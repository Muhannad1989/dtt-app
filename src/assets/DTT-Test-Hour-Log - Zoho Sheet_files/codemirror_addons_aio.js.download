(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(c){var h="CodeMirror-activeline";var g="CodeMirror-activeline-background";var f="CodeMirror-activeline-gutter";c.defineOption("styleActiveLine",false,function(i,l,j){var k=j==c.Init?false:j;if(l==k){return}if(k){i.off("beforeSelectionChange",b);d(i);delete i.state.activeLines}if(l){i.state.activeLines=[];e(i,i.listSelections());i.on("beforeSelectionChange",b)}});function d(j){for(var k=0;k<j.state.activeLines.length;k++){j.removeLineClass(j.state.activeLines[k],"wrap",h);j.removeLineClass(j.state.activeLines[k],"background",g);j.removeLineClass(j.state.activeLines[k],"gutter",f)}}function a(k,j){if(k.length!=j.length){return false}for(var l=0;l<k.length;l++){if(k[l]!=j[l]){return false}}return true}function e(j,l){var p=[];for(var n=0;n<l.length;n++){var m=l[n];var o=j.getOption("styleActiveLine");if(typeof o=="object"&&o.nonEmpty?m.anchor.line!=m.head.line:!m.empty()){continue}var k=j.getLineHandleVisualStart(m.head.line);if(p[p.length-1]!=k){p.push(k)}}if(a(j.state.activeLines,p)){return}j.operation(function(){d(j);for(var q=0;q<p.length;q++){j.addLineClass(p[q],"wrap",h);j.addLineClass(p[q],"background",g);j.addLineClass(p[q],"gutter",f)}j.state.activeLines=p})}function b(i,j){e(i,j.ranges)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.registerHelper("fold","brace",function(m,h){var o=h.line,g=m.getLine(o);var t;function d(u){for(var i=h.ch,v=0;;){var w=i<=0?-1:g.lastIndexOf(u,i-1);if(w==-1){if(v==1){break}v=1;i=g.length;continue}if(v==1&&w<h.ch){break}t=m.getTokenTypeAt(a.Pos(o,w+1));if(!/^(comment|string)/.test(t)){return w+1}i=w-1}}var j="{",e="}",n=d("{");if(n==null){j="[",e="]";n=d("[")}if(n==null){return}var l=1,c=m.lastLine(),f,q;outer:for(var s=o;s<=c;++s){var p=m.getLine(s),k=s==o?n:0;for(;;){var b=p.indexOf(j,k),r=p.indexOf(e,k);if(b<0){b=p.length}if(r<0){r=p.length}k=Math.min(b,r);if(k==p.length){break}if(m.getTokenTypeAt(a.Pos(s,k+1))==t){if(k==b){++l}else{if(!--l){f=s;q=k;break outer}}}++k}}if(f==null||o==f&&q==n){return}return{from:a.Pos(o,n),to:a.Pos(f,q)}});a.registerHelper("fold","import",function(b,i){function h(k){if(k<b.firstLine()||k>b.lastLine()){return null}var o=b.getTokenAt(a.Pos(k,1));if(!/\S/.test(o.string)){o=b.getTokenAt(a.Pos(k,o.end+1))}if(o.type!="keyword"||o.string!="import"){return null}for(var l=k,m=Math.min(b.lastLine(),k+10);l<=m;++l){var n=b.getLine(l),j=n.indexOf(";");if(j!=-1){return{startCh:o.end,end:a.Pos(l,j)}}}}var g=i.line,d=h(g),f;if(!d||h(g-1)||((f=h(g-2))&&f.end.line==g-1)){return null}for(var c=d.end;;){var e=h(c.line+1);if(e==null){break}c=e.end}return{from:b.clipPos(a.Pos(g,d.startCh+1)),to:c}});a.registerHelper("fold","include",function(b,h){function f(i){if(i<b.firstLine()||i>b.lastLine()){return null}var j=b.getTokenAt(a.Pos(i,1));if(!/\S/.test(j.string)){j=b.getTokenAt(a.Pos(i,j.end+1))}if(j.type=="meta"&&j.string.slice(0,8)=="#include"){return j.start+8}}var g=h.line,d=f(g);if(d==null||f(g-1)!=null){return null}for(var c=g;;){var e=f(c+1);if(e==null){break}++c}return{from:a.Pos(g,d+1),to:b.clipPos(a.Pos(c))}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.registerGlobalHelper("fold","comment",function(b){return b.blockCommentStart&&b.blockCommentEnd},function(l,h){var q=l.getModeAt(h),j=q.blockCommentStart,e=q.blockCommentEnd;if(!j||!e){return}var n=h.line,g=l.getLine(n);var m;for(var r=h.ch,c=0;;){var o=r<=0?-1:g.lastIndexOf(j,r-1);if(o==-1){if(c==1){return}c=1;r=g.length;continue}if(c==1&&o<h.ch){return}if(/comment/.test(l.getTokenTypeAt(a.Pos(n,o+1)))&&(o==0||g.slice(o-e.length,o)==e||!/comment/.test(l.getTokenTypeAt(a.Pos(n,o))))){m=o+j.length;break}r=o-1}var v=1,d=l.lastLine(),f,s;outer:for(var u=n;u<=d;++u){var p=l.getLine(u),k=u==n?m:0;for(;;){var b=p.indexOf(j,k),t=p.indexOf(e,k);if(b<0){b=p.length}if(t<0){t=p.length}k=Math.min(b,t);if(k==p.length){break}if(k==b){++v}else{if(!--v){f=u;s=k;break outer}}++k}}if(f==null||n==f&&s==m){return}return{from:a.Pos(n,m),to:a.Pos(f,s)}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){var c={};var g=/[^\s\u00a0]/;var e=b.Pos;function f(i){var h=i.search(g);return h==-1?0:h}b.commands.toggleComment=function(h){h.toggleComment()};b.defineExtension("toggleComment",function(k){if(!k){k=c}var h=this;var m=Infinity,j=this.listSelections(),n=null;for(var l=j.length-1;l>=0;l--){var p=j[l].from(),o=j[l].to();if(p.line>=m){continue}if(o.line>=m){o=e(m,0)}m=p.line;if(n==null){if(h.uncomment(p,o,k)){n="un"}else{h.lineComment(p,o,k);n="line"}}else{if(n=="un"){h.uncomment(p,o,k)}else{h.lineComment(p,o,k)}}}});function d(h,j,i){return/\bstring\b/.test(h.getTokenTypeAt(e(j.line,0)))&&!/^[\'\"\`]/.test(i)}function a(h,j){var i=h.getMode();return i.useInnerComments===false||!i.innerMode?i:h.getModeAt(j)}b.defineExtension("lineComment",function(m,n,q){if(!q){q=c}var o=this,j=a(o,m);var l=o.getLine(m.line);if(l==null||d(o,m,l)){return}var p=q.lineComment||j.lineComment;if(!p){if(q.blockCommentStart||j.blockCommentStart){q.fullLines=true;o.blockComment(m,n,q)}return}var i=Math.min(n.ch!=0||n.line==m.line?n.line+1:n.line,o.lastLine()+1);var h=q.padding==null?" ":q.padding;var k=q.commentBlankLines||m.line==n.line;o.operation(function(){if(q.indent){var u=null;for(var t=m.line;t<i;++t){var r=o.getLine(t);var s=r.slice(0,f(r));if(u==null||u.length>s.length){u=s}}for(var t=m.line;t<i;++t){var r=o.getLine(t),v=u.length;if(!k&&!g.test(r)){continue}if(r.slice(0,v)!=u){v=f(r)}o.replaceRange(u+p+h,e(t,0),e(t,v))}}else{for(var t=m.line;t<i;++t){if(k||g.test(o.getLine(t))){o.replaceRange(p+h,e(t,0))}}}})});b.defineExtension("blockComment",function(l,m,p){if(!p){p=c}var o=this,j=a(o,l);var k=p.blockCommentStart||j.blockCommentStart;var n=p.blockCommentEnd||j.blockCommentEnd;if(!k||!n){if((p.lineComment||j.lineComment)&&p.fullLines!=false){o.lineComment(l,m,p)}return}if(/\bcomment\b/.test(o.getTokenTypeAt(e(l.line,0)))){return}var i=Math.min(m.line,o.lastLine());if(i!=l.line&&m.ch==0&&g.test(o.getLine(i))){--i}var h=p.padding==null?" ":p.padding;if(l.line>i){return}o.operation(function(){if(p.fullLines!=false){var s=g.test(o.getLine(i));o.replaceRange(h+n,e(i));o.replaceRange(k+h,e(l.line,0));var q=p.blockCommentLead||j.blockCommentLead;if(q!=null){for(var r=l.line+1;r<=i;++r){if(r!=i||s){o.replaceRange(q+h,e(r,0))}}}}else{o.replaceRange(n,m);o.replaceRange(k,l)}})});b.defineExtension("uncomment",function(C,l,m){if(!m){m=c}var y=this,v=a(y,C);var n=Math.min(l.ch!=0||l.line==C.line?l.line:l.line-1,y.lastLine()),o=Math.min(C.line,n);var x=m.lineComment||v.lineComment,k=[];var G=m.padding==null?" ":m.padding,q;lineComment:{if(!x){break lineComment}for(var D=o;D<=n;++D){var r=y.getLine(D);var s=r.indexOf(x);if(s>-1&&!/comment/.test(y.getTokenTypeAt(e(D,s+1)))){s=-1}if(s==-1&&g.test(r)){break lineComment}if(s>-1&&g.test(r.slice(0,s))){break lineComment}k.push(r)}y.operation(function(){for(var K=o;K<=n;++K){var I=k[K-o];var L=I.indexOf(x),J=L+x.length;if(L<0){continue}if(I.slice(J,J+G.length)==G){J+=G.length}q=true;y.replaceRange("",e(K,L),e(K,J))}});if(q){return true}}var t=m.blockCommentStart||v.blockCommentStart;var h=m.blockCommentEnd||v.blockCommentEnd;if(!t||!h){return false}var F=m.blockCommentLead||v.blockCommentLead;var B=y.getLine(o),u=B.indexOf(t);if(u==-1){return false}var p=n==o?B:y.getLine(n);var w=p.indexOf(h,n==o?u+t.length:0);if(w==-1&&o!=n){p=y.getLine(--n);w=p.indexOf(h)}var E=e(o,u+1),z=e(n,w+1);if(w==-1||!/comment/.test(y.getTokenTypeAt(E))||!/comment/.test(y.getTokenTypeAt(z))||y.getRange(E,z,"\n").indexOf(h)>-1){return false}var A=B.lastIndexOf(t,C.ch);var H=A==-1?-1:B.slice(0,C.ch).indexOf(h,A+t.length);if(A!=-1&&H!=-1&&H+h.length!=C.ch){return false}H=p.indexOf(h,l.ch);var j=p.slice(l.ch).lastIndexOf(t,H-l.ch);A=(H==-1||j==-1)?-1:l.ch+j;if(H!=-1&&A!=-1&&A!=l.ch){return false}y.operation(function(){y.replaceRange("",e(n,w-(G&&p.slice(w-G.length,w)==G?G.length:0)),e(n,w+h.length));var L=u+t.length;if(G&&B.slice(L,L+G.length)==G){L+=G.length}y.replaceRange("",e(o,u),e(o,L));if(F){for(var K=o+1;K<=n;++K){var J=y.getLine(K),M=J.indexOf(F);if(M==-1||g.test(J.slice(0,M))){continue}var I=M+F.length;if(G&&J.slice(I,I+G.length)==G){I+=G.length}y.replaceRange("",e(K,M),e(K,I))}}});return true})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){function c(d,h,e){var g=d.getWrapperElement();var f;f=g.appendChild(document.createElement("div"));if(e){f.className="CodeMirror-dialog CodeMirror-dialog-bottom"}else{f.className="CodeMirror-dialog CodeMirror-dialog-top"}if(typeof h=="string"){f.innerHTML=h}else{f.appendChild(h)}return f}function a(d,e){if(d.state.currentNotificationClose){d.state.currentNotificationClose()}d.state.currentNotificationClose=e}b.defineExtension("openDialog",function(i,j,l){if(!l){l={}}a(this,null);var f=c(this,i,l.bottom);var e=false,g=this;function k(m){if(typeof m=="string"){h.value=m}else{if(e){return}e=true;f.parentNode.removeChild(f);g.focus();if(l.onClose){l.onClose(f)}}}var h=f.getElementsByTagName("input")[0],d;if(h){h.focus();if(l.value){h.value=l.value;if(l.selectValueOnOpen!==false){h.select()}}if(l.onInput){b.on(h,"input",function(m){l.onInput(m,h.value,k)})}if(l.onKeyUp){b.on(h,"keyup",function(m){l.onKeyUp(m,h.value,k)})}b.on(h,"keydown",function(m){if(l&&l.onKeyDown&&l.onKeyDown(m,h.value,k)){return}if(m.keyCode==27||(l.closeOnEnter!==false&&m.keyCode==13)){h.blur();b.e_stop(m);k()}if(m.keyCode==13){j(h.value,m)}});if(l.closeOnBlur!==false){b.on(h,"blur",k)}}else{if(d=f.getElementsByTagName("button")[0]){b.on(d,"click",function(){k();g.focus()});if(l.closeOnBlur!==false){b.on(d,"blur",k)}d.focus()}}return k});b.defineExtension("openConfirm",function(m,g,o){a(this,null);var h=c(this,m,o&&o.bottom);var j=h.getElementsByTagName("button");var f=false,k=this,d=1;function n(){if(f){return}f=true;h.parentNode.removeChild(h);k.focus()}j[0].focus();for(var e=0;e<j.length;++e){var l=j[e];(function(i){b.on(l,"click",function(p){b.e_preventDefault(p);n();if(i){i(k)}})})(g[e]);b.on(l,"blur",function(){--d;setTimeout(function(){if(d<=0){n()}},200)});b.on(l,"focus",function(){++d})}});b.defineExtension("openNotification",function(g,e){a(this,j);var f=c(this,g,e&&e.bottom);var d=false,h;var i=e&&typeof e.duration!=="undefined"?e.duration:5000;function j(){if(d){return}d=true;clearTimeout(h);f.parentNode.removeChild(f)}b.on(f,"click",function(k){b.e_preventDefault(k);j()});if(i){h=setTimeout(j,i)}return j})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){function d(n,m,o,i){if(o&&o.call){var g=o;o=null}else{var g=c(n,o,"rangeFinder")}if(typeof m=="number"){m=b.Pos(m,0)}var h=c(n,o,"minFoldSize");function f(p){var q=g(n,m);if(!q||q.to.line-q.from.line<h){return null}var s=n.findMarksAt(q.from);for(var r=0;r<s.length;++r){if(s[r].__isFold&&i!=="fold"){if(!p){return null}q.cleared=true;s[r].clear()}}return q}var k=f(true);if(c(n,o,"scanUp")){while(!k&&m.line>n.firstLine()){m=b.Pos(m.line-1,0);k=f(false)}}if(!k||k.cleared||i==="unfold"){return}var l=e(n,o);b.on(l,"mousedown",function(p){j.clear();b.e_preventDefault(p)});var j=n.markText(k.from,k.to,{replacedWith:l,clearOnEnter:c(n,o,"clearOnEnter"),__isFold:true});j.on("clear",function(q,p){b.signal(n,"unfold",n,q,p)});b.signal(n,"fold",n,k.from,k.to)}function e(f,g){var h=c(f,g,"widget");if(typeof h=="string"){var i=document.createTextNode(h);h=document.createElement("span");h.appendChild(i);h.className="CodeMirror-foldmarker"}else{if(h){h=h.cloneNode(true)}}return h}b.newFoldFunction=function(g,f){return function(h,i){d(h,i,{rangeFinder:g,widget:f})}};b.defineExtension("foldCode",function(h,f,g){d(this,h,f,g)});b.defineExtension("isFolded",function(h){var g=this.findMarksAt(h);for(var f=0;f<g.length;++f){if(g[f].__isFold){return true}}});b.commands.toggleFold=function(f){f.foldCode(f.getCursor())};b.commands.fold=function(f){f.foldCode(f.getCursor(),null,"fold")};b.commands.unfold=function(f){f.foldCode(f.getCursor(),null,"unfold")};b.commands.foldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(b.Pos(g,0),null,"fold")}})};b.commands.unfoldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(b.Pos(g,0),null,"unfold")}})};b.registerHelper("fold","combine",function(){var f=Array.prototype.slice.call(arguments,0);return function(g,k){for(var h=0;h<f.length;++h){var j=f[h](g,k);if(j){return j}}}});b.registerHelper("fold","auto",function(f,k){var h=f.getHelpers(k,"fold");for(var g=0;g<h.length;g++){var j=h[g](f,k);if(j){return j}}});var a={rangeFinder:b.fold.auto,widget:"\u2194",minFoldSize:0,scanUp:false,clearOnEnter:true};b.defineOption("foldOptions",null);function c(f,h,g){if(h&&h[g]!==undefined){return h[g]}var i=f.options.foldOptions;if(i&&i[g]!==undefined){return i[g]}return a[g]}b.defineExtension("foldOption",function(g,f){return c(this,g,f)})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("./foldcode"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","./foldcode"],a)}else{a(CodeMirror)}}})(function(d){d.defineOption("foldGutter",false,function(m,o,n){if(n&&n!=d.Init){m.clearGutter(m.state.foldGutter.options.gutter);m.state.foldGutter=null;m.off("gutterClick",k);m.off("change",g);m.off("viewportChange",l);m.off("fold",e);m.off("unfold",e);m.off("swapDoc",g)}if(o){m.state.foldGutter=new j(i(o));b(m);m.on("gutterClick",k);m.on("change",g);m.on("viewportChange",l);m.on("fold",e);m.on("unfold",e);m.on("swapDoc",g)}});var h=d.Pos;function j(m){this.options=m;this.from=this.to=0}function i(m){if(m===true){m={}}if(m.gutter==null){m.gutter="CodeMirror-foldgutter"}if(m.indicatorOpen==null){m.indicatorOpen="CodeMirror-foldgutter-open"}if(m.indicatorFolded==null){m.indicatorFolded="CodeMirror-foldgutter-folded"}return m}function c(m,n){var p=m.findMarks(h(n,0),h(n+1,0));for(var o=0;o<p.length;++o){if(p[o].__isFold&&p[o].find().from.line==n){return p[o]}}}function f(m){if(typeof m=="string"){var n=document.createElement("div");n.className=m+" CodeMirror-guttermarker-subtle";return n}else{return m.cloneNode(true)}}function a(m,s,r){var o=m.state.foldGutter.options,q=s;var p=m.foldOption(o,"minFoldSize");var n=m.foldOption(o,"rangeFinder");m.eachLine(s,r,function(t){var w=null;if(c(m,q)){w=f(o.indicatorFolded)}else{var v=h(q,0);var u=n&&n(m,v);if(u&&u.to.line-u.from.line>=p){w=f(o.indicatorOpen)}}m.setGutterMarker(t,o.gutter,w);++q})}function b(m){var n=m.getViewport(),o=m.state.foldGutter;if(!o){return}m.operation(function(){a(m,n.from,n.to)});o.from=n.from;o.to=n.to}function k(m,n,q){var p=m.state.foldGutter;if(!p){return}var o=p.options;if(q!=o.gutter){return}var r=c(m,n);if(r){r.clear()}else{m.foldCode(h(n,0),o.rangeFinder)}}function g(m){var o=m.state.foldGutter;if(!o){return}var n=o.options;o.from=o.to=0;clearTimeout(o.changeUpdate);o.changeUpdate=setTimeout(function(){b(m)},n.foldOnChangeTimeSpan||600)}function l(m){var o=m.state.foldGutter;if(!o){return}var n=o.options;clearTimeout(o.changeUpdate);o.changeUpdate=setTimeout(function(){var p=m.getViewport();if(o.from==o.to||p.from-o.to>20||o.from-p.to>20){b(m)}else{m.operation(function(){if(p.from<o.from){a(m,p.from,o.from);o.from=p.from}if(p.to>o.to){a(m,o.to,p.to);o.to=p.to}})}},n.updateViewportTimeSpan||400)}function e(m,p){var o=m.state.foldGutter;if(!o){return}var n=p.line;if(n>=o.from&&n<o.to){a(m,n,n+1)}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(o){var b="CodeMirror-lint-markers";function f(w,v){var u=document.createElement("div");u.className="CodeMirror-lint-tooltip";u.appendChild(v.cloneNode(true));document.body.appendChild(u);function t(x){if(!u.parentNode){return o.off(document,"mousemove",t)}u.style.top=Math.max(0,x.clientY-u.offsetHeight-5)+"px";u.style.left=(x.clientX+5)+"px"}o.on(document,"mousemove",t);t(w);if(u.style.opacity!=null){u.style.opacity=1}return u}function j(t){if(t.parentNode){t.parentNode.removeChild(t)}}function i(t){if(!t.parentNode){return}if(t.style.opacity==null){j(t)}t.style.opacity=0;setTimeout(function(){j(t)},600)}function s(x,v,u){var w=f(x,v);function t(){o.off(u,"mouseout",t);if(w){i(w);w=null}}var y=setInterval(function(){if(w){for(var z=u;;z=z.parentNode){if(z&&z.nodeType==11){z=z.host}if(z==document.body){return}if(!z){t();break}}}if(!w){return clearInterval(y)}},400);o.on(u,"mouseout",t)}function m(t,v,u){this.marked=[];this.options=v;this.timeout=null;this.hasGutter=u;this.onMouseOver=function(w){n(t,w)};this.waitingFor=0}function a(u,t){if(t instanceof Function){return{getAnnotations:t}}if(!t||t===true){t={}}return t}function d(t){var v=t.state.lint;if(v.hasGutter){t.clearGutter(b)}for(var u=0;u<v.marked.length;++u){v.marked[u].clear()}v.marked.length=0}function r(y,w,t,x){var u=document.createElement("div"),v=u;u.className="CodeMirror-lint-marker-"+w;if(t){v=u.appendChild(document.createElement("div"));v.className="CodeMirror-lint-marker-multiple"}if(x!=false){o.on(v,"mouseover",function(z){s(z,y,v)})}return u}function g(u,t){if(u=="error"){return u}else{return t}}function h(x){var u=[];for(var v=0;v<x.length;++v){var w=x[v],t=w.from.line;(u[t]||(u[t]=[])).push(w)}return u}function c(v){var t=v.severity;if(!t){t="error"}var u=document.createElement("div");u.className="CodeMirror-lint-message-"+t;if(typeof v.messageHTML!="undefined"){u.innerHTML=v.messageHTML}else{u.appendChild(document.createTextNode(v.message))}return u}function k(t,y,u){var v=t.state.lint;var x=++v.waitingFor;function w(){x=-1;t.off("change",w)}t.on("change",w);y(t.getValue(),function(A,z){t.off("change",w);if(v.waitingFor!=x){return}if(z&&A instanceof o){A=z}l(t,A)},u,t)}function q(t){var w=t.state.lint,v=w.options;var u=v.options||v;var y=v.getAnnotations||t.getHelper(o.Pos(0,0),"lint");if(!y){return}if(v.async||y.async){k(t,y,u)}else{var x=y(t.getValue(),u,t);if(!x){return}if(x.then){x.then(function(z){l(t,z)})}else{l(t,x)}}}function l(A,z){d(A);var u=A.state.lint,C=u.options;var y=h(z);for(var D=0;D<y.length;++D){var w=y[D];if(!w){continue}var E=null;var v=u.hasGutter&&document.createDocumentFragment();for(var x=0;x<w.length;++x){var t=w[x];var B=t.severity;if(!B){B="error"}E=g(E,B);if(C.formatAnnotation){t=C.formatAnnotation(t)}if(u.hasGutter){v.appendChild(c(t))}if(t.to){u.marked.push(A.markText(t.from,t.to,{className:"CodeMirror-lint-mark-"+B,__annotation:t}))}}if(u.hasGutter){A.setGutterMarker(D,b,r(v,E,w.length>1,u.options.tooltips))}}if(C.onUpdateLinting){C.onUpdateLinting(z,y,A)}}function p(t){var u=t.state.lint;if(!u){return}clearTimeout(u.timeout);u.timeout=setTimeout(function(){q(t)},u.options.delay||500)}function e(y,x){var w=x.target||x.srcElement;var v=document.createDocumentFragment();for(var t=0;t<y.length;t++){var u=y[t];v.appendChild(c(u))}s(x,v,w)}function n(E,z){var A=z.target||z.srcElement;if(!/\bCodeMirror-lint-mark-/.test(A.className)){return}var v=A.getBoundingClientRect(),D=(v.left+v.right)/2,C=(v.top+v.bottom)/2;var B=E.findMarksAt(E.coordsChar({left:D,top:C},"client"));var w=[];for(var u=0;u<B.length;++u){var t=B[u].__annotation;if(t){w.push(t)}}if(w.length){e(w,z)}}o.defineOption("lint",false,function(t,z,u){if(u&&u!=o.Init){d(t);if(t.state.lint.options.lintOnChange!==false){t.off("change",p)}o.off(t.getWrapperElement(),"mouseover",t.state.lint.onMouseOver);clearTimeout(t.state.lint.timeout);delete t.state.lint}if(z){var v=t.getOption("gutters"),x=false;for(var w=0;w<v.length;++w){if(v[w]==b){x=true}}var y=t.state.lint=new m(t,a(t,z),x);if(y.options.lintOnChange!==false){t.on("change",p)}if(y.options.tooltips!=false&&y.options.tooltips!="gutter"){o.on(t.getWrapperElement(),"mouseover",y.onMouseOver)}q(t)}});o.defineExtension("performLint",function(){if(this.state.lint){q(this)}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(e){var d=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8);var i=e.Pos;var a={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};function f(q,n,k){var s=q.getLineHandle(n.line),p=n.ch-1;var m=k&&k.afterCursor;if(m==null){m=/(^| )cm-fat-cursor($| )/.test(q.getWrapperElement().className)}var o=(!m&&p>=0&&a[s.text.charAt(p)])||a[s.text.charAt(++p)];if(!o){return null}var l=o.charAt(1)==">"?1:-1;if(k&&k.strict&&(l>0)!=(p==n.ch)){return null}var j=q.getTokenTypeAt(i(n.line,p+1));var r=g(q,i(n.line,p+(l>0?1:0)),l,j||null,k);if(r==null){return null}return{from:i(n.line,p),to:r&&r.pos,match:r&&r.ch==o.charAt(0),forward:l>0}}function g(w,r,n,k,m){var l=(m&&m.maxScanLineLength)||10000;var t=(m&&m.maxScanLines)||1000;var v=[];var x=m&&m.bracketRegex?m.bracketRegex:/[(){}[\]]/;var q=n>0?Math.min(r.line+t,w.lastLine()+1):Math.max(w.firstLine()-1,r.line-t);for(var o=r.line;o!=q;o+=n){var y=w.getLine(o);if(!y){continue}var u=n>0?0:y.length-1,p=n>0?y.length:-1;if(y.length>l){continue}if(o==r.line){u=r.ch-(n<0?1:0)}for(;u!=p;u+=n){var j=y.charAt(u);if(x.test(j)&&(k===undefined||w.getTokenTypeAt(i(o,u+1))==k)){var s=a[j];if((s.charAt(1)==">")==(n>0)){v.push(j)}else{if(!v.length){return{pos:i(o,u),ch:j}}else{v.pop()}}}}}return o-n==(n>0?w.lastLine():w.firstLine())?false:null}function b(s,n,m){var k=s.state.matchBrackets.maxHighlightLineLength||1000;var r=[],l=s.listSelections();for(var o=0;o<l.length;o++){var q=l[o].empty()&&f(s,l[o].head,m);if(q&&s.getLine(q.from.line).length<=k){var j=q.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";r.push(s.markText(q.from,i(q.from.line,q.from.ch+1),{className:j}));if(q.to&&s.getLine(q.to.line).length<=k){r.push(s.markText(q.to,i(q.to.line,q.to.ch+1),{className:j}))}}}if(r.length){if(d&&s.state.focused){s.focus()}var p=function(){s.operation(function(){for(var t=0;t<r.length;t++){r[t].clear()}})};if(n){setTimeout(p,800)}else{return p}}}var c=null;function h(j){j.operation(function(){if(c){c();c=null}c=b(j,false,j.state.matchBrackets)})}e.defineOption("matchBrackets",false,function(j,l,k){if(k&&k!=e.Init){j.off("cursorActivity",h);if(c){c();c=null}}if(l){j.state.matchBrackets=typeof l=="object"?l:{};j.on("cursorActivity",h)}});e.defineExtension("matchBrackets",function(){b(this,true)});e.defineExtension("findMatchingBracket",function(l,k,j){if(j||typeof k=="boolean"){if(!j){k=k?{strict:true}:null}else{j.strict=k;k=j}}return f(this,l,k)});e.defineExtension("scanForBracket",function(m,k,l,j){return g(this,m,k,l,j)})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],a)}else{a(CodeMirror)}}})(function(n){function k(w,v){if(typeof w=="string"){w=new RegExp(w.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),v?"gi":"g")}else{if(!w.global){w=new RegExp(w.source,w.ignoreCase?"gi":"g")}}return{token:function(y){w.lastIndex=y.pos;var x=w.exec(y.string);if(x&&x.index==y.pos){y.pos+=x[0].length||1;return"searching"}else{if(x){y.pos=x.index}else{y.skipToEnd()}}}}}function j(){this.posFrom=this.posTo=this.lastQuery=this.query=null;this.overlay=null}function s(v){return v.state.search||(v.state.search=new j())}function e(v){return typeof v=="string"&&v==v.toLowerCase()}function b(v,w,x){return v.getSearchCursor(w,x,{caseFold:e(w),multiline:true})}function d(v,y,z,w,x){v.openDialog(y,w,{value:z,selectValueOnOpen:true,closeOnEnter:false,onClose:function(){q(v)},onKeyDown:x})}function p(v,y,w,z,x){if(v.openDialog){v.openDialog(y,x,{value:z,selectValueOnOpen:true})}else{x(prompt(w,z))}}function l(w,y,x,v){if(w.openConfirm){w.openConfirm(y,v)}else{if(confirm(x)){v[0]()}}}function i(v){return v.replace(/\\(.)/g,function(w,x){if(x=="n"){return"\n"}if(x=="r"){return"\r"}return x})}function h(w){var v=w.match(/^\/(.*)\/([a-z]*)$/);if(v){try{w=new RegExp(v[1],v[2].indexOf("i")==-1?"":"i")}catch(x){}}else{w=i(w)}if(typeof w=="string"?w=="":w.test("")){w=/x^/}return w}var u='<span class="CodeMirror-search-label">Search:</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>';function t(v,x,w){x.queryText=w;x.query=h(w);v.removeOverlay(x.overlay,e(x.query));x.overlay=k(x.query,e(x.query));v.addOverlay(x.overlay);if(v.showMatchesOnScrollbar){if(x.annotate){x.annotate.clear();x.annotate=null}x.annotate=v.showMatchesOnScrollbar(x.query,e(x.query))}}function m(v,y,x,z){var C=s(v);if(C.query){return f(v,y)}var B=v.getSelection()||C.lastQuery;if(B instanceof RegExp&&B.source=="x^"){B=null}if(x&&v.openDialog){var w=null;var A=function(E,D){n.e_stop(D);if(!E){return}if(E!=C.queryText){t(v,C,E);C.posFrom=C.posTo=v.getCursor()}if(w){w.style.opacity=1}f(v,D.shiftKey,function(F,H){var G;if(H.line<3&&document.querySelector&&(G=v.display.wrapper.querySelector(".CodeMirror-dialog"))&&G.getBoundingClientRect().bottom-4>v.cursorCoords(H,"window").top){(w=G).style.opacity=0.4}})};d(v,u,B,A,function(F,H){var E=n.keyName(F);var D=v.getOption("extraKeys"),G=(D&&D[E])||n.keyMap[v.getOption("keyMap")][E];if(G=="findNext"||G=="findPrev"||G=="findPersistentNext"||G=="findPersistentPrev"){n.e_stop(F);t(v,s(v),H);v.execCommand(G)}else{if(G=="find"||G=="findPersistent"){n.e_stop(F);A(H,F)}}});if(z&&B){t(v,C,B);f(v,y)}}else{p(v,u,"Search for:",B,function(D){if(D&&!C.query){v.operation(function(){t(v,C,D);C.posFrom=C.posTo=v.getCursor();f(v,y)})}})}}function f(v,w,x){v.operation(function(){var y=s(v);var z=b(v,y.query,w?y.posFrom:y.posTo);if(!z.find(w)){z=b(v,y.query,w?n.Pos(v.lastLine()):n.Pos(v.firstLine(),0));if(!z.find(w)){return}}v.setSelection(z.from(),z.to());v.scrollIntoView({from:z.from(),to:z.to()},20);y.posFrom=z.from();y.posTo=z.to();if(x){x(z.from(),z.to())}})}function q(v){v.operation(function(){var w=s(v);w.lastQuery=w.query;if(!w.query){return}w.query=w.queryText=null;v.removeOverlay(w.overlay);if(w.annotate){w.annotate.clear();w.annotate=null}})}var a=' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">(Use /re/ syntax for regexp search)</span>';var g='<span class="CodeMirror-search-label">With:</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/>';var o='<span class="CodeMirror-search-label">Replace?</span> <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>';function c(v,w,x){v.operation(function(){for(var z=b(v,w);z.findNext();){if(typeof w!="string"){var y=v.getRange(z.from(),z.to()).match(w);z.replace(x.replace(/\$(\d)/g,function(A,B){return y[B]}))}else{z.replace(x)}}})}function r(v,x){if(v.getOption("readOnly")){return}var y=v.getSelection()||s(v).lastQuery;var w='<span class="CodeMirror-search-label">'+(x?"Replace all:":"Replace:")+"</span>";p(v,w+a,w,y,function(z){if(!z){return}z=h(z);p(v,g,"Replace with:","",function(D){D=i(D);if(x){c(v,z,D)}else{q(v);var C=b(v,z,v.getCursor("from"));var B=function(){var F=C.from(),E;if(!(E=C.findNext())){C=b(v,z);if(!(E=C.findNext())||(F&&C.from().line==F.line&&C.from().ch==F.ch)){return}}v.setSelection(C.from(),C.to());v.scrollIntoView({from:C.from(),to:C.to()});l(v,o,"Replace?",[function(){A(E)},B,function(){c(v,z,D)}])};var A=function(E){C.replace(typeof z=="string"?D:D.replace(/\$(\d)/g,function(F,G){return E[G]}));B()};B()}})})}n.commands.find=function(v){q(v);m(v)};n.commands.findPersistent=function(v){q(v);m(v,false,true)};n.commands.findPersistentNext=function(v){m(v,false,true,true)};n.commands.findPersistentPrev=function(v){m(v,true,true,true)};n.commands.findNext=m;n.commands.findPrev=function(v){m(v,true)};n.commands.clearSearch=q;n.commands.replace=r;n.commands.replaceAll=function(v){r(v,true)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(e){var l=e.Pos;function f(r){var q=r.flags;return q!=null?q:(r.ignoreCase?"i":"")+(r.global?"g":"")+(r.multiline?"m":"")}function b(q){return q.global?q:new RegExp(q.source,f(q)+"g")}function o(q){return/\\s|\\n|\n|\\W|\\D|\[\^/.test(q.source)}function n(w,v,x){v=b(v);for(var q=x.line,t=x.ch,u=w.lastLine();q<=u;q++,t=0){v.lastIndex=t;var s=w.getLine(q),r=v.exec(s);if(r){return{from:l(q,r.index),to:l(q,r.index+r[0].length),match:r}}}}function g(A,x,r){if(!o(x)){return n(A,x,r)}x=b(x);var w,z=1;for(var D=r.line,B=A.lastLine();D<=B;){for(var u=0;u<z;u++){var q=A.getLine(D++);w=w==null?q:w+"\n"+q}z=z*2;x.lastIndex=r.ch;var v=x.exec(w);if(v){var y=w.slice(0,v.index).split("\n"),t=v[0].split("\n");var C=r.line+y.length-1,s=y[y.length-1].length;return{from:l(C,s),to:l(C+t.length-1,t.length==1?s+t[0].length:t[t.length-1].length),match:v}}}}function h(r,t){var u=0,q;for(;;){t.lastIndex=u;var s=t.exec(r);if(!s){return q}q=s;u=q.index+(q[0].length||1);if(u==r.length){return q}}}function d(v,u,x){u=b(u);for(var q=x.line,t=x.ch,w=v.firstLine();q>=w;q--,t=-1){var s=v.getLine(q);if(t>-1){s=s.slice(0,t)}var r=h(s,u);if(r){return{from:l(q,r.index),to:l(q,r.index+r[0].length),match:r}}}}function i(B,y,r){y=b(y);var x,A=1;for(var D=r.line,w=B.firstLine();D>=w;){for(var u=0;u<A;u++){var q=B.getLine(D--);x=x==null?q.slice(0,r.ch):q+"\n"+x}A*=2;var v=h(x,y);if(v){var z=x.slice(0,v.index).split("\n"),t=v[0].split("\n");var C=D+z.length,s=z[z.length-1].length;return{from:l(C,s),to:l(C+t.length-1,t.length==1?s+t[0].length:t[t.length-1].length),match:v}}}}var p,a;if(String.prototype.normalize){p=function(q){return q.normalize("NFD").toLowerCase()};a=function(q){return q.normalize("NFD")}}else{p=function(q){return q.toLowerCase()};a=function(q){return q}}function m(x,v,w,t){if(x.length==v.length){return w}for(var u=0,r=w+Math.max(0,x.length-v.length);;){if(u==r){return u}var s=(u+r)>>1;var q=t(x.slice(0,s)).length;if(q==w){return s}else{if(q>w){r=s}else{u=s+1}}}}function k(C,y,r,u){if(!y.length){return null}var w=u?p:a;var F=w(y).split(/\r|\n\r?/);search:for(var G=r.line,q=r.ch,D=C.lastLine()+1-F.length;G<=D;G++,q=0){var B=C.getLine(G).slice(q),v=w(B);if(F.length==1){var E=v.indexOf(F[0]);if(E==-1){continue search}var r=m(B,v,E,w)+q;return{from:l(G,m(B,v,E,w)+q),to:l(G,m(B,v,E+F[0].length,w)+q)}}else{var x=v.length-F[0].length;if(v.slice(x)!=F[0]){continue search}for(var t=1;t<F.length-1;t++){if(w(C.getLine(G+t))!=F[t]){continue search}}var s=C.getLine(G+F.length-1),A=w(s),z=F[F.length-1];if(s.slice(0,z.length)!=z){continue search}return{from:l(G,m(B,v,x,w)+q),to:l(G+F.length-1,m(s,A,z.length,w))}}}}function c(C,y,r,t){if(!y.length){return null}var x=t?p:a;var E=x(y).split(/\r|\n\r?/);search:for(var F=r.line,q=r.ch,u=C.firstLine()-1+E.length;F>=u;F--,q=-1){var B=C.getLine(F);if(q>-1){B=B.slice(0,q)}var v=x(B);if(E.length==1){var D=v.lastIndexOf(E[0]);if(D==-1){continue search}return{from:l(F,m(B,v,D,x)),to:l(F,m(B,v,D+E[0].length,x))}}else{var A=E[E.length-1];if(v.slice(0,A.length)!=A){continue search}for(var s=1,r=F-E.length+1;s<E.length-1;s++){if(x(C.getLine(r+s))!=E[s]){continue search}}var z=C.getLine(F+1-E.length),w=x(z);if(w.slice(w.length-E[0].length)!=E[0]){continue search}return{from:l(F+1-E.length,m(z,w,z.length-E[0].length,x)),to:l(F,m(B,v,A.length,x))}}}}function j(t,s,u,q){this.atOccurrence=false;this.doc=t;u=u?t.clipPos(u):l(0,0);this.pos={from:u,to:u};var r;if(typeof q=="object"){r=q.caseFold}else{r=q;q=null}if(typeof s=="string"){if(r==null){r=false}this.matches=function(v,w){return(v?c:k)(t,s,w,r)}}else{s=b(s);if(!q||q.multiline!==false){this.matches=function(v,w){return(v?i:g)(t,s,w)}}else{this.matches=function(v,w){return(v?d:n)(t,s,w)}}}}j.prototype={findNext:function(){return this.find(false)},findPrevious:function(){return this.find(true)},find:function(s){var q=this.matches(s,this.doc.clipPos(s?this.pos.from:this.pos.to));while(q&&e.cmpPos(q.from,q.to)==0){if(s){if(q.from.ch){q.from=l(q.from.line,q.from.ch-1)}else{if(q.from.line==this.doc.firstLine()){q=null}else{q=this.matches(s,this.doc.clipPos(l(q.from.line-1)))}}}else{if(q.to.ch<this.doc.getLine(q.to.line).length){q.to=l(q.to.line,q.to.ch+1)}else{if(q.to.line==this.doc.lastLine()){q=null}else{q=this.matches(s,l(q.to.line+1,0))}}}}if(q){this.pos=q;this.atOccurrence=true;return this.pos.match||true}else{var r=l(s?this.doc.firstLine():this.doc.lastLine()+1,0);this.pos={from:r,to:r};return this.atOccurrence=false}},from:function(){if(this.atOccurrence){return this.pos.from}},to:function(){if(this.atOccurrence){return this.pos.to}},replace:function(s,r){if(!this.atOccurrence){return}var q=e.splitLines(s);this.doc.replaceRange(q,this.pos.from,this.pos.to,r);this.pos.to=l(this.pos.from.line+q.length-1,q[q.length-1].length+(q.length==1?this.pos.from.ch:0))}};e.defineExtension("getSearchCursor",function(r,s,q){return new j(this.doc,r,s,q)});e.defineDocExtension("getSearchCursor",function(r,s,q){return new j(this,r,s,q)});e.defineExtension("selectMatches",function(s,r){var q=[];var t=this.getSearchCursor(s,this.getCursor("from"),r);while(t.findNext()){if(e.cmpPos(t.to(),this.getCursor("to"))>0){break}q.push({anchor:t.from(),head:t.to()})}if(q.length){this.setSelections(q,0)}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.runMode=function(m,j,q,s){var l=a.getMode(a.defaults,j);var d=/MSIE \d/.test(navigator.userAgent);var h=d&&(document.documentMode==null||document.documentMode<9);if(q.appendChild){var n=(s&&s.tabSize)||a.defaults.tabSize;var g=q,f=0;g.innerHTML="";q=function(y,v){if(y=="\n"){g.appendChild(document.createTextNode(h?"\r":y));f=0;return}var w="";for(var z=0;;){var e=y.indexOf("\t",z);if(e==-1){w+=y.slice(z);f+=y.length-z;break}else{f+=e-z;w+=y.slice(z,e);var u=n-f%n;f+=u;for(var t=0;t<u;++t){w+=" "}z=e+1}}if(v){var x=g.appendChild(document.createElement("span"));x.className="cm-"+v.replace(/ +/g," cm-");x.appendChild(document.createTextNode(w))}else{g.appendChild(document.createTextNode(w))}}}var r=a.splitLines(m),c=(s&&s.state)||a.startState(l);for(var k=0,o=r.length;k<o;++k){if(k){q("\n")}var p=new a.StringStream(r[k]);if(!p.string&&l.blankLine){l.blankLine(c)}while(!p.eol()){var b=l.token(p,c);q(p.current(),b,k,p.start,c);p.start=p.pos}}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets"))}else{if(typeof define=="function"&&define.amd){define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],a)}else{a(CodeMirror)}}})(function(p){var v=p.keyMap.sublime={fallthrough:"default"};var n=p.commands;var m=p.Pos;var e=p.keyMap["default"]==p.keyMap.macDefault;var i=e?"Cmd-":"Ctrl-";function g(H,z,A){if(A<0&&z.ch==0){return H.clipPos(m(z.line-1))}var I=H.getLine(z.line);if(A>0&&z.ch>=I.length){return H.clipPos(m(z.line+1,0))}var y="start",E;for(var G=z.ch,D=A<0?0:I.length,B=0;G!=D;G+=A,B++){var C=I.charAt(A<0?G-1:G);var F=C!="_"&&p.isWordChar(C)?"w":"o";if(F=="w"&&C.toUpperCase()==C){F="W"}if(y=="start"){if(F!="o"){y="in";E=F}}else{if(y=="in"){if(E!=F){if(E=="w"&&F=="W"&&A<0){G--}if(E=="W"&&F=="w"&&A>0){E="w";continue}break}}}}return m(z.line,G)}function s(y,z){y.extendSelectionsBy(function(A){if(y.display.shift||y.doc.extend||A.empty()){return g(y.doc,A.head,z)}else{return z<0?A.from():A.to()}})}var u=e?"Ctrl-":"Alt-";n[v[u+"Left"]="goSubwordLeft"]=function(y){s(y,-1)};n[v[u+"Right"]="goSubwordRight"]=function(y){s(y,1)};if(e){v["Cmd-Left"]="goLineStartSmart"}var x=e?"Ctrl-Alt-":"Ctrl-";n[v[x+"Up"]="scrollLineUp"]=function(y){var A=y.getScrollInfo();if(!y.somethingSelected()){var z=y.lineAtHeight(A.top+A.clientHeight,"local");if(y.getCursor().line>=z){y.execCommand("goLineUp")}}y.scrollTo(null,A.top-y.defaultTextHeight())};n[v[x+"Down"]="scrollLineDown"]=function(y){var A=y.getScrollInfo();if(!y.somethingSelected()){var z=y.lineAtHeight(A.top,"local")+1;if(y.getCursor().line<=z){y.execCommand("goLineDown")}}y.scrollTo(null,A.top+y.defaultTextHeight())};n[v["Shift-"+i+"L"]="splitSelectionByLine"]=function(y){var A=y.listSelections(),C=[];for(var B=0;B<A.length;B++){var E=A[B].from(),D=A[B].to();for(var z=E.line;z<=D.line;++z){if(!(D.line>E.line&&z==D.line&&D.ch==0)){C.push({anchor:z==E.line?E:m(z,0),head:z==D.line?D:m(z)})}}}y.setSelections(C,0)};v["Shift-Tab"]="indentLess";n[v.Esc="singleSelectionTop"]=function(y){var z=y.listSelections()[0];y.setSelection(z.anchor,z.head,{scroll:false})};n[v[i+"L"]="selectLine"]=function(z){var A=z.listSelections(),y=[];for(var C=0;C<A.length;C++){var B=A[C];y.push({anchor:m(B.from().line,0),head:m(B.to().line+1,0)})}z.setSelections(y)};v["Shift-Ctrl-K"]="deleteLine";function a(z,y){if(z.isReadOnly()){return p.Pass}z.operation(function(){var C=z.listSelections().length,B=[],F=-1;for(var E=0;E<C;E++){var D=z.listSelections()[E].head;if(D.line<=F){continue}var A=m(D.line+(y?0:1),0);z.replaceRange("\n",A,null,"+insertLine");z.indentLine(A.line,null,true);B.push({head:A,anchor:A});F=D.line+1}z.setSelections(B)});z.execCommand("indentAuto")}n[v[i+"Enter"]="insertLineAfter"]=function(y){return a(y,false)};n[v["Shift-"+i+"Enter"]="insertLineBefore"]=function(y){return a(y,true)};function b(y,C){var B=C.ch,A=B,z=y.getLine(C.line);while(B&&p.isWordChar(z.charAt(B-1))){--B}while(A<z.length&&p.isWordChar(z.charAt(A))){++A}return{from:m(C.line,B),to:m(C.line,A),word:z.slice(B,A)}}n[v[i+"D"]="selectNextOccurrence"]=function(D){var B=D.getCursor("from"),C=D.getCursor("to");var z=D.state.sublimeFindFullWord==D.doc.sel;if(p.cmpPos(B,C)==0){var y=b(D,B);if(!y.word){return}D.setSelection(y.from,y.to);z=true}else{var F=D.getRange(B,C);var A=z?new RegExp("\\b"+F+"\\b"):F;var E=D.getSearchCursor(A,C);var G=E.findNext();if(!G){E=D.getSearchCursor(A,m(D.firstLine(),0));G=E.findNext()}if(!G||l(D.listSelections(),E.from(),E.to())){return p.Pass}D.addSelection(E.from(),E.to())}if(z){D.state.sublimeFindFullWord=D.doc.sel}};function d(G,A){var y=G.listSelections(),z=[];for(var C=0;C<y.length;C++){var D=y[C];var E=G.findPosV(D.anchor,A,"line");var B=G.findPosV(D.head,A,"line");var F={anchor:E,head:B};z.push(D);z.push(F)}G.setSelections(z)}var h=e?"Shift-Cmd":"Alt-Ctrl";n[v[h+"Up"]="addCursorToPrevLine"]=function(y){d(y,-1)};n[v[h+"Down"]="addCursorToNextLine"]=function(y){d(y,1)};function l(y,B,A){for(var z=0;z<y.length;z++){if(y[z].from()==B&&y[z].to()==A){return true}}return false}var k="(){}[]";function r(z){var A=z.listSelections(),C=[];for(var E=0;E<A.length;E++){var B=A[E],F=B.head,y=z.scanForBracket(F,-1);if(!y){return false}for(;;){var D=z.scanForBracket(F,1);if(!D){return false}if(D.ch==k.charAt(k.indexOf(y.ch)+1)){C.push({anchor:m(y.pos.line,y.pos.ch+1),head:D.pos});break}F=m(D.pos.line,D.pos.ch+1)}}z.setSelections(C);return true}n[v["Shift-"+i+"Space"]="selectScope"]=function(y){r(y)||y.execCommand("selectAll")};n[v["Shift-"+i+"M"]="selectBetweenBrackets"]=function(y){if(!r(y)){return p.Pass}};n[v[i+"M"]="goToBracket"]=function(y){y.extendSelectionsBy(function(z){var A=y.scanForBracket(z.head,1);if(A&&p.cmpPos(A.pos,z.head)!=0){return A.pos}var B=y.scanForBracket(z.head,-1);return B&&m(B.pos.line,B.pos.ch+1)||z.head})};var q=e?"Cmd-Ctrl-":"Shift-Ctrl-";n[v[q+"Up"]="swapLineUp"]=function(F){if(F.isReadOnly()){return p.Pass}var y=F.listSelections(),C=[],z=F.firstLine()-1,G=[];for(var A=0;A<y.length;A++){var B=y[A],E=B.from().line-1,D=B.to().line;G.push({anchor:m(B.anchor.line-1,B.anchor.ch),head:m(B.head.line-1,B.head.ch)});if(B.to().ch==0&&!B.empty()){--D}if(E>z){C.push(E,D)}else{if(C.length){C[C.length-1]=D}}z=D}F.operation(function(){for(var I=0;I<C.length;I+=2){var K=C[I],J=C[I+1];var H=F.getLine(K);F.replaceRange("",m(K,0),m(K+1,0),"+swapLine");if(J>F.lastLine()){F.replaceRange("\n"+H,m(F.lastLine()),null,"+swapLine")}else{F.replaceRange(H+"\n",m(J,0),null,"+swapLine")}}F.setSelections(G);F.scrollIntoView()})};n[v[q+"Down"]="swapLineDown"]=function(z){if(z.isReadOnly()){return p.Pass}var A=z.listSelections(),D=[],y=z.lastLine()+1;for(var C=A.length-1;C>=0;C--){var B=A[C],F=B.to().line+1,E=B.from().line;if(B.to().ch==0&&!B.empty()){F--}if(F<y){D.push(F,E)}else{if(D.length){D[D.length-1]=E}}y=E}z.operation(function(){for(var H=D.length-2;H>=0;H-=2){var J=D[H],I=D[H+1];var G=z.getLine(J);if(J==z.lastLine()){z.replaceRange("",m(J-1),m(J),"+swapLine")}else{z.replaceRange("",m(J,0),m(J+1,0),"+swapLine")}z.replaceRange(G+"\n",m(I,0),null,"+swapLine")}z.scrollIntoView()})};n[v[i+"/"]="toggleCommentIndented"]=function(y){y.toggleComment({indent:true})};n[v[i+"J"]="joinLines"]=function(y){var A=y.listSelections(),D=[];for(var C=0;C<A.length;C++){var B=A[C],F=B.from();var E=F.line,z=B.to().line;while(C<A.length-1&&A[C+1].from().line==z){z=A[++C].to().line}D.push({start:E,end:z,anchor:!B.empty()&&F})}y.operation(function(){var M=0,H=[];for(var K=0;K<D.length;K++){var L=D[K];var I=L.anchor&&m(L.anchor.line-M,L.anchor.ch),J;for(var G=L.start;G<=L.end;G++){var N=G-M;if(G==L.end){J=m(N,y.getLine(N).length+1)}if(N<y.lastLine()){y.replaceRange(" ",m(N),m(N+1,/^\s*/.exec(y.getLine(N+1))[0].length));++M}}H.push({anchor:I||J,head:J})}y.setSelections(H,0)})};n[v["Shift-"+i+"D"]="duplicateLine"]=function(y){y.operation(function(){var A=y.listSelections().length;for(var B=0;B<A;B++){var z=y.listSelections()[B];if(z.empty()){y.replaceRange(y.getLine(z.head.line)+"\n",m(z.head.line,0))}else{y.replaceRange(y.getRange(z.from(),z.to()),z.from())}}y.scrollIntoView()})};if(!e){v[i+"T"]="transposeChars"}function w(G,D){if(G.isReadOnly()){return p.Pass}var y=G.listSelections(),C=[],z;for(var A=0;A<y.length;A++){var B=y[A];if(B.empty()){continue}var F=B.from().line,E=B.to().line;while(A<y.length-1&&y[A+1].from().line==E){E=y[++A].to().line}if(!y[A].to().ch){E--}C.push(F,E)}if(C.length){z=true}else{C.push(G.firstLine(),G.lastLine())}G.operation(function(){var J=[];for(var K=0;K<C.length;K+=2){var N=C[K],M=C[K+1];var L=m(N,0),I=m(M);var H=G.getRange(L,I,false);if(D){H.sort()}else{H.sort(function(Q,O){var R=Q.toUpperCase(),P=O.toUpperCase();if(R!=P){Q=R;O=P}return Q<O?-1:Q==O?0:1})}G.replaceRange(H,L,I);if(z){J.push({anchor:L,head:m(M+1,0)})}}if(z){G.setSelections(J,0)}})}n[v.F9="sortLines"]=function(y){w(y,true)};n[v[i+"F9"]="sortLinesInsensitive"]=function(y){w(y,false)};n[v.F2="nextBookmark"]=function(y){var z=y.state.sublimeBookmarks;if(z){while(z.length){var B=z.shift();var A=B.find();if(A){z.push(B);return y.setSelection(A.from,A.to)}}}};n[v["Shift-F2"]="prevBookmark"]=function(y){var z=y.state.sublimeBookmarks;if(z){while(z.length){z.unshift(z.pop());var A=z[z.length-1].find();if(!A){z.pop()}else{return y.setSelection(A.from,A.to)}}}};n[v[i+"F2"]="toggleBookmark"]=function(F){var y=F.listSelections();var C=F.state.sublimeBookmarks||(F.state.sublimeBookmarks=[]);for(var B=0;B<y.length;B++){var D=y[B].from(),E=y[B].to();var G=F.findMarks(D,E);for(var A=0;A<G.length;A++){if(G[A].sublimeBookmark){G[A].clear();for(var z=0;z<C.length;z++){if(C[z]==G[A]){C.splice(z--,1)}}break}}if(A==G.length){C.push(F.markText(D,E,{sublimeBookmark:true,clearWhenEmpty:false}))}}};n[v["Shift-"+i+"F2"]="clearBookmarks"]=function(y){var A=y.state.sublimeBookmarks;if(A){for(var z=0;z<A.length;z++){A[z].clear()}}A.length=0};n[v["Alt-F2"]="selectBookmarks"]=function(y){var B=y.state.sublimeBookmarks,z=[];if(B){for(var A=0;A<B.length;A++){var C=B[A].find();if(!C){B.splice(A--,0)}else{z.push({anchor:C.from,head:C.to})}}}if(z.length){y.setSelections(z,0)}};v["Alt-Q"]="wrapLines";var c=i+"K ";function j(y,z){y.operation(function(){var B=y.listSelections(),G=[],E=[];for(var D=0;D<B.length;D++){var C=B[D];if(C.empty()){G.push(D);E.push("")}else{E.push(z(y.getRange(C.from(),C.to())))}}y.replaceSelections(E,"around","case");for(var D=G.length-1,A;D>=0;D--){var C=B[G[D]];if(A&&p.cmpPos(C.head,A)>0){continue}var F=b(y,C.head);A=F.from;y.replaceRange(z(F.word),F.from,F.to)}})}v[c+i+"Backspace"]="delLineLeft";n[v.Backspace="smartBackspace"]=function(y){if(y.somethingSelected()){return p.Pass}y.operation(function(){var E=y.listSelections();var A=y.getOption("indentUnit");for(var B=E.length-1;B>=0;B--){var F=E[B].head;var D=y.getRange({line:F.line,ch:0},F);var C=p.countColumn(D,null,y.getOption("tabSize"));var z=y.findPosH(F,-1,"char",false);if(D&&!/\S/.test(D)&&C%A==0){var G=new m(F.line,p.findColumn(D,C-A,A));if(G.ch!=F.ch){z=G}}y.replaceRange("",z,F,"+delete")}})};n[v[c+i+"K"]="delLineRight"]=function(y){y.operation(function(){var z=y.listSelections();for(var A=z.length-1;A>=0;A--){y.replaceRange("",z[A].anchor,m(z[A].to().line),"+delete")}y.scrollIntoView()})};n[v[c+i+"U"]="upcaseAtCursor"]=function(y){j(y,function(z){return z.toUpperCase()})};n[v[c+i+"L"]="downcaseAtCursor"]=function(y){j(y,function(z){return z.toLowerCase()})};n[v[c+i+"Space"]="setSublimeMark"]=function(y){if(y.state.sublimeMark){y.state.sublimeMark.clear()}y.state.sublimeMark=y.setBookmark(y.getCursor())};n[v[c+i+"A"]="selectToSublimeMark"]=function(y){var z=y.state.sublimeMark&&y.state.sublimeMark.find();if(z){y.setSelection(y.getCursor(),z)}};n[v[c+i+"W"]="deleteToSublimeMark"]=function(y){var A=y.state.sublimeMark&&y.state.sublimeMark.find();if(A){var C=y.getCursor(),B=A;if(p.cmpPos(C,B)>0){var z=B;B=C;C=z}y.state.sublimeKilled=y.getRange(C,B);y.replaceRange("",C,B)}};n[v[c+i+"X"]="swapWithSublimeMark"]=function(y){var z=y.state.sublimeMark&&y.state.sublimeMark.find();if(z){y.state.sublimeMark.clear();y.state.sublimeMark=y.setBookmark(y.getCursor());y.setCursor(z)}};n[v[c+i+"Y"]="sublimeYank"]=function(y){if(y.state.sublimeKilled!=null){y.replaceSelection(y.state.sublimeKilled,null,"paste")}};v[c+i+"G"]="clearBookmarks";n[v[c+i+"C"]="showInCenter"]=function(y){var z=y.cursorCoords(null,"local");y.scrollTo(null,(z.top+z.bottom)/2-y.getScrollInfo().clientHeight/2)};var f=e?"Ctrl-Shift-":"Ctrl-Alt-";n[v[f+"Up"]="selectLinesUpward"]=function(y){y.operation(function(){var z=y.listSelections();for(var B=0;B<z.length;B++){var A=z[B];if(A.head.line>y.firstLine()){y.addSelection(m(A.head.line-1,A.head.ch))}}})};n[v[f+"Down"]="selectLinesDownward"]=function(y){y.operation(function(){var z=y.listSelections();for(var B=0;B<z.length;B++){var A=z[B];if(A.head.line<y.lastLine()){y.addSelection(m(A.head.line+1,A.head.ch))}}})};function t(y){var B=y.getCursor("from"),A=y.getCursor("to");if(p.cmpPos(B,A)==0){var z=b(y,B);if(!z.word){return}B=z.from;A=z.to}return{from:B,to:A,query:y.getRange(B,A),word:z}}function o(y,z){var B=t(y);if(!B){return}var A=B.query;var C=y.getSearchCursor(A,z?B.to:B.from);if(z?C.findNext():C.findPrevious()){y.setSelection(C.from(),C.to())}else{C=y.getSearchCursor(A,z?m(y.firstLine(),0):y.clipPos(m(y.lastLine())));if(z?C.findNext():C.findPrevious()){y.setSelection(C.from(),C.to())}else{if(B.word){y.setSelection(B.from,B.to)}}}}n[v[i+"F3"]="findUnder"]=function(y){o(y,true)};n[v["Shift-"+i+"F3"]="findUnderPrevious"]=function(y){o(y,false)};n[v["Alt-F3"]="findAllUnder"]=function(y){var B=t(y);if(!B){return}var C=y.getSearchCursor(B.query);var A=[];var z=-1;while(C.findNext()){A.push({anchor:C.from(),head:C.to()});if(C.from().line<=B.from.line&&C.from().ch<=B.from.ch){z++}}y.setSelections(A,z)};v["Shift-"+i+"["]="fold";v["Shift-"+i+"]"]="unfold";v[c+i+"0"]=v[c+i+"J"]="unfoldAll";v[i+"I"]="findIncremental";v["Shift-"+i+"I"]="findIncrementalReverse";v[i+"H"]="replace";v.F3="findNext";v["Shift-F3"]="findPrev";p.normalizeKeyMap(v)});