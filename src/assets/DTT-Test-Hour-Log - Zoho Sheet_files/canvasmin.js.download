!function(t){var e=t.ZSClass||(t.ZSClass={}),i=e.Layer||(e.Layer={});(i.Interface||(i.Interface={})).implement=function(t,e){for(var i={},n=0;n<e.length;n++)e[n]&&e[n].prototype&&Object.assign(i,e[n].prototype);return Object.assign(i,t.prototype),i}}(this),function(t){function e(t,e,i){n.error("Layer: Implementation required")}var i=t.ZSClass||(t.ZSClass={}),n=t.ZSDevTools,o=i.Layer||(i.Layer={}),r=o.Interface||(o.Interface={});e.prototype={onMouseOver:function(){},onMouseLeave:function(){},onFocus:function(){},onBlur:function(){},onMove:function(t,e){},onMoveEnd:function(t,e){},onResize:function(t,e,i){},onResizeEnd:function(t,e,i){},getID:function(){},getController:function(){},onPlace:function(t,e,i,n){},onRemove:function(){},onLabelChange:function(t){},onShowLoader:function(){},onHideLoader:function(){}},r.Layer=e}(this),function(t){function e(t,e,i,o,r){n.error("RouterInterface: Implementation required")}var i=t.ZSClass,n=t.ZSDevTools,o=i.Layer||(i.Layer={}),r=o.Interface||(o.Interface={});e.prototype={onMouseOver:function(t){},onMouseLeave:function(t){},onFocus:function(t){},onBlur:function(t){},onMove:function(t,e,i){},onMoveEnd:function(t,e,i){},onResize:function(t,e,i,n){},onResizeEnd:function(t,e,i,n){},getID:function(t){},getController:function(t){},onPlace:function(t,e,i,n,o){},onRemove:function(t){},onRemoveAll:function(){},onLabelChange:function(t,e){},onShowLoader:function(t){},onHideLoader:function(t){}},r.Router=e}(this),function(t){function e(){s.error("ControlInterface: Implementation required")}function i(){s.error("ControllerInterface: Implementation required")}function n(){}function o(){}var r=t.ZSClass,s=t.console,h=r.Layer||(r.Layer={}),a=h.Interface||(h.Interface={});n.prototype={getInteracter:function(t,e,i,n){},updateBoundary:function(t,e,i){},mouseover:function(t){},mouseleave:function(t){},scrollIntoView:function(t){},focus:function(t){},blur:function(t){},focusAll:function(){},blurAll:function(){},move:function(t,e){},moveEnd:function(t,e){},resize:function(t,e){},resizeEnd:function(t,e){},place:function(t){},delete:function(t){},copy:function(t){},remove:function(t){},removeAll:function(){},clone:function(t,e){},setLabel:function(t,e){},assignMacro:function(t,e){},showLoader:function(t){},hideLoader:function(t){},executeScript:function(t){},onRender:function(t){},onLoad:function(t){}},o.prototype={updateBoundary:function(t,e,i){},onMouseOver:function(t){},onMouseLeave:function(t){},onScrollIntoView:function(t,e){},onFocus:function(t){},onBlur:function(t){},onFocusAll:function(){},onBlurAll:function(){},onMove:function(t){},onMoveEnd:function(t){},onResize:function(t){},onResizeEnd:function(t){},onPlace:function(t,e){},onRemove:function(t){},onShow:function(t,e){},onHide:function(t,e){},onDelete:function(t){},onCopy:function(t,e){},onClone:function(t){},onPlaceEdit:function(t,e){},onRemoveEdit:function(t,e){},onSubmitEdit:function(t,e){},onExecuteScript:function(t,e){},onLabelChange:function(t,e){},onAssignMacro:function(t,e,i){},onShowLoader:function(t){},onHideLoader:function(t){},onRender:function(t,e){},onCachedViewAttach:function(t,e){},onRefresh:function(t,e){},onLoad:function(t,e){},onZoom:function(t,e){},onUpdatePanelStatus:function(t,e){},onURLChange:function(t,e){},onResizeToOriginal:function(t,e){},onReplaceImage:function(t,e){}},e.prototype=a.implement(e,[o]),i.prototype=a.implement(i,[n,o]),a.Control=e,a.Controller=e}(this),function(t){function e(e,i,n,o){t.RectCnt++,this.set(e,i,n,o)}t.RectCnt=0,e.prototype={set:function(t,e,i,n){this.X=t,this.Y=e,this.width=i,this.height=n},addPaddingLeft:function(t){this.X+=t,this.width-=t,this.width=Math.max(0,this.width)},addPaddingTop:function(t){this.Y+=t,this.height-=t,this.height=Math.max(0,this.height)},addPaddingRight:function(t){this.width-=t,this.width=Math.max(0,this.width)},addPaddingBottom:function(t){this.height-=t,this.height=Math.max(0,this.height)},addPadding:function(t,e){this.addPaddingLeft(t),this.addPaddingRight(t),this.addPaddingTop(e),this.addPaddingBottom(e)},getX:function(){return this.X},getY:function(){return this.Y},getEndX:function(){return this.X+this.width},getEndY:function(){return this.Y+this.height},getWidth:function(){return this.width},getHeight:function(){return this.height},isXIntersects:function(t){return this.getX()<t&&t<this.getEndX()},isYIntersects:function(t){return this.getY()<t&&t<this.getEndY()},clone:function(){return new e(this.getX(),this.getY(),this.getWidth(),this.getHeight())}},t.Rect=e}(this),function(t){function e(t){this.words=[],this.init(t)}var i=t.ZSGrid||(t.ZSGrid={}),n=t.P=[];e.prototype={init:function(t){this.lineHeight=t;for(var e=this.words.length-1;e>=0;e--)this.words[e].destroy();this.words=[]},destroy:function(){this.init(),n.push(this)},createWord:function(){return new i.Word},addWord:function(t){this.words.push(t),this.lineHeight=Math.max(this.lineHeight,t.lineHeight)},isEmpty:function(){return!this.words.length},getWidth:function(){for(var t=0,e=0,i=this.words.length;e<i;e++)t+=this.words[e].getWidth();return t},getHeight:function(){return this.lineHeight},toString:function(){for(var t="",e=0,i=this.words.length;e<i;e++)t+=this.words[e];return t}},i.Line=function(t){return n.length?n.pop():new e(t)}}(this),function(t){function e(){this.init()}var i=t.ZSGrid||(t.ZSGrid={}),n=[];e.prototype={init:function(){this.lineHeight=0,this.width=0,this.content="",this.node=null},destroy:function(){this.init(),n.push(this)},setNode:function(t){this.node=t},applyStyle:function(t,e){this.node.applyStyle(t,e)},isUnderline:function(){return this.node.isUnderline()},isStrikeThrough:function(){return this.node.isStrikeThrough()},setContent:function(t){this.content=t},setWidth:function(t){this.width=t},setHeight:function(t){this.lineHeight=t},getWidth:function(){return this.width},getHeight:function(){return this.lineHeight},toString:function(){return this.content}},i.Word=function(){return n.length?n.pop():new e}}(this),function(t){function e(t,e,i,n,o,r,s,h,a){this.init(t,e,i,n,o,r,s,h,a)}var i=t.ZSGrid||(t.ZSGrid={}),n=[];e.prototype={init:function(t,e,i,n,o,r,s,h,a){this.content=t,this.bold=!!e,this.italic=!!i,this.underline=!!n,this.strikeThrough=!!o,this.color=r,this.fontname=a,this.fontsize=s,this.fontstyle=h},destroy:function(){this.init(),n.push(this)},applyStyle:function(t,e){t.font=(this.italic?"italic":"normal")+" "+(this.bold?"bold":"normal")+" "+this.fontsize*e+"pt "+this.fontname,t.fillStyle=this.color,t.strokeStyle=this.color},isUnderline:function(){return this.underline},isStrikeThrough:function(){return this.strikeThrough},getText:function(){return this.content},getHeight:function(){return i.getLineHeight(this.fontname,this.fontsize)},isEmpty:function(){return""===this.content},getStyle:function(){return this.style}},i.TextNode=e}(this),function(t){function e(t,e,i,n,o,r,s,h,a,c){this.init(t,e,i,n,o,r,s,h,a,c),this.BackGroundStack=[],this.ForeGroundStack=[],this.defaultHeight=20}var i=t.ZSGrid||(t.ZSGrid={}),n=[];e.prototype={init:function(t,e,i,n,o,r,s,h,a,c){this.index=t,this.valign=e,this.halign=i,this.borderLeft=n,this.borderRight=o,this.borderTop=r,this.borderBottom=s,this.bgColor=h,this.wrap=a,this.calculated=!1,this.deg=c},destroy:function(){this.init(),n.push(this)},getLine:function(){return new Line},isWrap:function(){return this.wrap},getBorderBottom:function(){return this.borderBottom},getBorderRight:function(){return this.borderRight},getBorderTop:function(){return this.borderTop},getBorderLeft:function(){return this.borderLeft},getBackground:function(){return this.bgColor},getData:function(){return this.Data},getIcon:function(){return this.icon},getVerticalAlignment:function(){return this.valign},getHorizontalAlignment:function(){return this.halign},setPrev:function(t){this.prev=t},getPaddingLeft:function(){return 2},getPaddingRight:function(){return 2},getPaddingTop:function(){return 0},getPaddingBottom:function(){return 0},getWidth:function(){for(var t=0,e=0;e<this.ForeGroundStack.length;e++){var i=this.ForeGroundStack[e];t<i.getWidth()&&(t=i.getWidth())}return t},hasContent:function(){for(var t=0;t<this.ForeGroundStack.length;t++){if(this.ForeGroundStack[t].hasContent())return!0}return!1},addInBackGroundStack:function(t){this.BackGroundStack.push(t)},addInForeGroundStack:function(t){this.ForeGroundStack.push(t)},render:function(t,e){e.addPaddingLeft(t.getZoom()*this.getPaddingLeft()),e.addPaddingRight(t.getZoom()*this.getPaddingRight()),e.addPaddingTop(t.getZoom()*this.getPaddingTop()),e.addPaddingBottom(t.getZoom()*this.getPaddingBottom());for(var i=0;i<this.ForeGroundStack.length;i++){this.ForeGroundStack[i].render(t,this,e)}},renderCell:function(t,e){t.drawBackground(this.getBackground(),e);for(var i=0;i<this.BackGroundStack.length;i++){this.BackGroundStack[i].render(t,this,e)}}},i.Cell=e}(this),function(t){function e(e,i,n){return(t.devicePixelRatio||1)>1?f(e,i,n):i>=3?n>1?1.5:1:e>=3?n>1?2.5:2:1==e&&i>0?n>1?3:2:n>1?2:1}function i(e,i,n){return(t.devicePixelRatio||1)>1?f(e,i,n):e>=3?n>1?3:2:1==e&&i>0?n>1?2:1.5:n>1?2.5:1.5}function n(e,i,n){return(t.devicePixelRatio||1)>1?p(e,i,n):e>=3?0:1==e?1:0==e&&i>0?1.5:n>1?3:0}function o(e,i,n){return(t.devicePixelRatio||1)>1?p(e,i,n):e>=3?n>1?2:0:1==e?2:0==e&&i>0?1.5:n>1?3:2}function r(e,i,n){return(t.devicePixelRatio||1)>1?p(e,i,n):e>=3?0:1==e&&i>0?1.5:2}function s(e,i,n){return(t.devicePixelRatio||1)>1?p(e,i,n):e>=3?1:1==e&&i>0?1.5:2.5}function h(e,i){return(t.devicePixelRatio||1)>1?u(e,i):e>=3?0:1==e&&i>0?1.5:2}function a(e,i){return(t.devicePixelRatio||1)>1?u(e,i):e>=3?1:1==e&&i>0?1.5:2.5}function c(e,i){return(t.devicePixelRatio||1)>1?v(e,i):e>=3?0:0===e&&0===i?1.5:3===i?0:.5}function l(e,i){return(t.devicePixelRatio||1)>1?v(e,i):e>=3?0:0===e&&0===i?1.5:3===i?0:1}function d(e,i){return(t.devicePixelRatio||1)>1?x(e,i):e>=3?0:0===e&&0===i?1.5:3===i?0:1}function g(e,i){return(t.devicePixelRatio||1)>1?x(e,i):e>=3?-.5:0===e&&0===i?1:3===i?-1:0}function u(t,e){return t>=3?1:1==t&&e>0?1.5:2}function f(t,e,i){return t>=3?i>1?3:2:1==t&&e>0?1.5:i>1?3:2}function p(t,e,i){return t>=3?0:1==t?1:0==t&&e>0?1.5:i>1?3:2}function v(t,e){return t>=3?0:0===t&&0===e?1.5:3===e?0:1}function x(t,e){return t>=3?-.5:0===t&&0===e?1.5:1}function m(t,e,i){return e>1&&i>1?t*(e%1):0}function S(t,e){this.context=t,this.rect=e,this.setBoundary(0,0,this.getWidth(),this.getHeight()),this.context.strokeRect(this.getX(),this.getY(),this.getWidth(),this.getHeight())}var C=(t.ZSGrid||(t.ZSGrid={}),t.ZSClass||(t.ZSClass={})),y=(t.Canvas||(t.Canvas={}),{Vertical:{TOP:0,MIDDLE:1,BOTTOM:2},Horizontal:{LEFT:0,CENTER:1,RIGHT:2}});S.prototype={drawLine:function(e,i,n,o){(t.devicePixelRatio||1)<=1&&(e=Math.floor(e)+.5,i=Math.floor(i)+.5,n=Math.floor(n)+.5,o=Math.floor(o)+.5),this.context.beginPath(),this.context.moveTo(e,i),this.context.lineTo(n,o),this.context.stroke()},drawCircle:function(t,e,i,n){this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI,!1),this.context.fillStyle=n,this.context.fill(),this.context.closePath()},strokeCircle:function(t,e,i,n){this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI,!1),this.context.strokeStyle=n,this.context.stroke(),this.context.closePath()},drawTriangle:function(t,e,i,n,o,r,s){this.context.beginPath(),this.context.fillStyle=s,this.context.moveTo(t,e),this.context.lineTo(i,n),this.context.lineTo(o,r),this.context.closePath(),this.context.fill()},drawRectangle:function(t,e){this.drawBackground(e,t)},drawBackground:function(t,e){this.context.fillStyle=t,this.context.fillRect(e.getX(),e.getY(),e.getWidth(),e.getHeight())},drawBorderBottom:function(n,o,r){r||(r=[3,3,3,3,3,3]);var s=this.rect.getFlip(),c=t.devicePixelRatio||1,l=r[0],d=r[1],g=r[2],u=r[3],f=r[4],p=r[5],v=n[0];this.context.fillStyle=n[2],this.context.strokeStyle=n[2];var x,S,C=h,y=a;if("double"==n[1]){var w=1.5;x=s?C(l,d):C(p,f),S=s?y(p,f):y(l,d);var R=this.rect.getZoom();if(c<=1)S-=m(S,R,v);if(X=o.getEndY()-v/3,T=o.getX()+w-x,H=o.getEndX()-w+S,this.drawLine(T,X,H,X),x=s?C(g,d):C(u,f),S=s?y(u,f):y(g,d),c<=1)S-=m(S,R,v);X=o.getEndY()+v/3,T=o.getX()+w-x,H=o.getEndX()-w+S,this.drawLine(T,X,H,X)}else{C=e,y=i;switch(n[1]){case"dotted":this.context.setLineDash([1,1]);break;case"dashed":this.context.setLineDash([3,2]);break;default:this.context.setLineDash([])}this.context.lineWidth=v;w=1.5;x=s?C(Math.max(l,g),d,v):C(Math.max(p,u),f,v),S=s?y(Math.max(p,u),f,v):y(Math.max(l,g),d,v);R=this.rect.getZoom();if(c<=1)S-=m(S,R,v);var X=o.getEndY(),T=o.getX()+w-x,H=o.getEndX()-w+S;this.drawLine(T,X,H,X),this.context.setLineDash([]),this.context.lineWidth=1}},drawBorderRight:function(e,i,h){var a=this.rect.getFlip(),c=t.devicePixelRatio||1;h||(h=[0,0,0,0,0,0]);var l=h[0],d=h[1],g=h[2],u=h[3],f=h[4],p=h[5],v=e[0];this.context.strokeWidth=v,this.context.strokeStyle=e[2];var x,S,C,y,w,R=r,X=s;if("double"==e[1]){var T=v/2,H=1.5;x=R(a?g:l,d,v),S=X(a?u:p,f,v),C=a?i.getX()-v/3:i.getEndX()-v/3;var L=this.rect.getZoom();if(c<=1)S-=m(S,L,v);if(y=i.getY()+H-x,w=i.getEndY()-H+S,this.drawLine(C,y,C,w),x=R(a?l:g,d,v),S=X(a?p:u,f,v),C=a?i.getX()+v/3:i.getEndX()+v/3,c<=1)S-=m(S,L,v);y=i.getY()+H-x,w=i.getEndY()-H+S,this.drawLine(C,y,C,w)}else{switch(e[1]){case"dotted":this.context.setLineDash([1,1]);break;case"dashed":this.context.setLineDash([3,2]);break;default:this.context.setLineDash([])}this.context.lineWidth=v;T=v/2,H=1.5;T=0;X=o;x=(R=n)(a?Math.max(g,l):Math.max(l,g),d,v),S=X(a?Math.max(u,p):Math.max(p,u),f,v),C=a?i.getX()-T:i.getEndX()-T,y=i.getY()+H-x,w=i.getEndY()-H+S,this.drawLine(C,y,C,w),this.context.setLineDash([]),this.context.lineWidth=1}},drawRightGridLine:function(t,e){var i=this.rect.getFlip(),n=[1,"solid","#d5d5d5"];e||(e=[0,0,0,0,0,0]);var o=e[0],r=e[1],s=e[2],h=e[3],a=e[4],d=e[5],g=n[0];this.context.strokeWidth=1,this.context.strokeStyle=n[2];var u=c,f=l;this.context.lineWidth=g;var p,v,x,m,S;p=u(i?Math.max(s,o):Math.max(o,s),r),v=f(i?Math.max(h,d):Math.max(d,h),a),x=i?t.getX()+0:t.getEndX()-0,m=t.getY()+1.5-p,S=t.getEndY()-1.5+v,this.drawLine(x,m,x,S),this.context.setLineDash([])},drawBottomGridLine:function(t,e){var i=[1,"solid","#DDD"],n=this.rect.getFlip();e||(e=[3,3,3,3,3,3]);var o=e[0],r=e[1],s=e[2],h=e[3],a=e[4],c=e[5],l=i[0];this.context.strokeStyle=i[2];var u=g,f=d;this.context.lineWidth=l;var p,v,x,m,S;p=n?u(Math.max(o,s),r):u(Math.max(c,h),a),v=n?f(Math.max(h,c),a):f(Math.max(o,s),r),x=t.getEndY(),m=t.getX()+1.5-p,S=t.getEndX()-1.5+v,this.drawLine(m,x,S,x),this.context.lineWidth=1},drawIcon:function(e,i,n,o){var r,s,h=e[0],a=e[1],c=e[2]*this.getZoom(),l=t.IconSets[h][a];switch(this.context.font=c+"px icons2",n){case y.Horizontal.LEFT:r=i.getX();break;case y.Horizontal.CENTER:r=i.getX()+(i.getWidth()-c)/2;break;case y.Horizontal.RIGHT:r=i.getX()+(i.getWidth()-c)}switch(o){case y.Vertical.TOP:s=i.getY(),this.context.textBaseline="alphabetic";break;case y.Vertical.MIDDLE:s=i.getY()+(i.getHeight()-c)/2,this.context.textBaseline="bottom";break;case y.Vertical.BOTTOM:s=i.getY()+(i.getHeight()-c),this.context.textBaseline="bottom"}for(var d in l){var g=l[d],u=g[0],f=g[1],p=g[2];this.context.strokeStyle=p,this.context.fillStyle=f,this.context.lineWidth=.5,this.context.fillText(u,r,s+c),this.context.strokeText(u,r,s+c)}},clearAll:function(){this.clear(this.getX(),this.getY(),this.getWidth(),this.getHeight())},clear:function(t,e,i,n){this.context.clearRect(t,e,i,n)},setBoundary:function(t,e,i,n){},getZoom:function(){return this.rect.getZoom()},getScrollLeft:function(){return this.rect.getScrollX()/this.rect.getScaleX()},setScrollLeft:function(t){},getScrollTop:function(){return this.rect.getScrollY()/this.rect.getScaleY()},setScrollTop:function(t){},translateX:function(t,e){if(this.rect.getFlip()){var i=this.getWidth()-e;return this.rect.getX()+i-(t-this.rect.getScrollX()/this.rect.getScaleX())*this.rect.getScaleX()}return this.rect.getX()+(t-this.rect.getScrollX()/this.rect.getScaleX())*this.rect.getScaleX()},translateY:function(t){return this.rect.getY()+(t-this.rect.getScrollY()/this.rect.getScaleY())*this.rect.getScaleY()},translateWidth:function(t){return t*this.rect.getScaleX()},translateHeight:function(t){return t*this.rect.getScaleY()},getX:function(){return this.rect.getX()},getY:function(){return this.rect.getY()},getHeight:function(){return this.rect.getHeight()},getWidth:function(){return this.rect.getWidth()},isXIntersects:function(t){return this.rect.isXIntersects(t/this.getZoom())},isYIntersects:function(t){return this.rect.isYIntersects(t/this.getZoom())},render:function(t,e,i,n,o){this.rect.getFlip(),n||(n=[]);var r=this.context,s=t.getX(),h=t.getY();switch(r.fillStyle="black",r.textBaseline="bottom",e){case y.Vertical.TOP:break;case y.Vertical.MIDDLE:h+=t.height/2;for(var a=0;a<n.length;a++){if((h-=(l=n[a]).getHeight()*o/2)<t.getY()){h=t.getY();break}}break;case y.Vertical.BOTTOM:h+=t.height;for(a=0;a<n.length;a++){if((h-=(l=n[a]).getHeight()*o)<t.getY()){h=t.getY();break}}}for(var c=0;c<n.length;c++){var l=n[c];switch(i){case y.Horizontal.LEFT:break;case y.Horizontal.CENTER:s+=(t.getWidth()-l.getWidth()*o)/2;break;case y.Horizontal.RIGHT:s+=t.getWidth()-l.getWidth()*o}h+=l.getHeight()*o;var d=l.words;for(a=0;a<d.length;a++){var g=d[a];if(g.applyStyle(r,o),"\t"!=g.content){if(r.fillText(g.content,s,h),g.isUnderline()){var u=g.getHeight()*o*.06,f="alphabetic"==r.textBaseline?h+u:h-u;r.lineWidth=u,r.beginPath(),r.moveTo(s,f),r.lineTo(s+g.getWidth()*o,f),r.stroke()}if(g.isStrikeThrough()){var p=g.getHeight()*o*.06,v="alphabetic"==r.textBaseline?h-g.lineHeight*o/4:h-g.lineHeight*o/2.5;r.lineWidth=p,r.beginPath(),r.moveTo(s,v),r.lineTo(s+g.getWidth()*o,v),r.stroke()}s+=g.getWidth()*o}else{var x=.09*o,m=r.measureText(" ").width,S=Math.floor(8*m),C=Math.ceil(s+S-t.getX())/S+x,w=parseFloat(C.toFixed(2));s=Math.floor(w)*S+t.getX()}}if(s=t.getX(),h>t.getY()+t.getHeight())break}}},C.UICanvas=S}(this),function(t){function e(t){var e=t&&t.bottom?t.bottom[0]:0;return t&&t.bottom&&"transparent"===t.bottom[2]?0:t&&t.bottom===c?0:e}function i(t){var e=t&&t.right?t.right[0]:0;return t&&t.right&&"transparent"===t.right[2]?0:t&&t.right===c?0:e}function n(e,i,n){var o={rect1:{},rect2:{},cutRect:{},pasteRect:{}},r=e.getScrollLeft(),s=e.getScrollTop(),h=r,a=s,c=r+e.getWidth()/e.rect.getScaleX(),l=s+e.getHeight()/e.rect.getScaleY(),d=Math.ceil(t.devicePixelRatio||2),g=e.getX(),u=e.getY(),f=e.getWidth(),p=e.getHeight(),v=e.rect.getScaleX(),x=e.rect.getScaleY();return o.cutRect.y=Math.floor(u*d),o.pasteRect.y=Math.floor(u*d),o.cutRect.height=Math.ceil(p*d),o.cutRect.x=Math.floor(g*d),o.pasteRect.x=Math.floor(g*d),o.cutRect.width=Math.ceil(f*d),i>=0?(o.cutRect.x=Math.floor((g+i)*d),o.cutRect.width=Math.ceil((f-i)*d)):(o.pasteRect.x=Math.floor((g+Math.abs(i))*d),o.cutRect.width=Math.ceil((f-Math.abs(i))*d)),n>=0?(o.cutRect.y=Math.floor((u+n)*d),o.cutRect.height=Math.ceil((p-n)*d)):(o.pasteRect.y=Math.floor((u+Math.abs(n))*d),o.cutRect.height=Math.ceil((p-Math.abs(n))*d)),i/=v,n/=x,o.rect1.startY=Math.floor(a),o.rect1.endY=Math.ceil(l),i>=0?(o.rect1.startX=Math.floor(c-i),o.rect1.endX=Math.ceil(c)):(o.rect1.startX=Math.floor(h),o.rect1.endX=Math.ceil(h+-1*i)),o.rect2.startX=Math.floor(h),o.rect2.endX=Math.ceil(c),n>=0?(o.rect2.startY=Math.floor(l-n),o.rect2.endY=Math.ceil(l)):(o.rect2.startY=Math.floor(a),o.rect2.endY=Math.ceil(a+-1*n)),o}function o(t){this.grid=t,this.row=Object.create(null),this.inActive=[],this.iHave={start:null,end:null}}var r=t.ZSClass||(t.ZSClass={}),s=t.ZSGrid||(t.ZSGrid={}),h=(r.Canvas,t.Content,new Rect),a={LEFT:0,CENTER:1,RIGHT:2},c={};o.prototype={fill:function(t){var e=this.grid;e.context.save(),e.context.beginPath(),e.context.rect(e.getX(),e.getY(),e.getWidth(),e.getHeight()),e.context.clip(),this.load(t,this.iHave.start,this.iHave.startCol,this.iHave.end,this.iHave.endCol),e.context.restore()},scroll:function(t,e,i){var o=this.grid,r=this.getScrollLeft(),s=this.getScrollTop(),h=r,a=s,c=r+o.getWidth()/o.rect.getScaleX(),l=s+o.getHeight()/o.rect.getScaleY(),d=t.findCol(h),g=t.findCol(c),u=t.findRow(a),f=t.findRow(l);this.iHave.start=u,this.iHave.end=f,this.iHave.startCol=d,this.iHave.endCol=g,o.context.save(),o.context.beginPath(),o.context.rect(o.getX(),o.getY(),o.getWidth(),o.getHeight()),o.context.clip();var p=n(o,e,i);if(p.cutRect.width>0&&p.cutRect.height>0){var v=o.context.getImageData(p.cutRect.x,p.cutRect.y,p.cutRect.width,p.cutRect.height);o.context.putImageData(v,p.pasteRect.x,p.pasteRect.y)}this.fillRect(t,p.rect1.startX,p.rect1.startY,p.rect1.endX,p.rect1.endY),this.fillRect(t,p.rect2.startX,p.rect2.startY,p.rect2.endX,p.rect2.endY),o.context.restore()},fillRect:function(t,e,i,n,o){if(!(e>=n||i>=o)){var r=this.grid;r.context.save(),r.context.beginPath();var s=t.findCol(e),h=t.findCol(n),a=t.findRow(i),c=t.findRow(o);r.clear(r.translateX(e),r.translateY(i),r.translateWidth(n-e),r.translateHeight(o-i)),this.load(t,a,s,c,h),r.context.restore()}},isInViewPort:function(t,e,i,n){var o=this.iHave;return t>=o.start&&i<=o.end&&e>=o.startCol&&n<=o.endCol},del:function(t,e,i){for(var n=e;n<i;n++)this.row[n]&&(this.inActive.push(this.row[n]),this.row[n].destroy(),delete this.row[n])},reload:function(t){this.del(t,this.iHave.start,this.iHave.end),this.fill(t)},renderMergedCell:function(t,e,i,n,o){var r=this.grid,s=t.getColX(i),a=t.getRowY(e),c=t.getColX(o+1)-s,l=t.getRowY(n+1)-a;c=r.translateWidth(c),l=r.translateHeight(l);var d=r.translateX(s,c),g=r.translateY(a),u=this.getCell(t,e,i);h.set(d,g,c,l),u.renderCell(r,h),r.context.save(),r.context.beginPath(),r.context.rect(d,g,c,l),r.context.clip(),u.render(r,h),r.context.restore()},load:function(t,n,o,r,s){var a,l,d,g,u,f,p,v,x,m,S,C,y,w,R,X,T=this.grid,H=T.rect.getFlip(),L=t.isHideGrid()?null:c,Y={},W={},P={},M={},b=[];for(R=null,u="FIRSTROW",y=T.translateY(t.getRowY(n)),d=n,g=o;g<=s;g=t.getNextNonHiddenCol(g)){var B=this.getCell(t,d,g);P[g]={},P[g].bottom=B.getBorderTop()||L}for(;d<=r;d=t.getNextNonHiddenRow(d)){l=t.getRowY(d),x=T.translateY(l),S=t.getRowHeight(d),S=T.translateHeight(S),g=o,a=t.getColX(g),W=P,P=M,M={},X=b,b=[],p=null,f="FIRSTCOL",w=T.translateWidth(t.getColWidth(o)),C=T.translateX(t.getColX(o),w),g=o;var N=null,F=!1,Z=0;-1!==(N=t.getPrevContentIndex(d,g))?F=!t.getMergeInfo(d,N):N=null,F=F&&null!==N;for(var G=X.shift();g<=s;g=t.getNextNonHiddenCol(g)){a=t.getColX(g),m=t.getColWidth(g),m=T.translateWidth(m),v=T.translateX(a,m);B=this.getCell(t,d,g);var I=t.getMergeInfo(d,g);if(I){var A=I.range;if(!Y[256*A[0]+A[1]]){Y[256*A[0]+A[1]]=[t.getNextNonHiddenRow(t.getPrevNonHiddenRow(A[0])),t.getNextNonHiddenCol(t.getPrevNonHiddenCol(A[1])),t.getPrevNonHiddenRow(t.getNextNonHiddenRow(A[2])),t.getPrevNonHiddenCol(t.getNextNonHiddenCol(A[3]))];var k=A[0],E=A[1],z=A[2],D=A[3];this.renderMergedCell(t,k,E,z,D)}}else h.set(v,x,m,S),B.renderCell(T,h);if((!I||I&&Y[256*I.range[0]+I.range[1]][3]===g)&&(M[g]||(M[g]={}),M[g].right&&M[g].right!==L||(M[g].right=B.getBorderRight()||L)),(!I||I&&Y[256*I.range[0]+I.range[1]][2]===d)&&(M[g]||(M[g]={}),M[g].bottom&&M[g].bottom!==L||(M[g].bottom=B.getBorderBottom()||L)),B.getBorderLeft()&&("transparent"!==B.getBorderLeft()[2]||M[f]&&M[f].right===L)&&null!==f&&(!I||I&&Y[256*I.range[0]+I.range[1]][1]===g)&&(M[f]||(M[f]={}),M[f].right&&M[f].right!==L&&"transparent"!==M[f].right[2]||(M[f].right=B.getBorderLeft())),"FIRSTCOL"===f&&(!I||I&&Y[256*I.range[0]+I.range[1]][1]===g)&&(M[f]||(M[f]={}),M[f].right&&M[f].right!==L&&"transparent"!==M[f].right[2]||(M[f].right=B.getBorderLeft()||L)),B.getBorderTop()&&("transparent"!==B.getBorderTop()[2]||P[g]&&P[g].bottom===L)&&null!==u&&(!I||I&&Y[256*I.range[0]+I.range[1]][0]===d)&&(P[g]||(P[g]={}),P[g].bottom&&P[g].bottom!==L&&"transparent"!==P[g].bottom[2]||(P[g].bottom=B.getBorderTop())),P[f]){var O=!1;if(G){var V=G[0],U=G[1];H?C-w<U&&(this.renderCll(t,G[0],G[1],G[2],u,y,R),G=X.shift()):C+w>=U&&(this.renderCll(t,G[0],G[1],G[2],u,y,R),G=X.shift()),U=U.toFixed(2),V=V.toFixed(2),C=C.toFixed(2),w=w.toFixed(2),U=parseFloat(U),V=parseFloat(V);var q=((C=parseFloat(C))+(w=parseFloat(w))).toFixed(2);q=parseFloat(q),O=H?V>C&&C>U:V<q&&q<U}if("FIRSTCOL"===f)if(h.set(C,y,0,R),et=P[f]&&P[f].right){var j=null,J=null,K=e(W[g]),Q=e(P[g]),$=i(M[f]),_=null;et&&et!=L?!O&&T.drawBorderRight(et,h,[j,J,K,Q,$,_]):!O&&T.drawRightGridLine(h,[j,J,K,Q,$,_])}if("FIRSTCOL"!==f){if(h.set(C,y,w,R),et=P[f].right){j=e(W[f]),J=i(W[f]),K=e(W[g]),Q=e(P[g]),$=i(M[f]),_=e(P[f]);et&&et!=L?!O&&T.drawBorderRight(et,h,[j,J,K,Q,$,_]):!O&&T.drawRightGridLine(h,[j,J,K,Q,$,_])}if("FIRSTROW"!==u)if(h.set(C,y,w,R),et=P[f].bottom){j=i(P[f]),J=e(P[g]),K=i(M[f]),Q=i(M[p]),$=e(P[p]),_=i(P[p]);et&&et!=L?T.drawBorderBottom(et,h,[j,J,K,Q,$,_]):T.drawBottomGridLine(h,[j,J,K,Q,$,_])}}}if("FIRSTROW"===u&&"FIRSTCOL"!==f)if(h.set(C,y,w,0),et=W[f]&&W[f].bottom){j=null,J=e(W[f]),K=i(M[f]),Q=i(M[p]),$=e(P[p]),_=null;et&&et!=L?T.drawBorderBottom(et,h,[j,J,K,Q,$,_]):T.drawBottomGridLine(h,[j,J,K,Q,$,_])}if(B.hasContent()||I){if(F){var tt=t.getColX(g);Z=this.renderCell(t,N,d,Z,tt,x,S,b)}F=!0,I&&(Z=t.getColX(t.getNextNonHiddenCol(g)),F=!1),N=g}p=f,f=g,C=v,w=m}if(F){tt=t.getColX(g);Z=this.renderCell(t,N,d,Z,tt,x,S,b)}tt=t.getColX(g);if(g=t.getNextContentIndex(d,N),t.getMergeInfo(d,g)||(Z=this.renderCell(t,g,d,Z,tt,x,S,b)),"FIRSTROW"===u)if(h.set(C,y,w,0),et=W[f]&&W[f].bottom){j=null,J=e(W[f]),K=i(M[f]),Q=i(M[p]),$=e(P[p]),_=null;et&&et!=L?T.drawBorderBottom(et,h,[j,J,K,Q,$,_]):T.drawBottomGridLine(h,[j,J,K,Q,$,_])}if(P[f]){if(h.set(C,y,w,R),et=P[f].right){j=e(W[f]),J=i(W[f]),K=e(W[g]),Q=e(P[g]),$=i(M[f]),_=e(P[f]);et&&et!=L?T.drawBorderRight(et,h,[j,J,K,Q,$,_]):T.drawRightGridLine(h,[j,J,K,Q,$,_])}if("FIRSTROW"!==u)if(et=P[f].bottom){j=i(P[f]),J=e(P[g]),K=i(M[f]),Q=i(M[p]),$=e(P[p]),_=i(P[p]);et&&et!=L?T.drawBorderBottom(et,h,[j,J,K,Q,$,_]):T.drawBottomGridLine(h,[j,J,K,Q,$,_])}}for(G&&this.renderCll(t,G[0],G[1],G[2],u,y,R);X.length;)G=X.shift(),this.renderCll(t,G[0],G[1],G[2],u,y,R);u=d,y=x,R=S}W=P,P=M,M={},p=null,f="FIRSTCOL",w=T.translateWidth(t.getColWidth(o)),C=T.translateX(t.getColX(o),w),g=o;for(G=(X=b).shift();g<=s;g=t.getNextNonHiddenCol(g)){a=t.getColX(g),m=t.getColWidth(g),m=T.translateWidth(m),v=T.translateX(a,m);B=this.getCell(t,d,g);if("FIRSTCOL"===f)if(h.set(C,y,0,R),et=P[f]&&P[f].right){j=null,J=null,K=e(W[g]),Q=e(P[g]),$=i(M[f]),_=null;et&&et!=L?!O&&T.drawBorderRight(et,h,[j,J,K,Q,$,_]):!O&&T.drawRightGridLine(h,[j,J,K,Q,$,_])}if(P[f]&&"FIRSTCOL"!==f){O=!1;if(G){V=G[0],U=G[1];H?C-w<U&&(this.renderCll(t,G[0],G[1],G[2],u,y,R),G=X.shift()):C+w>=U&&(this.renderCll(t,G[0],G[1],G[2],u,y,R),G=X.shift()),U=U.toFixed(2),V=V.toFixed(2),C=C.toFixed(2),w=w.toFixed(2),U=parseFloat(U),V=parseFloat(V);q=((C=parseFloat(C))+(w=parseFloat(w))).toFixed(2);q=parseFloat(q),O=H?V>C&&C>U:V<q&&q<U}if(h.set(C,y,w,R),et=P[f].right){j=e(W[f]),J=i(W[f]),K=e(W[g]),Q=e(P[g]),$=i(M[f]),_=e(P[f]);et&&et!=L?!O&&T.drawBorderRight(et,h,[j,J,K,Q,$,_]):!O&&T.drawRightGridLine(h,[j,J,K,Q,$,_])}if(et=P[f].bottom){j=i(P[f]),J=e(P[g]),K=i(M[f]),Q=i(M[p]),$=e(P[p]),_=i(P[p]);et&&et!=L?T.drawBorderBottom(et,h,[j,J,K,Q,$,_]):T.drawBottomGridLine(h,[j,J,K,Q,$,_])}}p=f,f=g,C=v,w=m}if(P[f]){var et;if(h.set(C,y,w,R),et=P[f].right){j=e(W[f]),J=i(W[f]),K=e(W[g]),Q=e(P[g]),$=i(M[f]),_=e(P[f]);et&&et!=L?T.drawBorderRight(et,h,[j,J,K,Q,$,_]):T.drawRightGridLine(h,[j,J,K,Q,$,_])}if(et=P[f].bottom){j=i(P[f]),J=e(P[g]),K=i(M[f]),Q=i(M[p]),$=e(P[p]),_=i(P[p]);et&&et!=L?T.drawBorderBottom(et,h,[j,J,K,Q,$,_]):T.drawBottomGridLine(h,[j,J,K,Q,$,_])}}for(G&&this.renderCll(t,G[0],G[1],G[2],u,y,R);X.length;)G=X.shift(),this.renderCll(t,G[0],G[1],G[2],u,y,R)},renderCll:function(t,e,i,n,o,r,s){var a=this.grid,c=this.getCell(t,o,n);a.context.save(),a.context.beginPath(),a.context.rect(e,r,i-e,s),a.context.clip();var l=t.getColX(n),d=t.getColWidth(n);d=a.translateWidth(d);var g=a.translateX(l,d);h.set(g,r,d,s-1),c.render(a,h),a.context.restore()},renderCell:function(t,e,i,n,o,r,s,h){var c=this.grid,l=c.rect.getFlip(),d=this.getCell(t,i,e),g=t.getColX(e),u=t.getColWidth(e),f=g,p=g,v=d.getHorizontalAlignment();if(l)switch(v){case a.RIGHT:p=(f=g+d.getPaddingLeft())+d.getWidth();break;case a.CENTER:f=g+u/2-d.getWidth()/2,p=g+u/2+d.getWidth()/2;break;case a.LEFT:f=g+u-d.getPaddingRight()-d.getWidth(),p=g+u-d.getPaddingRight()}else switch(v){case a.LEFT:p=(f=g+d.getPaddingLeft())+d.getWidth();break;case a.CENTER:f=g+u/2-d.getWidth()/2,p=g+u/2+d.getWidth()/2;break;case a.RIGHT:f=g+u-d.getPaddingRight()-d.getWidth(),p=g+u-d.getPaddingRight()}var x=t.getColX(t.findCol(f)),m=t.getColX(t.findCol(p)+1),S=(x=x<n?n:x,m=o<m?o:m,c.translateX(x,0)),C=c.translateX(m,0);return h.push([S,C,e,i,C-S]),m},setBoundary:function(t,e,i,n,o){this.grid.setBoundary(e,i,n,o)},getCell:function(t,e,i){return t.getCell(e,i)},getRow:function(e,i){if(!this.row[i]){if(this.inActive.length)this.row[i]=this.inActive.pop();else{var n=new t.Row(i,255);this.row[i]=n}this.row[i].load(i,e)}return this.row[i]},clear:function(t){this.grid.clearAll(t)},getScrollLeft:function(t){return this.grid.getScrollLeft()},getScrollTop:function(t){return this.grid.getScrollTop()},updateScroll:function(t,e){this.refresh(t,e)},onBeforeFill:function(t){var e=this.grid,i=this.getScrollLeft(),n=this.getScrollTop(),o=i,r=n,s=i+e.getWidth()/e.rect.getScaleX(),h=n+e.getHeight()/e.rect.getScaleY(),a=t.findCol(o),c=t.findCol(s),l=t.findRow(r),d=t.findRow(h);this.iHave.start=t.getNextNonHiddenRow(l-1),this.iHave.end=t.getPrevNonHiddenRow(d+1),this.iHave.startCol=t.getNextNonHiddenCol(a-1),this.iHave.endCol=t.getPrevNonHiddenCol(c+1)},refresh:function(t,e){this.clear(t),this.fill(t),e&&e()}},s.Pane=o}(this),function(t){function e(t,e){var n=document.createElement("div");n.className="pane";var o=document.createElement("div");o.className="scroller",n.appendChild(o),this.container=n,this.scroller=o,this.rect=t,this.grid=new i.Pane(e),this.Layers=[]}var i=t.ZSGrid||(t.ZSGrid={});e.prototype={appendTo:function(t){t.appendChild(this.container)},getRelativeCoordinates:function(t,e){return{x:this.rect.getFlip()?(this.rect.getWidth()+this.rect.getScrollX()+this.rect.getX()-t)/this.rect.getScaleX():(t-this.rect.getX()+this.rect.getScrollX())/this.rect.getScaleX(),y:(e-this.rect.getY()+this.rect.getScrollY())/this.rect.getScaleY()}},isInViewPort:function(t,e,i,n){return this.grid.isInViewPort(t,e,i,n)},updateBoundary:function(t){var e=this.container.style,i=this.rect;e.left=i.getX()+"px",e.top=i.getY()+"px",e.width=i.getWidth()+"px",e.height=i.getHeight()+"px"},scroll:function(t,e,i){this.grid.scroll(t,e,i),this.container.scrollLeft=this.rect.getScrollX(),this.container.scrollTop=this.rect.getScrollY()},updateScroll:function(t,e){this.grid.updateScroll(t,e),this.container.scrollLeft=this.rect.getTranslateScrollX(this.rect.getScrollX()),this.container.scrollTop=this.rect.getScrollY()},onBeforeFill:function(t){this.grid.onBeforeFill(t)},setContentDimension:function(t){var e=this.scroller.style,i=this.rect;e.width=i.getContentWidth()+"px",e.height=i.getContentHeight()+"px"},addLayer:function(t,e){var i=t.createView(this.scroller,e);this.Layers.push(i),i.attach()},refresh:function(t){this.grid.refresh(t)},reload:function(t){this.grid.reload(t)},getZoom:function(){return this.rect.getZoom()}},i.UIPane=e}(this),function(t){function e(t,e){this.X=0,this.width=0,this.scrollX=0,this.CX=0,this.CWidth=0,this.set(t,e),this.scaleX=1,this.flip=0}function i(t,e){this.Y=0,this.height=0,this.scrollY=0,this.CY=0,this.CHeight=0,this.set(t,e),this.scaleY=1}function n(t,e){this.xAxle=t,this.yAxle=e}function o(e,i,n){var o=t.devicePixelRatio||1,r=Math.ceil(Math.max(t.devicePixelRatio,o));if(!(e.width>=i*r&&e.height>=n*r)){var s=e.getContext("2d");e.width=i*r,e.height=n*r,e.style.width=i+"px",e.style.height=n+"px",s.scale(r,r)}}function r(t,e,i){this.container=e,this.canvas=t,this.root=i,this.Matrix=[new Array],this.panes=[]}t.ZSGrid,e.prototype={set:function(t,e){this.X=t,this.width=e},getX:function(){return this.X},getEndX:function(){return this.X+this.width},getScaleX:function(){return this.scaleX},setScaleX:function(t){this.scaleX=t},getWidth:function(){return this.width},isXIntersects:function(t){return this.getX()<=t&&t<=this.getEndX()},setContentViewPort:function(t,e){this.CX=t,this.CWidth=e,this.setScrollX(this.getScrollX())},getContentX:function(){return this.CX},getContentWidth:function(){return this.CWidth},getScrollX:function(){return this.scrollX},setScrollX:function(t){t=Math.max(t,this.CX),(t=Math.min(t,this.CWidth-this.width))<0&&(t=0),this.scrollX=t},setFlip:function(t){this.flip=t},getFlip:function(){return this.flip}},i.prototype={set:function(t,e){this.Y=t,this.height=e},getY:function(){return this.Y},getEndY:function(){return this.Y+this.height},getScaleY:function(){return this.scaleY},setScaleY:function(t){this.scaleY=t},getHeight:function(){return this.height},isYIntersects:function(t){return this.getY()<=t&&t<=this.getEndY()},setContentViewPort:function(t,e){this.CY=t,this.CHeight=e,this.setScrollY(this.getScrollY())},getContentY:function(){return this.CY},getContentHeight:function(){return this.CHeight},getScrollY:function(){return this.scrollY},setScrollY:function(t){t=Math.max(t,this.CY),(t=Math.min(t,this.CHeight-this.height))<this.CY&&(t=this.CY),this.scrollY=t}},n.prototype={getZoom:function(){return this.getScaleX()},getX:function(){return this.xAxle.getX()},getY:function(){return this.yAxle.getY()},getWidth:function(){return this.xAxle.getWidth()},getHeight:function(){return this.yAxle.getHeight()},isXIntersects:function(t){return this.xAxle.isXIntersects(t)},isYIntersects:function(t){return this.yAxle.isYIntersects(t)},setScrollX:function(t){this.xAxle.setScrollX(t)},setScrollY:function(t){this.yAxle.setScrollY(t)},getScrollX:function(){return this.xAxle.getScrollX()},getScrollY:function(){return this.yAxle.getScrollY()},getScaleX:function(){return this.xAxle.getScaleX()},getScaleY:function(){return this.yAxle.getScaleY()},getContentX:function(){return this.xAxle.getContentX()},getContentWidth:function(){return this.xAxle.getContentWidth()},getContentY:function(){return this.yAxle.getContentY()},getContentHeight:function(){return this.yAxle.getContentHeight()},setFlip:function(t){this.xAxle.setFlip(t)},getFlip:function(){return this.xAxle.getFlip()},getTranslateScrollX:function(t){return this.getFlip()?this.getContentWidth()-this.getWidth()-t:t}},r.prototype={insertPane:function(t,e,i){this.Matrix[t]||(this.Matrix[t]=new Array),this.Matrix[t][e]=i,this.panes.push(i)},setDimensions:function(t,e,i,n,r){this.setFlip(r),this.scale(i,n),this.canvas.style.width=window.innerWidth,this.canvas.style.height=window.innerHeight,o(this.canvas,t,e)},scale:function(t,e){for(var i=0;i<this.xAxles.length;i++)this.xAxles[i].setScaleX(t);for(i=0;i<this.yAxles.length;i++)this.yAxles[i].setScaleY(e)},setFlip:function(t){for(var e=0;e<this.xAxles.length;e++)this.xAxles[e].setFlip(t)},setContentDimension:function(t){this.apply(function(e){e.setContentDimension(t),e.updateBoundary(t),e.updateScroll(t)})},apply:function(t){for(var e=0;e<this.panes.length;e++)t(this.panes[e])},getRelativeCoordinates:function(t,e){for(var i=this.xAxles[0].getFlip(),n=-1,o=-1,r=1;r<this.xAxles.length;r++){var s=this.xAxles[r];if(s.isXIntersects(t)){i?(n=s.getWidth()+s.getX()+s.getScrollX()-t,n/=s.getScaleX()):(n=t-s.getX()+s.getScrollX(),n/=s.getScaleX());break}}for(var h=1;h<this.yAxles.length;h++){var a=this.yAxles[h];if(a.isYIntersects(e)){o=e-a.getY()+a.getScrollY(),o/=a.getScaleY();break}}return{x:n,y:o}},getRelativeCoordinateX:function(t){for(var e=0;e<this.xAxles.length;e++){var i=this.xAxles[e];if(i.isXIntersects(t))return t-i.getX()+i.getScrollX()}return-1},getRelativeCoordinateY:function(t){for(var e=0;e<this.yAxles.length;e++){var i=this.yAxles[e];if(i.isYIntersects(t))return t-i.getY()+i.getScrollY()}return-1},scroll:function(t,e,i,n,o,r){n=Math.round(n),o=Math.round(o);for(var s=0;s<this.xAxles.length;s++){var h=this.xAxles[s];if(h.isXIntersects(e)){var a=h.getScrollX();h.setScrollX(a+n),n=-(a-h.getScrollX());break}}for(var c=0;c<this.yAxles.length;c++){var l=this.yAxles[c];if(l.isYIntersects(i)){var d=l.getScrollY();l.setScrollY(d+o),o=-(d-l.getScrollY());break}}if(r){for(var g=0;g<this.Matrix.length;g++)g==c&&this.Matrix[g][s]?this.Matrix[g][s].scroll(t,n,o):this.Matrix[g][s]&&this.Matrix[g][s].scroll(t,n,0);for(g=0;g<this.Matrix.length;g++)this.Matrix[c][g]&&g!==s&&this.Matrix[c][g].scroll(t,0,o)}else{for(g=0;g<this.Matrix.length;g++)this.Matrix[g][s]&&(this.Matrix[g][s].onBeforeFill(t),this.Matrix[g][s].updateScroll(t));for(g=0;g<this.Matrix.length;g++)this.Matrix[c][g]&&g!==s&&(this.Matrix[c][g].onBeforeFill(t),this.Matrix[c][g].updateScroll(t))}},translateX:function(t,e,i){return t-(e+i)}},r.Axles={XAxle:e,YAxle:i},r.Rect=n,t.ZSGrid.UIPaneManager=r}(this),function(t){function e(t){this.rect=t.rect,this.grid=t}var i=t.ZSGrid||(t.ZSGrid={});e.prototype={reload:function(t){this.del(t,this.iHave.start,this.iHave.end),this.fill(t)},scroll:function(t,e,i){},updateScroll:function(t){this.refresh(t)},refresh:function(t){this.grid.clearAll(t)}},i.ScrollBar=e}(this),function(t){function e(e,i){var n=document.createElement("div");n.className="pane";var o=document.createElement("div");o.className="scroller",n.appendChild(o),this.container=n,this.scroller=o,this.rect=e,this.grid=new t.ZSGrid.ScrollBar(i)}var i=t.ZSGrid||(t.ZSGrid={});e.prototype={appendTo:function(t){t.appendChild(this.container)},getRelativeCoordinates:function(t,e){return{x:(t-this.rect.getX()+this.rect.getScrollX())/this.rect.getScaleX(),y:(e-this.rect.getY()+this.rect.getScrollY())/this.rect.getScaleY()}},updateBoundary:function(t){var e=this.container.style,i=this.rect;e.left=i.getX()+"px",e.top=i.getY()+"px",e.width=i.getWidth()+"px",e.height=i.getHeight()+"px"},updateScroll:function(t,e){this.container.scrollTop=this.rect.getScrollY()-this.rect.getContentY(),this.grid.updateScroll(t),e&&e()},onBeforeFill:function(t){},setContentDimension:function(t){var e=this.scroller.style,i=this.rect;e.width=i.getContentWidth()+"px"},fill:function(){},refresh:function(){},reload:function(t){}},i.UIVerticalScrollPane=e}(this),function(t){function e(e,i){var n=document.createElement("div");n.className="pane";var o=document.createElement("div");o.className="scroller",n.appendChild(o),this.container=n,this.scroller=o,this.rect=e,this.grid=new t.ZSGrid.ScrollBar(i)}var i=t.ZSGrid||(t.ZSGrid={});e.prototype={appendTo:function(t){t.appendChild(this.container)},getRelativeCoordinates:function(t,e){return{x:(t-this.rect.getX()+this.rect.getScrollX())/this.rect.getScaleX(),y:(e-this.rect.getY()+this.rect.getScrollY())/this.rect.getScaleY()}},updateBoundary:function(t){var e=this.container.style,i=this.rect;e.left=i.getX()+"px",e.top=i.getY()+"px",e.width=i.getWidth()+"px",e.height=i.getHeight()+"px"},scroll:function(t,e,i){this.container.scrollLeft=this.rect.getScrollX()-this.rect.getContentX(),this.grid.scroll(t,e,i)},updateScroll:function(t,e){var i=this.rect.getFlip();this.container.scrollLeft=i?this.maxScrollableWidth-this.rect.getWidth()-this.rect.getScrollX()+this.rect.getContentX():this.rect.getTranslateScrollX(this.rect.getScrollX()-this.rect.getContentX()),this.grid.updateScroll(t),e&&e()},onBeforeFill:function(t){},setContentDimension:function(t){var e=this.scroller.style,i=this.rect;e.height=i.getContentHeight()+"px"},fill:function(t){this.grid.refresh(t)},refresh:function(t){},reload:function(t){this.grid.reload(t)}},i.UIHorizontalScrollPane=e}(this),function(t){function e(e,i){var n=document.createElement("div");n.className="pane";var o=document.createElement("div");o.className="scroller",n.appendChild(o);var r=this;n.addEventListener("mouseover",function(){r.grid.iHave}),n.addEventListener("mouseout",function(t){}),this.container=n,this.scroller=o,this.rect=e,this.grid=new t.ZSGrid.ColumnHeader(i)}var i=t.ZSGrid||(t.ZSGrid={});e.prototype={appendTo:function(t){t.appendChild(this.container)},getRelativeCoordinates:function(t,e){return{x:this.rect.getFlip()?(this.rect.getWidth()+this.rect.getScrollX()+this.rect.getX()-t)/this.rect.getScaleX():(t-this.rect.getX()+this.rect.getScrollX())/this.rect.getScaleX(),y:(e-this.rect.getY()+this.rect.getScrollY())/this.rect.getScaleY()}},updateBoundary:function(t){var e=this.container.style,i=this.rect;e.left=i.getX()+"px",e.top=i.getY()+"px",e.width=i.getWidth()+"px",e.height=i.getHeight()+"px"},scroll:function(t,e,i){this.updateScroll(t)},updateScroll:function(t,e){this.container.scrollLeft=this.rect.getTranslateScrollX(this.rect.getScrollX()),this.grid.updateScroll(t),e&&e()},onBeforeFill:function(t){this.grid.onBeforeFill(t)},setContentDimension:function(t){var e=this.scroller.style,i=this.rect;e.width=i.getContentWidth()+"px",e.height=i.getContentHeight()+"px"},fill:function(t){this.grid.refresh(t)},refresh:function(t){this.grid.refresh(t)},reload:function(t){this.grid.reload(t)}},i.UIColumnPane=e}(this),function(t){function e(e,i){var n=document.createElement("div");n.className="pane";var o=document.createElement("div");o.className="scroller";var r=this;n.addEventListener("mouseover",function(){r.grid.iHave}),n.addEventListener("mouseout",function(t){}),n.appendChild(o),this.container=n,this.scroller=o,this.rect=e,this.grid=new t.ZSGrid.RowHeader(i)}var i=t.ZSGrid||(t.ZSGrid={});e.prototype={appendTo:function(t){t.appendChild(this.container)},getRelativeCoordinates:function(t,e){return{x:(t-this.rect.getX()+this.rect.getScrollX())/this.rect.getScaleX(),y:(e-this.rect.getY()+this.rect.getScrollY())/this.rect.getScaleY()}},updateBoundary:function(t){var e=this.container.style,i=this.rect;e.left=i.getX()+"px",e.top=i.getY()+"px",e.width=i.getWidth()+"px",e.height=i.getHeight()+"px"},scroll:function(t,e,i){this.container.scrollTop=this.rect.getScrollY(),this.grid.scroll(t,e,i)},updateScroll:function(t,e){this.container.scrollTop=this.rect.getScrollY(),this.grid.updateScroll(t),e&&e()},onBeforeFill:function(t){this.grid.onBeforeFill(t)},setContentDimension:function(t){var e=this.scroller.style,i=this.rect;e.width=i.getContentWidth()+"px",e.height=i.getContentHeight()+"px"},fill:function(){this.grid.refresh()},refresh:function(t){this.grid.refresh(t)},reload:function(t){this.grid.reload(t)}},i.UIRowPane=e}(this),function(t){function e(t){var e=document.createElement("div");e.className="pane selectAll",this.container=e,this.rect=t}var i=t.ZSGrid||(t.ZSGrid={});e.prototype={appendTo:function(t){t.appendChild(this.container)},setContentDimension:function(t){},updateBoundary:function(t){var e=this.container.style,i=this.rect;e.left=i.getX()+"px",e.top=i.getY()+"px",e.width=i.getWidth()+"px",e.height=i.getHeight()+"px"},updateScroll:function(t,e){e&&e()},onBeforeFill:function(t){},fill:function(){},reload:function(t){},refresh:function(){}},i.UISelectAllPane=e}(this),function(t){function e(t){var e=document.createElement("div");e.className="pane dummy",this.container=e,this.rect=t}var i=t.ZSGrid||(t.ZSGrid={});e.prototype={appendTo:function(t){t.appendChild(this.container)},setContentDimension:function(t){},updateBoundary:function(t){var e=this.container.style,i=this.rect;e.left=i.getX()+"px",e.top=i.getY()+"px",e.width=i.getWidth()+"px",e.height=i.getHeight()+"px"},updateScroll:function(t,e){e&&e()},onBeforeFill:function(t){},fill:function(){},reload:function(t){},refresh:function(){}},i.UIDummyPane=e}(this),function(t){function e(){var t=this.container.getBoundingClientRect();this.rect.left=t.left,this.rect.top=t.top,this.rect.height=t.height,this.rect.width=t.width}function i(e,i,n,o,r,s,h,a,c,l,d,g){var u=document.createElement("canvas");i.appendChild(u),this.canvas=u,this.container=i,this.interacter=e;var f=new t.Rect(n,o,r,s);this.rect=f,this.panes=new t.ZSGrid.UIPaneManager(u,i,this),this.freezedRow=h=h||0,this.freezedCol=a=a||0,this.zoom=c=c||1,this.isFlip=l||!1,this.panes.setDimensions(e,r,s,h,a,c,c,this.isFlip);var p=this.getScrollXs();p[2]=d?d[0]:0,p[1]=d?d[1]:0,this.setScrollXs(p);var v=this.getScrollYs();v[2]=g?g[0]:0,v[1]=g?g[1]:0,this.setScrollYs(v),this.setWidth(r),this.setHeight(s),this.updateBoundary()}function n(t,e,i){t.getContext("2d"),t.width=1*e,t.height=1*i,t.style.width=e+"px",t.style.height=i+"px"}t.ZSGrid,i.prototype={setInteracter:function(t){this.interacter=t},setLeft:function(t){this.container.style.left=t+"px",e.call(this)},setTop:function(t){this.container.style.top=t+"px",e.call(this)},setWidth:function(t){this.container.style.width=t+"px",e.call(this)},setHeight:function(t){this.container.style.height=t+"px",e.call(this)},scale:function(t,e){this.zoom=t,this.updateBoundary()},translateCoordinates:function(t){var e=t.pageX,i=t.pageY;return{x:e-=this.rect.left,y:i-=this.rect.top}},getRelativeCoordinates:function(t,e){return this.panes.getRelativeCoordinates(t,e)},getRelativeCoordinateX:function(t){return this.panes.getRelativeCoordinateX(t)},getRelativeCoordinateY:function(t){return this.panes.getRelativeCoordinateY(t)},setDimensions:function(t,e){this.setWidth(t),this.setHeight(e),this.updateBoundary()},freeze:function(t,e){var i=this.freezedCol,n=this.freezedRow;if(this.freezedRow=t,this.freezedCol=e,this.updateBoundary(),i>e){var o=this.getScrollXs();o[2]=this.interacter.getColX(e),this.setScrollXs(o)}if(n>t){var r=this.getScrollYs();r[2]=this.interacter.getRowY(t),this.setScrollYs(r)}},getFreezedRow:function(){return this.freezedRow},getFreezedCol:function(){return this.freezedCol},updateBoundary:function(t){var e=this.rect.getWidth(),i=this.rect.getHeight(),n=this;this.panes.setDimensions(this.interacter,e,i,this.freezedRow,this.freezedCol,this.zoom,this.zoom,this.getFlip()),this.panes.apply(function(t){t.onBeforeFill(n.interacter)}),cancelAnimationFrame(this.timer2),this.timer2=requestAnimationFrame(function(){n.panes.setContentDimension(n.interacter),t&&t.call(n)})},getScrollXs:function(){for(var t=this.panes.xAxles,e=[],i=0;i<t.length;i++){var n=t[i];e.push(n.getScrollX())}return e},setScrollXs:function(t){for(var e=this.panes.xAxles,i=0;i<e.length;i++){e[i].setScrollX(t[i])}},getScrollYs:function(){for(var t=this.panes.yAxles,e=[],i=0;i<t.length;i++){var n=t[i];e.push(n.getScrollY())}return e},setScrollYs:function(t){for(var e=this.panes.yAxles,i=0;i<e.length;i++){e[i].setScrollY(t[i])}},getXs:function(){for(var t=[],e=this.panes.xAxles,i=0;i<e.length;i++){var n=e[i];t.push(n.getX())}return t},getYs:function(){for(var t=[],e=this.panes.yAxles,i=0;i<e.length;i++){var n=e[i];t.push(n.getY())}return t},getWidths:function(){for(var t=[],e=this.panes.xAxles,i=0;i<e.length;i++){var n=e[i];t.push(n.getWidth())}return t},getHeights:function(){for(var t=[],e=this.panes.yAxles,i=0;i<e.length;i++)t.push(e[i].getHeight());return t},getHeight:function(){return this.rect.getHeight()},getWidth:function(){return this.rect.getWidth()},addLayer:function(t){this.panes.addLayer(function(e){e.addLayer(t,e)})},hideHeaders:function(){this.panes.hideHeaders(),this.updateBoundary()},refresh:function(){var t=this;cancelAnimationFrame(this.timer),this.timer=requestAnimationFrame(function(){t.panes.apply(function(e){e.refresh(t.interacter)})}),this.panes.apply(function(e){e.onBeforeFill(t.interacter)})},refreshHeaders:function(){var t=this;this.panes.applyOnHeaders(function(e){e.refresh(t.interacter)})},refreshPanes:function(){var t=this;this.panes.applyOnPanes(function(e){e.refresh(t.interacter)})},updateScroll:function(t){var e=this,i=this.interacter;cancelAnimationFrame(this.timer1),this.timer1=requestAnimationFrame(function(){e.panes.apply(function(t){t.updateScroll(i)}),t&&t()}),this.panes.apply(function(t){t.onBeforeFill(i)})},getZoom:function(){return this.zoom},setFlip:function(t){this.isFlip=t,this.updateBoundary()},getFlip:function(){return this.isFlip},getInteracter:function(){return this.interacter},scroll:function(t,e,i,n,o){var r=this;cancelAnimationFrame(this.scrollTimer),this.scrollTimer=requestAnimationFrame(function(){r.panes.scroll(t,e,i,n,o,!1)})},download:function(t,e,i,n,o){o=o||".png";this.toDataURL(o,t,e,i,n,function(t){var e=document.createElement("a");e.download="image"+o,e.setAttribute("href",t),document.body.appendChild(e),e.click(),document.body.removeChild(e)})},toDataURL:function(t,e,i,o,r,s){var h=document.createElement("canvas"),a=h.getContext("2d");n(h,2*o,2*r);var c=this.canvas.getContext("2d").getImageData(2*e,2*i,2*o,2*r);a.putImageData(c,0,0);var l=h.toDataURL("image/"+t),d=new Image;d.src=l,d.addEventListener("load",function(){n(h,o,r),a.drawImage(d,0,0,o,r);var e=h.toDataURL("image/"+t);s(e)})}},t.ZSGrid.UIGrid=i}(this),function(t){var e=t.ZSGrid||(t.ZSGrid={}),i=t.console;i.debug=function(){i.groupCollapsed.apply(i,arguments),i.trace.apply(i,["trace..."]),i.groupEnd.apply(i,arguments)};var n={error:"background: #CCC; color: #F00",warning:"background: #CCC; color: #FF0",info:"background: #CCC; color: #00F",success:"background: #CCC; color: #0F0",log:"background: #F00; color: #FF0",debug:"background: #F00; color: #FFF"};e.GridLogger={isEnabled:!0,enable:function(){this.isEnabled=!0},disable:function(){this.isEnabled=!1},log:function(t,e){var o=[t,e],r=o.slice(0,1);r[0]="%c"+r[0],r[0]="%c"+r[0];o[0]=n.log,o=r.concat(o),i.log.apply(console,o)},error:function(t,e){var o=[t,e],r=o.slice(0,1);r[0]="%c"+r[0];o[0]=n.error,o=r.concat(o),i.error.apply(console,o)}}}(this),function(t){function e(t,e){var n=((i=document.createElement("span")).style.position="absolute",i.style.visibility="hidden",i.style.zIndex=-10,document.body.appendChild(i),i);n.style.fontSize=e+"pt",n.style.fontFamily=""+t,n.innerText="A1";var o=n.getBoundingClientRect().height;return document.body.removeChild(n),o}var i,n=t.ZSGrid||(t.ZSGrid={}),o={},r=["Arial","Arial Black","Book Antiqua","Calibri","Comic Sans MS","Courier New","Garamond","Georgia","Lucida Console","Tahoma","Times New Roman","Trebuchet MS","Verdana"];n.Font={CheckSupport:function(t){return r.includes(t)},AddFont:function(t){r.push(t)}};var s=[8,9,10,11,12,14,16,18,20,22,24,26,28,32,40,48,56,64,72];for(var h in r)for(var a in o[r[h]]={},s){var c=s[a];o[r[h]][c]=e(r[h],c)}n.font=o,n.getLineHeight=function(t,i){return o[t]&&o[t][i]||function(t,e,i){o[t]?o[t][e]=i:(o[t]={},o[t][e]=i)}(t,i,e(t,i)),o[t][i]}}(this),function(t){function e(t){this.isChecked=t}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={});e.prototype={render:function(e,i,n){var o,r,s=this.isChecked?1:0,h=14*e.getZoom(),a=t.IconSets.Checkbox[s];for(var c in this.context=e.context,this.context.font=h+"px icons2",o=n.getX()+n.getWidth()/2,r=n.getY()+n.getHeight()/2,this.context.textBaseline="middle",r+=.25*e.getZoom(),a){var l=a[c],d=l[0],g=l[1],u=l[2];this.context.strokeStyle=u,this.context.fillStyle=g,this.context.lineWidth=.5,this.context.fillText(d,o-h/2,r),this.context.strokeText(d,o-h/2,r)}},hasContent:function(){return!0},getWidth:function(){return 1}},n.CheckBox=e}(this),function(t){function e(){}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={});e.prototype={render:function(t,e,i){t.context.fillStyle="#F15656",t.context.beginPath(),t.context.moveTo(i.getX(),i.getY()),t.context.lineTo(i.getX()+8,i.getY()),t.context.lineTo(i.getX(),i.getY()+8),t.context.lineTo(i.getX(),i.getY()),t.context.fill()}},n.DVCue=e}(this),function(t){function e(t,e,i,n){this.paddingRequired=t,this.isApplied=e,this.iconName=i,this.fontSize=n||r}function i(t,e){this.paddingRequired=t,this.fontSize=e||r}var n=t.ZSGrid||(t.ZSGrid={}),o=n.Nodes||(n.Nodes={}),r=14;e.prototype={render:function(t,e,i){var n=t.getZoom(),o=this.fontSize*n,r=this.fontSize,s=.5*n,h=1.5*n;i.addPaddingRight(s),this.paddingRequired&&i.addPaddingRight(-(2*h+o));var a=this.isApplied?[this.iconName,1,r]:[this.iconName,0,r];t.drawIcon(a,i,2,e.valign)},hasContent:function(){return!0},getWidth:function(){return 1}},o.FilterCue=e,i.prototype={render:function(t,e,i){var n=t.getZoom(),o=this.fontSize*n,r=.5*n,s=1.5*n;i.addPaddingRight(r),this.paddingRequired&&i.addPaddingRight(2*s+o)},hasContent:function(){return!1},getWidth:function(){return 1}},o.PaddingToFilterCue=i}(this),function(t){function e(t,e,i,n){this.content=t,this.color=e,this.fontSize=i,this.fontName=n}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={});e.prototype={render:function(t,e,i){var n=i.getX()+i.getWidth()/2,o=i.getY()+i.getHeight()/2,r=(Math.min(1,t.getZoom()),t.context);r.fillStyle=this.color,r.font=this.fontSize+"pt "+this.fontName,r.textBaseline="middle",r.textAlign="center",r.fillText(this.content,n,o)}},n.HeaderText=e}(this),function(t){function e(t,e,i,n){this.size=t||h,this.verticalPadding=n||r,this.horizontalPadding=i||s,this.color=e||o}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={}),o="black",r=7,s=4,h=8;e.prototype={render:function(t,e,i){if(a){var n=t.rect.getFlip()?i.getX()+this.horizontalPadding:i.getX()+i.getWidth()+this.horizontalPadding,o=i.getY()+this.verticalPadding;t.drawTriangle(n,o,n+this.size/2,o+this.size/2,n,o+this.size,this.color)}}};var a=!1;e.setMouseOver=function(t){a=t},n.RightHideCue=e}(this),function(t){function e(t,e,i,n){this.size=t||h,this.verticalPadding=n||r,this.horizontalPadding=i||s,this.color=e||o}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={}),o="black",r=7,s=4,h=8;e.prototype={render:function(t,e,i){if(a){var n=t.rect.getFlip()?i.getX()-this.horizontalPadding:i.getX()+i.getWidth()-this.horizontalPadding,o=i.getY()+this.verticalPadding;t.drawTriangle(n,o,n-this.size/2,o+this.size/2,n,o+this.size,this.color)}}};var a=!1;e.setMouseOver=function(t){a=t},n.LeftHideCue=e}(this),function(t){function e(t,e,i,n){this.size=t||h,this.verticalPadding=n||r,this.horizontalPadding=i||s,this.color=e||o}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={}),o="black",r=7,s=4,h=8;e.prototype={render:function(t,e,i){if(a){var n,o,r=t.rect.getFlip();n=r?i.getX()+this.horizontalPadding:i.getX()+i.getWidth()+this.horizontalPadding,o=i.getY()+this.verticalPadding,t.drawTriangle(n,o,n+this.size/2,o+this.size/2,n,o+this.size,this.color),n=r?i.getX()-this.horizontalPadding:i.getX()+i.getWidth()-this.horizontalPadding,t.drawTriangle(n,o,n-this.size/2,o+this.size/2,n,o+this.size,this.color)}}};var a=!1;e.setMouseOver=function(t){a=t},n.LeftAndRightHideCue=e}(this),function(t){function e(t,e,i,n){this.size=t||h,this.verticalPadding=n||r,this.horizontalPadding=i||s,this.color=e||o}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={}),o="black",r=3,s=1,h=8;e.prototype={render:function(t,e,i){if(a){var n=i.getX()+this.horizontalPadding,o=i.getY()+i.getHeight()-this.verticalPadding;t.drawTriangle(n,o,n+this.size/2,o-this.size/2,n+this.size,o,this.color)}}};var a=!1;e.setMouseOver=function(t){a=t},n.TopHideCue=e}(this),function(t){function e(t,e,i,n){this.size=t||h,this.verticalPadding=n||r,this.horizontalPadding=i||s,this.color=e||o}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={}),o="black",r=3,s=1,h=8;e.prototype={render:function(t,e,i){if(a){var n=i.getX()+this.horizontalPadding,o=i.getY()+i.getHeight()+this.verticalPadding;t.drawTriangle(n,o,n+this.size/2,o+this.size/2,n+this.size,o,this.color)}}};var a=!1;e.setMouseOver=function(t){a=t},n.BottomHideCue=e}(this),function(t){function e(t,e,i,n){this.size=t||h,this.verticalPadding=n||r,this.horizontalPadding=i||s,this.color=e||o}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={}),o="black",r=3,s=1,h=8;e.prototype={render:function(t,e,i){if(a){var n=i.getX()+this.horizontalPadding,o=i.getY()+i.getHeight()+this.verticalPadding;t.drawTriangle(n,o,n+this.size/2,o+this.size/2,n+this.size,o,this.color),o=i.getY()+i.getHeight()-this.verticalPadding,t.drawTriangle(n,o,n+this.size/2,o-this.size/2,n+this.size,o,this.color)}}};var a=!1;e.setMouseOver=function(t){a=t},n.TopAndBottomHideCue=e}(this),function(t){function e(t,e,i,n){this.icon=t,this.halign=e,this.valign=i,this.paddingRequired=n}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={});e.prototype={render:function(t,e,i){this.icon&&t.drawIcon(this.icon,i,this.halign,this.valign),this.paddingRequired&&i.addPaddingLeft(t.getZoom()*this.icon[2])},hasContent:function(){return!0},getWidth:function(){return 1}},n.ICSet=e}(this),function(t){function e(){}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={});e.prototype={render:function(t,e,i){var n=t.rect.getFlip();t.context.beginPath(),t.context.fillStyle="#33B6C3",n?(t.context.moveTo(i.getX()+8,i.getY()),t.context.lineTo(i.getX(),i.getY()),t.context.lineTo(i.getX(),i.getY()+8),t.context.lineTo(i.getX()+8,i.getY())):(t.context.moveTo(i.getX()+i.getWidth()-8,i.getY()),t.context.lineTo(i.getX()+i.getWidth(),i.getY()),t.context.lineTo(i.getX()+i.getWidth(),i.getY()+8),t.context.lineTo(i.getX()+i.getWidth()-8,i.getY())),t.context.fill()}},n.NoteCue=e}(this),function(t){function e(t){var e=document.createElement("img");e.src=t,e.onload=function(){this.loaded=!0},this.img=e}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={});e.prototype={render:function(t,e,i){if(o){var n=t.context.createPattern(this.img,"repeat");t.context.fillStyle=n;var r=t.translateX(0,i.getWidth()),s=t.translateY(0,i.getWidth());t.context.translate(r,s),t.context.fillRect(i.getX()-r,i.getY()-s,i.getWidth(),i.getHeight()),t.context.translate(-r,-s)}}};var o=!0;e.setVisibility=function(t){o=t},n.Pattern=e}(this),function(t){function e(){this.Lines=[],this.Nodes=[],this.calculated=!1}function i(){this.Lines=[],this.Nodes=[],this.calculated=!1}function n(){this.Lines=[],this.Nodes=[],this.calculated=!1}function o(){this.Lines=[],this.Nodes=[],this.calculated=!1}function r(t){var e=this.Nodes,i=0;if(0!=e.length){var n=e[i],o=new s.Line(n.getHeight());for(this.Lines.push(o);i<e.length;){var r=(n=e[i]).getText();n.applyStyle(t,1);for(var h=r.match(/(?:(?:[\t\n])|[^\t\n]+)/gi),a=0;a<h.length;a++){var c=h[a];if("\n"!==c){var l=t.measureText(c).width,d=o.createWord();d.setContent(c),d.setNode(n),d.setWidth(l),d.setHeight(n.getHeight()),o.addWord(d)}else o=new s.Line(n.getHeight()),this.Lines.push(o)}i++}}}var s=t.ZSGrid||(t.ZSGrid={}),h=s.Nodes||(s.Nodes={}),a=s.GridLogger;e.prototype={render:function(t,e,i){t.render(i,e.getVerticalAlignment(),e.getHorizontalAlignment(),this.Lines,t.getZoom())},addTextNode:function(t){this.Nodes.push(t)},calculate:function(t,e){this.Lines=[],e<0&&a.error("Column width can't be Negative."),function(t,e){var i=this.Nodes,n=0;if(0!=i.length){var o=i[n],r=0,h=new s.Line(o.getHeight());for(this.Lines.push(h);n<i.length;){var a=(o=i[n]).getText();o.applyStyle(t,1);for(var c=a.match(/(?:(?:[\n])|[^\n]+)/gi),l=0;l<c.length;l++)if("\n"!==c[l])for(var d=c[l].match(/(?:(?:[\t\s])|[^\t\s]+)/gi),g=0,u=d[g],f=u;g<d.length;){var p=t.measureText(u).width;if(0===r&&p>e){for(;p>e;)u=u.slice(0,u.length-1),p=t.measureText(u).width;if(""==u)return null;(v=h.createWord()).setContent(u),v.setNode(o),v.setWidth(p),v.setHeight(o.getHeight()),h.addWord(v),r=0,h=new s.Line(o.getHeight()),this.Lines.push(h),u=f=f.slice(u.length,f.length),p=t.measureText(u).width}else{if(r+p<=e){(v=h.createWord()).setContent(u),v.setNode(o),v.setWidth(p),v.setHeight(o.getHeight()),h.addWord(v),r+=p,u=f=d[++g];continue}r=0,h=new s.Line(o.getHeight()),this.Lines.push(h)}}else{var v;r=0,h=new s.Line(o.getHeight()),this.Lines.push(h),(v=h.createWord()).setContent("\n"),v.setNode(o),v.setHeight(o.getHeight())}n++}}}.call(this,t,e)},hasContent:function(){for(var t in this.Nodes)if(!this.Nodes[t].isEmpty())return!0;return!1},getWidth:function(){return 1}},h.TextWrapNode=e,i.prototype={render:function(t,e,i){t.render(i,e.getVerticalAlignment(),e.getHorizontalAlignment(),this.Lines,t.getZoom())},addTextNode:function(t){this.Nodes.push(t)},calculate:function(t,e){this.Lines=[],e<0&&a.error("Column width can't be Negative."),r.call(this,t)},hasContent:function(){for(var t in this.Nodes)if(!this.Nodes[t].isEmpty())return!0;return!1},getWidth:function(){for(var t=0,e=0;e<this.Lines.length;e++)t<this.Lines[e].getWidth()&&(t=this.Lines[e].getWidth());return t}},h.TextOverFlowNode=i,n.prototype={render:function(t,e,i){var n=function(t,e){for(var i=0,n=0;n<this.Lines.length;n++)i<this.Lines[n].getWidth()&&(i=this.Lines[n].getWidth());return 0==(i*=e)?1:t>i?1:t/i}.call(this,i.getWidth(),t.getZoom())*t.getZoom();t.render(i,e.getVerticalAlignment(),e.getHorizontalAlignment(),this.Lines,n)},addTextNode:function(t){this.Nodes.push(t)},calculate:function(t,e){this.Lines=[],e<0&&a.error("Column width can't be Negative."),r.call(this,t)},hasContent:function(){for(var t in this.Nodes)if(!this.Nodes[t].isEmpty())return!0;return!1},getWidth:function(){return 1}},h.TextWidthFitNode=n,o.prototype={render:function(t,e,i){t.render(i,e.getVerticalAlignment(),e.getHorizontalAlignment(),this.Lines,t.getZoom())},addTextNode:function(t){this.Nodes.push(t)},calculate:function(t,e){this.Lines=[],e<0&&a.error("Column width can't be Negative."),r.call(this,t)},hasContent:function(){for(var t in this.Nodes)if(!this.Nodes[t].isEmpty())return!0;return!1},getWidth:function(){return 1}},h.TextClipNode=o}(this),function(t){function e(){}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={});e.prototype={render:function(t,e,i){if(o){t.context.strokeStyle="#F15656",t.context.lineWidth=2,t.context.strokeRect(i.getX()+1,i.getY()+1,i.getWidth()-2,i.getHeight()-2)}}};var o=!1;e.setHighlightInvalidData=function(t){o=t},e.isHighlightInvalidData=function(){return o},n.InvalidDVCue=e}(this),function(t){function e(t,e,i,n,o,r){e.applyStyle(t,r),t.beginPath(),t.moveTo(i,o),t.lineTo(i+n,o),t.stroke()}function i(t,e,i){this.text1=t,this.text2=e,this.textRepeat=i,this.hash="#"}function n(t){this.node=t,this.hash="#"}var o=t.ZSGrid||(t.ZSGrid={}),r=o.Nodes||(o.Nodes={}),s={TOP:0,MIDDLE:1,BOTTOM:2},h={LEFT:0,CENTER:1,RIGHT:2};i.prototype={render:function(t,i,n){var o,r,h,a,c,l,d,g,u,f,p=n.getX(),v=n.getY(),x=t.getZoom(),m=t.context,S=i.valign,C="";switch(o=r=a=c,l=d=g=u=0,l=h=a=c=p,null==this.text1&&void 0==this.text1||(this.text1.applyStyle(m,x),d=t.context.measureText(this.text1.content).width,o=this.text1.getHeight()),null==this.text2&&void 0==this.text2||(this.text2.applyStyle(m,x),g=t.context.measureText(this.text2.content).width,r=this.text2.getHeight()),null==this.textRepeat&&void 0==this.textRepeat||(this.textRepeat.applyStyle(m,x),u=t.context.measureText(this.textRepeat.content).width,C=this.textRepeat.content),S){case s.TOP:break;case s.MIDDLE:v+=n.height/2,(v-=o>r?o*x/2:r*x/2)<n.getY()&&(v=n.getY());break;case s.BOTTOM:v+=n.height,(v-=o>r?o*x:r*x)<n.getY()&&(v=n.getY())}if(v+=o>r?o*x:r*x,(a+=n.getWidth()-g)-(h+d)<=0&&null!=this.text2&&void 0!=this.text2){var y=this.hash;this.text2.applyStyle(m,x);var w=t.context.measureText(y).width,R=Math.floor(n.getWidth()/w),X=y.repeat(R);return w=t.context.measureText(X).width,c+=n.getWidth()-w,t.context.fillStyle="#000000",this.text2.applyStyle(m,x),m.textBaseline="bottom",void t.context.fillText(X,c,v)}if(m.fillStyle="#000000",m.textBaseline="bottom",null!=this.textRepeat&&void 0!=this.textRepeat){f=a-(l=h+d);R=Math.floor(f/u);C=C.repeat(R),this.textRepeat.applyStyle(m,x),t.context.fillText(C,l,v)}if(null!=this.text1&&void 0!=this.text1&&null!=this.text2&&void 0!=this.text2&&(this.text1.applyStyle(m,x),t.context.fillText(this.text1.content,h,v)),null!=this.text2&&void 0!=this.text2&&(this.text2.applyStyle(m,x),t.context.fillText(this.text2.content,a,v)),null!=this.text2&&void 0!=this.text2&&this.text2.isUnderline()){var T=(Y=o>r?o:r)*x*.06,H="alphabetic"==m.textBaseline?v+T:v-T;if(m.lineWidth=T,null!=this.text1&&void 0!=this.text1&&e(m,this.text1,h,d,H,x),null!=this.textRepeat&&void 0!=this.textRepeat){var L=a-(h+d);e(m,this.textRepeat,l,L,H,x)}else{L=a-(h+d);e(m,this.text1,h+d,L,H,x)}null!=this.text2&&void 0!=this.text2&&e(m,this.text2,a,g,H,x)}if(null!=this.text2&&void 0!=this.text2&&this.text2.isStrikeThrough()){var Y,W=(Y=o>r?o:r)*x*.06,P="alphabetic"==m.textBaseline?v-Y*x/4:v-Y*x/2.5;if(m.lineWidth=W,null!=this.text1&&void 0!=this.text1&&e(m,this.text1,h,d,P,x),null!=this.textRepeat&&void 0!=this.textRepeat){L=a-(h+d);e(m,this.textRepeat,l,L,P,x)}else{L=a-(h+d);e(m,this.text1,h+d,L,P,x)}null!=this.text2&&void 0!=this.text2&&e(m,this.text2,a,g,P,x)}},hasContent:function(){return!0},getWidth:function(){return 1}},r.AccountingNode=i,n.prototype={render:function(t,i,n){if(null!=this.node&&void 0!=this.node){var o,r,a=t.context,c=n.getX(),l=n.getY(),d=t.getZoom(),g=i.valign,u=i.halign,f=Number(this.node.content),p=c,v=6,x=7;switch(this.node.applyStyle(a,d),o=t.context.measureText(f).width,r=this.node.getHeight(),a.fillStyle="black",a.textBaseline="bottom",g){case s.TOP:break;case s.MIDDLE:if(l+=n.height/2,(l-=r*d/2)<n.getY()){l=n.getY();break}break;case s.BOTTOM:if(l+=n.height,(l-=r*d)<n.getY()){l=n.getY();break}}if(l+=r*d,o>n.getWidth()){for(;x>0&&(x-=1,f=Number(f.toFixed(x)),this.node.applyStyle(a,d),o=t.context.measureText(f).width,n.getWidth()<o););for(;v>0&&n.getWidth()<o&&(v-=1,f=(f=parseFloat(f).toExponential(v)).toUpperCase(),this.node.applyStyle(a,d),o=t.context.measureText(f).width,n.getWidth()<o););if(n.getWidth()<o){var m=this.hash;this.node.applyStyle(a,d);var S=t.context.measureText(m).width,C=Math.floor(n.getWidth()/S),y=m.repeat(C);switch(S=t.context.measureText(y).width,u){case h.LEFT:break;case h.CENTER:p+=(n.getWidth()-S)/2;break;case h.RIGHT:p+=n.getWidth()-S}return a.fillStyle="#000000",this.node.applyStyle(a,d),void a.fillText(y,p,l)}}switch(u){case h.LEFT:break;case h.CENTER:c+=(n.getWidth()-o)/2;break;case h.RIGHT:c+=n.getWidth()-o}if(this.node.applyStyle(a,d),a.fillText(f,c,l),this.node.isUnderline()){var w=r*d*.06,R="alphabetic"==a.textBaseline?l+w:l-w;a.lineWidth=w,e(a,this.node,c,o,R,d)}if(this.node.isStrikeThrough()){var X=r*d*.06,T="alphabetic"==a.textBaseline?l-r*d/4:l-r*d/2.5;a.lineWidth=X,e(a,this.node,c,o,T,d)}}},hasContent:function(){return!0},getWidth:function(){return 1}},r.NumberNode=n}(this),function(t){function e(t,e,i,n,o,r){e.applyStyle(t,r),t.beginPath(),t.moveTo(i,o),t.lineTo(i+n,o),t.stroke()}function i(t){this.node=t,this.hash="#"}var n=t.ZSGrid||(t.ZSGrid={}),o=n.Nodes||(n.Nodes={}),r={TOP:0,MIDDLE:1,BOTTOM:2},s={LEFT:0,CENTER:1,RIGHT:2};i.prototype={render:function(t,i,n){if(null!=this.node&&void 0!=this.node){var o,h,a=t.context,c=n.getX(),l=n.getY(),d=t.getZoom(),g=i.valign,u=i.halign,f=this.node.content,p=c;switch(this.node.applyStyle(a,d),o=t.context.measureText(f).width,h=this.node.getHeight(),a.fillStyle="black",a.textBaseline="bottom",g){case r.TOP:break;case r.MIDDLE:if(l+=n.height/2,(l-=h*d/2)<n.getY()){l=n.getY();break}break;case r.BOTTOM:if(l+=n.height,(l-=h*d)<n.getY()){l=n.getY();break}}if(l+=h*d,o>n.getWidth()){var v=this.hash;this.node.applyStyle(a,d);var x=t.context.measureText(v).width,m=Math.floor(n.getWidth()/x),S=v.repeat(m);switch(x=t.context.measureText(S).width,u){case s.LEFT:break;case s.CENTER:p+=(n.getWidth()-x)/2;break;case s.RIGHT:p+=n.getWidth()-x}return a.fillStyle="#000000",this.node.applyStyle(a,d),void a.fillText(S,p,l)}switch(u){case s.LEFT:break;case s.CENTER:c+=(n.getWidth()-o)/2;break;case s.RIGHT:c+=n.getWidth()-o}if(this.node.applyStyle(a,d),a.fillText(f,c,l),this.node.isUnderline()){var C=h*d*.06,y="alphabetic"==a.textBaseline?l+C:l-C;a.lineWidth=C,e(a,this.node,c,o,y,d)}if(this.node.isStrikeThrough()){var w=h*d*.06,R="alphabetic"==a.textBaseline?l-h*d/4:l-h*d/2.5;a.lineWidth=w,e(a,this.node,c,o,R,d)}}},hasContent:function(){return!0},getWidth:function(){return 1}},o.FormatCellNode=i}(this),function(t){function e(){}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={});e.prototype={render:function(t,e,i){},hasContent:function(){return!0},getWidth:function(){return 1}},n.DummyNode=e}(this),function(t){function e(t){this.color=t}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={});e.prototype={render:function(t,e,i){if(o){t.context.fillStyle=this.color,t.context.fillRect(i.getX(),i.getY(),i.getWidth(),3)}}};var o=!0;e.setHighlightChanges=function(t){o=t},n.VersionHighlight=e}(this),function(t){function e(t,e){this.grid=t,this.active=Object.create(null),this.iHave={start:null,end:null}}var i=t.ZSGrid||{},n=new Rect;e.prototype={fill:function(t){var e=this.grid,i=e.getX(),n=e.getY(),o=e.getWidth(),r=e.getHeight();e.context.save(),e.context.beginPath(),e.context.rect(i,n,o,r),e.context.clip(),this.load(t,this.iHave.start,this.iHave.end),e.context.restore()},del:function(t,e,i){e=this.iHave.start,i=this.iHave.end;for(var n=e;n<i;n++)this.active[n]&&(this.active[n].destroy(),delete this.active[n])},load:function(t,e,i){var o,r,s=this.grid,h=e;r=s.translateY(0);for(var a,c=null,l=null,d=null,g=s.getHeight();h<=i;h=t.getNextNonHiddenCol(h)){a=t.getColX(h);var u=t.getColWidth(h);u=s.translateWidth(u),o=s.translateX(a,u),n.set(o,r,u,g),s.context.save(),s.context.beginPath(),s.context.rect(o,r,u,g),s.context.clip();var f=this.getCell(t,h);this.active[h]=f,f.renderCell(s,n),s.context.restore(),d&&(n.set(c,r,l,g),d.render(s,n)),d=f,c=o,l=u}d&&(n.set(c,r,l,g),d.render(s,n))},getCell:function(t,e){return t.getColumnCell(e)},reload:function(t){this.del(t,this.iHave.start,this.iHave.end),this.fill(t)},scroll:function(t,e,i){this.refresh(t)},updateScroll:function(t){this.refresh(t)},onBeforeFill:function(t){var e=this.grid,i=e.getScrollLeft(),n=i,o=i+e.getWidth()/e.getZoom(),r=t.findCol(n),s=t.findCol(o);this.iHave.start=t.getNextNonHiddenCol(r-1),this.iHave.end=t.getPrevNonHiddenCol(s+1)},setBoundary:function(t,e,i,n){this.grid.setBoundary(t,e,i,n)},setScrollLeft:function(t){this.grid.setScrollLeft(t)},setScrollTop:function(t){this.grid.setScrollTop(t)},setRelativeScroll:function(t,e){var i=this.grid,n=i.getScrollLeft()+t,o=i.getScrollTop()+e;n=Math.max(n,0),o=Math.max(o,0),i.setScrollLeft(n),i.setScrollTop(o)},setRelativeScrollLeft:function(t){t+=this.grid.getScrollLeft(),t=Math.max(t,0),this.setScrollLeft(t)},setRelativeScrollTop:function(t){t+=this.grid.getScrollTop(),t=Math.max(t,0),this.setScrollTop(t)},clear:function(){this.grid.clearAll()},refresh:function(t){this.clear(),this.fill(t)}},i.ColumnHeader=e}(this),function(t){function e(t,e,i,o,r,s){n.call(this,t,1,1,e,i,o,r,s,!0,null)}var i=t.ZSGrid||{},n=i.Cell;e.prototype={renderCell:function(t,e){n.prototype.renderCell.call(this,t,e)},render:function(t,e){t.drawBottomGridLine(e,[0,0,0,0,0,0]),e.addPaddingTop(-2),t.drawBorderRight(this.getBorderRight(),e,[0,0,0,0,0,0]);for(var i=0;i<this.ForeGroundStack.length;i++){this.ForeGroundStack[i].render(t,this,e)}}},e.prototype=Object.assign({},n.prototype,e.prototype),i.CXColumnCell=e}(this),function(t){function e(t,e){this.grid=t,this.active=Object.create(null),this.iHave={start:null,end:null}}var i=t.ZSGrid||(t.ZSGrid={}),n=new Rect;e.prototype={fill:function(t){var e=this.grid,i=e.getX(),n=e.getY(),o=e.getWidth(),r=e.getHeight();e.context.save(),e.context.beginPath(),e.context.rect(i,n,o,r),e.context.clip(),this.load(t,this.iHave.start,this.iHave.end),e.context.restore()},del:function(t,e,i){for(var n=e;n<i;n++)this.active[n]&&(this.active[n].destroy(),delete this.active[n])},load:function(t,e,i){var o,r,s=this.grid,h=e,a=s.getWidth();o=s.translateX(0,a);for(var c,l=null,d=null,g=null;h<=i;h=t.getNextNonHiddenRow(h)){c=t.getRowY(h),r=s.translateY(c);var u=t.getRowHeight(h);u=s.translateHeight(u),n.set(o,r,a,u);var f=t.getRowCell(h);this.active[h]=f,f.renderCell(s,n),l&&(n.set(o,d,a,g),l.render(s,n)),l=f,d=r,g=u}l&&(n.set(o,d,a,g),l.render(s,n))},reload:function(t){this.del(t,this.iHave.start,this.iHave.end),this.fill(t)},scroll:function(t,e,i){this.refresh(t)},updateScroll:function(t){this.refresh(t)},onBeforeFill:function(t){var e=this.grid,i=e.getScrollTop(),n=i,o=i+e.getHeight()/e.getZoom(),r=t.findRow(n),s=t.findRow(o);this.iHave.start=t.getNextNonHiddenRow(r-1),this.iHave.end=t.getPrevNonHiddenRow(s+1)},setBoundary:function(t,e,i,n){this.grid.setBoundary(t,e,i,n)},setScrollLeft:function(t){this.grid.setScrollLeft(t)},setScrollTop:function(t){this.grid.setScrollTop(t)},setRelativeScroll:function(t,e){var i=this.grid,n=i.getScrollLeft()+t,o=i.getScrollTop()+e;n=Math.max(n,0),o=Math.max(o,0),i.setScrollLeft(n),i.setScrollTop(o)},setRelativeScrollLeft:function(t){t+=this.grid.getScrollLeft(),t=Math.max(t,0),this.setScrollLeft(t)},setRelativeScrollTop:function(t){t+=this.grid.getScrollTop(),t=Math.max(t,0),this.setScrollTop(t)},clear:function(){this.grid.clearAll()},refresh:function(t){this.clear(),this.fill(t)}},i.RowHeader=e}(this),function(t){function e(t,e,i,o,r,s){n.call(this,t,1,1,e,i,o,r,s,!0,null)}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Cell;e.prototype={renderCell:function(t,e){n.prototype.renderCell.call(this,t,e)},render:function(t,e){t.drawBorderBottom(this.getBorderBottom(),e),t.drawRightGridLine(e);for(var i=0;i<this.ForeGroundStack.length;i++){this.ForeGroundStack[i].render(t,this,e)}}},e.prototype=Object.assign({},n.prototype,e.prototype),i.CXRowCell=e}(this),function(t){function e(t){var e=document.createElement("img");e.src=t,e.onload=function(){this.loaded=!0},this.img=e}var i=t.ZSGrid||(t.ZSGrid={}),n=i.Nodes||(i.Nodes={});e.prototype={render:function(t,e,i){i.addPaddingLeft(t.getZoom()*e.getPaddingLeft()),i.addPaddingRight(t.getZoom()*e.getPaddingRight()),i.addPaddingTop(t.getZoom()*e.getPaddingTop()),i.addPaddingBottom(t.getZoom()*e.getPaddingBottom()),t.context.drawImage(this.img,i.getX(),i.getY(),i.getWidth(),i.getHeight())}},n.ImageFill=e}(this),function(t){function e(t,e,i,n,o){this.sparkline=t,this.data=e,this.min=i,this.max=n,this.emptyCellType=o,this.Rect={},this.height=20}e.prototype={render:function(t,e,i){var n=i.clone(),o=i.clone();o.addPaddingLeft(2*t.getZoom()),o.addPaddingRight(2*t.getZoom()),o.addPaddingTop(2*t.getZoom()),o.addPaddingBottom(2*t.getZoom()),t.context.save(),t.context.beginPath(),t.context.rect(o.getX(),o.getY(),o.getWidth(),o.getHeight()),t.context.clip(),n.addPaddingLeft(6*t.getZoom()),n.addPaddingRight(6*t.getZoom()),n.addPaddingTop(4*t.getZoom()),n.addPaddingBottom(4*t.getZoom()),this.sparkline.draw(t,n.getX(),n.getY(),n.getWidth(),n.getHeight(),this.data,this.min,this.max,this.emptyCellType),t.context.restore()},calculateRect:function(t,e){var i=e.defaultHeight||this.height,n=3*(this.height>i?this.height:i);this.Rect.width=n,this.Rect.height=i},getRect:function(){return this.Rect},setData:function(t){this.data=t},setMaximum:function(t){this.max=t},setMinimum:function(t){this.min=t},setEmptyCellType:function(t){this.emptyCellType=t},hasContent:function(){return!0},getWidth:function(){return 1}},t.Sparkline=e}(this),function(t){function e(t,e,i,n){t&&(this.Dom=function(t,e,i,n){var o=document.createElement("div");return e&&(o.className=e),function(t,e,i){for(var n in e)t.addEventListener(n,e[n].bind(i))}(o,i,n),t.appendChild(o),o}(t,e,i,n))}var i=t.ZSClass;e.prototype={hide:function(){this.Dom.style.display="none"},show:function(){this.Dom.style.display=""}},i.UILayerElement=e}(this),function(t){function e(t,e,i){var o=new n(t,e);return function(t,e){for(var i in e)t[i]=new n(t.Dom,i,e[i],this)}.call(this,o,i),o}var i=t.ZSClass,n=i.UILayerElement;i.UILayer=function(t,i,o){t.className="Layer "+(i.class||""),function(t,e,i){for(var n in e)t.addEventListener(n,e[n].bind(i))}(t,i.Listeners,this),i.filler&&(this.filler=function(t,e){return new n(t,"filler",e,this)}.call(this,this.Dom,i.filler)),i.edges&&(this.edges=e.call(this,this.Dom,"edges",i.edges)),i.corners&&(this.corners=e.call(this,this.Dom,"corners",i.corners))}}(this),function(t){function e(t,e,i,n){this.ID=t,this.parent=e,this.Controller=i,this.router=n;var o=document.createElement("div");e.appendChild(o),this.Dom=o}var i=t.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,r=n.Modules||(n.Modules={}),s=r.Main||(r.Main={});e.prototype={getID:function(){return this.ID},getController:function(){return this.Controller},getRouter:function(){return this.router},isRTL:function(){return this.getRouter().getPane().rect.getFlip()},onPlace:function(t,e,i,n){var o=this.isRTL();this.top=~~e,this.left=~~t,this.height=~~n,this.width=~~i;var r=this.Dom.style;r.top=this.top+"px",o?(r.left="",r.right=this.left+"px"):(r.right="",r.left=this.left+"px"),r.height=this.height+"px",r.width=this.width+"px",this.parent.appendChild(this.Dom)},onRemove:function(){this.Dom.remove(),this.onBlur(),this.onMouseLeave()}};var h=[o.Layer];e.prototype=o.implement(e,h),s.Layer=e}(this),function(t){function e(t,e,i,n){this.Active={},this.inActive=[],this.Controller=i,this.Layer=e,this.parent=t,this.pane=n}var i=t.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,r=n.Modules||(n.Modules={}),s=r.Main||(r.Main={});e.prototype={attach:function(){this.Controller.addView(this)},dettach:function(){this.Controller.removeView(this)},getPane:function(){return this.pane},get:function(t){if(this.Active[t])return this.Active[t];if(this.inActive.length){var e=this.inActive.pop();this.Active[t]=e,e.ID=t}else this.Active[t]=new this.Layer(t,this.parent,this.Controller,this);return this.Active[t]},onPlace:function(t,e,i,n,o){var r=this.get(t),s=this.pane.getZoom();r.onPlace(e*s+(s-1),i*s+(s-1),n*s-(s-2),o*s-(s-2))},onRemove:function(t){var e=this.get(t);e.onRemove(),this.inActive.push(e),delete this.Active[t]},getActive:function(){return this.Active}};var h=[o.Router];e.prototype=o.implement(e,h),s.Router=e}(this),function(t){function e(){this.Alive={},this.Active={}}var i=t.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,r=n.Modules||(n.Modules={}),s=r.Main||(r.Main={});e.prototype={onPlace:function(t,e){this.Alive[t]=e},onRemove:function(t){this.onBlur(t),delete this.Alive[t]},onDelete:function(t){this.onBlur(t),delete this.Alive[t]},onScrollIntoView:function(t,e){e.scrollIntoView()},onFocus:function(t){this.Active[t]=!0},onBlur:function(t){delete this.Active[t]},getAlive:function(){return this.Alive},getActive:function(){return this.Active}};var h=[o.Control];e.prototype=o.implement(e,h),s.StateControl=e}(this),function(t){function e(){}var i=t.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,r=n.Modules||(n.Modules={}),s=r.Main||(r.Main={});e.prototype={onPlace:function(){},onRemove:function(){}};var h=[o.Control];e.prototype=o.implement(e,h),s.NetworkControl=e}(this),function(t){function e(){this.Views=[]}var i=t.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,r=n.Modules||(n.Modules={}),s=r.Main||(r.Main={});e.prototype={add:function(t){this.Views.push(t)},remove:function(t){var e=this.Views.indexOf(t);this.Views[e]&&(this.Views[e].onRemoveAll(),this.Views.splice(e,1))},onPlace:function(t,e){for(var i in this.Views){this.Views[i].onPlace(t,e.getX(),e.getY(),e.getWidth(),e.getHeight())}},onRemove:function(t){for(var e in this.Views){this.Views[e].onRemove(t)}},onDelete:function(t){this.onRemove(t)}};var h=[o.Control];e.prototype=o.implement(e,h),s.ViewControl=e}(this),function(t){function e(t,e,i){this.State=new t,this.Network=new e,this.Views=new i}var i=t.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,r=n.Modules||(n.Modules={}),s=r.Main||(r.Main={});e.prototype={createView:function(t){var e=document.createElement("div");t.appendChild(e);var i=new View(e,this);return this.addView(i),i},addView:function(t){this.Views.add(t)},removeView:function(t){this.Views.remove(t)},getInteracter:function(t){return new o.Interacter(t,this)},getActive:function(){return this.State.getActive()},getAlive:function(){return this.State.getAlive()},place:function(t){var e=t.getID();this.onPlace(e,t)},remove:function(t){var e=t.getID();this.onRemove(e,t)},removeAll:function(){var t=this.getAlive();for(var e in t)this.onRemove(e)},delete:function(t){this.Master.delete(t)},onPlace:function(t,e){this.State.onPlace(t,e),this.Views.onPlace(t,e),this.Network.onPlace(t,e)},onRemove:function(t,e){this.State.onRemove(t,e),this.Views.onRemove(t,e),this.Network.onRemove(t,e)},onDelete:function(t){var e=this.getActive();for(var t in e){var i=this.getInteracter(t);this.State.onDelete(t,i),this.Views.onDelete(t,i),this.Network.onDelete(t,i)}}};var h=[o.Controller];e.prototype=o.implement(e,h),s.Controller=e}(this),function(t){function e(t,e,i,n,o){s.Controller.call(this,t,e,i),this.Master=n,n.addController(this,o)}var i=t.ZSClass,n=i.Layer||(i.Layer={}),o=n.Interface,r=n.Modules||(n.Modules={}),s=r.Main||(r.Main={}),h=n.Ole||(n.Ole={});e.prototype={};var a=[s.Controller];e.prototype=o.implement(e,a),h.Controller=e}(this),function(t){function e(t,e,i,n){this.fixRight=!!t,this.fixBottom=!!e,this.fixWidth=!!i,this.fixHeight=!!n}var i=t.ZSClass,n=i.Layer||(i.Layer={}),o=n.Utility||(n.Utility={});e.prototype={isFixedRight:function(){return this.fixRight},isFixedBottom:function(){return this.fixBottom},isFixedWidth:function(){return this.fixWidth},isFixedHeight:function(){return this.fixHeight}},o.Point=e}(this);
!function(a){var r=["",""],t=["",""],n=[""],d=["",""],e=["",""],s=["","",""],f=["","",""],p=["","",""],c=["","",""],b=["","",""],C=["",""],i=["",""],E=["",""],D=["",""],o=["",""],B=["",""],l=["",""],g=["","",""],h=["","",""],S=["","","",""],k=["","","",""],L=["","","",""],T=["","","",""],u=["","",""],v=["",""],w={"5Arrows":[[["","#cf6a61","#9b514a"]],[["","#fcd058","#b09240"]],[["","#fcd058","#b09240"]],[["","#fcd058","#b09240"]],[["","#5ab187","#408061"]]],"3Arrows":[[["","#cf6a61","#9b514a"]],[["","#fcd058","#b09240"]],[["","#5ab187","#408061"]]],"5ArrowsGray":[[["","#848484","#7C7C7C"]],[["","#848484","#7C7C7C"]],[["","#848484","#7C7C7C"]],[["","#848484","#7C7C7C"]],[["","#848484","#7C7C7C"]]],"3Triangles":[[["","#e07369","#9b514a"]],[["","#fcd058","#b09240"]],[["","#5ab187","#408061"]]],"5TrafficLights":[[["","#000000","#000000"]],[["","#848484","#7C7C7C"]],[["","#e07369","#9b514a"]],[["","#fcd058","#b09240"]],[["","#5ab187","#408061"]]],"3TrafficLights2":[[["","#000000","transparent"],["","#e07369","transparent"]],[["","#000000","transparent"],["","#fcd058","transparent"]],[["","#000000","transparent"],["","#5ab187","transparent"]]],"3Signs":[[["","#e07369","#9b514a"]],[["","#fcd058","#b09240"]],[["","#5ab187","#408061"]]],"4RedToBlack":[[["","#000000","#000000"]],[["","#848484","#7c7c7c"]],[["","#eea0a2","#e99b9d"]],[["","#e07369","#9b514a"]]],"2Indicators":[[[r[0],"#e07369","#9b514a"]],[[r[1],"#5ab187","#408061"]]],"2Likes":[[[t[0],"#e07369","#9b514a"]],[[t[1],"#5ab187","#408061"]]],"3Flags":[[[n[0],"#e07369","#562f2b"]],[[n[0],"#e8bf50","#635328"]],[[n[0],"#52a37c","#264f3b"]]],"3HeartRating":[[["","transparent","#9b514a"]],[[d[0],"#9b514a","transparent"],[d[1],"#e07369","transparent"]],[["","#E07269","#E07269"]]],"3Heart":[[["","#e07369","#9b514a"]],[["","#E07269","#9b514a"]],[["","#E07269","#9b514a"]]],"2Love":[[[e[0],"#e07369","#9b514a"],[e[1],"transparent","#fff"]],[[e[0],"#E07269","#9b514a"],[e[1],"#fff","transparent"]]],"5Smileys":[[[s[0],"#fcd058","#B09240"],[s[1],"#3d3d3d","transparent"],[s[2],"#3d3d3d","transparent"]],[[f[0],"#fcd058","#B09240"],[f[1],"#3d3d3d","transparent"],[f[2],"#3d3d3d","transparent"]],[[p[0],"#fcd058","#B09240"],[p[1],"#3d3d3d","transparent"],[p[2],"#3d3d3d","transparent"]],[[c[0],"#fcd058","#B09240"],[c[1],"#3d3d3d","transparent"],[c[2],"#3d3d3d","transparent"]],[[b[0],"#fcd058","#B09240"],[b[1],"#3d3d3d","transparent"],[b[2],"#3d3d3d","transparent"]]],"3Symbols":[[["","#cf6a61","transparent"]],[["","#efc75a","transparent"]],[["","#52a37c","transparent"]]],"5Quarters":[[["","#DEDEDE","#989898"]],[[o[0],"#DEDEDE","#989898"],[o[1],"#000","transparent"]],[[B[0],"#DEDEDE","#989898"],[B[1],"#000","transparent"]],[[l[0],"#000","#989898"],[l[1],"#DEDEDE","transparent"]],[["","#989898","#989898"]]],"3Stars":[[["","#fff","#B09240"]],[["","transparent","#B09240"],["","#fcd058","transparent"]],[["","#fcd058","#B09240"]]],"5Weather":[[[C[0],"#a7d4f9","#5690c0"],[C[1],"#1d8ae0","#1671b9"]],[[i[0],"#a7d4f9","#5690c0"],[i[1],"#ff6f00","#e86907"]],[[E[0],"#a7d4f9","#5690c0"],[E[1],"#4c5fcd","transparent"]],[["","#a7d4f9","#5690c0"]],[[D[0],"#e0a322","#f1b129"],[D[1],"#a7d4f9","#5690c0"]]],Filter:[[[g[0],"#fff","transparent"],[g[1],"#7d7d7d","transparent"],[g[2],"#2d2d2d","transparent"]],[[h[0],"#6d6d6d","transparent"],[h[1],"#5d5d5d","transparent"],[h[2],"#fff","transparent"]]],Picklist:[[["","#7d7d7d","transparent"]]],PivotFilter:[[[g[0],"#fff","transparent"],[g[1],"#7d7d7d","transparent"],[g[2],"#2d2d2d","transparent"]],[[h[0],"#fff","transparent"],[h[1],"#7d7d7d","transparent"],[h[2],"#4ea47b","transparent"]],[[k[0],"#fff","transparent"],[k[1],"#7d7d7d","transparent"],[k[2],"#2d2d2d","transparent"],[k[3],"#2d2d2d","transparent"]],[[S[0],"#fff","transparent"],[S[1],"#7d7d7d","transparent"],[S[2],"#2d2d2d","transparent"],[S[3],"#2d2d2d","transparent"]],[[T[0],"#fff","transparent"],[T[1],"#dadada","transparent"],[T[2],"#19af5c","transparent"],[T[3],"#19af5c","transparent"]],[[L[0],"#fff","transparent"],[L[1],"#dadada","transparent"],[L[2],"#19af5c","transparent"],[L[3],"#19af5c","transparent"]]],Checkbox:[[[v[0],"#fff","transparent"],[v[1],"#8d8d8d","transparent"]],[[u[0],"#fff","transparent"],[u[1],"#1d1d1d","transparent"],[u[2],"#1d1d1d","transparent"]]]};a.IconSets=w}(this);
!function(e){var t=e.ZSGrid||{},i=e.ZSGrid.UIGrid,s=e.sPlusPlus,o=e.ZSClass,r=(o.Layer||(o.Layer={})).Interface,n=e.ZSEvents,a=n.topic,h=n.Groups,d=n.Names;function l(o,r,n,c,u,g,p,v,f,m,C,y){var w=document.createElement("div");w.classList.add("fifthPane"),this.fifthPane=w;var D=document.createElement("div");D.classList.add("lockCue"),this.lockCue=D,this.colFreezeCue=function(){var t=new UIFreezeCue;t.addClass("vCue grabCursor","vFCue grabCursor");var i=this,o=!1;function r(t){o=!0,t.preventDefault();var r=i.translateCoordinates(t),n=i.getRelativeCoordinateX(r.x),a=i.interacter,d=(a.getGridID(),a.getResourceID()),l=a.getSheetID(),c=a.getVersion(),u=s.data.getWorkBook(d,c),g=(u.getSheetObj(l),a.findCol(n)),p=e.Listener.Column.Freeze;p.mousedown.call(i,a,g),document.body.addEventListener("mouseup",h)}function n(e){i.colFreezeCue.showBodyDom(),i.colFreezeCue.bodyDom.classList.add("vFCueHover")}function a(e){o||(i.freezedCol||i.colFreezeCue.hideBodyDom(),i.colFreezeCue.bodyDom.classList.remove("vFCueHover"))}function h(e){o=!1,i.colFreezeCue.bodyDom.classList.remove("vFCueHover"),document.body.removeEventListener("mouseup",h)}return t.headerDom.addEventListener("mousedown",r),t.bodyDom.addEventListener("mousedown",r),t.bodyDom.addEventListener("mouseover",n),t.bodyDom.addEventListener("mouseleave",a),t.headerDom.addEventListener("mouseover",n),t.headerDom.addEventListener("mouseleave",a),t}.call(this),this.rowFreezeCue=function(){var t=new UIFreezeCue;t.addClass("hCue grabCursor","hFCue grabCursor");var i=this,o=!1;function r(t){o=!0,t.preventDefault();var r=i.translateCoordinates(t),a=i.getRelativeCoordinateY(r.y),h=i.interacter,d=(h.getGridID(),h.getResourceID()),l=h.getSheetID(),c=h.getVersion(),u=s.data.getWorkBook(d,c),g=(u.getSheetObj(l),h.findRow(a)),p=e.Listener.Row.Freeze;p.mousedown.call(i,t,h,g),document.body.addEventListener("mouseup",n)}function n(e){o=!1,i.colFreezeCue.bodyDom.classList.remove("vFCueHover"),document.body.removeEventListener("mouseup",n)}function a(e){i.rowFreezeCue.showBodyDom(),i.rowFreezeCue.bodyDom.classList.add("hFCueHover")}function h(e){o||(i.freezedRow||i.rowFreezeCue.hideBodyDom(),i.rowFreezeCue.bodyDom.classList.remove("hFCueHover"))}return t.headerDom.addEventListener("mousedown",r),t.bodyDom.addEventListener("mousedown",r),t.headerDom.addEventListener("mouseover",a),t.bodyDom.addEventListener("mouseover",a),t.headerDom.addEventListener("mouseleave",h),t.bodyDom.addEventListener("mouseleave",h),t}.call(this),this.isEdit=!0,function(){var e,i,s=devicePixelRatio;s<=1?(e=.9,i=.6):s<2?(e=1.5,i=1.25):(e=1,i=1);t.DivideFactor=i,t.ScaleFactor=e}(),i.call(this,o,r,n,c,u,g,p,v,f,m,C,y),m&&this.container.classList.add("gridFlip"),this.updateLock(),r.appendChild(w),r.appendChild(D),r.appendChild(this.colFreezeCue.headerDom),r.appendChild(this.colFreezeCue.bodyDom),r.appendChild(this.rowFreezeCue.headerDom),r.appendChild(this.rowFreezeCue.bodyDom),r.addEventListener("scroll",function(e){(this.scrollTop||this.scrollLeft)&&(this.scrollTop=0,this.scrollLeft=0)}),r.addEventListener("dragover",function(e){var t=o.getGridID();a.publish(h.Listener,d.UserAction.DRAG_DROP.DRAGOVER,{EVENT:e,DOM:this,GRID_ID:t})});for(var L=0;L<l.Layers.length;L++)l.Layers[L].call(this);this.setFonts("Lato")}function c(){var e=this.getWidths(),t=this.getHeights(),i=this.getFlip();this.colFreezeCue.setHeight(t[0]);this.getXs();this.colFreezeCue.setLeft(e[0]+e[1],i),this.freezedCol?this.colFreezeCue.showBodyDom():this.colFreezeCue.hideBodyDom();var o=this.getYs();this.rowFreezeCue.setTop(o[2]),this.rowFreezeCue.setWidth(e[0]),this.freezedRow?this.rowFreezeCue.showBodyDom():this.rowFreezeCue.hideBodyDom();var r=this.interacter.getGridID(),n=this.interacter.getResourceID(),a=this.interacter.getSheetID(),h=this.interacter.getVersion(),d=s.view.getSheetState2(r,n,a,h);d.setScreenWidths(e[2],e[1]),d.setScreenHeights(t[2],t[1])}l.prototype={getCenterPoint:function(){var e=this.getWidths(),t=this.getHeights(),i=this.getScrollXs(),s=this.getScrollYs();return{x:i[2]+e[2]+15-this.getWidth()/2,y:s[2]+t[2]+15-this.getHeight()/2}},setDimensions:function(e,t){i.prototype.setDimensions.call(this,e,t),this.panes.vScroll1&&this.panes.vScroll1.checkMaxRowLimit(this.interacter,this.freezedRow),this.panes.vScroll0&&this.panes.vScroll0.checkMaxRowLimit(this.interacter,this.interacter.getMaxRow()),this.panes.hScroll1&&this.panes.hScroll1.checkMaxColLimit(this.interacter,this.freezedCol),this.panes.hScroll0&&this.panes.hScroll0.checkMaxColLimit(this.interacter,this.interacter.getMaxColumn()),this.panes.vScroll0&&this.panes.vScroll0.updateMaxUsed(this.interacter,this.interacter.getMaxUsedRow()),this.panes.hScroll0&&this.panes.hScroll0.updateMaxUsed(this.interacter,this.interacter.getMaxUsedCol())},setInteracter:function(e){i.prototype.setInteracter.call(this,e),this.updateLock(),e.isSheetLocked()||!e.isEditable()?this.setEditable(!1):this.setEditable(!0)},setEditable:function(e){this.isEdit=e,e?this.container.classList.remove("readOnly"):this.container.classList.add("readOnly")},isEditable:function(){return this.isEdit},isInViewPort:function(e,t,i,s){return this.panes.isInViewPort(e,t,i,s)},isViewPortIntersects:function(e,t,i,s){return this.panes.isViewPortIntersects(e,t,i,s)},hideHeadersAndScrollbar:function(){this.panes.hideHeaders(),this.panes.hideScrollbars(),this.updateBoundary()},showHeadersAndScrollbar:function(){this.panes.showHeaders(),this.panes.showScrollbars(),this.updateBoundary()},hideHeaders:function(){this.panes.hideHeaders(),this.updateBoundary()},showHeaders:function(){this.panes.showHeaders(),this.updateBoundary()},hideScrollbars:function(){this.panes.hideScrollbars(),this.updateBoundary()},showScrollbars:function(){this.panes.showScrollbars(),this.updateBoundary()},onBeforeFill:function(){this.panes.onBeforeFill(this.interacter)},downloadGrid:function(e,t){this.toDataURL(e,this.getWidths()[0],this.getHeights()[0],Math.min(window.innerWidth-this.getWidths()[0],this.getWidths()[1]+this.getWidths()[2]),Math.min(window.innerHeight-this.getHeights()[0],this.getHeights()[1]+this.getHeights()[2]),2,t)},getCellRef:function(e,t,i,s,o){return this.interacter.getCell(s,o)},updateBoundary:function(){i.prototype.updateBoundary.call(this,c);var e=this.rect.getWidth(),t=this.rect.getHeight(),s=this.getWidths(),o=this.getHeights();this.getFlip()?(this.fifthPane.style.right=s[0]+"px",this.lockCue.style.right=s[0]+"px",this.fifthPane.style.left="",this.lockCue.style.left=""):(this.fifthPane.style.left=s[0]+"px",this.lockCue.style.left=s[0]+"px",this.fifthPane.style.right="",this.lockCue.style.right=""),this.fifthPane.style.top=o[0]+"px",this.lockCue.style.top=o[0]+"px",this.fifthPane.style.width=e-(s[0]+s[3])+"px",this.fifthPane.style.height=t-(o[0]+o[3])+"px",this.lockCue.style.width=e-(s[0]+s[3])+"px",this.lockCue.style.height=t-(o[0]+o[3])+"px"},setFlip:function(e){i.prototype.setFlip.call(this,e),e?this.container.classList.add("gridFlip"):this.container.classList.remove("gridFlip")},updateLock:function(){this.interacter.isSheetLocked()?(this.lockCue.style.display="",this.setEditable(!1)):(this.lockCue.style.display="none",this.setEditable(!0))},getScrollX:function(e,t){return e<t?this.getScrollXs()[1]:this.getScrollXs()[2]-this.getWidths()[1]},getScrollY:function(e,t){return e<t?this.getScrollYs()[1]:this.getScrollYs()[2]-this.getHeights()[1]},getRowHeaderWidth:function(){return this.panes.xAxles[0].getWidth()},getColumnHeaderHeight:function(){return this.panes.yAxles[0].getHeight()},getVSrollbarWidth:function(){return this.panes.xAxles[3].getWidth()},getHSrollbarHeight:function(){return this.panes.yAxles[3].getHeight()},download:function(e,t,i,s,o,r){r=r||".png";o=o||2,this.toDataURL(r,e,t,i,s,o,function(e){var t=document.createElement("a");t.download="image"+r,t.setAttribute("href",e),document.body.appendChild(t),t.click(),document.body.removeChild(t)})},setFonts:function(e){t.Font.AddFont(e)},toDataURL:function(t,i,s,o,r,n,a){var h=document.createElement("canvas"),d=h.getContext("2d"),l=e.devicePixelRatio||1;!function(e,t,i,s){var o=e.getContext("2d");s=s||1,e.width=t*s,e.height=i*s,e.style.width=t+"px",e.style.height=i+"px",o.scale(s,s)}(h,o*l,r*l);var c=this.canvas.getContext("2d").getImageData(i*l,s*l,o*l,r*l);d.putImageData(c,0,0);var u=h.toDataURL("image/"+t);(new Image).src=u,a(u)},getScrollPosition:function(e,t,i){var s=this.getHeights(),o=this.getWidths(),r=this.getScrollXs(),n=this.getScrollYs(),a=0,h=0;if(0==t){var d=s[0],l=i.y-d;e>0?a=r[2]+o[1]+o[2]:e<0&&(a=r[2]),h=l<s[1]?l-n[1]:l}else if(0==e){var c=o[0],u=i.x-c;t>0&&(h=n[2]+s[1]+s[2]),t<0&&(h=n[2]),a=u<o[1]?u-r[1]:u}else{d=s[0],c=o[0],l=i.y-d,u=i.x-c;e>0?a=r[2]+o[1]+o[2]:e<0&&(a=r[2]),t>0&&(h=n[2]+s[1]+s[2]),t<0&&(h=n[2])}return{rangeX:a,rangeY:h}}},l.Layers=[];var u=[i];l.prototype=r.implement(l,u),e.ZSGrid.UISheetGrid=l}(this);
!function(e){var o=e.ZSClass,t=e.ZSDevTools,n=o.Layer||(o.Layer={}),r=n.Modules||(n.Modules={}),l=r.Clone||(r.Clone={});function i(){t.error("CloneController: implemetation required")}i.prototype={clone:function(e,o){this.Master.clone(o)},onClone:function(e){var o=this.getActive();for(var t in o){var n=this.getInteracter(t);e.clone(n),this.State.onClone(t,n,e),this.Views.onClone(t,n,e),this.Network.onClone(t,n,e)}}},l.Controller=i}(this);
!function(t){var e=t.ZSClass,s=(t.ZSDevTools,e.Layer||(e.Layer={})),o=s.Modules||(s.Modules={}),i=o.Clone||(o.Clone={});function n(t,e){this.setOffset(t,e)}n.prototype={clone:function(t){t.clone();var e=t.getX()+this.x,s=t.getY()+this.y;t.setPosition(e,s)},setOffset:function(t,e){this.x=t,this.y=e}},i.Helper=n}(this);
!function(o){var t=o.ZSClass,e=o.ZSDevTools,n=t.Layer||(t.Layer={}),s=n.Modules||(n.Modules={}),i=s.Focus||(s.Focus={});function u(){e.error("FocusController: implemetation required")}u.prototype={mouseover:function(o){this.onMouseOver(o)},mouseleave:function(o){this.onMouseLeave(o)},scrollIntoView:function(o){var t=this.getInteracter(o);this.onScrollIntoView(o,t)},focus:function(o){this.Master.onFocus(this),this.onFocus(o)},blur:function(o){this.Master.onBlur(),this.onBlur(o)},focusAll:function(o,t,e){this.Master.focusAll(o,t,e)},blurAll:function(o,t,e){this.Master.blurAll(o,t,e)},onMouseOver:function(o){this.State.onMouseOver(o),this.Views.onMouseOver(o),this.Network.onMouseOver(o)},onMouseLeave:function(o){this.State.onMouseLeave(o),this.Views.onMouseLeave(o),this.Network.onMouseLeave(o)},onScrollIntoView:function(o,t){this.State.onScrollIntoView(o,t),this.Views.onScrollIntoView(o,t),this.Network.onScrollIntoView(o,t)},onFocus:function(o){this.State.onFocus(o),this.Views.onFocus(o),this.Network.onFocus(o)},onBlur:function(o){this.State.onBlur(o),this.Views.onBlur(o),this.Network.onBlur(o)},onFocusAll:function(o,t,e){var n=this.getAlive();for(var s in n)this.onFocus(s)},onBlurAll:function(o){var t=this.getActive();for(var o in t)this.onBlur(o)}},i.Controller=u}(this);
!function(o){var i=o.ZSClass,s=o.ZSDevTools,e=i.Layer||(i.Layer={}),n=e.Modules||(e.Modules={}),r=n.Focus||(n.Focus={});function t(){s.error("FocusViewControl: implemetation required")}t.prototype={onMouseOver:function(o){for(var i in this.Views){this.Views[i].onMouseOver(o)}},onMouseLeave:function(o){for(var i in this.Views){this.Views[i].onMouseLeave(o)}},onFocus:function(o){for(var i in this.Views){this.Views[i].onFocus(o)}},onBlur:function(o){for(var i in this.Views){this.Views[i].onBlur(o)}}},r.ViewControl=t}(this);
!function(o){var s=o.ZSClass,e=o.ZSDevTools,t=s.Layer||(s.Layer={}),i=t.Modules||(t.Modules={}),u=i.Focus||(i.Focus={});function r(){e.error("FocusLayer: implemetation required")}r.prototype={onMouseOver:function(){this.Dom.classList.add("hover")},onMouseLeave:function(){this.Dom.classList.remove("hover")},onFocus:function(){this.Dom.classList.add("focus")},onBlur:function(){this.Dom.classList.remove("focus")}},u.Layer=r}(this);
!function(e){var t,s=e.ZSClass,o=(e.sPlusPlus,s.Layer||(s.Layer={})),r=o.Modules||(o.Modules={}),n=r.Focus||(r.Focus={}),i=(e.JSUtil.Mouse.BindEvents,!1);function u(e){i=!0}function l(s){if(!i){var o=t.getController(),r=t.getID();o.scrollIntoView(r)}e.removeEventListener("mousemove",u),e.removeEventListener("mouseup",l)}n.Listeners={mouseover:function(e){var t=this.getController(),s=this.getID();t.getInteracter(s).isEditable()&&t.mouseover(s)},mouseleave:function(e){var t=this.getController(),s=this.getID();t.getInteracter(s).isEditable()&&t.mouseleave(s)},focuslayer:function(s){var o=this.getController(),r=this.getID();o.getInteracter(r).isEditable()&&(s.preventDefault(),s.stopPropagation(),i=!1,t=this,o.blurAll(),e.addEventListener("mousemove",u),e.addEventListener("mouseup",l),o.focus(r))}}}(this);
!function(o){var e=o.ZSClass,t=o.ZSDevTools,u=e.Layer||(e.Layer={}),n=u.Modules||(u.Modules={}),s=n.Focus||(n.Focus={});function r(){t.error("FocusRouter: implemetation required")}r.prototype={onMouseOver:function(o){this.get(o).onMouseOver()},onMouseLeave:function(o){this.get(o).onMouseLeave()},onFocus:function(o){this.get(o).onFocus()},onBlur:function(o){this.get(o).onBlur()}},s.Router=r}(this);
!function(e){var o=e.ZSClass,t=e.ZSDevTools,n=o.Layer||(o.Layer={}),r=n.Modules||(n.Modules={}),i=r.Move||(r.Move={});function v(){t.error("MoveController: implementation required")}v.prototype={move:function(e,o){this.Master.move(o)},moveEnd:function(e,o){this.Master.moveEnd(o)},onMove:function(e){var o=this.getActive();for(var t in o){var n=this.getInteracter(t);e.move(n),this.State.onMove(t,n,e),this.Views.onMove(t,n,e),this.Network.onMove(t,n,e)}},onMoveEnd:function(e){var o=this.getActive();for(var t in o){var n=this.getInteracter(t);e.moveEnd(n),this.State.onMoveEnd(t,n,e),this.Views.onMoveEnd(t,n,e),this.Network.onMoveEnd(t,n,e)}}},i.Controller=v}(this);
!function(o){var e=o.ZSClass,n=o.ZSDevTools,t=e.Layer||(e.Layer={}),i=t.Modules||(t.Modules={}),r=i.Move||(i.Move={});function s(){n.error("MoveViewControl: implementation required")}s.prototype={onMove:function(o,e,n){this.onPlace(o,e)},onMoveEnd:function(o,e,n){this.onPlace(o,e)}},r.ViewControl=s}(this);
!function(t){var i=t.ZSClass,e=(t.ZSDevTools,i.Layer||(i.Layer={})),s=e.Modules||(e.Modules={}),c=s.Move||(s.Move={});function o(t,i,e,s){this.x=t,this.y=i,this.xCallBack=e,this.yCallBack=s}o.prototype={move:function(t){var i=this.x+t.getX(),e=this.y+t.getY();i<=0?i=0:this.xCallBack&&this.xCallBack(),e<=0?e=0:this.yCallBack&&this.yCallBack(),t.setPosition(i,e)},moveEnd:function(){}};var a=0,h=1,l=2,y=3;function k(t,i,e){this.direction=t,this.shiftKey=i,this.callBack=e}k.prototype={move:function(t){var i=t.getX(),e=t.getY();switch(this.direction){case a:i=this.shiftKey?t.getNextRightStickyX():t.getLeftStickyX();break;case h:i=this.shiftKey?t.getRightStickyX():t.getNextLeftStickyX();break;case l:e=this.shiftKey?t.getNextBottomStickyY():t.getTopStickyY();break;case y:e=this.shiftKey?t.getBottomStickyY():t.getNextTopStickyY()}this.callBack&&this.callBack(),t.setPosition(i,e),t.scrollIntoView()},moveEnd:function(){}},c.Helper=o,c.StickyHelper=k}(this);
!function(t){var e,n,o=t.ZSClass,r=(t.sPlusPlus,o.Layer||(o.Layer={})),s=r.Modules||(r.Modules={}),i=s.Move||(s.Move={}),a=i.Helper,g=t.JSUtil.Mouse.BindEvents;function l(t){var e=this.getID(),n=this.getController(),o=this.getRouter().getPane(),r=n.getInteracter(e).getCoordinates(t,o);u.call(this,r.x,r.y)}function u(t,o){var r=this.getID(),s=this.getController();var i=new a(t-e,o-n,function(){e=t},function(){n=o});s.move(r,i)}function h(t){var o=this.getID(),r=this.getController(),s=this.getRouter().getPane(),i=r.getInteracter(o).getCoordinates(t,s),g=i.x-e,l=i.y-n,u=new a(g,l);r.moveEnd(o,u)}i.Listeners={mousedown:function(t){var o=this.getController(),r=this.getID(),s=o.getInteracter(r);if(s.isEditable()){var i=this.getRouter().getPane(),a=s.getCoordinates(t,i);e=a.x,n=a.y,t.preventDefault(),t.stopPropagation(),g.call(this,l,h)}},update:u}}(this);
!function(e){var i=e.ZSClass,t=e.ZSDevTools,s=i.Layer||(i.Layer={}),r=s.Modules||(s.Modules={}),n=r.Resize||(r.Resize={});function o(){t.error("ResizeController: implementation required")}o.prototype={resize:function(e,i){this.Master.resize(i)},resizeEnd:function(e,i){this.Master.resizeEnd(i)},onResize:function(e){var i=this.getActive();for(var t in i){var s=this.getInteracter(t);e.resize(s),this.State.onResize(t,s,e),this.Views.onResize(t,s,e),this.Network.onResize(t,s,e)}},onResizeEnd:function(e){var i=this.getActive();for(var t in i){var s=this.getInteracter(t);e.resizeEnd(s),this.State.onResizeEnd(t,s,e),this.Views.onResizeEnd(t,s,e),this.Network.onResizeEnd(t,s,e)}}},n.Controller=o}(this);
!function(e){var i=e.ZSClass,o=e.ZSDevTools,s=i.Layer||(i.Layer={}),n=s.Modules||(s.Modules={}),t=n.Resize||(n.Resize={});function r(){o.error("MoveViewControl: implementation required")}r.prototype={onResize:function(e,i,o){for(var s in this.Views){this.Views[s].onResize(e,i,o)}},onResizeEnd:function(e,i,o){for(var s in this.Views){this.Views[s].onResizeEnd(e,i,o)}}},t.ViewControl=r}(this);
!function(i){var t=i.ZSClass,h=(i.ZSDevTools,t.Layer||(t.Layer={})),s=h.Modules||(h.Modules={}),e=s.Resize||(s.Resize={});function o(i,t,h,s,e){this.point=i,this.X=t,this.Y=h,this.width=s,this.height=e,this.ratio=s/e,this.isFixedRatio=!i.isFixedWidth()&&!i.isFixedHeight(),this.shiftKey=!1}o.prototype={updateCoordinate:function(i,t,h){if(this.shiftKey=h,this.isFixedRatio&&h){var s=this.point.fixRight!=this.point.fixBottom?-1:1,e=this.X+(this.point.fixRight?0:this.width)-i,o=this.Y+(this.point.fixBottom?0:this.height)-t;this.point.fixBottom&&e*s>o*this.ratio||!this.point.fixBottom&&e*s<o*this.ratio?(this.currX=i,this.currY=this.Y+(this.point.fixBottom?0:this.height)-s*e/this.ratio):(this.currX=this.X+(this.point.fixRight?0:this.width)-s*o*this.ratio,this.currY=t)}else this.currX=i,this.currY=t},resize:function(i){var t=this.point,h=t.isFixedRight(),s=t.isFixedBottom(),e=t.isFixedWidth(),o=t.isFixedHeight(),r=this.X,d=this.Y,n=this.width,a=this.height;if(!e){r=h?this.currX:this.X;n=h?this.width-(this.currX-this.X):this.currX-this.X}if(!o){d=s?this.currY:this.Y;a=s?this.height-(this.currY-this.Y):this.currY-this.Y}var u=i.getMinimumDimension();n<u.width&&(this.isFixedRatio&&this.shiftKey?(u.width/this.ratio<u.height?n=(a=u.height)*this.ratio:a=(n=u.width)/this.ratio,s&&(d=this.Y+this.height-a)):n=u.width,h&&(r=this.X+this.width-n)),a<u.height&&(this.isFixedRatio&&this.shiftKey?(u.height*this.ratio<u.width?a=(n=u.width)/this.ratio:n=(a=u.height)*this.ratio,h&&(r=this.X+this.width-n)):a=u.height,s&&(d=this.Y+this.height-a)),i.setPosition(r,d),i.setDimension(n,a)},resizeEnd:function(){}},e.Helper=o}(this);
!function(e){var t=e.ZSClass,i=e.ZSDevTools,s=t.Layer||(t.Layer={}),n=s.Modules||(s.Modules={}),o=n.Resize||(n.Resize={});function a(e,t){var i=document.createElement("div");i.className="mOleCue",this.dom=i;var s=document.createElement("span");i.appendChild(s),s.dataset.key=e,this.span1=s,(s=document.createElement("span")).dataset.key=t,i.appendChild(s),this.span2=s}function h(){i.error("ResizeLayer: implemetation required")}a.prototype={show:function(e){e.appendChild(this.dom)},remove:function(){this.dom.remove()},setValues:function(e,t){this.span1.innerText=e,this.span2.innerText=t},setPosition:function(e,t,i,s){var n="mOleCue cue";t||(n+=s?"t":"b"),e||(n+=i?"l":"r"),this.dom.className=n}},h.prototype={onResize:function(e,t){var i=e.getX(),s=e.getY(),n=e.getWidth(),o=e.getHeight();this.onPlace(i,s,n,o),function(e,t){this.cue||(this.cue=new a("Width","Height"));var i=t.point;this.cue.show(this.Dom),this.cue.setPosition(i.isFixedWidth(),i.isFixedHeight(),i.isFixedRight(),i.isFixedBottom()),this.cue.setValues(~~e.getWidth()+"px",~~e.getHeight()+"px")}.call(this,e,t)},onResizeEnd:function(e,t){var i=e.getX(),s=e.getY(),n=e.getWidth(),o=e.getHeight();this.onPlace(i,s,n,o),function(){this.cue.remove()}.call(this)}},o.Layer=h}(this);
!function(t){var e,n,o=t.ZSClass,i=(t.sPlusPlus,o.Layer||(o.Layer={})),s=i.Utility,l=i.Modules||(i.Modules={}),T=l.Resize||(l.Resize={}),u=T.Helper,h=t.JSUtil.Mouse.BindEvents,a={TOP:new s.Point(1,1,1,0),BOTTOM:new s.Point(1,0,1,0),LEFT:new s.Point(1,1,0,1),RIGHT:new s.Point(0,1,0,1),TOPLEFT:new s.Point(1,1,0,0),TOPRIGHT:new s.Point(0,1,0,0),BOTTOMLEFT:new s.Point(1,0,0,0),BOTTOMRIGHT:new s.Point(0,0,0,0)};function r(t){var o=this.getController(),i=this.getID();o.getInteracter(i).isEditable()&&(n=new u(e,this.left,this.top,this.width,this.height),t.preventDefault(),t.stopPropagation(),h.call(this,c,f))}function c(t){var e=this.getController(),o=this.getID(),i=this.getRouter().getPane(),s=e.getInteracter(o).getCoordinates(t,i);n.updateCoordinate(s.x,s.y,t.shiftKey),e.resize(o,n)}function f(t){var e=this.getID();this.getController().resizeEnd(e,n)}T.Listeners={TopLeft:{mousedown:function(t){e=a.TOPLEFT,r.call(this,t)}},TopRight:{mousedown:function(t){e=a.TOPRIGHT,r.call(this,t)}},BottomRight:{mousedown:function(t){e=a.BOTTOMRIGHT,r.call(this,t)}},BottomLeft:{mousedown:function(t){e=a.BOTTOMLEFT,r.call(this,t)}},Top:{mousedown:function(t){e=a.TOP,r.call(this,t)}},Right:{mousedown:function(t){e=a.RIGHT,r.call(this,t)}},Bottom:{mousedown:function(t){e=a.BOTTOM,r.call(this,t)}},Left:{mousedown:function(t){e=a.LEFT,r.call(this,t)}}}}(this);
!function(e){var i=e.ZSClass,o=e.ZSDevTools,s=i.Layer||(i.Layer={}),t=s.Modules||(s.Modules={}),n=t.Resize||(t.Resize={});function r(){o.error("ResizeRouter: implemetation required")}r.prototype={onResize:function(e,i,o){this.get(e).onResize(i,o)},onResizeEnd:function(e,i,o){this.get(e).onResizeEnd(i,o)}},n.Router=r}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSClass,o=s.Layer||(s.Layer={}),r=o.RangeSelection||(o.RangeSelection={}),i=e.ZSEvents,u=i.topic,l=i.Groups,n=i.Names,g={class:"rangeSelection",filler:!0,edges:{top:{mousedown:function(e){c.call(this,e,0,3)},mouseup:d,mouseover:m},bottom:{mousedown:h,mouseup:d,mouseover:m},left:{mousedown:function(e){c.call(this,e,3,0)},mouseup:d,mouseover:m},right:{mousedown:h,mouseup:d,mouseover:m}}},a=!1;function m(e){a||(this.edges.bottom.Dom.style.cursor="grab",this.edges.bottom.Dom.style.cursor="-webkit-grab",this.edges.top.Dom.style.cursor="grab",this.edges.top.Dom.style.cursor="-webkit-grab",this.edges.left.Dom.style.cursor="grab",this.edges.left.Dom.style.cursor="-webkit-grab",this.edges.right.Dom.style.cursor="grab",this.edges.right.Dom.style.cursor="-webkit-grab")}function c(s,o,r){var i;a=!0,s.stopPropagation(),s.preventDefault(),(i=this).edges.bottom.Dom.style.cursor="",i.edges.top.Dom.style.cursor="",i.edges.left.Dom.style.cursor="",i.edges.right.Dom.style.cursor="";var g=t.view.getActiveGridID(),m=t.view.getGridComponent(g),c=m.translateCoordinates(s),h=m.getRelativeCoordinates(c.x,c.y);h.x+=o,h.y+=r;var v=t.view.getSheetID(g),b=t.view.getSheetState(g,v).getActiveRange();u.publish(l.Listener,n.Mouse.DragStart,{COLX:h.x,ROWY:h.y,RANGE:b}),e.addEventListener("mouseup",d)}function d(){a=!1,e.removeEventListener("mouseup",d)}function h(e){c.call(this,e,0,0)}r.Model=g,r.ReadOnlyModel={class:"rangeSelection",filler:!0,edges:{top:!1,bottom:!1,left:!1,right:!1}}}(this);
!function(e){var t=e.ZSClass,l=t.Layer||(t.Layer={});(l.Selection||(l.Selection={})).Model={class:"cellSelection",edges:{top:!0,bottom:!0,left:!0,right:!0}}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSClass,s=e.ZSEvents,o=s.topic,r=s.Groups,a=s.Names,n=e.ZSConstants.I18N,l=(t=e.sPlusPlus,(i=e.ZSClass).Layer||(i.Layer={})),S={class:"fillSeriesCue",corners:{br:{mousedown:function(i){i.stopPropagation(),i.returnValue=!1;var s=t.view.getActiveGridID(),n=t.view.getGridComponent(s).translateCoordinates(i),l=this.getRouter().getPane(),S=l.getRelativeCoordinates(n.x,n.y),u=e.JSUtil.Key.getKeyCombination(i)===e.ZSConstants.JSKeyCode.SUPER+"+"+i.which;o.publish(r.Listener,a.Mouse.FillStart,{GRIDID:s,COORDINATES:S,ISCTRLPRESSED:u,PANE:l})},dblclick:function(e){e.stopPropagation(),e.preventDefault();var s=t.view.getActiveGridID(),o=t.view.getResourceID(s),r=t.view.getSheetID(s),a=t.view.getVersionID(s),l=t.view.getSheetState(s,r),S=t.view.getSelectedSheets(s),u=l.getActiveRange(),v=t.data.getWorkBook(o,a).getSheetObj(r).Pivot;if(v&&v.isXists(u.startRow,u.startCol))return void i.ZSAlert(n["Error.Pivot.Table.Part.Change"]);UserAction.FillSeriesAuto(o,S,a,u)}}}};(l.FillSeriesSelectionCue||(l.FillSeriesSelectionCue={})).Model=S}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSClass,i=n.Layer||(n.Layer={}),o=i.RangePicker||(i.RangePicker={}),r=n.SelectorHelper.Constants.POINT,s=e.ZSEvents,a=s.topic,g=s.Groups,u=s.Names,c=n.Range,v={class:"rangePicker",filler:!0,corners:{tl:{mousedown:function(e){l(e);var t=this.getID(),i=n.RangePicker.State.get(t);d(t,e,i.endRow,i.endCol,r.LEFT_TOP)}},tr:{mousedown:function(e){l(e);var t=this.getID(),i=n.RangePicker.State.get(t);d(t,e,i.endRow,i.startCol,r.RIGHT_TOP)}},bl:{mousedown:function(e){l(e);var t=this.getID(),i=n.RangePicker.State.get(t);d(t,e,i.startRow,i.endCol,r.LEFT_BOTTOM)}},br:{mousedown:function(e){l(e);var t=this.getID(),i=n.RangePicker.State.get(t);d(t,e,i.startRow,i.startCol,r.RIGHT_BOTTOM)}}},edges:{top:!0,bottom:!0,left:!0,right:!0}},R=document.body;function l(e){e.preventDefault(),e.stopPropagation()}function d(e,n,i,o,r){a.publish(g.Listener,u.RangePicker.Modify,{index:e});var s=t.view.getActiveGridID(),v=t.view.getResourceID(s),l=t.view.getSheetID(s),d=t.view.getVersionID(s),T=t.view.getGridComponent(s),D=T.translateCoordinates(n),E=T.getRelativeCoordinates(D.x,D.y),S=new c(i,o,i,o);a.publish(g.Gesture.Selector.RangePicker,u.GESTURE.ACTION.START,{RID:v,SHEETID:l,VERSION:d,COLX:E.x,ROWY:E.y,point:r,fixedRange:S}),R.addEventListener("mousemove",I),R.addEventListener("mouseup",w)}function I(e){l(e);var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),o=t.view.getSheetID(n),r=t.view.getVersionID(n),s=t.view.getGridComponent(n),c=s.translateCoordinates(e),v=s.getRelativeCoordinates(c.x,c.y);a.publish(g.Gesture.Selector.RangePicker,u.GESTURE.ACTION.MOVE,{RID:i,SHEETID:o,VERSION:r,COLX:v.x,ROWY:v.y})}function w(e){l(e),a.publish(g.Listener,u.RangePicker.Disable),R.removeEventListener("mousemove",I),R.removeEventListener("mouseup",w)}o.Model=v}(this);
!function(s){s.sPlusPlus;var e=s.ZSClass,l=s.ZSEvents,i=(l.topic,l.Groups,l.Names,s.sPlusPlus,(e=s.ZSClass).Layer||(e.Layer={}));(i.FillSeriesSelection||(i.FillSeriesSelection={})).Model={class:"fillSeriesSelection",edges:{top:!0,bottom:!0,left:!0,right:!0}}}(this);
!function(e){e.sPlusPlus;var t=e.ZSClass,o=t.Layer||(t.Layer={});(o.CopySelection||(o.CopySelection={})).Model={class:"cutCopySelection",edges:{top:!0,bottom:!0,left:!0,right:!0}}}(this);
!function(e){e.sPlusPlus;var t=e.ZSClass,l=t.Layer||(t.Layer={});(l.DragSelection||(l.DragSelection={})).Model={class:"dragSelection",filler:!0,edges:{top:!0,bottom:!0,left:!0,right:!0}}}(this);
!function(e){e.sPlusPlus;var a=e.ZSClass,s=a.Layer||(a.Layer={});(s.HeaderDragSelection||(s.HeaderDragSelection={})).Model={class:"dragHeader",edges:{top:!0,left:!0}}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSClass,n=(e.UserAction,i.Editors.BasicEditor),s=i.Range,o="CellNoteTemplate",r="CellNoteHolder",l="http://www.w3.org/2000/svg";function a(t){var i=JSUtil.Key.getKeyCombination(t),n=e.ZSConstants.JSKeyCode;switch(i){case n.SUPER+"+"+n.SHIFT+"+"+n.ENTER:case n.SUPER+"+"+n.ENTER:return!0}}function h(e,t,i){for(var n in t)e.addEventListener(n,t[n].bind(i))}function c(e,t,i,s){this.Dom=function(e,t){var i=document.createElement("div");return t&&(i.className=t),e.appendChild(i),i}(e,r),this.line=function(e){var t=document.createElementNS(l,"svg");t.setAttribute("class","CellNoteLine");var i=document.createElementNS(l,"line");return i.setAttribute("x1",0),i.setAttribute("y1",0),t.appendChild(i),e.appendChild(t),i}(this.Dom),this.setLineCoordinates(0,0),function(e,t){var i=e.Dom,s=document.querySelector("#"+o).content.cloneNode(!0);i.appendChild(s);var r=i.querySelector(".CNEditor"),l=i.querySelector(".CNTrash");e.Comment=new n(r),e.Comment.customPreventDefault=a,e.CellInfo=i.querySelector(".CNInfo"),e.Trash=l,h(i,t.Container,this),h(r,t.Editor,this),h(l,t.Trash,this)}.call(i,this,t),this.onHide=t.onHide,this.Layer=i,this.ID=s,this.hide()}c.prototype={hide:function(){this.onHide&&this.onHide(),this.Dom.style.display="none",this.Comment.blur()},show:function(){this.Dom.style.display=""},focus:function(){this.Comment.focus();var e=this.Comment.value.length;this.Comment.setSelectionRange(e,e)},place:function(e,t,i,n,s){var o=this.Dom,r=o.style;this.x=e,this.y=t,s?(r.right=i?"":e+"px",r.left=i?e+"px":""):(r.left=i?"":e+"px",r.right=i?e+"px":""),r.top=n?"":t+"px",r.bottom=n?t+"px":"";var l=o.classList;n?l.add("fixB"):l.remove("fixB"),s?i?l.remove("fixR"):l.add("fixR"):i?l.add("fixR"):l.remove("fixR")},enable:function(){this.Comment.enable(),this.Trash.style.display=""},disable:function(){this.Comment.disable(),this.Trash.style.display="none"},setComment:function(e,t,i,n){this.range=new s(e,t,e,t),this.isAdd=!!n,this.CellInfo.dataset.cell=JSUtil.Cell.getReference(e,t),this.Comment.value=i},setLineCoordinates:function(e,t){this.line.setAttribute("x2",e),this.line.setAttribute("y2",t)},update:function(){var n=t.view.getActiveGridID(),s=t.view.getResourceID(n),o=t.view.getVersionID(n),r=t.view.getSheetID(n),l=this.Comment.value,a=this.isAdd?"add":"edit",h=this.Layer.getController(),c=new i.Layer.Notes.Interacter(e.interacter,s,r,o,null,null,l,null,null);h.CellComment(c,a,l,this.range)},delete:function(){var n=t.view.getActiveGridID(),s=t.view.getResourceID(n),o=t.view.getVersionID(n),r=t.view.getSheetID(n),l=this.Layer.getController(),a=new i.Layer.Notes.Interacter(e.interacter,s,r,o);l.CellComment(a,"remove","",this.range)}},i.UICellNote=c}(this);
!function(s){var i=s.ZSClass,h=i.Layer||(i.Layer={});(h.HighlightLocks||(h.HighlightLocks={})).Model={class:"highlightLocks"}}(this);
!function(t){var i=t.ZSClass,e=i.Layer||(i.Layer={});(e.HighlightComments||(e.HighlightComments={})).Model={class:"highlightCmt",filler:!0,edges:{top:!0,left:!0,bottom:!0,right:!0}}}(this);
!function(s){s.sPlusPlus;var a=s.ZSClass,l=a.Layer||(a.Layer={});(l.RecalculateFlash||(l.RecalculateFlash={})).Model={class:"rFlash"}}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSClass,s=n.Layer||(n.Layer={}),o=s.DataValidation||(s.DataValidation={}),r=(e.data.Defaults.MAX_COL,t.ZSEvents);r.topic,r.Groups,r.Names;function i(t){!function(t,e){var n=document.createElement("div");n.className=e;var s=document.querySelector("#dv_hint").content.cloneNode(!0);t.appendChild(n).appendChild(s)}(t,"dvHintCont"),this.content=t.querySelector("#hintText"),this.errorMsg=t.querySelector("#eMsg")}i.prototype={setContent:function(t){this.content.innerText=t},showErrorMessage:function(){this.errorMsg.style.display=""},hideErrorMessage:function(){this.errorMsg.style.display="none"}},o.UIDVHint=i}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSClass,n=i.Layer||(i.Layer={}),o=n.DataValidationButton||(n.DataValidationButton={}),a=e.ZSEvents,l=a.topic,s=a.Groups,r=a.Names,u={class:"dvListBtn dvListBtnC",filler:{mousedown:function(n){var o=t.view.getActiveGridID(),a=t.view.getResourceID(o),u=t.view.getVersionID(o),c=t.data.getWorkBook(a,u),D=t.view.getSheetID(o),d=(c.getSheetObj(D),t.view.getGridComponent(o)),v=d.translateCoordinates(n),S=d.getRelativeCoordinates(v.x,v.y),E=d.interacter.findRow(S.y),g=d.interacter.findCol(S.x);t.view.getSheetState(o,D);setTimeout(function(){t.view.fetchCellData(a,D,u,E,g,["DisplayValue"],o,function(e){l.publish(s.Selector.BoundUpdate.CellEdit,r.Selection.BOUND_UPDATE.ADD,{RID:a,SHEETID:D,VERSION:u,RANGE:new i.Range(E,g,E,g),RANGEID:0}),l.publish(s.Listener,r.CellAction.VALUE.SET,{RID:a,SHEETID:D,VERSION:u,ROW:E,COL:g,VALUE:{DisplayValue:e[E][g].DisplayValue},FOCUS:!0})},function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)})},0)},mouseover:function(e){},mouseleave:function(e){}}};o.Model=u}(this);
!function(t){t.sPlusPlus;var s=t.ZSClass,e=s.Layer||(s.Layer={});(e.PasteWidget||(e.PasteWidget={})).Model={class:"pasteWidget",edges:{top:!0,left:!0,bottom:!0,right:!0}}}(this);
!function(e){e.sPlusPlus;var t=e.ZSClass,r=(e.UserAction,t.Range,"Precedance"),i="http://www.w3.org/2000/svg";function n(e){this.Dom=function(e,t){var r=document.createElement("div");return t&&(r.className=t),e.appendChild(r),r}(e,r),this.line=function(e){var t=document.createElementNS(i,"svg");t.setAttribute("class","PrecedanceLine");var r=document.createElementNS(i,"defs"),n=document.createElementNS(i,"marker");n.setAttribute("id","arrow"),n.setAttribute("markerWidth","10"),n.setAttribute("markerHeight","10"),n.setAttribute("refX","9"),n.setAttribute("refY","3"),n.setAttribute("orient","auto"),n.setAttribute("markerUnits","strokeWidth");var a=document.createElementNS(i,"path");a.setAttribute("d","M0,0 L0,6 L9,3 z"),n.appendChild(a),r.appendChild(n),t.appendChild(r);var s=document.createElementNS(i,"line");return s.setAttribute("x1",0),s.setAttribute("y1",0),s.setAttribute("marker-end","url(#arrow)"),t.appendChild(s),e.appendChild(t),s}(this.Dom),this.setLineCoordinates(0,0)}n.prototype={},t.UIPrecedance=n}(this);
!function(e){e.sPlusPlus;var t=e.ZSClass,g=t.Layer||(t.Layer={});(g.RangeHighlight||(g.RangeHighlight={})).Model={class:"rangeHighlighter",filler:!0,edges:{top:!0,bottom:!0,left:!0,right:!0}}}(this);
!function(e){e.sPlusPlus;var s=e.ZSClass,o=s.Layer||(s.Layer={}),r={class:"userPresence",filler:!0,edges:{top:{mouseover:t,mouseleave:u},left:{mouseover:t,mouseleave:u},bottom:{mouseover:t,mouseleave:u},right:{mouseover:t,mouseleave:u}}};function t(){this.getController().mouseOver(this.getID())}function u(){this.getController().mouseLeave(this.getID())}(o.UserPresence||(o.UserPresence={})).Model=r}(this);
!function(e){e.sPlusPlus;var o=e.ZSClass,s=o.Layer||(o.Layer={}),t=s.PivotPlaceHolder||(s.PivotPlaceHolder={}),l=e.ZSConstants.I18N,r=s.Modules.Focus.Listeners;var i={class:"ZSOle PivotPlaceHolder",Listeners:{mouseover:r.mouseover,mouseleave:r.mouseleave,mousedown:function(e){this.Dom.querySelector("#divtxt2").innerText=l["Pivot.PlaceHolder.Content.Click"]}},edges:{top:!0,bottom:!0,left:!0,right:!0}};t.Model=i}(this);
!function(o){var e=o.ZSClass,t=e.Layer||(e.Layer={}),s=t.Button||(t.Button={});function n(){var o=document.createElement("div"),t=document.createElement("div");o.classList.add("ZSOLEBtn"),t.classList.add("ZSBtnEditor"),o.appendChild(t),this.Dom=o,this.Editor=new e.Editors.BasicEditor(t)}n.prototype={onSetLabel:function(o){this.Editor.value=o},showLoader:function(){this.Dom.classList.add("loading")},hideLoader:function(){this.Dom.classList.remove("loading")},appendTo:function(o){o.appendChild(this.Dom)},remove:function(){this.Dom.remove()}},s.UIButton=n}(this),function(o){var e=o.ZSClass,t=e.Layer||(e.Layer={}),s=t.Button||(t.Button={}),n=t.Modules,u=n.Move,i=n.Resize,r=n.Focus,a=u.Listeners,d=i.Listeners,l=r.Listeners,c=o.ZSEvents,m=c.topic,w=c.Groups,f=c.Names,v=o.JSUtil.Mouse.Register,p=o.JSUtil.Mouse.BindEvents;var L={class:"ZSOle",Listeners:{mouseover:l.mouseover,mouseleave:l.mouseleave,mousedown:function(e){var t=this,s=o.navigator.platform.contains("Mac")?e.metaKey:e.ctrlKey,n=t.getController().State.selectedButton===t.getID();e.preventDefault(),e.stopPropagation(),v.call(this,e,function(o){var e=t.getController(),u=t.getID();!e.getInteracter(u).isScriptAvailable()||s||n?l.focuslayer.call(t,o):e.executeScript(u)},function(o){(s||n)&&(t.getController(),!n&&l.focuslayer.call(t,o),a.mousedown.call(t,o),m.publish(w.Listener,f.Mouse.ScrollOut,{GRIDID:sPlusPlus.view.getActiveGridID(),CALLBACK:function(o,e,s,n,u,i){a.update.call(t,u,i)}}),document.body.classList.add("grabCursor"),p.call(this,function(){},function(){document.body.classList.remove("grabCursor")}))},function(o){l.focuslayer.call(t,o)})},dblclick:function(o){o.preventDefault(),o.stopPropagation()}},corners:{tl:{mousedown:d.TopLeft.mousedown},tr:{mousedown:d.TopRight.mousedown},bl:{mousedown:d.BottomLeft.mousedown},br:{mousedown:d.BottomRight.mousedown},t:{mousedown:d.Top.mousedown},b:{mousedown:d.Bottom.mousedown},l:{mousedown:d.Left.mousedown},r:{mousedown:d.Right.mousedown}},edges:{top:{mousedown:a.mousedown},bottom:{mousedown:a.mousedown},left:{mousedown:a.mousedown},right:{mousedown:a.mousedown}}};s.Model=L}(this);
!function(e){var o=e.ZSClass,t=o.Layer||(o.Layer={}),s=t.Image||(t.Image={});function n(){var e=document.createElement("div"),o=document.createElement("img");e.appendChild(o),e.classList.add("ZSOLEImage"),this.image=o,this.Dom=e}n.prototype={setName:function(e){this.image.name=e},setImageSrc:function(e){this.image.src=e},getNaturalHeight:function(){return this.image.naturalHeight},getNaturalWidth:function(){return this.image.naturalWidth},appendTo:function(e){e.appendChild(this.Dom)}},s.UIImage=n}(this),function(e){var o=e.ZSClass,t=o.Layer||(o.Layer={}),s=t.Image||(t.Image={}),n=t.Modules,u=n.Move,m=n.Resize,i=n.Focus,a=u.Listeners,r=m.Listeners,d=i.Listeners,l=e.ZSEvents,c=l.topic,g=l.Groups,w=l.Names,h=UIUtil.Component;var p={class:"ZSOle",Listeners:{mouseover:d.mouseover,mouseleave:d.mouseleave,mousedown:function(e){e.preventDefault(),e.stopPropagation(),h.triggerEvent(e,document),d.focuslayer.call(this,e),a.mousedown.call(this,e);var o=this;this.getController(),c.publish(g.Listener,w.Mouse.ScrollOut,{GRIDID:sPlusPlus.view.getActiveGridID(),CALLBACK:function(e,t,s,n,u,m){a.update.call(o,u,m)}})}},corners:{tl:{mousedown:r.TopLeft.mousedown},tr:{mousedown:r.TopRight.mousedown},bl:{mousedown:r.BottomLeft.mousedown},br:{mousedown:r.BottomRight.mousedown},t:{mousedown:r.Top.mousedown},b:{mousedown:r.Bottom.mousedown},l:{mousedown:r.Left.mousedown},r:{mousedown:r.Right.mousedown}},edges:{top:{mousedown:a.mousedown},bottom:{mousedown:a.mousedown},left:{mousedown:a.mousedown},right:{mousedown:a.mousedown}}};s.Model=p}(this);
!function(t){var e=t.ZSClass,i=e.Layer||(e.Layer={}),n=i.Chart||(i.Chart={}),r=i.Modules,o=r.Move,a=r.Resize,s=r.Focus,l=o.Listeners,h=a.Listeners,p=s.Listeners,c=t.ZSEvents,d=c.topic,u=c.Groups,f=c.Names,g=t.JSUtil.Mouse.Register;var C={class:"ZSOle ZSChartLayer",Listeners:{mouseover:p.mouseover,mouseleave:p.mouseleave,mousedown:function(t){var e=this,i=this.getController().getInteracter(e.getID());t.preventDefault(),t.stopPropagation(),i.isFreezed()||(e.Dom.querySelector(".ZSOLEChart").style.cursor="pointer",g.call(this,t,function(t){p.focuslayer.call(e,t)},function(t){var i=e.getController(),n=e.getID();i.getInteracter(n),p.focuslayer.call(e,t),l.mousedown.call(e,t),d.publish(u.Listener,f.Mouse.ScrollOut,{GRIDID:i.gridID,CALLBACK:function(t,i,n,r,o,a){l.update.call(e,o,a)}})},function(t){p.focuslayer.call(e,t)},function(t){p.focuslayer.call(e,t)}))}},corners:{tl:{mousedown:h.TopLeft.mousedown},tr:{mousedown:h.TopRight.mousedown},bl:{mousedown:h.BottomLeft.mousedown},br:{mousedown:h.BottomRight.mousedown},t:{mousedown:h.Top.mousedown},b:{mousedown:h.Bottom.mousedown},l:{mousedown:h.Left.mousedown},r:{mousedown:h.Right.mousedown}},edges:{top:{mousedown:l.mousedown},bottom:{mousedown:l.mousedown},left:{mousedown:l.mousedown},right:{mousedown:l.mousedown}}};n.Model=C}(this),function(t){var e=t.sPlusPlus,i=t.ZSClass,n=t.ZSChart,r=i.Layer||(i.Layer={}),o=r.Chart||(r.Chart={}),a=t.ZSConstants.I18N,s=t.ZSDevTools.Logger,l=(n.Constants,t.document),h=t.UserAction,p=t.UIUtil.Component,c=t.ZSEvents,d=c.Groups,u=c.Names,f=c.topic,g=null,C=!1,v=!1,m=null,F="rf",D="cf",M="pf",w="flt";function E(t){this.ID=t,this.element=n.Wrapper.DOMUtils.createElement("div",{id:t}),this.element.classList.add("ZSOLEChart"),this.elementMenu=l.createElement("div"),this.optionMenu=l.createElement("ul"),this.optionMenu.id="menuId"+t,this.optionMenu.classList.add("ZsOLEChartOpt"),this.liMenu=l.createElement("li"),this.liMenu.classList.add("ZsOLEChartMenu"),this.liMenu.addEventListener("mousedown",function(t){p.triggerEvent(t,l)}),this.liMenu.setAttribute("data-menu-id","MI_CHART_CONTEXT"),this.optionMenu.appendChild(this.liMenu),this.elementMenu.appendChild(this.optionMenu),this.container=n.Wrapper.DOMUtils.createElement("div"),this.container.appendChild(this.element),this.container.appendChild(this.elementMenu),this.filter=new I(this,this.ID+w+Math.ceil(Math.random()*Math.pow(10,3))),this.filter.append(),this.mode={view:!0,edit:!1}}function O(){this.isActive=!1}function I(t,e){this.parent=t,this.ID=e,this.Interactor=null,this.hasRowFilter=!1,this.hasColFilter=!1,this.hasPageFilter=!1,this.container=n.Wrapper.DOMUtils.createElement("div",{id:this.ID}),this.container.classList.add("fltChrtMenu"),this.padding=10,this.state=new O,this.state.reset(),this.filterDialogState=new O,this.filterDialogState.reset(),n.Wrapper.DOMUtils.addEventByNode(this.container,n.Wrapper.DOMUtils.Events.MOUSEWHEEL,function(t){t.stopPropagation()},!0),n.Wrapper.DOMUtils.addEventByNode(this.container,n.Wrapper.DOMUtils.Events.DOMMOUSEWHEEL,function(t){t.stopPropagation()},!0)}function y(t,e){this.parent=t,this.ID=e,this.container=n.Wrapper.DOMUtils.createElement("div",{id:this.ID})}E.prototype.addNotification=function(){this.notification||(this.notification=new y(this.container,this.ID+"noti"+Math.ceil(Math.random()*Math.pow(10,3))),this.notification.append()),this.notification.addBanner(),this.notification.hide()},E.prototype.removeNotification=function(){this.notification&&this.notification.remove(),delete this.notification},E.prototype.updateNotification=function(t){switch(this.notification||this.addNotification(),t){case 0:this.notification&&this.notification.hide();break;case 1:this.notification&&this.notification.show(),this.notification&&this.notification.addBanner()}},E.prototype.setPanelStatus=function(t){v=t,m=this.ID},E.prototype.onFocus=function(){if(!this.getMode().view){C=!0,f.publish(d.UI,u.SidePanel.CHARTS.OPEN_ICON),g&&clearTimeout(g);var t=n.Utility.getActiveChart();f.publish(d.Listener,u.UserAction.CHARTS.RESET_MENU,{ACTIVE_CHART_ID:t}),1==t.length&&function(){if(v&&m!=this.ID){n.Client.Action.removeBorderAnimation({ID:m}),n.Client.Action.resetChartSelection({ID:m}),f.publish(d.UI,u.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:m}),m=this.ID;n.Manager.SidePanelManager;f.publish(d.UI,u.SidePanel.CHARTS.OPEN,{CHART_ID:this.getID(),RECOMMENDATION:!1,TABEL_DEFINATION:!0})}}.call(this),this.filter&&this.filter.show()}},E.prototype.onBlur=function(){C=!1,g=setTimeout(function(){C||(this.setPanelStatus(!1),f.publish(d.UI,u.SidePanel.CHARTS.CLOSE),f.publish(d.UI,u.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:m}),m=null)}.bind(this),100),this.filter&&this.filter.hide()},E.prototype.getDOM=function(){return this.element},E.prototype.getID=function(){return this.ID},E.prototype.getMode=function(){return this.mode},E.prototype.setMode=function(t){this.mode.view=t,this.mode.edit=!t},E.prototype.isReadOnly=function(){return this.mode.view},E.prototype.getContainer=function(){return this.container},E.prototype.getFilterContainer=function(){return this.filter.getContainer()},E.prototype.appendTo=function(t){t.appendChild(this.container)},E.prototype.remove=function(){this.container.remove()},E.prototype.clearFilter=function(){this.filter&&this.filter.clean()},E.prototype.isActive=function(){return C},E.prototype.freezed=function(){var t=e.view.getActiveGridID();e.view.getGridComponent(t).allowToScroll=!1},E.prototype.unFreezed=function(){var t=e.view.getActiveGridID();e.view.getGridComponent(t).allowToScroll=!0},E.prototype.onAttachFilter=function(t,e){try{var i=this;i.filter.state.reset(),i.filter.setInterctor(e),t&&Object.keys(t).forEach(function(e){switch(e){case F:i.filter.attachRowFilter(t[F]);break;case D:i.filter.attachColumnFilter(t[D]);break;case M:i.filter.attachPageFilter(t[M])}}),i.filter.toggle()}catch(t){s.log("[Chart] Error while attaching filer",t)}},O.prototype={set:function(){this.isActive=!0},reset:function(){this.isActive=!1},status:function(){return this.isActive}},I.prototype={append:function(){this.parent.getContainer().appendChild(this.container)},hasFilter:function(){return this.hasPageFilter||this.hasRowFilter||this.hasColFilter},setInterctor:function(t){this.Interactor=t},onDialogOpen:function(){this.filterDialogState.set(),this.hide(),this.parent.freezed()},onDialogClose:function(){this.filterDialogState.reset(),this.show(),this.parent.unFreezed()},hide:function(){n.Wrapper.DOMUtils.hide(this.container),this.parent.unFreezed(),!this.parent.isActive()&&this.filterDialogState.status()&&f.publish(d.Listener,u.SheetAction.PIVOT.FILTER_CLOSE)},getID:function(){return this.ID},show:function(){this.parent.isActive()&&!this.filterDialogState.status()&&this.state.status()&&this.hasFilter()&&(n.Wrapper.DOMUtils.show(this.container),this.align()),this.parent.unFreezed()},toggle:function(){this.hasFilter()?this.show():this.hide()},align:function(){var t=this.getContainer(),e=t.getBoundingClientRect(),i=function(){var t=this.parent.getContainer().getBoundingClientRect(),i=window.innerWidth,n=t.right+e.width+this.padding>=i;return n=n&&t.left-(this.padding+e.width)>100,{alignmemt:"right",position:-1*(this.padding+e.width)}}.call(this);t.style.left="",t.style.right="",t.style[i.alignmemt]=i.position+"px"},clean:function(){this.removeRowFilter(),this.removeColumnFilter(),this.removePageFilter(),this.hasRowFilter=this.hasColFilter=this.hasPageFilter=!1},getContainer:function(){return this.container},getFilterContainer:function(){return this.parent.getFilterContainer()},openDialog:function(t,i,n){t.preventDefault(),t.stopPropagation();var r,o,a=(r=this.getContainer(),{top:(o=r.getBoundingClientRect()).top-e.view.measures.gridTop-o.height,left:o.left-e.view.measures.gridLeft-o.width,width:o.width,height:o.height}),s={hasHeader:!0,hasEvents:!0,header:{text:i.content},events:{onOpen:this.onDialogOpen.bind(this),onClose:this.onDialogClose.bind(this)}};n&&n(i,a,s)},appendRowFilterWrapper:function(t){this.rowFilterHead=n.Wrapper.DOMUtils.createElement("div"),this.rowFilterHead.classList.add("fmHead");var e=n.Wrapper.DOMUtils.createElement("span");e.innerText=a["Pivot.Filter.Row"],this.rowFilterHead.appendChild(e),this.rowFilter=n.Wrapper.DOMUtils.createElement("div",{id:this.getID()+"_"+F}),this.rowFilter.classList.add("rfWrapper","pb5"),t&&t.appendChild(this.rowFilter),this.rowFilter.appendChild(this.rowFilterHead),this.hasRowFilter=!0},appendColumnFilterWrapper:function(t){this.colFilterHead=n.Wrapper.DOMUtils.createElement("div"),this.colFilterHead.classList.add("fmHead");var e=n.Wrapper.DOMUtils.createElement("span");e.innerText=a["Pivot.Filter.Column"],this.colFilterHead.appendChild(e),this.colFilter=n.Wrapper.DOMUtils.createElement("div",{id:this.getID()+"_"+D}),this.colFilter.classList.add("cfWrapper","flt_left"),t&&t.appendChild(this.colFilter),this.colFilter.appendChild(this.colFilterHead),this.hasColFilter=!0},appendPageFilterWrapper:function(t){this.pageFilterHead=n.Wrapper.DOMUtils.createElement("div"),this.pageFilterHead.classList.add("fmHead");var e=n.Wrapper.DOMUtils.createElement("span");e.innerText=a["Pivot.Filter.Page"],this.pageFilterHead.appendChild(e),this.pageFilter=n.Wrapper.DOMUtils.createElement("div",{id:this.getID()+"_"+M}),this.pageFilter.classList.add("pgWrapper","pb5"),t&&t.appendChild(this.pageFilter),this.pageFilter.appendChild(this.pageFilterHead),this.hasPageFilter=!0},getRowFilterDOM:function(){return!this.rowFilter&&this.appendRowFilterWrapper(this.getFilterContainer()),this.rowFilter},getColumnFilterDOM:function(){return!this.colFilter&&this.appendColumnFilterWrapper(this.getFilterContainer()),this.colFilter},getPageFilterDOM:function(){return!this.pageFilter&&this.appendPageFilterWrapper(this.getFilterContainer()),this.pageFilter},removePageFilter:function(){this.pageFilter&&this.pageFilter.remove(),delete this.pageFilter},removeRowFilter:function(){this.rowFilter&&this.rowFilter.remove(),delete this.rowFilter},removeColumnFilter:function(){this.colFilter&&this.colFilter.remove(),delete this.colFilter},getFilterWrapper:function(t){switch(t){case F:return this.getRowFilterDOM();case D:return this.getColumnFilterDOM();case M:return this.getPageFilterDOM()}},attachRowFilter:function(t){var r=this;t.forEach(function(t){r.state.set();var o=r.getFilterWrapper(F),a=n.Wrapper.DOMUtils.createElement("img");a.src=e.data.AppRegistry.IMAGEPath+"../../images/"+t.pic+".svg";var l=n.Wrapper.DOMUtils.createElement("div");l.classList.add("pvtChrtDlg"),l.classList.add("pvtChrtFlt"),l.setAttribute("data-pivot",t.content),n.Wrapper.DOMUtils.addEventByNode(l,n.Wrapper.DOMUtils.Events.CLICK,function(e){var n=t.callback||i.Pivot.Util.openPivotChartFilterDialog;n&&r.openDialog(e,t,n),!n&&s.log("[CHART] >>>>>>>> No callback Added")}),n.Wrapper.DOMUtils.appendChild(o,l),n.Wrapper.DOMUtils.appendChild(l,a)})},attachColumnFilter:function(t){var r=this;t.forEach(function(t){r.state.set();var o=r.getFilterWrapper(D),a=n.Wrapper.DOMUtils.createElement("img");a.src=e.data.AppRegistry.IMAGEPath+"../../images/"+t.pic+".svg";var l=n.Wrapper.DOMUtils.createElement("div");l.classList.add("pvtChrtDlg"),l.classList.add("pvtChrtFlt"),l.setAttribute("data-pivot",t.content),n.Wrapper.DOMUtils.addEventByNode(l,n.Wrapper.DOMUtils.Events.CLICK,function(e){var n=t.callback||i.Pivot.Util.openPivotChartFilterDialog;n&&r.openDialog(e,t,n),!n&&s.log("[CHART] >>>>>>>> No callback Added")}),n.Wrapper.DOMUtils.appendChild(o,l),n.Wrapper.DOMUtils.appendChild(l,a)})},attachPageFilter:function(t){var r=this;t.forEach(function(t){r.state.set();var o=r.getFilterWrapper(M),a=n.Wrapper.DOMUtils.createElement("img");a.src=e.data.AppRegistry.IMAGEPath+"../../images/"+t.pic+".svg";var l=n.Wrapper.DOMUtils.createElement("div");l.classList.add("pvtChrtDlg"),l.classList.add("pvtChrtFlt"),l.setAttribute("data-pivot",t.content),n.Wrapper.DOMUtils.addEventByNode(l,n.Wrapper.DOMUtils.Events.CLICK,function(e){var n=t.callback||i.Pivot.Util.openPivotChartFilterDialog;n&&r.openDialog(e,t,n),!n&&s.log("[CHART] >>>>>>>> No callback Added")}),n.Wrapper.DOMUtils.appendChild(o,l),n.Wrapper.DOMUtils.appendChild(l,a)})}},y.prototype.addBanner=function(){this.clean();var t=h.getTemplate(["INFOBANNER"]);this.container.appendChild(t.INFOBANNER);var e=this.container.querySelector(".shNtfyClose");this.container.querySelector(".shNtfyCtn").innerText=a["Chart.Cells.Count.Exceeded.Info"];var r=this,o=new i.Timer(5e3,function(){r.clean(),r.addIcon()});o.set(),n.Wrapper.DOMUtils.addEventByNode(e,n.Wrapper.DOMUtils.Events.CLICK,function(){o.clear(),r.clean(),r.addIcon()})},y.prototype.append=function(){this.parent.appendChild(this.container)},y.prototype.clean=function(){this.container.innerHTML="",this.container.className="zscBanner"},y.prototype.addIcon=function(){this.container.classList.add("ZsOleChartInfo");var t=h.getTemplate(["chartInfoIcon"]);this.container.appendChild(t.chartInfoIcon),this.container.title=a["Chart.Cells.Count.Exceeded.Info"]},y.prototype.hide=function(){n.Wrapper.DOMUtils.hide(this.container)},y.prototype.show=function(){n.Wrapper.DOMUtils.show(this.container)},y.prototype.remove=function(){this.container.remove()},o.UIChartLayer=E}(this);
!function(t){var i=t.ZSClass,e=(t.sPlusPlus,i.Layer||(i.Layer={})),n=(e.Interface,e.MouseFollower||(e.MouseFollower={}));function r(t,i,e,n,r,s,o,h,u,g,c,a,d,l,f,P){this.interacter=t,this.ID=i,this.startRow=e,this.startCol=n,this.endRow=r,this.endCol=s,this.checkBox=o||null,this.filter=h||null,this.versionEdit=u||null,this.hyperLink=g,this.pivot=c,this.picklist=P,this.leftPadding=a,this.rightPadding=d,this.topPadding=l,this.bottomPadding=f}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getNextY:function(){return this.interacter.getRowY(this.startRow+1)},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getCheckBox:function(){return this.checkBox},getFilter:function(){return this.filter},getPicklist:function(){return this.picklist},getVersionEdit:function(){return this.versionEdit},getRange:function(){return new i.Range(this.startRow,this.startCol,this.endRow,this.endCol)},getHyperLink:function(){return this.hyperLink},getPivotHeader:function(){return this.pivot},getVerticalPadding:function(){return this.topPadding+this.bottomPadding},getHorizontalPadding:function(){return this.leftPadding+this.rightPadding}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.RangeSelection||(i.RangeSelection={}));function r(t,e,i,n,r,s,o){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s,this.filled=o}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},isFilled:function(){return this.filled},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.Selection||(i.Selection={}));function r(t,e,i,n,r,s){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.FillSeriesSelectionCue||(i.FillSeriesSelectionCue={}));function r(t,e,i,n,r,s){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.RangePicker||(i.RangePicker={}));function r(t,e,i,n,r,s,o,h){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s,this.active=o,this.color=h}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getColor:function(){return this.color},isActive:function(){return this.active},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.FillSeriesSelection||(i.FillSeriesSelection={}));function r(t,e,i,n,r,s){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.CopySelection||(i.CopySelection={}));function r(t,e,i,n,r,s){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.DragSelection||(i.DragSelection={}));function r(t,e,i,n,r,s){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.HeaderDragSelection||(i.HeaderDragSelection={}));function r(t,e,i,n,r,s){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,n=e.Layer||(e.Layer={}),o=(n.Interface,n.Notes||(n.Notes={})),r=i.data.Defaults.MAX_COL;function s(e,i,n,o,s,h,u,c,g,f,a,l,R){this.interacter=e,this.rid=i,this.sheetId=n,this.version=o,this.row=s,this.col=h,this.comment=u,this.NoteX=c,this.NoteY=g,this.rowX=f,this.colY=a,this.fixRight=l,this.fixBottom=R,this.ID=function(e,i){return t.JSUtil.Math.hash(e,i,r)}(s,h),this.startRow=s,this.startCol=h,this.endRow=s,this.endCol=h}s.prototype={getID:function(){return this.ID},getRid:function(){return this.rid},getSheetId:function(){return this.sheetId},getVersion:function(){return this.version},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getNoteX:function(){return this.NoteX},getNoteY:function(){return this.NoteY},getComment:function(){return this.comment},getRow:function(){return this.row},getCol:function(){return this.col},getRowX:function(){return this.rowX},getColY:function(){return this.colY},getFixRight:function(){return this.fixRight},getFixBottom:function(){return this.fixBottom},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},o.Interacter=s}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,n=e.Layer||(e.Layer={}),s=(n.Interface,n.HighlightLocks||(n.HighlightLocks={}));i.data.Defaults.MAX_COL;function r(t,e,i,n,s,r){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=s,this.endCol=r}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},s.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,n=e.Layer||(e.Layer={}),s=(n.Interface,n.HighlightComments||(n.HighlightComments={}));i.data.Defaults.MAX_COL;function r(t,e,i,n,s,r){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=s,this.endCol=r}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},s.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.RecalculateFlash||(i.RecalculateFlash={}));function s(t,e,i,n,s,r){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=s,this.endCol=r}s.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=s}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,n=e.Layer||(e.Layer={}),s=(n.Interface,n.DataValidation||(n.DataValidation={}));i.data.Defaults.MAX_COL;function r(t,e,i,n,s,r,o,h,a,u,c){this.interacter=t,this.rid=i,this.sheetId=n,this.version=s,this.ID=e,this.row=r,this.col=o,this.startRow=r,this.startCol=o,this.endRow=r,this.endCol=o,this.text=h,this.type=a,this.message=u,this.isValid=c}r.prototype={getID:function(){return this.ID},getRid:function(){return this.rid},getSheetId:function(){return this.sheetId},getVersion:function(){return this.version},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getText:function(){return this.text},getType:function(){return this.type},getMessage:function(){return this.message},getRow:function(){return this.row},getCol:function(){return this.col},isValidContent:function(){return this.isValid},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},s.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,n=e.Layer||(e.Layer={}),r=(n.Interface,n.DataValidationButton||(n.DataValidationButton={}));i.data.Defaults.MAX_COL;function s(t,e,i,n,r){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=i,this.endCol=n,this.align=r}s.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getAlign:function(){return this.align},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},r.Interacter=s}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.PasteWidget||(i.PasteWidget={}));function r(t,e,i,n,r,s,o,h){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s,this.leftDirection=o,this.topDirection=h}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},isLeftDirection:function(){return this.leftDirection},isTopDirection:function(){return this.topDirection},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,r=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(r.Interface,r.Precedance||(r.Precedance={}));function i(t,e,r,n,i,s,o,h,a,c){this.interacter=t,this.ID=e,this.startRow=r,this.startCol=n,this.endRow=i,this.endCol=s,this.source={startRow:o,startCol:h,endRow:a,endCol:c}}i.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getColX:function(){return(this.interacter.getColX(this.source.startCol)+this.interacter.getColX(this.source.endCol+1))/2},getRowY:function(){return(Math.round(this.interacter.getRowY(this.source.startRow))+Math.round(this.interacter.getRowY(this.source.endRow+1)))/2},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=i}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.RangeHighlight||(i.RangeHighlight={}));function r(t,e,i,n,r,s,o){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s,this.color=o}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)},getColor:function(){return this.color}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,n=(t.sPlusPlus,e.Layer||(e.Layer={})),i=(n.Interface,n.UserPresence||(n.UserPresence={}));function r(t,e,n,i,r,s,o,h,u){this.interacter=t,this.ID=e,this.color=o,this.name=h,this.editStatus=u,this.startRow=n,this.startCol=i,this.endRow=r,this.endCol=s}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)-1},getY:function(){return this.interacter.getRowY(this.startRow)-1},getColor:function(){return this.color},getName:function(){return this.name},getEditStatus:function(){return this.editStatus},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},i.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),n=(i.Interface,i.PivotPlaceHolder||(i.PivotPlaceHolder={}));function r(t,e,i,n,r,s){this.interacter=t,this.ID=e,this.startRow=i,this.startCol=n,this.endRow=r,this.endCol=s}r.prototype={getID:function(){return this.ID},getX:function(){return this.interacter.getColX(this.startCol)+1},getY:function(){return this.interacter.getRowY(this.startRow)+1},getWidth:function(){return this.interacter.getColX(this.endCol+1)-this.getX()-2},getHeight:function(){return this.interacter.getRowY(this.endRow+1)-this.getY()-2},isEditable:function(){return!0},getRange:function(){return new e.Range(this.startRow,this.startCol,this.endRow,this.endCol)}},n.Interacter=r}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,o=e.Layer||(e.Layer={}),n=(o.Interface,o.Button||(o.Button={})),r=t.ZSEvents,s=r.topic,h=r.Groups,g=r.Names,c=t.ZSConstants.FeatureConstants,a=i.view.Toolbar.Feature[c.DELUGE];function u(t,e,o,n,r,s,h,g){this.interacter=t,this.ID=e;var c=i.view.getActiveGridID(),a=i.view.getResourceID(c),u=i.view.getVersionID(c),v=i.view.getSheetID(c);this.gridID=c,this.rID=a,this.sheetID=v,this.version=u;var d=i.data.getWorkBook(a,u).getSheetObj(v).Buttons.get(e);this.button=d,this.label=o,this.X=n,this.Y=r,this.width=s,this.height=h,this.scriptListeners=g}function v(t){this.interacter=t}u.prototype={getID:function(){return this.ID},getX:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return this.button.getX()*t},getY:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return this.button.getY()*t},getWidth:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return this.button.getWidth()*t},getHeight:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return this.button.getHeight()*t},getLabel:function(){return this.button.getLabel()},getScriptListeners:function(){return this.button.getScript()},getHashedID:function(){return"Button"+this.getID()},getKey:function(){return"Button"},isEditable:function(){return!0},isScriptAvailable:function(){return!!this.button.script},clone:function(){this.button=this.button.clone()},setLabel:function(t){this.button.setLabel(t)},getMinimumDimension:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return{width:30*t,height:18*t}},setPosition:function(t,e){var o=i.view.getGridComponent(this.gridID).getZoom();this.button.setPosition(t/o,e/o)},setDimension:function(t,e){var o=i.view.getGridComponent(this.gridID).getZoom();this.button.setDimension(t/o,e/o)},getNetworkInteracter:function(){return new v(this)},getCoordinates:function(t,e){var o=i.view.getGridComponent(this.gridID).translateCoordinates(t),n=e.getRelativeCoordinates(o.x,o.y),r=i.view.getGridComponent(this.gridID).getZoom();return{x:n.x*r,y:Math.round(n.y*r)}},getAbsoluteX:function(){var t=i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),e=i.view.getSheetState(this.gridID,this.sheetID),o=e.getScreenWidths(),n=e.getScrollLefts(),r=this.interacter.getColX(t.Column.FreezedCount),s=this.getX(),h=0,g=~~n[1];return s>=r&&(h=o[1],g=~~n[0]),s-g+h},getAbsoluteY:function(){var t=i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),e=i.view.getSheetState(this.gridID,this.sheetID),o=e.getScreenHeights(),n=e.getScrollTops(),r=this.interacter.getRowY(t.Row.FreezedCount),s=this.getY(),h=0,g=~~n[1];return s>=r&&(h=o[1],g=n[0]),s-g+h},getLeftStickyX:function(){var t=this.button.getX(),e=(i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),this.interacter.findCol(t-1));return this.interacter.getColX(e)*i.view.getGridComponent(this.gridID).getZoom()},getNextLeftStickyX:function(){var t=this.button.getX(),e=(i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),this.interacter.findCol(t));return this.interacter.getColX(e+1)*i.view.getGridComponent(this.gridID).getZoom()},getRightStickyX:function(){var t=this.button.getX(),e=this.button.getWidth(),o=(i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),this.interacter.findCol(t+e+1));return(this.interacter.getColX(o+1)-e)*i.view.getGridComponent(this.gridID).getZoom()},getNextRightStickyX:function(){var t=this.button.getX(),e=this.button.getWidth(),o=(i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),this.interacter.findCol(t+e-1));return(this.interacter.getColX(o)-e)*i.view.getGridComponent(this.gridID).getZoom()},getTopStickyY:function(){var t=this.button.getY(),e=(i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),this.interacter.findRow(t-1));return this.interacter.getRowY(e)*i.view.getGridComponent(this.gridID).getZoom()},getNextTopStickyY:function(){var t=this.button.getY(),e=(i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),this.interacter.findRow(t));return this.interacter.getRowY(e+1)*i.view.getGridComponent(this.gridID).getZoom()},getBottomStickyY:function(){var t=this.button.getY(),e=this.button.getHeight(),o=(i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),this.interacter.findRow(t+e+1));return(this.interacter.getRowY(o+1)-e)*i.view.getGridComponent(this.gridID).getZoom()},getNextBottomStickyY:function(){var t=this.button.getY(),e=this.button.getHeight(),o=(i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),this.interacter.findRow(t+e-1));return(this.interacter.getRowY(o)-e)*i.view.getGridComponent(this.gridID).getZoom()},scrollIntoView:function(){var t=this.rID,e=this.version,i=this.sheetID,o=this.getX(),n=this.getY(),r=this.getWidth(),s=this.getHeight();UserAction.ScrollAreaIntoView(t,i,e,o,n,r,s)}},v.prototype={resize:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,n=t.ID,r=t.button;UserAction.ResizeButton(e,i,o,n,r)},move:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,n=t.ID,r=t.button;UserAction.MoveButton(e,i,o,n,r)},clone:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,n=(t.ID,t.button);UserAction.CloneButton(e,i,o,n,D)},delete:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,n=t.ID;t.button;UserAction.DeleteButton(e,i,o,n)},executeScript:function(){var e=this.interacter;if(e.isEditable()){var o=e.button.getScript();if(o)if("Deluge"==o.getModule())a.runMacro(o.getMacroName());else{var n=e.rID,r=e.sheetID,s=e.version,h=e.ID,g=i.view.getActiveGridID(),c=i.view.getGridComponent(g);c.Button.blur(h),c.Button.showLoader(h),function(e,o,n,r,s,h){var g=i.data.getWorkBook(e,n).SheetList.getById(o).getName(),c=i.view.getActiveGridID(),a=i.view.getSheetState(c,o).getActiveRange();t.UserAction.runMacro(e,o,n,r,s,[o],g,a,h)}(n,r,s,o.getModule(),o.getMacroName(),function(){c.Button.hideLoader(h)})}}},assignMacro:function(t){var e=this.interacter;!function(t,e,i,o,n,r){switch(r){case I.AddExistingMacro:UserAction.assignExistingMacro(t,e,i,n,function(r,s){n.setScript(r,s),UserAction.SetMacroButton(t,e,i,o,n)});break;case I.CreateMacro:UserAction.CreateAndAssignMacro(t,e,i,function(r,s){n.setScript(r,s),UserAction.SetMacroButton(t,e,i,o,n)});break;case I.RecordMacro:UserAction.RecordAndAssignMacro(t,e,i,function(r,s){n.setScript(r,s),UserAction.SetMacroButton(t,e,i,o,n)});break;case I.CreateDelugeMacro:a.buttonAssignMacro(function(r){n.setScript("Deluge",r),UserAction.SetMacroButton(t,e,i,o,n)})}}(e.rID,e.sheetID,e.version,e.ID,e.button,t)},setCaption:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,n=t.ID,r=t.button;UserAction.SetCaptionButton(e,i,o,n,r)},scrollIntoView:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,n=t.getX(),r=t.getY(),s=t.getWidth(),h=t.getHeight();UserAction.ScrollAreaIntoView(e,i,o,n,r,s,h)}};var d=0,I={AddExistingMacro:d++,CreateMacro:d++,RecordMacro:d++,CreateDelugeMacro:d++};function D(t,e,i,o){s.register(h.Listener,g.ServerAction.PROCESSRESPONSE,S,"RESPONSE")}function S(e){var o=t.ZSConstants.CommandConstants,n=i.view.getActiveGridID(),r=i.view.getResourceID(n),c=(i.view.getVersionID(n),i.view.getSheetID(n)),a=e[o.DOCUMENT_META][r][o.SHEET_META][c][o.BUTTON];if(a[o.INSERT]){var u=a[o.INSERT][0],v=(n=i.view.getActiveGridID(),i.view.getGridComponent(n));v.Button.blurAll(),v.Button.scrollIntoView(u),v.Button.focus(u)}s.unregister(h.Listener,g.ServerAction.PROCESSRESPONSE,S)}n.Interacter=u}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,o=e.Layer||(e.Layer={}),r=(o.Interface,o.Image||(o.Image={})),g=t.ZSEvents,n=g.topic,s=g.Groups,h=g.Names;function a(t,e,o,r,g,n,s,h,a,c,d,m,f,u,I,D,l,w,v){this.interacter=t,this.ID=e;var C=i.view.getActiveGridID(),R=i.view.getResourceID(C),p=i.view.getVersionID(C),S=i.view.getSheetID(C);this.gridID=C,this.rID=R,this.sheetID=S,this.version=p;var k=i.data.getWorkBook(R,p).getSheetObj(S).Images.get(e);if(this.zIndex=o,this.height=r,this.width=g,this.row=n,this.col=s,this.startRow=n,this.startCol=s,this.endRow=n,this.endCol=s,this.col=r,this.rowDiff=h,this.colDiff=a,this.name=c,this.styleName=d,this.textStyleName=m,"-1"!=(f=decodeURIComponent(f)).indexOf("u_n=")){f=i.data.AppRegistry.ctxpath+f;var G=i.data.DocRegistry[R].RemoteViewInfo&&i.data.DocRegistry[R].RemoteViewInfo.REMOTE_ENC_DOC_ID;G&&(f=f+"&doc="+G)}this.url=f,this.title=u,this.desc=I,this.hyperlink=D,this.actualHeight=l,this.actualWidth=w,this.sourceID=v,this.image=k}function c(t){this.interacter=t}a.prototype={getID:function(){return this.ID},getX:function(){var t=this.image.getCol(),e=this.image.getColDiff(),o=i.view.getGridComponent(this.gridID).getZoom();return(this.interacter.getColX(t)+e)*o},getY:function(){var t=this.image.getRow(),e=this.image.getRowDiff(),o=i.view.getGridComponent(this.gridID).getZoom();return(this.interacter.getRowY(t)+e)*o},getWidth:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return this.image.getWidth()*t},getHeight:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return this.image.getHeight()*t},getHashedID:function(){return"Image"+this.getID()},getKey:function(){return"Image"},getMinimumDimension:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return{width:18*t,height:18*t}},getCoordinates:function(t,e){var o=i.view.getGridComponent(this.gridID).translateCoordinates(t),r=e.getRelativeCoordinates(o.x,o.y),g=i.view.getGridComponent(this.gridID).getZoom();return{x:r.x*g,y:Math.round(r.y*g)}},getLeftStickyX:function(){i.data.getWorkBook(this.rID,this.version);var t=this.image.getCol(),e=this.image.getColDiff(),o=this.interacter.getColX(t)+e;t=this.interacter.findCol(o-1);return this.interacter.getColX(t)*i.view.getGridComponent(this.gridID).getZoom()},getNextLeftStickyX:function(){i.data.getWorkBook(this.rID,this.version);var t=this.image.getCol(),e=this.image.getColDiff(),o=this.interacter.getColX(t)+e;t=this.interacter.findCol(o);return this.interacter.getColX(t+1)*i.view.getGridComponent(this.gridID).getZoom()},getRightStickyX:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.image.getCol(),e=this.image.getColDiff(),o=this.interacter.getColX(t)+e,r=this.image.getWidth();t=this.interacter.findCol(o+r+1);return(this.interacter.getColX(t+1)-r)*i.view.getGridComponent(this.gridID).getZoom()},getNextRightStickyX:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.image.getCol(),e=this.image.getColDiff(),o=this.interacter.getColX(t)+e,r=this.image.getWidth();t=this.interacter.findCol(o+r-1);return(this.interacter.getColX(t)-r)*i.view.getGridComponent(this.gridID).getZoom()},getTopStickyY:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.image.getRow(),e=this.image.getRowDiff(),o=this.interacter.getRowY(t)+e;t=this.interacter.findRow(o-1);return this.interacter.getRowY(t)*i.view.getGridComponent(this.gridID).getZoom()},getNextTopStickyY:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.image.getRow(),e=this.image.getRowDiff(),o=this.interacter.getRowY(t)+e;t=this.interacter.findRow(o);return this.interacter.getRowY(t+1)*i.view.getGridComponent(this.gridID).getZoom()},getBottomStickyY:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.image.getRow(),e=this.image.getRowDiff(),o=this.interacter.getRowY(t)+e,r=this.image.getHeight();t=this.interacter.findRow(o+r+1);return(this.interacter.getRowY(t+1)-r)*i.view.getGridComponent(this.gridID).getZoom()},getNextBottomStickyY:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.image.getRow(),e=this.image.getRowDiff(),o=this.interacter.getRowY(t)+e,r=this.image.getHeight();t=this.interacter.findRow(o+r-1);return(this.interacter.getRowY(t)-r)*i.view.getGridComponent(this.gridID).getZoom()},setDimension:function(t,e){var o=i.view.getGridComponent(this.gridID).getZoom();this.image.setWidth(t/o),this.image.setHeight(e/o)},setPosition:function(t,e){var o=i.view.getGridComponent(this.gridID).getZoom();t/=o,e/=o;var r=this.interacter.Row.axis.find(e);this.image.setRow(r.idx),this.image.setRowDiff(r.rsdue);var g=this.interacter.Col.axis.find(t);this.image.setCol(g.idx),this.image.setColDiff(g.rsdue)},clone:function(){this.image=this.image.clone()},getURL:function(){return this.image.getURL()},getName:function(){return this.name},getStyleName:function(){return this.styleName},getTextStyleName:function(){return this.textStyleName},getTitle:function(){return this.title},getDescription:function(){return this.desc},getHyperlink:function(){return this.hyperlink},getActualHeight:function(){return this.actualHeight},getActualWidth:function(){return this.actualWidth},getSourceID:function(){return this.sourceID},isEditable:function(){return!0},getNetworkInteracter:function(){return new c(this)},scrollIntoView:function(){var t=this.rID,e=this.version,i=this.sheetID,o=this.getX(),r=this.getY(),g=this.getWidth(),n=this.getHeight();UserAction.ScrollAreaIntoView(t,i,e,o,r,g,n)}},c.prototype={delete:function(){var e=this.interacter,o=e.rID,r=e.sheetID,g=e.version,n=i.data.getWorkBook(o,g).getSheetObj(r),s=i.view.getActiveGridID(),h=i.view.getSelectedSheets(s),a=n.Prop.Name,c=[],d={imgId:e.getID()};c.push(d),t.UserAction.ImageAction(o,h,g,a,"IMAGE_REMOVE",c)},move:function(){var e=this.interacter,o=e.rID,r=e.sheetID,g=e.version,n=i.data.getWorkBook(o,g).getSheetObj(r),s=i.view.getActiveGridID(),h=i.view.getSelectedSheets(s),a=n.Prop.Name,c=e.image,d=[],m={imgId:e.getID(),row:c.getRow(),column:c.getCol(),sRowDiff:Math.round(c.getRowDiff()),sColDiff:Math.round(c.getColDiff())};d.push(m),t.UserAction.ImageAction(o,h,g,a,"IMAGE_MOVE",d)},resize:function(){var e=this.interacter,o=e.rID,r=e.sheetID,g=e.version,n=i.data.getWorkBook(o,g).getSheetObj(r),s=i.view.getActiveGridID(),h=i.view.getSelectedSheets(s),a=n.Prop.Name,c=e.image,d=[],m={imgId:e.getID(),row:c.getRow(),column:c.getCol(),sRowDiff:Math.round(c.getRowDiff()),sColDiff:Math.round(c.getColDiff()),imgWd:Math.round(c.getWidth()),imgHt:Math.round(c.getHeight())};d.push(m),t.UserAction.ImageAction(o,h,g,a,"IMAGE_RESIZE",d)},resizeToOriginal:function(){(f=new r.UIImage).setImageSrc(this.interacter.getURL());var e=f.getNaturalWidth(),o=f.getNaturalHeight(),g=this.interacter,n=g.rID,s=g.sheetID,h=g.version,a=i.data.getWorkBook(n,h).getSheetObj(s),c=i.view.getActiveGridID(),d=i.view.getSelectedSheets(c),m=a.Prop.Name,f=g.image,u=[],I={imgId:g.getID(),row:f.getRow(),column:f.getCol(),sRowDiff:Math.round(f.getRowDiff()),sColDiff:Math.round(f.getColDiff()),imgWd:Math.round(e),imgHt:Math.round(o)};u.push(I),t.UserAction.ImageAction(n,d,h,m,"IMAGE_RESIZE",u)},clone:function(){var e=this.interacter,o=e.rID,r=e.sheetID,g=e.version,n=i.data.getWorkBook(o,g).getSheetObj(r),s=i.view.getActiveGridID(),h=i.view.getSelectedSheets(s),a=n.Prop.Name,c=e.image,d=[],m={imgsid:e.getID(),row:c.getRow(),column:c.getCol(),sRowDiff:Math.round(c.getRowDiff()),sColDiff:Math.round(c.getColDiff())};d.push(m),t.UserAction.ImageAction(o,h,g,a,"IMAGE_CLONE",d)},replace:function(){var t=this.interacter;n.publish(s.UI,h.Toolbar.IMAGE.CLICK,{ID:t.getID()})},scrollIntoView:function(){var t=this.interacter,e=t.rID,i=t.sheetID,o=t.version,r=t.getX(),g=t.getY(),n=t.getWidth(),s=t.getHeight();UserAction.ScrollAreaIntoView(e,i,o,r,g,n,s)}},r.Interacter=a}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,r=e.Layer||(e.Layer={}),o=(r.Interface,r.Chart||(r.Chart={})),n=t.ZSEvents;n.topic,n.Groups,n.Names;function h(t,e,r){this.interacter=t,this.ID=e;var o=i.view.getActiveGridID(),n=i.view.getResourceID(o),h=i.view.getVersionID(o),s=i.view.getSheetID(o);this.gridID=o,this.rID=n,this.sheetID=s,this.version=h;var g=i.data.getWorkBook(n,h).getSheetObj(s).Charts.get(e);this.chart=g,this.sidePanelStatus=r}function s(t){this.interacter=t}h.prototype={getID:function(){return this.ID},getEncryptedID:function(){return this.chart.getEncryptedID()},getX:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return this.chart.getComputedLeft(this.chart.getStartColIndex())*t},getY:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return this.chart.getComputedTop(this.chart.getStartRowIndex())*t},getWidth:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return this.chart.getWidth()*t},getHeight:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return this.chart.getHeight()*t},getHashedID:function(){return"Chart"+this.getID()},getKey:function(){return"Chart"},getMinimumDimension:function(){var t=i.view.getGridComponent(this.gridID).getZoom();return{width:120*t,height:100*t}},getSidePanelStatus:function(){return this.sidePanelStatus},getPivotID:function(){return this.chart.getPivotId()},getLegendPosition:function(){return this.chart.getLegendPosition()},isEditable:function(){var t=i.data.getWorkBook(this.rID,this.version);return t.isEditable()&&!t.ProtectedSheets.isSheetLocked(this.sheetID)&&!this.isFreezed()},isReadOnlyChart:function(){return!1},getInstanceByViewIndex:function(t){return this.chart.getInstance()[t]},getNetworkInteracter:function(){return new s(this)},getController:function(){return this.Controller},scrollIntoView:function(){new s(this).scrollIntoView()},getCoordinates:function(t,e){var r=i.view.getGridComponent(sPlusPlus.view.getActiveGridID()).translateCoordinates(t),o=e.getRelativeCoordinates(r.x,r.y),n=i.view.getGridComponent(this.gridID).getZoom();return{x:o.x*n,y:Math.round(o.y*n)}},getLeftStickyX:function(){i.data.getWorkBook(this.rID,this.version);var t=this.chart.getLeft(),e=this.interacter.findCol(t-1);return this.interacter.getColX(e)*i.view.getGridComponent(this.gridID).getZoom()},getNextLeftStickyX:function(){i.data.getWorkBook(this.rID,this.version);var t=this.chart.getLeft(),e=this.interacter.findCol(t);return this.interacter.getColX(e+1)*i.view.getGridComponent(this.gridID).getZoom()},getRightStickyX:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.chart.getLeft(),e=this.chart.getWidth(),r=this.interacter.findCol(t+e+1);return(this.interacter.getColX(r+1)-e)*i.view.getGridComponent(this.gridID).getZoom()},getNextRightStickyX:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.chart.getLeft(),e=this.chart.getWidth(),r=this.interacter.findCol(t+e-1);return(this.interacter.getColX(r)-e)*i.view.getGridComponent(this.gridID).getZoom()},getTopStickyY:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.chart.getTop(),e=this.interacter.findRow(t-1);return this.interacter.getRowY(e)*i.view.getGridComponent(this.gridID).getZoom()},getNextTopStickyY:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.chart.getTop(),e=this.interacter.findRow(t);return this.interacter.getRowY(e+1)*i.view.getGridComponent(this.gridID).getZoom()},getBottomStickyY:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.chart.getTop(),e=this.chart.getHeight(),r=this.interacter.findRow(t+e+1);return(this.interacter.getRowY(r+1)-e)*i.view.getGridComponent(this.gridID).getZoom()},getNextBottomStickyY:function(){i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID);var t=this.chart.getTop(),e=this.chart.getHeight(),r=this.interacter.findRow(t+e-1);return(this.interacter.getRowY(r)-e)*i.view.getGridComponent(this.gridID).getZoom()},getRID:function(){return this.rID},getSheetID:function(){return this.sheetID},getVersion:function(){return this.version},setPosition:function(t,e){var r=i.view.getGridComponent(this.gridID).getZoom();this.chart.setPosition(t/r,e/r),ZSChart.Client.Action.destroyContextualToolbar(1)},setDimension:function(t,e){var r=i.view.getGridComponent(this.gridID).getZoom();this.chart.setDimension(t/r,e/r),ZSChart.Client.Action.destroyContextualToolbar()},isPivotChart:function(){if(this.chart)return this.chart.getPivotState()},isCellExceeded:function(){if(this.chart)return this.chart.isCellExceeded()},isFreezed:function(){var e=i.view.getActiveGridID();return!i.view.getGridComponent(e).allowToScroll||t.isCraftGrid}},s.prototype={resize:function(){var t=this.interacter,e=t.rID,i=t.sheetID,r=t.version,o=t.ID,n=t.chart;ZSChart.Action.resetSize(e,i,r,o,n.getLeft(),n.getTop(),n.getStartRowIndex(),n.getStartColIndex(),n.getStartRowDiff(),n.getStartColDiff(),n.getWidth(),n.getHeight())},move:function(){var t=this.interacter,e=t.rID,i=t.sheetID,r=t.version,o=t.ID,n=t.chart;ZSChart.Server.Action.repositionChart(e,i,r,o,n.getLeft(),n.getTop(),n.getStartRowIndex(),n.getStartColIndex(),n.getStartRowDiff(),n.getStartColDiff())},delete:function(){var t=this.interacter,e=t.rID,i=t.sheetID,r=t.version,o=t.ID;ZSChart.Server.Action.deleteChart(e,i,r,o)},scrollIntoView:function(){var t=this.interacter,e=t.rID,i=t.sheetID,r=t.version,o=t.getX(),n=t.getY(),h=t.getWidth(),s=t.getHeight();UserAction.ScrollAreaIntoView(e,i,r,o,n,h,s)},doServerCopy:function(){var t=this.interacter,e=t.rID,i=t.sheetID,r=t.version,o=t.getEncryptedID();ZSChart.Server.Action.doServerCopy(e,i,r,o)}},o.Interacter=h}(this);
!function(e){var t=e.ZSClass,n=(e.sPlusPlus,e.ZSEvents),s=n.topic,r=n.Groups,i=n.Names,l=(t.Layer.Ole.Interacter,e.ZSGrid.UISheetGrid),o=l.Layers;l.prototype;o.push(function(){this.Ole=new t.Layer.Ole.MasterController}),s.register(r.Listener,i.Layers.Ole.Blur,function(e,t,n){ApplyOnComputedSheets(e,t,n,function(){this.Ole.blurAll()})},"RID","SHEETID","VERSION"),s.register(r.Listener,i.Layers.Ole.Move,function(e,t,n,s){ApplyOnComputedSheets(e,t,n,function(){this.Ole.move(s)})},"RID","SHEETID","VERSION","HELPER"),s.register(r.Listener,i.Layers.Ole.MoveEnd,function(e,t,n,s){ApplyOnComputedSheets(e,t,n,function(){this.Ole.moveEnd(s)})},"RID","SHEETID","VERSION","HELPER"),s.register(r.Listener,i.Layers.Ole.Delete,function(e,t,n){ApplyOnComputedSheets(e,t,n,function(){this.Ole.delete()})},"RID","SHEETID","VERSION","HELPER"),s.register(r.Listener,i.Layers.Ole.SelectNext,function(e,t,n){ApplyOnComputedSheets(e,t,n,function(){this.Ole.focusNext()})},"RID","SHEETID","VERSION","HELPER"),s.register(r.Listener,i.Layers.Ole.SelectPrev,function(e,t,n){ApplyOnComputedSheets(e,t,n,function(){this.Ole.focusPrev()})},"RID","SHEETID","VERSION","HELPER"),s.register(r.Listener,i.Layers.Ole.Copy,function(e,t,n,s){ApplyOnComputedSheets(e,t,n,function(){this.Ole.copy()})},"RID","SHEETID","VERSION","HELPER")}(this);
!function(e){var t,r,i=e.ZSClass,o=e.sPlusPlus,n=e.ZSEvents,a=n.topic,l=n.Groups,s=n.Names,g=i.Layer.MouseFollower.Interacter,d=e.ZSGrid.UISheetGrid.Layers,c=e.ZSGrid.Nodes.CheckBox;d.push(function(){var e=this.MouseFollower=new i.Layer.MouseFollower.Controller;this.addLayer(e)}),a.register(l.Listener,s.Mouse.Move,function(n,d,u,v,h){ApplyOnComputedSheets(n,d,u,function(){if(t!=v||r!=h){var C=o.data.getWorkBook(n,u),p=C.getSheetObj(d),w=p.Merge.isXists(v,h);w&&(v=w.root.startRow,h=w.root.startCol);var f=C.ProtectedSheets.isSheetLocked(d),R=f||p.ProtectedRanges.isXists(v,h),S=new i.Range(v,h,v,h);p.Merge.extendRange(S);var m=e.JSUtil.Math.hash(S.startRow,S.startCol,sPlusPlus.data.Defaults.MAX_COL),k=p.Notes.get(m);k?a.publish(l.Listener,s.CellAction.COMMENT.SHOW,{RID:n,SHEETID:d,VERSION:u,ROW:S.startRow,COL:S.startCol,COMMENT:k}):a.publish(l.Listener,s.CellAction.COMMENT.HIDE);var A=o.view.getActiveGridID(),D=o.view.getGridComponent(A).interacter.getCell(v,h),G=D&&D.data&&D.data.isCheckbox&&!R?function(t,r,i,n,a){var l=e.getDataCache(t,r,i).getCell(n,a),s=o.view.getActiveGridID(),g=o.view.getGridComponent(s);if(l)for(var d=0;d<l.ForeGroundStack.length;d++){var u=l.ForeGroundStack[d];if(u instanceof c)return{value:u.isChecked,zoom:g.getZoom()}}return null}(n,d,u,v,h):null,I=f?null:function(e,t,r,n,a){for(var l=o.data.getWorkBook(e,r).getSheetObj(t).DataFilters,s=new i.Range(n,a,n,a),g=l.getIntersectedRanges(s),d=o.view.getActiveGridID(),c=o.view.getGridComponent(d),u=c.interacter.getCell(n,a),v=0;v<g.length;v++){var h=g[v];if(h.startRow===n)return{applied:h.properties.isApplied,valign:u.getVerticalAlignment(),zoom:c.getZoom()}}return null}(n,d,u,S.startRow,S.startCol),M=function(e,t,r,n,a){if(r!=o.data.Defaults.version){var l=new i.Range(n,a,n,a),s=o.view.getActiveGridID(),g=o.view.getVersionState(s),d=g.getVersionActionList(),c=g.getHighlightVersionChanges(),u=d[t];for(var v in u)if(g.isEditAction(u[v].a)&&c){var h=u[v].lp.length,C=u[v].lp[h-1];if(JSUtil.Range.parseRange(e,r,C).range.intersects(l))return{name:u[v].un,color:"#"+u[v].cc}}}return null}(n,d,u,v,h),O=D.data&&D.data.hyperlinkData?D.data.hyperlinkData:null,L=function(e,t,r,i,n){var a=o.data.getWorkBook(e,r).getSheetObj(t).PivotButton.isXists(i,n),l=o.view.getActiveGridID(),s=o.view.getGridComponent(l),g=s.interacter.getCell(i,n);return!!a&&{applied:"filter_new"!==a.root.properties.type,valign:g.getVerticalAlignment(),zoom:s.getZoom()}}(n,d,u,v,h),E=function(e,t,r,i,n){var a=o.data.getWorkBook(e,r).getSheetObj(t).Picklist.getInfo(i,n),l=o.view.getActiveGridID(),s=o.view.getGridComponent(l),g=s.interacter.getCell(i,n);return a?{picklist:a,halign:g.getHorizontalAlignment(),valign:g.getVerticalAlignment(),zoom:s.getZoom()}:null}(n,d,u,S.startRow,S.startCol),P=new g(this.interacter,0,S.startRow,S.startCol,S.endRow,S.endCol,G,I,M,O,L,D.getPaddingLeft(),D.getPaddingRight(),D.getPaddingTop(),D.getPaddingBottom(),E);this.MouseFollower.place(P),r=h,t=v}})},"RID","SHEETID","VERSION","ROW","COL")}(this);
!function(e){var t=e.ZSClass,n=(e.sPlusPlus,e.ZSEvents),i=n.topic,r=n.Groups,o=n.Names,a=t.Layer.RangeSelection.Interacter;e.ZSGrid.UISheetGrid.Layers.push(function(){var e=this.RangeSelection=new t.Layer.RangeSelection.Controller;this.addLayer(e)}),i.register(r.Selector.DomUpdate.Range,o.Selection.BOUND_UPDATE.ADD,function(e,t,n,i,r,o){ApplyOnComputedSheets(e,t,n,function(){var e=new a(this.interacter,i,r.startRow,r.startCol,r.endRow,r.endCol,!o);this.RangeSelection.place(e)})},"RID","SHEETID","VERSION","RANGEID","ActiveRange","isSingleCell"),i.register(r.Selector.DomUpdate.Range,o.Selection.BOUND_UPDATE.REMOVE,function(e,t,n,i){ApplyOnComputedSheets(e,t,n,function(){var e=new a(this.interacter,i);this.RangeSelection.remove(e)})},"RID","SHEETID","VERSION","RANGEID")}(this);
!function(e){var t=e.ZSClass,n=(e.sPlusPlus,e.ZSEvents),r=n.topic,i=n.Groups,s=n.Names,o=t.Layer.Selection.Interacter;e.ZSGrid.UISheetGrid.Layers.push(function(){var e=this.Selection=new t.Layer.Selection.Controller;this.addLayer(e)}),r.register(i.Selector.DomUpdate.Cell,s.Selection.BOUND_UPDATE.ADD,function(e,t,n,r,i){ApplyOnComputedSheets(e,t,n,function(){var e=new o(this.interacter,r,i.startRow,i.startCol,i.endRow,i.endCol);this.Selection.place(e)})},"RID","SHEETID","VERSION","RANGEID","ActiveCellRange")}(this);
!function(e){var t=e.ZSClass,i=(e.sPlusPlus,e.ZSEvents),r=i.topic,l=i.Groups,n=i.Names,s=t.Layer.FillSeriesSelectionCue.Interacter;function S(e,t,i,r,l){ApplyOnComputedSheets(e,t,i,function(){var e=new s(this.interacter,0,l.startRow,l.startCol,l.endRow,l.endCol);this.FillSeriesSelectionCue.place(e)})}function o(e,t,i,r){ApplyOnComputedSheets(e,t,i,function(){var e=new s(this.interacter,0);this.FillSeriesSelectionCue.remove(e)})}e.ZSGrid.UISheetGrid.Layers.push(function(){var e=this.FillSeriesSelectionCue=new t.Layer.FillSeriesSelectionCue.Controller;this.addLayer(e)}),r.register(l.Selector.DomUpdate.Range,n.Selection.BOUND_UPDATE.ADD,S,"RID","SHEETID","VERSION","RANGEID","ActiveRange","isSingleCell"),r.register(l.Selector.DomUpdate.Range,n.Selection.BOUND_UPDATE.REMOVE,o,"RID","SHEETID","VERSION","RANGEID"),r.register(l.Selector.DomUpdate.FillSeries,n.Selection.BOUND_UPDATE.ADD,S,"RID","SHEETID","VERSION","RANGEID","ActiveRange"),r.register(l.Selector.DomUpdate.FillSeries,n.Selection.BOUND_UPDATE.MODIFY,o,"RID","SHEETID","VERSION","RANGEID")}(this);
!function(e){var t=e.ZSClass,r=(e.sPlusPlus,e.ZSEvents),n=r.topic,i=r.Groups,s=r.Names,a=t.Layer.RangePicker.Interacter,c=e.ZSGrid.UISheetGrid,o=c.Layers;c.prototype;function R(e,t,r,n){ApplyOnComputedSheets(e,t,r,function(){var e=new a(this.interacter,n);this.RangePicker.remove(e)})}o.push(function(){var e=this.RangePicker=new t.Layer.RangePicker.Controller;this.addLayer(e)}),n.register(i.Listener,s.RangePicker.Add,function(e,t,r,n,i,s,c){ApplyOnComputedSheets(e,t,r,function(){if(t==this.interacter.getSheetID()){var o=new a(this.interacter,n,i.startRow,i.startCol,i.endRow,i.endCol,s,c);this.RangePicker.place(o)}else R(e,t,r,n)})},"RID","SHEETID","VERSION","RANGEID","Range","isCurrentRange","color"),n.register(i.Listener,s.RangePicker.Hide,R,"RID","SHEETID","VERSION","index")}(this);
!function(e){var t=e.ZSClass,i=(e.sPlusPlus,e.ZSEvents),r=i.topic,l=i.Groups,n=i.Names,s=t.Layer.FillSeriesSelection.Interacter,o=e.ZSGrid.UISheetGrid,S=o.Layers;o.prototype;S.push(function(){var e=this.FillSeriesSelection=new t.Layer.FillSeriesSelection.Controller;this.addLayer(e)}),r.register(l.Selector.DomUpdate.FillSeries,n.Selection.BOUND_UPDATE.ADD,function(e,t,i,r,l){ApplyOnComputedSheets(e,t,i,function(){var e=new s(this.interacter,r,l.startRow,l.startCol,l.endRow,l.endCol);this.FillSeriesSelection.place(e)})},"RID","SHEETID","VERSION","RANGEID","ActiveRange"),r.register(l.Selector.DomUpdate.FillSeries,n.Selection.BOUND_UPDATE.REMOVE,function(e,t,i,r){ApplyOnComputedSheets(e,t,i,function(){var e=new s(this.interacter,r);this.FillSeriesSelection.remove(e)})},"RID","SHEETID","VERSION","RANGEID")}(this);
!function(e){var t=e.ZSClass,o=(e.sPlusPlus,e.ZSEvents),n=o.topic,i=o.Groups,r=o.Names,s=t.Layer.CopySelection.Interacter;e.ZSGrid.UISheetGrid.Layers.push(function(){var e=this.CopySelection=new t.Layer.CopySelection.Controller;this.addLayer(e)}),n.register(i.Selector.DomUpdate.Copy,r.Selection.BOUND_UPDATE.ADD,function(e,t,o,n,i){ApplyOnComputedSheets(e,t,o,function(){var e=new s(this.interacter,n,i.startRow,i.startCol,i.endRow,i.endCol);this.CopySelection.place(e)})},"RID","SHEETID","VERSION","RANGEID","ActiveRange"),n.register(i.Selector.DomUpdate.Copy,r.Selection.BOUND_UPDATE.REMOVE,function(e,t,o,n){ApplyOnComputedSheets(e,t,o,function(){var e=new s(this.interacter,n);this.CopySelection.remove(e)})},"RID","SHEETID","VERSION","RANGEID")}(this);
!function(e){var t=e.ZSClass,r=(e.sPlusPlus,e.ZSEvents),n=r.topic,s=r.Groups,i=r.Names,a=t.Layer.DragSelection.Interacter,o=e.ZSGrid.UISheetGrid,c=o.Layers;o.prototype;c.push(function(){var e=this.DragSelection=new t.Layer.DragSelection.Controller;this.addLayer(e)}),n.register(s.Listener,i.Layers.Drag.Place,function(e,t,r,n,s){ApplyOnComputedSheets(e,t,r,function(){var e=new a(this.interacter,n,s.startRow,s.startCol,s.endRow,s.endCol);this.DragSelection.place(e)})},"RID","SHEETID","VERSION","ID","RANGE"),n.register(s.Listener,i.Layers.Drag.Remove,function(e,t,r,n){ApplyOnComputedSheets(e,t,r,function(){var e=new a(this.interacter,n);this.DragSelection.remove(e)})},"RID","SHEETID","VERSION","ID")}(this);
!function(e){var r=e.ZSClass,t=(e.sPlusPlus,e.ZSEvents),a=t.topic,n=t.Groups,s=t.Names,i=r.Layer.HeaderDragSelection.Interacter,o=e.ZSGrid.UISheetGrid,c=o.Layers;o.prototype;c.push(function(){var e=this.HeaderDragSelection=new r.Layer.HeaderDragSelection.Controller;this.addLayer(e)}),a.register(n.Listener,s.Layers.HeaderDrag.Place,function(e,r,t,a,n){ApplyOnComputedSheets(e,r,t,function(){var e=new i(this.interacter,a,n.startRow,n.startCol,n.endRow,n.endCol);this.HeaderDragSelection.place(e)})},"RID","SHEETID","VERSION","ID","RANGE"),a.register(n.Listener,s.Layers.HeaderDrag.Remove,function(e,r,t,a){ApplyOnComputedSheets(e,r,t,function(){var e=new i(this.interacter,a);this.HeaderDragSelection.remove(e)})},"RID","SHEETID","VERSION","ID")}(this);
!function(e){var t=e.ZSClass,s=(e.sPlusPlus,e.ZSEvents),r=s.topic,n=s.Groups,i=s.Names,o=t.Layer.Notes.Interacter;e.ZSGrid.UISheetGrid.Layers.push(function(){var e=this.Notes=new t.Layer.Notes.Controller;this.addLayer(e)}),r.register(n.Listener,i.Layers.Note.Place,function(e,t,s,r,n,i,a,c,u,h,N,O){ApplyOnComputedSheets(e,t,s,function(){var l=new o(this.interacter,e,t,s,r,n,i,a,c,u,h,N,O);this.Notes.place(l),this.Notes.setComment(l)})},"RID","SHEETID","VERSION","ROW","COL","COMMENT","X","Y","ROWX","COLY","FIXRIGHT","FIXBOTTOM"),r.register(n.Listener,i.Layers.Note.Remove,function(e,t,s,r,n){ApplyOnComputedSheets(e,t,s,function(){var i=new o(this.interacter,e,t,s,r,n);this.Notes.remove(i)})},"RID","SHEETID","VERSION","ROW","COL"),r.register(n.Listener,i.Layers.Note.RemoveAll,function(e,t,s){ApplyOnComputedSheets(e,t,s,function(){var r=new o(this.interacter,e,t,s);this.Notes.removeAll(r)})},"RID","SHEETID","VERSION")}(this);
!function(t){var e=t.ZSClass,r=t.sPlusPlus,i=t.ZSEvents,s=i.topic,o=i.Groups,n=i.Names,a=e.Layer.HighlightLocks.Interacter,E=t.ZSGrid.UISheetGrid,h=E.Layers;E.prototype;function S(t){var e={};for(var i in t){var s=t[i],o=s.startRow,n=s.startCol,a=s.endRow,E=s.endCol;e[JSUtil.Math.hash(o,n,r.data.Defaults.MAX_COL)]={startRow:o,startCol:n,endRow:a,endCol:E}}return e}function R(t,e,i,s,o){ApplyOnComputedSheets(t,e,i,function(){var o;o=Array.isArray(s)?S(s):s;r.data.getWorkBook(t,i).getSheetObj(e);for(var n=Object.keys(o),E=(r.view.getActiveGridID(),0);E<n.length;E++){var h=n[E],R=o[h],g=new a(this.interacter,h,R.startRow,R.startCol,R.endRow,R.endCol);this.HighlightLocks.place(g)}})}function g(t,e,i,s){ApplyOnComputedSheets(t,e,i,function(){var o;o=Array.isArray(s)?S(s):s;r.data.getWorkBook(t,i).getSheetObj(e);for(var n=Object.keys(o),E=0;E<n.length;E++){var h=n[E],R=o[h],g=new a(this.interacter,h,R.startRow,R.startCol,R.endRow,R.endCol);this.HighlightLocks.remove(g)}})}function c(t,e,i,s){r.data.getWorkBook(t,i).highlightLocks&&R(t,e,i,s)}h.push(function(){var t=this.HighlightLocks=new e.Layer.HighlightLocks.Controller;this.addLayer(t)}),s.register(o.Listener,n.UserAction.HIGHLIGHT_LOCKS,R,"RID","SHEETID","VERSION","RANGELIST","SHEETLIST"),s.register(o.Listener,n.UserAction.REMOVE_HIGHLIGHT_LOCKS,g,"RID","SHEETID","VERSION","RANGELIST","SHEETLIST"),s.register(o.Listener,n.SheetMeta.PROTECTED_RANGES,c,"RID","SHEETID","VERSION","RangeList"),s.register(o.Listener,n.SheetAction.PROTECTED_RANGES.MODIFY,c,"RID","SHEETID","VERSION","RangeList"),s.register(o.Listener,n.SheetAction.PROTECTED_RANGES.REMOVE,g,"RID","SHEETID","VERSION","RangeList")}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,t.ZSEvents),n=i.topic,s=i.Groups,r=i.Names,o=e.Layer.HighlightComments.Interacter;t.ZSGrid.UISheetGrid.Layers.push(function(){var t=this.HighlightComments=new e.Layer.HighlightComments.Controller;this.addLayer(t)}),n.register(s.Listener,r.UserAction.REVIEW_COMMENTS.PLACE_HIGHLIGHT,function(t,e,i,n,s){ApplyOnComputedSheets(t,e,i,function(){var t=new o(this.interacter,s,n.startRow,n.startCol,n.endRow,n.endCol);this.HighlightComments.place(t),this.HighlightComments.glowContainer(t)})},"RID","SHEETID","VERSION","RANGE","RANGEID"),n.register(s.Listener,r.UserAction.REVIEW_COMMENTS.REMOVE_HIGHLIGHT,function(t,e,i,n,s){ApplyOnComputedSheets(t,e,i,function(){var t=new o(this.interacter,s,n.startRow,n.startCol,n.endRow,n.endCol);this.HighlightComments.remove(t)})},"RID","SHEETID","VERSION","RANGE","RANGEID")}(this);
!function(e){var t=e.ZSClass,a=(e.sPlusPlus,e.ZSEvents),s=a.topic,l=a.Groups,r=a.Names,c=t.Layer.RecalculateFlash.Interacter,n=e.ZSGrid.UISheetGrid,i=n.Layers;n.prototype;i.push(function(){var e=this.RecalculateFlash=new t.Layer.RecalculateFlash.Controller;this.addLayer(e)}),s.register(l.Listener,r.Layers.Recalculate.Place,function(e,t,a,s,l){ApplyOnComputedSheets(e,t,a,function(){var e=new c(this.interacter,s,l.startRow,l.startCol,l.endRow,l.endCol);this.RecalculateFlash.place(e);var t=this;setTimeout(function(){t.RecalculateFlash.remove(e)},2e3)})},"RID","SHEETID","VERSION","ID","RANGE")}(this);
!function(t){var e=t.ZSClass,a=t.sPlusPlus,i=t.ZSEvents,r=i.topic,s=i.Groups,n=i.Names,o=e.Layer.DataValidation.Interacter,h=t.ZSGrid.UISheetGrid,g=h.Layers;h.prototype;g.push(function(){var t=this.DataValidation=new e.Layer.DataValidation.Controller;this.addLayer(t)}),r.register(s.Listener,n.UserAction.DATA_VALIDATION.PLACE_DV_HINT,function(t,i,r,s,n,h,g,I){ApplyOnComputedSheets(t,i,r,function(){var l=this,D=a.view.getActiveGridID();a.view.fetchRangeData(t,i,r,new e.Range(s,n,s,n),["IsContentValid"],!0,D,function(D){var R=D[s][n].IsContentValid,c=a.data.getWorkBook(t,r).getSheetObj(i).Merge;if(c.isIntersecting(new e.Range(s,n,s,n))){var A=c.isXists(s,n);s=A.root.endRow,n=A.root.endCol}var S=new o(l.interacter,0,t,i,r,s,n,h,g,I,R);l.DataValidation.place(S)})})},"RID","SHEETID","VERSION","ROW","COL","TEXT","TYPE","MESSAGE"),r.register(s.Listener,n.UserAction.DATA_VALIDATION.HIDE_DV_HINT,function(t,e,a){ApplyOnComputedSheets(t,e,a,function(){var t=new o(this.interacter,0);this.DataValidation.remove(t)})},"RID","SHEETID","VERSION")}(this),function(t){var e,a=t.sPlusPlus,i=t.ZSEvents,r=i.topic,s=i.Groups,n=i.Names,o=t.ZSClass,h=t.UserAction;function g(t,e,a,i,r){this.rID=t,this.sheetID=e,this.version=a,this.row=i.startRow,this.col=i.startCol,this.totalParts=0,this.partNum=0,this.array=r,this.getValueList()}g.prototype={getValueList:function(){if(this.array.isListRange&&this.array.range&&-1==this.array.range.indexOf("=")&&!this.hiddenSheetRange()){var t=this,e=this.array.range;if(this.rangeInfo=JSUtil.Range.parseRange(this.rID,this.version,e),!this.rangeInfo){var i=a.data.getWorkBook(this.rID,this.version).NamedRange.namedRangeMap.get(e);this.rangeInfo=JSUtil.Range.parseRange(this.rID,this.version,JSUtil.FormRange(i)),e=JSUtil.FormRange(i)}this.rangeObj=this.rangeInfo.range,this.rangeObj.endRow-this.rangeObj.startRow>2e3&&(this.rangeObj.endRow=this.rangeObj.startRow+2e3);a.view.fetchRangeData(this.rID,this.rangeInfo.sheetID,this.version,this.rangeObj,["ActualValue"],!0,a.view.getActiveGridID(),function(a){var i=[],r={};for(var s in a)for(var n in a[s]){var o=a[s][n].ActualValue;""==o.trim()||r[o]||(!r[o]&&i.push(o),r[o]=!0)}if(i.length){var h=JSUtil.Range.parseRange(t.rID,t.version,e).range,g={dataval:{sr:t.row,er:t.row,sc:t.col,ec:t.col,list:i,listSrcRange:{sr:h.startRow,sc:h.startCol,er:h.endRow,ec:h.endCol,sn:t.sheetID},partnum:-1}};t.listResponse(g)}})}else-1!=this.partNum&&this.array.type&&h.getListValues(this.rID,this.sheetID,this.version,this.row,this.col,this.totalParts,this.partNum,this.array.isListRange,this.array.range)},hiddenSheetRange:function(){var t=this.array.range;this.rngObj=JSUtil.Range.parseRange(this.rID,this.version,t);var e=a.data.getWorkBook(this.rID,this.version);if(!this.rngObj){var i=e.NamedRange.namedRangeMap.get(t);this.rangeInfo=JSUtil.Range.parseRange(this.rID,this.version,JSUtil.FormRange(i)),t=JSUtil.FormRange(i),this.rngObj=JSUtil.Range.parseRange(this.rID,this.version,t)}var r=e.SheetList.getIdByName(this.rngObj.sheetName);return e.SheetList.getById(r).getHidden()},listResponse:function(t){this.partNum=t.dataval.partnum,this.totalParts=t.dataval.tparts,r.publish(s.Listener,n.UserAction.DATA_VALIDATION.SHOW_LIST,{LIST_ARRAY:t.dataval.list})}},r.register(s.Listener,n.UserAction.DATA_VALIDATION.LIST_RESPONSE,function(t){e.listResponse(t)},"LIST_JSON"),r.register(s.Listener,n.UserAction.DATA_VALIDATION.GET_SCROLL_LIST,function(){e.getValueList()}),r.register(s.Selector.DomUpdate.CellEdit,n.Selection.BOUND_UPDATE.ADD,function(t,i,h,I){r.publish(s.Listener,n.UserAction.DATA_VALIDATION.HIDE_DV_HINT,{RID:t,SHEETID:i,VERSION:h});var l=function(t,e,i,r,s){var n=a.data.getWorkBook(t,i).getSheetObj(e).DataValidation.getIntersectedRanges(new o.Range(r,s,r,s));return n.length?n:""}(t,i,h,I.startRow,I.startCol)[0];l&&(e=new g(t,i,h,I,l))},"RID","SHEETID","VERSION","ActiveRange"),r.register(s.Listener,n.SheetAction.DATAVALIDATION.UPDATEDOM,function(t,e,i){var r=a.view.getActiveGridID();a.view.getSheetID(r)},"RESOURCE_ID","VERSION","STATE")}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,n=t.ZSEvents,a=n.topic,r=n.Groups,o=n.Names,s=e.Layer.DataValidationButton.Interacter,u=t.ZSGrid.UISheetGrid,D=u.Layers;u.prototype;D.push(function(){var t=this.DataValidationButton=new e.Layer.DataValidationButton.Controller;this.addLayer(t)}),a.register(r.Listener,o.UserAction.DATA_VALIDATION.PLACE_DV_BTN,function(t,n,a,r,o,u){ApplyOnComputedSheets(t,n,a,function(){var D=i.data.getWorkBook(t,a),c=(i.view.getActiveGridID(),D.getSheetObj(n));if(c.Merge.isIntersecting(new e.Range(r,o,r,o))){var I=c.Merge.isXists(r,o);r=I.root.endRow,o=I.root.endCol}var d=new s(this.interacter,0,r,o,u);this.DataValidationButton.place(d)})},"RID","SHEETID","VERSION","ROW","COL","ALIGN"),a.register(r.Listener,o.UserAction.DATA_VALIDATION.HIDE_DV_BTN,function(t,e,i){ApplyOnComputedSheets(t,e,i,function(){var t=new s(this.interacter,0);this.DataValidationButton.remove(t)})},"RID","SHEETID","VERSION")}(this);
!function(e){var t=e.ZSClass,s=e.sPlusPlus,a=e.ZSEvents,i=a.topic,n=a.Groups,o=a.Names,c=t.Layer.PasteWidget.Interacter,r=e.ZSConstants,d=(r.CommandConstants,r.ActionConstants),g={253:d.SYSTEMCLIP_PASTE,252:d.FILLSERIES,249:d.SERVERCLIP_PASTE_RANGE},S=e.ZSGrid.UISheetGrid,I=S.Layers;S.prototype;I.push(function(){var e=this.PasteWidget=new t.Layer.PasteWidget.Controller;this.addLayer(e)}),i.register(n.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT,function(e,t,a,i){ApplyOnComputedSheets(e,t,a,function(){var e=i[1][0][1][0][0],a=i[0],n=g[a],o=i[1][0][0],r=i[1][0][3],S=i[1][0][5],I=i[1][0][2],E=e.sr,l=e.sc,p=e.er,C=e.ec,R=i[2];s.data.UserInfo.RecastInfo=[];var u=function(e){var t=s.view.getActiveGridID(),a=s.view.getResourceID(t),i=s.view.getSheetID(t),n=s.view.getVersionID(t),o=(s.data.getWorkBook(a,n).getSheetObj(i),sPlusPlus.view.getSheetState(t,i)),c=o.sTops[0],r=o.sLefts[0],d=o.sHeights[0],g=o.sWidths[0],S=e.sr,I=e.sc,E=e.er,l=e.ec,p=(e[4],s.data.getWorkBook(a,n).getSheetObj(i),sPlusPlus.view.getGridComponent(t)),C=p.interacter,R=(C.getRowY(S),C.getColX(I),C.getRowY(E+1)),u=C.getColX(l+1),h=p.getZoom(),v=!1,f=!1;return r+g>u*h||(v=!0),c+d>R*h||(f=!0),v&&f?3:v?2:f?1:0}(e),h=!1,v=!1;1===u&&(h=!0),2===u&&(v=!0),3===u&&(h=!0,v=!0),s.data.UserInfo.RecastInfo=[];var f=s.view.getActiveGridID(),m=(s.view.getSheetState(f,t).getZoom(),new c(this.interacter,0,E,l,p,C,v,h));this.PasteWidget.place(m),function(e,t,a,i,n,o,c,r,g,S){if(!s.data.isRecastAction){switch(e){case d.SYSTEMCLIP_PASTE:document.getElementsByClassName("shIcon cpWidget")[0].classList.remove("fsWidget");break;case d.SERVERCLIP_PASTE_RANGE:case d.COPY_PASTE:document.getElementsByClassName("shIcon cpWidget")[0].classList.remove("fsWidget");break;case d.FILLSERIES:document.getElementsByClassName("shIcon cpWidget")[0].classList.add("fsWidget")}var I={rangeList:[[{sr:a,sc:i,er:n,ec:o}]],sheetList:[[c]]};s.data.RecastInfo={aparams:I,action:e,actionId:t},s.data.RecastInfo.popUpOptionType=r,s.data.RecastInfo.isT2COption=g,s.data.RecastInfo.isRecastActionOption=S}}(n,o,E,l,p,C,R,r,S,I)})},"RID","SHEETID","VERSION","META"),i.register(n.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,function(e,t,s){ApplyOnComputedSheets(e,t,s,function(){var e=new c(this.interacter,0);this.PasteWidget.remove(e)})},"RID","SHEETID","VERSION")}(this);
!function(e){var t=e.ZSClass,r=(e.sPlusPlus,e.ZSEvents),n=r.topic,s=r.Groups,a=r.Names,c=t.Layer.Precedance.Interacter,o=e.ZSGrid.UISheetGrid,i=o.Layers;o.prototype;i.push(function(){var e=this.Precedance=new t.Layer.Precedance.Controller;this.addLayer(e)}),n.register(s.Listener,a.Layers.Precedance.Place,function(e,t,r,n,s,a){ApplyOnComputedSheets(e,t,r,function(){var e=new c(this.interacter,n,s.startRow,s.startCol,s.endRow,s.endCol,a.startRow,a.startCol,a.endRow,a.endCol);this.Precedance.place(e)})},"RID","SHEETID","VERSION","ID","RANGE","CELL"),n.register(s.Listener,a.Layers.Precedance.Remove,function(e,t,r,n){ApplyOnComputedSheets(e,t,r,function(){var e=new c(this.interacter,n);this.Precedance.remove(e)})},"RID","SHEETID","VERSION","ID")}(this);
!function(e){var t=e.ZSClass,i=(e.sPlusPlus,e.ZSEvents),n=i.topic,r=i.Groups,s=i.Names,h=t.Layer.RangeHighlight.Interacter,a=e.ZSGrid.UISheetGrid,o=a.Layers;a.prototype;o.push(function(){var e=this.RangeHighlight=new t.Layer.RangeHighlight.Controller;this.addLayer(e)}),n.register(r.Listener,s.UserAction.HIGHLIGHT_RANGE.ADD,function(e,t,i,n,r,s){ApplyOnComputedSheets(e,t,i,function(){var e=new h(this.interacter,n,r.startRow,r.startCol,r.endRow,r.endCol,s);this.RangeHighlight.place(e)})},"RID","SHEETID","VERSION","RANGEID","RANGE","COLOR"),n.register(r.Listener,s.UserAction.HIGHLIGHT_RANGE.REMOVE,function(e,t,i,n){ApplyOnComputedSheets(e,t,i,function(){if(n)for(var e=0;e<n.length;e++){var t=new h(this.interacter,n[e]);this.RangeHighlight.remove(t)}else this.RangeHighlight.removeAll()})},"RID","SHEETID","VERSION","RANGEIDS")}(this);
!function(e){var t=e.ZSClass,r=e.sPlusPlus,s=e.ZSEvents,n=s.topic,o=s.Groups,a=s.Names,i=t.Layer.UserPresence.Interacter,c=e.ZSGrid.UISheetGrid,E=c.Layers;c.prototype;function I(e){return!(e.startRow>r.data.Defaults.MAX_ROW-1||e.startCol>r.data.Defaults.MAX_COL-1||e.endRow<r.data.Defaults.MIN_ROW||e.endCol<r.data.Defaults.MIN_COL)}function R(e,t,r,s,n,o,a,c){I(n)?ApplyOnComputedSheets(e,t,r,function(){var e=new i(this.interacter,s,n.startRow,n.startCol,n.endRow,n.endCol,"#"+o,a,c);this.UserPresence.place(e)}):u(e,t,r,s)}function u(e,t,r,s){ApplyOnComputedSheets(e,t,r,function(){var e=new i(this.interacter,s);this.UserPresence.remove(e)})}E.push(function(){var e=this.UserPresence=new t.Layer.UserPresence.Controller;this.addLayer(e)}),n.register(o.Listener,a.DocAction.USER_LIST.ADDINFO,R,"RID","SHEETID","VERSION","RANGEID","RANGE","COLOR","UNAME","EDITSTATUS"),n.register(o.Listener,a.DocAction.USER_LIST.REMOVE,u,"RID","SHEETID","VERSION","RANGEID"),n.register(o.Listener,a.DocAction.USER_LIST.EDITINFO,function(e,t,r,s,n,o,a){I(n)?ApplyOnComputedSheets(e,t,r,function(){R(e,t,r,s,n,o,a,!0)}):u(e,t,r,s)},"RID","SHEETID","VERSION","RANGEID","RANGE","COLOR","UNAME")}(this);
!function(e){var t=e.ZSClass,r=(e.sPlusPlus,e.ZSEvents),n=r.topic,i=r.Groups,o=r.Names,s=t.Layer.PivotPlaceHolder.Interacter,a=e.ZSGrid.UISheetGrid,c=a.Layers;a.prototype;function l(e,t,r,n){ApplyOnComputedSheets(e,t,r,function(){var e=new s(this.interacter,n);this.PivotPlaceHolder.remove(e)})}c.push(function(){var e=this.PivotPlaceHolder=new t.Layer.PivotPlaceHolder.Controller;this.addLayer(e)}),n.register(i.Listener,o.UserAction.PIVOT.PIVOTPLACEHOLDER_ADD,function(e,t,r,n,i){i.endRow=i.startRow+11,i.endCol=i.startCol+2,ApplyOnComputedSheets(e,t,r,function(){if(t==this.interacter.getSheetID()){var o=new s(this.interacter,n,i.startRow,i.startCol,i.endRow,i.endCol);this.PivotPlaceHolder.place(o)}else l(e,t,r,n)})},"RID","SHEETID","VERSION","ID","RANGE"),n.register(i.Listener,o.UserAction.PIVOT.PIVOTPLACEHOLDER_REMOVE,l,"RID","SHEETID","VERSION","ID"),n.register(i.Listener,o.UserAction.PIVOT.PIVOTPLACEHOLDER_MESSAGE,function(e,t,r,n){ApplyOnComputedSheets(e,t,r,function(){new s(this.interacter,n),this.PivotPlaceHolder.changeMessage(n)})},"RID","SHEETID","VERSION","ID"),n.register(i.Listener,o.UserAction.PIVOT.PIVOTPLACEHOLDER_FAULTY,function(e,t,r,n,i){ApplyOnComputedSheets(e,t,r,function(){var e=new s(this.interacter,n,i.startRow,i.startCol,i.endRow,i.endCol);this.PivotPlaceHolder.place(e)})},"RID","SHEETID","VERSION","ID","RANGE")}(this);
!function(t){var e=t.ZSClass,n=t.sPlusPlus,i=t.ZSEvents,r=i.topic,s=i.Groups,o=i.Names,S=e.Layer.Button.Interacter,u=t.ZSGrid.UISheetGrid,c=(u.Layers,{ID:0,Label:1,X:2,Y:3,Width:4,Height:5,ScriptListener:6});function I(){var t=this.Button.getActive();for(var e in t)return e}function T(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){var t=new S(this.interacter,i[c.ID],i[c.Label],i[c.X],i[c.Y],i[c.Width],i[c.Height],i[c.ScriptListener]);this.Button.place(t),this.Button.setButtonMeta(t)})}u.Layers.push(function(){var t=this.Button=new e.Layer.Button.Controller(this.Ole,"Button");this.addLayer(t)}),r.register(s.Listener,o.SheetMeta.BUTTONS,function(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){for(var r in i)T(t,e,n,i[r])})},"RID","SHEETID","VERSION","BUTTONS"),r.register(s.Listener,o.SheetAction.BUTTONS.INSERT,T,"RID","SHEETID","VERSION","BUTTONS","XAID"),r.register(s.Listener,o.SheetAction.BUTTONS.MOVE,function(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){T(t,e,n,i)})},"RID","SHEETID","VERSION","BUTTONS","XAID"),r.register(s.Listener,o.SheetAction.BUTTONS.RESIZE,function(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){T(t,e,n,i)})},"RID","SHEETID","VERSION","BUTTONS","XAID"),r.register(s.Listener,o.SheetAction.BUTTONS.MODIFY,function(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){T(t,e,n,i)})},"RID","SHEETID","VERSION","BUTTONS","XAID"),r.register(s.Listener,o.UserAction.BUTTONS.CLONE,function(t,n,i,r){ApplyOnComputedSheets(t,n,i,function(){var t=t||I.call(this),n=new e.Layer.Modules.Clone.Helper(100,100);this.Button.clone(t,n)})},"RID","SHEETID","VERSION","ID"),r.register(s.Listener,o.UserAction.BUTTONS.DELETE,function(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){var t=t||I.call(this),e=new S(this.interacter,t);this.Button.delete(e)})},"RID","SHEETID","VERSION","ID"),r.register(s.Listener,o.UserAction.BUTTONS.ASSIGNMACRO,function(t,e,n,i,r){ApplyOnComputedSheets(t,e,n,function(){var t=t||I.call(this);this.Button.assignMacro(t,r)})},"RID","SHEETID","VERSION","ID","CONTEXT"),r.register(s.Listener,o.SheetAction.BUTTONS.REPAINT,function(t,e,i){ApplyOnComputedSheets(t,e,i,function(){var r=n.data.getWorkBook(t,i).getSheetObj(e).Buttons.getMap();for(var s in r){var o=new S(this.interacter,s);this.Button.place(o),this.Button.setButtonMeta(o)}})},"RID","SHEETID","VERSION")}(this);
!function(e){var t=e.ZSClass,n=e.sPlusPlus,I=e.ZSEvents,i=I.topic,E=I.Groups,r=I.Names,s=t.Layer.Image.Interacter,o=e.ZSConstants.CommandConstants;function S(e,t,n,I){ApplyOnComputedSheets(e,t,n,function(){for(var i in I)a(e,t,n,I[i])})}function a(e,t,n,I){ApplyOnComputedSheets(e,t,n,function(){var e=new s(this.interacter,I[o.IMAGE_ID],I[o.IMAGE_ZINDEX],I[o.IMAGE_HEIGHT],I[o.IMAGE_WIDTH],I[o.IMAGE_ROW],I[o.IMAGE_COLUMN],I[o.IMAGE_ROW_DIFF],I[o.IMAGE_COL_DIFF],I[o.IMAGE_NAME],I[o.IMAGE_STYLE_NAME],I[o.IMAGE_TEXT_STYLE_NAME],I[o.IMAGE_URL],I[o.IMAGE_TILTE],I[o.IMAGE_DESC],I[o.IMAGE_HYPERLINK],I[o.IMAGE_ACTUAL_HEIGHT],I[o.IMAGE_ACTUAL_WIDTH],I[o.IMAGE_SOURCE_ID]);this.Image.place(e),this.Image.setImageMeta(e)})}function A(){var e=this.Image.getActive();for(var t in e)return t}function c(e,t,n,I){ApplyOnComputedSheets(e,t,n,function(){a(e,t,n,I)})}e.ZSGrid.UISheetGrid.Layers.push(function(){var e=this.Image=new t.Layer.Image.Controller(this.Ole,"Image");this.addLayer(e)}),i.register(E.Listener,r.SheetMeta.IMAGES,S,"RID","SHEETID","VERSION","IMAGES"),i.register(E.Listener,r.SheetAction.IMAGES.INSERT,S,"RID","SHEETID","VERSION","IMAGES"),i.register(E.Listener,r.SheetAction.IMAGES.MOVE,function(e,t,n,I){ApplyOnComputedSheets(e,t,n,function(){for(var i in I)a(e,t,n,I[i])})},"RID","SHEETID","VERSION","IMAGES"),i.register(E.Listener,r.SheetAction.IMAGES.RESIZE,function(e,t,n,I){ApplyOnComputedSheets(e,t,n,function(){for(var i in I)a(e,t,n,I[i])})},"RID","SHEETID","VERSION","IMAGES"),i.register(E.Listener,r.SheetAction.IMAGES.EDIT,function(e,t,n,I){ApplyOnComputedSheets(e,t,n,function(){for(var i=0,E=I.length;i<E;i++)c(e,t,n,I[i])})},"RID","SHEETID","VERSION","IMAGES"),i.register(E.Listener,r.UserAction.IMAGES.CLONE,function(e,n,I,i){ApplyOnComputedSheets(e,n,I,function(){var e=e||A.call(this),n=new t.Layer.Modules.Clone.Helper(100,100);this.Image.clone(e,n)})},"RID","SHEETID","VERSION","ID"),i.register(E.Listener,r.UserAction.IMAGES.RESIZE_TO_ORIGINAL,function(e,t,n,I,i,E){ApplyOnComputedSheets(e,t,n,function(){var e=e||A.call(this),t=new s(this.interacter,e);this.Image.resizeToOriginal(t)})},"RID","SHEETID","VERSION","ID","WIDTH","HEIGHT"),i.register(E.Listener,r.UserAction.IMAGES.REPLACE,function(e,t,n,I){ApplyOnComputedSheets(e,t,n,function(){var e=e||A.call(this),t=new s(this.interacter,e);this.Image.replaceImage(t)})},"RID","SHEETID","VERSION","ID"),i.register(E.Listener,r.UserAction.IMAGES.DELETE,function(e,t,n,I){ApplyOnComputedSheets(e,t,n,function(){var e=e||A.call(this),t=new s(this.interacter,e);this.Image.delete(t)})},"RID","SHEETID","VERSION","ID"),i.register(E.Listener,r.SheetAction.IMAGES.REPAINT,function(e,t,I){ApplyOnComputedSheets(e,t,I,function(){var i=n.data.getWorkBook(e,I).getSheetObj(t).Images.getMap();for(var E in i){var r=new s(this.interacter,E);this.Image.place(r),this.Image.setImageMeta(r)}})},"RID","SHEETID","VERSION")}(this);
!function(t){var e=t.ZSClass,n=t.sPlusPlus,i=t.ZSEvents,r=i.topic,s=i.Groups,o=i.Names,a=e.Layer.Chart.Interacter,h=(t.ZSConstants.CommandConstants,t.ZSGrid.UISheetGrid),c=h.Layers;h.prototype;function u(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){var t=new a(this.interacter,i);this.Chart.place(t)})}function S(t,e,n,i){if(i){var r=i.shift();r&&function(t,e,n,i){var r=this;return new Promise(function(s,o){l.call(r,i),u.call(r,t,e,n,i),C.call(r,t,e,n,i),function(t){var e=new a(this.interacter,t);this.Chart.Load(e)}.call(r,i),setTimeout(function(){s()},100)}.bind(this))}.call(this,t,e,n,r.id||r).then(function(){S.call(this,t,e,n,i)}.bind(this))}}function l(t){var e=new a(this.interacter,t);this.Chart.remove(e)}function C(t,e,i,r){n.data.getWorkBook(t,i).getSheetObj(e).Charts.get(r).flushInstance()}function f(t,e,n,i){i=i||I.call(this);var r=new a(this.interacter,i);this.Chart.delete(r)}function A(t,e,n,i){var r=i.shift();r&&function(t,e,n,i){var r=this;return new Promise(function(t,e){var n=new a(r.interacter,i);r.Chart.place(n);var s=r.Chart.getInteracter(i);r.Chart.onCachedViewAttach(i,s),setTimeout(function(){t()},100)}.bind(this))}.call(this,t,e,n,r).then(function(){A.call(this,t,e,n,i)}.bind(this))}function I(){var t=this.Chart.getActive();for(var e in t)return e}c.push(function(){var t=this.Chart=new e.Layer.Chart.Controller(this.Ole,"Chart");this.addLayer(t)}),r.register(s.Listener,o.UserAction.CHARTS.DELETE,function(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){for(var t in i){var e=i[t];e&&f.call(this,e)}})},"RID","SHEETID","VERSION","ACTIVE_CHART_ID"),r.register(s.Listener,o.SheetAction.CHARTS.INSERT,function(t,e,n,i,r){ApplyOnComputedSheets(t,e,n,function(){var t=this;return new Promise(function(e,n){for(var s=0;s<i.length;s++){var o=i[s].id,h=new a(t.interacter,o);t.Chart.place(h),t.Chart.Render(h),!r&&t.Chart.focus(o)}setTimeout(function(){e()},100)}.bind(this))})},"RID","SHEETID","VERSION","CHARTS"),r.register(s.Listener,o.SheetMeta.CHARTS,function(t,e,n,i,r){ApplyOnComputedSheets(t,e,n,function(){this.Chart.removeAll(),S.call(this,t,e,n,i)})},"RID","SHEETID","VERSION","CHARTS"),r.register(s.Listener,o.UserAction.CHARTS.UPDATE,function t(e,n,i,r,s){ApplyOnComputedSheets(e,n,i,function(){if(r){var o=r.shift();o&&function(t,e,n,i,r){var s=this;return new Promise(function(o,h){C.call(s,t,e,n,i),u.call(s,t,e,n,i),function(t){var e=new a(this.interacter,t);this.Chart.Refresh(e)}.call(s,i),!r&&s.Chart.focus(i),setTimeout(function(){o()},100)}.bind(this))}.call(this,e,n,i,o.id,s).then(function(){t.call(this,e,n,i,r,s)}.bind(this))}})},"RID","SHEETID","VERSION","CHARTS","doNotSetFocus"),r.register(s.Listener,o.SheetAction.CHARTS.ATTACH,function(t,e,n,i,r){ApplyOnComputedSheets(t,e,n,function(){var s=i.length,o=r.length;s>0&&S.call(this,t,e,n,i),o>0&&A.call(this,t,e,n,r)})},"RID","SHEETID","VERSION","CHARTS","CACHED"),r.register(s.Listener,o.SheetAction.CHARTS.PLACE,u,"RID","SHEETID","VERSION","ID"),r.register(s.Listener,o.SheetAction.CHARTS.BLUR,function(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){for(var t=0;t<i.length;t++){var e=i[t];this.Chart.blur(e)}})},"RID","SHEETID","VERSION","CHARTID"),r.register(s.Listener,o.SheetAction.CHARTS.FOCUS,function(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){for(var t=0;t<i.length;t++){var e=i[t];this.Chart.focus(e)}})},"RID","SHEETID","VERSION","CHARTID"),r.register(s.Listener,o.SheetAction.CHARTS.DELETE_LAYER,function(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){for(var t in i){var e=i[t];e&&l.call(this,e)}})},"RID","SHEETID","VERSION","ACTIVE_CHART_ID"),r.register(s.Listener,o.UserAction.CHARTS.ZOOM,function t(e,n,i,r,s){ApplyOnComputedSheets(e,n,i,function(){if(r){var s=r.shift();s&&function(t,e,n,i){var r=this;return new Promise(function(s,o){u.call(r,t,e,n,i),function(t){var e=new a(this.interacter,t);this.Chart.Zoom(e)}.call(r,i),setTimeout(function(){s()},100)}.bind(this))}.call(this,e,n,i,s.id).then(function(){t(e,n,i,r,!0)}.bind(this))}})},"RID","SHEETID","VERSION","CHARTS"),r.register(s.Listener,o.SheetAction.CHARTS.UPDTATE_BOUNDARY,function(t,e,n,i){ApplyOnComputedSheets(t,e,n,function(){this.Chart.removeAll(),A.call(this,t,e,n,i)})},"RID","SHEETID","VERSION","CHARTS"),r.register(s.Listener,o.SheetAction.CHARTS.UPDATE_PANEL_STATUS,function(t,e,n,i,r){ApplyOnComputedSheets(t,e,n,function(){var t=new a(this.interacter,i,r);this.Chart.updatePanelStatus(t)})},"RID","SHEETID","VERSION","CHART_ID","STATUS"),r.register(s.Listener,o.UserAction.CHARTS.NOTIFICATION.ADD,function(t,e,i,r){ApplyOnComputedSheets(t,e,i,function(){(function(t,e,i,r){n.data.getWorkBook(t,i).getSheetObj(e).Charts.get(r)&&this.Chart.placeNotification(r)}).call(this,t,e,i,r)})},"RID","SHEETID","VERSION","ID"),r.register(s.Listener,o.UserAction.CHARTS.NOTIFICATION.REMOVE,function(t,e,i,r){ApplyOnComputedSheets(t,e,i,function(){(function(t,e,i,r){n.data.getWorkBook(t,i).getSheetObj(e).Charts.get(r)&&this.Chart.removeNotification(r)}).call(this,t,e,i,r)})},"RID","SHEETID","VERSION","ID"),r.register(s.Listener,o.UserAction.CHARTS.NOTIFICATION.UPDATE,function(t,e,i,r,s){ApplyOnComputedSheets(t,e,i,function(){(function(t,e,i,r,s){n.data.getWorkBook(t,i).getSheetObj(e).Charts.get(r)&&this.Chart.updateNotification(r,s)}).call(this,t,e,i,r,s)})},"RID","SHEETID","VERSION","ID","STATUS")}(this);
!function(t){var r=t.ZSClass,o=r.Layer||(r.Layer={}),e=o.Ole||(o.Ole={}),n=1e3;function l(t){var r=t.getX(),o=t.getY();return n*o+r}function i(t,r){return t.getHashedID()===r.getHashedID()}function s(t,r){var o,e,n,s,a=l(t);for(var v in r){var c=(C=r[v]).getAlive();for(var f in c){var h=C.getInteracter(f),u=l(h);o?n>u&&(n=l(o=h)):n=l(o=h),a<=u&&!i(h,t)&&(e||(e=h,s=u),i(e,h)||u<s&&(e=h,s=u))}}!e&&(e=o);var C,g=e.getKey();(C=this.getController(g)).focus(e.getID()),C.scrollIntoView(e.getID())}function a(t,r){var o,e,n,s,a=l(t);for(var v in r){var c=(C=r[v]).getAlive();for(var f in c){var h=C.getInteracter(f),u=l(h);o?n<u&&(n=l(o=h)):n=l(o=h),u<=a&&!i(h,t)&&(e||(e=h,s=u),i(e,h)||u>=s&&(e=h,s=u))}}!e&&(e=o);var C,g=e.getKey();(C=this.getController(g)).focus(e.getID()),C.scrollIntoView(e.getID())}function v(){this.Controllers={}}v.prototype={addController:function(t,r){this.Controllers[r]=t},removeController:function(t){var r=this.Controllers.indexOf(t);this.Controllers[r]&&(this.Controllers[r].removeAll(),this.Controllers.splice(r,1))},getController:function(t){return this.Controllers[t]},onFocus:function(t){this.active=t},onBlur:function(){delete this.active},focusNext:function(){var t=this.active.getActive();for(var r in t){var o=this.active.getInteracter(r);return this.active.blur(r),void s.call(this,o,this.Controllers)}},focusPrev:function(){var t=this.active.getActive();for(var r in t){var o=this.active.getInteracter(r);return this.active.blur(r),void a.call(this,o,this.Controllers)}},blurAll:function(){for(var t in this.Controllers)this.Controllers[t].onBlurAll()},focusAll:function(){for(var t in this.Controllers)this.Controllers[t].onFocusAll()},removeAll:function(){for(var t in this.Controllers)this.Controllers[t].onRemoveAll()},move:function(t){for(var r in this.Controllers)this.Controllers[r].onMove(t)},moveEnd:function(t){for(var r in this.Controllers)this.Controllers[r].onMoveEnd(t)},resize:function(t){for(var r in this.Controllers)this.Controllers[r].onResize(t)},resizeEnd:function(t){for(var r in this.Controllers)this.Controllers[r].onResizeEnd(t)},delete:function(){for(var t in this.Controllers)this.Controllers[t].onDelete()},clone:function(t){for(var r in this.Controllers)this.Controllers[r].onClone(t)},copy:function(){for(var t in this.Controllers)this.Controllers[t].onCopy()},updateBoundary:function(t,r,o){for(var e in this.Controllers)this.Controllers[e].updateBoundary(t,r,o)}},e.MasterController=v}(this);
!function(e){var t,i=e.ZSClass,s=e.sPlusPlus,o=i.Layer||(i.Layer={}),n=o.Interface,a=o.Modules,r=a.Main,l=a.Focus,c=(a.Resize,a.Move,e.UIUtil),d=o.MouseFollower||(o.MouseFollower={}),h=(d.Model,i.UILayer),p=e.ZSEvents,m=p.topic,g=p.Groups,v=p.Names,u=(s.view.measures,{TOP:0,MIDDLE:1,BOTTOM:2});function D(e){var t=document.createElement("label");t.className="cbxc";var i=document.createElement("input");i.type="checkbox";var o=document.createElement("span");t.appendChild(i),i.checked=!1,t.appendChild(o),e.appendChild(t),this.input=i,this.Dom=t,i.addEventListener("click",function(e){e.stopPropagation();var t=s.view.getActiveGridID(),o=s.view.getGridComponent(t),n=o.translateCoordinates(e),a=o.getRelativeCoordinates(n.x,n.y),r=o.getInteracter(),l=r.getResourceID(),c=r.getSheetID(),d=r.getVersion(),h=r.findRow(a.y),p=r.findCol(a.x),m=s.data.getWorkBook(l,d),g=m.getSheetObj(c).ProtectedRanges.isXists(h,p),v=m.ProtectedSheets.isSheetLocked(c);if(g||v||!m.isEditable())return e.preventDefault(),!1;UserAction.CHECKBOX_EDIT(l,[c],d,~~i.checked)})}function f(e,t){var i=document.createElement("span");i.className="fltIcn",e.appendChild(i),i.addEventListener("mousedown",function(e){e.stopPropagation()}),i.addEventListener("dblclick",function(e){e.stopPropagation()}),i.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault();var t=s.view.getActiveGridID(),i=s.view.getGridComponent(t),o=i.translateCoordinates(e),n=i.getRelativeCoordinates(o.x,o.y),a=i.getInteracter(),r=a.getResourceID(),l=a.getSheetID(),c=a.getVersion(),d=a.findRow(n.y),h=a.findCol(n.x),p=s.data.getWorkBook(r,c).getSheetObj(l).Merge.isXists(d,h);p&&(h=p.root.startCol);var u=this.getBoundingClientRect(),D=u.height,f=u.width;m.publish(g.UI,v.Menu.SHOW_FILTER_OPTION,{WIDTH:f,HEIGHT:D,ROW:d,COL:h,TOP:u.top,LEFT:u.left})}),this.Dom=i}function y(e,t){var o=document.createElement("span");o.classList.add("dvListBtn","pckLstBtn");var n=document.createElement("DIV");n.classList.add("filler"),o.appendChild(n),e.appendChild(o),o.addEventListener("mousedown",function(e){var t=s.view.getActiveGridID(),o=s.view.getGridComponent(t),n=o.getInteracter(),a=n.getResourceID(),r=n.getSheetID(),l=n.getVersion(),c=o.translateCoordinates(e),d=o.getRelativeCoordinates(c.x,c.y),h=n.findRow(d.y),p=n.findCol(d.x),u=function(e){m.publish(g.Selector.BoundUpdate.CellEdit,v.Selection.BOUND_UPDATE.ADD,{RID:a,SHEETID:r,VERSION:l,RANGE:new i.Range(h,p,h,p),RANGEID:0}),m.publish(g.Listener,v.CellAction.VALUE.SET,{RID:a,SHEETID:r,VERSION:l,ROW:h,COL:p,VALUE:{DisplayValue:e[h][p].DisplayValue},FOCUS:!0})},D=["DisplayValue"];setTimeout(function(){s.view.fetchCellData(a,r,l,h,p,D,t,u,function(){})},0)}),this.Dom=o}function w(e,t){var i=document.createElement("span");i.className="fltIcn",e.appendChild(i),i.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault();var t=s.view.getActiveGridID(),i=s.view.getGridComponent(t),o=i.translateCoordinates(e),n=i.getRelativeCoordinates(o.x,o.y),a=i.getInteracter(),r=a.getResourceID(),l=a.getSheetID(),c=a.getVersion(),d=a.findRow(n.y),h=a.findCol(n.x),p=this.getBoundingClientRect();p.height,p.width;m.publish(g.UI,v.Menu.OPEN_PIVOTFILTER_OPTION,{RID:r,SHEETID:l,VERSION:c,ROW:d,COL:h})}),this.Dom=i}function L(e){var t=document.createElement("div");t.className="versionEdit",e.appendChild(t),this.edit=t}function I(e){var t,i,o=s.view.getActiveGridID(),n=s.view.getGridComponent(o),a=n.fifthPane.querySelector("#wrpr");a?(t=a,i=a.childNodes[0]):((t=document.createElement("div")).id="wrpr",t.setAttribute("nocontext",!0),i=document.createElement("ul")),this.container=i,this.wrapper=t,t.appendChild(i),n.fifthPane.appendChild(t),this.wrapper.addEventListener("mousedown",function(e){e.stopPropagation()}),this.wrapper.addEventListener("mousemove",function(e){e.stopPropagation()}),this.wrapper.className="hyperlinkContainer"}function E(){clearTimeout(t)}function C(e){var t=document.createElement("li"),i=document.createElement("a"),o=function(e){var t,i=document.createElement("span");return i.className="mr5",t=e.startsWith("tel:")?"teleLinkIcon":e.startsWith("mailto:")?"mailLinkIcon":e.startsWith("#")?"rangeLinkIcon":"urlLinkIcon",c.fn.addIcon(i,t),i}(e.linkto),n=e.displayValue;e.fun?(n=function(e){var t=s.view.getActiveGridID(),i=s.view.getGridComponent(t).getInteracter(),o=i.getResourceID(),n=i.getVersion(),a=s.data.getWorkBook(o,n);if(-1!=e.indexOf(".")){var r=e.split(".")[0],l=e.split(".")[1],c=r.substr(1,r.length),d=a.getSheetObj(c),h="#REF!";if(d){var p=d.Prop.getName();h="#"+p+"."+l}return h}return e}(n),i.addEventListener("click",function(){e.fun(e.linkto)})):(i.href=e.linkto,e.linkto.startsWith("t")||(i.target="_blank"));var a=document.createTextNode(n);return i.appendChild(a),t.appendChild(o),t.appendChild(i),t}function k(e,t,i,s){r.Layer.call(this,e,t,i,s);var o=document.createElement("div");o.className="wrapper",o.style.left="0px",o.style.right="0px",o.style.top="0px",o.style.bottom="0px",o.style.margin="auto",o.style.position="absolute",this.Dom.appendChild(o),this.wrapperDom=o,this.CheckBox=new D(o),this.FilterIcon=new f(o,this),this.VersionEdit=new L(o),this.HyperLink=new I(o),this.PivotIcon=new w(o,this),this.PicklistIcon=new y(o,this),h.call(this,this.Dom,{class:"mouseFollower"})}D.prototype={show:function(e,t){this.input.checked=e,this.Dom.style.display="",this.Dom.style.zoom=t},hide:function(){this.Dom.style.display="none"}},f.prototype={show:function(e,t,i){switch(e){case 1:this.Dom.classList.add("active");break;case 2:this.Dom.classList.remove("active")}switch(this.Dom.style.display="",this.Dom.style.zoom=i,this.Dom.style.right="4px",t){case u.TOP:this.Dom.classList.add("topAlign"),this.Dom.classList.remove("middleAlign"),this.Dom.classList.remove("bottomAlign");break;case u.MIDDLE:this.Dom.classList.add("middleAlign"),this.Dom.classList.remove("bottomAlign"),this.Dom.classList.remove("topAlign");break;case u.BOTTOM:this.Dom.classList.add("bottomAlign"),this.Dom.classList.remove("topAlign"),this.Dom.classList.remove("middleAlign")}},hide:function(){this.Dom.style.display="none"}},y.prototype={show:function(e,t,i,s){switch(e){case 1:this.Dom.classList.add("active");break;case 2:this.Dom.classList.remove("active")}switch(this.Dom.style.display="",this.Dom.style.zoom=i,t){case u.TOP:this.Dom.classList.add("topAlign"),this.Dom.classList.remove("middleAlign"),this.Dom.classList.remove("bottomAlign");break;case u.MIDDLE:this.Dom.classList.add("middleAlign"),this.Dom.classList.remove("bottomAlign"),this.Dom.classList.remove("topAlign");break;case u.BOTTOM:this.Dom.classList.add("bottomAlign"),this.Dom.classList.remove("topAlign"),this.Dom.classList.remove("middleAlign")}},hide:function(){this.Dom.style.display="none"}},w.prototype={show:function(e,t,i){switch(e){case 1:this.Dom.classList.add("active");break;case 2:this.Dom.classList.remove("active")}switch(this.Dom.style.display="",this.Dom.style.zoom=i,this.Dom.style.right="4px",t){case u.TOP:this.Dom.classList.add("topAlign"),this.Dom.classList.remove("middleAlign"),this.Dom.classList.remove("bottomAlign");break;case u.MIDDLE:this.Dom.classList.add("middleAlign"),this.Dom.classList.remove("bottomAlign"),this.Dom.classList.remove("topAlign");break;case u.BOTTOM:this.Dom.classList.add("bottomAlign"),this.Dom.classList.remove("topAlign"),this.Dom.classList.remove("middleAlign")}},hide:function(){this.Dom.style.display="none"}},L.prototype={show:function(e,t){this.edit.style.color=e,this.edit.dataset.name=t,this.edit.style.display=""},hide:function(){this.edit.style.display="none"}},I.prototype={show:function(e,t,i,o,n){E();var a=s.view.getActiveGridID(),r=s.view.getGridComponent(a),l=s.view.getResourceID(a),c=s.view.getSheetID(a),d=s.view.getVersionID(a),h=s.view.getSheetState(a,c),p=s.data.getWorkBook(l,d).getSheetObj(c),m=h.getScreenWidths(),g=h.getScreenHeights(),v=0,u=0;for(var D in m)v+=m[D];for(var f in g)u+=g[f];this.container.innerHTML="";for(var y=document.createDocumentFragment(),w=0;w<e.length;w++){var L=C(e[w]);y.appendChild(L)}this.container.appendChild(y),this.wrapper.style.display="",this.wrapper.addEventListener("mouseover",E);var I=this.container.offsetWidth;!function(e){for(var t=e.getElementsByTagName("li"),i=0;i<t.length;i++){var s=t[i],o=s.offsetWidth,n=s.getElementsByTagName("a"),a=s.getElementsByTagName("span"),r=a[0].offsetWidth,l=n[0].offsetWidth,c=o-r;if(c<=l-9){var d=n[0].innerText,h=d.length,p=Math.round(h*c/l),m=Math.round(p/2);n[0].innerText=d.slice(0,m)+"..."+d.slice(-(m-3))}}}(this.container);var k,A,b=r.getFreezedCol(),O=r.getFreezedRow(),T=r.getScrollX(o.startCol,b),R=r.getScrollY(o.startRow,O),P=this.wrapper.offsetHeight;if("lr-tb"===p.gridDirection?(k=t-T+I>v?v-I:t<T?0:t-T,this.wrapper.style.left=k+"px",this.wrapper.style.right=""):(k=t-T+I>v?v-I:t-T,this.wrapper.style.right=k+"px",this.wrapper.style.left=""),i-R+P>u){A=n-R-(P-1)}else A=i-R;this.wrapper.style.top=A+"px"},hide:function(){this.wrapper.style.display="none",this.wrapper.removeEventListener("mouseover",E)},debouncedHide:function(){E();var e=this;t=setTimeout(function(){e.hide()},500)}},k.prototype={onPlace:function(e,t,i,s,o,n,a,l,c,d,h,p,m,g,v){this.wrapperDom.style.width=i-a*o+"px",this.wrapperDom.style.height=s-n*o+"px",r.Layer.prototype.onPlace.call(this,e,t,i,s),l?this.CheckBox.show(l.value,l.zoom):this.CheckBox.hide(),c?this.FilterIcon.show(c.applied,c.valign,c.zoom):this.FilterIcon.hide(),d?this.VersionEdit.show(d.color,d.name):this.VersionEdit.hide(),h?this.HyperLink.show(h,e,m,g,t):this.HyperLink.debouncedHide(),p?this.PivotIcon.show(p.applied,p.valign,p.zoom):this.PivotIcon.hide(),v?this.PicklistIcon.show(v.picklist,v.valign,v.zoom,v.halign):this.PicklistIcon.hide()}};var A=[r.Layer,l.Layer];k.prototype=n.implement(k,A),d.Layer=k}(this);
!function(e){var o=e.ZSClass,t=o.Layer||(o.Layer={}),r=t.Interface,a=t.Modules,n=a.Main,s=a.Focus,i=(a.Resize,a.Move,t.MouseFollower),u=i.Layer;function c(e,o,t){n.Router.call(this,e,u,o,t)}c.prototype={onPlace:function(e,o,t,r,a,n,s,i,u,c,l,p,y,R,f){var h=this.get(e),v=this.pane.getZoom();h.onPlace(o*v+(v-1),t*v+(v-1),r*v-(v-2),a*v-(v-2),v,l,p,n,s,i,u,c,y*v+(v-1),R,f)}};var l=[n.Router,s.Router];c.prototype=r.implement(c,l),i.Router=c}(this);
!function(e){var t=e.ZSClass,i=t.Layer||(t.Layer={}),o=i.Interface,n=i.MouseFollower,r=i.Modules,l=r.Main,g=r.Focus,a=r.Resize,s=r.Move;function c(){l.ViewControl.call(this)}c.prototype={onPlace:function(e,t){for(var i in this.Views){this.Views[i].onPlace(e,t.getX(),t.getY(),t.getWidth(),t.getHeight(),t.getCheckBox(),t.getFilter(),t.getVersionEdit(),t.getHyperLink(),t.getPivotHeader(),t.getVerticalPadding(),t.getHorizontalPadding(),t.getNextY(),t.getRange(),t.getPicklist())}}};var V=[l.ViewControl,g.ViewControl,a.ViewControl,s.ViewControl];c.prototype=o.implement(c,V),n.ViewControl=c}(this);
!function(t){t.sPlusPlus;var o=t.ZSClass,e=o.Layer||(o.Layer={}),l=e.Interface,r=e.Modules.Main,a=e.MouseFollower;function s(){r.StateControl.call(this)}s.prototype={};var n=[r.StateControl];s.prototype=l.implement(s,n),a.StateControl=s}(this);
!function(o){var t=o.ZSClass,e=(o.sPlusPlus,t.Layer||(t.Layer={})),r=e.Interface,l=e.Modules.Main,s=e.MouseFollower;function n(){l.NetworkControl.call(this)}n.prototype={};var a=[l.NetworkControl];n.prototype=r.implement(n,a),s.NetworkControl=n}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.MouseFollower,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,p=n.ViewControl,w=n.Interacter,d=n.Router;function f(){i.Controller.call(this,u,v,p)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new w(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new d(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var i=e.ZSClass,l=(e.sPlusPlus,i.Layer||(i.Layer={})),t=l.Interface,o=l.Modules,n=o.Main,r=o.Focus,s=(o.Resize,o.Move,l.RangeSelection||(l.RangeSelection={})),a=s.Model,c=i.UILayer;function h(e,i,l,t){n.Layer.call(this,e,i,l,t),c.call(this,this.Dom,a)}h.prototype={onShowFiller:function(){this.filler.show()},onHideFiller:function(){this.filler.hide()}};var u=[n.Layer,r.Layer];h.prototype=t.implement(h,u),s.Layer=h}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),i=o.Interface,n=o.Modules,r=n.Main,l=n.Focus,s=(n.Resize,n.Move,o.RangeSelection),u=s.Layer;function a(e,t,o){r.Router.call(this,e,u,t,o)}a.prototype={onShowFiller:function(e){this.get(e).onShowFiller()},onHideFiller:function(e){this.get(e).onHideFiller()}};var c=[r.Router,l.Router];a.prototype=i.implement(a,c),s.Router=a}(this);
!function(o){var e=o.ZSClass,i=e.Layer||(e.Layer={}),t=i.Interface,l=i.RangeSelection,n=i.Modules,r=n.Main,s=n.Focus,a=n.Resize,c=n.Move;function w(){r.ViewControl.call(this)}w.prototype={onPlace:function(o,e){for(var i in r.ViewControl.prototype.onPlace.call(this,o,e),this.Views){var t=this.Views[i];e.isFilled()?t.onShowFiller(o):t.onHideFiller(o)}}};var V=[r.ViewControl,s.ViewControl,a.ViewControl,c.ViewControl];w.prototype=t.implement(w,V),l.ViewControl=w}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,n=o.Modules.Main,l=o.RangeSelection;function r(){n.StateControl.call(this)}r.prototype={};var s=[n.StateControl];r.prototype=a.implement(r,s),l.StateControl=r}(this);
!function(t){var o=t.ZSClass,e=(t.sPlusPlus,o.Layer||(o.Layer={})),r=e.Interface,n=e.Modules.Main,l=e.RangeSelection;function s(){n.NetworkControl.call(this)}s.prototype={};var a=[n.NetworkControl];s.prototype=r.implement(s,a),l.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.RangeSelection,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,p=n.ViewControl,d=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,p)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new d(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var t=e.ZSClass,a=(e.sPlusPlus,t.Layer||(t.Layer={})),s=a.Interface,o=a.Modules,r=o.Main,i=o.Focus,l=(o.Resize,o.Move,a.Selection||(a.Selection={})),c=l.Model,n=t.UILayer;function y(e,t,a,s){r.Layer.call(this,e,t,a,s),n.call(this,this.Dom,c)}y.prototype={};var u=[r.Layer,i.Layer];y.prototype=s.implement(y,u),l.Layer=y}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),r=o.Interface,a=o.Modules,i=a.Main,s=a.Focus,u=(a.Resize,a.Move,o.Selection),n=u.Layer;function c(e,t,o){i.Router.call(this,e,n,t,o)}c.prototype={};var l=[i.Router,s.Router];c.prototype=r.implement(c,l),u.Router=c}(this);
!function(o){var e=o.ZSClass,t=e.Layer||(e.Layer={}),i=t.Interface,n=t.Selection,r=t.Modules,l=r.Main,s=r.Focus,a=r.Resize,c=r.Move;function C(){l.ViewControl.call(this)}C.prototype={};var w=[l.ViewControl,s.ViewControl,a.ViewControl,c.ViewControl];C.prototype=i.implement(C,w),n.ViewControl=C}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,l=o.Modules.Main,n=o.Selection;function r(){l.StateControl.call(this)}r.prototype={};var s=[l.StateControl];r.prototype=a.implement(r,s),n.StateControl=r}(this);
!function(t){var o=t.ZSClass,e=(t.sPlusPlus,o.Layer||(o.Layer={})),r=e.Interface,l=e.Modules.Main,n=e.Selection;function s(){l.NetworkControl.call(this)}s.prototype={};var a=[l.NetworkControl];s.prototype=r.implement(s,a),n.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.Selection,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,p=n.ViewControl,d=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,p)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new d(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var i=e.ZSClass,l=(e.sPlusPlus,i.Layer||(i.Layer={})),s=l.Interface,t=l.Modules,r=t.Main,a=t.Focus,o=(t.Resize,t.Move,l.FillSeriesSelectionCue||(l.FillSeriesSelectionCue={})),c=o.Model,n=i.UILayer;function u(e,i,l,s){r.Layer.call(this,e,i,l,s),n.call(this,this.Dom,c)}u.prototype={};var y=[r.Layer,a.Layer];u.prototype=s.implement(u,y),o.Layer=u}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),r=o.Interface,i=o.Modules,s=i.Main,u=i.Focus,a=(i.Resize,i.Move,o.FillSeriesSelectionCue),l=a.Layer;function n(e,t,o){s.Router.call(this,e,l,t,o)}n.prototype={};var c=[s.Router,u.Router];n.prototype=r.implement(n,c),a.Router=n}(this);
!function(e){var o=e.ZSClass,t=o.Layer||(o.Layer={}),i=t.Interface,r=t.FillSeriesSelectionCue,l=t.Modules,n=l.Main,s=l.Focus,a=l.Resize,C=l.Move;function c(){n.ViewControl.call(this)}c.prototype={};var u=[n.ViewControl,s.ViewControl,a.ViewControl,C.ViewControl];c.prototype=i.implement(c,u),r.ViewControl=c}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),l=o.Interface,r=o.Modules.Main,a=o.FillSeriesSelectionCue;function n(){r.StateControl.call(this)}n.prototype={};var s=[r.StateControl];n.prototype=l.implement(n,s),a.StateControl=n}(this);
!function(o){var t=o.ZSClass,e=(o.sPlusPlus,t.Layer||(t.Layer={})),r=e.Interface,n=e.Modules.Main,l=e.FillSeriesSelectionCue;function i(){n.NetworkControl.call(this)}i.prototype={onHideFrom:function(){}};var s=[n.NetworkControl];i.prototype=r.implement(i,s),l.NetworkControl=i}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.FillSeriesSelectionCue,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,p=n.ViewControl,d=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,p)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new d(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var o=e.ZSClass,i=(e.sPlusPlus,o.Layer||(o.Layer={})),n=i.Interface,t=i.Modules,r=t.Main,l=t.Focus,s=(t.Resize,t.Move,i.RangePicker||(i.RangePicker={})),a=s.Model,c=o.UILayer;function h(e,o,i,n){r.Layer.call(this,e,o,i,n),c.call(this,this.Dom,a)}h.prototype={onSetColor:function(e){this.Dom.style.color=e},onBringForward:function(){this.Dom.style.zIndex=1},onSendBackward:function(){this.Dom.style.zIndex=""},onShowFiller:function(){this.filler.show()},onHideFiller:function(){this.filler.hide()}};var u=[r.Layer,l.Layer];h.prototype=n.implement(h,u),s.Layer=h}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),i=o.Interface,r=o.Modules,n=r.Main,s=r.Focus,a=(r.Resize,r.Move,o.RangePicker),l=a.Layer;a.Model;function c(e,t,o){n.Router.call(this,e,l,t,o),this.Active=[]}c.prototype={setColor:function(e,t){this.get(e).onSetColor(t)},bringForward:function(e){this.get(e).onBringForward()},sendBackward:function(e){this.get(e).onSendBackward()},showFiller:function(e){this.get(e).onShowFiller()},hideFiller:function(e){this.get(e).onHideFiller()}};var u=[n.Router,s.Router];c.prototype=i.implement(c,u),a.Router=c}(this);
!function(e){var o=e.ZSClass,t=o.Layer||(o.Layer={}),i=t.Interface,r=t.RangePicker,l=t.Modules,n=l.Main,a=l.Focus,s=l.Resize,c=l.Move;function w(){n.ViewControl.call(this)}w.prototype={onPlace:function(e,o){for(var t in n.ViewControl.prototype.onPlace.call(this,e,o),this.Views){var i=this.Views[t],r=o.getColor();i.onPlace(e,o.getX(),o.getY(),o.getWidth(),o.getHeight()),i.setColor(e,r),o.isActive()?(i.bringForward(e),i.showFiller(e)):(i.sendBackward(e),i.hideFiller(e))}}};var C=[n.ViewControl,a.ViewControl,s.ViewControl,c.ViewControl];w.prototype=i.implement(w,C),r.ViewControl=w}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,r=o.Modules.Main,n=o.RangePicker;function l(){r.StateControl.call(this)}l.prototype={};var s=[r.StateControl];l.prototype=a.implement(l,s),n.StateControl=l}(this);
!function(t){var o=t.ZSClass,e=(t.sPlusPlus,o.Layer||(o.Layer={})),r=e.Interface,n=e.Modules.Main,l=e.RangePicker;function s(){n.NetworkControl.call(this)}s.prototype={};var a=[n.NetworkControl];s.prototype=r.implement(s,a),l.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.RangePicker,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,p=n.ViewControl,d=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,p)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new d(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var i=e.ZSClass,l=(e.sPlusPlus,i.Layer||(i.Layer={})),s=l.Interface,t=l.Modules,r=t.Main,a=t.Focus,o=(t.Resize,t.Move,l.FillSeriesSelection||(l.FillSeriesSelection={})),c=o.Model,n=i.UILayer;function y(e,i,l,s){r.Layer.call(this,e,i,l,s),n.call(this,this.Dom,c)}y.prototype={};var u=[r.Layer,a.Layer];y.prototype=s.implement(y,u),o.Layer=y}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),r=o.Interface,i=o.Modules,s=i.Main,a=i.Focus,u=(i.Resize,i.Move,o.FillSeriesSelection),l=u.Layer;function n(e,t,o){s.Router.call(this,e,l,t,o)}n.prototype={};var c=[s.Router,a.Router];n.prototype=r.implement(n,c),u.Router=n}(this);
!function(e){var o=e.ZSClass,t=o.Layer||(o.Layer={}),i=t.Interface,r=t.FillSeriesSelection,l=t.Modules,n=l.Main,s=l.Focus,a=l.Resize,c=l.Move;function C(){n.ViewControl.call(this)}C.prototype={};var w=[n.ViewControl,s.ViewControl,a.ViewControl,c.ViewControl];C.prototype=i.implement(C,w),r.ViewControl=C}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),l=o.Interface,r=o.Modules.Main,a=o.FillSeriesSelection;function n(){r.StateControl.call(this)}n.prototype={};var s=[r.StateControl];n.prototype=l.implement(n,s),a.StateControl=n}(this);
!function(t){var e=t.ZSClass,o=(t.sPlusPlus,e.Layer||(e.Layer={})),r=o.Interface,l=o.Modules.Main,n=o.FillSeriesSelection;function s(){l.NetworkControl.call(this)}s.prototype={};var i=[l.NetworkControl];s.prototype=r.implement(s,i),n.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.FillSeriesSelection,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,p=n.ViewControl,d=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,p)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new d(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var t=e.ZSClass,o=(e.sPlusPlus,t.Layer||(t.Layer={})),a=o.Interface,s=o.Modules,r=s.Main,i=s.Focus,l=(s.Resize,s.Move,o.CopySelection||(o.CopySelection={})),y=t.UILayer,c=l.Model;function n(e,t,o,a){r.Layer.call(this,e,t,o,a),y.call(this,this.Dom,c)}n.prototype={};var p=[r.Layer,i.Layer];n.prototype=a.implement(n,p),l.Layer=n}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),r=o.Interface,a=o.Modules,i=a.Main,s=a.Focus,u=(a.Resize,a.Move,o.CopySelection),n=u.Layer;function c(e,t,o){i.Router.call(this,e,n,t,o)}c.prototype={};var l=[i.Router,s.Router];c.prototype=r.implement(c,l),u.Router=c}(this);
!function(o){var e=o.ZSClass,t=e.Layer||(e.Layer={}),i=t.Interface,n=t.CopySelection,r=t.Modules,l=r.Main,s=r.Focus,a=r.Resize,C=r.Move;function c(){l.ViewControl.call(this)}c.prototype={};var p=[l.ViewControl,s.ViewControl,a.ViewControl,C.ViewControl];c.prototype=i.implement(c,p),n.ViewControl=c}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,l=o.Modules.Main,n=o.CopySelection;function r(){l.StateControl.call(this)}r.prototype={};var s=[l.StateControl];r.prototype=a.implement(r,s),n.StateControl=r}(this);
!function(t){var o=t.ZSClass,e=(t.sPlusPlus,o.Layer||(o.Layer={})),r=e.Interface,l=e.Modules.Main,n=e.CopySelection;function s(){l.NetworkControl.call(this)}s.prototype={};var a=[l.NetworkControl];s.prototype=r.implement(s,a),n.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.CopySelection,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,p=n.NetworkControl,v=n.ViewControl,d=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,p,v)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new d(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var a=e.ZSClass,t=(e.sPlusPlus,a.Layer||(a.Layer={})),r=t.Interface,s=t.Modules,o=s.Main,i=s.Focus,l=(s.Resize,s.Move,t.DragSelection||(t.DragSelection={})),c=l.Model,n=a.UILayer;function y(e,a,t,r){o.Layer.call(this,e,a,t,r),n.call(this,this.Dom,c)}y.prototype={};var u=[o.Layer,i.Layer];y.prototype=r.implement(y,u),l.Layer=y}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),r=o.Interface,a=o.Modules,i=a.Main,s=a.Focus,u=(a.Resize,a.Move,o.DragSelection),n=u.Layer;function c(e,t,o){i.Router.call(this,e,n,t,o)}c.prototype={};var l=[i.Router,s.Router];c.prototype=r.implement(c,l),u.Router=c}(this);
!function(o){var e=o.ZSClass,t=e.Layer||(e.Layer={}),i=t.Interface,r=t.DragSelection,n=t.Modules,l=n.Main,a=n.Focus,s=n.Resize,c=n.Move;function C(){l.ViewControl.call(this)}C.prototype={};var w=[l.ViewControl,a.ViewControl,s.ViewControl,c.ViewControl];C.prototype=i.implement(C,w),r.ViewControl=C}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,r=o.Modules.Main,l=o.DragSelection;function n(){r.StateControl.call(this)}n.prototype={};var s=[r.StateControl];n.prototype=a.implement(n,s),l.StateControl=n}(this);
!function(t){var o=t.ZSClass,e=(t.sPlusPlus,o.Layer||(o.Layer={})),r=e.Interface,l=e.Modules.Main,n=e.DragSelection;function s(){l.NetworkControl.call(this)}s.prototype={};var a=[l.NetworkControl];s.prototype=r.implement(s,a),n.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.DragSelection,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,p=n.ViewControl,d=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,p)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new d(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var a=e.ZSClass,r=(e.sPlusPlus,a.Layer||(a.Layer={})),t=r.Interface,s=r.Modules,o=s.Main,i=s.Focus,l=(s.Resize,s.Move,r.HeaderDragSelection||(r.HeaderDragSelection={})),c=l.Model,n=a.UILayer;function y(e,a,r,t){o.Layer.call(this,e,a,r,t),n.call(this,this.Dom,c)}y.prototype={};var u=[o.Layer,i.Layer];y.prototype=t.implement(y,u),l.Layer=y}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,a=r.Modules,i=a.Main,s=a.Focus,u=(a.Resize,a.Move,r.HeaderDragSelection),n=u.Layer;function c(e,t,r){i.Router.call(this,e,n,t,r)}c.prototype={};var l=[i.Router,s.Router];c.prototype=o.implement(c,l),u.Router=c}(this);
!function(o){var e=o.ZSClass,t=e.Layer||(e.Layer={}),n=t.Interface,i=t.HeaderDragSelection,l=t.Modules,r=l.Main,a=l.Focus,c=l.Resize,s=l.Move;function p(){r.ViewControl.call(this)}p.prototype={onPlace:function(o,e){r.ViewControl.prototype.onShow.call(this,o,e),r.ViewControl.prototype.onPlace.call(this,o,e)}};var w=[r.ViewControl,a.ViewControl,c.ViewControl,s.ViewControl];p.prototype=n.implement(p,w),i.ViewControl=p}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,r=o.Modules.Main,l=o.HeaderDragSelection;function n(){r.StateControl.call(this)}n.prototype={};var s=[r.StateControl];n.prototype=a.implement(n,s),l.StateControl=n}(this);
!function(t){var e=t.ZSClass,o=(t.sPlusPlus,e.Layer||(e.Layer={})),r=o.Interface,l=o.Modules.Main,n=o.HeaderDragSelection;function a(){l.NetworkControl.call(this)}a.prototype={};var s=[l.NetworkControl];a.prototype=r.implement(a,s),n.NetworkControl=a}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.HeaderDragSelection,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,d=n.ViewControl,p=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,d)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new p(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var t,o,i,s=e.ZSClass,n=e.sPlusPlus,r=s.Layer||(s.Layer={}),a=r.Interface,c=r.Modules,l=c.Main,h=c.Focus,v=(c.Resize,c.Move,r.Notes||(r.Notes={})),g=s.UICellNote,u=n.data.Defaults.MAX_COL,w=e.ZSEvents,N=w.topic,m=w.Groups,d=w.Names,C=e.JSUtil.Mouse.BindEvents,D={Container:{mousedown:function(e){var o=n.view.getActiveGridID(),i=n.view.getResourceID(o),s=n.view.getVersionID(o),r=n.view.getSheetID(o),a=n.data.getWorkBook(i,s);if(!a.isEditable()||a.ProtectedSheets.isSheetLocked(r))return;t=e,e.stopPropagation(),e.preventDefault(),C.call(this,I,f)}},Editor:{keydown:function(t){var i=e.JSUtil.Key.getKeyCombination(t),s=e.ZSConstants.JSKeyCode;switch(i){case s.SUPER+"+"+s.ENTER:S.call(this);break;case s.ESC+"":var r=n.view.getActiveGridID(),a=n.view.getResourceID(r),c=n.view.getVersionID(r),l=n.view.getSheetID(r),h=n.data.getWorkBook(a,c),v=h.getSheetObj(l),g=this.getID(),w=Math.floor(g/256),N=g%256,g=e.JSUtil.Math.hash(w,N,u),m=v.Notes.get(g);this.Note.Comment.value=m.value,o=!1,this.Note.Comment.blur()}},mousedown:p,dblclick:function(e){e.stopPropagation()},focus:function(e){o=!0,p(e),i=this,N.register(m.Listener,d.Mouse.RangeDown,y)},blur:S},Trash:{click:function(){this.Note.delete()}}};function f(e){var t=n.view.getActiveGridID(),o=n.view.getResourceID(t),i=n.view.getVersionID(t),r=n.view.getSheetID(t),a=(n.view.getSheetState(t,r),this.getID()),c=Math.floor(a/256),l=a%256,h=this.getController(),v=n.view.getGridComponent(t),g=v.getZoom(),u=new s.Layer.Notes.Interacter(v.interacter,o,r,i,c,l,"",this.NoteX/g,this.NoteY/g);h.moveEnd(u)}function I(e){var o=e.clientX-t.clientX,i=e.clientY-t.clientY,r=n.view.getActiveGridID(),a=n.view.getResourceID(r),c=n.view.getVersionID(r),l=n.view.getSheetID(r),h=(n.view.getSheetState(r,l),this.getID()),v=Math.floor(h/256),g=h%256,u=this.getController(),w=n.view.getGridComponent(r),N=w.getZoom();if(w.getFlip())var m=new s.Layer.Notes.Interacter(w.interacter,a,l,c,v,g,"",(this.NoteX-o)/N,(this.NoteY+i)/N);else m=new s.Layer.Notes.Interacter(w.interacter,a,l,c,v,g,"",(this.NoteX+o)/N,(this.NoteY+i)/N);u.move(m),t=e}function p(e){e.stopPropagation();var t=n.view.Events.Key;t.focusContext(t.Entry.CellNote.Context)}function y(){S.call(i),N.unregister(m.Listener,d.Mouse.RangeDown,y)}function S(){o&&this.Note.Comment.blur(),o&&this.Note.update(),o=!1}function L(e,t,o,i){l.Layer.call(this,e,t,o,i),this.Dom.className="Layer CellNoteLayer cellComment",this.Note=new g(this.Dom,D,this,e)}L.prototype={onPlace:function(e,t,o,i,s,n,r){var a=this.isRTL();l.Layer.prototype.onPlace.call(this,e,t,o,i),a?(this.Note.place(s-e,n-t,!1,!1,a),this.Note.setLineCoordinates(s-e-o,t-n)):(this.Note.place(s-e,n-t),this.Note.setLineCoordinates(e+o-s,t-n)),this.NoteX=s,this.NoteY=n,this.Note.show()},onCommentChange:function(e,t,o){this.Note.setComment(e,t,o)}};var E=[l.Layer,h.Layer];L.prototype=a.implement(L,E),v.Layer=L}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),n=o.Interface,a=o.Modules,i=a.Main,s=a.Focus,r=(a.Resize,a.Move,o.Notes),c=r.Layer;r.Model;function u(e,t,o){i.Router.call(this,e,c,t,o)}u.prototype={onPlace:function(e,t,o,n,a,i,s,r){var c=this.get(e),u=this.pane.getZoom();c.onPlace(t*u+(u-1),o*u+(u-1),n*u-(u-2),a*u-(u-2),i*u,s*u,r)},onCommentChange:function(e,t,o,n){this.get(e).onCommentChange(t,o,n)},onMove:function(e,t,o,n,a,i,s,r){this.onPlace.call(this,e,t,o,n,a,i,s,r)}};var l=[i.Router,s.Router];u.prototype=n.implement(u,l),r.Router=u}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),n=o.Interface,i=o.Notes,s=o.Modules,r=s.Main,g=s.Focus,l=s.Resize,a=s.Move;function C(){r.ViewControl.call(this)}C.prototype={onPlace:function(e,t){for(var o in this.Views){this.Views[o].onPlace(e,t.getX(),t.getY(),t.getWidth(),t.getHeight(),t.getNoteX(),t.getNoteY())}},onCommentChange:function(e,t){for(var o in this.Views){this.Views[o].onCommentChange(e,t.getRow(),t.getCol(),t.getComment())}},onMove:function(e,t){for(var o in this.Views){this.Views[o].onMove(e,t.getX(),t.getY(),t.getWidth(),t.getHeight(),t.getNoteX(),t.getNoteY())}},onMoveEnd:function(e,t){},onCellComment:function(){}};var h=[r.ViewControl,g.ViewControl,l.ViewControl,a.ViewControl];C.prototype=n.implement(C,h),i.ViewControl=C}(this);
!function(t){t.sPlusPlus;var n=t.ZSClass,o=n.Layer||(n.Layer={}),e=o.Interface,a=o.Modules.Main,l=o.Notes;function i(){a.StateControl.call(this)}i.prototype={onCommentChange:function(t,n){},onMove:function(t,n){},onMoveEnd:function(t,n){},onCellComment:function(){}};var r=[a.StateControl];i.prototype=e.implement(i,r),l.StateControl=i}(this);
!function(e){var t=e.ZSClass,o=(e.sPlusPlus,t.Layer||(t.Layer={})),n=o.Interface,l=o.Modules.Main,r=o.Notes,i=e.UserAction;function s(){l.NetworkControl.call(this)}s.prototype={onCommentChange:function(e,t){},onMove:function(e,t){},onMoveEnd:function(e,t){i.MoveCellComment(t.getRid(),t.getSheetId(),t.getVersion(),t.getRow(),t.getCol(),t.getNoteX(),t.getNoteY())},onCellComment:function(e,t,o,n){i.CellComment(e.getRid(),[e.getSheetId()],e.getVersion(),t,o,n)}};var C=[l.NetworkControl];s.prototype=n.implement(s,C),r.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),n=o.Interface,r=o.Notes,i=o.Modules,l=i.Main,s=i.Focus,C=i.Resize,a=i.Move,m=i.Clone,v=r.StateControl,c=r.NetworkControl,h=r.ViewControl,u=r.Interacter,w=r.Router;function d(){l.Controller.call(this,v,c,h)}d.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),o=sPP.view.getGridComponent(t);return new u(o.interacter,e)},createView:function(e,t){var o=document.createElement("div");return e.appendChild(o),new w(o,this,t)},setComment:function(e){var t=e.getID();this.State.onCommentChange(t,e),this.Views.onCommentChange(t,e),this.Network.onCommentChange(t,e)},move:function(e){var t=e.getID();this.State.onMove(t,e),this.Views.onMove(t,e),this.Network.onMove(t,e)},moveEnd:function(e){var t=e.getID();this.State.onMoveEnd(t,e),this.Views.onMoveEnd(t,e),this.Network.onMoveEnd(t,e)},CellComment:function(e,t,o,n){this.State.onCellComment(e,t,o,n),this.Views.onCellComment(e,t,o,n),this.Network.onCellComment(e,t,o,n)}};var f=[l.Controller,s.Controller,C.Controller,a.Controller,m.Controller];d.prototype=n.implement(d,f),r.Controller=d}(this);
!function(e){var t=e.ZSClass,a=e.sPlusPlus,o=t.Layer||(t.Layer={}),s=o.Interface,n=o.Modules,i=n.Main,r=n.Focus,l=(n.Resize,n.Move,o.HighlightLocks||(o.HighlightLocks={})),c=l.Model,u=t.UILayer,p=e.ZSConstants.FeatureConstants,L=a.view.Toolbar.Feature[p.MANAGE_LOCK_SETTINGS];function d(e,t,o,s){i.Layer.call(this,e,t,o,s);var n=document.createElement("span");n.className="curPtr",this.Dom.appendChild(n),n.addEventListener("mousedown",function(e){e.stopPropagation()}),n.addEventListener("click",function(e){(L=L||a.view.Toolbar.Feature[p.MANAGE_LOCK_SETTINGS]).openDialog(),e.stopPropagation()}),u.call(this,this.Dom,c)}d.prototype={};var h=[i.Layer,r.Layer];d.prototype=s.implement(d,h),l.Layer=d}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),r=o.Interface,i=o.Modules,s=i.Main,a=i.Focus,u=(i.Resize,i.Move,o.HighlightLocks),c=u.Layer;u.Model;function l(e,t,o){s.Router.call(this,e,c,t,o)}l.prototype={};var n=[s.Router,a.Router];l.prototype=r.implement(l,n),u.Router=l}(this);
!function(o){var e=o.ZSClass,t=e.Layer||(e.Layer={}),i=t.Interface,r=t.HighlightLocks,n=t.Modules,l=n.Main,s=n.Focus,a=n.Resize,c=n.Move;function C(){l.ViewControl.call(this)}C.prototype={};var w=[l.ViewControl,s.ViewControl,a.ViewControl,c.ViewControl];C.prototype=i.implement(C,w),r.ViewControl=C}(this);
!function(t){t.sPlusPlus;var o=t.ZSClass,e=o.Layer||(o.Layer={}),a=e.Interface,l=e.Modules.Main,r=e.HighlightLocks;function s(){l.StateControl.call(this)}s.prototype={};var n=[l.StateControl];s.prototype=a.implement(s,n),r.StateControl=s}(this);
!function(t){var o=t.ZSClass,r=(t.sPlusPlus,o.Layer||(o.Layer={})),e=r.Interface,s=r.Modules.Main,l=r.HighlightLocks;t.UserAction;function n(){s.NetworkControl.call(this)}n.prototype={};var i=[s.NetworkControl];n.prototype=e.implement(n,i),l.NetworkControl=n}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.HighlightLocks,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,p=n.ViewControl,d=n.Interacter,w=n.Router;function h(){i.Controller.call(this,u,v,p)}h.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new d(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var f=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];h.prototype=o.implement(h,f),n.Controller=h}(this);
!function(e){var t=e.ZSClass,s=e.sPlusPlus,o=t.Layer||(t.Layer={}),a=o.Interface,i=o.Modules,r=i.Main,n=i.Focus,l=(i.Resize,i.Move,o.HighlightComments||(o.HighlightComments={})),u=l.Model,c=t.UILayer,m=e.ZSConstants.FeatureConstants;s.view.Toolbar.Feature[m.MANAGE_LOCK_SETTINGS];function h(e,t,s,o){r.Layer.call(this,e,t,s,o),c.call(this,this.Dom,u)}h.prototype={glowContainer:function(){this.Dom.classList.add("glowUser");var e=this;setTimeout(function(){e.Dom.classList.remove("glowUser")},1e3)}};var L=[r.Layer,n.Layer];h.prototype=a.implement(h,L),l.Layer=h}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),r=o.Interface,i=o.Modules,n=i.Main,a=i.Focus,s=(i.Resize,i.Move,o.HighlightComments),u=s.Layer;s.Model;function l(e,t,o){n.Router.call(this,e,u,t,o)}l.prototype={glowContainer:function(e){this.get(e).glowContainer()}};var c=[n.Router,a.Router];l.prototype=r.implement(l,c),s.Router=l}(this);
!function(o){var t=o.ZSClass,e=t.Layer||(t.Layer={}),i=e.Interface,n=e.HighlightComments,r=e.Modules,l=r.Main,s=r.Focus,a=r.Resize,w=r.Move;function C(){l.ViewControl.call(this)}C.prototype={glowContainer:function(o){for(var t in this.Views){this.Views[t].glowContainer(o)}}};var V=[l.ViewControl,s.ViewControl,a.ViewControl,w.ViewControl];C.prototype=i.implement(C,V),n.ViewControl=C}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,l=o.Modules.Main,n=o.HighlightComments;function r(){l.StateControl.call(this)}r.prototype={};var s=[l.StateControl];r.prototype=a.implement(r,s),n.StateControl=r}(this);
!function(t){var o=t.ZSClass,e=(t.sPlusPlus,o.Layer||(o.Layer={})),r=e.Interface,n=e.Modules.Main,s=e.HighlightComments;t.UserAction;function l(){n.NetworkControl.call(this)}l.prototype={};var i=[n.NetworkControl];l.prototype=r.implement(l,i),s.NetworkControl=l}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.HighlightComments,i=r.Modules,l=i.Main,a=i.Focus,C=i.Resize,c=i.Move,s=i.Clone,u=n.StateControl,v=n.NetworkControl,w=n.ViewControl,g=n.Interacter,p=n.Router;function d(){l.Controller.call(this,u,v,w)}d.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new g(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new p(r,this,t)},glowContainer:function(e){var t=e.getID();this.Views.glowContainer(t)}};var h=[l.Controller,a.Controller,C.Controller,c.Controller,s.Controller];d.prototype=o.implement(d,h),n.Controller=d}(this);
!function(e){var a=e.ZSClass,l=(e.sPlusPlus,a.Layer||(a.Layer={})),s=l.Interface,t=l.Modules,r=t.Main,c=t.Focus,o=(t.Resize,t.Move,l.RecalculateFlash||(l.RecalculateFlash={})),i=o.Model,u=a.UILayer;function y(e,a,l,s){r.Layer.call(this,e,a,l,s),u.call(this,this.Dom,i)}y.prototype={};var n=[r.Layer,c.Layer];y.prototype=s.implement(y,n),o.Layer=y}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),r=o.Interface,a=o.Modules,s=a.Main,u=a.Focus,c=(a.Resize,a.Move,o.RecalculateFlash),i=c.Layer;function l(e,t,o){s.Router.call(this,e,i,t,o)}l.prototype={};var n=[s.Router,u.Router];l.prototype=r.implement(l,n),c.Router=l}(this);
!function(e){var o=e.ZSClass,t=o.Layer||(o.Layer={}),i=t.Interface,l=t.RecalculateFlash,r=t.Modules,n=r.Main,a=r.Focus,s=r.Resize,c=r.Move;function C(){n.ViewControl.call(this)}C.prototype={};var u=[n.ViewControl,a.ViewControl,s.ViewControl,c.ViewControl];C.prototype=i.implement(C,u),l.ViewControl=C}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,a=e.Layer||(e.Layer={}),l=a.Interface,o=a.Modules.Main,r=a.RecalculateFlash;function s(){o.StateControl.call(this)}s.prototype={};var n=[o.StateControl];s.prototype=l.implement(s,n),r.StateControl=s}(this);
!function(t){var o=t.ZSClass,e=(t.sPlusPlus,o.Layer||(o.Layer={})),r=e.Interface,l=e.Modules.Main,a=e.RecalculateFlash;function s(){l.NetworkControl.call(this)}s.prototype={};var n=[l.NetworkControl];s.prototype=r.implement(s,n),a.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.RecalculateFlash,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,p=n.ViewControl,d=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,p)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new d(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var h=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,h),n.Controller=f}(this);
!function(t){var e=t.ZSClass,a=t.sPlusPlus,s=e.Layer||(e.Layer={}),i=s.Interface,o=s.Modules,n=o.Main,r=o.Focus,h=(o.Resize,o.Move,s.DataValidation||(s.DataValidation={})),l=h.UIDVHint,c=t.ZSConstants.FeatureConstants;a.view.Toolbar.Feature[c.MANAGE_LOCK_SETTINGS];function y(t,e,a,s){n.Layer.call(this,t,e,a,s),this.Dom.className="Layer",this.hint=new l(this.Dom)}y.prototype={onPlace:function(t,e,a,s,i,o,r,h){n.Layer.prototype.onPlace.call(this,t,e,a,s),this.hint.setContent(i),void 0==h||h?this.hint.hideErrorMessage():this.hint.showErrorMessage()}};var u=[n.Layer,r.Layer];y.prototype=i.implement(y,u),h.Layer=y}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),a=o.Interface,r=o.Modules,i=r.Main,n=r.Focus,s=(r.Resize,r.Move,o.DataValidation),u=s.Layer;s.Model;function c(e,t,o){i.Router.call(this,e,u,t,o)}c.prototype={onPlace:function(e,t,o,a,r,i,n,s,u){var c=this.get(e),l=this.pane.getZoom();c.onPlace(t*l,o*l,a*l,r*l,i,n,s,u)}};var l=[i.Router,n.Router];c.prototype=a.implement(c,l),s.Router=c}(this);
!function(t){var e=t.ZSClass,o=e.Layer||(e.Layer={}),i=o.Interface,n=o.DataValidation,a=o.Modules,l=a.Main,r=a.Focus,s=a.Resize,V=a.Move;function c(){l.ViewControl.call(this)}c.prototype={onPlace:function(t,e){for(var o in this.Views){this.Views[o].onPlace(t,e.getX(),e.getY(),e.getWidth(),e.getHeight(),e.getText(),e.getRow(),e.getCol(),e.isValidContent())}}};var w=[l.ViewControl,r.ViewControl,s.ViewControl,V.ViewControl];c.prototype=i.implement(c,w),n.ViewControl=c}(this);
!function(t){t.sPlusPlus;var a=t.ZSClass,o=a.Layer||(a.Layer={}),e=o.Interface,l=o.Modules.Main,n=o.DataValidation;function r(){l.StateControl.call(this)}r.prototype={};var s=[l.StateControl];r.prototype=e.implement(r,s),n.StateControl=r}(this);
!function(t){var o=t.ZSClass,r=(t.sPlusPlus,o.Layer||(o.Layer={})),e=r.Interface,a=r.Modules.Main,n=r.DataValidation;t.UserAction;function l(){a.NetworkControl.call(this)}l.prototype={};var s=[a.NetworkControl];l.prototype=e.implement(l,s),n.NetworkControl=l}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.DataValidation,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,d=n.ViewControl,p=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,d)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new p(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(a){var t=a.ZSClass,e=(a.sPlusPlus,t.Layer||(t.Layer={})),o=e.Interface,i=e.Modules,s=i.Main,r=i.Focus,l=(i.Resize,i.Move,e.DataValidationButton||(e.DataValidationButton={})),n=l.Model,u=t.UILayer;function y(a,t,e,o){s.Layer.call(this,a,t,e,o),u.call(this,this.Dom,n)}y.prototype={};var c=[s.Layer,r.Layer];y.prototype=o.implement(y,c),l.Layer=y}(this);
!function(t){var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,r=o.Modules,i=r.Main,u=r.Focus,n=(r.Resize,r.Move,o.DataValidationButton),s=n.Layer;function c(t,e,o){i.Router.call(this,t,s,e,o)}c.prototype={};var l=[i.Router,u.Router];c.prototype=a.implement(c,l),n.Router=c}(this);
!function(o){var t=o.ZSClass,e=t.Layer||(t.Layer={}),i=e.Interface,n=e.DataValidationButton,r=e.Modules,a=r.Main,l=r.Focus,s=r.Resize,C=r.Move;function V(){a.ViewControl.call(this)}V.prototype={};var c=[a.ViewControl,l.ViewControl,s.ViewControl,C.ViewControl];V.prototype=i.implement(V,c),n.ViewControl=V}(this);
!function(t){t.sPlusPlus;var a=t.ZSClass,o=a.Layer||(a.Layer={}),e=o.Interface,n=o.Modules.Main,l=o.DataValidationButton;function r(){n.StateControl.call(this)}r.prototype={};var s=[n.StateControl];r.prototype=e.implement(r,s),l.StateControl=r}(this);
!function(t){var o=t.ZSClass,r=(t.sPlusPlus,o.Layer||(o.Layer={})),e=r.Interface,a=r.Modules.Main,n=r.DataValidationButton;function l(){a.NetworkControl.call(this)}l.prototype={};var s=[a.NetworkControl];l.prototype=e.implement(l,s),n.NetworkControl=l}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.DataValidationButton,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,d=n.ViewControl,p=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,d)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new p(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var t=e.ZSClass,a=e.sPlusPlus,s=t.Layer||(t.Layer={}),n=s.Interface,i=s.Modules,o=i.Main,d=i.Focus,c=(i.Resize,i.Move,s.PasteWidget||(s.PasteWidget={})),r=t.UILayer,u=c.Model,m=["source_format","destination_format","SEPARATOR","T2T","ALL","VALUES","FORMATS","FORMULAS","COMMENTS","VALUES_AND_NUMBERFORMATS","FORMULAS_AND_NUMBERFORMATS","ALL_EXCEPT_COMMENTS","ALL_EXCEPT_BORDERS","VALIDATION","FILL_DEFAULT","FILL_COPY","FILL_FORMATS","FILL_EXCEPT_FORMATS"],l=["CopyPasteMatchWithSource","CopyPasteMatchWithDestination","SEPARATOR","TexttoColumns.Title","MenuItem.HomeTab.Paste.All","MenuItem.HomeTab.Paste.Values","MenuItem.HomeTab.Paste.Formats","MenuItem.HomeTab.Paste.Formulas","MenuItem.HomeTab.Paste.Notes","MenuItem.HomeTab.Paste.ValuesAndNumberFormats","MenuItem.HomeTab.Paste.FormulasAndNumberFormats","MenuItem.HomeTab.Paste.AllExceptNotes","MenuItem.HomeTab.Paste.AllExceptBorders","MenuItem.HomeTab.Paste.Validation","FillSeries.Default","FillSeries.CopyCells","FillSeries.FillFormats","FillSeries.FillWithOutFormats"],p={copy:"FILL_COPY",default:"FILL_DEFAULT"},E=document.getElementById("popupmenu"),I=e.UIUtil.Component,T=ZSConstants.FeatureConstants,A=e.ZSConstants.ActionConstants,L=a.view.Toolbar.Feature[T.RECAST],S=a.view.Toolbar.Feature[T.TEXT_TO_COLUMN],h=e.ZSConstants.I18N,R=null,P=-1,b=e.ZSEvents,f=b.topic,M=b.Groups,y=b.Names;function F(e,t,a,s){o.Layer.call(this,e,t,a,s),this.addRecastButton(),this.addRecastOption(),this.Dom.addEventListener("mousedown",function(e){e.stopPropagation(),I.triggerEvent(e,document)}),r.call(this,this.Dom,u)}F.prototype={addRecastButton:function(){var e=document.createElement("div");e.className="pasteWid";var t=document.createElement("div");t.className="shIcon cpWidget",t.setAttribute("data-menu-id","pasteWidgetPopUp"),e.appendChild(t),t.addEventListener("mousedown",function(e){e.stopPropagation(),I.triggerEvent(e,document)}),this.Dom.appendChild(e)},createListHolder:function(){(R=document.createElement("ul")).setAttribute("data-ctype","zmenu"),R.id="pasteWidgetPopUp",R.setAttribute("data-content-type","icon-text");for(var e=0;e<l.length;e++){var t=document.createElement("li");t.id="menuItem"+e,"SEPARATOR"===m[e]?t.setAttribute("data-item-type","separator"):(t.setAttribute("data-item-type","checkbox"),t.setAttribute("data-value",m[e]),t.innerText=h[l[e]]),R.appendChild(t)}E.appendChild(R),this.bindEvents()},addRecastOption:function(){!R&&this.createListHolder()},bindEvents:function(){I.bind(R,"zmenuitemclick",function(e,s){for(var n=document.getElementById(R.id).getElementsByTagName("li"),i=0;i<n.length;i++)"checked"===n[i].getAttribute("checked")&&I.zmenu("#"+R.id,"setMenuItemsAttribute",["#"+n[i].id],"checked",!1);I.zmenu("#"+R.id,"setMenuItemsAttribute",["#"+s.data.id],"checked",!0);var o=a.view.getActiveGridID(),d=a.view.getResourceID(o),c=a.view.getSelectedSheets(o),r=a.view.getVersionID(o);if("menuItem3"===s.data.id){S=S||a.view.Toolbar.Feature[T.TEXT_TO_COLUMN];var u=a.view.getSheetID(o),m=a.data.RecastInfo.aparams.rangeList[0][0],l=new t.Range(m.sr,m.sc,m.er,m.ec);f.publish(M.Selector.BoundUpdate.Range,y.Selection.BOUND_UPDATE.ADD,{RID:d,SHEETID:u,VERSION:r,RANGE:l}),S.openDialog()}else(L=L||a.view.Toolbar.Feature[T.RECAST]).recastAction(d,c,r,e,s)}),R.addEventListener("mousedown",function(e){e.stopPropagation()}),I.bind(R,"zmenubeforeshow",function(e,t){var s=document.getElementById(R.id).getElementsByTagName("li");if(P!==a.data.RecastInfo.actionId){P=a.data.RecastInfo.actionId;for(var n=0;n<s.length;n++)"checked"===s[n].getAttribute("checked")&&I.zmenu("#"+R.id,"setMenuItemsAttribute",["#"+s[n].id],"checked",!1);switch(a.data.RecastInfo.action){case A.SYSTEMCLIP_PASTE:I.zmenu("#"+R.id,"setMenuItemsAttribute",["#menuItem0"],"checked",!0);break;case A.SERVERCLIP_PASTE_RANGE:case A.COPY_PASTE:I.zmenu("#"+R.id,"setMenuItemsAttribute",["#menuItem"+m.indexOf(a.data.RecastInfo.popUpOptionType)],"checked",!0);break;case A.FILLSERIES:I.zmenu("#"+R.id,"setMenuItemsAttribute",["#menuItem"+m.indexOf(p[a.data.RecastInfo.popUpOptionType])],"checked",!0)}}for(n=0;n<s.length;n++)s[n].style.display="none";switch(a.data.RecastInfo.action){case A.SYSTEMCLIP_PASTE:for(n=0;n<2;n++)s[n].style.display="";a.data.RecastInfo.isT2COption&&(s[2].style.display="",s[3].style.display="");break;case A.SERVERCLIP_PASTE_RANGE:case A.COPY_PASTE:for(n=4;n<14;n++)s[n].style.display="";break;case A.FILLSERIES:for(n=14;n<s.length;n++)s[n].style.display=""}})},setDirection:function(e,t){e?this.Dom.classList.add("pasteLeft"):this.Dom.classList.remove("pasteLeft"),t?this.Dom.classList.add("pasteTop"):this.Dom.classList.remove("pasteTop")}};var g=[o.Layer,d.Layer];F.prototype=n.implement(F,g),c.Layer=F}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),i=o.Interface,r=o.Modules,s=r.Main,n=r.Focus,a=(r.Resize,r.Move,o.PasteWidget),u=a.Layer;function c(e,t,o){s.Router.call(this,e,u,t,o)}c.prototype={setDirection:function(e,t,o){this.get(e).setDirection(t,o)}};var l=[s.Router,n.Router];c.prototype=i.implement(c,l),a.Router=c}(this);
!function(o){var e=o.ZSClass,t=e.Layer||(e.Layer={}),i=t.Interface,n=t.PasteWidget,r=t.Modules,s=r.Main,l=r.Focus,a=r.Resize,c=r.Move;function w(){s.ViewControl.call(this)}w.prototype={onPlace:function(o,e){for(var t in s.ViewControl.prototype.onPlace.call(this,o,e),this.Views){this.Views[t].setDirection(o,e.isLeftDirection(),e.isTopDirection())}}};var V=[s.ViewControl,l.ViewControl,a.ViewControl,c.ViewControl];w.prototype=i.implement(w,V),n.ViewControl=w}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,r=o.Modules.Main,s=o.PasteWidget;function l(){r.StateControl.call(this)}l.prototype={};var n=[r.StateControl];l.prototype=a.implement(l,n),s.StateControl=l}(this);
!function(t){var o=t.ZSClass,e=(t.sPlusPlus,o.Layer||(o.Layer={})),r=e.Interface,s=e.Modules.Main,l=e.PasteWidget;function n(){s.NetworkControl.call(this)}n.prototype={};var a=[s.NetworkControl];n.prototype=r.implement(n,a),l.NetworkControl=n}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.PasteWidget,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,d=n.ViewControl,p=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,d)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new p(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var t=e.ZSClass,s=(e.sPlusPlus,t.Layer||(t.Layer={})),i=s.Interface,r=s.Modules,a=r.Main,n=r.Focus,c=(r.Resize,r.Move,s.Precedance||(s.Precedance={})),o=t.UIPrecedance;function l(e,t,s,i){a.Layer.call(this,e,t,s,i),o.call(this,this.Dom)}l.prototype={setLineCoordinates:function(e,t){this.line.setAttribute("x2",e),this.line.setAttribute("y2",t)}};var u=[a.Layer,n.Layer];l.prototype=i.implement(l,u),c.Layer=l}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),r=o.Interface,s=o.Modules,a=s.Main,i=s.Focus,n=(s.Resize,s.Move,o.Precedance),u=n.Layer;function c(e,t,o){a.Router.call(this,e,u,t,o)}c.prototype={setCoordinates:function(e,t,o,r,s){var a=this.get(e),i=this.pane.getZoom();a.setLineCoordinates((r-t)*i,(s-o)*i)}};var p=[a.Router,i.Router];c.prototype=r.implement(c,p),n.Router=c}(this);
!function(e){var o=e.ZSClass,t=o.Layer||(o.Layer={}),i=t.Interface,n=t.Precedance,r=t.Modules,l=r.Main,s=r.Focus,a=r.Resize,c=r.Move;function w(){l.ViewControl.call(this)}w.prototype={onPlace:function(e,o){for(var t in l.ViewControl.prototype.onPlace.call(this,e,o),this.Views){this.Views[t].setCoordinates(e,o.getX(),o.getY(),o.getColX(),o.getRowY())}}};var C=[l.ViewControl,s.ViewControl,a.ViewControl,c.ViewControl];w.prototype=i.implement(w,C),n.ViewControl=w}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,r=o.Modules.Main,n=o.Precedance;function l(){r.StateControl.call(this)}l.prototype={};var s=[r.StateControl];l.prototype=a.implement(l,s),n.StateControl=l}(this);
!function(t){var e=t.ZSClass,o=(t.sPlusPlus,e.Layer||(e.Layer={})),r=o.Interface,n=o.Modules.Main,l=o.Precedance;function s(){n.NetworkControl.call(this)}s.prototype={};var a=[n.NetworkControl];s.prototype=r.implement(s,a),l.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.Precedance,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,d=n.ViewControl,p=n.Interacter,w=n.Router;function f(){i.Controller.call(this,u,v,d)}f.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new p(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var m=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];f.prototype=o.implement(f,m),n.Controller=f}(this);
!function(e){var t=e.ZSClass,o=(e.sPlusPlus,t.Layer||(t.Layer={})),s=o.Interface,a=o.Modules,i=a.Main,l=a.Focus,r=(a.Resize,a.Move,o.RangeHighlight||(o.RangeHighlight={})),n=t.UILayer,y=r.Model;function c(e,t,o,s){i.Layer.call(this,e,t,o,s),n.call(this,this.Dom,y)}c.prototype={setColor:function(e){this.Dom.style.color=e}};var h=[i.Layer,l.Layer];c.prototype=s.implement(c,h),r.Layer=c}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),r=o.Interface,i=o.Modules,s=i.Main,a=i.Focus,n=(i.Resize,i.Move,o.RangeHighlight),u=n.Layer;function l(e,t,o){s.Router.call(this,e,u,t,o)}l.prototype={setColor:function(e,t){this.get(e).setColor(t)}};var c=[s.Router,a.Router];l.prototype=r.implement(l,c),n.Router=l}(this);
!function(o){var e=o.ZSClass,t=e.Layer||(e.Layer={}),i=t.Interface,n=t.RangeHighlight,r=t.Modules,l=r.Main,s=r.Focus,a=r.Resize,c=r.Move;function C(){l.ViewControl.call(this)}C.prototype={onPlace:function(o,e){for(var t in l.ViewControl.prototype.onPlace.call(this,o,e),this.Views){this.Views[t].setColor(o,e.getColor())}}};var w=[l.ViewControl,s.ViewControl,a.ViewControl,c.ViewControl];C.prototype=i.implement(C,w),n.ViewControl=C}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,l=o.Modules.Main,n=o.RangeHighlight;function r(){l.StateControl.call(this)}r.prototype={};var s=[l.StateControl];r.prototype=a.implement(r,s),n.StateControl=r}(this);
!function(t){var o=t.ZSClass,e=(t.sPlusPlus,o.Layer||(o.Layer={})),r=e.Interface,l=e.Modules.Main,n=e.RangeHighlight;function s(){l.NetworkControl.call(this)}s.prototype={};var a=[l.NetworkControl];s.prototype=r.implement(s,a),n.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,r=t.Layer||(t.Layer={}),o=r.Interface,n=r.RangeHighlight,l=r.Modules,i=l.Main,a=l.Focus,c=l.Resize,C=l.Move,s=l.Clone,u=n.StateControl,v=n.NetworkControl,p=n.ViewControl,d=n.Interacter,w=n.Router;function g(){i.Controller.call(this,u,v,p)}g.prototype={getInteracter:function(e){var t=sPP.view.getActiveGridID(),r=sPP.view.getGridComponent(t);return new d(r.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new w(r,this,t)}};var h=[i.Controller,a.Controller,c.Controller,C.Controller,s.Controller];g.prototype=o.implement(g,h),n.Controller=g}(this);
!function(e){var s=e.ZSClass,t=(e.sPlusPlus,s.Layer||(s.Layer={})),o=t.Interface,r=t.Modules,a=r.Main,i=r.Focus,n=(r.Resize,r.Move,t.UserPresence||(t.UserPresence={})),c=n.Model,l=s.UILayer;function d(e,s,t,o){a.Layer.call(this,e,s,t,o),l.call(this,this.Dom,c)}d.prototype={onSetColor:function(e){this.Dom.style.color=e},onSetName:function(e){this.edges.Dom.dataset.name=e},onSetEditStatus:function(e){var s=this.Dom.classList;e?s.add("editUserPresence"):s.remove("editUserPresence")},showName:function(){this.edges.Dom.classList.add("hover")},hideName:function(){this.edges.Dom.classList.remove("hover")}};var m=[a.Layer,i.Layer];d.prototype=o.implement(d,m),n.Layer=d}(this);
!function(t){var e=t.ZSClass,o=e.Layer||(e.Layer={}),s=o.Interface,i=o.Modules,n=i.Main,a=i.Focus,r=(i.Resize,i.Move,o.UserPresence),u=r.Layer;function c(t,e,o){n.Router.call(this,t,u,e,o)}c.prototype={setColor:function(t,e){this.get(t).onSetColor(e)},setName:function(t,e){this.get(t).onSetName(e)},setEditStatus:function(t,e){this.get(t).onSetEditStatus(e)},showName:function(t){this.get(t).showName()},hideName:function(t){this.get(t).hideName()}};var h=[n.Router,a.Router];c.prototype=s.implement(c,h),r.Router=c}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),i=o.Interface,s=o.UserPresence,r=o.Modules,n=r.Main,a=r.Focus,l=r.Resize,w=r.Move;function c(){n.ViewControl.call(this)}c.prototype={onPlace:function(e,t){n.ViewControl.prototype.onPlace.call(this,e,t);var o=t.getColor(),i=t.getName(),s=t.getEditStatus();for(var r in this.Views){var a=this.Views[r];a.setColor(e,o),a.setName(e,i),a.setEditStatus(e,s)}},onMouseOver:function(e,t){for(var o in this.Views){this.Views[o].showName(e)}},onMouseLeave:function(e,t){for(var o in this.Views){this.Views[o].hideName(e)}}};var V=[n.ViewControl,a.ViewControl,l.ViewControl,w.ViewControl];c.prototype=i.implement(c,V),s.ViewControl=c}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),n=o.Interface,r=o.Modules.Main,s=o.UserPresence;function a(){r.StateControl.call(this)}a.prototype={onMouseOver:function(t,e){},onMouseLeave:function(t,e){}};var l=[r.StateControl];a.prototype=n.implement(a,l),s.StateControl=a}(this);
!function(e){var o=e.ZSClass,t=(e.sPlusPlus,o.Layer||(o.Layer={})),n=t.Interface,r=t.Modules.Main,s=t.UserPresence;function l(){r.NetworkControl.call(this)}l.prototype={onMouseOver:function(e,o){},onMouseLeave:function(e,o){}};var u=[r.NetworkControl];l.prototype=n.implement(l,u),s.NetworkControl=l}(this);
!function(e){var t=e.ZSClass,r=e.sPlusPlus,o=t.Layer||(t.Layer={}),n=o.Interface,i=o.UserPresence,s=o.Modules,a=s.Main,l=s.Focus,u=s.Resize,c=s.Move,v=s.Clone,C=i.StateControl,h=i.NetworkControl,w=i.ViewControl,M=i.Interacter,p=i.Router;function d(){a.Controller.call(this,C,h,w)}d.prototype={getInteracter:function(e){var t=r.view.getActiveGridID(),o=r.view.getGridComponent(t);return new M(o.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new p(r,this,t)},mouseOver:function(e){var t=this.getInteracter(e);this.State.onMouseOver(e,t),this.Views.onMouseOver(e,t),this.Network.onMouseOver(e,t)},mouseLeave:function(e){var t=this.getInteracter(e);this.State.onMouseLeave(e,t),this.Views.onMouseLeave(e,t),this.Network.onMouseLeave(e,t)}};var f=[a.Controller,l.Controller,u.Controller,c.Controller,v.Controller];d.prototype=n.implement(d,f),i.Controller=d}(this);
!function(e){var t=e.ZSClass,a=e.sPlusPlus,o=t.Layer||(t.Layer={}),r=o.Interface,l=o.Modules,s=l.Main,i=l.Focus,c=(l.Resize,l.Move,e.ZSConstants.I18N),n=o.PivotPlaceHolder||(o.PivotPlaceHolder={}),p=n.Model,d=t.UILayer,y=e.UserAction;function h(e,t,o,r){s.Layer.call(this,e,t,o,r);var l=y.getTemplate(["placeholder"]).placeholder,i=l.querySelector(".pIArea"),c=a.data.AppRegistry.IMAGEPath+"placeholder.svg";i.src=c,this.Dom.append(l),d.call(this,this.Dom,p)}h.prototype={changeMessage:function(e){this.Dom.querySelector("#divtxt2").innerText="temp"==e?c["Pivot.PlaceHolder.Content.Click"]:c["Pivot.PlaceHolder.Content"]}};var P=[s.Layer,i.Layer];h.prototype=r.implement(h,P),n.Layer=h}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),a=o.Interface,r=o.Modules,s=r.Main,i=r.Focus,n=(r.Resize,r.Move,o.PivotPlaceHolder),c=n.Layer;function u(e,t,o){s.Router.call(this,e,c,t,o)}u.prototype={changeMessage:function(e){this.get(e).changeMessage(e)}};var l=[s.Router,i.Router];u.prototype=a.implement(u,l),n.Router=u}(this);
!function(e){var o=e.ZSClass,t=o.Layer||(o.Layer={}),i=t.Interface,n=t.PivotPlaceHolder,r=t.Modules,l=r.Main,s=r.Focus,a=r.Resize,c=r.Move;function w(){l.ViewControl.call(this)}w.prototype={onPlace:function(e,o){l.ViewControl.prototype.onPlace.call(this,e,o)},onChangeMessage:function(e){for(var o in this.Views){this.Views[o].changeMessage(e)}}};var C=[l.ViewControl,s.ViewControl,a.ViewControl,c.ViewControl];w.prototype=i.implement(w,C),n.ViewControl=w}(this);
!function(t){t.sPlusPlus;var e=t.ZSClass,o=e.Layer||(e.Layer={}),a=o.Interface,l=o.Modules.Main,r=o.PivotPlaceHolder;function n(){l.StateControl.call(this)}n.prototype={};var s=[l.StateControl];n.prototype=a.implement(n,s),r.StateControl=n}(this);
!function(t){var o=t.ZSClass,e=(t.sPlusPlus,o.Layer||(o.Layer={})),r=e.Interface,l=e.Modules.Main,n=e.PivotPlaceHolder;function s(){l.NetworkControl.call(this)}s.prototype={};var a=[l.NetworkControl];s.prototype=r.implement(s,a),n.NetworkControl=s}(this);
!function(e){var t=e.ZSClass,r=e.sPlusPlus,o=t.Layer||(t.Layer={}),n=o.Interface,l=o.PivotPlaceHolder,i=o.Modules,a=i.Main,s=i.Focus,c=i.Resize,C=i.Move,u=i.Clone,v=l.StateControl,d=l.NetworkControl,p=l.ViewControl,w=l.Interacter,g=l.Router;function h(){a.Controller.call(this,v,d,p)}h.prototype={getInteracter:function(e){var t=r.view.getActiveGridID(),o=r.view.getGridComponent(t);return new w(o.interacter,e)},createView:function(e,t){var r=document.createElement("div");return e.appendChild(r),new g(r,this,t)},changeMessage:function(e){this.Views.onChangeMessage(e)}};var f=[a.Controller,s.Controller,c.Controller,C.Controller,u.Controller];h.prototype=n.implement(h,f),l.Controller=h}(this);
!function(t){var e=t.ZSClass,o=(t.sPlusPlus,e.Layer||(e.Layer={})),s=o.Interface,i=o.Modules,n=i.Main,a=i.Focus,r=i.Resize,u=(i.Move,e.UILayer),h=UIUtil.Component,c=o.Button||(o.Button={}),d=c.Model;function l(t,e,o,s){n.Layer.call(this,t,e,o,s),this.Dom.setAttribute("context","MI_BUTTON_CONTEXT"),this.Dom.classList.add("ZsBtnLayer");var i=document.createElement("div");i.className="ZSOleMenu",i.setAttribute("data-menu-id","MI_BUTTON_CONTEXT"),i.addEventListener("mousedown",function(t){t.stopPropagation(),h.triggerEvent(t,document)}),this.button=new c.UIButton(t,this.Dom),this.button.Editor.disable(),this.button.Dom.appendChild(i),this.button.appendTo(this.Dom),u.call(this,this.Dom,d)}l.prototype={onSetLabel:function(t){this.button.onSetLabel(t)},onShowLoader:function(){this.button.showLoader()},onHideLoader:function(){this.button.hideLoader()},onMouseOver:function(){var t=this.Controller.getInteracter(this.ID);this.Dom.classList.add("hover"),t.isScriptAvailable()&&this.Dom.classList.add("hasScript")},onMouseLeave:function(){this.Dom.classList.remove("hover"),this.Dom.classList.remove("hasScript")}};var L=[n.Layer,a.Layer,r.Layer];l.prototype=s.implement(l,L),c.Layer=l}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),n=o.Interface,a=o.Modules,i=a.Main,r=a.Focus,u=a.Resize,s=(a.Move,o.Button),c=s.Layer;function h(e,t,o){i.Router.call(this,e,c,t,o)}h.prototype={setLabel:function(e,t){this.get(e).onSetLabel(t)},onLabelChange:function(e,t){this.get(e).onLabelChange(t)},onShowLoader:function(e){this.get(e).onShowLoader()},onHideLoader:function(e){this.get(e).onHideLoader()},onPlace:function(e,t,o,n,a){this.get(e).onPlace(t,o,n,a)}};var l=[i.Router,r.Router,u.Router];h.prototype=n.implement(h,l),s.Router=h}(this);
!function(e){var t=e.ZSClass,i=t.Layer||(t.Layer={}),o=i.Interface,n=i.Button,s=i.Modules,r=s.Main,a=s.Focus,h=s.Resize,l=s.Move;function w(){r.ViewControl.call(this)}w.prototype={setButtonMeta:function(e){for(var t in this.Views){this.Views[t].setLabel(e.getID(),e.getLabel())}},onLabelChange:function(e,t){for(var i in this.Views){var o=this.Views[i],n=t.getLabel();o.onLabelChange(e,n)}},onShowLoader:function(e){for(var t in this.Views){this.Views[t].onShowLoader(e)}},onHideLoader:function(e){for(var t in this.Views){this.Views[t].onHideLoader(e)}},onPlace:function(e,t){for(var i in this.Views){this.Views[i].onPlace(e,t.getX(),t.getY(),t.getWidth(),t.getHeight())}}};var V=[r.ViewControl,a.ViewControl,h.ViewControl,l.ViewControl];w.prototype=o.implement(w,V),n.ViewControl=w}(this);
!function(t){var o=t.sPlusPlus,e=t.ZSClass,n=e.Layer||(e.Layer={}),s=n.Interface,l=n.Modules.Main,a=n.Button;function r(){l.StateControl.call(this)}r.prototype={setButtonMeta:function(t){},onFocus:function(t){l.StateControl.prototype.onFocus.call(this,t);var e=o.view.Events.Key;e.focusContext(e.Entry.Button.Context),this.selectedButton=t},onBlur:function(t){l.StateControl.prototype.onBlur.call(this,t);var e=o.view.Events.Key,n=e.Stack[e.Stack.length-1];e.focusContext(n),this.selectedButton=""}};var u=[l.StateControl];r.prototype=s.implement(r,u),a.StateControl=r}(this);
!function(t){var e=t.ZSClass,n=(t.sPlusPlus,e.Layer||(e.Layer={})),o=n.Interface,r=n.Modules.Main,c=n.Button;function i(){r.NetworkControl.call(this)}i.prototype={setButtonMeta:function(t){},onResizeEnd:function(t,e,n){e.getNetworkInteracter().resize()},onMoveEnd:function(t,e,n){e.getNetworkInteracter().move()},onExecuteScript:function(t,e){e.getNetworkInteracter().executeScript()},onClone:function(t,e,n){e.getNetworkInteracter().clone()},onAssignMacro:function(t,e,n){e.getNetworkInteracter().assignMacro(n)},onSubmitEdit:function(t,e){e.getNetworkInteracter().setCaption()},onDelete:function(t,e){e.getNetworkInteracter().delete()}};var a=[r.NetworkControl];i.prototype=o.implement(i,a),c.NetworkControl=i}(this);
!function(t){var e=t.sPlusPlus,o=t.ZSClass,n=o.Layer||(o.Layer={}),i=n.Interface,r=n.Button,s=n.Ole,a=n.Modules,c=a.Main,h=a.Focus,u=a.Resize,l=a.Move,d=a.Clone,w=r.StateControl,v=r.NetworkControl,S=r.ViewControl,f=r.Interacter,g=r.Router;function L(t,e){s.Controller.call(this,w,v,S,t,e)}L.prototype={getInteracter:function(t){var o=e.view.getActiveGridID(),n=e.view.getGridComponent(o);return new f(n.interacter,t)},createView:function(t,e){var o=document.createElement("div");return t.appendChild(o),new g(o,this,e)},setButtonMeta:function(t){this.State.setButtonMeta(t),this.Views.setButtonMeta(t),this.Network.setButtonMeta(t)},showLoader:function(t){this.onShowLoader(t)},hideLoader:function(t){this.onHideLoader(t)},setLabel:function(t){var e=this.getInteracter(t);this.onLabelChange(t,e)},assignMacro:function(t,e){var o=this.getInteracter(t);this.onAssignMacro(t,o,e)},placeEdit:function(t){var e=t.getID();t.clone(),this.onPlaceEdit(e,t)},submitEdit:function(t){var e=t.getID();this.onSubmitEdit(e,t),this.onLabelChange(e,t),this.onRemoveEdit(e,t)},removeEdit:function(t){var e=t.getID();this.onRemoveEdit(e,t),this.setButtonMeta(t)},executeScript:function(t){var e=this.getInteracter(t);this.onExecuteScript(t,e)},onPlaceEdit:function(t,o){this.onRemove(t,o);var n=e.view.getGridComponent(sPlusPlus.view.getActiveGridID());r.EditLayer.place(n.fifthPane,o)},onRemoveEdit:function(t,e){this.onPlace(t,e),this.setButtonMeta(e),r.EditLayer.remove()},onSubmitEdit:function(t,e){this.State.onSubmitEdit(t,e),this.Views.onSubmitEdit(t,e),this.Network.onSubmitEdit(t,e)},onExecuteScript:function(t,e){this.State.onExecuteScript(t,e),this.Views.onExecuteScript(t,e),this.Network.onExecuteScript(t,e)},onLabelChange:function(t,e){this.State.onLabelChange(t,e),this.Views.onLabelChange(t,e),this.Network.onLabelChange(t,e)},onAssignMacro:function(t,e,o){this.State.onAssignMacro(t,e,o),this.Views.onAssignMacro(t,e,o),this.Network.onAssignMacro(t,e,o)},onShowLoader:function(t){this.State.onShowLoader(t),this.Views.onShowLoader(t),this.Network.onShowLoader(t)},onHideLoader:function(t){this.State.onHideLoader(t),this.Views.onHideLoader(t),this.Network.onHideLoader(t)}};var C=[c.Controller,h.Controller,u.Controller,l.Controller,d.Controller];L.prototype=i.implement(L,C),r.Controller=L}(this);
!function(e){var t=e.ZSClass,a=(e.sPlusPlus,t.Layer||(t.Layer={})),i=a.Interface,n=a.Modules,s=n.Main,o=n.Focus,r=n.Resize,m=(n.Move,t.UILayer),c=a.Image||(a.Image={}),l=c.Model;function u(e,a,i,n){s.Layer.call(this,e,a,i,n),this.Dom.addEventListener("dblclick",function(e){e.stopPropagation()}),this.Dom.addEventListener("contextmenu",function(e){t.ContextMenu.doRightClick(e,"MI_IMAGE_CONTEXT",this)});var o=document.createElement("div");o.className="ZSOleMenu",o.setAttribute("data-menu-id","MI_IMAGE_CONTEXT"),this.image=new c.UIImage,this.image.Dom.appendChild(o),this.image.appendTo(this.Dom),m.call(this,this.Dom,l)}u.prototype={onURLChange:function(e){this.image.setImageSrc(e)}};var d=[s.Layer,o.Layer,r.Layer];u.prototype=i.implement(u,d),c.Layer=u}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),n=o.Interface,a=o.Modules,r=a.Main,i=a.Focus,u=a.Resize,s=(a.Move,o.Image),c=s.Layer;s.Model;function l(e,t,o){r.Router.call(this,e,c,t,o)}l.prototype={onURLChange:function(e,t){this.get(e).onURLChange(t)},onPlace:function(e,t,o,n,a){this.get(e).onPlace(t,o,n,a)}};var R=[r.Router,i.Router,u.Router];l.prototype=n.implement(l,R),s.Router=l}(this);
!function(e){var t=e.ZSClass,o=t.Layer||(t.Layer={}),i=o.Interface,n=o.Image,r=o.Modules,s=r.Main,a=r.Focus,l=r.Resize,c=r.Move;function h(){s.ViewControl.call(this)}h.prototype={onURLChange:function(e,t){for(var o in this.Views){var i=this.Views[o],n=t.getURL();i.onURLChange(e,n)}},onPlace:function(e,t){for(var o in this.Views){this.Views[o].onPlace(e,t.getX(),t.getY(),t.getWidth(),t.getHeight())}}};var w=[s.ViewControl,a.ViewControl,l.ViewControl,c.ViewControl];h.prototype=i.implement(h,w),n.ViewControl=h}(this);
!function(t){var o=t.sPlusPlus,e=t.ZSClass,n=e.Layer||(e.Layer={}),a=n.Interface,l=n.Modules.Main,r=n.Image;function s(){l.StateControl.call(this)}s.prototype={onFocus:function(t){l.StateControl.prototype.onFocus.call(this,t);var e=o.view.Events.Key;e.focusContext(e.Entry.Ole.Context)},onBlur:function(t){l.StateControl.prototype.onBlur.call(this,t);var e=o.view.Events.Key,n=e.Stack[e.Stack.length-1];e.focusContext(n)}};var c=[l.StateControl];s.prototype=a.implement(s,c),r.StateControl=s}(this);
!function(e){var t=e.ZSClass,n=(e.sPlusPlus,t.Layer||(t.Layer={})),o=n.Interface,r=n.Modules.Main,a=n.Image;function i(){r.NetworkControl.call(this)}i.prototype={setImageMeta:function(e){},onDelete:function(e,t){t.getNetworkInteracter().delete()},onMoveEnd:function(e,t,n){t.getNetworkInteracter().move()},onResizeEnd:function(e,t,n){t.getNetworkInteracter().resize()},onClone:function(e,t,n){t.getNetworkInteracter().clone()},onResizeToOriginal:function(e,t){t.getNetworkInteracter().resizeToOriginal()},onReplaceImage:function(e,t){t.getNetworkInteracter().replace()}};var c=[r.NetworkControl];i.prototype=o.implement(i,c),a.NetworkControl=i}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSClass,o=n.Layer||(n.Layer={}),i=o.Interface,r=o.Image,a=o.Ole,l=o.Modules,s=(a=o.Ole||(o.Ole={}),l.Main),c=l.Focus,g=l.Resize,h=l.Move,C=l.Clone,u=r.StateControl,R=r.NetworkControl,w=r.ViewControl,I=r.Interacter,p=r.Router;function v(e,t){a.Controller.call(this,u,R,w,e,t)}v.prototype={getInteracter:function(e){var n=t.view.getActiveGridID(),o=t.view.getGridComponent(n);return new I(o.interacter,e)},createView:function(e,t){var n=document.createElement("div");return e.appendChild(n),new p(n,this,t)},setImageMeta:function(e){var t=e.getID();this.onURLChange(t,e)},onURLChange:function(e,t){this.State.onURLChange(e,t),this.Views.onURLChange(e,t),this.Network.onURLChange(e,t)},replaceImage:function(e){var t=e.getID();this.State.onReplaceImage(t,e),this.Views.onReplaceImage(t,e),this.Network.onReplaceImage(t,e)},resizeToOriginal:function(e){var t=e.getID();this.onResizeToOriginal(t,e)},onResizeToOriginal:function(e,t){this.State.onResizeToOriginal(e,t),this.Views.onResizeToOriginal(e,t),this.Network.onResizeToOriginal(e,t)}};var m=[s.Controller,c.Controller,g.Controller,h.Controller,C.Controller];v.prototype=i.implement(v,m),r.Controller=v}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,e.Layer||(e.Layer={})),a=i.Interface,o=i.Modules,n=o.Main,r=o.Focus,s=o.Resize,c=(o.Move,e.UILayer),h=i.Chart||(i.Chart={}),l=h.Model,u=t.ZSEvents,d=u.Groups,C=u.Names,f=u.topic,m=(t.window,t.ZSConstants.I18N);function p(t,i,a,o){n.Layer.call(this,t,i,a,o),this.Dom.classList.add("ZSChartLayer"),this.Dom.addEventListener("dblclick",function(t){t.stopPropagation()}),this.Dom.addEventListener("contextmenu",function(t){e.ContextMenu.doRightClick(t,"MI_CHART_CONTEXT",this)});var r=document.createElement("div");r.className="ZSOleMenu",r.setAttribute("data-menu-id","MI_CHART_CONTEXT"),this.chart=new h.UIChartLayer(t),this.chart.appendTo(this.Dom),this.Dom.addEventListener("dblclick",function(t){var i=this.chart.getMode(),a=ZSChart.Manager.SidePanelManager;a&&!a.isPanelOpen()&&i.edit?f.publish(d.UI,C.SidePanel.CHARTS.OPEN,{CHART_ID:this.chart.getID(),RECOMMENDATION:a.RECOMMENDATION,TABEL_DEFINATION:!0}):i.edit||e.ZSAlert(m["Chart.Edit.NotAllowed"],{title:m["Alert.Title.YetToSupport"]}),t.stopPropagation(),t.preventDefault()}.bind(this)),c.call(this,this.Dom,l)}p.prototype={onFocus:function(){this.Dom.classList.add("focus"),this.chart.onFocus()},onBlur:function(){this.Dom.classList.remove("focus"),this.chart.onBlur(),this.setOutlineColor()},setOutlineColor:function(){try{var t=(new ZSChart.Utility.ChartAgent).getChartMeta(this.chart.getID()).getBorderColor();this.Dom.style.outlineColor=t}catch(t){}},addNotification:function(){try{this.chart.addNotification()}catch(t){}},removeNotification:function(){try{this.chart.removeNotification()}catch(t){}},updateNotification:function(t){try{this.chart.updateNotification(t)}catch(t){}}};var N=[n.Layer,r.Layer,s.Layer];p.prototype=a.implement(p,N),h.Layer=p}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,n=t.ZSChart,r=e.Layer||(e.Layer={}),o=r.Interface,a=r.Modules,c=a.Main,s=a.Focus,h=a.Resize,l=(a.Move,r.Chart),I=l.Layer,A=(l.Model,t.ZSEvents),d=A.Groups,C=A.Names,g=A.topic;n=n;function u(t,e,i){c.Router.call(this,t,I,e,i),this.Alive=!0,this.boundary={}}u.prototype={updateBoundaryProps:function(t){var e=t.bound;this.boundary=e,this.Alive=e.startRow!=e.endRow&&e.startCol!=e.endCol},updateBoundary:function(t,e,i){try{var r=(new n.Utility.ChartAgent).getAllMetaOfSheet(t,e,i);g.publish(d.Listener,C.SheetMeta.CHARTS,{RID:t,SHEETID:e,VERSION:i,CHARTS:r})}catch(t){}},onZoom:function(t,e){var r=e.chart,o=e.getWidth(),a=e.getHeight(),c=i.view.getActiveGridID(),s=i.view.getSheetID(c),h=i.view.getSheetState(c,s).getZoom();n.Utility.setSize.fn.call(this,r.getInstance(),a/h,o/h)},onRender:function(t,e,i){var r=this.getLayerByID(t),o=r.chart.getDOM(),a=e.chart,c=a.cloneOf(a.getOptions(),!0),s=a.cloneOf(a.getDetails(),!0),h=a.isActionOwner(),l=e.getRID(),I=e.getSheetID(),A=e.getVersion(),u=[];if(s.co=c,(s=n.Client.Action.addSynchronization(t,s)).wd=e.getWidth(),s.ht=e.getHeight(),u.push(s),c.chart.renderTo=o,n.Client.Action.insertChart(l,I,A,u,void 0,i),!a.isInsertFromZiaPanel()){r.chart.setPanelStatus(!0);var D=n.Manager.SidePanelManager;h&&g.publish(d.UI,C.SidePanel.CHARTS.OPEN,{CHART_ID:r.chart.getID(),RECOMMENDATION:D.RECOMMENDATION,TABEL_DEFINATION:!0}),n.Client.Action.OverrideHighchartEvents(r.chart.getID())}e.isPivotChart()&&this.onAttachFilter(t,e),g.publish(d.Listener,C.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:l,SHEETID:I,VERSION:A}),"ANIMATION_CHART"!==s.type&&(e.isCellExceeded()&&g.publish(d.Listener,C.UserAction.CHARTS.NOTIFICATION.ADD,{RID:l,SHEETID:I,VERSION:A,ID:t}),e.isCellExceeded()&&g.publish(d.Listener,C.UserAction.CHARTS.NOTIFICATION.UPDATE,{RID:l,SHEETID:I,VERSION:A,ID:t,STATUS:"SHOW"}),!e.isCellExceeded()&&g.publish(d.Listener,C.UserAction.CHARTS.NOTIFICATION.REMOVE,{RID:l,SHEETID:I,VERSION:A,ID:t}))},onAttachFilter:function(t,i){try{var n=this.getLayerByID(t),r=i.getRID(),o=i.getVersion(),a=i.getPivotID(),c=e.Pivot.Util.getPivotChartFilterDetails(r,o,a);n.chart.clearFilter(),n.chart.onAttachFilter(c,i)}catch(t){}},onCachedViewAttach:function(t,e,i){var n=this.get(t);if(this.Alive){var r=n.chart.getDOM(),o=e.getInstanceByViewIndex(i);o&&o.container?(r.innerHTML="",r.appendChild(o.container),e.isPivotChart()&&this.onAttachFilter(t,e)):this.onRefresh(t,e)}else n&&n.onRemove()},getLayerByID:function(t){return this.Active[t]},onFocus:function(t){return this.get(t).onFocus(),!0},setPanelStatus:function(t,e){this.get(t).chart.setPanelStatus(e)},onRefresh:function(t,e){var i=this.getLayerByID(t),r=i.chart.getDOM(),o=e.chart,a=o.cloneOf(o.getOptions(),!0),c=o.cloneOf(o.getDetails(),!0),s=e.getRID(),h=e.getSheetID(),l=e.getVersion(),I=[];c.co=a,(c=n.Client.Action.addSynchronization(t,c)).wd=e.getWidth(),c.ht=e.getHeight(),function(t,e){try{t.co.plotOptions.series.animation=e}catch(t){}return t}.call(this,c,!1),I.push(c),a.chart.renderTo=r,n.Client.Action.insertChart(s,h,l,I,!0),n.Client.Action.OverrideHighchartEvents(i.chart.getID()),e.isPivotChart()&&this.onAttachFilter(t,e),"ANIMATION_CHART"!==c.type&&(e.isCellExceeded()&&g.publish(d.Listener,C.UserAction.CHARTS.NOTIFICATION.ADD,{RID:s,SHEETID:h,VERSION:l,ID:t}),e.isCellExceeded()&&g.publish(d.Listener,C.UserAction.CHARTS.NOTIFICATION.UPDATE,{RID:s,SHEETID:h,VERSION:l,ID:t,STATUS:"SHOW"}),!e.isCellExceeded()&&g.publish(d.Listener,C.UserAction.CHARTS.NOTIFICATION.REMOVE,{RID:s,SHEETID:h,VERSION:l,ID:t}))},onLoad:function(t,e){var i=this.getLayerByID(t),r=i.chart.getDOM(),o=e.chart,a=o.cloneOf(o.getOptions(),!0),c=o.cloneOf(o.getDetails(),!0),s=e.getRID(),h=e.getSheetID(),l=e.getVersion(),I=[];c.co=a,(c=n.Client.Action.addSynchronization(t,c)).wd=e.getWidth(),c.ht=e.getHeight(),I.push(c),a.chart.renderTo=r,n.Client.Action.insertChart(s,h,l,I,n.Client.Action.getChartState(o.getID())),n.Client.Action.setChartState(o.getID()),n.Client.Action.OverrideHighchartEvents(i.chart.getID()),e.isPivotChart()&&this.onAttachFilter(t,e),"ANIMATION_CHART"!==c.type&&(e.isCellExceeded()&&g.publish(d.Listener,C.UserAction.CHARTS.NOTIFICATION.ADD,{RID:s,SHEETID:h,VERSION:l,ID:t}),e.isCellExceeded()&&g.publish(d.Listener,C.UserAction.CHARTS.NOTIFICATION.UPDATE,{RID:s,SHEETID:h,VERSION:l,ID:t,STATUS:"SHOW"}),!e.isCellExceeded()&&g.publish(d.Listener,C.UserAction.CHARTS.NOTIFICATION.REMOVE,{RID:s,SHEETID:h,VERSION:l,ID:t}))},onPlace:function(t,e,i,n,r){var o=this.get(t);o.chart.ID=t,o.chart.element.id=t,this.Alive&&o.onPlace(e,i,n,r),this.Alive&&o.setOutlineColor(),function(t,e){var i=this.Controller.getInteracter(e);t.chart.getMode();i.isReadOnlyChart()?t.chart.setMode(!0):t.chart.setMode(!1)}.call(this,o,t)},onBlur:function(t){this.get(t).onBlur()},placeNotification:function(t){var e=this.get(t);this.Alive&&e.addNotification()},removeNotification:function(t){var e=this.get(t);this.Alive&&e.removeNotification()},updateNotification:function(t,e){var i=this.Controller.getInteracter(t).isCellExceeded()&&"SHOW"==e,n=this.get(t);this.Alive&&n.updateNotification(i?1:0)},onCopy:function(t,e){(new n.Controller.ZSCController).saveChartAsImage(t,function(t){var e=document.createElement("img");e.src=t,e.setAttribute("source",i.data.AppRegistry.COPY_SOURCE+" "+i.data.AppRegistry.COPY_CHART_SOURCE);var n=document.querySelector("#copyEditor");n.innerHTML="",n.appendChild(e),function(t){var e=document.createRange();e.selectNodeContents(t);var i=window.getSelection();i.removeAllRanges(),i.addRange(e)}(n),document.execCommand("copy"),this.Interactor.getNetworkInteracter().doServerCopy()}.bind({ID:t,Interactor:e}))},onRemove:function(t){this.get(t).onRemove(),delete this.Active[t]}};var D=[c.Router,s.Router,h.Router];u.prototype=o.implement(u,D),l.Router=u}(this);
!function(i){var t=i.ZSClass,e=t.Layer||(t.Layer={}),n=e.Interface,o=e.Chart,a=e.Modules,r=a.Main,s=a.Focus,h=a.Resize,c=a.Move;function l(){r.ViewControl.call(this)}l.prototype={onZoom:function(i,t){for(var e in this.Views){var n=this.Views[e];n.Alive&&n.onZoom(i,t)}},onRender:function(i,t){for(var e in this.Views){var n=this.Views[e];n.Alive&&n.onRender(i,t,e)}},onCachedViewAttach:function(i,t){for(var e in this.Views){this.Views[e].onCachedViewAttach(i,t,e)}},onRefresh:function(i,t){for(var e in this.Views){var n=this.Views[e];n.Alive&&n.onRefresh(i,t)}},onLoad:function(i,t){for(var e in this.Views){var n=this.Views[e];n.Alive&&n.onLoad(i,t)}},updateBoundary:function(i,t,e){try{var n=(new ZSChart.Utility.ChartAgent).getAllChartID(i,t,e);n.length>=1&&Topic.publish(G.Listener,Names.SheetAction.CHARTS.UPDTATE_BOUNDARY,{RID:i,SHEETID:t,VERSION:e,CHARTS:n})}catch(i){}},onUpdatePanelStatus:function(i,t){for(var e in this.Views){this.Views[e].setPanelStatus(i,t)}},onPlace:function(i,t){for(var e in this.Views){this.Views[e].onPlace(i,t.getX(),t.getY(),t.getWidth(),t.getHeight())}},onCopy:function(i,t){for(var e in this.Views){var n=this.Views[e];if(n.Alive){n.onCopy(i,t);break}}},placeNotification:function(i){for(var t in this.Views){var e=this.Views[t];e.Alive&&e.placeNotification(i)}},removeNotification:function(i){for(var t in this.Views){var e=this.Views[t];e.Alive&&e.removeNotification(i)}},updateNotification:function(i,t){for(var e in this.Views){var n=this.Views[e];n.Alive&&n.updateNotification(i,t)}},OnColumnResize:function(i,t,e,n){try{var o=(new ZSChart.Utility.ChartAgent).getAllChartByColumnBoundary(i,t,e,n);Topic.publish(G.Listener,Names.SheetAction.CHARTS.MOVE,{RID:i,SHEETID:t,VERSION:e,CHARTS:o,AOWNER:!1})}catch(i){}},OnRowResize:function(i,t,e,n){try{var o=(new ZSChart.Utility.ChartAgent).getAllChartByRowBoundary(i,t,e,n);Topic.publish(G.Listener,Names.SheetAction.CHARTS.MOVE,{RID:i,SHEETID:t,VERSION:e,CHARTS:o,AOWNER:!1})}catch(i){}}};var f=[r.ViewControl,s.ViewControl,h.ViewControl,c.ViewControl];l.prototype=n.implement(l,f),o.ViewControl=l}(this);
!function(t){var o=t.sPlusPlus,n=t.ZSClass,e=n.Layer||(n.Layer={}),i=e.Interface,a=e.Modules.Main,c=e.Chart;function l(){a.StateControl.call(this)}l.prototype={onFocus:function(t){a.StateControl.prototype.onFocus.call(this,t);var n=o.view.Events.Key;n.focusContext(n.Entry.Ole.Context)},onBlur:function(t){a.StateControl.prototype.onBlur.call(this,t);var n=o.view.Events.Key,e=n.Stack[n.Stack.length-1];n.focusContext(e)},placeNotification:function(){},removeNotification:function(){},updateNotification:function(){},OnColumnResize:function(){},OnRowResize:function(){}};var r=[a.StateControl];l.prototype=i.implement(l,r),c.StateControl=l}(this);
!function(t){var e=t.ZSClass,o=(t.sPlusPlus,e.Layer||(e.Layer={})),n=o.Interface,i=o.Modules.Main,r=o.Chart;function c(){i.NetworkControl.call(this)}c.prototype={onResizeEnd:function(t,e,o){e.getNetworkInteracter().resize()},onMoveEnd:function(t,e,o){e.getNetworkInteracter().move()},onDelete:function(t,e){e.getNetworkInteracter().delete()},placeNotification:function(){},removeNotification:function(){},updateNotification:function(){},OnColumnResize:function(){},OnRowResize:function(){}};var a=[i.NetworkControl];c.prototype=n.implement(c,a),r.NetworkControl=c}(this);
!function(t){var e=t.sPlusPlus,o=t.ZSClass,i=o.Layer||(o.Layer={}),n=i.Interface,a=i.Chart,r=i.Ole,s=i.Modules,h=(r=i.Ole||(i.Ole={}),s.Main),c=s.Focus,u=s.Resize,l=s.Move,w=s.Clone,d=a.StateControl,f=a.NetworkControl,p=a.ViewControl,C=a.Interacter,N=a.Router;function v(t,e){r.Controller.call(this,d,f,p,t,e)}v.prototype={getInteracter:function(t){var o=e.view.getActiveGridID(),i=e.view.getGridComponent(o);return new C(i.interacter,t)},createView:function(t,e){var o=document.createElement("div");return t.appendChild(o),new N(o,this,e)},Render:function(t){var e=t.getID();this.State.onRender(e,t),this.Views.onRender(e,t),this.Network.onRender(e,t)},onCopy:function(){var t=this.getActive();for(var e in t){var o=new C(this.interacter,e);this.State.onCopy(e,o),this.Views.onCopy(e,o),this.Network.onCopy(e,o)}},Refresh:function(t){var e=t.getID();this.State.onRefresh(e,t),this.Views.onRefresh(e,t),this.Network.onRefresh(e,t)},onCachedViewAttach:function(t,e){this.State.onCachedViewAttach(t,e),this.Views.onCachedViewAttach(t,e),this.Network.onCachedViewAttach(t,e)},Load:function(t){var e=t.getID();this.State.onLoad(e,t),this.Views.onLoad(e,t),this.Network.onLoad(e,t)},updateBoundary:function(t,e,o){this.State.updateBoundary(t,e,o),this.Views.updateBoundary(t,e,o),this.Network.updateBoundary(t,e,o)},Zoom:function(t){var e=t.getID();this.State.onZoom(e,t),this.Views.onZoom(e,t),this.Network.onZoom(e,t)},updatePanelStatus:function(t){var e=t.getID(),o=t.getSidePanelStatus();this.State.onUpdatePanelStatus(e,o),this.Views.onUpdatePanelStatus(e,o),this.Network.onUpdatePanelStatus(e,o)},placeNotification:function(t){this.State.placeNotification(t),this.Views.placeNotification(t),this.Network.placeNotification(t)},removeNotification:function(t){this.State.removeNotification(t),this.Views.removeNotification(t),this.Network.removeNotification(t)},updateNotification:function(t,e){this.State.updateNotification(t,e),this.Views.updateNotification(t,e),this.Network.updateNotification(t,e)},OnColumnResize:function(t,e,o,i){this.State.OnColumnResize(t,e,o,i),this.Views.OnColumnResize(t,e,o,i),this.Network.OnColumnResize(t,e,o,i)},OnRowResize:function(t,e,o,i){this.State.OnRowResize(t,e,o,i),this.Views.OnRowResize(t,e,o,i),this.Network.OnRowResize(t,e,o,i)}};var R=[h.Controller,c.Controller,u.Controller,l.Controller,w.Controller];v.prototype=n.implement(v,R),a.Controller=v}(this);
!function(e){var t,i=e.sPlusPlus,s=e.Listener||(e.Listener={}),r=s.Pane||(s.Pane={}),n=e.JSUtil.Mouse.BindEvents,o=e.ZSEvents,a=o.topic,I=o.Groups,l=o.Names,D={mousedown:function(t,s,r,o,D,R,d){var h=i.view.getGridComponent(s),C={gridID:s,This:this,rID:r,sheetID:o,version:D},c=i.view.CellEditor;if(c&&c.getEditStatus()&&!ZSClass.RangePicker.isSelection()&&a.publish(I.Gesture.Selector.CellEdit,l.GESTURE.ACTION.ENUMERATE,{RID:r,SHEETID:o,VERSION:D,isSubmittable:1}),t.shiftKey)return u.call(C,t);var g=0;(t.metaKey||t.ctrlKey&&-1==e.navigator.platform.toUpperCase().indexOf("MAC"))&&(g=1);var S={RID:r,SHEETID:o,VERSION:D,ROWY:d,COLX:R,ACTIVEX:R,ACTIVEY:d,metaKey:t.metaKey,ACCUMULATE:g,GRID_ID:s};a.publish(I.Listener,l.Mouse.RangeDown,S),a.publish(I.Listener,l.Mouse.ScrollOut,{GRIDID:s,CALLBACK:E}),n.call(C,v,u,!0),h.refreshHeaders()},mouseover:function(){t=this}};function v(e){var s=i.view.getActiveGridID(),r=i.view.getGridComponent(s).translateCoordinates(e),n=t.getRelativeCoordinates(r.x,r.y);E(this.gridID,this.rID,this.sheetID,this.version,n.x,n.y)}function E(e,t,s,r,n,o){e=i.view.getActiveGridID();var D=i.view.getGridComponent(e);a.publish(I.Listener,l.Mouse.RangeMove,{RID:t,SHEETID:s,VERSION:r,RANGEID:0,ROWY:o,COLX:n}),D.refreshHeaders()}function u(e){var s=i.view.getActiveGridID(),r=i.view.getGridComponent(s).translateCoordinates(e),n=t.getRelativeCoordinates(r.x,r.y),o={RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID:0,ROWY:n.y,COLX:n.x,GRID_ID:this.gridID};a.publish(I.Listener,l.Mouse.RangeEnd,o)}r.Selection=D}(this);
!function(t){t.sPlusPlus;var e=ZSClass.Layer.Interface,r=t.ZSGrid||(t.ZSGrid={}),n=r.Cell,i={CLASSIC:0,COZY:2,COMFORT:4},o={CLASSIC:2,COZY:4,COMFORT:6},s={CLASSIC:0,COZY:3,COMFORT:7};function u(){switch(ZSClass.Padding.getRowPadding()){case s.CLASSIC:return i.CLASSIC;case s.COZY:return i.COZY;case s.COMFORT:return i.COMFORT;default:return i.CLASSIC}}function C(){switch(ZSClass.Padding.getColPadding()){case s.CLASSIC:return o.CLASSIC;case s.COZY:return o.COZY;case s.COMFORT:return o.COMFORT;default:return o.CLASSIC}}function d(t,e,r,i,o,s,u,C,d,a){n.call(this,t,e,r,i,o,s,u,C,d,a)}d.prototype={getPaddingLeft:function(){return C()},getPaddingRight:function(){return C()},getPaddingTop:function(){return u()},getPaddingBottom:function(){return u()}},d.prototype=e.implement(d,[n]),r.Cell=d;var a=[1,"dashed","#D5D5D5"];function c(t){n.call(this,-1,0,0,a,a,a,a,"transparent",0,null),this.interacter=t}c.prototype={getBorderBottom:function(){return this.interacter.isHideGrid()?null:this.borderBottom},getBorderRight:function(){return this.interacter.isHideGrid()?null:this.borderRight},getBorderTop:function(){return this.interacter.isHideGrid()?null:this.borderTop},getBorderLeft:function(){return this.interacter.isHideGrid()?null:this.borderLeft}},c.prototype=Object.assign({},n.prototype,c.prototype),r.EmptyCell=c}(this);
!function(e){e.ZSGrid;var t=e.ZSGrid.UIPaneManager,s=t.Axles.XAxle,i=t.Axles.YAxle,h=t.Rect;function n(e,t,s,i){var n=new h(t,s),l=new ZSClass.UICanvas(e,n);return new ZSClass.UISheetPane(n,l,i)}function l(t,s,i,n){var l=new h(s,i),r=new ZSClass.UICanvas(t,l);return new e.ZSGrid.UIColumnPane(l,r,n)}function r(t,s,i,n){var l=new h(s,i),r=new ZSClass.UICanvas(t,l);return new e.ZSGrid.UIRowPane(l,r,n)}function a(t,s,i,n){var l=new h(s,i),r=new ZSClass.UICanvas(t,l);return new e.ZSGrid.UIVerticalScrollPane(l,r,n)}function x(t,s,i,n){var l=new h(s,i),r=new ZSClass.UICanvas(t,l);return new e.ZSGrid.UIHorizontalScrollPane(l,r,n)}function o(t,s,i){var n=new h(t,s);return new e.ZSGrid.UIDummyPane(n,i)}function A(A,c,d){t.call(this,A,c,d);var C=this.canvas.getContext("2d");this.xAxles=[new s(0,40),new s(0,0),new s(0,0),new s(0,15)],this.yAxles=[new i(0,23),new i(0,0),new i(0,0),new i(0,15)],this.pane0=n(C,this.xAxles[2],this.yAxles[2],d),this.pane1=n(C,this.xAxles[1],this.yAxles[1],d),this.pane2=n(C,this.xAxles[2],this.yAxles[1],d),this.pane3=n(C,this.xAxles[1],this.yAxles[2],d),this.col0=l(C,this.xAxles[2],this.yAxles[0],d),this.col1=l(C,this.xAxles[1],this.yAxles[0],d),this.row0=r(C,this.xAxles[0],this.yAxles[2],d),this.row1=r(C,this.xAxles[0],this.yAxles[1],d),this.vScroll0=a(C,this.xAxles[3],this.yAxles[2],d),this.vScroll1=a(C,this.xAxles[3],this.yAxles[1],d),this.hScroll0=x(C,this.xAxles[2],this.yAxles[3],d),this.hScroll1=x(C,this.xAxles[1],this.yAxles[3],d),this.dummy0=o(this.xAxles[0],this.yAxles[3],d),this.dummy1=o(this.xAxles[3],this.yAxles[0],d),this.selectAll=function(t,s,i){var n=new h(t,s);return new e.ZSGrid.UISelectAllPane(n,i)}(this.xAxles[0],this.yAxles[0],d),this.insertPane(0,0,this.selectAll),this.insertPane(0,1,this.col1),this.insertPane(0,2,this.col0),this.insertPane(0,3,this.dummy1),this.insertPane(1,0,this.row1),this.insertPane(1,1,this.pane1),this.insertPane(1,2,this.pane2),this.insertPane(1,3,this.vScroll1),this.insertPane(2,0,this.row0),this.insertPane(2,1,this.pane3),this.insertPane(2,2,this.pane0),this.insertPane(2,3,this.vScroll0),this.insertPane(3,0,this.dummy0),this.insertPane(3,1,this.hScroll1),this.insertPane(3,2,this.hScroll0),this.apply(function(e){e.appendTo(c),e.updateBoundary()}),this.headersCache={hidden:!1},this.scrollbarCache={hidden:!1}}A.prototype={setDimensions:function(e,s,i,h,n,l,r,a){t.prototype.setDimensions.call(this,s,i,l,r,a);var x=a,o=this.xAxles[0].getWidth(),A=this.yAxles[0].getHeight(),c=this.xAxles[3].getWidth(),d=this.yAxles[3].getHeight(),C=0,w=o,y=C+w,g=e.getColX(n)*l,u=y+g,P=s-u-c,f=u+P,p=c,S=A,v=0+S,H=e.getRowY(h)*r,I=v+H,m=i-I-d,Z=I+m,U=d;x&&(C=this.translateX(s,C,w),y=this.translateX(s,y,g),u=this.translateX(s,u,P),f=this.translateX(s,f,p)),this.xAxles[0].set(C,w),this.xAxles[1].set(y,g),this.xAxles[2].set(u,P),this.xAxles[3].set(f,p),this.yAxles[0].set(0,S),this.yAxles[1].set(v,H),this.yAxles[2].set(I,m),this.yAxles[3].set(Z,U),this.xAxles[0].setContentViewPort(C,w),this.xAxles[1].setContentViewPort(y,g);var V=e.getColX(e.getMaxColumn()-1),W=e.getColWidth(e.getMaxColumn()-1);this.xAxles[2].setContentViewPort(g,Math.max(g+P,(V+W)*l+400)),this.xAxles[3].setContentViewPort(f,U),this.yAxles[0].setContentViewPort(0,S),this.yAxles[1].setContentViewPort(0,H);var b=e.getRowY(e.getMaxRow()-1),G=e.getRowHeight(e.getMaxRow()-1);this.yAxles[2].setContentViewPort(H,Math.max(H+m,(b+G)*r+400)),this.yAxles[3].setContentViewPort(Z,p)},hideHeaders:function(){this.headersCache.hidden||(this.headersCache={xAxles:{width:this.xAxles[0].width,CWidth:this.xAxles[0].CWidth},yAxles:{height:this.yAxles[0].height,CHeight:this.yAxles[0].CHeight},hidden:!0},this.xAxles[0].width=this.xAxles[0].CWidth=0,this.yAxles[0].height=this.yAxles[0].CHeight=0)},showHeaders:function(){this.headersCache.hidden&&(this.xAxles[0].width=this.headersCache.xAxles.width,this.xAxles[0].CWidth=this.headersCache.xAxles.CWidth,this.yAxles[0].height=this.headersCache.yAxles.height,this.yAxles[0].CHeight=this.headersCache.yAxles.CHeight,this.headersCache.hidden=!1)},hideScrollbars:function(){this.scrollbarCache.hidden||(this.scrollbarCache={xAxles:{width:this.xAxles[3].width,CWidth:this.xAxles[3].CWidth},yAxles:{height:this.yAxles[3].height,CHeight:this.yAxles[3].CHeight},hidden:!0},this.xAxles[3].width=this.xAxles[3].CWidth=0,this.yAxles[3].height=this.yAxles[3].CHeight=0)},showScrollbars:function(){this.scrollbarCache.hidden&&(this.xAxles[3].width=this.scrollbarCache.xAxles.width,this.xAxles[3].CWidth=this.scrollbarCache.xAxles.CWidth,this.yAxles[3].height=this.scrollbarCache.yAxles.height,this.yAxles[3].CHeight=this.scrollbarCache.yAxles.CHeight,this.scrollbarCache.hidden=!1)},isInViewPort:function(e,t,s,i){for(var h=this.getPanes(),n=0;n<h.length;n++)if(h[n].isInViewPort(e,t,s,i))return!0;return!1},isViewPortIntersects:function(e,t,s,i){for(var h=this.getPanes(),n=0;n<h.length;n++)if(h[n].isViewPortIntersects(e,t,s,i))return!0;return!1},addLayer:function(e){for(var t=this.getPanes(),s=0;s<t.length;s++)e(t[s])},onBeforeFill:function(e){for(var t=this.getPanes(),s=0;s<t.length;s++)t[s].onBeforeFill(e)},applyOnHeaders:function(e){for(var t=this.getHeaders(),s=0;s<t.length;s++)e(t[s])},applyOnPanes:function(e){for(var t=this.getPanes(),s=0;s<t.length;s++)e(t[s])},getPanes:function(){return[this.pane0,this.pane1,this.pane2,this.pane3]},getHeaders:function(){return[this.row0,this.row1,this.col1,this.col0]}},A.prototype=Object.assign({},t.prototype,A.prototype),A.Axles={XAxle:s,YAxle:i},A.Rect=h,e.ZSGrid.UIPaneManager=A}(this);
!function(e){var t,i=(e.ZSGrid||(e.ZSGrid={})).UIPane,r=e.sPlusPlus,n=e.ZSClass,o=e.Listener.Pane,s=n.Layer.Interface,a=(r.view.measures,e.ZSEvents),l=a.topic,c=a.Groups,u=a.Names,v=n.Selector.Assistor,g=n.SelectorHelper.Constants.MULTI_DIRECTION;function d(s,a,d){i.call(this,s,a),this.container.classList.add("sheetPane"),this.root=d,this.container.setAttribute("context","MI_GRID_CONTEXT"),function(){var e=this;this.container.addEventListener("mousedown",function(i){i.pageX,i.pageY;var s=e.getInteracter();(function(e,i){var s=r.view.getActiveGridID();t=s;var a=r.view.getGridComponent(s);if(!a)return;var d=a.translateCoordinates(e),h=this.getRelativeCoordinates(d.x,d.y),I=r.view.getResourceID(t),S=r.view.getSheetID(t),C=r.view.getVersionID(t),E=r.view.getSheetState(t,S);if(3===e.which||2===e.button)for(var R=E.getRanges(),w=r.data.getWorkBook(I,C),D=w.getSheetObj(S),f=new v(void 0,!0,g),p=f.ADD(D,h.x,h.y),m=R.length,O=m-1;O>=0;O--)if(R[O].subset(p))return;e.preventDefault();var A=r.view.CellEditor;A&&A.getEditStatus()&&!n.RangePicker.isSelection()&&l.publish(c.Gesture.Selector.CellEdit,u.GESTURE.ACTION.ENUMERATE,{RID:I,SHEETID:S,VERSION:C,isSubmittable:1}),o.Selection.mousedown.call(this,e,s,I,S,C,h.x,h.y),l.publish(c.Selector.DomUpdate.CellEdit,u.Selection.BOUND_UPDATE.APPLY,{CONTAINER:a.fifthPane})}).call(e,i,s)})}.call(this),function(){var t=this;this.container.addEventListener("dblclick",function(i){i.pageX,i.pageY;var n=t.getInteracter();(function(t,i){var n=r.view.getActiveGridID(),o=r.view.getResourceID(n),s=r.view.getSheetID(n),a=r.view.getVersionID(n),v=r.view.getGridComponent(n);if(!v)return;var g=v.translateCoordinates(t),d=this.getRelativeCoordinates(g.x,g.y),h=r.view.getSheetState(n,s).getActiveRange(),I=r.data.getWorkBook(o,a),S=I.getSheetObj(s),C=S.ProtectedRanges.isXists(h.startRow,h.startCol),E=v.interacter.getCell(h.startRow,h.startCol),R=!!E.data&&E.data.isCheckbox,w=S.Pivot.isXists(h.startRow,h.startCol),D=I.ProtectedSheets.isSheetLocked(s);if(C||w||D||R||!v.isEditable())return;l.publish(c.Gesture.Selector.CellEdit,u.GESTURE.ACTION.DOWN,{RID:o,SHEETID:s,VERSION:a,x:d.x,y:d.y});r.view.fetchCellData(o,s,a,h.startRow,h.startCol,["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],n,function(e){l.publish(c.Listener,u.CellAction.VALUE.SET,{RID:o,SHEETID:s,VERSION:a,ROW:h.startRow,COL:h.startCol,VALUE:e[h.startRow][h.startCol],FOCUS:!0})},function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)})}).call(t,i,n)})}.call(this),function(){var e=this;this.container.addEventListener("mousemove",function(t){var i=e.getInteracter();(function(e,t){var i=r.view.getActiveGridID(),n=r.view.getGridComponent(i);if(!n)return;var s=n.translateCoordinates(e),a=this.getRelativeCoordinates(s.x,s.y),v=t.getResourceID(),g=t.getSheetID(),d=t.getVersion(),h=t.findRow(a.y),I=t.findCol(a.x);l.publish(c.Listener,u.Mouse.Move,{RID:v,SHEETID:g,VERSION:d,ROW:h,COL:I}),o.Selection.mouseover.call(this)}).call(e,t,i)})}.call(this)}d.prototype={getInteracter:function(){return this.root.getInteracter()},isViewPortIntersects:function(e,t,i,r){return this.getInteracter().isViewPortIntersects(e,t,i,r)}},d.prototype=s.implement(d,[i]),n.UISheetPane=d}(this);
!function(e){var t,i,r,o,n=e.sPlusPlus,a=(n.view.measures,e.ZSEvents),s=a.topic,l=a.Groups,c=a.Names,v=e.JSUtil.Mouse.BindEvents,g=1e3/60;function u(){var e=n.view.getActiveGridID(),t=n.view.getGridComponent(e),i=t.rect,r=(t.getHeights(),t.getWidths(),t.getRowHeaderWidth()),o=t.getColumnHeaderHeight(),a=t.getHSrollbarHeight(),s=t.getVSrollbarWidth();t.getFlip()&&(r=t.getVSrollbarWidth(),s=t.getRowHeaderWidth());var l=i.top+o,c=i.top+i.height-a;return{left:i.left+r,top:l,right:i.left+i.width-s,bottom:c}}function d(e){var t=u(),i=e.pageY;return t.top>=i?-10:t.bottom<=i?10:0}function m(e,t){var i=u(),r=e.pageX;return t?i.right<=r?-15:i.left>=r?15:0:i.left>=r?-15:i.right-1<=r?15:0}function I(e){var t=n.view.getActiveGridID(),i=n.view.getGridComponent(t);e;var r=m(e,i.getFlip());if(0!=r){var o=i.translateCoordinates(e);i.getRelativeCoordinates();w(this.gridID,r,0,o,this.callBack)}else L()}function h(t){L(),e.removeEventListener("mousemove",I),e.removeEventListener("mouseup",h)}function D(e){e;var t=n.view.getActiveGridID(),i=n.view.getGridComponent(t),r=d(e);if(0!=r){var o=i.translateCoordinates(e);w(this.gridID,0,r,o,this.callBack)}else L()}function f(t){L(),e.removeEventListener("mousemove",D),e.removeEventListener("mouseup",f)}function p(t){L(),e.removeEventListener("mousemove",C),e.removeEventListener("mouseup",p)}function C(e){e;var t=n.view.getActiveGridID(),i=n.view.getGridComponent(t),r=m(e,i.getFlip()),o=d(e),a=i.translateCoordinates(e),s=i.getRelativeCoordinates(a.x,a.y);this.gridID=this.gridID||n.view.getActiveGridID(),0!=r&&0!=o?w(this.gridID,r,o,s,this.callBack):0!=r?w(this.gridID,r,0,s,this.callBack):0!=o?w(this.gridID,0,o,s,this.callBack):L()}function w(e,a,s,l,c){n.view.getGridComponent(e).getFlip();L(),G(e,a,s,l,c);var v=a,u=s;i=setTimeout(function(){a=1.5*v,s=1.5*u},1500),r=setTimeout(function(){a=2*v,s=2*u},3e3),o=setTimeout(function(){a=4*v,s=4*u},5e3),t=setInterval(function(){G(e,a,s,l,c)},g)}function L(){clearInterval(t),clearTimeout(i),clearTimeout(r),clearTimeout(o)}function G(e,t,i,r,o){var a=n.view.getResourceID(e),v=n.view.getSheetID(e),g=n.view.getVersionID(e),u=n.view.getGridComponent(e).getScrollPosition(t,i,r);o(e,a,v,g,u.rangeX,u.rangeY),s.publish(l.UserAction,c.SheetAction.SCROLL_POSITION.Relativepane0,{RID:a,SHEETID:v,VERSION:g,DistanceX:t,DistanceY:i})}s.register(l.Listener,c.Mouse.ScrollOut,function(e,t){var i={gridID:e,callBack:t};v.call(i,C,p)},"GRIDID","CALLBACK"),s.register(l.Listener,c.Mouse.ScrollOutRowY,function(e,t){var i={gridID:e,callBack:t};v.call(i,D,f)},"GRIDID","CALLBACK"),s.register(l.Listener,c.Mouse.ScrollOutColX,function(e,t){var i={gridID:e,callBack:t};v.call(i,I,h)},"GRIDID","CALLBACK")}(this);
!function(o){function t(o,t,i,r,e,s,h,l){this.color=o,this.highColor=t,this.lowColor=i,this.firstColor=r,this.lastColor=e,this.negativeColor=s,this.markerColor=h,this.showHorizontalAxis=l}t.prototype={draw:function(o,t,i,r,e,s,h,l,n){var a,C=r/(s.length-1);a=l-h==0?l===h?e/l:1:e/(l-h);var c=t,g=i+e;o.context.lineWidth=Math.min(2,1*o.getZoom()),o.context.strokeStyle="#dddddd",this.showHorizontalAxis&&o.drawLine(c,g,c+r,g),function(o,t,i,r,e,s,h,l,n,a,C){var c=s.length,g=0,d=i,f=[];o.context.beginPath(),o.context.strokeStyle=n,o.context.lineWidth=1*o.getZoom();for(var v=!0;g<c;g++,t+=r)if(isNaN(s[g]))"gap"===C&&(v=!0);else{i=d-e*s[g],i+=h*e,v?o.context.moveTo(t,i):o.context.lineTo(t,i),v=!1;var n=a(g,s[g],h,l,c-1);n&&f.push([t,i,n])}o.context.stroke(),function(o,t){for(var i=t.length,r=0;r<i;r++){var e=t[r];o.drawCircle(e[0],e[1],1.5*o.getZoom(),e[2])}}(o,f)}(o,c,g,C,a,s,h,l,this.color,this.getColor.bind(this),n)},getColor:function(o,t,i,r,e){var s;return this.highColor&&t===r?s=this.highColor:this.lowColor&&t===i?s=this.lowColor:this.firstColor&&0===o?s=this.firstColor:this.lastColor&&o===e?s=this.lastColor:this.negativeColor&&t<0?s=this.negativeColor:this.markerColor&&(s=this.markerColor),s}},o.LineSparkline=t}(this);
!function(o){var t=o.Rect;function i(o,t,i,r,n,s,h,l){this.color=o,this.highPointColor=t,this.lowPointColor=i,this.firstPointColor=r,this.lastPointColor=n,this.negativePointColor=s,this.markerPointColor=h,this.showHorizontalAxis=l}i.prototype={draw:function(o,i,r,n,s,h,l,a){var e=h.length,C=n/e,P=s/(a-l+1),g=i,c=r+(l>0?s:s-P*Math.abs(l));this.showHorizontalAxis&&o.drawLine(g,c,g+n,c);for(var f=C-2,v=0;v<e;v++){if(!isNaN(h[v])){var w=this.getColor(v,h[v],l,a,e-1);w=w||this.color;s=P*h[v]-(l>0?(l-1)*P:0);var u=new t(g,c-s,f,s);o.drawRectangle(u,w)}g+=C}},getColor:function(o,t,i,r,n){var s;return this.highPointColor&&t===r?s=this.highPointColor:this.lowPointColor&&t===i?s=this.lowPointColor:this.firstPointColor&&0===o?s=this.firstPointColor:this.lastPointColor&&o===n?s=this.lastPointColor:this.negativePointColor&&t<0?s=this.negativePointColor:this.markerPointColor&&(s=this.markerPointColor),s}},o.ColumnSparkline=i}(this);
!function(o){var t=o.Rect;function i(o,t,i,r,s,n,h,l){this.color=o,this.highPointColor=t,this.lowPointColor=i,this.firstPointColor=r,this.lastPointColor=s,this.negativePointColor=n,this.markerPointColor=h,this.showHorizontalAxis=l}i.prototype={draw:function(o,i,r,s,n,h,l,a){var e=h.length,C=s/e,P=n/2,g=P,c=i,f=r+P;this.showHorizontalAxis&&o.drawLine(c,f,c+s,f);for(var v=C-2,w=0;w<e;w++){if(!isNaN(h[w])){var u=this.getColor(w,h[w],l,a,e-1);u=u||this.color,n=0===h[w]?0:h[w]>0?g:-g;var k=new t(c,f-n,v,n);o.drawRectangle(k,u)}c+=C}},getColor:function(o,t,i,r,s){var n;return this.highPointColor&&t===r?n=this.highPointColor:this.lowPointColor&&t===i?n=this.lowPointColor:this.firstPointColor&&0===o?n=this.firstPointColor:this.lastPointColor&&o===s?n=this.lastPointColor:this.negativePointColor&&t<0?n=this.negativePointColor:this.markerPointColor&&(n=this.markerPointColor),n}},o.WinLossSparkline=i}(this);
!function(t){function e(t,e,i,n,o){this.sparkline=t,this.data=e,this.min=i,this.max=n,this.emptyCellType=o}e.prototype={render:function(t,e,i){var n=i.clone(),o=i.clone();o.addPaddingLeft(2*t.getZoom()),o.addPaddingRight(2*t.getZoom()),o.addPaddingTop(2*t.getZoom()),o.addPaddingBottom(2*t.getZoom()),t.context.save(),t.context.beginPath(),t.context.rect(o.getX(),o.getY(),o.getWidth(),o.getHeight()),t.context.clip(),n.addPaddingLeft(6*t.getZoom()),n.addPaddingRight(6*t.getZoom()),n.addPaddingTop(4*t.getZoom()),n.addPaddingBottom(4*t.getZoom()),this.sparkline.draw(t,n.getX(),n.getY(),n.getWidth(),n.getHeight(),this.data,this.min,this.max,this.emptyCellType),t.context.restore()},setData:function(t){this.data=t},setMaximum:function(t){this.max=t},setMinimum:function(t){this.min=t},setEmptyCellType:function(t){this.emptyCellType=t},hasContent:function(){return!0},getWidth:function(){return 1}},t.Sparkline=e}(this);
!function(t){function i(){this.dom=document.createElement("div"),this.dom.style.position="relative"}i.prototype={getDom:function(){return this.dom},setTop:function(t){this.dom.style.top=t+"px"},setLeft:function(t){this.dom.style.left=t+"px"},setWidth:function(t){this.dom.style.width=t+"px"},setHeight:function(t){this.dom.style.height=t+"px"},appendTo:function(t){t.appendChild(this.dom)},appendChild:function(t){this.dom.appendChild(t)}},t.UICueHolder=i}(this);
!function(t){function s(){this.dom=document.createElement("div")}s.prototype={getDom:function(){return this.dom},addClass:function(t){this.dom.className=t},setLeft:function(t,s){s?(this.dom.style.left="",this.dom.style.right=t+"px"):(this.dom.style.left=t+"px",this.dom.style.right="")},setTop:function(t){this.dom.style.top=t+"px"},hide:function(){this.dom.style.display="none"},show:function(){this.dom.style.display=""}},t.UIDragAndDropHolder=s}(this);
!function(t){function i(){this.dom=document.createElement("div"),this.dom.style.position="absolute"}i.prototype={getDom:function(){return this.dom},setLeft:function(t,i){i?(this.dom.style.right=t+"px",this.dom.style.left=""):(this.dom.style.left=t+"px",this.dom.style.right="")},setTop:function(t){this.dom.style.top=t+"px"},hide:function(){this.dom.style.display="none"},show:function(){this.dom.style.display=""},addClass:function(t){this.dom.className=t},addTitle:function(t){this.dom.title=t},addListener:function(t,i){this.dom.addEventListener(t,i)}},t.UIShowCue=i}(this);
!function(t){function s(){this.dom=document.createElement("div"),this.dom.style.position="absolute"}s.prototype={getDom:function(){return this.dom},setLeft:function(t){this.dom.style.left=t+"px"},setRight:function(t){this.dom.style.right=t+"px"},setTop:function(t){this.dom.style.top=t+"px"},setBottom:function(t){this.dom.style.bottom=t+"px"},setWidth:function(t){this.dom.style.width=t+"px"},setHeight:function(t){this.dom.style.height=t+"px"},show:function(){this.dom.style.display=""},hide:function(){this.dom.style.display="none"},addClass:function(t){this.dom.className=t},addToClassList:function(t){this.dom.classList.add(t)},removeFromClassList:function(t){this.dom.classList.remove(t)},addListener:function(t,s){this.dom.addEventListener(t,s)}},t.UIResizeCue=s}(this);
!function(t){function n(){this.dom=document.createElement("div")}n.prototype={getDom:function(){return this.dom},addClass:function(t){this.dom.className=t},addListener:function(t,n){!function(t,n,o){t.addEventListener(n,o)}(this.dom,t,n)}},t.UIDropDown=n}(this);
!function(t){function i(){this.dom=document.createElement("div"),this.dom.style.position="absolute"}i.prototype={getDom:function(){return this.dom},setLeft:function(t,i){i?(this.dom.style.right=t+"px",this.dom.style.left=""):(this.dom.style.left=t+"px",this.dom.style.right="")},setTop:function(t){this.dom.style.top=t+"px"},setWidth:function(t){this.dom.style.width=t+"px"},setHeight:function(t){this.dom.style.height=t+"px"},addClass:function(t){this.dom.className=t},setAttribute:function(t,i){this.dom.setAttribute(t,i)},show:function(){this.dom.style.display=""},hide:function(){this.dom.style.display="none"},appendChild:function(t){this.dom.appendChild(t)}},t.UIHeaderContainer=i}(this);
!function(t){function e(){this.headerDom=document.createElement("div"),this.bodyDom=document.createElement("div")}e.prototype={addClass:function(t,e){this.headerDom.className=t,this.bodyDom.className=e},setLeft:function(t,e){40==t&&(t-=2),e?(this.headerDom.style.left="",this.bodyDom.style.left="",this.headerDom.style.right=t+"px",this.bodyDom.style.right=t-1+"px"):(this.headerDom.style.left=t-1+"px",this.bodyDom.style.left=t+"px",this.headerDom.style.right="",this.bodyDom.style.right="")},setTop:function(t){23==t&&(t-=2),this.headerDom.style.top=t-2+"px",this.bodyDom.style.top=t+"px"},setWidth:function(t){this.headerDom.style.width=t+"px"},setHeight:function(t){this.headerDom.style.height=t+"px"},hideBodyDom:function(){this.bodyDom.style.display="none"},showBodyDom:function(){this.bodyDom.style.display=""}},t.UIFreezeCue=e}(this);
!function(e){var t=e.sPlusPlus,i=e.Listener||(e.Listener={}),s=i.Column||(i.Column={}),r=e.JSUtil.Mouse.BindEvents,n=ZSClass.SelectorHelper.Constants.TYPE,o=e.ZSEvents,a=o.topic,I=o.Groups,h=o.Names,l={mousedown:function(i,s,o,l,E,D){var R=t.view.getGridComponent(s),d={gridID:s,This:this,rID:o,sheetID:l,version:E};if(i.shiftKey)u.call(d,i);else{var c=0;(i.metaKey||i.ctrlKey&&-1==e.navigator.platform.toUpperCase().indexOf("MAC"))&&(c=1);var g={RID:o,SHEETID:l,VERSION:E,ROWY:-1,COLX:D,ACTIVEX:D,ACTIVEY:-1,ACCUMULATE:c,metaKey:i.metaKey,TYPE:n.COLUMN,GRID_ID:s};if(i.which&&3===i.which||i.button&&2===i.button)if(R.getInteracter().getActiveRange(l).isWhole())return;a.publish(I.Listener,h.Mouse.RangeDown,g),a.publish(I.Listener,h.Mouse.ScrollOutColX,{GRIDID:s,CALLBACK:v}),R.refreshHeaders(),r.call(d,C,u,!0)}}};function C(e){var i=t.view.getActiveGridID(),s=t.view.getGridComponent(i),r=s.translateCoordinates(e),o=this.This.getRelativeCoordinates(r.x,r.y),l={RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID:0,ROWY:-1,COLX:o.x,TYPE:n.COLUMN};a.publish(I.Listener,h.Mouse.RangeMove,l),s.refreshHeaders()}function u(e){var i=t.view.getActiveGridID(),s=t.view.getGridComponent(i),r=s.translateCoordinates(e),o=this.This.getRelativeCoordinates(r.x,r.y),l={RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID:0,ROWY:-1,COLX:o.x,TYPE:n.COLUMN};a.publish(I.Listener,h.Mouse.RangeEnd,l),s.refreshHeaders()}function v(e,i,s,r,n,o,l){e=t.view.getActiveGridID();var C=t.view.getGridComponent(e),u={RID:i,SHEETID:s,VERSION:r,RANGEID:0,ROWY:o,COLX:n,TYPE:l};a.publish(I.Listener,h.Mouse.RangeEnd,u),C.refreshHeaders()}s.Selection=l}(this);
!function(e){var t,r,i,o,n,s,a=e.sPlusPlus,l=e.Listener||(e.Listener={}),d=l.Column||(l.Column={}),g=a.data.Defaults,h=document.body,C=e.ZSConstants.I18N,c=e.JSUtil.Mouse.BindEvents,u=e.ZSEvents,v=u.topic,D=u.Groups,S=u.Names,I=!1,f={mousedown:function(l,d,g,C){R(!0),I=!0;var u=l.getGridID();l.getResourceID(),l.getSheetID(),l.getVersion();r=i=C,(t=r.clone()).startCol=t.endCol+1,o=u;a.view.getSelectedSheets(u);var f={gridID:u,interacter:l,This:this},w=a.view.getGridComponent(u);this.container.style.height=w.getHeight()+"px",v.publish(D.Listener,S.Mouse.ScrollOutColX,{GRIDID:u,CALLBACK:A.bind(f)}),n=function(t){if(27==t.keyCode){I=!1;var r=this.interacter.getResourceID(),i=this.interacter.getSheetID(),o=this.interacter.getVersion();v.publish(D.Listener,S.Layers.HeaderDrag.Remove,{RID:r,SHEETID:i,VERSION:o,ID:0}),h.classList.remove("grabbingCursor"),this.This.dragAndDropCueHolder.hide();var l=a.view.getGridComponent(this.gridID),d=l.getHeights();this.This.container.style.height=d[0]+"px",s.clearEvents(),e.removeEventListener("keydown",n)}}.bind(f),e.addEventListener("keydown",n),e.addEventListener("mouseup",p),s=c.call(f,m,L,!0),this.dragAndDropCueHolder.hide()}};function p(){R(!1),e.removeEventListener("mouseup",p)}function m(e){var t=this.interacter.getGridID(),r=this.interacter.getResourceID(),i=this.interacter.getSheetID(),o=this.interacter.getVersion(),n=a.view.getGridComponent(t).translateCoordinates(e),s=this.This.getRelativeCoordinates(n.x,n.y),l=a.view.getSheetState(t,i).getZoom();A.call(this,t,r,i,o,s.x*l,s.y*l)}function A(e,n,s,l,d,g){if(I){var h=a.view.getGridComponent(e),C=(a.data.getWorkBook(n,l).getSheetObj(s),a.data.Defaults.MAX_ROW-1),c=h.interacter.findCol(d),u=c+(t.endCol-t.startCol);u>a.data.Defaults.MAX_COL-1&&(c=(u=a.data.Defaults.MAX_COL-1)-(t.endCol-t.startCol));var v=new ZSClass.Range(0,c,C,u),D=a.view.getSheetState(o,s).getZoom();d=Math.floor(d/D);var S=h.interacter.findCol(d),f=d-h.interacter.getColX(S)>=h.interacter.getColWidth(S)/2?S+1:S;v.startCol>=r.startCol&&(v.endCol,r.endCol);v.startCol=f,v.endCol=-1!=v.endCol?v.endCol:0,i=v,f>=r.startCol&&f-1<=r.endCol?w.call(this,v,!1):w.call(this,v,!0)}}function L(t){var o=this.interacter.getGridID(),s=this.interacter.getResourceID(),l=this.interacter.getSheetID(),d=this.interacter.getVersion(),h=a.view.getSheetState(o,l).getActiveCellRange();h.startRow,h.startCol;i.endCol=i.startCol;var c=a.view.getSelectedSheets(o),u=a.view.getGridComponent(o).getHeights();this.This.container.style.height=u[0]+"px",function(e,t,r,i,o,n){var s=a.data.getWorkBook(e,r).getSheetObj(t);if(R(!1),this.dragAndDropCueHolder.hide(),!o.equals(n)&&function(e,t){return e.MaxUsedCol+t>=g.MAX_COL}(s,o.endCol-o.startCol+1))return void ZSClass.ZSAlert(C["InsertCol.Alert.InsertingNotPossibleBeyondMaxCol"],{title:C["Alert.Title.LimitExceeded"]});o.endCol!==n.endCol&&o.startCol!==n.startCol&&UserAction.InsertCutCol(e,i,r,new Array(n),!0,new Array(o))}.call(this.This,s,l,d,c,r,i),v.publish(D.Listener,S.Layers.HeaderDrag.Remove,{RID:s,SHEETID:l,VERSION:d,ID:0}),e.removeEventListener("keydown",n)}function w(e,t){if(t){var r=0,i=this.interacter.getGridID(),o=this.interacter.getResourceID(),n=this.interacter.getSheetID(),s=this.interacter.getVersion(),l=a.view.getGridComponent(i),d=(a.data.getWorkBook(o,s).getSheetObj(n),a.view.getSheetState(i,n).getZoom());r=l.interacter.getColX(e.startCol);var g=this.interacter.getFlip();g&&(r-=this.This.rect.getX()),this.This.dragAndDropCueHolder.setLeft(r*d,g),this.This.dragAndDropCueHolder.show()}else this.This.dragAndDropCueHolder.hide()}function R(e){e?h.classList.add("grabbingCursor"):h.classList.remove("grabbingCursor")}d.isDragAndDrop=function(e,t,r,i,o){var n=a.view.getSheetState(t,i).getActiveRange();return!(!a.data.getWorkBook(r,o).isEditable()||function(e,t,r){return a.data.getWorkBook(e,r).ProtectedSheets.isSheetLocked(t)}(r,i,o)||!n.isCol()||!function(e,t){var r=new ZSClass.Range(0,e,g.MAX_ROW-1,e);return t.intersects(r)}(e,n)||function(e){return 0==e.startCol&&e.endCol==g.MAX_COL-1}(n))},d.toggleGrabbingCursor=R,d.DragAndDrop=f}(this);
!function(e){var t=e.sPlusPlus,i=t.data.Defaults,n=e.Listener||(e.Listener={}),o=n.Column||(n.Column={}),l=o.Show||(o.Show={}),s={mousedown:function(e,n,o,l,s,r){n=t.view.getActiveGridID();var d,a=t.view.getGridComponent(n).interacter,C=a.findCol(r);a.getColWidth(C);if(a.getFlip()){var g=a.getPrevNonHiddenCol(C);-1===g&&(g=0),d=new ZSClass.Range(0,g,i.MAX_ROW-1,C)}else{var v=a.getNextNonHiddenCol(C);v===i.MAX_COL&&(v=i.MAX_COL-1),d=new ZSClass.Range(0,C,i.MAX_ROW,v)}var w=t.view.getSelectedSheets(n);UserAction.HideCol(o,w,s,"SHOW",d)}},r={mousedown:function(e,n,o,l,s,r){n=t.view.getActiveGridID();var d,a=t.view.getGridComponent(n).interacter,C=a.findCol(r);a.getColWidth(C);if(a.getFlip()){var g=a.getNextNonHiddenCol(C);g===i.MAX_COL&&(g=i.MAX_COL-1),d=new ZSClass.Range(0,C,i.MAX_ROW,g)}else{var v=a.getPrevNonHiddenCol(C);-1===v&&(v=0),d=new ZSClass.Range(0,v,i.MAX_ROW-1,C)}var w=t.view.getSelectedSheets(n);UserAction.HideCol(o,w,s,"SHOW",d)}};l.Left=s,l.Right=r}(this);
!function(e){var t,i,s,n=e.sPlusPlus,o=e.Listener||(e.Listener={}),r=o.Column||(o.Column={}),a=n.data.Defaults,l=document.body,h=e.JSUtil.Mouse.BindEvents,d=5,g={mousedown:function(e,o,r,a){var d=r.getResourceID(),g=r.getGridID(),v=r.getSheetID(g),m=r.getVersion(),p=n.data.getWorkBook(d,m).getSheetObj(v).Column.axis.getDim(o),f=r.getColX(o),S=r.getColWidth(o),x=n.view.getGridComponent(g).getHeight(),W=n.view.getSheetState(g,v).getZoom(),D=(f+S)*W;r.getFlip()&&(D=this.grid.grid.rect.xAxle.getContentWidth()-D);i=function(e,t,i,s,n){var o=document.createElement("div"),r=o.style;return r.position="absolute",r.top=t+"px",r.left=e+"px",r.width=i+"px",r.height=s+"px",r.backgroundColor=n,o}(D,0,1,x,"#999"),this.container.appendChild(i),t=this.container,this.container.style.height=x+"px",this.container.classList.add("colResizeCursor"),s=function(e,t,i){var s=document.createElement("div");s.className="rrzeHlpTxt";var n=s.style;return n.top=t+2+"px",n.left=e+2+"px",s.setAttribute("data-check","Width : "+i+"px"),s}(D,0,p),this.container.appendChild(s),l.addEventListener("mouseup",c);var I={gridID:g,interacter:r,container:this.container,resizer:i,This:this,denoterElement:s,x:e,initialWidth:p,finalWidth:S,initialCol:o,zoom:W,mouseUpCallBack:a};h.call(I,u,C)},dblclick:function(e,t,i){var s=i.getGridID(),o=i.getResourceID(s),r=i.getSheetID(s),l=i.getVersion(s),h=n.view.getSelectedSheets(s),d=n.view.getSheetState(s,r).getActiveRange(),g=new ZSClass.Range(0,e,a.MAX_ROW-1,e);d.subset(g)?UserAction.ResizeCol(o,h,l,t,d.startCol,d.getColSpan(),!0,!0):UserAction.ResizeCol(o,h,l,t,e,1,!0,!1)}};function c(){l.removeEventListener("mouseup",c);var e=n.view.getGridComponent(n.view.getActiveGridID()).getHeights();t.style.height=e[0]+"px",t.classList.remove("colResizeCursor"),t.removeChild(i),t.removeChild(s)}function u(e){var t=n.view.getActiveGridID(),i=n.view.getGridComponent(t),s=i.translateCoordinates(e),o=this.This.getRelativeCoordinates(s.x,s.y).x,r=o-this.x;(this.finalWidth=this.initialWidth+r,i.getFlip())&&(o=this.This.grid.grid.rect.xAxle.getContentWidth()-o);if(this.finalWidth<=0)this.resizer.style.left=o*l-this.finalWidth+"px",this.denoterElement.style.left=o*l-this.finalWidth+2+"px",this.finalWidth=0,this.denoterElement.setAttribute("data-check","Hide");else{var a=this.interacter.getSheetID(this.gridID),l=n.view.getSheetState(this.gridID,a).getZoom();this.resizer.style.left=o*l+"px",this.denoterElement.style.left=o*l+2+"px",this.finalWidth=Math.round(this.finalWidth),this.denoterElement.setAttribute("data-check","Width : "+this.finalWidth+"px")}}function C(e){var t=this.interacter,i=this.finalWidth,s=t.getResourceID(),o=t.getSheetID(),r=t.getVersion(),l=n.view.getSelectedSheets(this.gridID),h=n.view.getSheetState(this.gridID,o).getActiveRange(),d=new ZSClass.Range(0,this.initialCol,a.MAX_ROW-1,this.initialCol);if(i){var g=t.getColWidth(d.startCol),c=this.mouseUpCallBack;g!==i&&(h.subset(d)?UserAction.ResizeCol(s,l,r,i,h.startCol,h.getColSpan(),!1,!0,function(){c(e)}):UserAction.ResizeCol(s,l,r,i,this.initialCol,1,!1,!1,function(){c(e)}))}else h.subset(d)?UserAction.HideCol(s,l,r,"HIDE",h):UserAction.HideCol(s,l,r,"HIDE",d)}r.isResize=function(e,t,i,s,o,r){var a=n.data.getWorkBook(s,r);if(!a.isEditable()||function(e,t,i){return n.data.getWorkBook(e,i).ProtectedSheets.isSheetLocked(t)}(s,o,r))return!1;var l=a.getSheetObj(o),h=(n.view.getSheetState(i,o).getZoom(),l.Column.axis.getDim(t));return e-l.Column.axis.getPos(t)>=h-d},r.Resize=g}(this);
!function(t){t.sPlusPlus.data.Defaults;var n=t.Listener||(t.Listener={}),o={mousedown:function(t,n,o){n.subset(o)&&t.stopPropagation(),UIUtil.Component.triggerEvent(t,document)}};(n.Column||(n.Column={})).DropDown=o}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSConstants.I18N,o=e.ZSGrid.UIColumnPane,r=e.UIHeaderContainer,n=e.Listener.Column,s=t.data.Defaults,a=(document.body,t.view.measures),d=e.ZSEvents,h=d.topic,l=d.Groups,u=d.Names,g=e.ZSGrid.Nodes,C=g.LeftAndRightHideCue,c=g.LeftHideCue;function v(e,t,i){this.rect=e,this.root=i,o.call(this,e,t),this.cueholder=new UICueHolder,this.cueholder.setTop(0),this.cueholder.setHeight(e.getHeight());var s=function(e){var t=new r;return t.setAttribute("context","MI_COLHEAD_CONTEXT"),t.addClass("colHeaderContainer"),t.setTop(0),t.setHeight(e.getHeight()),a.Grid.ColHeader=e.getHeight(),t.hide(),t}(e);this.headerContainer=s;var d=f.call(this,e,p,m);this.rearResizeCue=d;var h=f.call(this,e,R,S);this.frontResizeCue=h;var l=function(){var e=new UIDropDown;return e.addClass("cDropDown"),e.dom.setAttribute("data-menu-id","MI_COLHEAD_CONTEXT"),e}();this.dropDown=l,s.appendChild(l.getDom()),s.appendChild(d.getDom()),s.appendChild(h.getDom()),d.hide(),h.hide(),this.cueholder.appendChild(this.headerContainer.getDom());var u=w.call(this,n.Show.Left.mousedown);u.addClass("leftShowcue columnShowCue"),u.hide(),this.leftShowCue=u,this.cueholder.appendChild(u.getDom());var g=w.call(this,n.Show.Right.mousedown);g.addClass("rightShowCue columnShowCue"),g.hide(),this.rightShowCue=g,this.cueholder.appendChild(g.getDom());var C,c=((C=new UIDragAndDropHolder).addClass("dragAndDropCueColHandler"),C);c.hide(),this.dragAndDropCueHolder=c,this.cueholder.appendChild(c.getDom()),this.scroller.appendChild(this.cueholder.getDom()),this.container.classList.add("columnPane"),this.addListener()}function w(e){var o=new UIShowCue,r=this;return o.addTitle(i["Show.Cols"]),o.addListener("mousedown",function(i){var o=r.getInteracter();if(3!=i.which&&2!=i.button){var n=t.view.getActiveGridID(),s=t.view.getGridComponent(n);if(s){var a=o.getResourceID(),d=o.getSheetID(),h=o.getVersion(),l=s.translateCoordinates(i),u=r.getRelativeCoordinates(l.x,l.y);e.call(r,i,n,a,d,h,u.x),i.stopPropagation(),r.leftShowCue.hide(),r.rightShowCue.hide()}}}),o}function f(e,i,o){var r=i(e),a=this,d=!1;return r.addListener("mousedown",function(e){e.stopPropagation();var i=a.getInteracter();if(d)d=!1;else{d=!0,setTimeout(function(){d=!1},350);var r=t.view.getActiveGridID(),h=t.view.getGridComponent(r);if(h&&h.isEditable()){var l=h.translateCoordinates(e),u=a.getRelativeCoordinates(l.x,l.y),g=o(i,u.x);n.Resize.mousedown.call(a,u.x,g,i,function(e){var i=t.view.getActiveGridID(),o=t.view.getGridComponent(i),r=o.interacter,n=o.translateCoordinates(e),a=this.getRelativeCoordinates(n.x,n.y),d=this.headerContainer;d.show();var h=r.findCol(a.x),l=r.getColWidth(h),u=r.getColX(h),g=this.rect.getScaleX();u*=g,l*=g;var C=this.rect.getFlip(),c=r.getSheetID(),v=t.view.getSheetState(i,c).getActiveRange(),w=new ZSClass.Range(0,h,s.MAX_ROW-1,h);v.subset(w)?this.dropDown.addClass("cDropDown cDropDownSelection"):this.dropDown.addClass("cDropDown");d.setLeft(u,C),d.setWidth(l)}.bind(a))}}}),r.addListener("dblclick",function(e){e.stopPropagation();var i=a.getInteracter(),s=t.view.getActiveGridID(),d=t.view.getGridComponent(s);if(d&&d.isEditable()){var h=d.translateCoordinates(e),l=a.getRelativeCoordinates(h.x,h.y);r.hide();var u=o(i,l.x),g=i.getColWidth(u);n.Resize.dblclick(u,g,i)}}),r.addListener("mouseover",function(e){r.addToClassList("colResizeHover")}),r.addListener("mouseleave",function(e){r.removeFromClassList("colResizeHover")}),r}function p(e){var t=new UIResizeCue;return t.setHeight(e.getHeight()),t.addClass("rightResizeCue colResizeCue"),t}function D(e,t){return e.getNextNonHiddenCol(t)>=e.getMaxColumn()}function S(e,t){var i=e.findCol(t),o=e.getPrevNonHiddenCol(i);return o<0?0:o}function m(e,t){return e.findCol(t)}function R(e){var t=new UIResizeCue;return t.setHeight(e.getHeight()),t.addClass("leftResizeCue colResizeCue"),t}v.prototype={getInteracter:function(){return this.root.getInteracter()},setContentDimension:function(e){o.prototype.setContentDimension.call(this,e),this.cueholder.setWidth(this.rect.getContentWidth())},addListener:function(){var e=this,i=!1;C.setMouseOver(!0),c.setMouseOver(!0),this.container.addEventListener("mousemove",function(o){var r=e.getInteracter(),a=t.view.getActiveGridID(),d=t.view.getGridComponent(a);if(d){!i&&d.refreshHeaders(r),i=!0;var h=e.headerContainer;h.show();var l=d.translateCoordinates(o),u=e.getRelativeCoordinates(l.x,l.y),g=r.findCol(u.x),C=r.getColWidth(g),c=r.getColX(g),v=e.rect.getScaleX();c*=v,C*=v,u.x-c<C/2?(e.rearResizeCue.hide(),e.frontResizeCue.show(),r.getPrevNonHiddenCol(g)<0&&e.frontResizeCue.hide()):(e.rearResizeCue.show(),e.frontResizeCue.hide());a=r.getGridID();var w=r.getResourceID(),f=r.getSheetID(),p=r.getVersion(),S=c/v,m=C/v,R=e.rect.getFlip(),I=t.view.getSheetState(a,f).getActiveRange(),L=new ZSClass.Range(0,g,s.MAX_ROW-1,g);I.subset(L)&&!I.isWhole()?e.dropDown.addClass("cDropDown cDropDownSelection"):e.dropDown.addClass("cDropDown"),h.setLeft(c,R),h.setWidth(C),d.isEditable()&&(u.x<=S+10?r.getPrevNonHiddenCol(g)+1!==g&&g>0&&(e.leftShowCue.show(),e.rightShowCue.show(),R?(e.leftShowCue.setLeft(c,R),e.rightShowCue.setLeft(c-14,R)):(e.leftShowCue.setLeft(c-14,R),e.rightShowCue.setLeft(c,R)),D(r,g)&&e.rightShowCue.hide()):u.x>=S+m-10?r.getNextNonHiddenCol(g)-1!==g&&g<s.MAX_COL&&(e.leftShowCue.show(),e.rightShowCue.show(),R?(e.leftShowCue.setLeft(c+C,R),e.rightShowCue.setLeft(c+C-14,R)):(e.leftShowCue.setLeft(c+C-14,R),e.rightShowCue.setLeft(c+C,R)),D(r,g)&&e.rightShowCue.hide()):(e.leftShowCue.hide(),e.rightShowCue.hide()),n.isDragAndDrop(g,a,w,f,p)?o.target.classList.add("grabCursor"):o.target.classList.remove("grabCursor"))}}),this.container.addEventListener("mouseleave",function(o){var r=e.getInteracter(),n=t.view.getActiveGridID(),s=t.view.getGridComponent(n);s&&(i&&s.refreshHeaders(r),i=!1,o.target.classList.remove("grabCursor"),e.headerContainer.hide(),e.leftShowCue.hide(),e.rightShowCue.hide())}),this.container.addEventListener("mousedown",function(i){i.preventDefault(),i.stopPropagation();var o=e.getInteracter(),r=t.view.getActiveGridID(),s=t.view.getGridComponent(r);if(s){var a=s.translateCoordinates(i),d=e.getRelativeCoordinates(a.x,a.y),g=(r=o.getGridID(),o.getResourceID()),C=o.getSheetID(),c=o.getVersion(),v=o.findCol(d.x),w=t.view.CellEditor;if(w&&w.getEditStatus()&&!ZSClass.RangePicker.isSelection()&&h.publish(l.Gesture.Selector.CellEdit,u.GESTURE.ACTION.ENUMERATE,{RID:g,SHEETID:C,VERSION:c,isSubmittable:1}),!ZSClass.RangePicker.isSelection()&&s.isEditable()&&n.isDragAndDrop(v,r,g,C,c)){var f=t.view.getSheetState(r,C).getActiveRange();n.DragAndDrop.mousedown.call(e,o,d.x,d.y,f)}else n.Selection.mousedown.call(e,i,r,g,C,c,d.x)}}),this.dropDown.dom.addEventListener("mousedown",function(i){var o=e.getInteracter(),r=t.view.getActiveGridID(),a=t.view.getGridComponent(r);if(a){var d=a.translateCoordinates(i),h=a.getRelativeCoordinateX(d.x),l=(r=o.getGridID(),o.getResourceID()),u=o.getSheetID(),g=o.getVersion(),C=o.getActiveRange(),c=o.getActiveRanges(),v=o.findCol(h),w=new ZSClass.Range(0,v,s.MAX_ROW-1,v);n.DropDown.mousedown(i,C,w);for(var f=c.length-1;f>=0;f--)if(c[f].subset(w))return;i.stopPropagation(),n.Selection.mousedown.call(e,i,r,l,u,g,h)}})}},v.prototype=Object.assign({},o.prototype,v.prototype),ZSGrid.UISheetColumnPane=v,ZSGrid.UIColumnPane=v}(this);
!function(e){var t=e.sPlusPlus,i=e.Listener||(e.Listener={}),s=i.Row||(i.Row={}),r=e.JSUtil.Mouse.BindEvents,n=ZSClass.SelectorHelper.Constants.TYPE,o=e.ZSEvents,a=o.topic,I=o.Groups,h=o.Names,R={mousedown:function(i,s,o,R,D,v){var C={gridID:s,This:this,rID:o,sheetID:R,version:D};if(i.shiftKey)l.call(C,i);else{var c=t.view.getGridComponent(s),d=0;(i.metaKey||i.ctrlKey&&-1==e.navigator.platform.toUpperCase().indexOf("MAC"))&&(d=1);var O={RID:o,SHEETID:R,VERSION:D,ROWY:v,COLX:-1,ACTIVEX:-1,ACTIVEY:v,metaKey:i.metaKey,TYPE:n.ROW,ACCUMULATE:d,GRID_ID:s};if(i.which&&3===i.which||i.button&&2===i.button)if(c.getInteracter().getActiveRange(R).isWhole())return;a.publish(I.Listener,h.Mouse.RangeDown,O),a.publish(I.Listener,h.Mouse.ScrollOutRowY,{GRIDID:s,CALLBACK:u}),c.refreshHeaders(),r.call(C,E,l)}}};function E(e){var i=t.view.getActiveGridID(),s=t.view.getGridComponent(i),r=s.translateCoordinates(e),o=this.This.getRelativeCoordinates(r.x,r.y),R={RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID:0,ROWY:o.y,COLX:-1,TYPE:n.ROW};a.publish(I.Listener,h.Mouse.RangeMove,R),s.refreshHeaders()}function l(e){var i=t.view.getActiveGridID(),s=t.view.getGridComponent(i),r=s.translateCoordinates(e),o=this.This.getRelativeCoordinates(r.x,r.y),R={RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID:0,ROWY:o.y,COLX:-1,TYPE:n.ROW};a.publish(I.Listener,h.Mouse.RangeEnd,R),s.refreshHeaders()}function u(e,t,i,s,r,n,o){var R={RID:t,SHEETID:i,VERSION:s,RANGEID:0,ROWY:n,COLX:r,TYPE:o};a.publish(I.Listener,h.Mouse.RangeEnd,R)}s.Selection=R}(this);
!function(e){var t,r,i,o,n,s,a=e.sPlusPlus,d=e.Listener||(e.Listener={}),g=d.Row||(d.Row={}),h=a.data.Defaults,c=document.body,w=e.ZSConstants.I18N,R=e.JSUtil.Mouse.BindEvents,u=e.ZSEvents,l=u.topic,v=u.Groups,D=u.Names,S=!1,C={mousedown:function(d,g,h,w){b(!0),S=!0;var u=d.getGridID(),C=d.getResourceID(),m=d.getSheetID(),L=d.getVersion();o=u,r=i=w,(t=r.clone()).startRow=t.endRow+1;a.data.getWorkBook(C,L).getSheetObj(m);var k={gridID:u,interacter:d,This:this};l.publish(v.Listener,D.Mouse.ScrollOutRowY,{GRIDID:u,CALLBACK:p.bind(k)});var y=a.view.getGridComponent(u);this.container.style.width=y.getWidth()+"px",n=function(t){if(27==t.keyCode){S=!1;var r=this.interacter.getResourceID(),i=this.interacter.getSheetID(),d=this.interacter.getVersion();l.publish(v.Listener,D.Layers.HeaderDrag.Remove,{RID:r,SHEETID:i,VERSION:d,ID:0}),c.classList.remove("grabbingCursor"),this.This.dragAndDropCueHolder.hide(),s.clearEvents();var g=a.view.getGridComponent(o),h=g.getWidths();this.This.container.style.width=h[0]+"px",e.removeEventListener("keydown",n)}}.bind(k),e.addEventListener("keydown",n),e.addEventListener("mouseup",I),s=R.call(k,f,A),this.dragAndDropCueHolder.hide()}};function I(){b(!1)}function f(e){var t=this.interacter.getGridID(),r=this.interacter.getResourceID(),i=this.interacter.getSheetID(),n=this.interacter.getVersion(),s=(h=a.view.getGridComponent(t)).translateCoordinates(e),d=this.This.getRelativeCoordinates(s.x,s.y),g=a.view.getSheetState(o,i).getZoom(),h=a.view.getGridComponent(t);this.This.container.style.width=h.getWidth()+"px",p.call(this,t,r,i,n,d.x*g,d.y*g)}function p(e,n,s,d,g,h){if(S){var c=a.view.getGridComponent(e),w=(a.data.getWorkBook(n,d).getSheetObj(s),c.interacter.findRow(h)),R=w+(t.endRow-t.startRow),u=a.data.Defaults.MAX_COL-1;R>=a.data.Defaults.MAX_ROW-1&&(w=(R=a.data.Defaults.MAX_ROW-1)-(t.endRow-t.startRow));var l=new ZSClass.Range(w,0,R,u),v=a.view.getSheetState(o,s).getZoom();h=Math.floor(h/v);var D=c.interacter.findRow(h),C=h-Math.round(c.interacter.getRowY(D))>=Math.round(c.interacter.getRowHeight(D)/2)?D+1:D;!(l.startRow>=r.startRow&&l.endRow+1<=r.endRow)&&(l.startRow=C,l.endRow=-1!=l.endRow?l.endRow:0,i=l,C>=r.startRow&&C-1<=r.endRow?m.call(this,l,!1):m.call(this,l,!0))}}function A(t){var o=this.interacter.getGridID(),s=this.interacter.getResourceID(),d=this.interacter.getSheetID(),g=this.interacter.getVersion(),c=a.view.getSheetState(o,d).getActiveCellRange();c.startRow,c.startCol;i.endRow=i.startRow;var R=a.view.getSelectedSheets(o),u=a.view.getGridComponent(this.gridID).getWidths();this.This.container.style.width=u[0]+"px",function(e,t,r,i,o,n){var s=a.data.getWorkBook(e,r).getSheetObj(t);if(b(!1),this.dragAndDropCueHolder.hide(),function(e,t){return e.MaxUsedRow+t>=h.MAX_ROW}(s,o.endRow-o.startRow+1))return void ZSClass.ZSAlert(w["InsertRow.Alert.InsertingNotPossibleBeyondMaxRow"],{title:w["Alert.Title.LimitExceeded"]});o.endRow!==n.endRow&&o.startRow!==n.startRow&&UserAction.InsertCutRow(e,i,r,new Array(n),!0,new Array(o))}.call(this.This,s,d,g,R,r,i),l.publish(v.Listener,D.Layers.HeaderDrag.Remove,{RID:s,SHEETID:d,VERSION:g,ID:0}),e.removeEventListener("keydown",n)}function m(e,t){if(t){var r,i=this.interacter.getGridID(),o=this.interacter.getResourceID(),n=this.interacter.getSheetID(),s=this.interacter.getVersion(),d=(a.data.getWorkBook(o,s).getSheetObj(n),a.view.getSheetState(i,n).Zoom);r=a.view.getGridComponent(i).interacter.getRowY(e.startRow),this.This.dragAndDropCueHolder.setTop(r*d),this.This.dragAndDropCueHolder.show()}else this.This.dragAndDropCueHolder.hide()}function b(e){e?c.classList.add("grabbingCursor"):c.classList.remove("grabbingCursor")}g.isDragAndDrop=function(e,t,r,i,o){var n=a.view.getSheetState(t,i).getActiveRange();return!(!a.data.getWorkBook(r,o).isEditable()||function(e,t,r){return a.data.getWorkBook(e,r).ProtectedSheets.isSheetLocked(t)}(r,i,o)||!n.isRow()||!function(e,t){var r=new ZSClass.Range(e,0,e,h.MAX_COL-1);return t.intersects(r)}(e,n)||function(e){return 0==e.startRow&&e.endRow==h.MAX_ROW-1}(n))},g.toggleGrabbingCursor=b,g.DragAndDrop=C}(this);
!function(e){var t=e.sPlusPlus,i=t.data.Defaults,o=e.Listener||(e.Listener={}),n=o.Row||(o.Row={}),w=n.Show||(n.Show={}),r={mousedown:function(e,o,n,w,r,s){o=t.view.getActiveGridID();var d=t.view.getGridComponent(o).interacter,a=d.findRow(s),g=(d.getRowHeight(a),d.getNextNonHiddenRow(a));g===i.MAX_ROW&&(g=i.MAX_ROW-1);var v=new ZSClass.Range(a,0,g,i.MAX_COL-1),R=t.view.getSelectedSheets(o);UserAction.HideRow(n,R,r,"SHOW",v)}},s={mousedown:function(e,o,n,w,r,s){o=t.view.getActiveGridID();var d=t.view.getGridComponent(o).interacter,a=d.findRow(s),g=(d.getRowHeight(a),d.getPrevNonHiddenRow(a));-1===g&&(g=0);var v=new ZSClass.Range(g,0,a,i.MAX_COL-1),R=t.view.getSelectedSheets(o);UserAction.HideRow(n,R,r,"SHOW",v)}};w.Top=r,w.Bottom=s}(this);
!function(e){var t,i,s,n=e.sPlusPlus,o=e.Listener||(e.Listener={}),r=o.Row||(o.Row={}),a=n.data.Defaults,h=document.body,g=e.JSUtil.Mouse.BindEvents,d=5,l={mousedown:function(e,o,r){var a=r.getResourceID(),d=r.getGridID(),l=r.getSheetID(d),v=r.getVersion(),R=n.data.getWorkBook(a,v).getSheetObj(l).Row.axis.getDim(o),p=r.getRowY(o),m=r.getRowHeight(o),f=n.view.getSheetState(d,l).getZoom(),S=(p+m)*f,D=(H=n.view.getGridComponent(d)).getXs();i=function(e,t,i,s,n){var o=document.createElement("div"),r=o.style;return r.position="absolute",r.top=t+"px",r.left=e+"px",r.width=i+"px",r.height=s+"px",r.backgroundColor=n,o}(D[1],S,window.innerWidth,1,"#999");var H=n.view.getGridComponent(d);this.container.style.width=H.getWidth()+"px",this.container.classList.add("rowResizeCursor"),this.container.appendChild(i),t=this.container,s=function(e,t,i){var s=document.createElement("div");s.className="rrzeHlpTxt";var n=s.style;return n.top=t+2+"px",n.left=e+2+"px",n.zIndex=2,s.setAttribute("data-check","Height : "+i+"px"),s}(D[1],S,R),this.container.appendChild(s);var x={gridID:d,container:this.container,resizer:i,This:this,denoterElement:s,y:e,initialHeight:R,finalHeight:m,initialRow:o,zoom:f,interacter:r};g.call(x,w,u),h.addEventListener("mouseup",c)},dblclick:function(e,t,i){var s=i.getGridID(),o=i.getResourceID(s),r=i.getSheetID(s),h=i.getVersion(s),g=n.view.getSelectedSheets(s),d=n.view.getSheetState(s,r).getActiveRange(),l=new ZSClass.Range(e,0,e,a.MAX_COL-1);d.subset(l)?UserAction.ResizeRow(o,g,h,t,d.startRow,d.getRowSpan(),!0,!0):UserAction.ResizeRow(o,g,h,t,e,1,!0,!1)}};function c(){h.removeEventListener("mouseup",c);var e=n.view.getGridComponent(n.view.getActiveGridID());t.style.width=e.getWidth()+"px",t.classList.remove("rowResizeCursor"),t.removeChild(i),t.removeChild(s)}function w(e){var t=this.interacter,i=n.view.getActiveGridID(),s=n.view.getGridComponent(i).translateCoordinates(e),o=this.This.getRelativeCoordinates(s.x,s.y).y,r=o-this.y;if(this.finalHeight=this.initialHeight+r,this.finalHeight<=0)this.resizer.style.top=o*h-this.finalHeight+"px",this.denoterElement.style.top=o*h-this.finalHeight+2+"px",this.finalHeight=0,this.denoterElement.setAttribute("data-check","Hide");else{var a=t.getSheetID(this.gridID),h=n.view.getSheetState(this.gridID,a).getZoom();this.resizer.style.top=o*h+"px",this.denoterElement.style.top=o*h+2+"px",this.finalHeight=Math.round(this.finalHeight),this.denoterElement.setAttribute("data-check","Height : "+this.finalHeight+"px")}}function u(e){var t=this.interacter,i=this.finalHeight,s=t.getResourceID(),o=t.getSheetID(),r=t.getVersion(),h=n.view.getSelectedSheets(this.gridID),g=n.view.getSheetState(this.gridID,o).getActiveRange(),d=new ZSClass.Range(this.initialRow,0,this.initialRow,a.MAX_COL-1);i?g.subset(d)?UserAction.ResizeRow(s,h,r,i,g.startRow,g.getRowSpan(),!1,!0):UserAction.ResizeRow(s,h,r,i,this.initialRow,1,!1,!1):g.subset(d)?UserAction.HideRow(s,h,r,"HIDE",g):UserAction.HideRow(s,h,r,"HIDE",d)}r.isResize=function(e,t,i,s,o,r){var a=n.data.getWorkBook(s,r);if(!a.isEditable()||function(e,t,i){return n.data.getWorkBook(e,i).ProtectedSheets.isSheetLocked(t)}(s,o,r))return!1;var h=a.getSheetObj(o),g=h.Row.axis.getDim(t);return e-h.Row.axis.getPos(t)>=g-d},r.Resize=l}(this);
!function(t){t.sPlusPlus.data.Defaults;var o=t.Listener||(t.Listener={}),n={mousedown:function(t,o,n){o.subset(n)&&t.stopPropagation(),UIUtil.Component.triggerEvent(t,document)}};(o.Row||(o.Row={})).DropDown=n}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSConstants.I18N,i=t.data.Defaults,r=e.ZSGrid.UIRowPane,n=e.UIHeaderContainer,s=e.Listener.Row,d=(document.body,e.ZSEvents),a=d.topic,h=d.Groups,u=d.Names,w=e.ZSGrid.Nodes,g=w.TopAndBottomHideCue,l=w.TopHideCue,c=t.view.measures;function C(e,t,o){this.root=o,r.call(this,e,t),this.cueholder=new UICueHolder,this.cueholder.setLeft(0),this.cueholder.setWidth(e.getWidth());var i=function(e){var t=new n;return t.setAttribute("context","MI_ROWHEAD_CONTEXT"),t.addClass("rowHeaderContainer"),t.setLeft(0),t.setWidth(e.getWidth()),c.Grid.RowHeader=e.getWidth(),t.hide(),t}(e);this.headerContainer=i;var d=v.call(this,e,S,p);this.bottomResizeCue=d;var a=v.call(this,e,D,m);this.topResizeCue=a;var h=function(){var e=new UIDropDown;return e.addClass("rDropDown"),e.dom.setAttribute("data-menu-id","MI_ROWHEAD_CONTEXT"),e}();this.dropDown=h,i.appendChild(h.getDom()),i.appendChild(d.getDom()),i.appendChild(a.getDom()),d.hide(),a.hide(),this.cueholder.appendChild(i.getDom());var u=f.call(this,s.Show.Top.mousedown);u.addClass("topShowCue rowShowCue"),u.hide(),this.topShowCue=u,this.cueholder.appendChild(u.getDom());var w=f.call(this,s.Show.Bottom.mousedown);w.addClass("bottomShowCue rowShowCue"),w.hide(),this.bottomShowCue=w,this.cueholder.appendChild(w.getDom());var g,l=((g=new UIDragAndDropHolder).addClass("dragAndDropCueRowHandler"),g);l.hide(),this.dragAndDropCueHolder=l,this.cueholder.appendChild(l.getDom()),this.container.appendChild(this.cueholder.getDom()),this.container.classList.add("rowPane"),this.addListener()}function v(e,o,i){var r=o(e),n=this,d=!1;return r.addListener("mousedown",function(e){e.stopPropagation();var o=n.getInteracter();if(d)d=!1;else{d=!0,setTimeout(function(){d=!1},350);var r=t.view.getActiveGridID(),a=t.view.getGridComponent(r);if(a){var h=a.translateCoordinates(e),u=n.getRelativeCoordinates(h.x,h.y),w=i(o,u.y);s.Resize.mousedown.call(n,u.y,w,o)}}}),r.addListener("dblclick",function(e){e.stopPropagation();var o=n.getInteracter(),d=t.view.getActiveGridID(),a=t.view.getGridComponent(d);if(a){var h=a.translateCoordinates(e),u=n.getRelativeCoordinates(h.x,h.y);r.hide();var w=i(o,u.y),g=o.getRowHeight(w);s.Resize.dblclick(w,g,o)}}),r.addListener("mouseover",function(e){r.addToClassList("rowResizeHover")}),r.addListener("mouseleave",function(e){r.removeFromClassList("rowResizeHover")}),r}function p(e,t){return e.findRow(t)}function m(e,t){var o=e.findRow(t),i=e.getPrevNonHiddenRow(o);return i<0?0:i}function R(e,t){return e.getNextNonHiddenRow(t)>=e.getMaxRow()}function S(e){var t=new UIResizeCue;return t.setWidth(e.getWidth()),t.addClass("bottomResizeCue rowResizeCue"),t}function D(e){var t=new UIResizeCue;return t.setWidth(e.getWidth()),t.addClass("topResizeCue rowResizeCue"),t}function f(e,i){var r=new UIShowCue;r.addTitle(o["Show.Rows"]);var n=this;return r.addListener("mousedown",function(o){var i=n.getInteracter();if(3!=o.which&&2!=o.button){var r=t.view.getActiveGridID(),s=t.view.getGridComponent(r);if(s){var d=i.getResourceID(),a=i.getSheetID(),h=i.getVersion(),u=s.translateCoordinates(o),w=n.getRelativeCoordinates(u.x,u.y);e.call(n,o,r,d,a,h,w.y),o.stopPropagation(),n.topShowCue.hide(),n.bottomShowCue.hide()}}}),r}C.prototype={getInteracter:function(){return this.root.getInteracter()},setContentDimension:function(e){r.prototype.setContentDimension.call(this,e),this.cueholder.setHeight(this.rect.getContentHeight())},addListener:function(e){var o=this,r=!1;g.setMouseOver(!0),l.setMouseOver(!0),this.container.addEventListener("mousemove",function(e){e.preventDefault();var n=o.getInteracter(),d=t.view.getActiveGridID(),a=t.view.getGridComponent(d);if(a){!r&&a.refreshHeaders(),r=!0;var h=o.headerContainer;h.show();var u=a.translateCoordinates(e),w=o.getRelativeCoordinates(u.x,u.y),g=n.findRow(w.y),l=n.getRowHeight(g),c=n.getRowY(g),C=o.rect.getScaleY();c*=C,l*=C,w.y-c<l/2?(o.bottomResizeCue.hide(),o.topResizeCue.show(),n.getPrevNonHiddenRow(g)<0&&o.topResizeCue.hide()):(o.bottomResizeCue.show(),o.topResizeCue.hide());d=n.getGridID();var v=n.getResourceID(),p=n.getSheetID(),m=n.getVersion(),S=t.data.getWorkBook(v,m).getSheetObj(p).Row.Filter;if(h.setTop(c),h.setHeight(l),a.isEditable()){var D=c/C,f=l/C;w.y<=D+7?n.getPrevNonHiddenRow(g)+1!==g&&S.prevNonHidden(g)+1===g&&g>0&&(o.topShowCue.show(),o.topShowCue.setTop(c-14),o.bottomShowCue.show(),o.bottomShowCue.setTop(c),R(n,g)&&o.bottomShowCue.hide()):w.y>=D+f-7?n.getNextNonHiddenRow(g)-1!==g&&S.nextNonHidden(g)-1===g&&g<i.MAX_ROW&&(o.topShowCue.show(),o.topShowCue.setTop(c+l-14),o.bottomShowCue.show(),o.bottomShowCue.setTop(c+l),R(n,g)&&o.bottomShowCue.hide()):(o.topShowCue.hide(),o.bottomShowCue.hide()),s.isDragAndDrop(g,d,v,p,m)?e.target.classList.add("grabCursor"):e.target.classList.remove("grabCursor")}}}),this.container.addEventListener("mouseleave",function(e){var i=o.getInteracter(),n=t.view.getActiveGridID(),s=t.view.getGridComponent(n);s&&(r&&s.refreshHeaders(i),r=!1,e.target.classList.remove("grabCursor"),o.headerContainer.hide(),o.topShowCue.hide(),o.bottomShowCue.hide(),this.style.width=o.rect.getWidth()+"px")}),this.cueholder.dom.addEventListener("mouseover",function(e){o.container.style.width=o.rect.getWidth()+window.innerWidth+"px"}),this.cueholder.dom.addEventListener("mouseleave",function(e){o.container.style.width=o.rect.getWidth()+"px"}),this.container.addEventListener("mousedown",function(e){e.preventDefault();var i=o.getInteracter(),r=t.view.getActiveGridID(),n=t.view.getGridComponent(r);if(n){var d=n.translateCoordinates(e),w=o.getRelativeCoordinates(d.x,d.y),g=(r=i.getGridID(),i.getResourceID()),l=i.getSheetID(),c=i.getVersion(),C=i.findRow(w.y),v=t.view.CellEditor;if(v&&v.getEditStatus()&&!ZSClass.RangePicker.isSelection()&&a.publish(h.Gesture.Selector.CellEdit,u.GESTURE.ACTION.ENUMERATE,{RID:g,SHEETID:l,VERSION:c,isSubmittable:1}),!ZSClass.RangePicker.isSelection()&&n.isEditable()&&s.isDragAndDrop(C,r,g,l,c)){var p=t.view.getSheetState(r,l).getActiveRange();s.DragAndDrop.mousedown.call(o,i,w.x,w.y,p)}else s.Selection.mousedown.call(o,e,r,g,l,c,w.y)}}),this.dropDown.dom.addEventListener("mousedown",function(e){var r=o.getInteracter(),n=t.view.getActiveGridID(),d=t.view.getGridComponent(n);if(d){var a=d.translateCoordinates(e),h=o.getRelativeCoordinates(a.x,a.y),u=(n=r.getGridID(),r.getResourceID()),w=r.getSheetID(),g=r.getVersion(),l=r.getActiveRange(w),c=r.getActiveRanges(),C=r.findRow(h.y),v=new ZSClass.Range(C,0,C,i.MAX_COL-1);s.DropDown.mousedown(e,l,v);for(var p=c.length-1;p>=0;p--)if(c[p].subset(v))return;e.stopPropagation(),s.Selection.mousedown.call(o,e,n,u,w,g,h.y)}})}},C.prototype=Object.assign({},r.prototype,C.prototype),ZSGrid.UISheetRowPane=C,ZSGrid.UIRowPane=C}(this);
!function(e){var t,i,r,s=e.sPlusPlus,o=s.data.Defaults,n=e.Listener||(e.Listener={}),l=n.Column||(n.Column={}),h=e.ZSEvents,a=h.topic,d=h.Groups,c=h.Names,g=e.JSUtil.Mouse.BindEvents,u={mousedown:function(e,n){var l=e.getResourceID(),h=e.getSheetID(),u=e.getVersion(),v=s.data.getWorkBook(l,u);if(!function(e,t,i){return s.data.getWorkBook(e,i).ProtectedSheets.isSheetLocked(t)}(l,h,u)&&v.isEditable()){var m=s.view.getGridComponent(sPlusPlus.view.getActiveGridID()),F=m.interacter.getColX(m.getFreezedCol()),p=m.getScrollYs();a.publish(d.Listener,c.SheetMeta.SCROLL_POSITION0,{RID:l,SHEETID:h,VERSION:u,SCROLLLEFT:F,SCROLLTOP:p[2]});var S=m.getWidths(),y=e.getColX(o.MAX_COL_FREEZE),z=v.getSheetObj(h),w={grid:m,interacter:e,rowHeaderWidth:S[0],colFreezeCue:this.colFreezeCue,finalFreeze:z.Column.FreezedCount,maxPos:y},D=e.getGridID(),L=s.view.getSheetState(D,h).getZoom(),x=e.getColX(n);t=function(e,i,r,s,o){var n=t;n||(n=document.createElement("div"));var l=n.style;return l.position="absolute",l.top=i+"px",l.left=e+"px",l.width=r+"px",l.height=s+"px",l.backgroundColor=o,n}(x*L+S[0],0,1,710,"#999"),this.container.appendChild(t),i=this.container,this.colFreezeCue.showBodyDom(),this.colFreezeCue.bodyDom.classList.add("vFCueMove"),r=function(){document.body.removeEventListener("mouseup",r),this.colFreezeCue.bodyDom.classList.remove("vFCueMove"),this.freezedCol||this.colFreezeCue.hideBodyDom();i.removeChild(t)}.bind(this),document.body.addEventListener("mouseup",r),g.call(w,C,f)}}};function C(e){var i,r=this.interacter.getFlip(),o=this.grid.translateCoordinates(e),n=function(){var e=s.view.getGridComponent(sPlusPlus.view.getActiveGridID()),t=e.rect,i=e.getWidths(),r=i[0],o=i[3];return{left:t.left+r,right:t.left+t.width-o}}(),l=this.interacter.getGridID(),h=this.interacter.getSheetID(),a=s.view.getSheetState(l,h).getZoom();if(r){var d,c=this.grid.getWidths();d=c[3]+c[2]+c[1],n.left=d,n.right=void 0,o.x>n.left?(i=0,t.style.display="none"):(t.style.display="",i=d-o.x,(i/=a)>this.maxPos&&(i=this.maxPos))}else n.left>o.x?(i=0,t.style.display="none"):(t.style.display="",i=o.x-n.left,(i/=a)>this.maxPos&&(i=this.maxPos));var g=this.interacter.findCol(i),u=this.interacter.getColX(g),C=this.interacter.getColWidth(g);this.colFreezeCue.setLeft(i*a+this.rowHeaderWidth,r),i>u+C/2?(this.finalFreeze=g+1,r?(t.style.left="",t.style.right=(u+C)*a+this.rowHeaderWidth+"px"):(t.style.left=(u+C)*a+this.rowHeaderWidth+"px",t.style.right="")):(this.finalFreeze=g,r?(t.style.left="",t.style.right=u*a+this.rowHeaderWidth+"px"):(t.style.left=u*a+this.rowHeaderWidth+"px",t.style.right=""))}function f(){var t=this.interacter.getFlip(),i=this.interacter.getResourceID(),r=this.interacter.getSheetID(),o=this.interacter.getVersion(),n=s.data.getWorkBook(i,o).getSheetObj(r),l=n.Column.FreezedCount;if(this.finalFreeze!==l){var h=s.view.getSelectedSheets(this.interacter.getGridID());e.UserAction.Freeze(i,h,o,n.Row.FreezedCount,this.finalFreeze)}var a=this.interacter.getGridID(),d=s.view.getSheetState(a,r).getZoom(),c=this.finalFreeze?this.interacter.getColX(this.finalFreeze)*d:this.interacter.getColX(this.finalFreeze);this.colFreezeCue.setLeft(c+this.rowHeaderWidth,t)}l.Freeze=u}(this);
!function(e){var t,i,o,r=e.sPlusPlus,s=r.data.Defaults,n=r.view.measures,a=e.Listener||(e.Listener={}),h=e.ZSEvents,g=h.topic,d=h.Groups,c=h.Names,l=a.Row||(a.Row={}),u=e.JSUtil.Mouse.BindEvents,p={mousedown:function(e,n,a){e.stopPropagation();var h=n.getResourceID(),l=n.getSheetID(),p=n.getVersion(),S=r.data.getWorkBook(h,p);if(!function(e,t,i){return r.data.getWorkBook(e,i).ProtectedSheets.isSheetLocked(t)}(h,l,p)&&S.isEditable()){var m=n.getGridID(),F=r.view.getGridComponent(sPlusPlus.view.getActiveGridID()),R=F.interacter.getRowY(F.getFreezedRow()),f=F.getScrollXs();g.publish(d.Listener,c.SheetMeta.SCROLL_POSITION0,{RID:h,SHEETID:l,VERSION:p,SCROLLLEFT:f[2],SCROLLTOP:R});var z=F.getHeights(),C=n.getRowY(s.MAX_ROW_FREEZE),D=S.getSheetObj(l),H={grid:F,interacter:n,colHeaderHeight:z[0],rowFreezeCue:this.rowFreezeCue,finalFreeze:D.Row.FreezedCount,maxPos:C},I=r.view.getSheetState(m,l).getZoom(),L=n.getRowY(a);t=function(e,i,o,r,s){var n=t;n||(n=document.createElement("div"));var a=n.style;return a.position="absolute",a.top=i+"px",a.left=e+"px",a.width=o+"px",a.height=r+"px",a.backgroundColor=s,n}(0,L*I+z[0],window.innerWidth,1,"#999"),this.container.appendChild(t),i=this.container,o=function(e){document.body.removeEventListener("mouseup",o),this.rowFreezeCue.bodyDom.classList.remove("hFCueMove"),this.freezedRow||this.rowFreezeCue.hideBodyDom();i.removeChild(t)}.bind(this),document.body.addEventListener("mouseup",o),u.call(H,w,v)}}};function w(e){var i,o,s,a,h,g,d=this.grid.translateCoordinates(e),c=(i=r.view.getGridComponent(sPlusPlus.view.getActiveGridID()),o=i.rect,s=i.getHeights(),a=s[0],h=s[3],{top:o.top+a-n.Top.Height,bottom:o.top+o.height-h-n.Top.Height}),l=this.interacter.getGridID(),u=this.interacter.getSheetID(),p=r.view.getSheetState(l,u).getZoom();c.top>d.y?(g=0,t.style.display="none"):(t.style.display="",g=d.y-c.top,(g/=p)>this.maxPos&&(g=this.maxPos));var w=this.interacter.findRow(g),v=this.interacter.getRowY(w),S=this.interacter.getRowHeight(w);this.rowFreezeCue.setTop(g*p+this.colHeaderHeight),g>v+S/2?(this.finalFreeze=w+1,t.style.top=(v+S)*p+this.colHeaderHeight+"px"):(this.finalFreeze=w,t.style.top=v*p+this.colHeaderHeight+"px")}function v(t){t.stopPropagation();var i=this.interacter.getResourceID(),o=this.interacter.getSheetID(),s=this.interacter.getVersion(),n=r.data.getWorkBook(i,s).getSheetObj(o),a=n.Row.FreezedCount;if(this.finalFreeze!==a){var h=r.view.getSelectedSheets(this.interacter.getGridID());e.UserAction.Freeze(i,h,s,this.finalFreeze,n.Column.FreezedCount)}var g=this.interacter.getGridID(),d=r.view.getSheetState(g,o).getZoom(),c=this.finalFreeze?this.interacter.getRowY(this.finalFreeze)*d:this.interacter.getRowY(this.finalFreeze);this.rowFreezeCue.setTop(c+this.colHeaderHeight)}l.Freeze=p}(this);
!function(t){var e=t.ZSGrid.UIVerticalScrollPane,o=t.ZSEvents,i=o.topic,s=o.Groups,r=o.Names;function n(t,o,n){this.root=n,e.call(this,t,o);var c=this;this.vScrollBar=new UIVScrollBar(this.container,this.scroller,function(e){var o=c.getInteracter();i.publish(s.UserAction,r.SheetAction.SCROLL_POSITION.Relativepane0,{RID:o.getResourceID(),SHEETID:o.getSheetID(),VERSION:o.getVersion(),DistanceX:0,DistanceY:this.scrollTop-t.getScrollY()+c.rect.getContentY()})}),this.container.classList.add("vScroll"),this.maxUsedRow=0}n.prototype={getInteracter:function(){return this.root.getInteracter()},setContentDimension:function(t){e.prototype.setContentDimension.call(this,t)},scroll:function(t,e,o){this.grid.scroll(t,e,o)},updateScroll:function(t,o){e.prototype.updateScroll.call(this,t);var i=this.rect.getHeight()+this.rect.getScrollY(),s=t.findRow(i);this.updateMaxUsed(t,s),o&&o()},checkMaxRowLimit:function(t,e){this.maxUsedRow>e&&(this.maxUsedRow=e,this.vScrollBar.setHeight(t.getRowY(e)))},updateMaxUsed:function(t,e){this.maxUsedRow<e&&(this.maxUsedRow=e,this.vScrollBar.setHeight(t.getRowY(e)))},addListener:function(){}},n.prototype=Object.assign({},e.prototype,n.prototype),ZSGrid.UIVerticalScrollPane=n}(this);
!function(t){function e(e,o,r){this.parent=e,this.scroller=o,this.onScroll=r,function(e,o){var r=this;this.parent.addEventListener("mousedown",function(e){n=r,r.onScroll&&(r.parent.onscroll=r.onScroll),t.addEventListener("mouseup",i)}),this.onScroll&&this.parent.addEventListener("mousewheel",o,!1),this.onScroll&&this.parent.addEventListener("DOMMouseScroll",o,!1)}.call(this,this.parent,r)}var n;function i(e){n.parent.onscroll=void 0,t.removeEventListener("mouseup",i)}e.prototype={setHeight:function(t){this.scroller.style.height=t+"px"},setScroll:function(e){var n=this.parent;t.cancelAnimationFrame(this.timerId),this.timerId=t.requestAnimationFrame(function(){n.scrollTop=e})},setContentHeight:function(t){this.setHeight(t)}},t.UIVScrollBar=e}(this);
!function(t){var e=t.ZSGrid.UIHorizontalScrollPane,o=t.ZSEvents,i=o.topic,r=o.Groups,l=o.Names;function s(t,o,s){this.root=s,e.call(this,t,o);var c=this;this.maxScrollableWidth=0,this.hScrollBar=new UIHScrollBar(this.container,this.scroller,function(e){var o,s=c.getInteracter();o=t.getFlip()?c.maxScrollableWidth-c.rect.getWidth()-this.scrollLeft-c.rect.getScrollX()+c.rect.getContentX():this.scrollLeft-c.rect.getScrollX()+c.rect.getContentX(),i.publish(r.UserAction,l.SheetAction.SCROLL_POSITION.Relativepane0,{RID:s.getResourceID(),SHEETID:s.getSheetID(),VERSION:s.getVersion(),DistanceX:o,DistanceY:0})}),this.container.classList.add("hScroll"),this.maxUsedCol=0}s.prototype={getInteracter:function(){return this.root.getInteracter()},setContentDimension:function(t){e.prototype.setContentDimension.call(this,t)},scroll:function(t,e,o){this.grid.scroll(t,e,o)},updateScroll:function(t,o){e.prototype.updateScroll.call(this,t);var i=this.rect.getWidth()+this.rect.getScrollX(),r=t.findCol(i);this.updateMaxUsed(t,r),o&&o()},checkMaxColLimit:function(t,e){this.maxUsedCol>e&&(this.maxUsedCol=e,this.hScrollBar.setWidth(t.getColX(e)))},updateMaxUsed:function(t,e){if(this.maxUsedCol<e){this.maxUsedCol=e;var o=t.getColX(e)+t.getColWidth(e);o=Math.min(o,this.rect.getContentWidth()),this.hScrollBar.setWidth(o),this.maxScrollableWidth=o}}},s.prototype=Object.assign({},e.prototype,s.prototype),t.ZSGrid.UIHorizontalScrollPane=s}(this);
!function(t){function n(n,o,s){this.parent=n,this.scroller=o,this.onScroll=s,function(n,o){var s=this;this.parent.addEventListener("mousedown",function(n){e=s,s.onScroll&&(s.parent.onscroll=s.onScroll),t.addEventListener("mouseup",i)}),this.onScroll&&this.parent.addEventListener("mousewheel",o,!1),this.onScroll&&this.parent.addEventListener("DOMMouseScroll",o,!1)}.call(this,this.parent,s)}var e;function i(n){e.parent.onscroll=void 0,t.removeEventListener("mouseup",i)}n.prototype={setWidth:function(t){this.width=t,this.scroller.style.width=t+"px"},setScroll:function(n){var e=this.parent;t.cancelAnimationFrame(this.timerId);var i=this;this.timerId=t.requestAnimationFrame(function(){e.scrollLeft=i.width-n})},setContentWidth:function(t){this.setWidth(t)}},t.UIHScrollBar=n}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSGrid.UISelectAllPane,r=ZSClass.SelectorHelper.Constants.TYPE,s=e.ZSEvents,o=s.topic,i=s.Groups,a=s.Names;function c(e,t){this.root=t,n.call(this,e),this.addListener()}c.prototype={getInteracter:function(){return this.root.getInteracter()},addListener:function(){var e=this;this.container.addEventListener("mousedown",function(t){t.preventDefault();var n=e.getInteracter(),s=(n.getGridID(),{RID:n.getResourceID(),SHEETID:n.getSheetID(),VERSION:n.getVersion(),ROWY:-1,COLX:-1,ACTIVEX:-1,ACTIVEY:-1,metaKey:t.metaKey,TYPE:r.SHEET});o.publish(i.Listener,a.Mouse.RangeDown,s)}),this.container.addEventListener("mouseup",function(n){var s=e.getInteracter(),c=s.getGridID(),u={RID:s.getResourceID(),SHEETID:s.getSheetID(),VERSION:s.getVersion(),RANGEID:0,ROWY:-1,COLX:-1,TYPE:r.SHEET};o.publish(i.Listener,a.Mouse.RangeEnd,u),t.view.getGridComponent(c).refreshHeaders(s)})},refresh:function(){}},c.prototype=Object.assign({},n.prototype,c.prototype),ZSGrid.UISelectAllPane=c}(this);
!function(t){var e=ZSGrid.Cell,n=ZSClass.DataCacheClasses||(ZSClass.DataCacheClasses={});new e(-1,0,0,null,null,null,null,"transparent",0);function s(t,e,n){var s;this.count=n-e+1,this.Cells=(s=this.count,new Array(s)),this.ContentBitSet=new ZSClass.Hidden(t,"COL"),this.start=e,this.end=n}s.prototype={clear:function(t,e){for(var n=t;n<=e;n++)delete this.Cells[n],this.ContentBitSet.onShow(n,1)},setBoundary:function(t){this.start=this.start>t?t:this.start,this.end=this.end<t?t:this.end},getColBoundary:function(){return{start:this.start,end:this.end}},clearAll:function(){s.call(this,this.count)},isFaulty:function(){for(var t=0;t<this.count;t++)if(!this.Cells[t])return!0;return!1},iterateAllRange:function(t,e,n,s,l){for(var i in this.Cells){var h=this.Cells[i];this.setCell(i,ZSClass.getCellObject(t,e,n,s,i,h.data,l))}},setCell:function(t,e,n){e.hasContent()?this.ContentBitSet.onHide(t,1):this.ContentBitSet.onShow(t,1),this.Cells[t]=e,n&&n()},getCell:function(t){return this.Cells[t]||null},isRequested:function(){return this.requested},setRequestStatus:function(t){this.requested=t},isExist:function(t){return!!this.Cells[t]},getNextContentIndex:function(t){return this.ContentBitSet.nextHidden(t)},getPrevContentIndex:function(t){return this.ContentBitSet.prevHidden(t)},iterate:function(t){for(var e in this.Cells){var n=this.Cells[e];n&&t(n)}},insertCol:function(t,e){(function(t,e){this.ContentBitSet.onInsert(t,e);for(var n=this.Cells.length-1;n>=t;n--)this.Cells[n]&&n+e<=this.count&&(this.Cells[n+e]=this.Cells[n],delete this.Cells[n]);for(var n=t;n<t+e;n++)delete this.Cells[n]}).call(this,t,e)},deleteCol:function(t,e){(function(t,e){this.ContentBitSet.onDelete(t,e);for(var n=t+e;n<this.Cells.length;n++)this.Cells[n]&&(this.Cells[n-e]=this.Cells[n]);for(var n=this.Cells.length-e;n<this.Cells.length;n++)delete this.Cells[n]}).call(this,t,e)},hideCol:function(t,e){(function(t,e){for(var n=t;n<t+e;n++)delete this.Cells[n]}).call(this,t,e)},reset:function(){s.call(this,this.count)}},n.Row=s}();
!function(t){var e=t.ZSClass,o=e.DataCacheClasses||(e.DataCacheClasses={}),i=o.Row,s=sPlusPlus.data.Defaults.MAX_COL;function r(t,e,o,i){this.start=t,this.end=e,this.startCol=o,this.endCol=i,this.Store={}}r.prototype={fetchRows:function(t,e){for(var o=[],i=0;i<e.length;i++){var s=e[i];this.isRowAvailable(s)||(o.push(s),this.createRow(s))}o.length>0&&t(o)},iterateAllRange:function(t,e,o,i){for(var s in this.Store){this.Store[s].iterateAllRange(t,e,o,s,i)}},isRowAvailable:function(t){return!!this.Store[t]},createRow:function(t){var e=s-1,o=this.startCol,r=this.endCol;this.Store[t]=new i(e,o,r)},setCell:function(t,e,o,i){this.isRowAvailable(t)||this.createRow(t);var s=this.getRow(t);s&&s.setCell(e,o,i)},getCell:function(t,e){var o=this.getRow(t);return o?o.getCell(e):null},getRow:function(t){return this.Store[t]||null},setRow:function(t,e){this.Store[t]=e},deleteRow:function(t){delete this.Store[t]},getOrderedKeys:function(){var t=Object.keys(this.Store);return t.sort(function(t,e){return~~t-~~e}),t},insertCol:function(t,e){for(var o in this.Store){this.Store[o].insertCol(t,e)}},deleteCol:function(t,e){for(var o in this.Store){this.Store[o].deleteCol(t,e)}},hideCol:function(t,e){for(var o in this.Store){this.Store[o].hideCol(t,e)}}},o.Page=r}(this);
!function(t){var e,i=sPlusPlus,n=ZSClass.DataCacheClasses||(ZSClass.DataCacheClasses={}),s=i.data.Defaults,o=s.MAX_COL,a=(s.MAX_ROW,t.JSUtil),r=t.ZSClass.Range,h=n.Row,l=new ZSGrid.Cell(-1,0,0,null,null,null,null,"transparent",0);function d(t,e,i,n,s,o){this.rID=t,this.sheetID=e,this.version=i,this.fetcher=n,this.viewportCallBack=s,this.RefreshGrid=w,this.loaderCallBack=o,this.isRefreshGridRequested=!1,this.Panes={},this.Rows={},this.MergeCache={},this.Boundary={}}function u(t,e,n,s,o,a,r){var h=i.data.getWorkBook(t,n).getSheetObj(e),l=s.startRow,d=s.endRow;if(h.Row.Visibility.isHidden(l)&&(l=h.Row.Visibility.nextNonHidden(l)),!(l>d)){var u=[],R=[],f=s.startCol,w=s.endCol;f=h.Column.hidden.isHidden(f)?h.Column.hidden.nextNonHidden(f):f,w=h.Column.hidden.isHidden(w)?h.Column.hidden.prevNonHidden(w):w;for(var C=f;C<=w;C=h.Column.hidden.nextNonHidden(C))u.push(C);for(C=l=h.Row.Visibility.isHidden(l)?h.Row.Visibility.nextNonHidden(l):l;C<=d;C=h.Row.Visibility.nextNonHidden(C))R.push(C);r&&(u=u.concat(r)).sort(function(t,e){return t-e}),this.updateNotAvailableData(t,e,n,R,u,o,a,{sC:u[0],eC:u[u.length-1]})}}function R(t){var e=this.getBoundary();return!e||e.startCol<=t&&e.endCol>=t}function f(t){clearTimeout(e),e=setTimeout(function(){t&&t()},100)}function w(t){var e=i.view.getActiveGridID(),n=i.view.getGridComponent(e);n&&n.refresh()}function C(t,e){for(var i in e){var n=e[i];t.includes(n)||t.push(n)}return t}d.prototype={setPane:function(t,e,n,s,o){var a=Math.max(i.data.Defaults.MIN_ROW,8*Math.floor(o.startRow/8)),h=Math.min(i.data.Defaults.MAX_ROW-1,8*Math.ceil(o.endRow/8));o=new r(a,o.startCol,h,o.endCol),this.Panes[s]=o},removePane:function(t){this.Panes[t]&&delete this.Panes[t]},load:function(t,e,n,s){var a=i.view.getActiveGridID(),r=[],h=[];for(var l in this.Panes){var d=this.Panes[l];r.push(d),h.push(new ZSClass.Range(d.startRow,0,d.endRow,o-1))}var u=this;this.viewportCallBack(t,e,n,h,!1,!0,a,r,function(i){!s&&i.isSameViewPort||(u.getMergedCells(t,e,n,i.MergedRanges),function(t,e,i,n,s){UserAction.getNextDataCell(t,e,i,n,function(t){var e=function(t){var e=[];for(var i in t){var n=t[i];-1==e.indexOf(n)&&e.push(n)}return e}(t);s(e)})}(t,e,n,r,function(i){u.getRows(t,e,n,r,void 0,i)}),u.loaderCallBack())})},isIntersectedWithDataRange:function(t){var e=this.getBoundary();return!(!e||e.startCol!=t.startCol||e.endCol!=t.endCol)},getRows:function(t,e,i,n,s,o){var a={};for(var r in n){var h=n[r];u.call(this,t,e,i,h,a,s,o)}this.Rows=a},getMergedCells:function(t,e,i,n){var s={};for(var r in n){var h=n[r],d=h.startRow,u=h.startCol,R=a.Math.hash(d,u,o);this.MergeCache[R]?s[R]=this.MergeCache[R]:(s[R]=l,this.updateMergeCell(t,e,i,d,u))}this.MergeCache=s},updateMergeCell:function(t,e,i,n,s){var r=this,h=a.Math.hash(n,s,o);r.fetcher(t,e,i,[n],[s],function(t,e,i){r.MergeCache[h]=i},function(){f(function(){r.refreshGrid()})})},loadBoundaryRange:function(t,e,n,s,o){(function(t,e,n,s,o){var a=i.data.getWorkBook(t,n).getSheetObj(e),r=s.startRow,h=s.endRow;a.Row.Visibility.isHidden(r)&&(r=a.Row.Visibility.nextNonHidden(r));if(r>h)return;for(var l=[],d=[],u=s.startCol,f=s.endCol,w=u=a.Column.hidden.isHidden(u)?a.Column.hidden.nextNonHidden(u):u;w<=f;w=a.Column.hidden.nextNonHidden(w))R.call(this,w)&&l.push(w);for(var w=r=a.Row.Visibility.isHidden(r)?a.Row.Visibility.nextNonHidden(r):r;w<=h;w=a.Row.Visibility.nextNonHidden(w))this.Rows[w]&&d.push(w);d.length&&l.length&&this.updateDataRange(t,e,n,d,l,o,{sC:l[0],eC:l[l.length-1]})}).call(this,t,e,n,s,o)},loadRange:function(t,e,n,s){(function(t,e,n,s){var o=i.data.getWorkBook(t,n).getSheetObj(e),a=s.startRow,r=s.endRow;o.Row.Visibility.isHidden(a)&&(a=o.Row.Visibility.nextNonHidden(a));if(a>r)return;for(var h=[],l=[],d=s.startCol,u=s.endCol,R=d=o.Column.hidden.isHidden(d)?o.Column.hidden.nextNonHidden(d):d;R<=u;R=o.Column.hidden.nextNonHidden(R))h.push(R);for(var R=a=o.Row.Visibility.isHidden(a)?o.Row.Visibility.nextNonHidden(a):a;R<=r;R=o.Row.Visibility.nextNonHidden(R))l.push(R);l.length&&this.updateDataRange(t,e,n,l,h,void 0,{sC:h[0],eC:h[h.length-1]})}).call(this,t,e,n,s)},iterateAllRange:function(t){for(var e in this.Panes){var i=this.Panes[e];i&&this.loadBoundaryRange(this.rID,this.sheetID,this.version,new ZSClass.Range(i.startRow,i.startCol,i.endRow,i.endCol))}},iterateRange:function(t,e){for(var n=i.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),s=n.Row.Visibility.isHidden(t.startRow)?n.Row.Visibility.nextNonHidden(t.startRow):t.startRow,o=n.Column.hidden.isHidden(t.startCol)?n.Column.hidden.nextNonHidden(t.startCol):t.startCol,a=s;a<=t.endRow;a=n.Row.Visibility.nextNonHidden(a))if(this.isRowAvailable(a))for(var r=this.getRow(a),h=o;h<=t.endCol;h=n.Column.hidden.nextNonHidden(h))if(r.isExist(h)){var l=r.getCell(h);r.setCell(h,ZSClass.getCellObject(this.rID,this.sheetID,this.version,a,h,l.data,e))}for(var d in this.MergeCache){h=d%256;if(s<=(a=Math.floor(d/256))&&a<=t.endRow&&o<=h&&h<=t.endCol){l=this.MergeCache[d];this.MergeCache[d]=ZSClass.getCellObject(this.rID,this.sheetID,this.version,a,h,l.data,e)}}},updateDataRange:function(t,e,i,n,s,o,a){var r=this;this.fetcher(t,e,i,n,s,r.setCell.bind(r,a.sC,a.eC),function(){o?o(t,e,i):f(function(){r.refreshGrid(n)})})},updateNotAvailableData:function(t,e,i,n,s,o,a,r){for(var h=[],l=[],d=0;d<n.length;d++){var u=n[d];if(this.isRowAvailable(u))for(var R=0;R<s.length;R++){var f=s[R],w=this.getCell(u,f);w?o&&(o[u]?(o[u].setBoundary(f),o[u].setCell(f,w)):(o[u]=this.createRow(r.sC,r.eC),o[u].setCell(f,w))):(!l.includes(f)&&l.push(f),-1==h.indexOf(u)&&h.push(u))}else h.push(u),l=C(l,s)}h.length>0||l.length>0?this.updateDataRange(t,e,i,h,s,void 0,r):a&&a()},reload:function(t,e,i){var n=this.getBoundary();for(var s in this.Panes){n=this.Panes[s];this.loadRange(t,e,i,new ZSClass.Range(n.startRow,n.startCol,n.endRow,n.endCol))}},getBoundary:function(){var t=this.getOrderedKeys(),e=t.length;if(e){var i=~~t[0],n=~~t[e-1];return{start:i,end:n,startCol:this.Rows[i].getColBoundary().start,endCol:this.Rows[n].getColBoundary().end}}},setCell:function(t,e,i,n,s){var o=this.Rows;o[i]?o[i].setBoundary(t,e):o[i]=this.createRow(t,e),o[i].setCell(n,s)},isRowAvailable:function(t){return!!this.getRow(t)},refreshGrid:function(t){this.RefreshGrid(t)},getCell:function(t,e){var i=a.Math.hash(t,e,o);if(this.MergeCache[i])return this.MergeCache[i];var n=this.getRow(t);return n?n.getCell(e):null},getRow:function(t){return this.Rows[t]},createRow:function(t,e){return new h(o-1,t,e)},removeRow:function(t){delete this.Rows[t]},setRow:function(t,e,i,n){this.isRowAvailable||(this.Rows[t]=this.createRow(i,n)),this.Rows[t]=e},getOrderedKeys:function(){var t=Object.keys(this.Rows);return t.sort(function(t,e){return~~t-~~e}),t},getNextContentIndex:function(t,e){return this.isRowAvailable(t)?this.getRow(t).getNextContentIndex(e):null},getPrevContentIndex:function(t,e){return this.isRowAvailable(t)?this.getRow(t).getPrevContentIndex(e):null},isInViewPort:function(t,e,i,n){var s=new ZSClass.Range(t,e,i,n);for(var o in this.Panes){if(this.Panes[o].subset(s))return!0}return!1},isViewPortIntersects:function(t,e,i,n){var s=new ZSClass.Range(t,e,i,n);for(var o in this.Panes){if(this.Panes[o].intersects(s))return!0}return!1},updateCells:function(t,e,i,n,s,o){if(this.isRowAvailable(n)){var a=ZSClass.getCellObject(t,e,i,~~n,~~s,o);this.Rows[n].setCell(s,a)}},hideRow:function(t,e){for(var i=t;i<t+e;i++)this.isRowAvailable(i)&&this.removeRow(i)},hideCol:function(t,e){for(var i in this.Rows){this.Rows[i].hideCol(t,e)}},onAfterShowCol:function(t){for(var e in this.Panes){var i=this.Panes[e];this.loadRange(this.rID,this.sheetID,this.version,new ZSClass.Range(i.startRow,t,i.endRow,i.endCol))}},onAfterShowRow:function(){for(var t in this.Panes){var e=this.Panes[t];this.loadRange(this.rID,this.sheetID,this.version,new ZSClass.Range(e.startRow,e.startCol,e.endRow,e.endCol))}},insertRow:function(t,e){(function(t,e){for(var i=this.getOrderedKeys(),n=i.length-1;n>=0;n--){var s=~~i[n];if(s<t)return;if(this.isRowAvailable(s)){var o=this.getRow(s);this.setRow(s+e,o,o.start,o.end),this.removeRow(s)}}}).call(this,t,e)},onAfterInsertRow:function(t){this.getBoundary();for(var e in this.Panes){var i=this.Panes[e];this.loadRange(this.rID,this.sheetID,this.version,new ZSClass.Range(i.startRow,i.startCol,i.endRow,i.endCol))}},deleteRow:function(t,e){(function(t,e){for(var i=t;i<t+e;i++)this.isRowAvailable(i)&&this.removeRow(i);for(var n=this.getOrderedKeys(),s=0;s<n.length;s++){var o=~~n[s];if(!(o<t+e)&&this.isRowAvailable(o)){var a=this.getRow(o);this.setRow(o-e,a,a.start,a.end),this.removeRow(o)}}}).call(this,t,e)},insertCol:function(t,e){for(var i in this.Rows){this.Rows[i].insertCol(t,e)}this.getBoundary();var n=t+e-1;for(var i in this.Panes){var s=this.Panes[i];this.loadRange(this.rID,this.sheetID,this.version,new ZSClass.Range(s.startRow,t,s.endRow,n))}},deleteCol:function(t,e){for(var i in this.Rows){this.Rows[i].deleteCol(t,e)}for(var i in this.Panes){var n=this.Panes[i],s=n.endCol;this.loadRange(this.rID,this.sheetID,this.version,new ZSClass.Range(n.startRow,s-e+1,n.endRow,s))}}},n.DataCache=d}(this);
!function(e){if(e.isCanvasGrid){var t,r=e.ZSClass,n=e.sPlusPlus,a=n.data.Defaults,o=e.ZSEvents,i=o.topic,E=o.Groups,R=o.Names,s=e.ZSDevTools.Logger,S=(n.view.measures,e.ZSConstants.CommandConstants),g=(a=n.data.Defaults).MAX_COL,I=a.MAX_ROW,D=r.DataCacheClasses,A={};e.getDataCache=c,i.register(E.Listener,R.GridAction.RELOAD,function(e,t){var r=n.view.getActiveGridID(),a=n.view.getSheetID(r);c(e,a,t).reload(e,a,t)},"RID","VERSION"),i.register(E.Listener,R.ServerAction.PROCESSTRIMCELLRESPONSE,function(e,a,o,i,E,R){var s=c(e,a,o),S=s.getBoundary(),g=n.data.getWorkBook(e,o).getSheetObj(a);if(S)for(var I=i.length-1;I>=0;I--){var D=i[I],A=D[0]+D[1]-1;A=A>n.data.Defaults.MAX_ROW?n.data.Defaults.MAX_ROW:A;for(var f=D[0],u=E[D[2]],v=u.length-1;v>=0;v--){var O=u[v];if(O){var T=O[0]+O[1]-1;T=T>n.data.Defaults.MAX_COL?n.data.Defaults.MAX_COL:T;var L=O[0],h=new r.Range(f,L,A,T);if(d(e,a,o,h)&&s.loadBoundaryRange(e,a,o,h,l),t){var N=g.DataValidation.getIntersectedRanges(h);t(e,a,o,R,N)}}}}},"DOCID","SHEETID","VERSION","ROW_DATA","COLUMN_DATA","XAID","CONDITIONAL_FORMAT"),i.register(E.Listener,R.ServerAction.PROCESSTRIMFAULTYRESPONSE,O,"DOCID","SHEETID","VERSION","RANGES","CELLS","XAID"),i.register(E.Listener,R.ServerAction.PROCESSCFRESPONSE,function(e,t,n,a,o,i,E){var R=c(e,t,n);if(R.getBoundary()){for(var s in a){var S=a[s];d(e,t,n,S=new r.Range(S[0],S[1],S[2],S[3]))&&R.loadBoundaryRange(e,t,n,S,l)}O(e,t,n,o,i)}},"DOCID","SHEETID","VERSION","META","FAULTY_RANGES","FAULTY_CELLS","XAID"),i.register(E.Listener,R.SheetAction.SPARKLINES.INSERT,function(e,t,a,o){for(var s=n.data.getWorkBook(e,a).getSheetObj(t).sparklines.getAllRanges(),S=0;S<o.length;S++){var g=o[S];for(var I in s){var D=s[I].properties;if(D.id==g)for(var A=D.outputRange,f=0;f<A.length;f++)for(var u=A[f],l=u[0];l<=u[2];l++)for(var v=u[1];v<=u[3];v++){var O=new r.Range(l,v,l,v);c(e,t,a).loadBoundaryRange(e,t,a,O)}}}i.publish(E.UI,R.SidePanel.Sparklines.CREATE)},"RID","SHEETID","VERSION","DATA"),i.register(E.Listener,R.SheetAction.SPARKLINES.DATA,function(e,t,n,a){for(var o=0;o<a.length;o++){var i=a[o],E=i[0][0],R=i[0][1],s=(i[0][2],new r.Range(E,R,E,R));c(e,t,n).loadBoundaryRange(e,t,n,s)}},"RID","SHEETID","VERSION","DATA"),i.register(E.Listener,R.SheetAction.SPARKLINES.MODIFY,function(t,a,o,i){for(var E=n.data.getWorkBook(t,o).getSheetObj(a).sparklines.RangeList,R=0;R<i.length;R++)for(var s=i[R],S=s[0],g=(s[1],E.getLeafNode(S.sr,S.sc,S.er,S.ec)[0].outputRange),I=0;I<g.length;I++)for(var D=g[I],A=D[0];A<=D[2];A++)for(var f=D[1];f<=D[3];f++)S=new r.Range(A,f,A,f),c(t,a,o).loadBoundaryRange(t,a,o,S);e.JSUtil.SparklinePool.highlightRanges(t,a,o)},"RID","SHEETID","VERSION","PROPS"),i.register(E.Listener,R.SheetAction.SPARKLINES.EDIT_GROUP,function(e,t,a,o){for(var i=n.data.getWorkBook(e,a).getSheetObj(t).sparklines.getAllRanges(),E={},R=0;R<o.length;R++)E[(S=o[R])[0]]=!0;for(var s in i){var S;if(1!=E[(S=i[s].properties)[R]])for(var g=S.outputRange,I=0;I<g.length;I++)for(var D=g[I],A=D[0];A<=D[2];A++)for(var f=D[1];f<=D[3];f++){var u=new r.Range(A,f,A,f);c(e,t,a).loadBoundaryRange(e,t,a,u)}}},"RID","SHEETID","VERSION","DATA"),i.register(E.Listener,R.SheetAction.SPARKLINES.REMOVE,function(t,a,o,i){n.data.getWorkBook(t,o).getSheetObj(a);for(var E=0;E<i.length;E++)for(var R=i[E],s=R[0];s<=R[2];s++)for(var S=R[1];S<=R[3];S++){var g=new r.Range(s,S,s,S);c(t,a,o).loadBoundaryRange(t,a,o,g)}e.JSUtil.SparklinePool.highlightRanges(t,a,o)},"RID","SHEETID","VERSION","REMOVE"),i.register(E.Listener,R.SheetAction.SPARKLINES.UNDO,function(e,t,n,a){for(var o=0;o<a.length;o++)for(var i=a[o],E=i[0];E<=i[2];E++)for(var R=i[1];R<=i[3];R++){var s=new r.Range(E,R,E,R);c(e,t,n).loadBoundaryRange(e,t,n,s)}},"RID","SHEETID","VERSION","META"),i.register(E.Listener,R.SheetAction.SPARKLINES.EXTREMES,function(e,t,a,o){for(var i in n.data.getWorkBook(e,a).getSheetObj(t).sparklines.getAllRanges(),o){var E=o[i][0],R=sparklineInfo.getLeafNode(E.sr,E.sc,E.er,E.ec)[0].outputRange;for(i=0;i<R.length;i++)for(var s=R[i],S=s[0];S<=s[2];S++)for(var g=s[1];g<=s[3];g++)E=new r.Range(S,g,S,g),c(e,t,a).loadBoundaryRange(e,t,a,E)}},"RID","SHEETID","VERSION","EXTREMES"),i.register(E.Listener,R.SheetAction.ROW_HEADERS.INSERT,function(e,t,r,n,a){c(e,t,r).insertRow(n,a)},"RID","SHEETID","VERSION","start","count"),i.register(E.Listener,R.SheetAction.ROW_HEADERS.DELETE,function(e,t,r,n,a){c(e,t,r).deleteRow(n,a)},"RID","SHEETID","VERSION","start","count"),i.register(E.Listener,R.SheetAction.ROW_HEADERS.ONAFTERINSERT,function(e,t,r,n){c(e,t,r).onAfterInsertRow(n)},"RID","SHEETID","VERSION","start"),i.register(E.Listener,R.SheetAction.COLUMN_HEADERS.INSERT,function(e,t,r,n,a){c(e,t,r).insertCol(n,a)},"RID","SHEETID","VERSION","start","count"),i.register(E.Listener,R.SheetAction.COLUMN_HEADERS.DELETE,function(e,t,r,n,a){c(e,t,r).deleteCol(n,a)},"RID","SHEETID","VERSION","start","count"),i.register(E.Listener,R.SheetAction.COLUMN_HEADERS.RESIZE.ENUMERATE,function(e,t,n,a,o){var i=c(e,t,n),E=new r.Range(0,a,I-1,a+o-1);i.iterateRange(E,function(){}),i.refreshGrid()},"RID","SHEETID","VERSION","START","COUNT"),i.register(E.Listener,R.SheetAction.HIDEROWS.ADD,function(e,t,r,n,a){c(e,t,r).hideRow(n,a)},"RID","SHEETID","VERSION","start","count"),i.register(E.Listener,R.SheetAction.HIDECOLS.ADD,function(e,t,r,n,a){c(e,t,r).hideCol(n,a)},"RID","SHEETID","VERSION","start","count"),i.register(E.Listener,R.UserAction.DATA_VALIDATION.HIGHLIGHT_INVALID_CELLS,function(e,t,a,o){var i=c(e,t,a),E=n.view.getActiveGridID(),R=(n.view.getGridComponent(E),n.data.getWorkBook(e,a),i.getBoundary()),s=new r.Range(R.start,R.startCol,R.end,R.endCol);i.loadBoundaryRange(e,t,a,s)},"RID","SHEETID","VERSION","INVALID_CELLS"),i.register(E.Listener,R.DocMeta.PIVOT,function(e,t,a){var o=n.view.getActiveGridID(),i=n.view.getGridComponent(o),E=i.interacter.getSheetID();for(var R in a){var s=a[R][S.TARGET];if(E===s[0]){var g=c(e,s[0],t),I=new r.Range(s[1],s[2],s[3],s[4]);g.iterateRange(I,function(){}),i.refresh()}}},"RID","VERSION","PIVOT"),i.register(E.Listener,R.SheetAction.DATAVALIDATION.UPDATEDOM,function(e,r,n){n&&(t=function(e,r,n,a,o){for(var i in o)"INTERRUPT"==o[i].properties.messageType&&(UserAction.revokeLastAction(e,r,n,a),t=void 0)})},"RESOURCE_ID","VERSION","STATE"),i.register(E.Listener,R.DocAction.WORKSHEETS.DELETE,function(e,t,r){for(var n=0,a=r.length;n<a;n++){var o=r[n][0];delete A[e][t][o]}},"RID","VERSION","DELETE"),i.register(E.Listener,R.SheetAction.HIDEROWS.ON_AFTER_REMOVE,function(e,t,r,n){c(e,t,r).onAfterShowRow()},"RID","SHEETID","VERSION","start"),i.register(E.Listener,R.SheetAction.HIDECOLS.ON_AFTER_REMOVE,function(e,t,r,n){c(e,t,r).onAfterShowCol(n)},"RID","SHEETID","VERSION","start"),i.register(E.Listener,R.SheetAction.PICKLIST.REDRAW,function(e,t,n,a){var o=c(e,t,n);for(var i in a){var E=a[i],R=new r.Range(E[0],E[1],E[2],E[3]);d(e,t,n,R)&&o.loadBoundaryRange(e,t,n,R,l)}},"RID","SHEETID","VERSION","DATA")}function c(t,r,n){return A[t]||(A[t]={}),A[t][n]||(A[t][n]={}),A[t][n][r]?A[t][n][r]:(A[t][n][r]=new D.DataCache(t,r,n,u,e.UserAction.prefetchData,f),A[t][n][r])}function f(){var t=e.ZSEvents,r=t.topic,n=t.Groups,a=t.Names;r.publish(n.UI,a.Layout.DATA_LOADER.HIDE)}function u(e,t,a,o,i,E,R,s){var S=function(n){for(var o in n){var i=n[o];for(var s in i){var S=i[s],g=r.getCellObject(e,t,a,~~o,~~s,S);E(o,s,g)}}R(n)}.bind(this),g=function(e){}.bind(this),I=n.view.getActiveGridID();n.view.fetchData(e,t,a,o,i,["ActualValue","DisplayValue","Format","Formula","ConditionalFormat","CellComment","Hyperlink","CellType","patternColor","Pattern","IsContentValid","hasLink","isCheckbox","Picklist","repeatIndex","repeatChar"],I,S,g)}function l(e,t,r){var n=c(e,t,r);!n.isRefreshGridRequested&&n.RefreshGrid()}function v(e){var t=e[0],r=e[1],n=e[2],a=e[3];return t<0&&(s.log("Flaw :: Wrong range as input... correcting in DataBinder...",e),t=0),r<0&&(s.log("Flaw :: Wrong range as input... correcting in DataBinder...",e),r=0),n>=I&&(s.log("Flaw :: Wrong range as input... correcting in DataBinder...",e),n=I-1),a>=g&&(s.log("Flaw :: Wrong range as input... correcting in DataBinder...",e),a=g-1),[t,r,n,a]}function O(e,t,a,o,i,E){!a&&(a=n.data.Defaults.version);var R=c(e,t,a);if(R.getBoundary()){for(var s in o){o[s]=v(o[s]),d(e,t,a,S=new r.Range(o[s][0],o[s][1],o[s][2],o[s][3]))&&R.loadBoundaryRange(e,t,a,S,l)}for(var s in i){var S,I=parseInt(i[s]/g),D=i[s]%g;d(e,t,a,S=new r.Range(I,D,I,D))&&R.loadBoundaryRange(e,t,a,S,l)}}}function d(e,t,r,n){var a=c(e,t,r).Panes;for(var o in a){var i=a[o];if(n.intersects(i))return!0}return!1}}(this);
!function(e){if(e.isCanvasGrid){var a,t=e.ZSClass,n=e.sPlusPlus,R=n.data.Defaults,T=e.ZSEvents,o=T.topic,r=T.Groups,E=T.Names,O=(e.ZSDevTools.Logger,n.view.measures,t.Range),c=e.ZSConstants.ActionConstants,i=(R=n.data.Defaults).MAX_ROW,s=R.MAX_COL,C="",L={BACKGROUNDCOLOR:0,COLOR:1,FONTSIZE:2,FONTNAME:3,FONTWEIGHT:4,FONTSTYLE:5,TEXTLINETHROUGHTSTYLE:6,TEXTUNDERLINESTYLE:7,TEXTWRAP:8,HALLIGN:9,VALLIGN:10,BORDER:11,HIDETEXT:12,ICONSET:13},N={NONE:12,LEFT:13,RIGHT:14,TOP:16,BOTTOM:17,OUTSIDE:19,VERTICAL:20,HORIZONTAL:22,INSIDE:24,ALL:25},I={LEFT:0,RIGHT:1,TOP:2,BOTTOM:3};o.register(r.Listener,E.GridAction.CLIENTFIRSTACTIONS,function(e,a,n,R,T,o){var r=R.action?R.action:R,E=getDataCache(e,a,n);switch(r){case"RESIZECOL":for(var O in T){var c=new t.Range(0,T[O].startCol,i-1,T[O].endCol);E.iterateRange(c,function(){})}case"RESIZEROW":return void E.refreshGrid()}for(O=0;O<T.length;O++)l(e,a,n,R,c=T[O],o);E.refreshGrid()},"RID","SHEETID","VERSION","ACTION","RANGELIST","VALUE")}function l(e,t,R,T,o,r){var E=T.action?T.action:T,O=getDataCache(e,t,R);if(E!==c.BORDERS){n.data.getWorkBook(e,R).getSheetObj(t);O.iterateRange(o,function(e,a,t,n,R,T,o){switch(E){case"SUBMIT":for(var O=!1,i=["FLOAT","NUMBER","CURRENCY","DATE","TIME","DATETIME","PERCENTAGE","FRACTION","SCIENTIFIC"],s=0;s<i.length;s++)if(T.CellType===i[s]){O=!0;break}O||!isNaN(r)&&"STRING"!==T.CellType?(!o[L.HALLIGN]&&(o[L.HALLIGN]=2),T.CellType="FLOAT"):T.CellType="STRING",T.DisplayValue=r,T.ActualValue=r,T.Pattern=void 0;break;case c.COLOR:o[L.BACKGROUNDCOLOR]=r;break;case c.TEXTCOLOR:o[L.COLOR]=r;break;case c.FONTFAMILY:o[L.FONTNAME]=r;break;case c.BOLD:o[L.FONTWEIGHT]=r?"bold":"";break;case c.ITALIC:o[L.FONTSTYLE]=r?"italic":"";break;case c.STRIKETHROUGH:o[L.TEXTLINETHROUGHTSTYLE]=!!r;break;case c.UNDERLINE:o[L.TEXTUNDERLINESTYLE]=!!r;break;case c.FONTSIZE:o[L.FONTSIZE]=parseInt(r);break;case c.HALIGN:o[L.HALLIGN]=function(e){switch(e){case"center":return"center";case"right":return"end";default:return"start"}}(r);break;case c.VALIGN:o[L.VALLIGN]=function(e){switch(e){case"vcenter":case"middle":return"middle";case"vbottom":case"bottom":return"bottom";case"vtop":case"top":default:return"top"}}(r);break;case c.WRAP:o[L.TEXTWRAP]=r?"wrap":"no-wrap";break;case c.CLEARCONTENTS:T.DisplayValue="",T.ActualValue="",T.Formula=r;break;case c.CLEARALL:T.DisplayValue="",T.CellComment=[];case c.CLEARSTYLES:o[L.BACKGROUNDCOLOR]="",o[L.COLOR]="",o[L.FONTNAME]="Arial",o[L.FONTWEIGHT]="normal",o[L.FONTSTYLE]="normal",o[L.TEXTLINETHROUGHTSTYLE]=!1,o[L.TEXTUNDERLINESTYLE]=!1,o[L.FONTSIZE]=10,o[L.HALIGN]=0,o[L.VALLIGN]=0,o[L.TEXTWRAP]=!1,o[L.BORDER]=["","","",""];break;case c.CHECKBOX_EDIT:T.isCheckbox&&(T.DisplayValue=r?"TRUE":"FALSE");break;case c.CHECKBOX_ADD:case c.CHECKBOX_CLEAR:break;case c.CELL_COMMENT:switch(r.MODE){case"remove":T.CellComment=[];break;case"add":T.CellComment=r.COMMENT}break;case c.HYPERLINK:}})}else{var i=T.borderStyle;!function(e,t,n,R,T,o){switch(T=~~T){case N.NONE:!function(e,a,t,n){getDataCache(e,a,t).iterateRange(n,u),P(e,a,t,n,d),U(e,a,t,n,B),X(e,a,t,n,f),V(e,a,t,n,A)}(e,t,n,R);break;case N.LEFT:F(e,t,n,R,o);break;case N.RIGHT:M(e,t,n,R,o);break;case N.TOP:!function(e,a,t,n,R){C=R,V(e,a,t,n,A),p(e,a,t,n,n.startRow,g),C=""}(e,t,n,R,o);break;case N.BOTTOM:!function(e,a,t,n,R){C=R,X(e,a,t,n,f),p(e,a,t,n,n.endRow,b),C=""}(e,t,n,R,o);break;case N.OUTSIDE:!function(e,t,n,R,T){F(e,t,n,R,T),M(e,t,n,R,T),X(e,t,n,R,f),V(e,t,n,R,A),C=T,a=R,p(e,t,n,R,R.startRow,w),p(e,t,n,R,R.endRow,w),C=""}(e,t,n,R,o);break;case N.VERTICAL:!function(e,a,t,n,R){C=R,V(e,a,t,n,A),X(e,a,t,n,f),getDataCache(e,a,t).iterateRange(n,H),C=""}(e,t,n,R,o);break;case N.HORIZONTAL:!function(e,a,t,n,R){C=R,U(e,a,t,n,B),P(e,a,t,n,d),getDataCache(e,a,t).iterateRange(n,h),C=""}(e,t,n,R,o);break;case N.INSIDE:!function(e,t,n,R,T){C=T,a=R,getDataCache(e,t,n).iterateRange(R,v),P(e,t,n,R,d),U(e,t,n,R,B),X(e,t,n,R,f),V(e,t,n,R,A),C=""}(e,t,n,R,o);break;case N.ALL:!function(e,a,t,n,R){C=R,getDataCache(e,a,t).iterateRange(n,G),P(e,a,t,n,d),U(e,a,t,n,B),X(e,a,t,n,f),V(e,a,t,n,A),C=""}(e,t,n,R,o)}}(e,t,R,o,r,i)}}function D(e){var a=e[L.BORDER];1==a.length&&(a[1]=a[0],a[2]=a[0],a[3]=a[0])}function u(e,a,t,n,R,T,o){o[L.BORDER]=["","","",""]}function f(e,a,t,n,R,T,o){D(o),o[L.BORDER][I.TOP]=""}function d(e,a,t,n,R,T,o){D(o),o[L.BORDER][I.LEFT]=""}function A(e,a,t,n,R,T,o){D(o),o[L.BORDER][I.BOTTOM]=""}function B(e,a,t,n,R,T,o){D(o),o[L.BORDER][I.RIGHT]=""}function g(e,a,t,n,R,T,o){D(o),o[L.BORDER][I.TOP]=C}function S(e,a,t,n,R,T,o){D(o),o[L.BORDER][I.LEFT]=C}function b(e,a,t,n,R,T,o){D(o),o[L.BORDER][I.BOTTOM]=C}function k(e,a,t,n,R,T,o){D(o),o[L.BORDER][I.RIGHT]=C}function G(e,a,t,n,R,T,o){o[L.BORDER]=[C,C,C,C]}function H(e,a,t,n,R,T,o){D(o),o[L.BORDER][I.LEFT]=C,o[L.BORDER][I.RIGHT]=C}function h(e,a,t,n,R,T,o){D(o),o[L.BORDER][I.TOP]=C,o[L.BORDER][I.BOTTOM]=C}function w(e,t,n,R,T,o,r){D(r),R===a.startRow&&(r[L.BORDER][I.TOP]=C),R===a.endRow&&(r[L.BORDER][I.BOTTOM]=C),T===a.startCol&&(r[L.BORDER][I.LEFT]=C),T===a.endCol&&(r[L.BORDER][I.RIGHT]=C)}function v(e,t,n,R,T,o,r){D(r),R!==a.startRow&&(r[L.BORDER][I.TOP]=C),R!==a.endRow&&(r[L.BORDER][I.BOTTOM]=C),T!==a.startCol&&(r[L.BORDER][I.LEFT]=C),T!==a.endCol&&(r[L.BORDER][I.RIGHT]=C)}function F(e,a,t,n,R){C=R,U(e,a,t,n,B),m(e,a,t,n,n.startCol,S),C=""}function M(e,a,t,n,R){C=R,P(e,a,t,n,d),m(e,a,t,n,n.endCol,k),C=""}function m(e,a,t,n,R,T){var o=new O(n.startRow,R,n.endRow,R);getDataCache(e,a,t).iterateRange(o,T)}function p(e,a,t,n,R,T){var o=new O(R,n.startCol,R,n.endCol);getDataCache(e,a,t).iterateRange(o,T)}function U(e,a,t,R,T){var o=n.data.getWorkBook(e,t).getSheetObj(a).Column.hidden.prevNonHidden(R.startCol);if(!(o<0)){var r=new O(R.startRow,o,R.endRow,o);getDataCache(e,a,t).iterateRange(r,T)}}function P(e,a,t,R,T){var o=n.data.getWorkBook(e,t).getSheetObj(a).Column.hidden.nextNonHidden(R.endCol);if(!(o>=s-1)){var r=new O(R.startRow,o,R.endRow,o);getDataCache(e,a,t).iterateRange(r,T)}}function V(e,a,t,R,T){var o=n.data.getWorkBook(e,t).getSheetObj(a).Row.Visibility.prevNonHidden(R.startRow);if(!(o<0)){var r=new O(o,R.startCol,o,R.endCol);getDataCache(e,a,t).iterateRange(r,T)}}function X(e,a,t,R,T){var o=n.data.getWorkBook(e,t).getSheetObj(a).Row.Visibility.nextNonHidden(R.endRow);if(!(o>=i-1)){var r=new O(o,R.startCol,o,R.endCol);getDataCache(e,a,t).iterateRange(r,T)}}}(this);
!function(e){var r=e.ZSEvents,t=r.topic,a=r.Groups,i=r.Names;t.register(a.Listener,i.Layers.Preview.Place,function(e,r,t,a,i){var s=getDataCache(e,r,t);s.iterateRange(a,function(e,r,t,a,s,n,c){i&&i(a,s,null,n,c)}),s.refreshGrid()},"RID","SHEETID","VERSION","RANGE","CALLBACK"),t.register(a.Listener,i.Layers.Preview.RemoveAll,function(e,r,t,a){var i=getDataCache(e,r,t);a?i.reload(e,r,t,!0):i.refreshGrid()},"RID","SHEETID","VERSION","isDataNeeded")}(this);
!function(t){var e=t.ZSClass||(t.ZSClass={}),i=t.sPlusPlus;function n(t,e,n,o){var r=this;this.gridID=t,this.rID=e,this.sheetID=n,this.version=o,this.emptyCell=new ZSGrid.EmptyCell(this),this.Col={get axis(){r.getGridID();var t=r.getResourceID(),e=r.getVersion(),n=r.getSheetID();return i.data.getWorkBook(t,e).getSheetObj(n).Column.auxiliaryAxis},get hidden(){r.getGridID();var t=r.getResourceID(),e=r.getVersion(),n=r.getSheetID();return i.data.getWorkBook(t,e).getSheetObj(n).Column.hidden}},this.Row={get axis(){r.getGridID();var t=r.getResourceID(),e=r.getVersion(),n=r.getSheetID();return i.data.getWorkBook(t,e).getSheetObj(n).Row.auxiliaryAxis},get hidden(){r.getGridID();var t=r.getResourceID(),e=r.getVersion(),n=r.getSheetID();return i.data.getWorkBook(t,e).getSheetObj(n).Row.Visibility}}}n.prototype={findCol:function(t){return Math.min(this.Col.axis.findAbs(t),this.getMaxColumn()-1)},findRow:function(t){return Math.min(this.Row.axis.findAbs(t),this.getMaxRow()-1)},getColX:function(t){return this.Col.axis.getPos(t)},getRowY:function(t){return this.Row.axis.getPos(t)},getColWidth:function(t){return this.Col.axis.getDim(t)},getRowHeight:function(t){return this.Row.axis.getDim(t)},getNextNonHiddenRow:function(t){return-1!=t||this.Row.hidden.isHidden(0)?this.Row.hidden.nextNonHidden(Math.max(t,0)):0},getPrevNonHiddenRow:function(t){var e=this.getMaxRow();return t>e-1&&!this.Row.hidden.isHidden(e-1)?e-1:this.Row.hidden.prevNonHidden(Math.min(t,i.data.Defaults.MAX_ROW-1))},getNextNonHiddenCol:function(t){return-1!=t||this.Col.hidden.isHidden(0)?this.Col.hidden.nextNonHidden(Math.max(t,0)):0},getPrevNonHiddenCol:function(t){var e=this.getMaxColumn();return t>e-1&&!this.Col.hidden.isHidden(e-1)?e-1:this.Col.hidden.prevNonHidden(Math.min(t,i.data.Defaults.MAX_COL-1))},isSheetLocked:function(){return i.data.getWorkBook(this.rID,this.version).ProtectedSheets.isSheetLocked(this.sheetID)},isEditable:function(){return i.data.getWorkBook(this.rID,this.version).isEditable()},getPrevContentIndex:function(e,i){return t.getDataCache(this.getResourceID(),this.getSheetID(),this.getVersion()).getPrevContentIndex(e,i)},getNextContentIndex:function(e,i){return t.getDataCache(this.getResourceID(),this.getSheetID(),this.getVersion()).getNextContentIndex(e,i)},getCell:function(e,i){var n=t.getDataCache(this.getResourceID(),this.getSheetID(),this.getVersion()).getCell(e,i);return null==n?this.emptyCell:n},isInViewPort:function(e,i,n,o){return t.getDataCache(this.getResourceID(),this.getSheetID(),this.getVersion()).isInViewPort(e,i,n,o)},isViewPortIntersects:function(e,i,n,o){return t.getDataCache(this.getResourceID(),this.getSheetID(),this.getVersion()).isViewPortIntersects(e,i,n,o)},isHideGrid:function(){var t=this.getResourceID(),e=this.getVersion(),n=this.getSheetID();return!i.data.getWorkBook(t,e).getSheetObj(n).IsShowGrid},getActiveRanges:function(){return i.view.getSheetState(this.getGridID(),this.getSheetID()).getRanges()},getActiveRange:function(){return i.view.getSheetState(this.getGridID(),this.getSheetID()).getActiveRange()},getGridID:function(){return this.gridID},getResourceID:function(){return this.rID},getSheetID:function(){return this.sheetID},getVersion:function(){return this.version},updateSheetIdVersion:function(t,e){this.sheetID=t,this.version=e},getMergeInfo:function(t,e){var n=this.getResourceID(),o=this.getVersion(),r=this.getSheetID(),s=i.data.getWorkBook(n,o).getSheetObj(r).Merge.isXists(t,e);return s?{isRoot:s.isRoot,range:[s.root.startRow,s.root.startCol,s.root.endRow,s.root.endCol]}:null},getRowData:function(t,i,n,o){for(var r=i;r<=n;r++){o(r,e.getCell(t,r),t)}},getMaxRow:function(){return i.data.Defaults.MAX_ROW},getMaxColumn:function(){return i.data.Defaults.MAX_COL},getMaxUsedRow:function(){var t=this.getResourceID(),e=this.getVersion(),n=this.getSheetID();return i.data.getWorkBook(t,e).getSheetObj(n).MaxUsedRow},getMaxUsedCol:function(){var t=this.getResourceID(),e=this.getVersion(),n=this.getSheetID();return i.data.getWorkBook(t,e).getSheetObj(n).MaxUsedCol},getColumnCell:function(t){var i=this.getGridID();return e.getColumnCell(this,t,i,this.getResourceID(),this.getSheetID(),this.getVersion())},getRowCell:function(t){var i=this.getGridID();return e.getRowCell(this,t,i,this.getResourceID(),this.getSheetID(),this.getVersion())},getFlip:function(){var t=this.getGridID();return i.view.getGridComponent(t).getFlip()}},e.Interacter=n}(this);
!function(t){t.sPlusPlus;var e,n=t.ZSClass||(t.ZSClass={}),r=[1,"dashed","#D5D5D5"],i=[1,"solid","#d5d5d5"],o=t.temporary.Colaxis,s=t.temporary.Rowaxis,u=t.temporary.rID,a=t.temporary.sheetID,d=t.temporary.version,f=t.temporary.freezedRow,l=t.temporary.freezedCol,h=t.temporary.zoom,g=t.temporary.gridDirection;function c(t){this.gridID=t,this.rID=u,this.sheetID=a,this.version=d,this.freezedRow=f,this.freezedCol=l,this.Col={get axis(){return o}},this.Row={get axis(){return s}}}c.prototype={findCol:function(t){return Math.min(this.Col.axis.findAbs(t),255)},findRow:function(t){return Math.min(this.Row.axis.findAbs(t),65535)},getColX:function(t){return this.Col.axis.getPos(t)},getRowY:function(t){return this.Row.axis.getPos(t)},getColWidth:function(t){return this.Col.axis.getDim(t)},getRowHeight:function(t){return this.Row.axis.getDim(t)},getNextNonHiddenRow:function(t){for(;t+1<this.getMaxRow()&&0===this.Row.axis.getDim(t+1);)t++;return t+1},getPrevNonHiddenRow:function(t){for(;t-1>=0&&0===this.Row.axis.getDim(t-1);)t--;return t-1},getNextNonHiddenCol:function(t){for(;t+1<this.getMaxColumn()&&0===this.Col.axis.getDim(t+1);)t++;return t+1},getPrevNonHiddenCol:function(t){for(;t-1>=0&&0===this.Col.axis.getDim(t-1);)t--;return t-1},getMaxRow:function(){return 65536},getMaxColumn:function(){return 256},getGridID:function(){return this.gridID},getResourceID:function(){return this.rID},getSheetID:function(){return this.sheetID},getVersion:function(){return this.version},getPrevContentIndex:function(t,e){return e-1},getNextContentIndex:function(t,e){return e+1},getMergeInfo:function(t,e){return null},updateSheetIdVersion:function(t,e){this.sheetID=t,this.version=e},isHideGrid:function(){return!1},getState:function(){return sPlusPlus.view.State[this.gridID][this.rID][this.version].getSheetState(this.sheetID)},getZoom:function(){return h},getIsFlip:function(){return"rl-tb"===g},getFreezedRow:function(){return this.freezedRow},getFreezedCol:function(){return this.freezedCol},isSheetLocked:function(){return!1},getCell:function(n,i){return e||(e=new t.ZSGrid.Cell(-1,0,0,r,r,r,r,"transparent",0)),e},getColumnCell:function(e){var n=new t.ZSGrid.Nodes.HeaderText(JSUtil.Object.getCharForNum(e+1),"black",8,"Arial"),r=new t.ZSGrid.CXColumnCell(0,i,i,i,i,"#f5f6f5");return r.addInBackGroundStack(n),r},getRowCell:function(e){var n=new t.ZSGrid.Nodes.HeaderText(e+1,"black",8,"Arial"),r=new t.ZSGrid.CXRowCell(0,i,i,i,i,"#f5f6f5");return r.addInBackGroundStack(n),r},getMaxUsedRow:function(){return 0},getMaxUsedCol:function(){return 0}},n.DummyInteracter=c}(this);
!function(b){var t=b.ZSGrid||(b.ZSGrid={}),i={getSplitData:function(b){return b.match(/([\s\n]|[^\s\n]+)/gi)},isLink:function(b){return b.match(/((\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}\b)|(((((\+(\b[0-9]{1,3}\b))(\ |-|)|)((([0-9]{1})(-| )([0-9]{2})( |-)([0-9]{2})( |-)([0-9]{2})( |-)([0-9]{2})\b)|(\b[0-9]{10}\b)))|((\(\b[1-9]{1,3}\b\)|)( |)([0-9]{3})( [0-9]{3})( [0-9]{4})\b)|(([0-9]{3}( |-)([0-9]{3})(-| )([0-9]{4}))\b)))|(\b(?:(?:https?|ftp|file):\/\/|www\.|ftp\.)(?:\([-A-Z0-9+&@#/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#/%=~_|$?!:,.]*\)|[A-Z0-9+&@#/%=~_|$])\b|(\b^[a-zA-z0-9]\.[a-zA-z]\b)))/gi)},isEmail:function(b){return!!b.match(/(\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}\b)/gi)},isMobileNumber:function(b){return!!b.match(/((((\+(\b[0-9]{1,3}\b))(\ |-|)|)((([0-9]{1})(-| )([0-9]{2})( |-)([0-9]{2})( |-)([0-9]{2})( |-)([0-9]{2})\b)|(\b[0-9]{10}\b)))|((\(\b[1-9]{1,3}\b\)|)( |)([0-9]{3})( [0-9]{3})( [0-9]{4})\b)|(([0-9]{3}( |-)([0-9]{3})(-| )([0-9]{4}))\b))/gi)},isWebsite:function(b){return!0}};i.isLink=function(b){return b.match(/((\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}\b)|(((((\+(\b[0-9]{1,3}\b))(\ |-|)|)((([0-9]{1})(-| )([0-9]{2})( |-)([0-9]{2})( |-)([0-9]{2})( |-)([0-9]{2})\b)|(\b[0-9]{10}\b)))|((\(\b[1-9]{1,3}\b\)|)( |)([0-9]{3})( [0-9]{3})( [0-9]{4})\b)|(([0-9]{3}( |-)([0-9]{3})(-| )([0-9]{4}))\b)))|(\b(?:(?:https?|ftp|file):\/\/|www\.|ftp\.)(?:\([-A-Z0-9+&@#/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#/%=~_|$?!:,.]*\)|[A-Z0-9+&@#/%=~_|$])\b|(\b^[a-zA-z0-9]\.[a-zA-z]\b)))/gi)},t.HyperLinkUtil=i}(this);
!function(e){var t=e.sPlusPlus,r=e.ZSClass,n=t.data.Defaults,o=[1,"solid","#d5d5d5"],u=[""],i=[2,"solid","#bbbbbb"],l="#f5f6f5",s="#e5e6e5",a="#13AD6B",d=[1,"solid",a];function c(e,r,n,o){var u=l,i=t.view.getSheetState(e,r).getRanges();for(var d in i)if(i[d].intersects(n)&&(u=s,o(i[d])))return{color:a,lastColumn:i[d].endCol,lastRow:i[d].endRow};return{color:u}}var f={getBorder:function(){return o},getHideBorder:function(){return u},getFilterBorder:function(){return i},getColumnBackGroundColor:function(e,t,o){return c(t,o,new r.Range(0,e,n.MAX_ROW,e),function(e){return e.isCol()})},getRowBackGroundColor:function(e,t,o){return c(t,o,new r.Range(e,0,e,n.MAX_COL),function(e){return e.isRow()})},getWholeSelectedBorder:function(){return d},getWholeSelectedColor:function(){return a},isFilterColorNeeded:function(e,n,o,u){for(var i=t.data.getWorkBook(e,o).getSheetObj(n).DataFilters,l=new r.Range(u,0,u,255),s=i.getIntersectedRanges(l),a=0;a<s.length;a++){if(s[a].properties.isApplied)return!0}return!1}};r.HeaderStyleDef=f}(this);
!function(e){var o=e.sPlusPlus,t=o.data.Defaults,d=ZSGrid.Nodes,r=d.HeaderText,l=new d.LeftAndRightHideCue(8.5,"#6d6d6d",5,7),n=new d.LeftHideCue,a=ZSClass.HeaderStyleDef,u=a.getBorder(),C=a.getHideBorder(),c=a.getWholeSelectedColor(),i=a.getWholeSelectedBorder();ZSClass.getColumnCell=function(d,s,g,S,h,k){var m,B=o.data.getWorkBook(S,k).getSheetObj(h).Column.hidden,H=u;B.nextNonHidden(s)-1!==s&&s<t.MAX_COL&&(H=C,m=B.nextNonHidden(s)===t.MAX_COL?n:l);var f=a.getColumnBackGroundColor(s,g,h),G="black";f.color===c?(G="white",f.lastColumn===s&&(H=i)):s+1<d.getMaxColumn()&&a.getColumnBackGroundColor(s+1,g,h).color===c&&(H=i);var w=new r(JSUtil.Object.getCharForNum(s+1),G,8.3,"Lato"),L=new e.ZSGrid.CXColumnCell(s,u,H,u,u,f.color);return L.addInBackGroundStack(w),m&&L.addInForeGroundStack(m),L}}(this);
!function(e){var o=e.sPlusPlus,t=o.data.Defaults,d=ZSGrid.Nodes,r=d.HeaderText,l=new d.TopAndBottomHideCue(8.5,"#6d6d6d",3,5),a=new d.TopHideCue,n=ZSClass.HeaderStyleDef,i=n.getBorder(),s=n.getHideBorder(),c=n.getFilterBorder(),u=n.getWholeSelectedColor(),w=n.getWholeSelectedBorder();ZSClass.getRowCell=function(d,g,C,R,S,B){var k,H=o.data.getWorkBook(R,B).getSheetObj(S),G=H.Row.Visibility,W=H.Row.Filter,f=i;G.nextNonHidden(g)-1!==g&&g<t.MAX_ROW&&(W.nextNonHidden(g)-1!==g&&g<t.MAX_ROW?f=c:(f=s,k=G.nextNonHidden(g)===t.MAX_ROW?a:l));var h=n.getRowBackGroundColor(g,C,S),x="black";h.color===u?(x="white",h.lastRow===g&&(f=w)):g+1<d.getMaxRow()&&n.getRowBackGroundColor(g+1,C,S).color===u&&(f=w);var N=new e.ZSGrid.CXRowCell(g,i,i,i,f,h.color),v=new r(g+1,n.isFilterColorNeeded(R,S,B,g)?"#ae101f":x,8.3,"Lato");return N.addInBackGroundStack(v),k&&N.addInForeGroundStack(k),N}}(this);
!function(t){var e=t.sPlusPlus,n=(e.data.Defaults,{BACKGROUNDCOLOR:0,COLOR:1,FONTSIZE:2,FONTNAME:3,FONTWEIGHT:4,FONTSTYLE:5,TEXTLINETHROUGHTSTYLE:6,TEXTUNDERLINESTYLE:7,TEXTWRAP:8,HALLIGN:9,VALLIGN:10,BORDER:11,HIDETEXT:12,ICONSET:13}),r=2,a="STRING",o="FLOAT",u="PERCENTAGE",c="CURRENCY",i="DATE",s="TIME",T="DATETIME",E="FRACTION",l="SCIENTIFIC",N="BOOLEAN",C="SSN",O="ZIPCODE",f="ZIPCODE4",I="PHONENUMBER",S=(t.ZSConstants.CommandConstants,{getBackGroundColor:function(t){return t[n.BACKGROUNDCOLOR]||"#FFF"},getTextColor:function(t){return t[n.COLOR]||"#000"},getFontSize:function(t){return t[n.FONTSIZE]||10},getFontName:function(t){return t[n.FONTNAME]},getBold:function(t){return"bold"===t[n.FONTWEIGHT]},getItalic:function(t){return"italic"===t[n.FONTSTYLE]},getStrikeThrough:function(t){return t[n.TEXTLINETHROUGHTSTYLE]},getUnderline:function(t){return t[n.TEXTUNDERLINESTYLE]},getTextWrap:function(t){return"wrap"===t[n.TEXTWRAP]?1:0},getHorizontalAlign:function(t,e){var r=e.CellType;if(e.Pattern&&void 0!=e.Pattern[288]&&-1!=e.Pattern[288])return 2;switch(t[n.HALLIGN]){case"start":return 0;case"center":return 1;case"end":return 2;default:var a=!0===t[n.HIDETEXT];if(("FLOAT"===r||"NUMBER"===r||"PERCENTAGE"===r||"CURRENCY"===r||"ACCOUNTING"===r||"DATE"===r||"TIME"===r||"DATETIME"===r||"FRACTION"===r||"SCIENTIFIC"===r||"BOOLEAN"===r||"SSN"===r||"ZIPCODE"===r||"ZIPCODE4"===r||"PHONENUMBER"===r)&&!a)return 2}return e.isRTL?2:0},getVerticalAlign:function(t){switch(t[n.VALLIGN]){case"vcenter":case"middle":return 1;case"vbottom":case"bottom":return 2;case"vtop":case"top":default:return 0}},getBorders:function(t){var e=t[n.BORDER];1==e.length&&(e[1]=e[0],e[2]=e[0],e[3]=e[0]);var r={};return r.left=d(e[0],t),r.right=d(e[1],t),r.top=d(e[2],t),r.bottom=d(e[3],t),r},isHideText:function(t){return!0===t[n.HIDETEXT]},getIconSet:function(t){return t[n.ICONSET]?[t[n.ICONSET][1],t[n.ICONSET][0],4*(t[n.ICONSET][r]?10:t[n.FONTSIZE])/3*1.15]:null},getFontNameUI:function(t,r){var a=e.data.getWorkBook(t,r).CellStyle.styles.Default[n.FONTNAME];return ZSGrid.Font.CheckSupport(a)||(a=e.view.Defaults.CellStyle.FontName),a},checkFontSupport:function(t,e,r){!ZSGrid.Font.CheckSupport(r[n.FONTNAME])&&(r[n.FONTNAME]=this.getFontNameUI(t,e))},isAccountingCell:function(t){return void 0!=t.repeatIndex&&-1!=t.repeatIndex&&void 0!=t.repeatChar&&t.repeatChar.length>0},isTextNode:function(t){return t.CellType===a},isNumberNode:function(t){return t.CellType==o&&t.Pattern&&0==Object.keys(t.Pattern).length},isDefaultColor:function(t){switch(t){case"":case"#000000":case"black":case"#000":return!0}return!1},isFormatCell:function(t){switch(t){case u:case c:case i:case s:case T:case E:case l:case N:case C:case O:case f:case I:case o:return 1;default:return 0}}});function d(t,e){return""===t||null===t||t.contains("none")?e[n.BACKGROUNDCOLOR]?[1,"solid","transparent"]:null:((t=t.split(" "))[0]=function(t){if(t.contains("in"))return function(t){return Math.floor(parseFloat(t)*p)}(t);if(t.contains("pt"))return function(t){return Math.floor(parseFloat(t)*A)}(t);if(t.contains("px"))return Math.floor(parseFloat(t));return F.font=t+" arial",parseInt(F.font)}(t[0]),t[1]=t[1]||"solid",t[2]="transparent"==t[2]?e[n.BACKGROUNDCOLOR]||"#DDD":t[2],t)}var F=document.createElement("canvas").getContext("2d");function R(t){var e=document.createElement("span");e.style.position="absolute",e.style.height=t,document.body.appendChild(e);var n=e.offsetHeight;return e.remove(),n}var p=R("1in");var A=R("300pt")/300;ZSClass.CellStyleDef=S}(this);
!function(i){var t=ZSClass.CellStyleDef,e=ZSClass.CellDecorator||(e={}),n={},l="#1a0dab",r=ZSGrid.TextNode;var o="http://",a="https://";function s(i){return ZSGrid.HyperLinkUtil.isEmail(i)}function u(i){return ZSGrid.HyperLinkUtil.isMobileNumber(i)}function p(i){return ZSGrid.HyperLinkUtil.isWebsite(i)}function k(i,t,e){return{displayValue:i,linkto:t,fun:e}}n.getHyperLinkNode=function(i,e){if(ZSGrid.HyperLinkUtil.isLink(e.content)){var n=e.content.match(/([\s\n]|[^\s\n]+)/gi),o="";if(n){for(var a=0;a<n.length;a++){var s=e.underline,u=e.color;null!=ZSGrid.HyperLinkUtil.isLink(n[a])?(""!=o&&(i.addTextNode(new r(o,e.bold,e.italic,s,e.strikeThrough,e.color,e.fontsize,e.fontstyle,e.fontname)),o=""),t.isDefaultColor(u)&&(u=l),i.addTextNode(new r(n[a],e.bold,e.italic,!0,e.strikeThrough,u,e.fontsize,e.fontstyle,e.fontname))):o+=n[a]}""!=o&&i.addTextNode(new r(o,e.bold,e.italic,s,e.strikeThrough,e.color,e.fontsize,e.fontstyle,e.fontname))}}else u=t.isDefaultColor(e.color)?l:e.color,i.addTextNode(new r(e.content,e.bold,e.italic,!0,e.strikeThrough,u,e.fontsize,e.fontstyle,e.fontname));return i},n.getSingleHyperlinkData=function(i){if(i.Hyperlink.startsWith("#"))var t=k(i.Hyperlink,i.Hyperlink,function(i){if(-1!=(i=i.substr(1,i.length)).indexOf("."))var t=i.split(".")[0];UserAction.GotoLink(t,i)});else{var e;s(i.Hyperlink)||u(i.Hyperlink)?e=i.Hyperlink:p(i.Hyperlink)&&(e=i.Hyperlink.startsWith(o)||i.Hyperlink.startsWith(a)?i.Hyperlink:a+i.Hyperlink),t=k(""==i.DisplayValue?i.ActualValue:(n=i.DisplayValue,ZSGrid.HyperLinkUtil.isLink(n)?i.DisplayValue:i.Hyperlink),e,null)}var n;return t},n.getMultipleHyperlinkData=function(i){for(var t=ZSGrid.HyperLinkUtil.getSplitData(i.DisplayValue),e=[],n=0;n<t.length;n++)if(ZSGrid.HyperLinkUtil.isLink(t[n])){var l;s(t[n])?l="mailto:"+t[n]:u(t[n])?l="tel:"+t[n]:p(t[n])&&(l=t[n].startsWith(o)||t[n].startsWith(a)?t[n]:a+t[n]);var r={displayValue:t[n],linkto:l,fun:null};e.push(r)}return e},e.Hyperlink=n}();
!function(e){var i=e.sPlusPlus,t=ZSClass.CellDecorator||(t={}),a={};function r(e){for(var i={min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER},t=0;t<e.length;t++)e[t]>i.max&&(i.max=e[t]),e[t]<i.min&&(i.min=e[t]);return i}function n(e,i,t){if(e.setData(i),e.setEmptyCellType(t.getEmptyCellType()),t.getMinimum()||t.getMaximum())if(t.getMinimum())if(t.getMaximum())e.setMaximum(t.getMaximum()),e.setMinimum(t.getMinimum());else{a=r(i);e.setMinimum(t.getMinimum()),e.setMaximum(a.max)}else{var a=r(i);e.setMinimum(a.min),e.setMaximum(t.getMaximum())}else{var a=r(i);e.setMinimum(a.min),e.setMaximum(a.max)}}t.Sparkline=a,a.setSparklineNode=function(t,a,r,o,s,m,l){var u,g=i.data.getWorkBook(a,o).getSheetObj(r),p=t.data,v=g.sparklines.getInfo(s,m).properties.props,c=v.getHighPointColor(),f=v.getLowPointColor(),C=v.getFirstPointColor(),w=v.getLastPointColor(),M=v.getNegativePointColor(),k=v.getMarkerPointColor();switch(v.getType()){case"winloss":u=new e.WinLossSparkline(v.getLineColor(),c,f,C,w,M,k,v.isShowAxis());break;case"column":u=new e.ColumnSparkline(v.getLineColor(),c,f,C,w,M,k,v.isShowAxis());break;case"line":u=new e.LineSparkline(v.getLineColor(),c,f,C,w,M,k,v.isShowAxis())}var x=new e.Sparkline(u,[],1,1);if(t.addInBackGroundStack(x),p.spData)n(x,p.spData,v);else{var h=i.view.getActiveGridID();i.view.fetchRangeDataFromWorker(a,l.sheetID,o,l.range,["ActualValue"],!v.hidden,h,function(t){var a=function(e,i,t,a){for(var r=[],n=e.range.startRow,o=e.range.startCol,s=e.range.endRow,m=e.range.endCol,l=n;l<=s;l++)for(var u=o;u<=m;u++)if(i[l]&&i[l][u]){var g=parseFloat(i[l][u].ActualValue);if(isNaN(g)){if("skip"==a)continue;g="gap"==a?NaN:"zero"==a?0:NaN}r.push(g)}return t?r.reverse():r}(l,t,v.isReverse(),v.getEmptyCellType());n(x,a,v),p.spData=a;var r=i.view.getActiveGridID();i.view.getGridComponent(r).refresh();var o=i.view.Toolbar.Feature[e.ZSConstants.FeatureConstants.PRINT];o&&o.refreshPreview&&o.refreshPreview()},function(){})}}}(this);
!function(e){var t=e.sPlusPlus,a=t.data.Defaults,n=ZSClass.CellStyleDef,i=ZSClass.CellDecorator.Hyperlink,l=ZSClass.CellDecorator.Sparkline,o=(ZSConstants.CommandConstants,e.ZSEvents),r=o.topic,s=o.Groups,d=o.Names,c=e.ZSGrid,u=c.Cell,g=c.Nodes,C=c.TextNode,p=document.createElement("canvas").getContext("2d"),k=new g.Pattern("/sheet/appsheet/styles/spriteImages/images/protected_bg.png"),S=new RegExp("^[֑-߿יִ-﷽ﹰ-ﻼ]");e.checkRTL=function(e){return S.test(e)};var f={createCell:function(e,t,a){var i=n.getVerticalAlign(t),l=n.getHorizontalAlign(t,a),o=n.getBorders(t),r=n.getBackGroundColor(t);return new u(e,i,l,o.left,o.right,o.top,o.bottom,r)},setNotes:function(e,t,n,i){var l=JSUtil.Math.hash(n,i,a.MAX_COL),o=e.data;(t.Notes.get(l)||o.CellComment&&o.CellComment.length)&&e.addInBackGroundStack(new g.NoteCue)},setDataValidation:function(e,t,a,n){var i=t.DataValidation.isXists(a,n),l=e.data;i&&0==l.IsContentValid&&e.addInBackGroundStack(new g.InvalidDVCue)},setFilterIconPadding:function(e,t,a,n,i,l){var o=e.data.isCheckbox,r=x(t,a,n);r?e.addInForeGroundStack(new g.PaddingToFilterCue(!o&&2===i)):(r=m(t,a,n))&&e.addInForeGroundStack(new g.PaddingToFilterCue(!o&&2===i))},setFilterIcon:function(e,t,a,n,i,l){var o=e.data.isCheckbox,r=x(t,a,n);r?e.addInForeGroundStack(new g.FilterCue(!o&&2===i,r.applied,"Filter")):(r=m(t,a,n))&&e.addInForeGroundStack(new g.FilterCue(!o&&2===i,r.applied,"PivotFilter"))},setPicklistIconPadding:function(e,t,a,n,i){e.data.isCheckbox;t.Picklist.getInfo(a,n)&&e.addInForeGroundStack(new g.PaddingToFilterCue(!0,!1))},setPicklistIcon:function(e,t,a,n,i){e.data.isCheckbox;t.Picklist.getInfo(a,n)&&e.addInForeGroundStack(new g.FilterCue(!0,!1,"Picklist",10))},setIconSet:function(t,a,i,l,o,r,s){var d=t.data.isCheckbox,c=n.isHideText(a),u=n.getIconSet(a),C=t.data.DisplayValue,p=n.isAccountingCell(t.data);u&&(u=e.IconSets[u[0]]?u:null),u&&t.addInForeGroundStack(new g.ICSet(u,d||""!==C&&!c?0:s,r,!d&&(0===s||p)))},setLockCell:function(e,a,n,i,l,o){var r=t.data.getWorkBook(a,i),s=r.getSheetObj(n);(r.ProtectedSheets.isSheetLocked(n)||s.ProtectedRanges.isXists(l,o))&&e.addInBackGroundStack(k)},setCheckBox:function(e){var t=e.data,a=t.DisplayValue;"FLOAT"==t.CellType&&(a=0!=t.DisplayValue?"TRUE":"FALSE");var n="TRUE"==a,i=new g.CheckBox(n);e.addInForeGroundStack(i)},setHyperlink:function(e){var t=e.data,a=[];if(""==t.Hyperlink)a=i.getMultipleHyperlinkData(t);else{var n=i.getSingleHyperlinkData(t);a.push(n)}e.data.hyperlinkData=a},setSparkline:function(e,a,n,i,o,r){t.view.getActiveGridID();var s=t.data.getWorkBook(a,i).getSheetObj(n).sparklines;if(s.isXists(o,r)){var d=s.getInfo(o,r).properties;if(!d)return;var c=JSUtil.SparklinePool.getDataRange(a,i,d,o,r);c&&l.setSparklineNode(e,a,n,i,o,r,c)}},addDisplayValue:function(e,t,a,l,o){var r=n.getBold(o),s=n.getItalic(o),d=n.getUnderline(o),c=n.getStrikeThrough(o),u=n.getTextColor(o),k=n.getFontSize(o),S=n.getFontName(o),f=e.data.DisplayValue;if(n.isAccountingCell(e.data)){var h=function(e,t,a,n,i,l,o,r,s){var d=t.repeatIndex,c=t.repeatChar,u="",p="";e.length>0&&(u=e.substring(0,d),p=e.substring(d,e.length));t.hasLink&&(i=!0,o=y);var k=new C(u,a,n,i,l,o,r,"fontstyle",s),S=new C(p,a,n,i,l,o,r,"fontstyle",s),f=new C(c,a,n,i,l,o,r,"fontstyle",s);return new g.AccountingNode(k,S,f)}(f,e.data,r,s,d,c,u,k,S);e.addInForeGroundStack(h)}else{var v=function(e,t,a,l,o,r,s,d,c,u){var p=new C(e,l,o,r,s,d,c,"fontstyle",u);if(n.isFormatCell(t.CellType))var k=new g.TextSpecialClipNode;else switch(n.getTextWrap(a)){case 0:var k=new g.TextOverFlowNode;break;case 1:var k=new g.TextWrapNode;break;case 2:var k=new g.TextClipNode}t.hasLink?k=i.getHyperLinkNode(k,p):k.addTextNode(p);return k}(f,e.data,o,r,s,d,c,u,k,S);if(e.addInForeGroundStack(v),!v.calculated){var D=e.getPaddingRight()+e.getPaddingLeft(),I=t.Merge.isXists(a,l);if(I&&I.isRoot){var m=I.root.startCol,x=I.root.endCol,F=t.Column.auxiliaryAxis.getPos(x)+t.Column.auxiliaryAxis.getDim(x)-t.Column.auxiliaryAxis.getPos(m);w=F<D?F:F-D}else{var w=t.Column.auxiliaryAxis.getDim(l);w=w<D?w:w-D}v.calculate(p,w)}}}},h=g.TextClipNode;function v(){h.call(this)}v.prototype={render:function(e,t,a){var n=t.getHorizontalAlignment();(function(){for(var e=0,t=0;t<this.Lines.length;t++)e<this.Lines[t].getWidth()&&(e=this.Lines[t].getWidth());return e}).call(this)>a.getWidth()/e.getZoom()&&(n=0),e.render(a,t.getVerticalAlignment(),n,this.Lines,e.getZoom())}},v.prototype=Object.assign({},h.prototype,v.prototype),g.TextSpecialClipNode=v;var y="#1a0dab";function D(e){return JSUtil.Object.clone(e,!0)}function I(e,t,a){return a.Format||e.ColStyleNames.getStyle(t)||"Default"}function m(e,t,a){var n=e.PivotButton.isXists(t,a);return!!n&&{applied:"filter_new"!==n.root.properties.type}}function x(e,t,a){var n=e.DataFilters.getAllRanges();for(var i in n)if(n[i].isHeader(t,a))return{applied:-1!==n[i].properties.appliedColumns.indexOf(a)};return!1}ZSClass.getCellObject=function(e,a,i,l,o,c,u){l=~~l,o=~~o;var C=t.data.getWorkBook(e,i),p=C.getSheetObj(a),k=D(c),S=I(p,o,k),h=k.styleDef?k.styleDef:D(C.CellStyle.getStyleDef(S));u&&u(e,a,i,l,o,k,h),h=ZSClass.CellDecorator.getStyle(h,k),n.checkFontSupport(e,i,h),k.styleDef=h;var v=f.createCell(o,h,k);v.data=k,f.setLockCell(v,e,a,i,l,o),f.setNotes(v,p,l,o),f.setDataValidation(v,p,l,o),f.setSparkline(v,e,a,i,l,o);var y=n.getVerticalAlign(h),m=n.getHorizontalAlign(h,k);f.setFilterIconPadding(v,p,l,o,m,h),f.setIconSet(v,h,p,l,o,y,m),f.setPicklistIconPadding(v,p,l,o,m);var x=v.data.isCheckbox,F=n.isHideText(h);x?f.setCheckBox(v):""===k.DisplayValue||F?k.Formula&&v.addInForeGroundStack(new g.DummyNode):f.addDisplayValue(v,p,l,o,h),!k.hyperlinkData&&k.hasLink&&f.setHyperlink(v),f.setFilterIcon(v,p,l,o,m,h),f.setPicklistIcon(v,p,l,o,m);var w=function(e,a,n,i,l){if(n!=t.data.Defaults.version){var o=new ZSClass.Range(i,l,i,l),r=t.view.getActiveGridID(),s=t.view.getVersionState(r),d=s.getVersionActionList()[a];for(var c in d)if(s.isEditAction(d[c].a)){var u=d[c].lp.length,g=d[c].lp[u-1];if(JSUtil.Range.parseRange(e,n,g).range.intersects(o))return{name:d[c].un,color:"#"+d[c].cc}}}return null}(e,a,i,l,o);return w&&v.addInBackGroundStack(new g.VersionHighlight(w.color)),k.CellComment&&k.CellComment.length?r.publish(s.Listener,d.CellAction.COMMENT.ADD,{RID:e,SHEETID:a,VERSION:i,ROW:l,COL:o,COMMENT:k.CellComment}):(r.publish(s.Listener,d.CellAction.COMMENT.HIDE),r.publish(s.Listener,d.CellAction.COMMENT.DELETE,{RID:e,SHEETID:a,VERSION:i,ROW:l,COL:o,COMMENT:""})),v},ZSClass.getPrintCellObject=function(e,a,i,l,o,r,s){l=~~l,o=~~o;var d=t.data.getWorkBook(e,i),c=d.getSheetObj(a),u=D(r),C=I(c,o,u),p=u.styleDef?u.styleDef:D(d.CellStyle.getStyleDef(C));s&&s(e,a,i,l,o,u,p),p=ZSClass.CellDecorator.getStyle(p,u),n.checkFontSupport(e,i,p),u.styleDef=p;var k=f.createCell(o,p,u);k.data=u,f.setSparkline(k,e,a,i,l,o);var S=n.getVerticalAlign(p),h=n.getHorizontalAlign(p,u);f.setIconSet(k,p,c,l,o,S,h);var v=k.data.isCheckbox,y=n.isHideText(p);return v?f.setCheckBox(k):""===u.DisplayValue||y?u.Formula&&k.addInForeGroundStack(new g.DummyNode):f.addDisplayValue(k,c,l,o,p),!u.hyperlinkData&&u.hasLink&&f.setHyperlink(k),k}}(this);
!function(t){if(t.isCanvasGrid){var e=t.sPlusPlus,i=t.ZSClass,s=t.ZSGrid,n=s.Print||(s.Print={}),h=""===document.createElement("detect").style.zoom,r=t.ZSConstants.I18N,a=JSUtil.fn.replaceParams(r["Print.OutOfBounds"],[400]);g.prototype={imgSource:function(t,e){t.src=e},onPageCreate:function(t,e,i){var s=this.pgCoordinates[t],h=s[0],r=s[1],a=s[2],o=s[3],g=s[4],l=this.getRowLimit(),d=this.getColLimit();r>l&&(r=l),o>d&&(o=d);var f=n.getPageSize(this.layout,this.pageSize).width-this.marginLeft-this.marginRight,p=r-h,c=this.scaleY<1?f:o-a;e.setContentDim(p,c,g);var u=e.getImgDom();this.imgSource(u,i)},findColAt:function(t){return Math.min(this.maxCol,this.findCol(t))},findRowAt:function(t){return Math.min(this.maxRow,this.findRow(t))},getRowLimit:function(){return this.getRowY(this.maxRow+1)},getColLimit:function(){return this.getColX(this.maxCol+1)},isHideGrid:function(){return!this.gridLine},isHideHeaders:function(){return!0},isHideScrollBars:function(){return!0},getPrevContentIndex:function(t,e){var i=this.getPageID(t,e);return n.getDataCache(this.gridID,this.rID,this.sheetID,this.version).getPrevContentIndex(i,t,e)},getNextContentIndex:function(t,e){var i=this.getPageID(t,e);return n.getDataCache(this.gridID,this.rID,this.sheetID,this.version).getNextContentIndex(i,t,e)},getCell:function(t,e){var i=n.getDataCache(this.gridID,this.rID,this.sheetID,this.version),s=this.getPageID(t,e),h=-1!=s?i.getCell(s,t,e):null;return null==h?this.emptyCell:h},isInViewPort:function(t,e,i,s){return n.getDataCache(this.gridID,this.rID,this.sheetID,this.version).isInViewPort(t,e,i,s)},onComputeCoordinates:function(t,e,i,s,n){var h=this.pgCoordinates[t],r=h[0]*this.scaleY,a=h[1],o=h[2]*this.scaleX,g=h[3];a>s&&(a=s),g>n&&(g=n),this.fixedHeight=a-r,this.fixedWidth=g-o,this.scaleY<1||(e=this.fixedWidth>0?this.fixedWidth:e),i=this.fixedHeight>0?this.fixedHeight:i;var l=!1;return(r>=s||o>=n)&&(l=!0),{setX:o,setY:r,height:i,width:e,isOutOfBounds:l}},computeScale:function(t,e,i){var s=this.Col.axis,n=i/(s.getPos(e+1)-s.getPos(t));n=Math.min(n,1),this.scaleX=n,this.scaleY=n},computePageCoordinates:function(t,i,s,h){var r=e.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),a=this.Row.axis,o=this.Col.axis,g=this.printRange,l=!1,d=r.Merge.isXists(g.startRow,g.startCol),f=r.Merge.isXists(g.endRow,g.endCol);d&&f&&(l=d.root.equals(f.root)),l||g.isSingle()?(t=0,i=0,s=this.maxRow,h=this.maxCol):(t=g.startRow,i=g.startCol,s=g.endRow,h=g.endCol);var p=n.getPageSize(this.layout,this.pageSize),c=p.width-this.marginLeft-this.marginRight,u=p.height-this.marginTop-this.marginBottom;this.isFitToWidth&&this.computeScale(i,h,c);var m,v,C=[],I=[],x=a.getPos(t);v=x;for(var D=t;D<=s;D++){if(v+(R=a.getDim(D)*this.scaleX)-x>u){if(v==x){var w=u/R;v+=R,C.push([0==x?x:x-1,v,w])}else C.push([0==x?x:x-1,v]),D--;x=v}else v+=R}if(C.push([0==x?x:x-1,v]),this.scaleY<1){var P=o.getPos(h+1)-o.getPos(i),y=0==o.getPos(i)?0:o.getPos(i)-1;I.push([y,y+P])}else{m=x=o.getPos(i);for(D=i;D<=h;D++){var R;if(m+(R=o.getDim(D))-x>c){if(m==x){var S=c/R;m+=R,I.push([0==x?x:x-1,m,S])}else I.push([0==x?x:x-1,m]),D--;x=m}else m+=R}I.push([0==x?x:x-1,m])}this.pgCnt=0,this.pgCoordinates=[],this.pgSplit={};var O=!1;for(D=0;D<C.length;D++){for(var L=0;L<I.length;L++){var B=1,W=this.findRowAt(C[D][0]+1),E=this.findRowAt((C[D][1]-1)/this.scaleY);W==E&&C[D][2]&&(B=C[D][2]);var H=this.findColAt(I[L][0]+1),k=this.findColAt(I[L][1]-1);if(H==k&&I[L][2]&&B>I[L][2]&&(B=I[L][2]),this.pgSplit[this.pgCnt]=[W,E,H,k],this.pgCoordinates[this.pgCnt++]=1==B?[C[D][0],C[D][1],I[L][0],I[L][1]]:[C[D][0],C[D][1],I[L][0],I[L][1],B],400==this.pgCnt){this.lmtExcdNtf.show(),O=!0;break}}if(O)break}},getOLEs:function(t){return this.pgOLEs[t]},getOleXYinPg:function(t,e,i,s,n,h,r,a){this.isFitToWidth&&(a/=this.scaleY);var o,g,l=t-n,d=e-h,f=!1;return e>=h&&e<=a&&t>=n&&t<=r?(o=d+"px",g=l+"px",f=!0):e>=h&&e<a&&t<=n?(o=d+"px",g=-(n-t)+"px",f=!0):e<n&&t>=n&&t<=r?(o=-(h-e)+"px",g=l+"px",f=!0):e<h&&t<n&&s>=h&&i>=n&&(o=-(h-e)+"px",g=-(n-t)+"px",f=!0),{isOleInPg:f,top:o,left:g}},findOLEPos:function(){this.pgOLEs={};for(var t=e.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID),i=t.Buttons,s=t.Images,n=document.body.querySelector("#MainGrid").getElementsByTagName("img"),h=(new ZSChart.Utility.ChartAgent).getAllMetaOfSheet(this.rID,this.sheetID,this.version),r=0;r<this.pgCnt;r++)!this.pgOLEs[r]&&(this.pgOLEs[r]=[]),this.showButtons&&this.findBtnsInPg(i,this.pgCoordinates[r],r),this.showCharts&&this.findChartsInPg(h,this.pgCoordinates[r],r),this.showImages&&this.findImagesInPg(s,this.pgCoordinates[r],r,n)},findImagesInPg:function(t,e,i,s){var n=t.getKeys(),h=n.length;if(!(h<=0))for(var r=0;r<h;r++){var a=t.get(n[r]),o=this.Col.axis.getPos(a.getCol())+a.getColDiff(),g=this.Row.axis.getPos(a.getRow())+a.getRowDiff(),l=o+a.Width,d=g+a.Height,p=e[0],c=e[1],u=e[2],m=e[3],v=this.getOleXYinPg(o,g,l,d,u,p,m,c);if(v.isOleInPg){var C=this.pgOLEs[i],I={id:n[r],dom:f(a,v.top,v.left,s,this.scaleX,this.isFlip)};C.push(I)}}},findChartsInPg:function(t,e,i){var s=t.length;if(!(s<=0))for(var n=0;n<s;n++){var h=t[n],r=this.Col.axis.getPos(h.getStartColIndex())+parseInt(h.getStartColDiff()),a=this.Row.axis.getPos(h.getStartRowIndex())+parseInt(h.getStartRowDiff()),o=r+h.getWidth(),g=a+h.getHeight(),l=e[0],f=e[1],p=e[2],c=e[3],u=this.getOleXYinPg(r,a,o,g,p,l,c,f);if(u.isOleInPg&&h.chartInstance[0]){var m=this.pgOLEs[i],v={id:h.chartInstance[0].renderTo.id,dom:d(h,u.top,u.left,this.scaleX,this.isFlip)};m.push(v)}}},findBtnsInPg:function(t,e,i){var s=t.getKeys(),n=s.length;if(!(n<=0))for(var h=0;h<n;h++){var r=t.get(s[h]),a=r.x,o=r.y,g=a+r.width,d=o+r.height,f=e[0],p=e[1],c=e[2],u=e[3],m=this.getOleXYinPg(a,o,g,d,c,f,u,p);if(m.isOleInPg){var v=this.pgOLEs[i],C={id:s[h],dom:l(r,m.top,m.left,this.scaleX,this.isFlip)};v.push(C)}}},loadDataToCache:function(t,e,i,s){n.getDataCache(this.gridID,this.rID,this.sheetID,this.version).load(this.gridID,this.rID,this.sheetID,this.version,t,e,i,s)},setDataPane:function(t,e,s,h){var r=n.getDataCache(this.gridID,this.rID,this.sheetID,this.version),a=r.getNextPaneId();return r.setPane(a,new i.Range(t,e,s,h))},removeDataPane:function(){var t=n.getDataCache(this.gridID,this.rID,this.sheetID,this.version);for(var e in t.Panes){var i=e;t.removePane(i)}},loadBufferArray:function(t,e,s,n,h){for(var r={},a=0;a<t.length;a++){var o=t[a],g=this.pgSplit[o];r[o]=new i.Range(g[0],0,g[1],g[3])}this.loadDataToCache(r,e,s,n)},findPagesWithSparkline:function(){this.pgsWithSparklines=[];for(var t=e.data.getWorkBook(this.rID,this.version).getSheetObj(this.sheetID).sparklines.getAllRanges(),s=this.pgCoordinates,n=0;n<s.length;n++){var h=s[n],r=new i.Range(this.findRow(h[0]+1),this.findCol(h[2]+1),this.findRow(h[1]-1),this.findCol(h[3]-1));for(var a in t)if(r.intersects(t[a])){-1==this.pgsWithSparklines.indexOf(n)&&this.pgsWithSparklines.push(n);break}}},hasSparkLine:function(t){return-1!=this.pgsWithSparklines.indexOf(t)},getPageID:function(t,e){var s=new i.Range(t,e,t,e);for(var n in this.pgSplit){var h=this.pgSplit[n],r=new i.Range(h[0],h[2],h[1],h[3]);if(s.intersects(r))return n}return-1},getBufferAry:function(t,e,i){var s=[];t<0&&(t=0),e>this.pgCnt-1&&(e=this.pgCnt-1);for(var n=i.pages,h=t;h<=e;h++){""===n[h].image.getAttribute("src")&&(s.push(h),this.isRendered[h]=!0)}return s},clearData:function(){n.clearDataCache(this.rID,this.sheetID,this.version)}},g.prototype=Object.assign({},i.Interacter.prototype,g.prototype),n.PrintInteractor=g}function o(t){return 96*t}function g(t,e,n,h,r){i.Interacter.call(this,t,e,n,h),this.layout="0"==r.Orientation?"portrait":"landscape",this.pageSize=r.PageSize,this.marginLeft=o(r.MarginLeft),this.marginRight=o(r.MarginRight),this.marginTop=o(r.MarginTop),this.marginBottom=o(r.MarginBottom),this.maxRow=Math.min(this.getMaxRow(),r.maxRow),this.maxCol=Math.min(this.getMaxColumn(),r.maxCol),this.fixedWidth=r.fixedWidth,this.fixedHeight=r.fixedHeight,this.gridLine=r.addGridLines,this.showCharts=r.addChart,this.showButtons=r.addButton,this.showImages=r.addImage,this.headerHeight=r.headerHeight,this.footerHeight=r.footerHeight,this.freezedRow=r.freezedRow,this.freezedCol=r.freezedCol,this.isFlip=!!r.isFlip,this.printRange=r.printRange,this.isFitToWidth=r.FitToWidth,this.scaleX=1,this.scaleY=1,this.viewPortHeight=[0,1e6],this.viewPortWidth=[0,1e6],this.emptyCell=new s.Cell(-1,0,0,null,null,null,null,"transparent",0),this.isRendered={},this.lmtExcdNtf=new i.TBNotification(a,{mode:"STD",showCloseBtn:!0}),this.computePageCoordinates(),this.findOLEPos()}function l(t,e,i,s,n){var r=document.createElement("div");if(r.style.zIndex="261",r.style.position="absolute",r.style.top=h?e:parseFloat(e)*s+"px",r.style.left=h?i:parseFloat(i)*s+"px",r.style.height=t.height+"px",r.style.width=t.width+"px",r.style.textAlign="center",r.innerText=t.label,r.className="ZSOLEBtn",h?r.style.zoom=s:(r.style.transform="scale("+s+")",r.style.transformOrigin="0 0"),n){var a=r.style.left;r.style.left=r.style.right,r.style.right=a}return r}function d(t,e,i,s,n){var r=t.chartInstance[0].renderTo.id,a=document.getElementById(r).parentElement.parentElement.cloneNode(!0);if(a.removeAttribute("id"),a.style.position="absolute",a.style.zIndex="261",a.style.top=h?e:parseFloat(e)*s+"px",a.style.left=h?i:parseFloat(i)*s+"px",h?a.style.zoom=s:(a.style.transform="scale("+s+")",a.style.transformOrigin="0 0"),n){var o=a.style.left;a.style.left=a.style.right,a.style.right=o}return a}function f(t,e,i,s,n,r){for(var a,o=s.length,g=t.getURL(),l=0;l<o;l++)if(s[l].src.contains(g)){a=s[l];break}var d=document.createElement("canvas");d.height=t.getHeight(),d.width=t.getWidth(),d.getContext("2d").drawImage(a,0,0,d.width,d.height);var f=d.toDataURL("image/svg"),p=document.createElement("img");if(p.src=f,p.height=t.getHeight(),p.width=t.getWidth(),p.style.position="absolute",p.style.top=h?e:parseFloat(e)*n+"px",p.style.left=h?i:parseFloat(i)*n+"px",h?p.style.zoom=n:(p.style.transform="scale("+n+")",p.style.transformOrigin="0 0"),p.style.zIndex="261",r){var c=p.style.left;p.style.left=p.style.right,p.style.right=c}return p}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,r=i.topic,n=i.Groups,s=i.Names;function a(i,r,n,s,a){!function(e){var i=t.view.getActiveGridID(),r=t.view.getGridComponent(i);r&&r.setScrollXs(e)}(s),function(e){var i=t.view.getActiveGridID(),r=t.view.getGridComponent(i);r&&r.setScrollYs(e)}(a);var o=t.view.getActiveGridID(),S=t.view.getGridComponent(o);if(S){var c=t.view.getSheetState(o,r),g=S.getScrollYs(),l=S.getScrollXs();e.isRangeGrid?(c.setScrollPosition0(g[0],l[0]),c.setScrollPosition1(0,0)):(c.setScrollPosition0(g[2],l[2]),c.setScrollPosition1(g[1],l[1])),S.updateScroll(function(){I(i,r,n)})}}function o(i,r,n,s,o){var S=t.view.getActiveGridID(),c=t.view.getGridComponent(S);if(c){var I=c.getScrollXs(),g=c.getScrollYs();e.isRangeGrid?(I[0]=s,g[0]=o):(I[2]=s,g[2]=o),a(i,r,n,I,g)}}function S(e,i,r,n,s){var o=t.view.getActiveGridID(),S=t.view.getGridComponent(o);if(S){var c=S.getScrollXs(),I=S.getScrollYs();c[1]=n,I[1]=s,a(e,i,r,c,I)}}function c(t){var i=e.bLimit||32;return{start:Math.max(sPlusPlus.data.Defaults.MIN_ROW,Math.floor((t.start-i)/i)*i),end:Math.min(sPlusPlus.data.Defaults.MAX_ROW-1,Math.ceil((t.end+i)/i)*i),startCol:Math.max(sPlusPlus.data.Defaults.MIN_COL,8*Math.floor((t.startCol-8)/8)),endCol:Math.min(sPlusPlus.data.Defaults.MAX_COL-1,8*Math.ceil((t.endCol+8)/8))}}function I(t,i,r){g(t,i,r),e.getDataCache(t,i,r).load(t,i,r)}function g(i,r,n){var s=t.view.getActiveGridID(),a=t.view.getGridComponent(s);if(a){var o=a.getHeights(),S=a.getWidths(),I=c(a.panes.pane0.grid.iHave),g=e.RangeGridData,l=e.getDataCache(i,r,n);if(g)l.setPane(i,r,n,0,new ZSClass.Range(I.start,I.startCol,I.end,t.data.Defaults.MAX_COL-1));else{o[2]?l.setPane(i,r,n,0,new ZSClass.Range(I.start,I.startCol,I.end,I.endCol)):l.removePane(0);var R=a.panes.pane1.grid.iHave;S[1]&&o[1]?l.setPane(i,r,n,1,new ZSClass.Range(R.start,R.startCol,R.end,R.endCol)):l.removePane(1);var D=a.panes.pane2.grid.iHave,v=c(D);o[1]?l.setPane(i,r,n,2,new ZSClass.Range(D.start,v.startCol,D.end,v.endCol)):l.removePane(2);var E=a.panes.pane3.grid.iHave,d=c(E);S[1]?l.setPane(i,r,n,3,new ZSClass.Range(d.start,E.startCol,d.end,E.endCol)):l.removePane(3)}}}function l(e,i,r){var n=t.view.getActiveGridID(),s=t.view.getGridComponent(n);if(s){s.getHeights();s.onBeforeFill(),g(e,i,r)}}function R(e,i,r,n){var s=getDataCache(e,i,r);for(var a in n){var o=n[a],S=new ZSClass.Range(o[0],o[1],o[2],o[3]);s.iterateRange(S,function(){})}var c=t.view.getActiveGridID();t.view.getGridComponent(c).refreshPanes()}function D(e,i,r){var n=t.view.getActiveGridID(),s=t.view.getGridComponent(n),a=s.interacter.getSheetID();for(var o in r){var S=r[o][0];if(S===a)s.updateLock(),getDataCache(e,S,i).iterateAllRange(function(){}),s.refreshPanes()}s.updateLock()}function v(i,r,n,s){var a=t.view.getActiveGridID();t.view.getGridComponent(a);for(var o in s){var S=new ZSClass.Range(s[o][0],s[o][1],s[o][2],s[o][3]);e.getDataCache(i,r,n).loadBoundaryRange(i,r,n,S)}}function E(e,t,i,r,n,s,a){ApplyOnComputedSheets(e,t,i,function(){var S=function(e,t,i,r,n,s){var a=n.getScrollX(),o=s.getScrollY(),S=n.getWidth(),c=s.getHeight(),I=a+S,g=o+c,l=e,R=t,D=l+i,v=R+r,E=a,O=o;if(d(0,1e5,l,D)){var A=a<l,C=D<I;A?C||(E=D-S):E=l}if(d(0,1e6,R,v)){var f=o<R,u=v<g;f?u||(O=v-c):O=R}return{X:E,Y:O}}(r,n,s,a,this.panes.xAxles[2],this.panes.yAxles[2]);o(e,t,i,S.X,S.Y),UserAction.DummyScroll(this.interacter.getResourceID(),this.interacter.getSheetID(),this.interacter.getVersion())})}function d(e,t,i,r){return e<r&&i<t}e.scrollIntoView=E,r.register(n.Gesture.Selector.Range,s.GESTURE.ACTION.DOWN,function(e,t,i){r.publish(n.Listener,s.Layers.Ole.Blur,{RID:e,SHEETID:t,VERSION:i})},"RID","SHEETID","VERSION"),r.register(n.UserAction,s.SheetAction.SCROLL_POSITION.ScrollIntoView,E,"RID","SHEETID","VERSION","X","Y","WIDTH","HEIGHT"),r.register(n.Listener,s.Browser.ScreenViewport,function(e,t,i,r,n){ApplyOnComputedSheets(e,t,i,function(){this.setDimensions(r,n)})},"RID","SHEETID","VERSION","Width","Height"),r.register(n.Listener,s.SheetMeta.FREEZE,function(e,t,i,r,n){ApplyOnComputedSheets(e,t,i,function(){this.freeze(r,n)})},"RID","SHEETID","VERSION","FreezedRow","FreezedCol"),r.register(n.Listener,s.SheetAction.ZOOM.On,function(e,t,i,r){ApplyOnComputedSheets(e,t,i,function(){this.scale(r,r)})},"RID","SHEETID","VERSION","ZOOM"),r.register(n.Listener,s.GridAction.FLIP,function(e,t,i,r){ApplyOnComputedSheets(e,t,i,function(){this.setFlip(r)})},"RID","SHEETID","VERSION","FLIP"),r.register(n.Listener,s.SheetAction.GRID_LINES.MODIFY,function(e,i,r,n){var s=t.view.getActiveGridID();t.view.getGridComponent(s).refreshPanes()},"RID","SHEETID","VERSION","SHOW_GRID"),r.register(n.UserAction,s.SheetAction.SCROLL_POSITION.DummyScroll,I,"RID","SHEETID","VERSION"),r.register(n.Listener,s.SheetMeta.SCROLL_POSITION0,o,"RID","SHEETID","VERSION","SCROLLLEFT","SCROLLTOP"),r.register(n.Listener,s.SheetMeta.SCROLL_POSITION1,S,"RID","SHEETID","VERSION","SCROLLLEFT","SCROLLTOP"),r.register(n.UserAction,s.SheetAction.SCROLL_POSITION.Relativepane0,function(i,r,n,s,a,S){var c=t.view.getActiveGridID(),I=t.view.getGridComponent(c);if(I){var g=I.getScrollXs(),l=I.getScrollYs();e.isRangeGrid?o(i,r,n,g[0]+s,l[0]+a):o(i,r,n,g[2]+s,l[2]+a)}},"RID","SHEETID","VERSION","DistanceX","DistanceY","Forced"),r.register(n.UserAction,s.SheetAction.SCROLL_POSITION.Relativepane1,function(e,i,r,n,s,a){var o=t.view.getActiveGridID(),c=t.view.getGridComponent(o);if(c){var I=c.getScrollXs(),g=c.getScrollYs();S(e,i,r,I[1]+n,g[1]+s)}},"RID","SHEETID","VERSION","DistanceX","DistanceY","Forced"),r.register(n.UserAction,s.SheetAction.SCROLL_POSITION.Relativepane2,function(e,i,r,n,s,o){var S=t.view.getActiveGridID(),c=t.view.getGridComponent(S);if(c){var I=c.getScrollXs(),g=c.getScrollYs();!function(e,i,r,n,s){var o=t.view.getActiveGridID(),S=t.view.getGridComponent(o);if(S){var c=S.getScrollXs(),I=S.getScrollYs();c[2]=n,I[1]=s,a(e,i,r,c,I)}}(e,i,r,I[2]+n,g[1]+s)}},"RID","SHEETID","VERSION","DistanceX","DistanceY","Forced"),r.register(n.UserAction,s.SheetAction.SCROLL_POSITION.Relativepane3,function(e,i,r,n,s,o){var S=t.view.getActiveGridID(),c=t.view.getGridComponent(S);if(c){var I=c.getScrollXs(),g=c.getScrollYs();!function(e,i,r,n,s){var o=t.view.getActiveGridID(),S=t.view.getGridComponent(o);if(S){var c=S.getScrollXs(),I=S.getScrollYs();c[1]=n,I[2]=s,a(e,i,r,c,I)}}(e,i,r,I[1]+n,g[2]+s)}},"RID","SHEETID","VERSION","DistanceX","DistanceY","Forced"),r.register(n.Listener,s.DocMeta.ACTIVE_SHEET,function(i,r,n){var s=t.view.getActiveGridID(),a=t.view.getGridComponent(s);if(a){var o,S,c,I,g=e.RangeGridData;g&&(o=g.startRow,S=g.startCol,c=g.endRow,I=g.endCol);var l=new ZSClass.Interacter(s,i,r,n,o,S,c,I);a.setInteracter(l)}},"RID","ACTIVE_SHEET","VERSION"),r.register(n.Listener,s.DocAction.DATAVALIDATION.HIGHLIGHT_INVALID_DATA,function(e,i,r){var n=t.view.getActiveGridID(),s=t.view.getGridComponent(n),a=!!t.data.UserInfo.HighlightInvalidData;ZSGrid.Nodes.InvalidDVCue.setHighlightInvalidData(a),s.refreshPanes()},"RID","SHEETID","VERSION"),r.register(n.Listener,s.SheetAction.DATAVALIDATION.REMOVE,R,"RID","SHEETID","VERSION","RangeList"),r.register(n.Listener,s.SheetMeta.DATAVALIDATION,R,"RID","SHEETID","VERSION","RangeList"),r.register(n.Listener,s.SheetAction.DATAVALIDATION.ADD,R,"RID","SHEETID","VERSION","RangeList"),r.register(n.Listener,s.DocMeta.PROTECTED_SHEETS,D,"RID","VERSION","PROTECTED_SHEETS"),r.register(n.Listener,s.DocAction.PROTECTED_SHEETS.MODIFY,D,"RID","VERSION","MODIFY"),r.register(n.Listener,s.DocAction.PROTECTED_SHEETS.REMOVE,D,"RID","VERSION","REMOVE"),r.register(n.Listener,s.SheetMeta.PROTECTED_RANGES,v,"RID","SHEETID","VERSION","RangeList"),r.register(n.Listener,s.SheetAction.PROTECTED_RANGES.REMOVE,v,"RID","SHEETID","VERSION","RangeList"),r.register(n.Listener,s.SheetAction.PROTECTED_RANGES.MODIFY,v,"RID","SHEETID","VERSION","RangeList"),r.register(n.Selector.BoundUpdate.Range,s.Selection.BOUND_UPDATE.ADD,function(e,i,r,n){var s=t.view.getActiveGridID(),a=t.view.getGridComponent(s),o=a.getInteracter();a.refreshHeaders(o)},"RID","SHEETID","VERSION","RANGE"),r.register(n.UI,s.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES,function(){var e=t.view.getActiveGridID(),i=t.view.getGridComponent(e);ZSGrid.Nodes.VersionHighlight.setHighlightChanges(!1),i.refreshPanes()}),r.register(n.UI,s.SidePanel.VersionHistory.HIGHLIGHT_CHANGES,function(){var e=t.view.getActiveGridID(),i=t.view.getGridComponent(e);ZSGrid.Nodes.VersionHighlight.setHighlightChanges(!0),i.refreshPanes()}),r.register(n.Listener,s.SheetAction.LOCK_PATTERN,function(e,i,r,n){ZSGrid.Nodes.Pattern.setVisibility(n);var s=t.view.getActiveGridID();t.view.getGridComponent(s).refresh()},"RID","SHEETID","VERSION","SHOW"),r.register(n.UserAction,s.SheetAction.DATAFILTER.ONAPPLY,function(e,t,i,r){l(e,t,i);var n=getDataCache(e,t,i),s=r.startRow,a=r.startCol,o=r.endCol;if(n.getBoundary()){var S=new ZSClass.Range(s,a,s,o);n.iterateRange(S,function(){}),n.isRefreshGridRequested=!0;var c=[];for(var I in n.Panes){var g=n.Panes[I];r=new ZSClass.Range(g.startRow,g.startCol,g.endRow,g.endCol),c.push(r)}n.getRows(e,t,i,c,function(){n.isRefreshGridRequested=!1,n.refreshGrid()})}},"RID","SHEETID","VERSION","FRANGE"),r.register(n.UserAction,s.SheetAction.DATAFILTER.REMOVE,function(e,t,i,r,n){l(e,t,i);var s=getDataCache(e,t,i);if(r){var a=r.startRow,o=r.startCol,S=r.endCol,c=new ZSClass.Range(a,o,a,S);s.iterateRange(c,function(){}),s.isRefreshGridRequested=!0;var I=[];for(var g in s.Panes){var R=s.Panes[g],D=new ZSClass.Range(R.startRow,R.startCol,R.endRow,R.endCol);I.push(D)}s.getRows(e,t,i,I,function(){s.isRefreshGridRequested=!1,s.refreshGrid()})}else s.iterateAllRange()},"RID","SHEETID","VERSION","RANGE")}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,n=i.topic,o=i.Groups,s=i.Names;function r(e,i,n,o,s,r){var E;switch(o){case"INSERTCOL":E=a;break;case"INSERTROW":E=l;break;case"DELETECOL":E=h;break;case"DELETEROW":E=c;break;default:E=function(){}}var S,R=this.interacter.getGridID(),g=(e=this.interacter.getResourceID(),i=this.interacter.getSheetID(),n=this.interacter.getVersion(),t.view.getSheetState(R,i)),v=t.data.getWorkBook(e,n).getSheetObj(i).Merge;switch(o){case"INSERTCOL":case"INSERTROW":case"DELETECOL":case"DELETEROW":case"HIDEROW":case"SHOWROW":case"HIDECOL":case"SHOWCOL":case"RESIZEROW":case"RESIZECOL":S=function(e){};break;default:S=function(e){var t=e.getRange();v.extendRange(t),e.startRow=t.startRow,e.startCol=t.startCol,e.endRow=t.endRow,e.endCol=t.endCol}}var I=this.CopySelection.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.CopySelection.place(u)}I=this.DataValidation&&this.DataValidation.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.DataValidation.place(u)}I=this.DataValidationButton&&this.DataValidationButton.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.DataValidationButton.place(u)}I=this.FillSeriesSelectionCue.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.FillSeriesSelectionCue.place(u)}I=this.HighlightComments&&this.HighlightComments.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.HighlightComments.place(u)}I=this.HighlightLocks.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.HighlightLocks.place(u)}I=this.PasteWidget.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.PasteWidget.place(u)}I=this.Precedance.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.Precedance.place(u)}I=this.RangeHighlight.getAlive();for(var A in I){var u=I[A];this.RangeHighlight.place(u)}I=this.RangePicker.getAlive();for(var A in I){u=I[A];this.RangePicker.place(u)}I=this.PivotPlaceHolder&&this.PivotPlaceHolder.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.PivotPlaceHolder.place(u)}I=this.RangeSelection.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),g.addSelection(u.getRange(),u.getID()),this.RangeSelection.place(u)}I=this.RecalculateFlash.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.RecalculateFlash.place(u)}I=this.Selection.getAlive();for(var A in I){S(u=I[A]),E(u,s,r);var O=u.getRange();g.setActiveCellRange(void 0,O,O.startRow,O.startCol),this.Selection.place(u)}I=this.UserPresence.getAlive();for(var A in I){S(u=I[A]),E(u,s,r),this.UserPresence.place(u)}I=this.Image&&this.Image.getAlive();for(var A in I){u=I[A];this.Image.place(u)}I=this.Button&&this.Button.getAlive();for(var A in I){u=I[A];this.Button.place(u)}I=this.Chart&&this.Chart.getAlive();for(var A in I){u=I[A];this.Chart.place(u)}I=this.Notes&&this.Notes.getAlive();for(var A in I){u=I[A];this.Notes.place(u)}}function a(e,t,i){e.endCol>=t&&(e.endCol+=i),e.startCol>=t&&(e.startCol+=i),e.startCol>e.endCol&&(e.endCol=e.startCol)}function l(e,t,i){e.endRow>=t&&(e.endRow+=i),e.startRow>=t&&(e.startRow+=i),e.startRow>e.endRow&&(e.endRow=e.startRow)}function h(e,t,i){var n=e.startCol,o=e.endCol;n>t&&(n=(n-=i)<t?t:n,e.startCol=n),t<=o&&(n>(o=t<=(o-=i)?o:t-1)&&(o=n),e.endCol=o)}function c(e,t,i){var n=e.startRow,o=e.endRow;n>t&&(n=(n-=i)<t?t:n,e.startRow=n),t<=o&&(n>(o=t<=(o-=i)?o:t-1)&&(o=n),e.endRow=o)}function E(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i)})}function S(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"ZOOM")})}n.register(o.Listener,s.GridAction.CLIENTFIRSTACTIONS,function(e,t,i,n,o,s){switch(n.action?n.action:n){case"RESIZEROW":case"RESIZECOL":ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i)})}},"RID","SHEETID","VERSION","ACTION","RANGELIST","VALUE"),n.register(o.Listener,s.GridAction.FLIP,function(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i)})},"RID","SHEETID","VERSION","FLIP"),n.register(o.Listener,s.SheetAction.ROW_HEADERS.INSERT,function(e,t,i,n,o){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"INSERTROW",n,o)})},"RID","SHEETID","VERSION","start","count"),n.register(o.Listener,s.SheetAction.ROW_HEADERS.DELETE,function(e,t,i,n,o){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"DELETEROW",n,o)})},"RID","SHEETID","VERSION","start","count"),n.register(o.Listener,s.SheetAction.COLUMN_HEADERS.INSERT,function(e,t,i,n,o){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"INSERTCOL",n,o)})},"RID","SHEETID","VERSION","start","count"),n.register(o.Listener,s.SheetAction.COLUMN_HEADERS.DELETE,function(e,t,i,n,o){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"DELETECOL",n,o)})},"RID","SHEETID","VERSION","start","count"),n.register(o.Listener,s.SheetAction.ROW_HEADERS.RESIZE.ENUMERATE,function(e,t,i,n,o){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"RESIZEROW",n,o)})},"RID","SHEETID","VERSION","START","COUNT","STYLENAME","xaid"),n.register(o.Listener,s.SheetAction.COLUMN_HEADERS.RESIZE.ENUMERATE,function(e,t,i,n,o){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"RESIZECOL",n,o)})},"RID","SHEETID","VERSION","START","COUNT","STYLENAME","xaid"),n.register(o.Listener,s.SheetAction.MERGE_CELLS.META,E,"RID","SHEETID","VERSION","MergeList"),n.register(o.Listener,s.SheetAction.MERGE_CELLS.ADD,E,"RID","SHEETID","VERSION","MergeList"),n.register(o.Listener,s.SheetAction.MERGE_CELLS.REMOVE,function(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i)})},"RID","SHEETID","VERSION","MergeList"),n.register(o.Listener,s.SheetAction.ZOOM.On,S,"RID","SHEETID","VERSION","ZOOM"),n.register(o.Listener,s.SheetMeta.FREEZE,S,"RID","SHEETID","VERSION"),n.register(o.UserAction,s.SheetAction.DATAFILTER.ONAPPLY,function(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i)})},"RID","SHEETID","VERSION","FRANGE","FACOLS","FROWS","START"),n.register(o.UserAction,s.SheetAction.DATAFILTER.REMOVE,function(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i)})},"RID","SHEETID","VERSION","RANGE"),n.register(o.Listener,s.SheetMeta.FREEZE,function(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i)})},"RID","SHEETID","VERSION","FreezedRow","FreezedCol"),n.register(o.Listener,s.SheetAction.HIDECOLS.ON_AFTER_ADD,function(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"HIDECOL")})},"RID","SHEETID","VERSION","start","count"),n.register(o.Listener,s.SheetAction.HIDECOLS.ON_AFTER_REMOVE,function(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"SHOWCOL")})},"RID","SHEETID","VERSION","start","count"),n.register(o.Listener,s.SheetAction.HIDEROWS.ON_AFTER_ADD,function(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"HIDEROW")})},"RID","SHEETID","VERSION","start","count"),n.register(o.Listener,s.SheetAction.HIDEROWS.ON_AFTER_REMOVE,function(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i,"HIDECOL")})},"RID","SHEETID","VERSION","start","count"),n.register(o.UserAction,s.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,function(e,i,n,o){ApplyOnComputedSheets(e,i,n,function(){(function(){var e=this.interacter.getGridID(),i=this.interacter.getResourceID(),n=this.interacter.getSheetID(),o=this.interacter.getVersion(),s=(t.view.getSheetState(e,n),t.data.getWorkBook(i,o).getSheetObj(n).Merge,this.CopySelection.getAlive());for(var r in s){var a=s[r];this.CopySelection.remove(a)}for(var r in s=this.DataValidation&&this.DataValidation.getAlive())a=s[r],this.DataValidation.remove(a);for(var r in s=this.DataValidationButton&&this.DataValidationButton.getAlive())a=s[r],this.DataValidationButton.remove(a);for(var r in s=this.FillSeriesSelectionCue.getAlive())a=s[r],this.FillSeriesSelectionCue.remove(a);for(var r in s=this.HighlightComments&&this.HighlightComments.getAlive())a=s[r],this.HighlightComments.remove(a);for(var r in s=this.HighlightLocks.getAlive())a=s[r],this.HighlightLocks.remove(a);for(var r in s=this.PasteWidget.getAlive())a=s[r],this.PasteWidget.remove(a);for(var r in s=this.Precedance.getAlive())a=s[r],this.Precedance.remove(a);for(var r in s=this.RangeHighlight.getAlive())a=s[r],this.RangeHighlight.remove(a);for(var r in s=this.RangePicker.getAlive())a=s[r],this.RangePicker.remove(a);for(var r in s=this.PivotPlaceHolder&&this.PivotPlaceHolder.getAlive())a=s[r],this.PivotPlaceHolder.remove(a);for(var r in s=this.RangeSelection.getAlive())a=s[r],this.RangeSelection.remove(a);for(var r in s=this.RecalculateFlash.getAlive())a=s[r],this.RecalculateFlash.remove(a);for(var r in s=this.Selection.getAlive())a=s[r],this.Selection.remove(a);for(var r in s=this.UserPresence.getAlive())a=s[r],this.UserPresence.remove(a);for(var r in s=this.Image&&this.Image.getAlive())a=s[r],this.Image.remove(a);for(var r in s=this.Button&&this.Button.getAlive())a=s[r],this.Button.remove(a);for(var r in s=this.Chart&&this.Chart.getAlive())a=s[r],this.Chart.remove(a);for(var r in s=this.Notes&&this.Notes.getAlive())a=s[r],this.Notes.remove(a)}).call(this)})},"RID","SHEETID","VERSION","TARGET_SHEET"),n.register(o.Listener,s.SheetMeta.GRIDVIEW,function(e,t,i){ApplyOnComputedSheets(e,t,i,function(){r.call(this,e,t,i)})},"RID","SHEETID","VERSION")}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSClass,i=e.ZSEvents,r=i.topic,o=i.Groups,a=i.Names,s=t.view.measures,c=e.document.body,l={};t.view.getGridComponent=function(e){return l[e]},t.view.getActiveGridID=function(){return t.view.Defaults.defaultGrid},t.view.getResourceID=function(e){var n=t.view.getGridComponent(e);return n&&n.interacter.getResourceID()},t.view.getSheetID=function(e){var n=t.view.getGridComponent(e);return n&&n.interacter.getSheetID()},t.view.getVersionID=function(e){var n=t.view.getGridComponent(e);return n&&n.interacter.getVersion()},e.ApplyOnComputedSheets=function(e,t,n,i){for(var r in l){var o=l[r];i.apply(o,arguments)}};!function(i){var u=window.innerHeight-s.Top.Height-s.Bottom.Height,v=window.innerWidth-s.Right.Width-s.Left.Width,d=document.querySelector(".gridContainer");d.innerHTML="";var g=new n.DummyInteracter(i),h=(g.getResourceID(),g.getSheetID(),g.getVersion(),g.getState()),S=g.getFreezedRow(),f=g.getFreezedCol(),p=g.getIsFlip(),w=l[i]=new e.ZSGrid.UISheetGrid(g,d,0,0,v,u,S,f,g.getZoom(),p,h.getScrollLefts(),h.getScrollTops());c.classList.contains("shRtl")&&w.setLeft(t.view.measures.Right.sidePanelBar);var I=w.getWidths(),D=w.getHeights();h.setScreenWidths(I[2],I[1]),h.setScreenHeights(D[2],D[1]);var m,R,L,A,O=300,Y=25,E=0,X=0,G={SLOW:0,NORMAL:1,FAST:2,VERY_FAST:3},T=-1!==e.navigator.userAgent.indexOf("Firefox"),C=-1!==e.navigator.platform.indexOf("Win"),F=-1!==e.navigator.platform.indexOf("Linux");T&&(C||F)?(R=function(e,t,n){var i,r;switch(n){case G.SLOW:r=70,i=25;break;case G.NORMAL:r=150,i=40;break;case G.FAST:r=200,i=50;break;case G.VERY_FAST:r=400,i=70}return{deltaX:e/3*r,deltaY:t?t/3*i:0}},L=function(){var e=Date.now();return m=e-X,X=e,m>O?(E=0,G.SLOW):++E>Y?E>80?G.VERY_FAST:G.FAST:G.NORMAL}):(R=function(e,t,n){return{deltaX:e,deltaY:t}},L=function(){return 0}),d.addEventListener("wheel",function(e,n){if(-1==e.path.indexOf(w.fifthPane)){e.preventDefault(),e.stopPropagation();var i=w.getFlip(),s=t.view.getActiveGridID(),c=t.view.getResourceID(s),l=t.view.getSheetID(s),u=t.view.getVersionID(s),v=t.view.getSheetState(s,l),d=w.translateCoordinates(e),g=R(e.deltaX,e.deltaY,L());w.scroll(w.interacter,d.x,d.y,g.deltaX*(i?-1:1),g.deltaY),r.publish(o.Listener,a.GridAction.WheelXYPaneContainerScroll,{RID:c,SHEETID:l,VERSION:u}),r.publish(o.UserAction,a.SheetAction.SCROLL_POSITION.DummyScroll,{RID:c,SHEETID:l,VERSION:u});var h=w.getScrollYs(),S=w.getScrollXs();return v.setScrollPosition0(h[2],S[2]),v.setScrollPosition1(h[1],S[1]),!1}},{passive:!1,capture:!0}),d.addEventListener("touchmove",function(e,t){if(e.preventDefault(),e.stopPropagation(),!A)return A=e,!1;var n=e.touches[0].clientX-(A?A.touches[0].clientX:0),i=e.touches[0].clientY-(A?A.touches[0].clientY:0);A=e;var r=e.touches[0],o=new WheelEvent("wheel",{deltaX:-n,deltaY:-i,clientX:r.clientX,clientY:r.clientY,screenX:r.screenX,screenY:r.screenY});return r.target.dispatchEvent(o),!1},{passive:!1,capture:!0}),d.addEventListener("touchend",function(e){A=void 0})}(t.view.getActiveGridID());t.view||(t.view={})}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSEvents,i=o.topic,s=o.Groups,n=o.Names,r=e.ZSClass,a=r.UICellNote,l=(t.data.Defaults.MAX_COL,r.Layer||(r.Layer={})),c=l.Interface,u=(l.Modules.Main,l.Notes),d={Container:{mouseover:function(){u.NotesEditLayer.show()},mouseleave:function(){!u.NotesEditLayer.Focused&&u.NotesEditLayer.hide()}},Editor:{focus:function(){if(!u.NotesEditLayer.Focused){u.NotesEditLayer.Focused=!0,t.data.UserInfo.Permission.isScrollable=!1;var o=e.sPlusPlus.view.Events.Key;o.focusContext(o.Entry.CellNote.Context),e.JSUtil.Mouse.BindOnExternalClick(u.NotesEditLayer.Dom,h)}},dblclick:function(e){e.stopPropagation()}},Trash:{click:function(){u.NotesEditLayer.removeComment(),u.NotesEditLayer.hide()}},onHide:function(){if(u.NotesEditLayer&&u.NotesEditLayer.isFocused()){u.NotesEditLayer.Focused=!1,t.data.UserInfo.Permission.isScrollable=!0;var o=e.sPlusPlus.view.Events.Key;o.focusContext(o.Entry.CellEditor.Context)}}};function h(){u.NotesEditLayer.updateComment(),u.NotesEditLayer.hide()}function f(){this.Container=document.createElement("div"),a.call(this,this.Container,d),this.Dom.classList.add("fifthPane"),this.Focused=!1}f.prototype={place:function(o,i,s,n,r,l){this.interacter=o,this.controller=i;var c=t.view.getGridComponent(sPlusPlus.view.getActiveGridID());c.fifthPane.appendChild(this.Container);var u=c.getFlip();a.prototype.place.call(this,s,n,r,l,u),this.show();var d=e.sPlusPlus.view.Events.Key;d.focusContext(d.Entry.CellNote.Context)},getInteracter:function(){return this.interacter},updateComment:function(){var e=this.interacter.getRange();this.controller.CellComment(this.interacter,this.isAdd?"add":"edit",this.Comment.value,e)},removeComment:function(){var e=this.interacter.getRange();this.controller.CellComment(this.interacter,"remove","",e)},isFocused:function(){return this.Focused}};var m=[a];f.prototype=c.implement(f,m),i.register(s.UI,n.Layout.TEMPLATE_LOADED,function(){u.NotesEditLayer=new f})}(this);
!function(e){var t=e.ZSClass,o=e.sPlusPlus,i=e.ZSEvents,s=i.topic,r=i.Groups,n=i.Names,a=(t.Layer||(t.Layer={})).Notes,l=a.Interacter,E=222,d=127,g=1,C=!1;function N(e,i,s,r,n){var a=o.data.getWorkBook(e,s).getSheetObj(i),l=o.view.getActiveGridID(),C=sPlusPlus.view.getGridComponent(l),N=C.interacter,O=N.getColX(n),L=N.getRowY(r),u=C.getWidths(),c=C.getHeights(),S=u[2]+u[1],h=c[2]+c[1],R=C.getFreezedCol(),M=C.getFreezedRow(),I=new t.Range(r,n,r,n),f=(I=a.Merge.extendRange(I),N.getColX(N.getNextNonHiddenCol(I.endCol))),D=N.getRowY(N.getNextNonHiddenRow(I.endRow)),y=C.getScrollX(n,R),A=C.getScrollY(r,M),p=C.getZoom();O-=y/=p,L-=A/=p,f-=y,D-=A,O*=p,L*=p;var v=(f*=p)+E>=S,T=(D*=p)+d>=h;return{x:v?S-O+g:f-g,y:T?h-D+g:L-g,fixRight:v,fixBottom:T}}function O(e){return e%o.data.Defaults.MAX_COL}function L(e,t,i){var s,r=o.data.getWorkBook(e,i).getSheetObj(t).Notes.getMap();for(var n in r){u(e,t,i,(s=n,Math.floor(s/o.data.Defaults.MAX_COL)),O(n),r[n])}C=!0}function u(e,t,i,a,l,E){var d=o.data.getWorkBook(e,i).getSheetObj(t),g=d.Column.axis,C=d.Row.auxiliaryAxis,N=d.Merge.isXists(a,l),O=g.getPos((N?N.root.endCol:l)+1),L=C.getPos(a);s.publish(r.Listener,n.Layers.Note.Place,{RID:e,SHEETID:t,VERSION:i,ROW:a,COL:l,COMMENT:E.value,X:E.x||O+10,Y:E.y||L-10,ROWX:O,COLY:L})}function c(){a.NotesEditLayer&&!a.NotesEditLayer.isFocused()&&a.NotesEditLayer.hide()}s.register(r.Listener,n.CellAction.COMMENT.NEW,function(t,i,s,r,n){ApplyOnComputedSheets(t,i,s,function(){var E=N(t,i,s,r,n),d=o.data.getWorkBook(t,s).getSheetObj(i),g=e.JSUtil.Math.hash(r,n,o.data.Defaults.MAX_COL),C=d.Notes.get(g),O=C?C.value:"",L=new l(this.interacter,t,i,s,r,n);a.NotesEditLayer.place(L,this.Notes,E.x,E.y,E.fixRight,E.fixBottom),a.NotesEditLayer.setComment(r,n,O,!0),a.NotesEditLayer.show(),a.NotesEditLayer.focus()})},"RID","SHEETID","VERSION","ROW","COL"),s.register(r.Listener,n.CellAction.COMMENT.SHOW,function(t,i,s,r,n){ApplyOnComputedSheets(t,i,s,function(){if(!C&&!a.NotesEditLayer.isFocused()){var E=o.data.getWorkBook(t,s),d=E.getSheetObj(i),g=e.JSUtil.Math.hash(r,n,o.data.Defaults.MAX_COL),O=d.Notes.get(g),L=N(t,i,s,r,n),u=o.view.getActiveGridID(),c=(o.view.getSheetState(u,i),d.ProtectedRanges.isXists(r,n)),S=E.ProtectedSheets.isSheetLocked(i),h=new l(this.interacter,t,i,s,r,n);a.NotesEditLayer.place(h,this.Notes,L.x,L.y,L.fixRight,L.fixBottom),a.NotesEditLayer.setComment(r,n,O.value),!E.isEditable()||c||S?a.NotesEditLayer.disable():a.NotesEditLayer.enable()}})},"RID","SHEETID","VERSION","ROW","COL"),s.register(r.Listener,n.CellAction.COMMENT.HIDE,c),s.register(r.Listener,n.CellAction.COMMENT.UPDATE,function(){e.JSUtil.Mouse.UnbindExternalClick(),a.NotesEditLayer.updateComment(),a.NotesEditLayer.hide()}),s.register(r.Listener,n.CellAction.COMMENT.CANCEL,function(e,t,o){ApplyOnComputedSheets(e,t,o,function(){a.NotesEditLayer.hide()})},"RID","SHEETID","VERSION"),s.register(r.Listener,n.CellAction.COMMENT.SHOWALL,L,"RID","SHEETID","VERSION"),s.register(r.Listener,n.CellAction.COMMENT.HIDEALL,function(e,t,o){s.publish(r.Listener,n.Layers.Note.RemoveAll,{RID:e,SHEETID:t,VERSION:o}),C=!1},"RID","SHEETID","VERSION"),s.register(r.Listener,n.CellAction.COMMENT.ADD,function(t,i,s,r,n,a){ApplyOnComputedSheets(t,i,s,function(){var l,E=o.data.getWorkBook(t,s).getSheetObj(i),d=e.JSUtil.Math.hash(r,n,o.data.Defaults.MAX_COL);l=a,a={value:e.decodeURIComponent(l[0]),x:~~l[1],y:~~l[2]},E.Notes.set(d,a),C&&u(t,i,s,r,n,a)})},"RID","SHEETID","VERSION","ROW","COL","COMMENT"),s.register(r.Listener,n.CellAction.COMMENT.DELETE,function(t,i,a,l,E){ApplyOnComputedSheets(t,i,a,function(){var d=o.data.getWorkBook(t,a).getSheetObj(i),g=e.JSUtil.Math.hash(l,E,o.data.Defaults.MAX_COL);d.Notes.get(g)&&(d.Notes.remove(g),C&&function(e,t,o,i,a){s.publish(r.Listener,n.Layers.Note.Remove,{RID:e,SHEETID:t,VERSION:o,ROW:i,COL:a})}(t,i,a,l,E))})},"RID","SHEETID","VERSION","ROW","COL"),s.register(r.Listener,n.GridAction.WheelXYPaneContainerScroll,c)}(this);
!function(t){var e=t.ZSClass,i=t.sPlusPlus,n=e.Layer||(e.Layer={}),s=(n.Interface,n.Modules.Main),r=(t.JSUtil,e=t.ZSClass,n.Button),a=t.ZSEvents,o=a.topic,c=a.Groups,l=a.Names,u=document.createElement("div");function h(t){t.stopPropagation()}function d(e){switch(t.JSUtil.Key.getKeyCombination(e)){case t.ZSConstants.JSKeyCode.ENTER:return!0}}function v(){r.UIButton.call(this),this.Dom.classList.add("fifthPane");var t=this,e={valueChanged:function(e){t.interacter.setLabel(t.Editor.value)}};this.Editor.addListeners(e),this.Editor.customPreventDefault=d}u.classList.add("ZSOLEBtnMask"),u.addEventListener("click",function(){var t=r.EditLayer.getInteracter();o.publish(c.Listener,l.UserAction.BUTTONS.SUBMITEDIT,{RID:t.rID,SHEETID:t.sheetID,VERSION:t.version})}),v.prototype={place:function(e,n){e.appendChild(u),this.parent=e,this.interacter=n;var r=n.getAbsoluteX(),a=n.getAbsoluteY(),o=n.getWidth(),c=n.getHeight(),l=n.getLabel();s.Layer.prototype.onPlace.call(this,r,a,o,c),this.Editor.value=l,this.Editor.setSelectionRange(l.length,l.length);var d=i.view.Events.Key;d.focusContext(d.Entry.ButtonEdit.Context),this.active=!0,t.addEventListener("wheel",h,!0)},remove:function(){u.remove(),this.Dom.remove(),this.active=!1,t.removeEventListener("wheel",h,!0)},getInteracter:function(){return this.interacter},isActive:function(){return this.active},isRTL:function(){return this.interacter.interacter.getFlip()}},r.EditLayer=new v}(this);
!function(t){var e=t.ZSClass,i=(t.sPlusPlus,t.ZSEvents),n=i.topic,r=i.Groups,s=i.Names,o=e.Layer.Button.Interacter;n.register(r.Listener,s.UserAction.BUTTONS.EDIT,function(t,e,i,n){ApplyOnComputedSheets(t,e,i,function(){n=n||function(){var t=this.Button.getActive();for(var e in t)return e}.call(this);var t=new o(this.interacter,n);this.Button.placeEdit(t)})},"RID","SHEETID","VERSION","ID"),n.register(r.Listener,s.UserAction.BUTTONS.CANCELEDIT,function(t,i,n,r){ApplyOnComputedSheets(t,i,n,function(){var t=e.Layer.Button;if(t.EditLayer.isActive()){var i=t.EditLayer.getInteracter().getID(),n=new o(this.interacter,i);this.Button.removeEdit(n)}})},"RID","SHEETID","VERSION","ID"),n.register(r.Listener,s.UserAction.BUTTONS.SUBMITEDIT,function(t,i,n,r){ApplyOnComputedSheets(t,i,n,function(){var t=e.Layer.Button;if(t.EditLayer.isActive()){var i=t.EditLayer.getInteracter();this.Button.submitEdit(i),this.Button.focus(i.getID())}})},"RID","SHEETID","VERSION","ID")}(this);
