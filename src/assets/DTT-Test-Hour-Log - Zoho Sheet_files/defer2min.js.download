!function(t){var e=function(){this.init()};e.prototype={init:function(){this.head={},this.head.length=0,this.head.next=this.head,this.head.prev=this.head,this.last=this.head},moveBackward:function(){if(0===this.head.length)return null;this.last=this.last.prev;var t=this.last.data;return this.display(),t},moveForward:function(){if(0===this.head.length)return null;this.last=this.last.next;var t=this.last.data;return this.display(),t},get:function(){return 0!==this.head.length?this.head.prev.data:null},getSize:function(){return this.head.length},isEmpty:function(){return 0===this.head.length},remove:function(t){t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev,this.head.length--},insertLast:function(t){var e={data:t,next:null,prev:null};e.prev=this.head.prev,e.next=this.head,this.head.prev.next=e,this.head.prev=e,this.last=e,this.head.length++},removeAll:function(t){if(t!==this.head){var e=t.next,h=this.head.prev;this.head.prev=t,t.next=this.head,delete e.prev,delete h.next}},display:function(){for(var t=this.head.next,e="%cHEAD%c -> ";t!==this.head;)t!==this.last?e+=t.data+" -> ":e+="%c"+t.data+" %c-> ",t=t.next;return e},iterate:function(t){var e=Array.prototype.slice.call(arguments,1),h=this.head.length,i=this.head.prev;for(e.unshift(i.data);h>0;)t.apply(void 0,e),i=i.prev,h--}},t.ZSClass.UndoRedoQueue=e}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSClass,o=s.UndoRedoQueue,i=function(){o.apply(this,arguments),this.lastAction=null,this.MAX=e.data.Defaults.MAX_UNDOREDO_COUNT,this.counter=new s.UndoRedoCounter,this.UndoTransientAO={},this.RedoTransientAO={}};(i.prototype=o.prototype).add=function(t){this.head.length>=this.MAX&&this.remove(this.head.next),this.last.next===this.head?this.insertLast(t):(this.removeAll(this.last),this.insertLast(t)),this.counter.add()},i.prototype.undo=function(){this.last!==this.head&&(this.moveBackward(),this.counter.undo())},i.prototype.redo=function(){this.last.next!==this.head?(this.moveForward(),this.counter.redo()):this.head.next!==this.head.prev&&(this.add(this.last.data),this.counter.redo())},i.prototype.getNextNthData=function(t){for(var e=this.last,s=0;s<t;s++)e=e.next;return e.data},i.prototype.getPrevNthData=function(t){for(var e=this.last.next,s=0;s<t;s++)e=e.prev;return e.data},i.prototype.deQueue=function(t){for(var e=this.last,s=0;s<t;s++)e=e.next;this.remove(e)},i.prototype.isUndoPossible=function(){return this.counter.isUndoPossible()},i.prototype.isRedoPossible=function(){return this.counter.isRedoPossible()},i.prototype.getLastAction=function(){return this.lastAction},i.prototype.setLastAction=function(t){this.lastAction=t},s.UndoRedo=i}(this);
!function(o){var t=o.ZSDevTools.Logger,n=function(){this.redo_counter=0,this.undo_counter=0,this.MAX=o.sPlusPlus.data.Defaults.MAX_UNDOREDO_COUNT};n.prototype={isUndoPossible:function(){return!!this.undo_counter},isRedoPossible:function(){return!!this.redo_counter},add:function(o){this.undo_counter<this.MAX&&this.undo_counter++,this.redo_counter=0},undo:function(){return this.undo_counter?(this.undo_counter--,this.redo_counter++,!0):(t.log("No more Undo actions!!!"),!1)},redo:function(){return this.undo_counter<this.MAX&&this.undo_counter++,!!this.redo_counter&&(this.redo_counter--,!0)}},o.ZSClass.UndoRedoCounter=n}(this);
!function(t){t.sPlusPlus;var i=t.ZSClass;function n(t){this.id=t}n.prototype={get:function(){return this.id},getNiceUrl:function(){return"/comments/"+this.id}},i.CommentState=n}(this);
!function(t){function n(t,n,i,e,s,r){this.id=t,this.description=n,this.arguments=i,this.returntype=e,this.script=null,this.functionScope=r}n.prototype={setScript:function(t){this.script=t},setDescription:function(t){this.description=t},setArguments:function(t){this.arguments=t},setReturnType:function(t){this.returntype=t},setId:function(t){this.id=t},setScope:function(t){this.functionScope=t},getScope:function(){return this.functionScope},getScript:function(){return this.script},getDescription:function(){return this.description},getArguments:function(){return this.arguments},getReturnType:function(){return this.returntype},getId:function(){return this.id}},t.ZSClass.DelugeFunction=n}(this);
!function(a){a.sPlusPlus;var e=a.UserAction;a.JSUtil;ZSClass.FindTable=function(a,t,n,r,o){e.getDataTable(a,t,n,r,function(e){var t,r,l,s,i={};if(e.successful){var C={};if(e.unavailable){var g=JSUtil.Range.parseRange(a,n,e.rangeLabel);C.startRow=g.range.startRow,C.endRow=g.range.endRow,C.startCol=g.range.startCol,C.endCol=g.range.endCol}else C.startRow=e.stRow,C.endRow=e.enRow,C.startCol=e.stCol,C.endCol=e.enCol;var R=(t=C.startCol,r=C.startRow,l=C.endCol,s=C.endRow,JSUtil.Object.getCharForNum(t+1)+""+(r+1)+":"+JSUtil.Object.getCharForNum(l+1)+(s+1));i.range=C,i.rangeLabel=R}o&&o(i)})}}(this);
!function(e){var t,r,i,n,a,o,s,l,c,u=e.sPlusPlus,p=(e.ZSConstants.FeatureConstants,e.document),h=(e.ZSConstants.wCC,e.ZSConstants.I18N),d=(e.ZSConstants.JSKeyCode,e.ZSEvents),g=d.topic,v=d.Groups,y=d.Names,I=(u.SML.Client,e.UIUtil.Component),m=e.ZSClass,S=m.Editors,f=e.JSUtil,D=m.RangePicker,A=e.UserAction,C=(f.fn,e.ZSConstants.FeatureConstants),E=u.view.Toolbar.Feature[C.DATA_CLEANING],R=(m.SidePanel,m.SidePanelClassList),w=(R.right,R.right,u.view.measures,u.view.Toolbar.Feature[C.DATA_DUPLICATES]);h=ZSConstants.I18N;function L(e){this.wrapper=p.querySelector("#removeDuplicates"),this.gridID=u.view.getActiveGridID(),this.rID=u.view.getResourceID(this.gridID),this.sheetID=u.view.getSheetID(this.gridID),this.version=u.view.getVersionID(this.gridID),this.range=e.tableRange,this.isFRL=e.frl,this.rangeIDArray=[],this.columnElement=this.getColumnElement(),this.isCheckBoxCreated=!1,this.actionType=e.duplicatesInfo.actionType}function q(e){-1==e.path.indexOf(p.querySelector("#moveDataContainer"))&&(m.RangePicker.isActiveOn(i)||I.zpopover("#moveData","close")),-1==e.path.indexOf(p.querySelector("#copyDataContainer"))&&(m.RangePicker.isActiveOn(n)||I.zpopover("#copyData","close"))}L.prototype={addListeners:function(){this.ListenerAdded=!0;var e=this;this.wrapper.querySelectorAll("input").forEach(function(t,r){t.addEventListener("change",function(r){if("radio"!=t.type)switch(t.id){case"matchCase":case"skipBlanks":case"includeHiddenCells":case"incFirstOcc":e.getDuplicates(!0);break;case"frh":e.isFRL=this.checked,e.isCheckBoxCreated=!1,e.showHeaders(),e.getDuplicates(!0)}})}),this.wrapper.querySelector("#selectAll").addEventListener("click",function(){this.classList.contains("filterItemSelect")?(this.classList.remove("filterItemSelect"),this.classList.remove("filterPartialSelection"),e.wrapper.querySelector("#unique").setAttribute("data-count",""),e.wrapper.querySelector("#duplicate").setAttribute("data-count","")):this.classList.add("filterItemSelect");var t=this.classList.contains("filterItemSelect");e.wrapper.querySelector("#columnContainer").querySelectorAll(".filterItem").forEach(function(e){t?e.classList.add("filterItemSelect"):e.classList.remove("filterItemSelect")}),e.getDuplicates(!0)});var t={buttons:[{text:"Delete",primary:!0},{text:h["Dialog.Button.Cancel"]}]};t.buttons[0].click=function(){e.getDuplicates(!1,"deleteRow")},t.buttons[1].click=function(){},this.formatContainer=new UIUtil.FormatContainer(this.wrapper),this.enableRangeSelectors(),this.wrapper.querySelector("#deleteBtn").addEventListener("click",function(){m.ZSAlert(f.fn.replaceParams(h["DataCleaning.Alert.Delete"],[e.actionType]),t)}),I.zpopover("#applyStyle","getComponentElement").querySelector("#applyFormat").addEventListener("click",function(){var t=e.formatContainer.getFormats();e.getDuplicates(!1,"highlight",t),I.zpopover("#applyStyle","close")});var r=I.zpopover("#moveData","getComponentElement");I.bind(r,"zpopoveropen",function(){p.querySelector('input[name="type"]').checked=!0,p.querySelector("#mvRng").style.display="none",e.setAttributes(),p.querySelectorAll('input[name="type"]').forEach(function(e){e.addEventListener("click",function(){"newSheet"==this.value?p.querySelector("#mvRng").style.display="none":(p.querySelector("#mvRng").style.display="block",i.value="",setTimeout(function(){i.focus()},10))})})});var a=I.zpopover("#copyData","getComponentElement");I.bind(a,"zpopoverbeforeopen",function(){p.querySelector('input[name="copytype"]').checked=!0,p.querySelector("#cpRng").style.display="none",e.setAttributes(),p.querySelectorAll('input[name="copytype"]').forEach(function(e){e.addEventListener("click",function(){"newSheet"==this.value?p.querySelector("#cpRng").style.display="none":(p.querySelector("#cpRng").style.display="block",n.value="",setTimeout(function(){n.focus()},10))})})}),r.querySelector("#moveBtn").addEventListener("click",function(){var t=p.querySelector('input[name="type"]').checked,r=t?"":i.value.trim();e.getDuplicates(!1,"move",r,t),p.querySelector('input[name="type"]:checked').value="existingSheet",I.zpopover("#moveData","close"),i.value=""}),a.querySelector("#copyBtn").addEventListener("click",function(){var t=p.querySelector('input[name="copytype"]').checked,r=t?"":n.value.trim();e.getDuplicates(!1,"copy",r,t),p.querySelector('input[name="copytype"]:checked').value="existingSheet",I.zpopover("#copyData","close"),n.value=""})},setAttributes:function(e){I.zpopover(this.wrapper.querySelector("#moveData"),"setAttributes",{closeOnBodyClick:!1}),I.zpopover(this.wrapper.querySelector("#copyData"),"setAttributes",{closeOnBodyClick:!1}),p.body.addEventListener("mousedown",q,!1)},enableRangeSelectors:function(){var e=this.wrapper.querySelector("#moveRange");i=new S.RangeEditor(e,!0),D.register(i,!0,!0),i.addListeners({}),e=this.wrapper.querySelector("#copyRange"),n=new S.RangeEditor(e,!0),D.register(n,!0,!0),n.addListeners({})},loadInfo:function(e){this.gridID=u.view.getActiveGridID(),this.rID=u.view.getResourceID(this.gridID),this.sheetID=u.view.getSheetID(this.gridID),this.version=u.view.getVersionID(this.gridID),this.range=e.tableRange,this.isFRL=e.frl,this.rangeIDArray=[]},changePreview:function(){var e=this.duplicateInfo.uniqueValueCount,t=this.duplicateInfo.duplicateCount,r=e/(t+e)*100+"%";this.wrapper.querySelector("#indicator").style.background="linear-gradient(to right, rgb(68, 200, 146) "+r+", rgb(96, 96, 96) "+r+", rgb(96, 96, 96))",this.wrapper.querySelector("#unique").setAttribute("data-count",e),this.wrapper.querySelector("#duplicate").setAttribute("data-count",t)},selectDuplicateRanges:function(e){0!=this.rangeIDArray.length&&g.publish(v.Listener,y.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID_ARRAY:this.rangeIDArray});var t=[];this.rangeIDArray=[];for(var r=0;r<e.length;r++){var i=f.Range.parseRange(this.rID,this.version,e[r]).range;f.SparklinePool.mergeRanges(i,t)}for(r=0;r<t.length;r++){var n=t[r];this.rangeIDArray.push(r+1),g.publish(v.Listener,y.UserAction.HIGHLIGHT_RANGE.ADD,{RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID:r+1,RANGE:n,COLOR:"red"})}},getColumnElement:function(){var e=p.createElement("div");return e.className="filterItem",e},showHeaders:function(){var e,t=this;this.wrapper.querySelector("#columnContainer").innerHTML="";var r=f.Range.parseRange(this.rID,this.version,this.range).range,i=new m.Range(r.startRow,r.startCol,r.startRow,r.endCol);sPlusPlus.view.fetchRangeData(t.rID,this.sheetID,this.version,i,["ActualValue","IsContentValid"],!1,this.gridID,function(n){if(!t.isCheckBoxCreated){t.isCheckBoxCreated=!0;for(var a=r.startCol,o=0;a<=r.endCol;a++,o++)if(n[i.startRow][a]){e=t.isFRL&&n[i.startRow][a].ActualValue&&""!=n[i.startRow][a].ActualValue.trim()?n[i.startRow][a].ActualValue:"Column "+f.Object.getCharForNum(a+1);var s=t.columnElement.cloneNode(!0);s.setAttribute("value",e),s.innerText=e;var l=t.wrapper.querySelector("#selectAll").classList.contains("filterItemSelect")||t.wrapper.querySelector("#selectAll").classList.contains("filterPartialSelection")?"filterItemSelect":"";l&&s.classList.add(l),s.setAttribute("id",o+"row"),t.wrapper.querySelector("#columnContainer").appendChild(s)}t.wrapper.querySelector("#columnContainer").querySelectorAll(".filterItem").forEach(function(e,r){e.addEventListener("click",function(){var r=e.classList;r.contains("filterItemSelect")?r.remove("filterItemSelect"):r.add("filterItemSelect"),t.doCheckBoxAction()})})}})},doCheckBoxAction:function(){var e=this.wrapper.querySelector("#columnContainer").querySelectorAll(".filterItem").length,t=this.wrapper.querySelector("#columnContainer").querySelectorAll(".filterItemSelect").length,r=this.wrapper.querySelector("#selectAll");r.className="filterItem",r.className=0==t?"filterItem":t==e?"filterItem filterItemSelect":"filterItem filterPartialSelection",this.getDuplicates(!0)},getDuplicates:function(e,t,r,a){o=t;var s=this.getColumnAry(),l=this.wrapper.querySelector("#incFirstOcc").checked,c=this.wrapper.querySelector("#includeHiddenCells").checked,u=this.wrapper.querySelector("#matchCase").checked;if(e)g.publish(v.Listener,y.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID_ARRAY:this.rangeIDArray}),0!=s.length&&A.getDuplicatesInfo(this.rID,[this.sheetID],this.version,this.range,this.isFRL,s,l,u,c,this.actionType);else{var p="move"!=t&&"copy"!=t||a?"":this.getDestRangeObj("copy"==t?n.value.trim():i.value.trim());0!=s.length&&A.getDuplicates(this.rID,[this.sheetID],this.version,this.range,this.isFRL,s,l,t,u,!1,r,this.callBack,this,c,this.actionType,a||!1,p)}},getDestRangeObj:function(e){var t=f.Range.parseRange(this.rID,this.version,e),r=t.range,i=r.startRow,n=r.startCol,o=r.startRow+this.duplicateInfo.rowCount,s=E.getRange(),l=f.Range.parseRange(a.rID,a.version,s).range,c=r.endCol+l.endCol-l.startCol,u=t.sheetName+"."+new m.Range(i,n,o,c).getLabel(),p=new m.ParamGenerator([t.sheetID],this.rID,this.version,!0,!0),h=p.getSheets(),d=p.getCustomRanges(f.Range.parseRange(this.rID,this.version,u).range),g=new m.ParamGenerator([this.sheetID],this.rID,this.version,!0,!0);return{sheetList:h,rangeList:d,srcSheetList:g.getSheets(),srcRangeList:g.getCustomRanges(f.Range.parseRange(this.rID,this.version,this.range).range),activeCell:p.getActiveCell()}},getColumnAry:function(){var e=[];return this.wrapper.querySelector("#columnContainer").querySelectorAll(".filterItem").forEach(function(t,r){t.classList.contains("filterItemSelect")&&e.push(parseInt(t.id))}),e},callBack:function(e){var t="move"==o?f.fn.replaceParams(h["DataDuplicate.Info.Move"],[e]):"copy"==o?f.fn.replaceParams(h["DataDuplicate.Info.Copy"],[e]):f.fn.replaceParams(h["DataDuplicate.Info.Delete"],[e]);new m.TBNotification(t,{type:"info",parent:this.wrapper}).show(),this.changePreview(),0!=this.rangeIDArray.length&&g.publish(v.Listener,y.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:this.rID,SHEETID:this.sheetID,VERSION:this.version,RANGEID_ARRAY:this.rangeIDArray}),"duplicate"==this.actionType?this.wrapper.querySelector("#duplicate").setAttribute("data-count",0):this.wrapper.querySelector("#unique").setAttribute("data-count",0),o=void 0},reset:function(){this.wrapper.querySelector("#selectAll").classList.add("filterItemSelect"),this.wrapper.querySelector("#frh").checked=!0,this.wrapper.querySelector("#incFirstOcc").checked="duplicate"==this.duplicateInfo.actionType,this.wrapper.querySelector("#includeHiddenCells").checked=!1,this.wrapper.querySelector("#matchCase").checked=!1,this.formatContainer.reset(),this.isCheckBoxCreated=!1}},window.addEventListener("DC_Duplicate_view_On_Close",function(){a&&0!=a.rangeIDArray.length&&g.publish(v.Listener,y.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:a.rID,SHEETID:a.sheetID,VERSION:a.version,RANGEID_ARRAY:a.rangeIDArray})}),window.addEventListener("frequency_edit",function(){!function(e){l=e;var t=E.getRange(),r=u.view.getActiveGridID(),i=u.view.getResourceID(r),n=u.view.getSheetID(r),a=u.view.getVersionID(r),o=f.Range.parseRange(i,a,t),s=new m.Range(o.range.startRow,e.col,o.range.endRow,e.col).getLabel();A.ReplaceAll(i,[n],a,e.oldvalue,e.newvalue,!0,!0,!0,290,s)}(arguments[0].detail)}),g.register(v.Listener,y.UserAction.DATA_DUPLICATE.TABLE_DETAILS,function(e){I.initComponent("#removeDuplicates",function(){var t=u.view.getActiveGridID(),r=u.view.getResourceID(t),i=u.view.getVersionID(t),n=f.Range.parseRange(r,i,e.tableRange).range;if(n.startRow==n.endRow)return p.querySelector("#invalidRange").style.display="block",p.querySelector("#removeDuplicates").style.display="none",void(p.querySelector("#columnLoader").style.display="none");p.querySelector("#invalidRange").style.display="none",p.querySelector("#removeDuplicates").style.display="",E.setRange(e.tableRange),a?(a.isCheckBoxCreated=!1,a.loadInfo(e)):(a=new L(e)).addListeners(),a.duplicateInfo=e.duplicatesInfo,a.actionType=e.duplicatesInfo.actionType,a.duplicateEntries=e.duplicateRecords.length,a.wrapper.querySelector("#selectAll").checked=!0,a.showHeaders(),p.querySelector("#columnLoader").style.display="none",p.querySelector("#removeDuplicates").style.display="",a.wrapper.querySelector("#incFirstOcc").checked="unique"==e.duplicatesInfo.actionType,a.changePreview(),a.selectDuplicateRanges(e.duplicateRecords),a.wrapper.querySelector("#frh").checked=e.frl})},"TABLE_DETAILS"),g.register(v.Listener,y.UserAction.DATA_DUPLICATE.FREQUENCY_DETAILS,function(e){var r=u.view.getActiveGridID(),i=u.view.getSheetID(r),n=u.view.getSheetState(r,i);if(E.loadSheet2App(),void 0==t&&(t=module.getModule("SA/Controller/SheetAppController")),E.setRange(e.tableRange),e.findDataRange){var a=e.headers;a.forEach(function(e,t,r){e.value||(r[t]={key:e.key,value:"COLUMN "+f.Object.getCharForNum(e.key+1)})});var o={columns:a,currentCol:n.getActiveCol(),mode:5};E.tableInstance.created=!0,E.tableInstance.setCurrentCol(n.getActiveCol());var s=u.view.getResourceID(r),l=u.view.getVersionID(r),c=f.Range.parseRange(s,l,E.getRange()),h=c.range;E.tableInstance.sr=h.startRow,E.tableInstance.er=h.endRow,E.tableInstance.sc=h.startCol,E.tableInstance.ec=h.endCol,E.tableInstance.sn=c.sheetID,E.tableInstance.setRange(c.sheetID,h.startRow,h.startCol,h.endRow,h.endCol,e.headers),t.load(o,void 0,!0),E.isSheetAppLoaded=!0}t.constructColumnFrequency(e.info),E.highlightCurrentColumn(),p.querySelector(".sPComp.sPDatCln .ZsLoader").style.display="none"},"FREQUENCY_DETAILS"),g.register(v.Listener,y.UserAction.DATA_DUPLICATE.REPLACE_INFO,function(e){if(0!=e){var t=f.fn.replaceParams(h["DataDuplicate.Frequency.ReplaceAll"],[e]),r=new m.TBNotification(t,{type:"info",parent:p.querySelector("#SidebarContentArea")});l&&r.show(),l&&w.LoadFrequency(l.col,E.getRange())}},"replaceCount"),g.register(v.Listener,y.UserAction.DATA_DUPLICATE.TABLE_INFO,function(e){a.tableInfo=e.duplicatesInfo,a.duplicateEntries=e.duplicateRecords.length,a.duplicateInfo=e.duplicatesInfo,a.selectDuplicateRanges(e.duplicateRecords),a.changePreview()},"TABLE_INFO"),g.register(v.Listener,y.UserAction.DATA_DUPLICATE.COUNT,function(e,t,r,i){a.callBack(i)},"RID","SHEETID","VERSION","DATA"),g.register(v.UI,y.SidePanel.DATACLEANING.UPDATE_RANGE,function(e){void 0==r&&(r=module.getModule("SA/Controller/SheetAppUIController")),3!=global.SA.Controller.SheetAppUIController.getOperationMenuValue()&&4!=global.SA.Controller.SheetAppUIController.getOperationMenuValue()||(w.readTable(e,a.actionType),a&&0!=a.rangeIDArray.length&&g.publish(v.Listener,y.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:a.rID,SHEETID:a.sheetID,VERSION:a.version,RANGEID_ARRAY:a.rangeIDArray}))},"RANGE"),g.register(v.Listener,y.UserAction.DATACLEANING.REFRESH,function(e,i,n,o){if(void 0==r&&(r=module.getModule("SA/Controller/SheetAppUIController")),E.isOpen())for(var l in s||(s=E.constructBanner(function(){if(3!=r.getOperationMenuValue()&&4!=r.getOperationMenuValue()){var e=E.tableInstance.getCurrentCol();void 0==t&&(t=module.getModule("SA/Controller/SheetAppController")),t.triggerColumnChange(e,!0)}else a.reset(),w.readTable(E.getRange(),a.actionType)})),o){var c=o[l],u=c[0],p=c[1],h=(c[2],c[3]),d=E.tableInstance.getCurrentCol();if(3!=r.getOperationMenuValue()&&4!=r.getOperationMenuValue())d>=p&&d<=h&&E.showNotification();else{var g=f.Range.parseRange(a.rID,a.version,a.range).range;g.startRow<=u&&g.endRow>=u&&g.startCol<=p&&g.endCol>=p&&E.showNotification()}}},"RID","SHEETID","VERSION","DATA"),g.register(v.Listener,y.SheetAction.FILTER.SHOW_COUNT,function(e){if(0!=e){var t=u.view.getActiveGridID(),r=u.view.getResourceID(t),i=u.view.getSheetID(t),n=u.view.getVersionID(t),a=u.data.getWorkBook(r,n).getSheetObj(i);clearTimeout(c),setTimeout(function(){var t=a.DataFilters.getAllRanges()[0];if(0!=t.properties.appliedColumns.length){var r=t.endRow-t.startRow,i=r-e;p.querySelector(".sTFilterDesc")&&p.querySelector(".sTFilterDesc").remove(),function(e,t,r){var i=p.createElement("div");i.classList.add("sTFilterDesc"),i.textContent=r,p.querySelector("#SHEET_SB_CONTAINER").append(i)}(0,0,f.fn.replaceParams(h["Filter.foundRecords"],[i,r])),c=setTimeout(function(){p.querySelector(".sTFilterDesc")&&p.querySelector(".sTFilterDesc").remove()},5e3)}},20)}else p.querySelector(".sTFilterDesc")&&p.querySelector(".sTFilterDesc").remove()},"FILTER_COUNT")}(this),function(e){var t=e.sPlusPlus,r=(e.ZSConstants.FeatureConstants,e.document,e.ZSConstants.wCC,e.ZSConstants.I18N,e.ZSConstants.JSKeyCode,e.ZSEvents),i=(r.topic,r.Groups,r.Names,e.ZSConstants.FeatureConstants),n=(t.SML.Client,e.UIUtil.Component),a=e.ZSClass;a.Editors,a.RangePicker,e.UserAction,JSUtil.fn,t.view.Toolbar.Feature[i.DATA_DUPLICATES];function o(e){this.wrapper=e,this.container=e.querySelector("#applyStyleContainer"),this.appendListerners()}o.prototype={appendListerners:function(){var e=this;this.boldElem=this.container.querySelector("#bold"),this.ItalicElem=this.container.querySelector("#italic"),this.UnderlineElem=this.container.querySelector("#underline"),this.StrikeElem=this.container.querySelector("#strike"),this.bgColorElem=this.container.querySelector("#fill"),this.tcColorElem=this.container.querySelector("#textColor"),this.clearElem=this.container.querySelector("#clearElem"),this.colorPickerElemArray=[this.bgColorElem,this.tcColorElem],this.colorPickerElemArray.forEach(function(t,r){t.setAttribute("data",'{"pickerOptions":{"nocolorbutton":false}, "value":"#000000"}'),t.setAttribute("data-ctype","zcolorchooser"),t.setAttribute("data-picker-id","sheet-colorpicker"),n.bind(t,"zcolorchooserchange",function(r,i){t.style.borderBottom="3px solid "+i.color,e.changePreview()})});var t=n.zpopover("#applyStyle","getComponentElement");n.bind(t,"zpopoverbeforeopen",function(){e.reset()}),this.formatArray=[this.boldElem,this.ItalicElem,this.UnderlineElem,this.StrikeElem],this.formatArray.forEach(function(t,r){t.addEventListener("click",function(){var r=t.parentElement.classList;r.contains("active")?r.remove("active"):r.add("active"),e.changePreview()})}),this.clearElem.addEventListener("click",function(){e.reset()}),n.initComponent(this.container)},changePreview:function(e){var t=this.container.querySelector("#previewElem");t.style.fontWeight=this.boldElem.parentElement.classList.contains("active")?"bold":"",t.style.fontStyle=this.ItalicElem.parentElement.classList.contains("active")?"italic":"";var r="underline";this.UnderlineElem.parentElement.classList.contains("active")&&this.StrikeElem.parentElement.classList.contains("active")?r="line-through underline":!this.UnderlineElem.parentElement.classList.contains("active")&&this.StrikeElem.parentElement.classList.contains("active")?r="line-through":this.UnderlineElem.parentElement.classList.contains("active")||this.StrikeElem.parentElement.classList.contains("active")||(r=""),t.style.textDecoration=r,t.style.backgroundColor="transparent"==this.bgColorElem.style.borderBottomColor?"":this.bgColorElem.style.borderBottomColor,t.style.color="transparent"==this.tcColorElem.style.borderBottomColor?"":this.tcColorElem.style.borderBottomColor},reset:function(){this.formatArray.forEach(function(e,t){e.parentElement.classList.remove("active")}),this.colorPickerElemArray.forEach(function(e,t){e.style.borderBottomColor="transparent"}),this.changePreview()},getFormats:function(){var e=[];return this.formatArray.forEach(function(t,r){var i=t.parentElement.classList;e.push(i.contains("active"))}),this.colorPickerElemArray.forEach(function(t,r){var i=t.style.borderBottomColor;if("transparent"==i)i="";else{var n=i.substring(4,i.length-1).split(",");i=JSUtil.fn.rgbToHex(n)}e.push(i)}),e}},UIUtil.FormatContainer=o}(this);
!function(e){var t,n,i,o,s=e.sPlusPlus,r=e.ZSEvents,a=r.topic,l=r.Groups,c=r.Names,S=e.UIUtil.Component,u=e.ZSConstants.FeatureConstants,d=e.document,E=e.ZSConstants.I18N,g=(e.ZSConstants.wCC,e.ZSConstants.CommandConstants),I=e.ZSConstants.LocaleConstants,C=e.sPlusPlus.data.AppRegistry,v=e.JSUtil,T=void 0,D=void 0,p=e.isCanvasGrid,f=s.view.Toolbar.Feature[u.SPREADSHEET_SETTINGS];function m(){var t={modal:!0,width:460,title:E["MenuItem.FileTab.SpreadSheetSetting"]};T||(!function(){var t=e.UserAction.getTemplate(["SP_SHEETSETTINGS"]).SP_SHEETSETTINGS;(D=d.createElement("div")).id="DI_SPSettings",D.appendChild(t);var s=v.fn.replaceParams(E["documentsettingsdialog.additionalInfo"],new Array("<a target='_blank' href='"+C.ZOHO_ACCOUNTS_URL+"/u/h#profile/personal'>","</a>"));D.querySelector("#zohoAccLink").innerHTML=s,D.querySelector("[id=spcountryCombo]").appendChild(n),D.querySelector("[id=splanguageCombo]").appendChild(i),D.querySelector("[id=sptimezoneCombo]").appendChild(o),!p&&(D.querySelector("#shtDir").style.display="none"),D.querySelector("#okBtn").addEventListener("click",N),D.querySelector("#cancelBtn").addEventListener("click",O)}(),T=new e.ZSClass.Dialog(D,t)),T.open()}!function(){var e=["COUNTRY","LANGUAGE","TIMEZONE"];for(var t in e){for(var s=I[e[t]],r=document.createDocumentFragment(),a=0;a<=s.length;a++)if(void 0!=s[a]){var l,c;"TIMEZONE"===e[t]?(l=s[a].substring(0,s[a].indexOf("[")),c=s[a].substring(s[a].indexOf("[")+1,s[a].length)):(c=s[a].substring(0,s[a].indexOf("_")),l=s[a].substring(s[a].indexOf("_")+1,s[a].length));var S=d.createElement("option");S.text=c,S.value=l,r.appendChild(S)}"COUNTRY"==e[t]?n=r:"LANGUAGE"==e[t]?i=r:o=r}}();function N(){var n=S.zselect("#spcountryCombo","getValue"),i=S.zselect("#splanguageCombo","getValue"),o=S.zselect("#sptimezoneCombo","getValue"),r=!!p&&S.zselect("#spdirection","getValue"),a=s.data.Defaults.VIEW==s.data.View.CLASSIC?"CLASSIC":"COMFORT";if(function(e,n,i,o){var s=e,r=n,a=i,l=o,c=t[g.COUNTRY],S=t[g.LANGUAGE],u=t[g.TIME_ZONE],d=!!p&&t[g.SHEET_DIRECTION];if(c!=s||S!=r||u!=a||d!=l)return!0;return!1}(n,i,o,r)){var l=s.view.getActiveGridID(),c=s.view.getResourceID(l),u=(s.view.getSheetID(l),s.view.getVersionID(l)),d=s.view.getSelectedSheets(l);e.UserAction.DocumentSetting(c,d,u,i+"_"+n,o,a,r)}O()}function O(){T.close()}a.register(l.Listener,c.UserAction.FETCH_DOCUMENT_SETTINGS,function(e){m(),t=e,S.zselect("#spcountryCombo","setValue",e[g.COUNTRY]),S.zselect("#splanguageCombo","setValue",e[g.LANGUAGE]),S.zselect("#sptimezoneCombo","setValue",e[g.TIME_ZONE]),p&&S.zselect("#spdirection","setValue",e[g.SHEET_DIRECTION])},"RESPONSE");var h=!0;f.openDialog=m,f.fetchDocumentSettings=function(){var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),i=s.view.getSelectedSheets(t),o=s.view.getVersionID(t);e.UserAction.fetchDocumentSettings(n,i,o)},a.register(l.Listener,c.DocMeta.DOC_SETTINGS,function(e,t,n){if(p)if(h)h=!1;else{var i=s.data.Defaults.DISP_DIR,o=n[g.SHEET_DIRECTION]?"rl-tb":"lr-tb",r=s.view.getActiveGridID(),S=s.view.getSheetID(r);if(o!==i){s.data.Defaults.DISP_DIR=o;for(var u=s.data.getWorkBook(e,t),d=u.SheetList,E=0;E<d.length;E++){var I=u.getSheetObj(d[E].Id);I.Visited&&I.gridDirection!==o&&(I.modifyGridDirection(o),I.getId()===S&&a.publish(l.Listener,c.GridAction.FLIP,{RID:e,SHEETID:S,VERSION:t,FLIP:n[g.SHEET_DIRECTION]}))}}}},"RID","VERSION","DOC_SETTINGS")}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,o=e.UIUtil,a=(n.topic,n.Groups,n.Names,e.UIUtil.Component),l=e.ZSConstants.FeatureConstants,s=e.document,i=e.ZSConstants.I18N,c=(e.ZSConstants.wCC,e.ZSConstants.CommandConstants,e.ZSConstants.LocaleConstants,e.sPlusPlus.data.AppRegistry,e.JSUtil,void 0),d=void 0;function r(){d.querySelector("#setPasswordCheckBox").checked?(document.getElementById("password-container").style.display="",document.getElementById("encrypt-password").focus()):(document.getElementById("password-container").style.display="none",document.getElementById("encrypt-password").value="")}function m(){var t=document.getElementById("emailfield"),n=function(e){for(var t=null,n=0;n<e.length;n++)t=null===t?e[n].email:t+","+e[n].email;return t}(o.Component.getZtokenfiledValues(t)),a=d.querySelector("#mailMessage").value,l=d.querySelector("#AttachmentFormatType").value,s=d.querySelector("#SendMeCopy"),c=d.querySelector("#encrypt-password").value,r=d.querySelector("#mailSubject").value,m=d.querySelector("#SheetLists").value;if(!n||o.Component.isZtokenfiledContainErrorToken(t))return new ZSClass.TBNotification(i.EmailValidationMessage,{type:"error",parent:d}).show(),!1;var p=!1;s.checked&&(p=!0),e.UserAction.SendAttachmentInMail(n,r,a,l,p,c,m),u()}function u(e,t){c.close(),a.zcombo("#sheetListDiv","setValue","NONE"),a.zcombo("#AttachmentFormatType","setValue","xlsx"),document.getElementById("sheetListDiv").style.display="none",document.getElementById("mailMessage").value="",document.getElementById("password-container").style.display="none",document.getElementById("setPasswordCheckBox").checked=!1,document.getElementById("SendMeCopy").checked=!1,o.Component.destroyZtokenfiled(document.getElementById("emailfield"))}t.view.Toolbar.Feature[l.SEND_AS_ATTACHMENT].openDialog=function(){var n={modal:!0,width:450,title:i.SendAsAttachment,close:function(){u()}};c||(function(){var n=t.view.getActiveGridID(),o=t.view.getResourceID(n),l=t.view.getVersionID(n),i=e.UserAction.getTemplate(["SendAsAttachmentTemplate"]).SendAsAttachmentTemplate;(d=s.createElement("div")).id="DI_SendAsAttachment",d.appendChild(i),d.querySelector("#sendMailBtn").addEventListener("click",m),d.querySelector("#cancelMailBtn").addEventListener("click",u),d.querySelector("#setPasswordCheckBox").addEventListener("click",r),d.querySelector("#mailSubject").value=t.data.getWorkBook(o,l).Name;var c=d.querySelector("#AttachmentFormatType");a.bind(c,"zselectboxchange",function(e,n){var o=d.querySelector("#SheetLists"),l=n.value;if("csv"===l){a.zcombo(o,"removeAllOptions"),document.getElementById("sheetListDiv").style.display="";for(var s=t.view.getActiveGridID(),i=t.view.getResourceID(s),c=sPlusPlus.data.getWorkBook(i,"Head").SheetList,r=[],m=0;m<c.length;m++){var u=c[m].Name;r.push({label:u,value:u})}a.zcombo(o,"addOption",r)}else document.getElementById("sheetListDiv").style.display="none";var p=d.querySelector("#setPasswordCheckBox");"csv"===l||"ods"===l?(p.checked&&(document.getElementById("encrypt-password").value="",document.getElementById("password-container").style.display="none",p.checked=!1),d.querySelector("#password-checkbox").style.display="none"):d.querySelector("#password-checkbox").style.display=""})}(),c=new e.ZSClass.Dialog(d,n));var l=t.data.UserInfo.USER_CONTACT,p=[];for(var y in l)l.hasOwnProperty(y)&&p.push(l[y]);o.Component.ztokenfield(document.getElementById("emailfield"),{data:p,dataMapping:{value:"email",text:"fullName",image:"imageUrl",informativeText:"email",id:"email"},placeholder:"Recipients",maxAllowedValues:10,tokens:{contentType:"image-text",editable:!0,animateOnRemove:!1,showRemoveButtonOnHover:!1},dropdownList:{contentType:"image-text-desc",itemType:"none"},sort:!0,search:{minKeywordLength:1,by:"fullName",showNoResultsMessage:!1,highlightKeyword:!1,criteria:"contains"},acceptNewValues:!0,newValuePattern:new RegExp(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/),dataValidation:!0,autoComplete:!1,tokenedit:function(e,t){var n=(t=e.detail).options,o=t.textboxValue,a=o.match(/\"(.*)\"/)&&o.match(/\"(.*)\"/).pop();o=o.match(/\<(.*)\>/)&&o.match(/\<(.*)\>/).pop(),null===a&&null===o&&(a=o=t.textboxValue);var l=n.newValuePattern,s=t.itemData;if(s.invalidToken=!1,!o||o&&o.length&&!l.test(o))s.invalidToken=!0;else{var i=n.dataMapping;s[i.id]=o,s[i.titleText]=o,s[i.text]=a||o}}}),c.open()}}(this);
!function(e){var t,c,n=e.sPlusPlus,o=e.document,l=e.ZSConstants.FeatureConstants,p=e.ZSConstants.I18N,i=n.view.Toolbar.Feature[l.COPY];p=e.ZSConstants.I18N;function r(){c.querySelector("#cpclp_input").innerHTML=t.tableData}function a(){c.querySelector("#cpclp_input").innerText="",c.querySelector("#cpclp_copy").innerText=p.Copy,t.close()}function s(){c.querySelector("#cpclp_input").select(),document.execCommand("copy"),c.querySelector("#cpclp_copy").innerText=p["Statusbar.Copied"]}i.openDialog=function(n){var l,i;t||(l={width:650,title:p.CopyToClipboard,close:a,open:r},i=UserAction.getTemplate(["copyToClipTemplate"]),(c=o.createElement("div")).id="DI_COPYCLIP",c.appendChild(i.copyToClipTemplate),c.querySelector("#cpclp_close").addEventListener("click",a),c.querySelector("#cpclp_copy").addEventListener("click",s),t=new e.ZSClass.Dialog(c,l)),t.tableData=n,t.open()}}(this);
!function(t){t.sPlusPlus;var e,i=t.ZSClass,l=t.document,s=t.UIUtil.Component,r=t.ZSConstants,o=r.I18N,a=r.ActionConstants,c=function(t,e){this.callback=t,this.dateFormat=e.dateFormat,this.init()};function n(){if(this.DOM.customTxt1.value="",this.DOM.customTxt2.value="",this.DOM.andOperator.checked=!0,this.DOM.autoFilterCnt.innerHTML="",this.DOM.cellFilterCnt.innerHTML="",this.DOM.textFilterCnt.innerHTML="",m(this.DOM.autoFilter,!0),m(this.DOM.customFilter,!1),s.zcombo(this.DOM.criteria1,"setValue","eq"),s.zcombo(this.DOM.criteria2,"setValue","eq"),s.zcombo("foCategory","setValue","values"),s.zspinner("fspinner","setValue",10),s.zdatefield(customTxt2,"destroy"),s.zdatefield(customTxt1,"destroy"),this.DOM.autoCellFilterSearch.value="",this.prevTab){var t="#"+this.DOM[this.prevTab].id;this.container.querySelector(t+" + label").classList.remove("flChecked"),this.prevTab=void 0}}function h(t){var e=this.getIndexOfSelectedItem(t);-1==e?(this.addSelectItem(t),this.selectedItemsCount++):(this.removeSelectedItem(e),this.selectedItemsCount--),u.call(this)}function u(){var t=this.getActiveTab().selectedItems.length,e=Object.keys(this.activeTabData).length;v("filterbtn",t>0?"enable":"disable");var i=this.activeTab+"Select";t==e?(!this.DOM[i].classList.contains("filterItemSelect")&&this.DOM[i].classList.add("filterItemSelect"),this.DOM[i].classList.remove("filterPartialSelection")):t<1?(this.DOM[i].classList.remove("filterItemSelect"),this.DOM[i].classList.remove("filterPartialSelection")):(this.DOM[i].classList.contains("filterItemSelect")&&this.DOM[i].classList.remove("filterItemSelect"),!this.DOM[i].classList.contains("filterPartialSelection")&&this.DOM[i].classList.add("filterPartialSelection"));var l="#"+this.DOM[this.activeTab].id,s=this.container.querySelector(l+" + label");if(t>0){if(void 0!=this.prevTab&&this.prevTab!=this.activeTab){var r="#"+this.DOM[this.prevTab].id;this.container.querySelector(r+" + label").classList.remove("flChecked");var o="autoCellFilter"==this.prevTab?"autoFilterCnt":"cellColorFilter"==this.prevTab?"cellFilterCnt":"textFilterCnt";this.getFilterdTab().selectedItems.length>0&&function(t){for(var e=this.container.querySelector("#"+t).children,i=this.prevTab+"Select",l=0;l<e.length;l++){var s;(s=e[l]).classList.contains("filterItemSelect")&&s.classList.remove("filterItemSelect"),s.classList.contains("filterPartialSelection")&&s.classList.remove("filterPartialSelection")}this.DOM[i].classList.remove("filterPartialSelection"),this.DOM[i].classList.remove("filterItemSelect")}.call(this,o),this.clearAllSelectedItems()}s.classList.add("flChecked"),this.prevTab=this.activeTab}else s.classList.remove("flChecked")}function d(){var t=this.data.dT,e=this.DOM.criteria1,i=this.DOM.criteria2;e.querySelector('option[value="top"]'),e.querySelector('option[value="bottom"]');"NUMBER"==t?(s.zcombo(e,"setOptionAttributes","top","hidden",!1),s.zcombo(e,"setOptionAttributes","bottom","hidden",!1)):"DATE"!=t&&"TEXT"!=t||(s.zcombo(e,"setOptionAttributes","top","hidden",!0),s.zcombo(e,"setOptionAttributes","bottom","hidden",!0)),"DATE"==t?(O(e.querySelector("option[value='gt']"),o["Condition.DateAfter"]),O(e.querySelector("option[value='gte']"),o["Condition.DateOnOrAfter"]),O(e.querySelector("option[value='lt']"),o["Condition.DateBefore"]),O(e.querySelector("option[value='lte']"),o["Condition.DateOnOrBefore"]),O(i.querySelector("option[value='gt']"),o["Condition.DateAfter"]),O(i.querySelector("option[value='gte']"),o["Condition.DateOnOrAfter"]),O(i.querySelector("option[value='lt']"),o["Condition.DateBefore"]),O(i.querySelector("option[value='lte']"),o["Condition.DateOnOrBefore"])):(O(e.querySelector("option[value='gt']"),o["Condition.GreaterThan"]),O(e.querySelector("option[value='gte']"),o["Condition.GreaterThanOrEqualTo"]),O(e.querySelector("option[value='lt']"),o["Condition.LessThan"]),O(e.querySelector("option[value='lte']"),o["Condition.LessThanOrEqualTo"]),O(i.querySelector("option[value='gt']"),o["Condition.GreaterThan"]),O(i.querySelector("option[value='gte']"),o["Condition.GreaterThanOrEqualTo"]),O(i.querySelector("option[value='lt']"),o["Condition.LessThan"]),O(i.querySelector("option[value='lte']"),o["Condition.LessThanOrEqualTo"])),s.zcombo(e,"refresh"),s.zcombo(i,"refresh")}function f(t,e){t.style.top=e+"px"}function v(t,e){s[e]("#"+t)}function m(t,e){t.style.display=e?"":"none"}function O(t,e){t.innerText=e}function b(t,e,i){var r=l.getElementById("customFilter"),o=l.getElementById("customTxt1");if(v("filterbtn","enable"),"top"==t||"bottom"==t){o.type="input",r.classList.add("topBotm");var a=l.getElementById("foCategory"),c=l.getElementById("fspinner"),n="items"==i.sC?"values":"percent";e&&s.zcombo(a,"setValue",n),e&&s.zspinner(c,"setValue",i.sVal)}else"lt"!=t&&"lte"!=t&&"gt"!=t&&"gte"!=t||"DATE"!=i.dT?s.zdatefield(o,"destroy"):s.zdatefield(o,{format:i.dateFormat,picker:!0}),r.classList.remove("topBotm")}function D(t,e,l,s){var r=this.data.cD,o=this.data.ccs,a=this.data.tcs;r="autoCellFilter"===l?r:"cellColorFilter"==l?o:a;this.activeTab=l,this.activeTabData=r;var c=this.container.querySelector("#"+e+"loader");if(m(c,!0),!this.filterTypes[l])if("autoCellFilter"==l)(function(t,e,l,s,r){var o=this.container.querySelector("#"+l+"loader"),a=s,c=[],n=a.indexOf(""),u=[];if(c=[],-1!=n){u.push(a[n]),c.push(this.data.selectedItemIndexes[n]);for(var d=0;d<a.length;d++)d!=n&&(u.push(a[d]),c.push(this.data.selectedItemIndexes[d]))}else u=a,c=this.data.selectedItemIndexes;this.initActiveTab();var f=this,v=(this.getActiveTab().selectedItems,this.DOM[l]),O=0,b=h.bind(this),D=this.activeTab+"Search";new i.AutoSuggest.filterSuggest({editor:this.DOM[D],container:v,dataType:"Array",fuzzy:!0,data:u,dontCreateSpan:!0,searchCallBack:function(t){m(f.DOM.noMatch,t),m(f.DOM.autoCellFilterSelect,!t)},callBack:function(e){var l=e.text;new i.Filter.selectItems(t,b)[r](l,c[O],e.dom),e.decorate=function(){},O++}}),m(o,!1)}).call(this,t,l,e,r,s);else{this.initActiveTab();var n={};if(this.dataFromClient)n=r;else for(var u=0;u<r.length;u++){var d=void 0!=this.data.selectedItemIndexes[u]?this.data.selectedItemIndexes[u]:0;n[r[u]]=d}var f=h.bind(this),O=new i.Filter.selectItems(t,f);this.DOM[e].appendChild(O[s](n))}m(c,!1),v("filterbtn",this.selectedItemsCount>0?"enable":"disable")}c.prototype={init:function(){var i=t.UserAction.getTemplate(["filterWidget"]).filterWidget;this.container=l.createElement("div"),this.container.id="DI_FILTER",this.container.className="flWrapper",this.container.style.zIndex=1e3,this.container.appendChild(i),l.body.appendChild(this.container),s.initComponent("#"+this.container.id),function(){var t=this.container;this.DOM={autoCellFilter:t.querySelector("#filterCellValue"),cellColorFilter:t.querySelector("#filterCellColor"),textColorFilter:t.querySelector("#filterTextColor"),autoFilterCnt:t.querySelector("#autoFilterCnt"),cellFilterCnt:t.querySelector("#cellFilterCnt"),textFilterCnt:t.querySelector("#textFilterCnt"),clearbtn:t.querySelector("#clearbtn"),filterbtn:t.querySelector("#filterbtn"),customTxt1:t.querySelector("#customTxt1"),customTxt2:t.querySelector("#customTxt2"),criteria1:t.querySelector("#criteria1"),criteria2:t.querySelector("#criteria2"),andOperator:t.querySelector("#andOperator"),orOperator:t.querySelector("#orOperator"),toggleFilter:t.querySelector("#toggleFilter"),autoFilter:t.querySelector("#autoFilter"),customFilter:t.querySelector("#customFilter"),cellColorFilterSelect:t.querySelector("#cellColorSelect"),textColorFilterSelect:t.querySelector("#textColorSelect"),autoCellFilterSelect:t.querySelector("#autoSelect"),textColorFilterSearch:t.querySelector("#textColorSearch"),cellColorFilterSearch:t.querySelector("#cellColorSearch"),autoCellFilterSearch:t.querySelector("#autoSearch"),noMatch:t.querySelector("#noMatch"),maxInfo:t.querySelector("#maxDataInfo")}}.call(this),function(){var t=function(){var t=this.dateFormat;if(this.DOM.toggleFilter.classList.toggle("autoFilterCls"),this.isCustomFilter)this.posAdjusted&&f(this.container,e),m(this.DOM.autoFilter,!0),m(this.DOM.customFilter,!1),this.DOM.toggleFilter.innerText=o["Filter.customFilter"],this.isCustomFilter=!1,this.DOM.autoCellFilter.click();else{if(this.posAdjusted){var i=parseInt(this.container.style.top);e=i;var l=this.container.offsetHeight,r=l-250;i+=r,f(this.container,i)}m(this.DOM.autoFilter,!1),m(this.DOM.customFilter,!0),this.DOM.toggleFilter.innerText=o["Filter.Auto"],this.isCustomFilter=!0;this.DOM.customTxt1.onfocus=function(){v("filterbtn","enable")},this.DOM.customTxt2.onfocus=function(){v("filterbtn","enable")},d.call(this);var a=this.data.dT,c=s.zcombo(this.DOM.criteria1,"getValue");b(c,!1,{dT:a,dateFormat:t}),s.unbind(this.DOM.criteria1,"zselectboxchange"),s.bind(this.DOM.criteria1,"zselectboxchange",function(e,i){var l=i.value;b(l,!1,{dT:a,dateFormat:t})});var n=this.DOM.customTxt2;s.unbind(this.DOM.criteria2,"zselectboxchange"),s.bind(this.DOM.criteria2,"zselectboxchange",function(e,i){v("filterbtn","enable");var l=i.value;"lt"!=l&&"lte"!==l&&"gt"!==l&&"gte"!==l||"DATE"!=a?s.zdatefield(n,"destroy"):s.zdatefield(n,{format:t,picker:!0})}),""==this.DOM.customTxt1.value&&""==this.DOM.customTxt2.value?v("filterbtn","disable"):v("filterbtn","enable")}}.bind(this),i=function(t){this.callback.sortFilter(t)}.bind(this);this.DOM.toggleFilter.onclick=function(){t()};var l=this.container.querySelector("#sortAsc"),r=this.container.querySelector("#sortDesc");l.onclick=function(){i("ASC")},r.onclick=function(){i("DESC")};var a=function(t,e){for(var i=t.children,l=0;l<i.length;l++){var s=i[l],r=e&&!s.classList.contains("filterItemSelect")||!e;if(r){var o=s.getAttribute("value");if(e)s.classList.add("filterItemSelect"),s.classList.remove("filterPartialSelection"),this.addSelectItem(o),v("filterbtn","enable");else{s.classList.remove("filterPartialSelection"),s.classList.remove("filterItemSelect");var a=this.getIndexOfSelectedItem(o);this.removeSelectedItem(a),v("filterbtn","disable")}}}u.call(this)}.bind(this),c=this.DOM.autoFilterCnt,n=this.DOM.cellFilterCnt,h=this.DOM.textFilterCnt;this.DOM.autoCellFilterSelect.onclick=function(){var t=!(!this.classList.contains("filterPartialSelection")&&this.classList.contains("filterItemSelect"));a(c,t)},this.DOM.cellColorFilterSelect.onclick=function(){var t=!(!this.classList.contains("filterPartialSelection")&&this.classList.contains("filterItemSelect"));a(n,t)},this.DOM.textColorFilterSelect.onclick=function(){var t=!(!this.classList.contains("filterPartialSelection")&&this.classList.contains("filterItemSelect"));a(h,t)}}.call(this)},getDialogPos:function(){return this.container.style.display="",{height:this.container.clientHeight,width:this.container.clientWidth}},show:function(t,e,i){n.call(this),this.container.style.top=t+"px",this.container.style.left=e+"px",this.posAdjusted=i,m(this.container.querySelector("#autoFilterCntloader"),!0),m(this.container.querySelector("#cellFilterCntloader"),!0),m(this.container.querySelector("#textFilterCntloader"),!0)},generateData:function(t){this.selectedItemsCount=0,this.data=t;var i=t.aft;this.dataFromClient=void 0==this.data.selectedItemIndexes,this.isCustomFilter=void 0!=i&&"fc"===i,this.filteredtype=this.isCustomFilter;var l=i&&"fbcc"===i?"filterCellColor":i&&"fbtc"===i?"filterTextColor":"filterCellValue",r=!!t.aft;this.filterTypes={};var c,n=D.bind(this,l,"autoFilterCnt","autoCellFilter","generateAutoFilterItems"),h=D.bind(this,l,"cellFilterCnt","cellColorFilter","generateCellColorItems"),u=D.bind(this,l,"textFilterCnt","textColorFilter","generateTextColorItems");if(this.DOM.autoCellFilter.onclick=function(){n()},this.DOM.cellColorFilter.onclick=function(){h()},this.DOM.textColorFilter.onclick=function(){u()},this.isCustomFilter){var O=this.dateFormat;if(this.DOM.toggleFilter.innerText=o["Filter.Auto"],this.DOM.toggleFilter.classList.add("autoFilterCls"),d.call(this),this.posAdjusted){var T=parseInt(this.container.style.top);e=T,T+=this.container.offsetHeight-250,f(this.container,T)}m(this.DOM.autoFilter,!1),m(this.DOM.customFilter,!0);var S=t.sOpr?t.sOpr:t.o1?t.o1:t.o2;s.zcombo(this.DOM.criteria1,"setValue",S),b(S,!0,{sC:t.sC,sVal:t.sVal,dT:t.dT,dateFormat:O});var p=this.data.dT;s.unbind(this.DOM.criteria1,"zselectboxchange"),s.bind(this.DOM.criteria1,"zselectboxchange",function(t,e){b(e.value,!1,{dT:p,dateFormat:O})});var C=this.DOM.customTxt2;if(s.unbind(this.DOM.criteria2,"zselectboxchange"),s.bind(this.DOM.criteria2,"zselectboxchange",function(t,e){var i=e.value;"lt"!=i&&"lte"!==i&&"gt"!==i&&"gte"!==i||"DATE"!=p?s.zdatefield(C,"destroy"):s.zdatefield(C,{format:O,picker:!0})}),!t.sVal){if("DATE"!=p)this.DOM.customTxt1.value=t.v1,this.DOM.customTxt2.value=t.v2;else{var F=["lt","lte","gt","gte"];t.o1&&-1!=F.indexOf(t.o1)?s.zdatefield(this.DOM.customTxt1,"setValue",t.v1):this.DOM.customTxt1.value=t.v1,t.o2&&-1!=F.indexOf(t.o2)?(s.zdatefield(C,{format:O,picker:!0}),s.zdatefield(C,"setValue",t.v2)):this.DOM.customTxt2.value=t.v2}this.DOM.orOperator.checked="OR"==t.ft,t.o1&&s.zcombo(this.DOM.criteria1,"setValue",t.o1),t.o2&&s.zcombo(this.DOM.criteria2,"setValue",t.o2)}c=t.v1||t.v2||t.sVal||t.o1||t.o2?"enable":"disable"}else{m(this.DOM.autoFilter,!0),m(this.DOM.customFilter,!1);var M=this.container.querySelector("#"+l);M.checked=!0,M.click(),c=r?"enable":"disable",this.DOM.toggleFilter.classList.remove("autoFilterCls"),this.DOM.toggleFilter.innerText=o["Filter.customFilter"],c=0!=this.getActiveTab().selectedItems.length||0!=this.data.selectedItemIndexes.length?"enable":"disable"}v("clearbtn",c),v("filterbtn",c),function(t){var e=function(){this.callback.clearFilter(this.data.index),this.close()}.bind(this),i=function(){var t,e,i,l,r,o,c="none"==this.DOM.customFilter.style.display,n=this.data,h=n.dT,u=(n.index,["lt","lte","gt","gte"]);if(c){t=JSON.stringify(this.getActiveTab().selectedItems),e="eq",i="OR";var d=this.getActiveTab().selectedItems.length,f=Object.keys(this.activeTabData).length;o=d==f?a.APPLY_FILTER_ALL:void 0}else{e=this.DOM.criteria1.value,r=this.DOM.criteria2.value;var v=-1!=u.indexOf(e),m=-1!=u.indexOf(r);if("top"==e||"bottom"==e){t=this.container.querySelector("#fspinner").value;var O=this.container.querySelector("#foCategory").value;e=e+" "+O,o=a.SPECIAL_CRITERIA}else(v||m)&&"DATE"==h?(t=v?s.zdatefield(this.DOM.customTxt1,"getValue").dateString:this.DOM.customTxt1.value,l=m?s.zdatefield(this.DOM.customTxt2,"getValue").dateString:this.DOM.customTxt2.value,r=m?r:""!==this.DOM.customTxt2.value?this.DOM.criteria2.value:"",i=1==this.DOM.andOperator.checked?"AND":"OR"):(t=""!==this.DOM.customTxt1.value?this.DOM.customTxt1.value:"",l=""!==this.DOM.customTxt2.value?this.DOM.customTxt2.value:"",r=""!==this.DOM.customTxt2.value?this.DOM.criteria2.value:"",i=1==this.DOM.andOperator.checked?"AND":"OR")}this.callback.applyFilter(n.index,h,t,e,i,l,r,o),this.close()}.bind(this);this.DOM.clearbtn.onclick=function(){"enable"==t&&e()},this.DOM.filterbtn.onclick=function(){i()}}.call(this,c),m(this.DOM.maxInfo,t.smd)},close:function(){this.container&&""===this.container.style.display&&(this.container.style.display="none",n.call(this)),this.callback.dialogClose()},clearAllSelectedItems:function(){this.selectedItemsCount-=this.filterTypes[this.prevTab].selectedItems.length,this.filterTypes[this.prevTab].selectedItems,this.filterTypes[this.prevTab]={},this.filterTypes[this.prevTab].selectedItems=[]},getIndexOfSelectedItem:function(t){return this.getActiveTab().selectedItems.indexOf(t)},removeSelectedItem:function(t){this.getActiveTab().selectedItems.splice(t,1)},initActiveTab:function(){this.filterTypes[this.activeTab]={},this.filterTypes[this.activeTab].selectedItems=[],u.call(this)},addSelectItem:function(t){this.filterTypes[this.activeTab].selectedItems.push(t)},getActiveTab:function(){return this.filterTypes[this.activeTab]},getFilterdTab:function(){return this.filterTypes[this.prevTab]},changeDateFormat:function(t){this.dateFormat=t}},i.Filter.Dialog=c}(this);
!function(e){e.sPlusPlus;var t=e.ZSConstants.I18N;function s(e,t){this.type=e,this.callback=t}s.prototype={init:function(){this.model={inputProps:{className:"filterItem"},inputAttrs:{},spanProps:{className:"flClrPallete"}},this.eventListener={click:this.setSelectedItems}},generateAutoFilterItems:function(e,s,l){this.init();var i=document.createDocumentFragment(),n=this.model.inputProps,r=this.model.inputAttrs;if(this.type)var a=!("filterCellValue"!=this.type||!s);else a=!!s;var o=e||t["Filter.blanks"];r.value=e,n.title=o,n.innerText=o;var m=new ZSClass.Filter.Item("div",n,r,this,this.eventListener,l).getElement();return a&&this.setSelectedItems(m,a),i.appendChild(m),i},generateCellColorItems:function(e){this.init();var s=document.createDocumentFragment(),l=this.model.inputProps,i=this.model.inputAttrs,n=this.model.spanProps;for(var r in e){var a=!("filterCellColor"!=this.type||!e[r]),o=r,m={innerText:""==o?t["Filter.noFill"]:""};i.value="bycellcolor("+o+")";var p=new ZSClass.Filter.Item("div",l,i,this,this.eventListener).getElement(),c=new ZSClass.Filter.Item("span",m).getElement();a&&this.setSelectedItems(p,a),n.style={},n.style.backgroundColor=o;var h=new ZSClass.Filter.Item("span",n).getElement();p.appendChild(h),p.appendChild(c),s.appendChild(p)}return s},generateTextColorItems:function(e){this.init();var s=document.createDocumentFragment(),l=this.model.inputProps,i=this.model.inputAttrs,n=this.model.spanProps;for(var r in e){var a=!("filterTextColor"!=this.type||!e[r]),o=r,m={innerText:""==o?t["Filter.default"]:""};i.value="byfontcolor("+o+")";var p=new ZSClass.Filter.Item("div",l,i,this,this.eventListener).getElement(),c=new ZSClass.Filter.Item("span",m).getElement();a&&this.setSelectedItems(p,a),n.style={},n.style.backgroundColor=""==o?"black":o;var h=new ZSClass.Filter.Item("span",n).getElement();p.appendChild(h),p.appendChild(c),s.appendChild(p)}return s},setSelectedItems:function(e,t){var s=e.getAttribute("value");e.classList.toggle("filterItemSelect"),this.callback&&this.callback(s)}},ZSClass.Filter.selectItems=s}(this);
!function(t){function e(t,e,s,i,n,c){this.type=t,this.props=e,this.attributes=s,this.events=n,this.parent=i,this.elem=c}function s(t,e){Object.keys(e).forEach(function(s){"style"==s?function(t,e){Object.keys(e).forEach(function(s){t.style[s]=e[s]})}(t,e[s]):t[s]=e[s]})}e.prototype.getElement=function(){var t=this.elem||document.createElement(this.type);return this.props&&s(t,this.props),this.attributes&&function(t,e){Object.keys(e).forEach(function(s){t.setAttribute(s,e[s])})}(t,this.attributes),this.events&&function(t,e,s){Object.keys(s).forEach(function(i){t.addEventListener(i,function(){s[i].call(e,this)})})}(t,this.parent,this.events),t},ZSClass.Filter.Item=e}();
!function(t){t.sPlusPlus;var s=t.ZSClass.AutoSuggest;function e(t){s.register.call(this,t);var e,n,i={input:function(){var t=(s=this.editor,e=s.value,n=s.selectionStart,i=s.selectionEnd,r=function(t,s,e){var n=/[\/\-()-+=,~@%^*"|;<>'&}{\n ]/g,i=t.substring(0,s),r=t.substring(e,t.length),u=s-i.split(n).pop().length,g=e+r.split(n)[0].length;t.substring(0,u),t.substring(g,t.length);return{start:u,end:g}}(e,n,i),e.substring(r.start,r.end));var s,e,n,i,r;this.suggest(t)}.bind(this)};e=this.editor,n=i,Object.keys(n).forEach(function(t){var s=n[t];e.addEventListener(t,s)}),this.suggest("")}e.prototype=new s.register,s.filterSuggest=e}(this);
!function(t){var i=t.sPlusPlus,e=t.ZSClass,n=(i.view.Events.Key,t.ZSConstants),s=n.JSKeyCode,c=n.wCC;function o(t){this.callback=t,this.init()}function a(t){var i=t;this.activeElement&&this.activeElement.classList.remove("active"),i.classList.add("active"),this.activeElement=t}function l(t){return t.preventDefault(),!1}function r(t){return this.listAry.indexOf(t)}function h(t,i){t.scrollTop=i}function u(t){this.container.offsetHeight;var i=t.offsetTop,e=this.container.scrollTop,n=this.listAry.length-1;i<e?h(this.container,i):i==n*t.offsetHeight&&h(this.container,i)}o.prototype={init:function(){this.container=document.createElement("ul"),this.container.classList.add("pickListMenu"),this.container.addEventListener("mousemove",function(){this.container.classList.remove("pointer")}.bind(this)),this.container.id=c.SUBMENUITEM+"PICK_LIST"+c.IDENTITY,document.body.appendChild(this.container),this.context=new e.KeyMapping,this.bindEvents()},getDialogPos:function(){return{height:this.container.offsetHeight}},getDisplay:function(){return this.container.style.display},setDialogPos:function(t){var i=t.top,e=t.left,n=t.height<this.container.offsetHeight?t.height+"px":"auto";this.container.style.top=i+"px",this.container.style.left=e+"px",this.container.style.height=n},close:function(){this.container.style.cssText="",this.container.style.display="none",this.container.innerHTML="",this.reset()},reset:function(){this.activeElement=void 0},show:function(t,i){this.listAry=[];var e=document.createDocumentFragment(),n=t.length;if(0!=n)for(var s=0;s<n;s++){var c=t[s];(l=document.createElement("li")).addEventListener("click",this.callback.submit.bind(this,c)),l.addEventListener("mouseover",a.bind(this,l)),this.listAry.push("list_"+s),l.setAttribute("id","list_"+s);var o=document.createTextNode(c);l.appendChild(o),e.appendChild(l)}else{var l=document.createElement("li");o=document.createTextNode("none");l.appendChild(o),e.appendChild(l)}this.container.style.display="",this.container.appendChild(e),i&&this.setDialogPos(i),this.setActiveCellFocus()},setActiveCellFocus:function(){if(this.activeElement){a.call(this,this.activeElement);var t=this.activeElement.offsetTop;h(this.container,t)}},bindEvents:function(){var t=i.view.Events.Key.Entry.PickList.Context.keyDown;t[s.ESC]=function(){this.callback.close()}.bind(this),t[s.ENTER]=function(){var t=this.activeElement&&this.activeElement.textContent;return t&&this.callback.submit(t),!1}.bind(this),t[s.DOWN]=function(){if(0==this.listAry.length)return;var t=this.activeElement;if(this.container.classList.add("pointer"),t){var i=t.getAttribute("id"),e=r.call(this,i),n=function(t){var i=t+1>=this.listAry.length?0:t+1,e=this.listAry[i];return this.container.querySelector("#"+e)}.call(this,e);a.call(this,n),function(t){var i=this.container.offsetHeight,e=t.offsetTop;if(e+t.offsetHeight>i){var n=this.container.scrollTop;h(this.container,n+t.offsetHeight)}else 0==e&&h(this.container,0)}.call(this,n)}else{var s=this.container.childNodes[0];a.call(this,s)}return!1}.bind(this),t[s.UP]=function(){if(0==this.listAry.length)return;var t=this.activeElement;if(this.container.classList.add("pointer"),t){var i=t.getAttribute("id"),e=r.call(this,i),n=function(t){var i=t-1<0?this.listAry.length-1:t-1,e=this.listAry[i];return this.container.querySelector("#"+e)}.call(this,e);a.call(this,n),u.call(this,n)}else{var s=this.listAry.length,c=this.container.childNodes[s-1];a.call(this,c),u.call(this,c)}return!1}.bind(this),t[s.LEFT]=l,t[s.RIGHT]=l,t[s.PURE_PRINTABLE_CHAR]=this.close.bind(this)}},e.PickFromList=o}(this);
!function(y){var d,e,t=y.sPlusPlus,M=y.ZSClass,i=y.ZSEvents,s=y.ZSConstants,n=y.UIUtil.Component,r=(s.JSKeyCode,s.wCC,i.topic),a=i.Groups,o=i.Names,l={"ar-SA":"dd/MM/yy","bg-BG":"dd.M.yyyy","ca-ES":"dd/MM/yyyy","zh-TW":"yyyy/M/d","cs-CZ":"d.M.yyyy","da-DK":"dd-MM-yyyy","de-DE":"dd.MM.yyyy","el-GR":"d/M/yyyy","en-US":"M/d/yyyy","fi-FI":"d.M.yyyy","fr-FR":"dd/MM/yyyy","he-IL":"dd/MM/yyyy","hu-HU":"yyyy. MM. dd","is-IS":"d.M.yyyy","it-IT":"dd/MM/yyyy","ja-JP":"yyyy/MM/dd","ko-KR":"yyyy-MM-dd","nl-NL":"d-M-yyyy","nb-NO":"dd.MM.yyyy","pl-PL":"yyyy-MM-dd","pt-BR":"d/M/yyyy","ro-RO":"dd.MM.yyyy","ru-RU":"dd.MM.yyyy","hr-HR":"d.M.yyyy","sk-SK":"d. M. yyyy","sq-AL":"yyyy-MM-dd","sv-SE":"yyyy-MM-dd","th-TH":"d/M/yyyy","tr-TR":"dd.MM.yyyy","ur-PK":"dd/MM/yyyy","id-ID":"dd/MM/yyyy","uk-UA":"dd.MM.yyyy","be-BY":"dd.MM.yyyy","sl-SI":"d.M.yyyy","et-EE":"d.MM.yyyy","lv-LV":"yyyy.MM.dd","lt-LT":"yyyy.MM.dd","fa-IR":"MM/dd/yyyy","vi-VN":"dd/MM/yyyy","hy-AM":"dd.MM.yyyy","az-Latn-AZ":"dd.MM.yyyy","eu-ES":"yyyy/MM/dd","mk-MK":"dd.MM.yyyy","af-ZA":"yyyy/MM/dd","ka-GE":"dd.MM.yyyy","fo-FO":"dd-MM-yyyy","hi-IN":"dd-MM-yyyy","ms-MY":"dd/MM/yyyy","kk-KZ":"dd.MM.yyyy","ky-KG":"dd.MM.yy","sw-KE":"M/d/yyyy","uz-Latn-UZ":"dd/MM yyyy","tt-RU":"dd.MM.yyyy","pa-IN":"dd-MM-yy","gu-IN":"dd-MM-yy","ta-IN":"dd-MM-yyyy","te-IN":"dd-MM-yy","kn-IN":"dd-MM-yy","mr-IN":"dd-MM-yyyy","sa-IN":"dd-MM-yyyy","mn-MN":"yy.MM.dd","gl-ES":"dd/MM/yy","kok-IN":"dd-MM-yyyy","syr-SY":"dd/MM/yyyy","dv-MV":"dd/MM/yy","ar-IQ":"dd/MM/yyyy","zh-CN":"yyyy/M/d","de-CH":"dd.MM.yyyy","en-GB":"dd/MM/yyyy","es-MX":"dd/MM/yyyy","fr-BE":"d/MM/yyyy","it-CH":"dd.MM.yyyy","nl-BE":"d/MM/yyyy","nn-NO":"dd.MM.yyyy","pt-PT":"dd-MM-yyyy","sr-Latn-CS":"d.M.yyyy","sv-FI":"d.M.yyyy","az-Cyrl-AZ":"dd.MM.yyyy","ms-BN":"dd/MM/yyyy","uz-Cyrl-UZ":"dd.MM.yyyy","ar-EG":"dd/MM/yyyy","zh-HK":"d/M/yyyy","de-AT":"dd.MM.yyyy","en-AU":"d/MM/yyyy","es-ES":"dd/MM/yyyy","fr-CA":"yyyy-MM-dd","sr-Cyrl-CS":"d.M.yyyy","ar-LY":"dd/MM/yyyy","zh-SG":"d/M/yyyy","de-LU":"dd.MM.yyyy","en-CA":"dd/MM/yyyy","es-GT":"dd/MM/yyyy","fr-CH":"dd.MM.yyyy","ar-DZ":"dd-MM-yyyy","zh-MO":"d/M/yyyy","de-LI":"dd.MM.yyyy","en-NZ":"d/MM/yyyy","es-CR":"dd/MM/yyyy","fr-LU":"dd/MM/yyyy","ar-MA":"dd-MM-yyyy","en-IE":"dd/MM/yyyy","es-PA":"MM/dd/yyyy","fr-MC":"dd/MM/yyyy","ar-TN":"dd-MM-yyyy","en-ZA":"yyyy/MM/dd","es-DO":"dd/MM/yyyy","ar-OM":"dd/MM/yyyy","en-JM":"dd/MM/yyyy","es-VE":"dd/MM/yyyy","ar-YE":"dd/MM/yyyy","en-029":"MM/dd/yyyy","es-CO":"dd/MM/yyyy","ar-SY":"dd/MM/yyyy","en-BZ":"dd/MM/yyyy","es-PE":"dd/MM/yyyy","ar-JO":"dd/MM/yyyy","en-TT":"dd/MM/yyyy","es-AR":"dd/MM/yyyy","ar-LB":"dd/MM/yyyy","en-ZW":"M/d/yyyy","es-EC":"dd/MM/yyyy","ar-KW":"dd/MM/yyyy","en-PH":"M/d/yyyy","es-CL":"dd-MM-yyyy","ar-AE":"dd/MM/yyyy","es-UY":"dd/MM/yyyy","ar-BH":"dd/MM/yyyy","es-PY":"dd/MM/yyyy","ar-QA":"dd/MM/yyyy","es-BO":"dd/MM/yyyy","es-SV":"dd/MM/yyyy","es-HN":"dd/MM/yyyy","es-NI":"dd/MM/yyyy","es-PR":"dd/MM/yyyy","am-ET":"d/M/yyyy","tzm-Latn-DZ":"dd-MM-yyyy","iu-Latn-CA":"d/MM/yyyy","sma-NO":"dd.MM.yyyy","mn-Mong-CN":"yyyy/M/d","gd-GB":"dd/MM/yyyy","en-MY":"d/M/yyyy","prs-AF":"dd/MM/yy","bn-BD":"dd-MM-yy","wo-SN":"dd/MM/yyyy","rw-RW":"M/d/yyyy","qut-GT":"dd/MM/yyyy","sah-RU":"MM.dd.yyyy","gsw-FR":"dd/MM/yyyy","co-FR":"dd/MM/yyyy","oc-FR":"dd/MM/yyyy","mi-NZ":"dd/MM/yyyy","ga-IE":"dd/MM/yyyy","se-SE":"yyyy-MM-dd","br-FR":"dd/MM/yyyy","smn-FI":"d.M.yyyy","moh-CA":"M/d/yyyy","arn-CL":"dd-MM-yyyy","ii-CN":"yyyy/M/d","dsb-DE":"d. M. yyyy","ig-NG":"d/M/yyyy","kl-GL":"dd-MM-yyyy","lb-LU":"dd/MM/yyyy","ba-RU":"dd.MM.yy","nso-ZA":"yyyy/MM/dd","quz-BO":"dd/MM/yyyy","yo-NG":"d/M/yyyy","ha-Latn-NG":"d/M/yyyy","fil-PH":"M/d/yyyy","ps-AF":"dd/MM/yy","fy-NL":"d-M-yyyy","ne-NP":"M/d/yyyy","se-NO":"dd.MM.yyyy","iu-Cans-CA":"d/M/yyyy","sr-Latn-RS":"d.M.yyyy","si-LK":"yyyy-MM-dd","sr-Cyrl-RS":"d.M.yyyy","lo-LA":"dd/MM/yyyy","km-KH":"yyyy-MM-dd","cy-GB":"dd/MM/yyyy","bo-CN":"yyyy/M/d","sms-FI":"d.M.yyyy","as-IN":"dd-MM-yyyy","ml-IN":"dd-MM-yy","en-IN":"dd/MM/yyyy","or-IN":"dd-MM-yy","bn-IN":"dd-MM-yy","tk-TM":"dd.MM.yy","bs-Latn-BA":"d.M.yyyy","mt-MT":"dd/MM/yyyy","sr-Cyrl-ME":"d.M.yyyy","se-FI":"d.M.yyyy","zu-ZA":"yyyy/MM/dd","xh-ZA":"yyyy/MM/dd","tn-ZA":"yyyy/MM/dd","hsb-DE":"d. M. yyyy","bs-Cyrl-BA":"d.M.yyyy","tg-Cyrl-TJ":"dd.MM.yy","sr-Latn-BA":"d.M.yyyy","smj-NO":"dd.MM.yyyy","rm-CH":"dd/MM/yyyy","smj-SE":"yyyy-MM-dd","quz-EC":"dd/MM/yyyy","quz-PE":"dd/MM/yyyy","hr-BA":"d.M.yyyy.","sr-Latn-ME":"d.M.yyyy","sma-SE":"yyyy-MM-dd","en-SG":"d/M/yyyy","ug-CN":"yyyy-M-d","sr-Cyrl-BA":"d.M.yyyy","es-US":"M/d/yyyy"};function c(y,d,e){d.style.display="block",this.allowChange=!1,this.CellEditor=y,this.container=d,this.create(),this.init(e),this.set(e),setTimeout(function(){y.Editor.focus()},100),this.allowChange=!0,this.enabled=!0}function h(y,d,e){d.style.display="block",this.allowChange=!1,this.CellEditor=y,this.container=d,this.create(),this.init(e),this.set(e),setTimeout(function(){y.Editor.focus()},100),this.allowChange=!0,this.enabled=!0}c.prototype={create:function(){this.picker=document.createElement("DIV"),this.picker.id="cellDtPck",this.hasTime?this.setStyleForTime.call(this):this.removeStyleForTime.call(this),this.picker.setAttribute("data-ctype","zdatepicker"),this.picker.setAttribute("data-picker",!0),this.container.appendChild(this.picker)},init:function(){this.removeStyleForTime.call(this);var y={format:"MMM dd, yyyy",type:"inline",forElement:this.CellEditor.Editor,appendTo:this.container,change:this.onChange.bind(this),dateselect:this.onDateChange.bind(this),close:this.onClose.bind(this),width:"300px"};n.zdatepicker("#cellDtPck",y),n.zdatepicker("#cellDtPck","open");var d=this.container.getBoundingClientRect(),e=d.height,t=d.width;UserAction.calcPosition(this.CellEditor.DatePickerContainer,this.CellEditor,void 0,void 0,t,e)},setStyleForTime:function(){this.container.classList.add("tmPck"),this.container.classList.remove("dtPck")},removeStyleForTime:function(){this.container.classList.remove("tmPck"),this.container.classList.add("dtPck")},set:function(y){y&&n.zdatepicker("#cellDtPck","setValue",y)},onDateChange:function(y,d){if(this.allowChange){var e=t.view.getActiveGridID(),M=t.view.getResourceID(e),i=t.view.getSheetID(e),s=t.view.getVersionID(e),n=t.view.CellEditor.getEditCell(),l=this.createLocaleDateString(d.options.value);n&&n.getRID()&&UserAction.SubmitCell(n.getRID(),[n.getSheetID()],n.getVersion(),l,n.getRow(),n.getCol(),!0,void 0),setTimeout(function(){r.publish(a.Gesture.Selector.CellEdit,o.GESTURE.ACTION.ENUMERATE,{RID:M,SHEETID:i,VERSION:s,isSubmittable:0})},0)}},onChange:function(y,e){var t=new Date(e.options.value);new Intl.DateTimeFormat(d,{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(t)},onClose:function(y,d){this.container.style.display="none",this.enabled=!1},createLocaleDateString:function(y){var t=new Date(y),M="en-US";d&&e&&(M=d+"-"+e);var i=l[M];void 0==i&&(i="dd/MM/yyyy");var s=t.getDate(),n=t.getMonth()+1,r=t.getFullYear();return i=(i=(i=(i=(i=i.replace("dd","d")).replace("MM","M")).replace("d",s)).replace("M",n)).replace("yyyy",r)}},h.prototype={create:function(){this.picker=document.createElement("DIV"),this.picker.id="cellDtPck",this.hasTime?this.setStyleForTime.call(this):this.removeStyleForTime.call(this),this.picker.setAttribute("data-ctype","zdatetimepicker"),this.picker.setAttribute("data-picker",!0),this.picker.setAttribute("data-time-field-type","input"),this.picker.setAttribute("data-time-multiple-select-box-type","h-m-t"),this.container.appendChild(this.picker)},init:function(y){var d=new Date(y).toTimeString(),e=d.split(":");if(e.length>1){var t=parseInt(e[0]);d=(t=(t=0==t?12:t)>12?t%12:t)+":"+e[1]}this.setStyleForTime.call(this);var M={format:"MMM dd, yyyy hh:mm:ss tt",type:"inline",forElement:this.CellEditor.Editor,appendTo:this.container,dateselect:this.onDateChange.bind(this),close:this.onClose.bind(this),width:"300px"};n.zdatetimepicker("#cellDtPck",M),n.zdatetimepicker("#cellDtPck","open");var i=this.container.getBoundingClientRect(),s=i.height,r=i.width;UserAction.calcPosition(this.CellEditor.DatePickerContainer,this.CellEditor,void 0,void 0,r,s)},setStyleForTime:function(){this.container.classList.add("tmPck"),this.container.classList.remove("dtPck")},removeStyleForTime:function(){this.container.classList.remove("tmPck"),this.container.classList.add("dtPck")},set:function(y){y&&n.zdatetimepicker("#cellDtPck","setValue",y)},onDateChange:function(y,d){if(this.allowChange){var e=t.view.getActiveGridID(),M=t.view.getResourceID(e),i=t.view.getSheetID(e),s=t.view.getVersionID(e),n=t.view.CellEditor.getEditCell(),l=this.createLocaleDateString(d.options.value);n&&n.getRID()&&UserAction.SubmitCell(n.getRID(),[n.getSheetID()],n.getVersion(),l,n.getRow(),n.getCol(),!0,void 0),setTimeout(function(){r.publish(a.Gesture.Selector.CellEdit,o.GESTURE.ACTION.ENUMERATE,{RID:M,SHEETID:i,VERSION:s,isSubmittable:0})},0)}},onClose:function(y,d){this.container.style.display="none",this.enabled=!1},createLocaleDateString:function(y){var t=new Date(y),M="en-US";d&&e&&(M=d+"-"+e);var i=l[M];void 0==i&&(i="dd/MM/yyyy");var s=t.getDate(),n=t.getMonth()+1,r=t.getFullYear();return i=(i=(i=(i=(i=(i=i.replace("dd","d")).replace("MM","M")).replace("d",s)).replace("M",n)).replace("yyyy",r))+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}},M.DatePicker={},M.DatePicker.getPicker=function(y,d,e,t,M){return M?new h(y,d,e):new c(y,d,e,t,M)},r.register(a.Listener,o.DocMeta.DOCUMENT_LOCALE,function(y,t){d=y,e=t},"LANGUAGE","COUNTRY")}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,i=t.view.Toolbar.Feature[o.IMAGE],a=10,n=e.ZSEvents,s=n.topic,r=n.Groups,g=n.Names,d=e.UIUtil.Component,l=e.ZSConstants.ActionConstants,I=!1;var c=new function(){ZSClass.KeyMapping.call(this)},p=t.view.Events.Key;function u(o,i){var n=-1==t.data.AppRegistry.ZFSNG_PRODUCT_TYPE,s=!n||-1!=t.data.UserInfo.zuid,r={isRemoteMode:n,gadgetsURL:"//"+t.data.AppRegistry.gadgetUrl,enableGadgets:s,gadgets:{hostname:"",serviceName:"sheet"},noOfImagesToBeSelected:a||50,onInsert:v,onInsertType:void 0!=i?i:"INSERT"};if(n){var g=t.view.getActiveGridID(),c=t.view.getResourceID(g),u=t.view.getVersionID(g),D={URL:"imagefileupload",action:l.IMAGE_UPLOAD},C=new e.ZSClass.RequestParameters(D);r.uploadURL=C.getURL(c,u)+"?"+C.getParametersAsString(c,u,!1)}else r.product_type=t.data.AppRegistry.ZFSNG_PRODUCT_TYPE,r.owner_id=t.data.AppRegistry.OWNER_ZUID;p.focusContext(p.Entry.Dialog.Context),I||(d.bind("#zfeedbackDialog","zdialogclose",function(e,t){p.focusContext(p.Entry.CellEditor.Context)}),I=!0),d.initFcomponents(),FCImageLibrary.open(r)}function v(e){var o=t.view.getActiveGridID(),i=t.view.getResourceID(o),a=t.view.getSheetID(o),n=t.view.getVersionID(o);t.data.getWorkBook(i,n);s.publish(r.Listener,g.SheetAction.IMAGES.UPLOAD,{RID:i,SHEETID:a,VERSION:n,IMAGES:e.info,DATA:e}),FCImageLibrary.close()}p.Entry.Dialog.Node.addChildNode(c),s.register(r.UI,g.Toolbar.IMAGE.CLICK,u,"EV","ID"),i.openDialog=u}(this);
!function(e){var t,n,r,i,o,a,s,l,c=e.sPlusPlus,u=e.ZSConstants,v=u.FeatureConstants,d=e.UIUtil.Component,S=u.I18N,g=e.ZSEvents,p=g.Groups,C=g.Names,I=g.topic,y=c.view.Toolbar.Feature[v.SOLVER],m=[];function E(){var e=new y.Constraint(t);e.addConstraintToUI(),e.initComponents(),m.push(e)}function D(){var e=c.data.getWorkBook(l.rID,l.version).getSheetObj(l.sheetID).Prop.getName(),t=c.view.getSheetState(l.gridID,l.sheetID).getActiveCellRange().getLabel();r.value=e+"."+t}function h(){d.destroyComponent(t);var u=c.view.getActiveGridID(),v=c.view.getResourceID(u),S=c.view.getVersionID(u),g=c.view.getSheetID(u);l.sheetID!=g&&e.UserAction.SwitchSheet(v,g,S,l.sheetID),r.value="",i.value="",o.checked=!0,s.value="",d.zcombo(a,"setValue","MAXIMIZE"),s.style.display="none",t.innerHTML="",0,m=[],n.style.display=""}y.openDialog=function(){l||function(){var c=e.UserAction.getTemplate(["solverTemplate"]).solverTemplate,u=document.createElement("div");u.id="DI_SOLVER",u.appendChild(c),r=new ZSClass.Editors.RangeEditor(u.querySelector("#targetCell")),i=new ZSClass.Editors.RangeEditor(u.querySelector("#variantCells")),ZSClass.RangePicker.register(r,!0,!0),ZSClass.RangePicker.register(i,!0),o=u.querySelector("#nonNegative"),a=u.querySelector("#optimizeTo"),s=u.querySelector("#specificValue"),d.bind(a,"zselectboxchange",function(e,t){"VALUE"==t.value?s.style.display="inline-block":s.style.display="none"}),t=u.querySelector("#solverConstraintsContainer"),(n=u.querySelector("#addSolverConstraint")).addEventListener("click",E),u.querySelector("#clBtn").addEventListener("click",function(){l.close()}),u.querySelector("#okBtn").addEventListener("click",function(){var e,t=r.value.trim(),n=i.value.trim(),l=d.zcombo(a,"getValue"),c="VALUE"==l,u=o.checked;c&&(e=s.value.trim()),y.execute(t,n,l,u,e,m,c)});var v={width:560,title:S["MenuItem.DataTab.Solver"],close:h,open:D};l=new ZSClass.Dialog(u,v);var g=u.querySelector("#rangePickerVariant");ZSClass.RangePicker.Dialog.register(i,l,g,S["MenuItem.DataTab.Solver"])}(),E(),l.open(),r.focus()},I.register(p.Listener,C.UserAction.SOLVER.REMOVE_CONSTRAINT,function(e){m.splice(e,1)},"INDEX")}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=t.UIUtil.Component,i=e.view.Toolbar.Feature[s.SOLVER],r=0,o=[],a=t.ZSEvents,l=a.Groups,p=a.Names,u=a.topic;function d(t){this.parent=t;var e=UserAction.getTemplate(["solverConstraintTemplate"]).solverConstraintTemplate;this.expressionEditor=new ZSClass.Editors.RangeEditor(e.querySelector("#constraintExpression")),this.valueEditor=new ZSClass.Editors.RangeEditor(e.querySelector("#constraintValue")),ZSClass.RangePicker.register(this.expressionEditor,!0,!0),ZSClass.RangePicker.register(this.valueEditor,!0,!0),this.closeButton=e.querySelector("#solverConstraintClose"),this.closeButton.addEventListener("click",this.remove.bind(this)),this.operator=e.querySelector("#constraintOperator"),this.operator.id=this.operator.id+""+r,r++;var s=document.createElement("div");s.className="dspTblRow",s.appendChild(e),this.solverConstraintElement=s}d.prototype={getExpression:function(){return this.expressionEditor.value.trim()},getValue:function(){return this.valueEditor.value.trim()},addConstraintToUI:function(){this.parent.appendChild(this.solverConstraintElement),this.solverConstraintElement.scrollIntoView(),o.push(this),10==o.length&&(addConstraintBtn.style.display="none")},remove:function(){this.parent.removeChild(this.solverConstraintElement);var t=o.indexOf(this);u.publish(l.Listener,p.UserAction.SOLVER.REMOVE_CONSTRAINT,{INDEX:t}),o.splice(t,1),9==o.length&&(addConstraintBtn.style.display="")},getOperator:function(){return n.zcombo(this.operator,"getValue")},initComponents:function(){n.initComponent(this.operator)}},i.Constraint=d}(this);
!function(e){var t=e.sPlusPlus,r=e.ZSEvents,a=(r.topic,r.Groups,r.Names,e.ZSConstants.FeatureConstants),o=(e.document,e.ZSConstants.I18N),n=(e.ZSConstants.wCC,e.ZSClass),i=n.Editors.RangeEditor,l=n.Editors.TextAreaEditor,s=n.Editors.Utility,c=(n.Range,e.UIUtil.Component,t.view.Toolbar.Feature[a.GOAL_SEEK]),d=void 0,u=void 0;function g(){d.close()}var v={keydown:function(e){13===(e.keyCode||e.which)&&(e.preventDefault(),g())}};var S={keydown:function(e){13==e.which&&(c.execute(),e.preventDefault())}};c.openDialog=function(r){var a,g={width:400,title:o["MenuItem.DataTab.GoalSeek"],close:function(){var r,a,o,n;r=t.view.getActiveGridID(),a=t.view.getResourceID(r),o=t.view.getVersionID(r),n=t.view.getSheetID(r),d.sheetID!=n&&e.UserAction.SwitchSheet(a,n,o,d.sheetID),u.querySelector("#gsVariantCell").innerText="",u.querySelector("#gsResult").value=""},open:function(){var e,r,a,o,n,i;e=t.view.getActiveGridID(),r=t.view.getResourceID(e),a=t.view.getSheetID(e),o=t.view.getVersionID(e),n=t.data.getWorkBook(r,o).getSheetObj(a).Prop.getName(),i=t.view.getActiveState(e).getSheetState(a).getActiveCellRange().getLabel(),u.querySelector("#gsTargetCell").innerText=n+"."+i,u.querySelector("#gsTargetCell").focus()}};d||(a=e.UserAction.getTemplate(["goalSeekTemplate"]).goalSeekTemplate,(u=document.createElement("div")).id="DI_GOALSEEK",u.className="gSd",u.appendChild(a),u.querySelector("#okBtn").addEventListener("click",function(){c.execute()}),u.querySelector("#cancelBtn").addEventListener("click",function(){d.close()}),d=new e.ZSClass.Dialog(u,g),function(){var t=new i(u.querySelector("#gsTargetCell"),!0);n.RangePicker.register(t,!0,!0);var r=u.querySelector("#targetCellRange");n.RangePicker.Dialog.register(t,d,r,o["MenuItem.DataTab.GoalSeek"]+" - "+o["GoalSeek.UI.TargetCell"]),t.addListeners(v),s.animateLabel(t),s.addValidator(t,function(){return e.JSUtil.REGEXP.validCell.test(t.value)},function(){t.Editor.style.borderBottomColor="#dfdfdf"},function(){t.Editor.style.borderBottomColor="#ff8d00"},200);var a=new i(u.querySelector("#gsVariantCell"),!0);n.RangePicker.register(a,!0,!0);var c=u.querySelector("#variantCellRange");n.RangePicker.Dialog.register(a,d,c,o["MenuItem.DataTab.GoalSeek"]+" - "+o["GoalSeek.UI.VariantCell"]),a.addListeners(v),s.animateLabel(a),s.addValidator(a,function(){return e.JSUtil.REGEXP.validCell.test(a.value)},function(){a.Editor.style.borderBottomColor="#dfdfdf"},function(){a.Editor.style.borderBottomColor="#ff8d00"},200);var g=new l(u.querySelector("#gsResult"));s.animateLabel(g),g.addListeners(S)}()),d.open()},c.closeDialog=g}(this);
!function(e){var t,n,i,o,s,a,r,l=e.sPlusPlus,c=e.ZSEvents,u=c.topic,d=c.Groups,S=c.Names,v=e.ZSConstants.FeatureConstants,E=(e.document,e.ZSConstants.I18N),g=(e.ZSConstants.wCC,e.ZSClass),p=(g.Editors.RangeEditor,g.Editors.TextAreaEditor,g.Editors.Utility,g.Range,e.UIUtil.Component,l.view.Toolbar.Feature[v.GOAL_SEEK]);function m(){n.close();var e=l.view.getActiveGridID();l.view.getSheetID(e);UserAction.SubmitCell(i,o,s,r,a.startRow,a.startCol)}function C(){var e,t,n,i;e=l.view.getActiveGridID(),t=l.view.getResourceID(e),n=l.view.getSheetID(e),i=l.view.getVersionID(e),u.publish(d.Listener,S.Layers.Preview.RemoveAll,{RID:t,SHEETID:n,VERSION:i,isDataNeeded:!0})}p.openResultDialog=function(i,o,s){n||function(){var i=e.UserAction.getTemplate(["GoalSeekResponseTemplate"]).GoalSeekResponseTemplate;(t=document.createElement("div")).id="DI_GOALSEEK_RESULT",t.className="gSd",t.appendChild(i),t.querySelector("#okBtn").addEventListener("click",m),t.querySelector("#clBtn").addEventListener("click",function(){n.close()});var o={modal:!0,width:350,title:E["MenuItem.DataTab.GoalSeek"],close:C,open:function(){}};n=new g.Dialog(t,o)}(),t.querySelector("#gsMessage").innerText=i,t.querySelector("#targetCellValue").innerText=o,t.querySelector("#gsResultVal").innerText=s,n.open()},p.initCopyParams=function(e,t,n,l,c){i=e,s=t,o=n,a=l,r=c}}(this);
!function(e){var o,t,n,i=e.sPlusPlus,r=e.ZSConstants,s=r.FeatureConstants,a=(e.document,r.I18N,r.wCC),c=e.ZSClass,l=e.ZSEvents,u=(l.Groups,l.Names,l.topic,i.view.Toolbar.Feature[s.IMPORT]);function d(){}function p(){o&&o.close()}u.openDialog=function(){var e={import:u.execute,importCancel:p,openDialog:d,closeDialog:p};o||(o=new c.ImportDialog(e),u.Dialog=o),o.open()},u.closeDialog=p,u.openEncryptedDialog=function(e){if(!n){var o=UserAction.getTemplate(["openImportPasswordDialogue"]).openImportPasswordDialogue,i=document.createElement("div");i.id=a.DI+s.IMPORT+a.IDENTITY,n=new c.Dialog(i,{width:400,title:"Password Protected"}),function(e){var o=e.querySelector("#ImportBtn"),i=e.querySelector("#CancelBtn"),r=e.querySelector("#SetPassword");o.addEventListener("click",function(e){var o=document.querySelector("#SetPassword").value;u.importEncryptedAction(o,t)}),r.addEventListener("keydown",function(){u.hideWrongPasswordMessage()}),i.addEventListener("click",function(e){n.close()})}(o),i.appendChild(o)}t=e,n.open()},u.closePasswordDialog=function(){n&&n.close()}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSClass,r=(e.document,e.ZSConstants),s=r.I18N,o=(r.ActionConstants,i.Editors.RangeEditor,e.ZSConstants.JSKeyCode,i.Editors),n=(i.Editors.Utility,e.UIUtil.Component),l=t.data.UserInfo.Permission.isEditable,a=(UserAction.DelimiterDetector,function(e,t){this.callback=e,this.enableImportOptions=void 0==t||t,this.init()});a.prototype={init:function(){var t=function(){this.DOM.fileImportOpt.checked=!0,d.call(this)}.bind(this),i=function(){this.DOM.fileImportOpt.checked=!0,this.importOption="createNew",I.bind(this)(!1,!0),c.bind(this)()}.bind(this),o={modal:!1,width:650,title:s["MenuItem.FileTab.Import"],close:function(){t()},open:function(){(function(){var e=this.Dom;l||(e.querySelector("#importAsTemplate").disabled=!0,e.querySelector("#replaceSpreadsheet").disabled=!0,e.querySelector("#replaceCurrSheet").disabled=!0,e.querySelector("#insertSheets").disabled=!0,e.querySelector("#appendRows").disabled=!0,e.querySelector("#replaceData").disabled=!0)}).call(this),i()}},a=this.getDialogContent();this.dialog=new e.ZSClass.Dialog(a,o),this.initEditor(this.dialog,a),function(){var e=this.dialog.Dom;this.DOM={container:e,fileUrl:e.querySelector("#xurl"),importBtn:e.querySelector("#import"),importBtnTxt:e.querySelector("#import").childNodes[1],fileUploadEl:e.querySelector("#content"),fileImportOpt:e.querySelector("#fileimport"),urlImportOpt:e.querySelector("#urlimport"),importOptions:e.querySelectorAll("input[name=importview]"),emsg:e.querySelector("#eMsg"),emsgs:e.querySelector("#eMsgs"),delimiterContainer1:e.querySelector("#delimiterContainer1"),delimiterContainer2:e.querySelector("#delimiterContainer2"),delimiter1:e.querySelector("#delimiter1"),delimiter2:e.querySelector("#delimiter2"),customDelimiter1:e.querySelector("#customDelimiter1"),customDelimiter2:e.querySelector("#customDelimiter2")},this.importOption="createNew",this.showErrorMsg=h,this.errorMsg="errorMsg1"}.call(this),this.isURLImport=!1,function(){var e=this,t=this.DOM;this.isURLImport;if(t.fileImportOpt.onchange=t.urlImportOpt.onchange=d.bind(this),t.fileUploadEl.onchange=function(){t.fileUploadEl.files.length>0&&e.fileAttach.bind(e)(t.fileUploadEl.files)},t.container.querySelector(".import-close").onclick=d.bind(this),t.container.querySelector("#close").onclick=this.callback.importCancel.bind(this),t.importBtn.onclick=function(){f.bind(this)(!0),this.callback.import.call(this)}.bind(this),this.enableImportOptions)for(var i=0;i<t.importOptions.length;i++)m(e,t.importOptions[i]);else t.container.querySelector("#importOptions").style.display="none";t.fileUrl.oninput=function(){e.fileAttach.bind(e)(t.fileUploadEl.files)},t.container.querySelector("#importForm1").onsubmit=function(i){return e.fileAttach.bind(e)(t.fileUploadEl.files),i.stopPropagation(),!1};var s={valueChanged:function(t){b.bind(e)(!1)}};this.url_editor.addListeners(s),this.url_editor.customPreventDefault=function(e){var t=e.keyCode||e.which;if(r.JSKeyCode.LEFTCOMMAND&&(t==r.JSKeyCode.V||t==r.JSKeyCode.C||t==r.JSKeyCode.X))return e.stopPropagation(),!1},n.bind(this.DOM.delimiter1,"zselectboxchange",function(t,i){"Custom"==i.value?(e.DOM.customDelimiter1.style.display="",e.DOM.customDelimiter1.focus()):e.DOM.customDelimiter1.style.display="none"}),n.bind(this.DOM.delimiter2,"zselectboxchange",function(t,i){"Custom"==i.value?(e.DOM.customDelimiter2.style.display="",e.DOM.customDelimiter2.focus()):e.DOM.customDelimiter2.style.display="none"})}.call(this)},open:function(){this.dialog.open()},close:function(){this.dialog.close()},getDialogContent:function(){var t=e.UserAction.getTemplate(["importTemplate"]).importTemplate,i=document.createElement("div");return i.id="DI_IMPORT",i.appendChild(t),i},initEditor:function(e,t){var r=t.querySelector("#xurl");this.url_editor=new o.TextAreaEditor(r);var n=t.querySelector("#startCell"),l=new o.RangeEditor(n,!0);i.RangePicker.register(l,!0,!0);var c=n.nextElementSibling;i.RangePicker.Dialog.register(l,e,c,s["MenuItem.FileTab.Import"]),a.startCellEditor=l},fileAttach:function(e){var t,i,r=!1,s="",o="",n=this;this.isURLImport?(s=this.DOM.fileUrl.value,this.files=s,o=s.substring(s.lastIndexOf("/")+1).trim(),r=function(){var e=this.DOM.fileUrl.value.trim();this.DOM.fileUrl.value=e;var t=new RegExp("^(http[s]?:\\/\\/(www\\.)?|ftp:\\/\\/(www\\.)?|www\\.){1}(([0-9A-Za-z-\\.@:%_+~#=]+)+((\\.[a-zA-Z]{2,3})+)(/(.)*)?(\\?(.)*)?)*");(t=t.test(e)&&v(e))||(this.errorMsg="errorMsg2");return t}.call(this),i=function(){(function(e,t){c.bind(this)(),e?(this.DOM.container.querySelector("#browseDetails").style.display="block",this.DOM.container.querySelector(".importloadercnt").style.display="none",this.DOM.container.querySelector(".importloadersuccess").style.display="none",this.DOM.fileUrl.style.borderColor="#f26f7b"):(this.DOM.container.querySelector(".importloadercnt").style.display="block",this.DOM.container.querySelector(".importloadersuccess").style.display="block",this.DOM.fileUrl.style.borderColor="",w.bind(this)(t))}).bind(n)(!r,o)}):(this.files=e,o=function(e){var t;if((e=e.split("\\").pop()).length>30){e.split(".");t=e.substr(0,20)+"..."+e.substr(e.length-7,e.length)}else t=e;return t}(e[0].name),t=e[0].size,r=v.bind(this)(o)&&function(e){var t=!0;e>Math.pow(10,7)&&(t=!1,this.errorMsg="errorMsg2");return t}.bind(this)(t),i=function(){y.bind(n)(!r,o)}),r?i.call():this.showErrorMsg(this.errorMsg,!0),O.bind(this)(r),q.bind(this)(this.DOM.container.querySelector("#"+this.importOption))}};function c(){n.zcombo(this.DOM.delimiter1,"setValue","Comma"),n.zcombo(this.DOM.delimiter2,"setValue","Comma"),this.DOM.customDelimiter1.value="",this.DOM.customDelimiter2.value="",this.DOM.customDelimiter1.style.display="none",this.DOM.customDelimiter2.style.display="none",this.DOM.delimiterContainer1.style.display="none",this.DOM.delimiterContainer2.style.display="none"}function d(){(function(){u.bind(this)(!1),f.bind(this)(!1),O.bind(this)(!1),M.bind(this)(!1),y.bind(this)(!0),b.call(this),g.bind(this)(!1)}).call(this);var e=this.DOM.container.querySelector("#browseFile");this.isURLImport=this.DOM.urlImportOpt.checked;var t=this.DOM.container.querySelector("#importview_holder").style,i=this.DOM.fileUrl;this.DOM.fileUrl.value="";var r=this.DOM.fileUploadEl;this.isURLImport?(t.top="-150px",e.style.display="none",i.style.display="block",i.tabIndex=0,r.tabIndex=-1):(t.top="0px",e.style.display="block",i.style.display="none",i.tabIndex=-1,r.tabIndex=0),I.bind(this)(!1)}function h(e,t){f.bind(this)(!1),O.bind(this)(!1),this.isURLImport?b.call(this):(M.bind(this)(!1),y.bind(this)(!0)),t?p.bind(this)(!0):u.bind(this)(!0,e)}function u(e,t){e?(this.DOM.emsgs.style.display="none",this.DOM.emsg.style.display="block",this.DOM.emsg.classList.add("emsg"),this.DOM.emsg.innerText=t):(this.DOM.emsgs.style.display="block",this.DOM.emsg.style.display="none",this.DOM.emsg.classList.remove("emsg"))}function p(e){e?(this.DOM.container.querySelector("#"+this.errorMsg).style.display="",this.DOM.container.querySelector("#"+this.errorMsg).classList.add("emsg")):("errorMsg2"==this.errorMsg&&(this.DOM.container.querySelector("#"+this.errorMsg).style.display="none"),this.DOM.container.querySelector("#"+this.errorMsg).classList.remove("emsg"),this.errorMsg="errorMsg1")}function m(e,t){t.onchange=function(){q.bind(e)(t)}}function y(e,t){if(c.bind(this)(),e)this.DOM.container.querySelector(".filewrapper").style.border="1px dashed #ccc",this.DOM.container.querySelector("#browseFile").style.display="block",this.DOM.container.querySelector("#browseDetails").style.display="block",this.DOM.container.querySelector("#importLabel").style.display="none",this.DOM.container.querySelector("#content").value="",D.bind(this)(!1),S.bind(this)(!0);else{var i=this.DOM.container.querySelector("#importLabel");this.DOM.container.querySelector(".filewrapper").style.border="none",this.DOM.container.querySelector("#browseFile").style.display="none",this.DOM.container.querySelector("#browseDetails").style.display="none",i.style.display="block",i.innerText=t,w.bind(this)(t),M.bind(this)(!0)}}function b(){this.DOM.importBtn.disabled=!0,u.bind(this)(!1),p.bind(this)(!1),this.DOM.container.querySelector("#browseDetails").style.display="block",this.DOM.container.querySelector(".importloadercnt").style.display="none",this.DOM.fileUrl.style.borderColor=""}function D(e){e?(this.DOM.container.querySelector("#scell").style.display="block",this.DOM.container.querySelector("#startCell").focus()):this.DOM.container.querySelector("#scell").style.display="none"}function M(e){e?this.DOM.container.querySelector(".importView_browse").classList.add("importCancel"):this.DOM.container.querySelector(".importView_browse").classList.remove("importCancel")}function O(e){e&&!this.DOM.container.querySelector("#"+this.importOption).disabled?this.DOM.importBtn.disabled=!1:this.DOM.importBtn.disabled=!0}function g(e,t){e?(this.DOM.container.querySelector("#importInfo").innerText=t,this.DOM.container.querySelector("#importInfo").style.display="block"):this.DOM.container.querySelector("#importInfo").style.display="none"}function f(e){e?(this.DOM.importBtn.classList.add("ZsRt"),this.DOM.importBtnTxt.nodeValue=s["Indication.Importing"]):(this.DOM.importBtn.classList.remove("ZsRt"),this.DOM.importBtnTxt.nodeValue=s["Import.Button.Label"])}function S(e){this.DOM.container.querySelector("#csvNote").style.opacity=e?"1":"0"}function v(e){var t=e.split(".").pop();return t=t.toLowerCase(),-1!==["xlsx","xls","xlsm","ods","sxc","csv","tsv"].indexOf(t)}function q(e){var r=e.id;if(e.checked)switch(this.importOption=r,e.id){case"replaceCurrSheet":case"appendRows":var o=function(){var e=t.view.getActiveGridID(),i=t.view.getSheetID(e),r=t.view.getSheetState(e,i),s=t.view.getResourceID(e),o=(r.getActiveRange(),t.view.getVersionID(e)),n=t.data.getWorkBook(s,o);return n.getSheetObj(i).ProtectedRanges.getAllRanges().length>0||n.ProtectedSheets.isSheetLocked(i)}();g.bind(this)(o,s["Import.WarningLabel.LockMsg1"]),O.bind(this)(!o),D.bind(this)(!1);break;case"replaceData":var n=t.view.getActiveGridID(),l=t.view.getResourceID(n),c=t.view.getSheetID(n),d=t.view.getVersionID(n),h=t.data.getWorkBook(l,d).getSheetObj(c).Prop.getName(),u=t.view.getActiveState(n).getSheetState(c).getActiveCellRange(),p=u.getLabel(),m=this.DOM.container.querySelector("#startCell");a.startCellEditor.value=h+"."+p,m.focus(),D.bind(this)(!0);o=function(e){var r=t.view.getActiveGridID(),s=t.view.getSheetID(r),o=t.view.getSheetState(r,s),n=t.view.getResourceID(r),l=(t.data.Defaults,o.getActiveRange(),t.view.getVersionID(r)),a=t.data.getWorkBook(n,l);if(a.ProtectedSheets.isSheetLocked(s))return!0;var c=new i.Range(e.startRow,e.startCol,t.data.Defaults.MAX_ROW-1,t.data.Defaults.MAX_COL-1);return a.getSheetObj(s).ProtectedRanges.isIntersecting(c)}(u);g.bind(this)(o,s["Import.WarningLabel.LockMsg1"]),O.bind(this)(!o);break;case"replaceSpreadsheet":o=function(){for(var e=t.view.getActiveGridID(),i=(t.view.getSheetID(e),t.view.getResourceID(e)),r=t.view.getVersionID(e),s=t.data.getWorkBook(i,r),o=!1,n=Object.keys(s.ProtectedSheets).length>0,l=0;l<s.SheetList.length;l++)if(!s.getSheetObj(s.SheetList[l].Id).ProtectedRanges.isEmpty()){o=!0;break}return o||n}();g.bind(this)(o,s["Import.WarningLabel.LockMsg2"]),O.bind(this)(!o),D.bind(this)(!1);break;default:D.bind(this)(!1),g.bind(this)(!1),O.bind(this)(!0)}}function w(e){var t="";void 0!=e&&(t=(e=e.split("\\").pop()).split(".").pop()),"csv"==(t=t.toLowerCase())||"tsv"==t?I.bind(this)(!0,!1,t):I.bind(this)(!1),this.format=t}function I(e,t,i){if(e&&l)this.DOM.container.querySelector("#replaceCurrSheet").disabled=!1,this.DOM.container.querySelector("#appendRows").disabled=!1,this.DOM.container.querySelector("#replaceData").disabled=!1,this.isURLImport?(this.DOM.delimiterContainer2.style.display="","tsv"==i?n.zcombo(this.DOM.delimiter2,"setValue","Tab"):n.zcombo(this.DOM.delimiter2,"setValue","Comma")):(this.DOM.delimiterContainer1.style.display="","tsv"==i?n.zcombo(this.DOM.delimiter1,"setValue","Tab"):n.zcombo(this.DOM.delimiter1,"setValue","Comma")),q.bind(this)(this.DOM.container.querySelector("#replaceData")),S.bind(this)(!1);else{if(this.DOM.container.querySelector("#replaceCurrSheet").disabled=!0,this.DOM.container.querySelector("#appendRows").disabled=!0,this.DOM.container.querySelector("#replaceData").disabled=!0,this.DOM.delimiterContainer1.style.display="",this.DOM.delimiterContainer2.style.display="",t)this.DOM.container.querySelector("#createNew").checked=!0,S.bind(this)(!0),D.bind(this)(!1);c.bind(this)()}}i.ImportDialog=a}(this);
!function(e){var t,o,r,n,a,c,i,l,u,m,d,s,f,C,p,g,b,E,S,v,T=e.sPlusPlus,A=e.document,I=e.UIUtil.Component,y=(e.ZSConstants.JSKeyCode,e.UserAction),R=e.JSUtil,L=e.ZSConstants,F=L.FeatureConstants,N=L.CommandConstants,h=L.I18N,O=L.wCC,M=e.ZSEvents,z=M.topic,U=M.Groups,x=M.Names,P=!1,_=T.view.Toolbar.Feature[F.FORMATCELLS],q={buttons:[{text:h.OK,primary:!0}]};function V(n,c){l=T.view.getActiveGridID(),u=T.view.getResourceID(l),m=T.view.getVersionID(l),d=T.view.getSelectedSheets(l),s=T.view.getSheetID(l),f=T.view.getSheetState(l,s),C=f.getActiveRow(),p=f.getActiveCol(),a=c,o||function(){var n=y.getTemplate(["FORMAT_CELLS"]);r=n.FORMAT_CELLS,g=r.querySelector("#formatPreview"),b=r.querySelector("#codePreview"),E=r.querySelector("#customFrmtCombo"),S=r.querySelector("#customFrmtInput");var a={width:560,dialogClass:"fmcell",title:h.FormatCells,open:w,close:Z};(function(){if(!T.data.AppRegistry.localeInfo)return void e.ZSDevTools.LoggerLogger.log("Locale Info Empty. Please chcek API call response");for(var t=T.data.AppRegistry.localeInfo.CURRENCY_MAP,o=T.data.AppRegistry.localeInfo.CURRENCY_LIST_WITH_UNIQUES,n=T.data.AppRegistry.localeInfo.POPULAR_CURRENCY_LIST,a=r.querySelector("#popularCurr"),c=r.querySelector("#currList"),i=r.querySelector("#popularCurrAcc"),l=r.querySelector("#currListAcc"),u=0;u<n.length;u++){var m=t[n[u]],d=A.createElement("option"),s=m.KEY.substring(m.KEY.indexOf("(")+1,m.KEY.length-1);d.value=s,d.innerText=m.CURRENCY+" "+m.CURRENCY_NAME,a.appendChild(d),i.appendChild(d.cloneNode(!0))}for(var u=0;u<o.length;u++){var f=o[u];X[f]=t[f].COUNTRY;var d=A.createElement("option");d.value=f.substring(f.indexOf("(")+1,f.length-1),d.innerText=t[f].CURRENCY+" "+t[f].CURRENCY_NAME,c.appendChild(d),l.appendChild(d.cloneNode(!0))}})(),function(){if(!T.data.AppRegistry.localeInfo)return void e.ZSDevTools.Logger.log("Locale Info Empty. Please chcek API call response");for(var t=r.querySelector("#regionalFrmtCountryCombo"),o=T.data.AppRegistry.localeInfo.REGIONAL_LIST,n=T.data.AppRegistry.localeInfo.CURRENCY_MAP,a=0;a<o.length;a++){var c=A.createElement("option");c.value=o[a],c.innerText=n[o[a]].COUNTRY,t.appendChild(c)}}(),c={formatType:"DATETIME",format:"M/d/yy HH:mmk",language:i,frmtAction:"generate"},l={formatType:"CURRENCY",negFrmt:"0",thousandsep:"true",decimals:"2",leadingzeroes:"1",language:i,symbol:i,frmtAction:"generate"},y.FORMATCELLS_CLIENT(u,d,m,c,me),y.FORMATCELLS_CLIENT(u,d,m,{formatType:"REGIONAL",format:"undefined",language:"en(US)",frmtAction:"generate"},ue),y.FORMATCELLS_CLIENT(u,d,m,l,de),(t=A.createElement("div")).id=O.DI+F.FORMATCELLS+O.IDENTITY,t.appendChild(r),o=new e.ZSClass.Dialog(t,a),function(){for(var e=t.querySelectorAll("#tabList li"),o=0;o<e.length;o++)e[o].addEventListener("click",W.bind(e[o]));I.bind("#negativeFormatNumbers","zselectboxchange",ae.float),I.bind("#decimalPlacesNumber","znumberfieldchange",ae.float),I.bind("#decimalPlacesNumber","znumberfieldspinend",ae.float),I.bind("#leadingZeroNumber","znumberfieldchange",ae.float),I.bind("#leadingZeroNumber","znumberfieldspinend",ae.float),t.querySelector("#thousandSeperatorNumber").addEventListener("change",ae.float),t.querySelector("#prefix").addEventListener("blur",ae.float),t.querySelector("#suffix").addEventListener("blur",ae.float),I.bind("#currencySymbol","zcomboboxchange",function(){ae.currency()}),I.bind("#negativeFormatCurrency","zselectboxchange",ae.currency),I.bind("#decimalPlacesCurrency","znumberfieldchange",ae.currency),I.bind("#decimalPlacesCurrency","znumberfieldspinend",ae.currency),I.bind("#leadingZeroCurrency","znumberfieldchange",ae.currency),I.bind("#decimalPlacesCurrency","znumberfieldspinend",ae.currency),t.querySelector("#thousandSeperatorCurrency").addEventListener("change",ae.currency),I.bind("#currencySymbolAcc","zcomboboxchange",function(){ae.accounting(),!0}),I.bind("#decimalPlacesCurrencyAcc","znumberfieldchange",ae.accounting),I.bind("#decimalPlacesCurrencyAcc","znumberfieldspinend",ae.accounting),I.bind("#leadingZeroCurrencyAcc","znumberfieldchange",ae.accounting),I.bind("#decimalPlacesCurrencyAcc","znumberfieldspinend",ae.accounting),t.querySelector("#thousandSeperatorCurrencyAcc").addEventListener("change",ae.accounting),I.bind("#dateFormatCombo","zselectboxchange",ae.datetime),I.bind("#timeFormatCombo","zselectboxchange",ae.datetime),I.bind("#durationFormatCombo","zselectboxchange",ae.duration),I.bind("#percentageFormatSpinner","znumberfieldchange",ae.percentage),I.bind("#percentageFormatSpinner","znumberfieldspinend",ae.percentage),function(){t.querySelector("#fractionFormatCombo");I.bind("#fractionFormatCombo","zselectboxchange",ae.fraction)}(),I.bind("#scientificFormatSpinner","znumberfieldchange",ae.scientific),I.bind("#scientificFormatSpinner","znumberfieldspinend",ae.scientific),t.querySelector("#regionalFrmtCombo").addEventListener("change",ae.regional),I.bind("#regionalFrmtCountryCombo","zselectboxchange",function(){P=!0,ae.regional()}),I.bind("#regionalFrmtCombo","zselectboxchange",function(){ae.regional()}),S.addEventListener("focus",function(){}),S.addEventListener("keydown",function(e){var t=e.which;13==t&&(k(),H(),e.stopPropagation())}),E.addEventListener("change",function(){var e=this.value,t={formatType:"CUSTOM",frmtAction:"generate"};t.format=encodeURIComponent(e),y.FORMATCELLS_CLIENT(u,d,m,t,function(e){le(e.format.preview,e.format.formatcode,e.format.color)})}),t.querySelector("#okBtn").addEventListener("click",k),t.querySelector("#cancelBtn").addEventListener("click",H),t.querySelector("#manageFrmt").addEventListener("click",G)}(),e.dialogWrapper=t,e.dialogObject=o;var c,l}(),o.open()}function D(){var e={formatType:"CUSTOM"};return-1==E.selectedIndex||S.value?(e.frmtAction="saveAndApplyCustomFormats",e.format=encodeURIComponent(S.value)):(e.frmtAction="submit",e.format=encodeURIComponent(E.value)),e}function G(){z.publish(U.UI,x.Toolbar.FORMAT.OPEN_MANAGEFORMAT,{RID:u,SHEETLIST:d,VERSION:m})}function k(){switch(n.getAttribute("name")){case"general":_.GENERAL(u,d,m);break;case"float":var e=I.zcombo("#negativeFormatNumbers","getValue"),r=t.querySelector("#thousandSeperatorNumber").checked,a=I.zspinner("#decimalPlacesNumber","getValue"),c=I.zspinner("#leadingZeroNumber","getValue"),l=i,s=t.querySelector("#prefix").value,f=t.querySelector("#suffix").value;if(s.includes('"')||f.includes('"'))return void ZSClass.ZSAlert(h["Alert.Format.QuotesNotAllowed"],q);s=s&&s.length>0?encodeURIComponent(s):void 0,f=f&&f.length>0?encodeURIComponent(f):void 0,_.FLOAT(u,d,m,e,r,a,c,l,s,f);break;case"currency":y.FORMATCELLS_GRID(u,d,m,null,null,se());break;case"accounting":y.FORMATCELLS_GRID(u,d,m,null,null,fe());break;case"datetime":ce()?y.FORMATCELLS_GRID(u,d,m,null,null,Ce()):ZSClass.ZSAlert("both can't be none");break;case"duration":y.FORMATCELLS_GRID(u,d,m,null,null,pe());break;case"percentage":var C=I.zspinner("#percentageFormatSpinner","getValue");_.PERCENTAGE(u,d,m,C,i);break;case"fraction":var p=t.querySelector("#fractionFormatCombo").value;_.FRACTION(u,d,m,p);break;case"scientific":C=I.zspinner("#scientificFormatSpinner","getValue");_.SCIENTIFIC(u,d,m,C,i);break;case"text":_.TEXT(u,d,m);break;case"regional":var g=I.zcombo("#regionalFrmtCountryCombo","getValue"),b=t.querySelector("#regionalFrmtCombo").value;_.REGIONAL(u,d,m,g,b);break;case"custom":-1==E.selectedIndex?y.FORMATCELLS_CLIENT(u,d,m,D(),function(e){"FormatSupported"==e.cusFrmtStatus?y.FORMATCELLS_GRID(u,d,m,null,null,D()):ZSClass.ZSAlert("Invalid format")}):y.FORMATCELLS_GRID(u,d,m,null,null,D())}o.close()}function w(){S.value="",setTimeout(j,500),z.register(U.Listener,x.SheetAction.ACTIVE_CELL.INFO,Y)}function Z(){z.unregister(U.Listener,x.SheetAction.ACTIVE_CELL.INFO,Y)}function Y(){var e=n.getAttribute("name");ae[e]()}function H(){o.close()}function K(){var e;B(),J(),$(),ee(),te(),I.zspinner("#percentageFormatSpinner","setValue",void 0!=e?e:2),oe(),re(),ne()}function j(){K();var o="general";if(a){var r=t.querySelector("#tabList [name='"+a+"']");W.call(r)}else{T.view.fetchCellData(u,s,m,C,p,["Pattern"],l,function(r){var n=r[C][p].Pattern;if(R.Object.isEmpty(n))v=void 0;else{var a=n[N.FORMATTYPE];"date"!=(o=a.toLowerCase())&&"time"!=o||(o="datetime"),"string"==o&&(o="text"),"custom"==o&&(v=n[N.FORMATSTRING]),function(t){var o=t[N.FORMATTYPE];switch(o){case"FLOAT":B(t[N.NEGATIVEFRMT],t[N.DECIMALS],t[N.LEADINGZEROES],t[N.ISGROUPINGUSED],t[N.PREFIX],t[N.SUFFIX]);break;case"CURRENCY":var r=Q(e.decodeURIComponent(t[N.FORMATSTRING]));J(r,t[N.NEGATIVEFRMT],t[N.DECIMALS],t[N.LEADINGZEROES],t[N.ISGROUPINGUSED]);break;case"ACCOUNTING":var n=Q(e.decodeURIComponent(t[N.FORMATSTRING]));$(n,t[N.DECIMALS],t[N.LEADINGZEROES],t[N.ISGROUPINGUSED]);break;case"DATETIME":case"DATE":case"TIME":"DATETIME"==o?ee(e.decodeURIComponent(t[N.DATEFMRT].replace(/\+/g," ")),e.decodeURIComponent(t[N.TIMEFMRT].replace(/\+/g," "))):"DATE"==o?ee(e.decodeURIComponent(t[N.DATEFMRT].replace(/\+/g," ")),"none"):ee("none",e.decodeURIComponent(t[N.TIMEFMRT].replace(/\+/g," ")));break;case"DURATION":te(e.decodeURIComponent(t[N.TIMEFMRT].replace(/\+/g," ")));break;case"CUSTOM":break;case"REGIONAL":ne(t[N.LANGUAGE]+"("+t[N.COUNTRY]+")",t[N.REGIONALTYPE]);break;case"SCIENTIFIC":re(t[N.DECIMALS]);break;case"FRACTION":oe(t[N.FRACTION_DIGITS])}}(n)}var c=t.querySelector("#tabList [name='"+o+"']");W.call(c)},function(r){e.ZSDevTools.Logger.log(" couldn't retrieve data from cell  ",r);var n=t.querySelector("#tabList [name='"+o+"']");W.call(n)})}}function Q(e){var t=e.indexOf("[$"),o=e.substr(t,7);return o=o.replace("[$","").replace("-","(").concat(")")}var X={};function W(){if(n){var e=n.getAttribute("name");if(o==e)return;n.className="",t.querySelector("#"+e+"Content").style.display="none"}var o=this.getAttribute("name");"custom"===o&&(g.innerText="",b.innerText=""),this.className="active",t.querySelector("#"+o+"Content").style.display="",n=this,ae[o]()}function B(e,o,r,n,a,c){I.zcombo("#negativeFormatNumbers","setAttribute","selectedIndex",void 0!=e?e:0),I.zspinner("#decimalPlacesNumber","setValue",void 0!=o?o:2),I.zspinner("#leadingZeroNumber","setValue",void 0!=r?r:1),t.querySelector("#thousandSeperatorNumber").checked=void 0!=n&&n,t.querySelector("#suffix").value=c||"",t.querySelector("#prefix").value=a||""}function J(e,o,r,n,a){var c=void 0!=e?e:i;c=c.substring(c.indexOf("(")+1,c.length-1),I.zcombobox("#currencySymbol","setValue",c),I.zcombo("#negativeFormatCurrency","setAttribute","selectedIndex",void 0!=o?o:0),I.zspinner("#decimalPlacesCurrency","setValue",void 0!=r?r:2),I.zspinner("#leadingZeroCurrency","setValue",void 0!=n?n:1),t.querySelector("#thousandSeperatorCurrency").checked=void 0==a||a}function $(e,o,r,n){var a=void 0!=e?e:i;a=a.substring(a.indexOf("(")+1,a.length-1),I.zcombobox("#currencySymbolAcc","setValue",a),I.zspinner("#decimalPlacesCurrencyAcc","setValue",void 0!=o?o:2),I.zspinner("#leadingZeroCurrencyAcc","setValue",void 0!=r?r:1),t.querySelector("#thousandSeperatorCurrencyAcc").checked=void 0==n||n}function ee(e,t){void 0!=e?I.zcombo("#dateFormatCombo","setValue",e):I.zcombo("#dateFormatCombo","setAttribute","selectedIndex",0),void 0!=t?I.zcombo("#timeFormatCombo","setValue",t):I.zcombo("#timeFormatCombo","setAttribute","selectedIndex",0)}function te(e){void 0!=e?I.zcombo("#durationFormatCombo","setValue",e):I.zcombo("#durationFormatCombo","setAttribute","selectedIndex",0)}function oe(e){t.querySelector("#fractionFormatCombo").selectedIndex=void 0!=e?e-1:0}function re(e){UIUtil.Component.zspinner("#scientificFormatSpinner","setValue",void 0!=e?e:2)}function ne(o,r){if(T.data.AppRegistry.localeInfo){for(var n=!1,a=0;a<T.data.AppRegistry.localeInfo.REGIONAL_LIST.length;a++)o===T.data.AppRegistry.localeInfo.REGIONAL_LIST[a]&&(n=!0);void 0!=o&&n?I.zcombo("#regionalFrmtCountryCombo","setValue",o):T.data.AppRegistry.localeInfo.REGIONAL_LIST[i]?I.zcombo("#regionalFrmtCountryCombo","setValue",i):I.zcombo("#regionalFrmtCountryCombo","setAttribute","selectedIndex",0);t.querySelector("#regionalFrmtCombo");void 0!=r?I.zcombo("#regionalFrmtCombo","setValue",r):I.zcombo("#regionalFrmtCombo","setAttribute","selectedIndex",0)}else e.ZSDevTools.Logger.log("Locale Info Empty. Please chcek API call response")}var ae={};function ce(){var e=I.zcombo("#dateFormatCombo","getValue"),t=I.zcombo("#timeFormatCombo","getValue");return!("none"==e&&"none"==t)}function ie(e){var o=e.USERLEVELCUSTOMFORMATS,r=e.ISENCODED,n=e.DOCUMENTLEVELCUSTOMFORMATS,a=E.querySelector("#usrOptGrp"),c=E.querySelector("#docOptGrp"),i=t.querySelector("#noCustom");if(o&&o.length>0||n&&n.length>0){var l=!1;E.innerHTML="",a.innerHTML="",c.innerHTML="",i.style.display="none",E.style.display="block";for(var u=o.length,m=0;m<u;m++){var d=A.createElement("option"),s=r?decodeURIComponent(o[m]):o[m];d.value=s,d.textContent=r?decodeURIComponent(o[m]):o[m],decodeURIComponent(v)===s&&(d.selected=!0,ae.customPreview(o[m]),l=!0),a.appendChild(d)}for(var f=0;f<n.length;f++){d=A.createElement("option"),s=decodeURIComponent(n[f]);d.value=s,d.textContent=decodeURIComponent(n[f]),decodeURIComponent(v)===s&&(d.selected=!0,ae.customPreview(n[f]),l=!0),c.appendChild(d)}if(!l&&v){d=A.createElement("option");var C=decodeURIComponent(v);ae.customPreview(v),d.value=C,d.textContent=C,d.selected=!0,c.appendChild(d)}E.appendChild(a),E.appendChild(c)}else E.style.display="none",i.style.display="block"}function le(e,t,o,r){if(g.innerText=e,b.innerText=decodeURIComponent(t).replace(/\+/g," "),g.style.color=o||"#000",r){var n=A.querySelector(r);A.querySelector(r+"-container").style.color=n.options[n.selectedIndex].style.color}}function ue(e){var o=e.format.regional,r=Object.keys(o),n=t.querySelector("#regionalFrmtCombo");n.innerHTML="";for(var a=0;a<r.length;a++){var c=r[a],i=o[c],l=A.createElement("option");l.value=c,l.innerText=i,n.appendChild(l)}}function me(e){var o=e.format.datetimepatterns,r=o.datePatterns,n=o.timePatterns,a=o.durationPatterns,c=t.querySelector("#durationFormatCombo"),i=t.querySelector("#dateFormatCombo"),l=t.querySelector("#timeFormatCombo");c.innerHTML="",i.innerHTML="",l.innerHTML="";for(var u=0;u<a.length;u++){var m=A.createElement("option"),d=decodeURIComponent(a[u].replace(/\+/g," "));m.value=d,m.innerText=d,c.appendChild(m),I.zcombo(c,"refresh")}for(u=0;u<r.length;u++){(m=A.createElement("option")).value=r[u],m.innerText=r[u],i.appendChild(m),I.zcombo(i,"refresh")}for(u=0;u<n.length;u++){(m=A.createElement("option")).value=n[u],m.innerText=n[u],l.appendChild(m),I.zcombo(l,"refresh")}}function de(e){var o=t.querySelector("#negativeFormatCurrency").options,r=e.format;o[0].innerText=r.firstoption,o[1].innerText=r.secondoption,o[2].innerText=r.thirdoption,o[3].innerText=r.fourthoption,o[4].innerText=r.fifthoption}function se(){return{formatType:"CURRENCY",frmtAction:"generate",negFrmt:I.zcombo("#negativeFormatCurrency","getValue"),thousandsep:t.querySelector("#thousandSeperatorCurrency").checked,decimals:I.zspinner("#decimalPlacesCurrency","getValue"),leadingzeroes:I.zspinner("#leadingZeroCurrency","getValue"),language:i,symbol:I.zcombobox("#currencySymbol","getValue")}}function fe(){return{formatType:"ACCOUNTING",frmtAction:"generate",thousandsep:t.querySelector("#thousandSeperatorCurrencyAcc").checked,decimals:I.zspinner("#decimalPlacesCurrencyAcc","getValue"),leadingzeroes:I.zspinner("#leadingZeroCurrencyAcc","getValue"),language:i,symbol:I.zcombobox("#currencySymbolAcc","getValue")}}function Ce(){var e,t=I.zcombo("#dateFormatCombo","getValue"),o=I.zcombo("#timeFormatCombo","getValue"),r="";return"none"==t?(e="TIME",r=o):"none"==o?(r=t,e="DATE"):(r=t+" "+o,e="DATETIME"),{formatType:e,frmtAction:"generate",format:r,language:i}}function pe(){var e=I.zcombo("#durationFormatCombo","getValue");return{formatType:"TIME",frmtAction:"generate",format:encodeURIComponent(e)}}ae.general=function(){y.FORMATCELLS_CLIENT(u,d,m,_.GENERAL_PARAMS(),function(e){le(e.format.preview,e.format.formatcode,e.format.color)})},ae.float=function(){var e=I.zcombo("#negativeFormatNumbers","getValue"),o=t.querySelector("#thousandSeperatorNumber").checked,r=I.zspinner("#decimalPlacesNumber","getValue"),n=I.zspinner("#leadingZeroNumber","getValue"),a=i,c=t.querySelector("#prefix").value,l=t.querySelector("#suffix").value;c.includes('"')||l.includes('"')?ZSClass.ZSAlert(h["Alert.Format.QuotesNotAllowed"],q):(c=c&&c.length>0?encodeURIComponent(c):void 0,l=l&&l.length>0?encodeURIComponent(l):void 0,y.FORMATCELLS_CLIENT(u,d,m,_.FLOAT_PARAMS(e,o,r,n,a,c,l),function(e){le(e.format.preview,e.format.formatcode,e.format.color,"#negativeFormatNumbers")}))},ae.currency=function(){y.FORMATCELLS_CLIENT(u,d,m,se(),function(e){le(e.format.preview,e.format.formatcode,e.format.color,"#negativeFormatCurrency");var o=t.querySelector("#negativeFormatCurrency"),r=o.options,n=e.format;r[0].innerText=n.firstoption,r[1].innerText=n.secondoption,r[2].innerText=n.thirdoption,r[3].innerText=n.fourthoption,r[4].innerText=n.fifthoption,I.zcombo(o,"refresh")})},ae.accounting=function(){y.FORMATCELLS_CLIENT(u,d,m,fe(),function(e){le(e.format.preview,e.format.formatcode,e.format.color)})},ae.datetime=function(){ce()&&y.FORMATCELLS_CLIENT(u,d,m,Ce(),function(e){le(e.format.preview,e.format.formatcode,e.format.color)})},ae.duration=function(){y.FORMATCELLS_CLIENT(u,d,m,pe(),function(e){le(e.format.preview,e.format.formatcode,e.format.color)})},ae.percentage=function(){var e=I.zspinner("#percentageFormatSpinner","getValue");y.FORMATCELLS_CLIENT(u,d,m,_.PERCENTAGE_PARAMS(e,i),function(e){le(e.format.preview,e.format.formatcode,e.format.color)})},ae.fraction=function(){var e=t.querySelector("#fractionFormatCombo").value;y.FORMATCELLS_CLIENT(u,d,m,_.FRACTION_PARAMS(e),function(e){le(e.format.preview,e.format.formatcode,e.format.color)})},ae.scientific=function(){var e=I.zspinner("#scientificFormatSpinner","getValue");y.FORMATCELLS_CLIENT(u,d,m,_.SCIENTIFIC_PARAMS(e,i),function(e){le(e.format.preview,e.format.formatcode,e.format.color)})},ae.text=function(){y.FORMATCELLS_CLIENT(u,d,m,_.TEXT_PARAMS(),function(e){le(e.format.preview,e.format.formatcode,e.format.color)})},ae.regional=function(){var e=I.zcombo("#regionalFrmtCountryCombo","getValue"),o=t.querySelector("#regionalFrmtCombo").value;y.FORMATCELLS_CLIENT(u,d,m,_.REGIONAL_PARAMS(e,o),function(e){if(le(e.format.preview,e.format.formatcode,e.format.color),P){var o=t.querySelector("#regionalFrmtCombo"),r=e.format.regional;o.innerHTML="";for(var n=Object.keys(r),a=0;a<n.length;a++){var c=n[a],i=r[c],l=A.createElement("option");l.value=c,l.innerText=i,o.appendChild(l)}I.zcombo("#regionalFrmtCombo","refresh"),I.zcombo("#regionalFrmtCombo","setAttribute","selectedIndex",0),P=!1}})},ae.custom=function(){S.focus();y.FORMATCELLS_CLIENT(u,d,m,{formatType:"CUSTOM",frmtAction:"readCustomFormats"},ie)},ae.customPreview=function(e){var t={formatType:"CUSTOM",format:e,frmtAction:"generate"};y.FORMATCELLS_CLIENT(u,d,m,t,function(e){le(e.format.preview,e.format.formatcode,e.format.color)})},z.register(U.Listener,x.DocMeta.DOCUMENT_LOCALE,function(t,o){i=t+"("+(c=o)+")";var r=T.data.AppRegistry.localeInfo;if(r){var n=r.CURRENCY_MAP,a=r.CURRENCY_LIST_WITH_UNIQUES;for(var l in n)if(-1!=l.indexOf(c)){i=l;break}if(-1==a.indexOf(i))for(l=0;l<a.length;l++){var u=a[l];if(n[u].CURRENCY_NAME===n[i].CURRENCY_NAME){i=u;break}}}else e.ZSDevTools.Logger.log("Locale Info Empty. Please chcek API call response")},"LANGUAGE","COUNTRY"),_.openDialog=V,_.LOCALE=function(){return i},_.Callshortcut=function(){V()}}(this);
!function(t){var e,s,i,o,r,a,n,l,d=t.sPlusPlus,m=t.document,u=(t.UIUtil.Component,t.UserAction),c=(t.JSUtil,t.ZSConstants),p=c.FeatureConstants,h=(c.CommandConstants,c.I18N),C=c.wCC,F=t.ZSClass.ZSAlert,y=t.ZSEvents,v=y.topic,S=y.Groups,T=y.Names,A=d.view.Toolbar.Feature[p.FORMATCELLS],M=[],f={title:h["Alert.Title.InvalidFormatCode"]};function E(){a.appendChild(n);u.FORMATCELLS_CLIENT(i,o,r,{formatType:"CUSTOM",frmtAction:"readCustomFormats"},function(t){a.removeChild(n),a=e.querySelector("#custFormatList");var s=e.querySelector("#custFormatList"),i=t.USERLEVELCUSTOMFORMATS;if(i&&i.length>0){s.innerText="",s.removeAttribute("style");for(var o=0;o<i.length;o++){var r=new R(i[o]);M.push(r),a.appendChild(r.dom)}}else s.setAttribute("style","text-align:center;line-height: 265px"),s.innerText="0 "+h["FormatCells.CustomFormats"]})}function L(){a.innerHTML="",M=[],A.openDialog(null,"custom")}function O(){var t=l.value;if(t){var s={formatType:"CUSTOM",frmtAction:"saveCustomFormats",format:t};u.FORMATCELLS_CLIENT(i,o,r,s,function(t){if(t.CUSTOMFORMAT){var s=e.querySelector("#custFormatList");s.hasAttribute("style")&&(s.innerText="",s.removeAttribute("style"));var i=new R(t.CUSTOMFORMAT);a.appendChild(i.dom),M.push(i)}else if(t.cusFrmtStatus&&"FormatNotSupported"==t.cusFrmtStatus){var o=h["FormatCells.CustomFormat.AlertMessage"];F(o,f)}},A.UpdateCustomFormats.bind(this,M))}else{var n=h["FormatCells.CustomFormat.AlertMessage"];F(n,f)}}function N(){var t=l.value;if(t){var e={formatType:"CUSTOM",frmtAction:"saveAndApplyCustomFormats",format:t};u.FORMATCELLS_CLIENT(i,o,r,e,function(t){var a=t.cusFrmtStatus;if("FormatNotSupported"==a){var n=h["FormatCells.CustomFormat.AlertMessage"];F(n,f)}else"FormatSupported"==a&&(s.close(),u.FORMATCELLS_GRID(i,o,r,null,null,e))},A.UpdateCustomFormats.bind(this,M))}else{var a=h["FormatCells.CustomFormat.AlertMessage"];F(a,f)}}function R(t){this.value=decodeURIComponent(t),this.init()}R.prototype={init:function(){var t=u.getTemplate(["MANAGE_FORMAT_LIST"]);this.dom=m.createElement("li"),this.dom.appendChild(t.MANAGE_FORMAT_LIST),this.displayName=this.dom.querySelector("#roCustName"),this.displayName.innerText=this.value,this.viewMode=this.dom.querySelector("#viewAction"),this.input=this.dom.querySelector("#rwCustName"),this.input.value=this.value,this.input.style.display="none",this.editMode=this.dom.querySelector("#editAction"),this.editMode.style.display="none",this.bindEvents()},bindEvents:function(){this.dom.querySelector("#rwCustName").addEventListener("keydown",function(){}),this.dom.querySelector("#deleteCustFrmt").addEventListener("click",this.deleteFormat.bind(this)),this.dom.querySelector("#editCustFrmt").addEventListener("click",this.editFormat.bind(this)),this.dom.querySelector("#updateCustFrmt").addEventListener("click",this.updateFormat.bind(this)),this.dom.querySelector("#cancelCustFrmt").addEventListener("click",this.cancelEdit.bind(this))},editFormat:function(){this.viewMode.style.display="none",this.displayName.style.display="none",this.editMode.style.display="",this.input.style.display=""},deleteFormat:function(){this.dom.parentNode.removeChild(this.dom);for(var t=M.indexOf(this),s=0;s<M.length;s++)t==s&&M.splice(t,1);var a={formatType:"CUSTOM",frmtAction:"deleteCustomFormats",index:t};if(u.FORMATCELLS_CLIENT(i,o,r,a,null,A.UpdateCustomFormats.bind(this,M)),0==e.querySelector("#custFormatList").querySelectorAll("li").length){var n=e.querySelector("#custFormatList");n.setAttribute("style","text-align:center;line-height: 265px"),n.innerText="0 "+h["FormatCells.CustomFormats"]}},updateFormat:function(){var t=M.indexOf(this),e=this.input.value;if(e){var s={formatType:"CUSTOM",frmtAction:"updateCustomFormats",index:t,format:e};u.FORMATCELLS_CLIENT(i,o,r,s,function(t){if(t.cusFrmtStatus&&"FormatNotSupported"==t.cusFrmtStatus){var e=h["FormatCells.CustomFormat.AlertMessage"];F(e,f)}else this.displayName.style.display="",this.displayName.innerText=decodeURIComponent(t.CUSTOMFORMAT),this.viewMode.style.display="",this.editMode.style.display="none",this.input.style.display="none"}.bind(this),A.UpdateCustomFormats.bind(this,M))}else{var a=h["FormatCells.CustomFormat.AlertMessage"];F(a,f)}},cancelEdit:function(){this.viewMode.style.display="",this.editMode.style.display="none",this.input.style.display="none",this.displayName.style.display="",l.value=""}},v.register(S.UI,T.Toolbar.FORMAT.OPEN_MANAGEFORMAT,function(d,c,p){i=d,o=c,r=p,s||function(){(n=m.createElement("span")).className="ZsLoader";var i=u.getTemplate(["MANAGE_FORMAT"]).MANAGE_FORMAT,o={width:750,dialogClass:"fmcell",title:h.FormatCells,open:E};(e=m.createElement("div")).id=C.DI+"ManageFormat"+C.IDENTITY,e.appendChild(i),e.querySelector("#fCloseDlg").addEventListener("click",L),e.querySelector("#addBtn").addEventListener("click",O),e.querySelector("#addApplyBtn").addEventListener("click",N),l=e.querySelector("#valueInput"),a=e.querySelector("#custFormatList"),s=new t.ZSClass.Dialog(e,o)}(),s.open()},"RID","SHEETLIST","VERSION")}(this);
!function(e){var t,l,r,a,s,i=e.sPlusPlus,n=e.ZSConstants,o=n.FeatureConstants,c=n.ConditionalFormatClassicOperator,u=(n.ActionConstants,e.document),d=e.ZSConstants.wCC,h=e.ZSConstants.I18N,p=e.ZSEvents,m=p.topic,g=p.Groups,y=p.Names,v=(e.ZSConstants,i.view.Toolbar.Feature[o.CF_CLASSIC]),f=(i.SML.Client,e.UIUtil.Component),S=e.ZSClass,T=S.Editors,E=S.RangePicker,I=e.UserAction,C=u.getElementById("popupmenu"),b={},A=0,L=!1,q=!1,D=1,R={theme1:["rgb(155, 222, 180)","rgb(37, 150, 80)","false","false","none","false"],theme2:["rgb(248, 205, 207)","rgb(231, 72, 77)","false","false","none","false"],theme3:["rgb(248, 245, 203)","rgb(140, 132, 28)","false","false","none","false"],theme4:["rgb(209, 232, 251)","rgb(48, 123, 187)","false","false","none","false"],theme5:["rgb(246, 217, 186)","","false","false","none","false"],theme6:["rgb(194, 232, 230)","","false","false","none","false"],theme7:["rgb(255, 255, 255)","rgb(0, 0, 0)","true","false","none","false"],theme8:["rgb(255, 255, 255)","rgb(45, 133, 210)","true","false","none","false"],theme9:["rgb(255, 255, 255)","rgb(0, 0, 0)","false","false","none","true"],theme10:["rgb(255, 255, 255)","rgb(232, 80, 86)","false","false","none","true"],clearTheme:["transparent","transparent","false","false","none","false"]},U={DECIMAL:h["CFormat.Decimal"].toLowerCase(),WHOLENUMBER:h["CFormat.WholeNumber"].toLowerCase(),TEXT_LENGTH:h["CFormat.TextLength"].toLowerCase(),DATE:h["Filter.date"].toLowerCase(),ANY_VALUE:h.Number.toLowerCase(),TIME:h.Time.toLowerCase(),DATETIME:h.DateTime.toLowerCase()};function N(e,t){var l=i.view.getActiveGridID(),r=i.view.getResourceID(l),a=i.view.getSelectedSheets(l),s=i.view.getSheetState(l,a[0]).getActiveRange(),n=i.view.getVersionID(l);I.dataType(r,a,n,s,e,t)}function O(e,n,o,d){var p=i.view.getActiveGridID(),v=i.view.getResourceID(p),T=i.view.getSheetID(p),E=i.view.getSelectedSheets(p),C=d&&"EDIT"==d.mode?"CFormat.EditRule":"CFormat.CreateRule",R=h["CFormat.Classic"]+" - "+h[C],U={width:575,title:"Classic - "+R,dialogClass:"cfclassic",close:function(){!function(){s="",A=0,L&&m.publish(g.Listener,y.UserAction.CONDITIONAL_FORMAT.MANAGE,{isServerRequestNeed:q});L=!1,q=!1,a="",D=0,f.destroyComponent(t.querySelector(".cFDrag")),b={datarange:b.datarange},t.querySelector(".cFDrag").innerHTML="",u.querySelectorAll(".classicTheme").forEach(function(e,t){e.remove()})}()}};if(!l){var N=I.getTemplate(["classicTemplate"]).classicTemplate;(t=u.createElement("div")).id="DI_CF_CLASSIC",t.appendChild(N),l=new S.Dialog(t,U),function(e,l,a){(function(){var e=I.getTemplate(["classicSingleRule"]).classicSingleRule,t=u.createElement("div");t.id="classicRule",t.appendChild(e),t=I.renderJsTemplate(t.outerHTML,c);var l=(new DOMParser).parseFromString(t,"text/html");r=l.getElementById("classicRule").children[0]})(),B(t.querySelector("#appliestofieldcs"),"datarange"),t.querySelector("#addRule").addEventListener("click",F),t.querySelector("#classic_create").addEventListener("click",function(){P(e,l,a)}),t.querySelector("#classic_cancel").addEventListener("click",w),f.sortable(t.querySelector("#classicRule"),{axis:"y",disabled:!(D>1),cancel:"#formula"})}(v,E,i.view.getVersionID(p))}e=e||s,l.open(),l.setTitle(R),function(e,l,r,s,n,o,c){var u=new G("rule"+ ++A,s,n),d=i.view.getVersionID(r),h=(i.data.getWorkBook(e,d).getSheetObj(l),i.view.getSheetState(r,l));h.getActiveRange();b.datarange.value="",b.datarange.focus();var p=h.getRanges();S.RangePicker.setRanges(e,l,d,p),c&&o?(t.querySelector("#aR").style.display="none",a=o||void 0,setTimeout(function(){u.setValues(a)},100)):t.querySelector("#aR").style.display="block"}(v,T,p,e,n,d,o),L=o}function F(){new G("rule"+ ++A,s);D++,M()}function M(){f.sortable(t.querySelector("#classicRule"),{axis:"y",cancel:"#formula"})}function w(){l.close()}var _,k;function B(e,t){var r=new T.RangeEditor(e,!0);E.register(r);var a=e.nextElementSibling;S.RangePicker.Dialog.register(r,l,a,h["Chart.Range.select"]),b[t]=r}function x(e,t,l){var r=[];return l.replace(/,/g,";").split(";").forEach(function(l){var a=JSUtil.Range.parseRange(e,t,l);if(void 0!=a)r.push(a.range);else if(l&&l.length>0)throw"Error in range"}),r}function V(e,t){var l=e.valinp.errorMsg,r=h[""+l];-1===l.indexOf("DataVal.InputError")||t.cr_nu!==c.BETWEEN&&t.cr_nu!==c.NOT_BETWEEN||(r=h["DataVal.InputError2"]);var a=JSUtil.fn.replaceParams(r,new Array(U.ANY_VALUE));S.ZSAlert(a,{title:h["Alert.Title.InvalidValueType"]})}function P(e,r,a){var s=function(){var e={};e.datarange=b.datarange.value.trim().replace(/,/g,";");var r=t.querySelector(".cFDrag").children,a=r.length;e.noofrules=a;for(var s=!0,i=1;i<=a;i++){var n=r[i-1],o=n.getAttribute("id"),u=n.querySelectorAll("select"),d=f.zcombo(u[0],"getValue"),p="DATE"==d?n.querySelectorAll("#date input"):n.querySelectorAll("#cellValue input"),m=f.zcombo(u[0],"getAttribute","selectedIndex"),g="FORMULA"==d?-1:parseInt(f.zcombo(u[m+1],"getValue")),y=Y(n.querySelector(".cFFrmtWidget").querySelector("ul"),!0);e["cr_ty"+i]=d,e["cstyle"+i]=y,e["cond"+i]=g,e["cval"+i]="FORMULA"==d?encodeURIComponent(b[o].value):"DATE"==d?g<=c.NOT_EQUAL?encodeURIComponent(UIUtil.Component.zdatefield(t.querySelector("#date3"),"getValue").dateString):encodeURIComponent(UIUtil.Component.zdatefield(t.querySelector("#date1"),"getValue").dateString+";"+UIUtil.Component.zdatefield(t.querySelector("#date2"),"getValue").dateString):g<=c.NOT_EQUAL||"TEXT"==d?encodeURIComponent(p[2].value):encodeURIComponent(p[0].value+";"+p[1].value),"%3B"!=e["cval"+i]||"CELL"==d||(s=!1)}if(!s)return void S.ZSAlert(h["CFormat.FieldsBlank"],{title:h["Alert.Title.EnterValue"]});return e.asn=W(l.rID,l.version,e.datarange),e}(),i=x(e,a,b.datarange.value.trim());s&&I.CFValidation(e,r,i,a,s,"conditionalformat",z,V)}function z(e,t,l,r,s){a&&"EDIT"===a.mode&&(e.csuid=a.csuid),q=!0;var i=a&&"EDIT"==a.mode?"CONDITIONAL_FORMAT_EDIT":"CONDITIONAL_FORMAT_APPLY";I.applyConditionalFormat(e,t,l,r,s,i,w)}function W(e,t,r){var a=r.split(";"),s=JSUtil.Range.parseRange(e,t,a[0]);return s?s.sheetID:l.sheetID}function Y(e,t){var l=[],r=e.querySelector(".shCellBG").style.borderBottomColor,a=e.querySelector(".shTxtBg").style.borderBottomColor;return l.push("transparent"==r?"":r),l.push("transparent"==a?"":a),l.push(e.querySelector(".shBold").parentElement.classList.contains("active")),l.push(e.querySelector(".shItalic").parentElement.classList.contains("active")),l.push(e.querySelector(".shUndrLine").parentElement.classList.contains("active")?"single":"none"),l.push(e.querySelector(".shStrThr").parentElement.classList.contains("active")),t?l.join("~"):l}function G(e,t,l){this.id=e,this.value=t,this.type=l,this.create()}G.prototype={create:function(){this.template=r.cloneNode(!0),this.template.setAttribute("id",this.id),t.querySelector(".cFDrag").appendChild(this.template),this.appendAttributes()},appendAttributes:function(){var e=this;this.previewElem=this.template.querySelector(".cFPrv"),this.selectTags=this.template.querySelectorAll("select"),setTimeout(function(){e.doColorPickerChanges()},10),this.selectTags[0].setAttribute("id","rulesCombo"+A),this.selectTags[1].setAttribute("id","anyvalueCombo"+A),this.selectTags[2].setAttribute("id","textCombo"+A),this.selectTags[3].setAttribute("id","dateCombo"+A),this.selectTags[4].setAttribute("id","cellCombo"+A),this.bindEvents(),f.initComponent(this.template),this.selectTags.forEach(function(t,l){setTimeout(function(){f.bind(t,"zselectboxchange",function(t,r){0===l?e.setCombo(A):e.getListItems(A)})},100)}),f.zcombo(this.selectTags[0],"setValue",this.value),this.setCombo()},doColorPickerChanges:function(){["#date1","#date2","#date3"].forEach(function(l){var r={format:e.JSUtil.Range.getDateFormats(),forElement:l};f.zdatefield(t.querySelector(l),"setAttributes",r)})},bindEvents:function(){var e=this;this.template.querySelector(".cFFrmtWidget").querySelector("ul").querySelectorAll("li").forEach(function(t,l){t.addEventListener("click",function(l,r){var a=t.classList;a.contains("active")?a.remove("active"):a.add("active"),e.changePreview(e.previewElem)})}),this.template.querySelector(".shClear").addEventListener("click",function(){e.loadThemeInDialog(R.clearTheme)}),this.template.querySelectorAll(".cP1").forEach(function(t,l){t.setAttribute("data",'{"pickerOptions":{"noColorButton":false, "defaultColorButton":false}, "value":"#000000"}'),t.setAttribute("data-ctype","zcolorchooser"),t.setAttribute("data-picker-id","sheet-colorpicker"),f.bind(t,"zcolorchooserchange",function(l,r){t.style.borderBottom="3px solid "+r.color,e.changePreview(e.previewElem)}),f.bind(t,"zcolorchooserbeforepickeropen",function(e,l){t.style.borderBottom&&t.style.borderBottom;"transparent"!=t.style.borderBottomColor&&f.zcolorchooser(t,"setValue",t.style.borderBottom)})}),this.template.querySelector(".cFClose").onclick=this.delete.bind(this),B(this.template.querySelector("#formula"),this.id),this.addThemeInPreview()},addThemeInPreview:function(){var e=this;this.classicThemeMenu=I.getTemplate(["classicQuickTheme"]).classicQuickTheme.children[0],this.classicThemeMenu.id=d.DIALOGSUBMENUITEM+o.CF_CLASSIC+d.IDENTITY+"_"+A,C.appendChild(this.classicThemeMenu),this.previewElem.setAttribute("data-menu-id",d.DIALOGSUBMENUITEM+o.CF_CLASSIC+d.IDENTITY+"_"+A),this.classicThemeMenu.querySelectorAll("li").forEach(function(t,l){t.addEventListener("click",function(l,r){var a=t.getAttribute("theme");e.loadThemeInDialog(R[a])})});var t=this.classicThemeMenu;f.bind(this.classicThemeMenu,"zmenubeforeshow",function(l,r){e.checkTheme(t)})},changePreview:function(e){var t=Y(this.template.querySelector(".cFFrmtWidget").querySelector("ul"),!0).split("~"),l="";l+="background-color:"+t[0]+";",l+="color:"+t[1]+";",l+="true"==t[2]?"font-weight:bold;":"",l+="true"==t[3]?"font-style:italic;":"","single"!=t[4]&&"true"!=t[5]||("single"==t[4]&&"false"==t[5]?l+="text-decoration:underline;":"none"==t[4]?l+="text-decoration:line-through;":l+="text-decoration:line-through underline;"),e.setAttribute("style",l)},loadThemeInDialog:function(e){this.template.querySelector(".shCellBG").style.borderBottomColor=e[0],this.template.querySelector(".shTxtBg").style.borderBottomColor=e[1],"true"==e[2]?this.template.querySelector(".shBold").parentElement.classList.add("active"):this.template.querySelector(".shBold").parentElement.classList.remove("active"),"true"==e[3]?this.template.querySelector(".shItalic").parentElement.classList.add("active"):this.template.querySelector(".shItalic").parentElement.classList.remove("active"),"single"==e[4]?this.template.querySelector(".shUndrLine").parentElement.classList.add("active"):this.template.querySelector(".shUndrLine").parentElement.classList.remove("active"),"true"==e[5]?this.template.querySelector(".shStrThr").parentElement.classList.add("active"):this.template.querySelector(".shStrThr").parentElement.classList.remove("active"),this.changePreview(this.previewElem)},checkTheme:function(e){e.querySelector(".active").classList.remove("active");var t=this.getStyle(this.previewElem),l=!1;for(var r in R)if(t.toString()==R[r].toString()){e.querySelector("[theme="+r+"]").classList.add("active"),l=!0;break}l?"block"==e.querySelector("#custom").style.display&&(R.CUSTOM=this.getStyle(e.querySelector("#custom"))):(R.CUSTOM=t,e.querySelector("#custom").style.display="block",e.querySelector("#custom").classList.add("active"),this.changePreview(e.querySelector("#custom"))),R.CUSTOM?e.querySelector("#custom").style.display="block":e.querySelector("#custom").style.display="none"},getStyle:function(e){var t=[];return t.push(e.style.backgroundColor),t.push(e.style.color),t.push("bold"==e.style.fontWeight?"true":"false"),t.push("italic"==e.style.fontStyle?"true":"false"),t.push(-1!=e.style.textDecoration.indexOf("underline")?"single":"none"),t.push(-1!=e.style.textDecoration.indexOf("line-through")?"true":"false"),t},setCombo:function(){this.valueIndex=f.zcombo(this.selectTags[0],"getAttribute","selectedIndex"),2==this.valueIndex?(this.template.querySelector("#cellValue").style.display="none",this.template.querySelector("#date").style.display="block"):(this.template.querySelector("#cellValue").style.display="block",this.template.querySelector("#date").style.display="none");var e=5!==this.valueIndex?this.valueIndex+1:void 0;this.showProperValueCombo(e)},showProperValueCombo:function(e){var t=this;this.selectTags.forEach(function(l,r){0!=r&&(r===e&&5!=e?(f.zcombo(l,"getElement").style.display="flex",t.type?(f.zcombo(l,"setValue",t.type),t.type=""):f.zcombo(l,"setAttribute","selectedIndex",0)):f.zcombo(l,"getElement").style.display="none")}),this.getListItems()},getListItems:function(){this.singleInput="2"==this.valueIndex?this.template.querySelector("#date #singleInput"):this.template.querySelector("#singleInput"),this.doubleInput="2"==this.valueIndex?this.template.querySelector("#date #doubleInput"):this.template.querySelector("#doubleInput");var e=this.selectTags[this.valueIndex+1],t=f.zcombo(e,"getValue");4===this.valueIndex||t<=c.NOT_EQUAL||t>=c.TEXT_CONTAINING&&t<=c.TEXT_ENDINGWITH?(this.singleInput.style.display="block",this.doubleInput.style.display="none",2!==this.valueIndex&&(this.singleInput.children[0].style.display=4===this.valueIndex?"none":"block",this.singleInput.children[1]&&(this.singleInput.children[1].style.display=4===this.valueIndex?"block":"none"))):t==c.BETWEEN||t==c.NOT_BETWEEN?(this.singleInput.style.display="none",this.doubleInput.style.display="block"):(this.singleInput.style.display="none",this.doubleInput.style.display="none")},setValues:function(e){switch(this.loadThemeInDialog(e.cstyle1.split("~")),b.datarange.value=e.datarange,this.type=e.cond1,this.value){case"ANY_VALUE":parseInt(this.type)<=c.NOT_EQUAL?this.singleInput.querySelector("input").value=e.cval1[0]:parseInt(this.type)!=c.BETWEEN&&parseInt(this.type)!=c.NOT_BETWEEN||(this.doubleInput.querySelectorAll("input")[0].value=e.cval1[0],this.doubleInput.querySelectorAll("input")[1].value=e.cval1[1]);break;case"DATE":parseInt(this.type)<=c.NOT_EQUAL?f.zdatefield(t.querySelector("#date3"),"setValue",e.cval1[0]):parseInt(this.type)!=c.BETWEEN&&parseInt(this.type)!=c.NOT_BETWEEN||(f.zdatefield(t.querySelector("#date1"),"setValue",e.cval1[0]),f.zdatefield(t.querySelector("#date2"),"setValue",e.cval1[1]));break;case"TEXT":this.singleInput.querySelector("input").value=e.cval1[0];break;case"FORMULA":b[this.id].value=e.cval1[0]}b.datarange&&b.datarange.Editor.focus()},delete:function(){D--,t.querySelector(".cFDrag").removeChild(this.template),M()}},v.quickAction=N,m.register(g.Listener,y.UserAction.CONDITIONAL_FORMAT.FIND_DATA_TYPE,function(e,t,l){s="number"===e?"ANY_VALUE":e.toUpperCase(),t&&"9"==t?s="TEXT":t&&"4"==t?s="FORMULA":!t||"33"!=t&&"34"!=t||(s="CELL"),O(s,t,l)},"DATA_TYPE","CR_TYPE","MANAGE_REQ"),m.register(g.Listener,y.UserAction.CONDITIONAL_FORMAT.CLASSIC,O,"value","type","isManageReq","ruleObj"),m.register(g.Listener,y.UserAction.CONDITIONAL_FORMAT.FIND_CLASSIC,N,"type","isManageReq"),e.JSUtil.CFUtils.getDateFormat=function(e){var t=new Date(e);return e?t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear():""},e.JSUtil.CFUtils.setDateFormat=function(e){var t=e.split("/");return t[2]+"-"+t[0]+"-"+t[1]},e.JSUtil.CFUtils.getRangeList=x,e.JSUtil.Range.findASN=W,e.JSUtil.Range.getDateFormats=function(){var e="yyyy",t="MM/dd/"+e;return"MDY"===k&&(t="MM"+_+"dd"+_+e),"DMY"===k&&(t="dd"+_+"MM"+_+e),"YMD"===k&&(t=e+_+"MM"+_+"dd"),t},e.JSUtil.Range.getRangesInString=function(e,t,l){var r="";return l.forEach(function(e){r+=new S.Range(e.startRow,e.startCol,e.endRow,e.endCol).getLabel()+";"}),r.substring(0,r.length-1)},m.register(g.Listener,y.DocMeta.DOCUMENT_LOCALE,function(e,t){_=e,k=t},"DATE_SEPARATOR","LOCALE_DATEFORMAT"),m.register(g.Listener,y.DocMeta.DOCUMENT_LOCALE,function(e,t){e,t},"LANGUAGE","COUNTRY")}(this);
!function(e){var t,i,o,r,n,a=e.sPlusPlus,c=e.ZSConstants.FeatureConstants,s=e.document,l=e.ZSConstants.wCC,u=e.ZSConstants.I18N,d=e.ZSConstants.JSKeyCode,v=e.ZSEvents,p=v.topic,g=v.Groups,C=v.Names,S=(a.SML.Client,e.UIUtil.Component),h=e.ZSClass,m=h.Editors,y=h.RangePicker,E=e.UserAction,f=JSUtil.fn,b=3,I=!1,T=!1,N=[],M=s.getElementById("popupmenu"),A=a.view.Toolbar.Feature[c.COLOR_SCALE],L=e.ZSConstants.ColorscaleTheme;function O(e,v){r=e;var A="EDIT"==(e=e||L.GREEN_WHITE).mode?"CFormat.EditRule":"CFormat.CreateRule",O=u["CFormat.ColorScale"]+" - "+u[A],U={width:570,title:O,dialogClass:"clScale",close:function(){!function(){I&&p.publish(g.Listener,C.UserAction.CONDITIONAL_FORMAT.MANAGE,{isServerRequestNeed:T});t="",I=!1,T=!1}()},open:function(){!function(){var e=r||L.GREEN_WHITE,i=a.view.getActiveGridID(),o=a.view.getResourceID(i),n=a.view.getSheetID(i),c=a.view.getVersionID(i),s=(a.data.getWorkBook(o,c).getSheetObj(n),a.view.getSheetState(i,n));s.getActiveRange();if(N[0].value="",N[0].focus(),e&&"EDIT"==e.mode)t=e,N[0].value=e.datarange;else{var l=s.getRanges();h.RangePicker.setRanges(o,n,c,l)}q(e)}()}};if(!o){var D=E.getTemplate(["conditonalFormatTemplate"]).conditonalFormatTemplate;(i=s.createElement("div")).id="DI_CONDTIONAL_FORMATTING",i.appendChild(D),o=new h.Dialog(i,U),function(){for(var e=E.getTemplate(["csRuleTemplate"]).csRuleTemplate,t=i.querySelectorAll(".dspTblRow .csSet"),r=1;r<=b;r++){var a=e.cloneNode(!0),d=new Z(a,r);t[r-1].appendChild(d.container)}i.querySelector("#cs_createBtn").addEventListener("click",G),i.querySelector("#cs_cancelBtn").addEventListener("click",R),i.querySelector("#colorScalePreview").setAttribute("data-menu-id",l.DIALOGSUBMENUITEM+c.COLOR_SCALE+l.IDENTITY),i.querySelector("#hideCellContent").addEventListener("change",V),i.querySelector("#autoTextColor").addEventListener("change",V("autoTextColor")),function(){var e=s.createElement("ul");e.dataItemType="submenu",e.id=l.DIALOGSUBMENUITEM+c.COLOR_SCALE+l.IDENTITY;var t=E.getTemplate(["colorscaleSubMenu"]).colorscaleSubMenu;e.appendChild(t),e.querySelector("#customDialog").remove(),M.appendChild(e),S.bind(e,"zmenubeforeshow",function(e,t){this.querySelector("#custom").style.display="none",function(e){e.querySelector(".active").classList.remove("active");var t=w(),i=!1;for(var o in L)if(JSON.stringify(t).toLowerCase()==JSON.stringify(L[o]).toLowerCase()){e.querySelector("[theme="+o+"]").classList.add("active"),i=!0;break}if(i)L.CUSTOM&&(e.querySelector("#custom").style.display="block");else{L.CUSTOM=t,e.querySelector("#custom").style.display="block";var r=2==t.noofcond?f.getGradientColor(t.cs_c1,t.cs_c2,7):f.getGradientColor(t.cs_c1,t.cs_c2,t.cs_c3,7);e.querySelector("#classicPreview").style.backgroundImage=x(r),e.querySelector("#classicPreview").classList.add("active")}}(this),function(e){if(n)return!1;e.querySelectorAll(".theme").forEach(function(e,t){e.addEventListener("mousedown",function(){var t=e.getAttribute("theme");q(L[t])})}),n=!0}(this)})}(),function(e){i.querySelectorAll(".ZsRangeIco");e.forEach(function(e,t){var r=i.querySelector(e),n=new m.RangeEditor(r,!0);y.register(n);var a=r.nextElementSibling;h.RangePicker.Dialog.register(n,o,a,u["Chart.Range.select"]),N.push(n)})}(["#appliestofieldcs","#value1","#value2","#value3"])}(),o.getKeyContext().keyDown[d.ENTER]=function(e){G()}}o.open(),o.setTitle(O),I=v}function R(){o.close()}function q(e){for(var t=e.noofcond,o=1,r=1;o<=t;o++,r++)2===t&&2==o?(S.zcolorselectbox("#input"+r,"setValue","transparent"),S.zcombo("#type"+r,"setValue","NONE"),N[r].value=U(r,"NONE"),D(r),r++):_(r),"MINIMUM"==e["cr_ty"+o]||"MAXIMUM"==e["cr_ty"+o]?D(r):_(r),N[r].value="MINIMUM"===e["cr_ty"+o]?"(Lowest value)":"MAXIMUM"===e["cr_ty"+o]?"(Highest value)":e["cval"+o],S.zcombo("#type"+r,"setValue",e["cr_ty"+o]),S.zcolorselectbox("#input"+r,"setValue",e["cs_c"+o]);e.mode&&(i.querySelector("#hideCellContent").checked=e.hcc,i.querySelector("#autoTextColor").checked=e.atc),k()}function U(e,t){var i;switch(e){case"minpoint":case 1:i="NUMBER"===t||"PERCENT"===t?"0":"FORMULA"===t?"=":"PERCENTILE"===t?"10":"(Lowest value)";break;case"midpoint":case 2:i="NONE"===t?"":"PERCENTILE"===t||"PERCENT"===t?"50":"FORMULA"===t?"=":"0";break;case"maxpoint":case 3:i="NUMBER"===t?"0":"FORMULA"===t?"=":"PERCENTILE"===t?"90":"PERCENT"===t?"100":"(Highest value)"}return i}function D(e){i.querySelector("#value"+e).classList.add("zsDisable");var t=i.querySelector("#input"+e);t.previousElementSibling.classList.add("zsDisable"),2==e&&(UIUtil.Component.zcolorselectbox(t,"disable"),P("input2","transparent")),N[e].disable()}function _(e){i.querySelector("#value"+e).classList.remove("zsDisable");var t=i.querySelector("#input"+e);t.previousElementSibling.classList.remove("zsDisable"),2==e&&UIUtil.Component.zcolorselectbox(t,"enable"),N[e].enable()}function w(){for(var e={},t=0,o=1;o<=b;o++){t++,2==o&&"NONE"===i.querySelector("#type2").value&&o++;var r=i.querySelector("#type"+o).value;e["cr_ty"+t]=r,e["cval"+t]="MAXIMUM"===r||"MINIMUM"===r?"":encodeURIComponent(N[o].value);var n=z("input"+o),a=n.substring(4,n.length-1).split(",");e["cs_c"+t]=JSUtil.fn.rgbToHex(a)}return e.noofcond=t,e.noofrules=1,e}function k(){var e=x("NONE"===S.zcombo("#type2","getValue")?f.getGradientColor(z("input1"),z("input3"),7):f.getGradientColor(z("input1"),z("input2"),z("input3"),7));i.querySelector("#colorScalePreview").style.backgroundImage=e}function x(e,t){for(var i="linear-gradient(to right, ",o=100/e.length,r=0;r<e.length;r++)i+=e[r]+" "+Math.round(o*r)+"% ,"+e[r]+" "+Math.round(o*(r+1))+"%, ";return i.substring(0,i.lastIndexOf(","))+")"}function z(e){var t=S.zcolorselectbox("#"+e,"getElement")[0];return t.querySelector("canvas")?t.querySelector("canvas").style.backgroundColor:"transparent"}function P(e,t){S.zcolorselectbox("#"+e,"setValue",t)}function F(e,t){var i=e.valinp.errorMsg,o=u[""+i];h.ZSAlert(o)}function G(){var e,r=((e=w()).istheme=!1,e.hcc=i.querySelector("#hideCellContent").checked,e.atc=i.querySelector("#autoTextColor").checked,e.datarange=N[0].value.replace(/,/g,";"),e.asn=JSUtil.Range.findASN(o.rID,o.version,e.datarange),t&&"EDIT"==t.mode&&(e.csuid=t.csuid,e.cs_type=t.cs_type),e),n=a.view.getActiveGridID(),c=a.view.getResourceID(n),s=a.view.getSelectedSheets(n),l=a.view.getVersionID(n),u=JSUtil.CFUtils.getRangeList(o.rID,o.version,N[0].value.trim());E.CFValidation(c,s,u,l,r,"colorscales",B,F)}function B(e,i,o,r,n){T=!0;var a=t&&"EDIT"==t.mode?"CONDITIONAL_FORMAT_EDIT":"COLOR_SCALES_APPLY";E.applyConditionalFormat(e,i,o,r,n,a,R)}var V=function(){i.querySelector("#hideCellContent").checked?i.querySelector("#autoTextColor").parentNode.classList.add("zsDisable"):i.querySelector("#autoTextColor").parentNode.classList.remove("zsDisable")};function Z(e,t){this.container=e,this.id=t,this.criteria=1==this.id?"minpoint":2==this.id?"midpoint":"maxpoint",this.addAttributes()}Z.prototype={addAttributes:function(){this.container.querySelector(".zsEditor").setAttribute("id","value"+this.id),this.container.querySelector(".cP").setAttribute("id","input"+this.id),this.removeOptions(),this.selectTag.setAttribute("id","type"+this.id),this.selectTag.setAttribute("action",this.criteria),this.selectTag.setAttribute("set",this.id),this.bindColorpallete()},removeOptions:function(){var e=this;this.selectTag=this.container.querySelector("select");var t=s.createElement("option");t.value="minpoint"==this.criteria?"MINIMUM":"midpoint"==this.criteria?"NONE":"MAXIMUM",t.text="midpoint"==this.criteria?"None":"Automatic";var i="midpoint"==this.criteria?4:0;this.selectTag.add(t,i),S.bind(this.selectTag,"zselectboxchange",function(t,i){e.setComboAction(i.value)})},bindColorpallete:function(){var e=this.container.querySelector(".cP");e.getAttribute("id");e.setAttribute("data",'{"pickerOptions":{"defaultColorButton":false, "noColorButton":false}}'),e.setAttribute("data-ctype","zcolorselect"),S.bind(e,"zcolorselectselect",function(e,t){setTimeout(function(){k()},10)})},setComboAction:function(e){var t=U(this.criteria,e);N[this.id].value=t,"midpoint"!==this.criteria||"rgba(0, 0, 0, 0)"!==z("input2")&&"transparent"!==z("input2")||P("input2",f.getGradientColor(z("input1"),z("input3"),3)[1]),"NONE"==e||"MINIMUM"==e||"MAXIMUM"==e?D(this.id):_(this.id),k()}},p.register(g.Listener,C.UserAction.CONDITIONAL_FORMAT.COLORSCALE,O,"ruleObj","isManageReq"),A.openDialog=O}(this);
!function(e){var t,n,o,l,i=e.sPlusPlus,c=e.ZSConstants.FeatureConstants,r=(e.ZSConstants.ConditionalFormatClassicOperator,e.ZSConstants.ActionConstants,e.document),a=e.ZSConstants.wCC,s=e.ZSConstants.I18N,u=e.ZSEvents,d=u.topic,S=u.Groups,y=u.Names,p=r.getElementById("popupmenu"),v=(i.SML.Client,e.UIUtil.Component),f=e.ZSClass,m=e.ZSConstants.IconSetConstants,g=f.Editors,C=f.RangePicker,I=e.UserAction,q=!1,h=!1,E={},T=e.ZSConstants.IconSetTheme,b=e.ZSConstants.classNameMap,A=5,N=i.view.Toolbar.Feature[c.ICON_SET];function w(e,u){var b,A,N,w=i.view.getActiveGridID(),R=i.view.getResourceID(w),L=i.view.getSheetID(w),U=i.view.getVersionID(w),B="EDIT"==(e=e||T[m.ARROWS3]).mode?"CFormat.EditRule":"CFormat.CreateRule",M=s["CFormat.IconSets"]+" - "+s[B],V={width:570,title:M,dialogClass:"icSet",close:function(){!function(e){h&&d.publish(S.Listener,y.UserAction.CONDITIONAL_FORMAT.MANAGE,{isServerRequestNeed:q});o="",h=!1,q=!1}()},open:function(){}};if(!n){var Z=I.getTemplate(["iconSetTemplate"]).iconSetTemplate;(t=r.createElement("div")).id="DI_CF_ICONSET",t.appendChild(Z),n=new f.Dialog(t,V),(b=I.getTemplate(["allIcons"]).allIcons).querySelectorAll("li").forEach(function(e){e.addEventListener("click",function(){e.querySelector("span")&&(l.classList=e.querySelector("span").classList[0]),z(k())})}),p.appendChild(b.children[0]),t.querySelectorAll(".iCSelectBox.wd50").forEach(function(e,t){e.addEventListener("click",function(){l=this.querySelector("span"),e.setAttribute("data-menu-id","iconSetIcons")})}),A=t.querySelectorAll("select"),N=t.querySelectorAll(".zsEditor"),A.forEach(function(e,t){setTimeout(function(){v.bind("#"+e.id,"zselectboxchange",function(t,n){D(e.getAttribute("action"),n.value,parseInt(e.getAttribute("set")))})},0)}),N.forEach(function(e){e.addEventListener("keyup",function(){var t=e.getAttribute("id");D("value",e.textContent,parseInt(t.substring(t.length-1,t.length)))})}),function(){var e=r.createElement("ul");e.dataItemType="submenu",e.className="icTypes",e.id=a.DIALOGSUBMENUITEM+c.ICON_SET+a.IDENTITY;var t=I.getTemplate(["iconsetTable"]).iconsetTable;t.querySelector("#ic_custom").style.display="none",e.appendChild(t),e.querySelectorAll("li").forEach(function(e){e.addEventListener("click",function(){F(T[e.getAttribute("type")])})}),v.bind(e,"menubeforeshow",function(e,t){}),p.appendChild(e)}(),["appliestofield","value1","value2","value3","value4"].forEach(function(e,o){var l=t.querySelector("#"+e),i=new g.RangeEditor(l,!0);i.addListeners(x),C.register(i);var c=l.nextElementSibling;f.RangePicker.Dialog.register(i,n,c,s["Chart.Range.select"]),E[e]=i}),t.querySelector(".iCSelectBox.wd150").setAttribute("data-menu-id",a.DIALOGSUBMENUITEM+c.ICON_SET+a.IDENTITY),t.querySelector("#applyIconset").addEventListener("click",function(){O()}),t.querySelector("#cancelBtn").addEventListener("click",_)}setTimeout(function(){!function(e,t,n,l){i.data.getWorkBook(e,n).getSheetObj(t);var c=i.view.getSheetState(i.view.getActiveGridID(),t);c.getActiveRange();if(E.appliestofield.value="",E.appliestofield.focus(),"EDIT"==l.mode)o=l,E.appliestofield.value=l.datarange;else{var r=c.getRanges();f.RangePicker.setRanges(e,t,n,r)}F(l)}(R,L,U,e)},0),n.open(),n.setTitle(M),h=u}function _(){n.close()}function D(e,n,o){var l=t.querySelector("#set"+(o+1)).querySelector(".flt_left.mr5.mt5"),i=t.querySelectorAll(".iCSelectBox.wd150 .mr5").length;switch(e){case"symbol":c=("gt"==n?"> ":">= ")+E["value"+o].value;break;case"value":var c="Formula";if("FORMULA"!=n)if(B(n=E["value"+o].value)){parseInt(n);n.length>=9?(c=n.substring(0,6)+"...",l.setAttribute("title",n)):(c=n,l.removeAttribute("title"))}c=("gt"==v.zcombo("#cd"+o,"getValue")?"> ":">= ")+c}c+=i==o+1?"":" and",l.innerText=c}function O(){var e=function(){var e=k();e.istheme=!1,e.hcc=t.querySelector("#hdCellConten").checked,e.rio=t.querySelector("#RvIconOrder").checked,e.dis=t.querySelector("#kpDfltSize").checked,e.noofrules=1,e.datarange=E.appliestofield.value.replace(/,/g,";"),e.asn=JSUtil.Range.findASN(n.rID,n.version,e.datarange),e.iconSetName=L(e),o&&"EDIT"==o.mode&&(e.csuid=o.csuid,e.cs_type=o.cs_type);return e}(),l=i.view.getActiveGridID(),c=i.view.getResourceID(l),r=i.view.getSelectedSheets(l),a=i.view.getVersionID(l),s=JSUtil.CFUtils.getRangeList(n.rID,n.version,E.appliestofield.value.trim());I.CFValidation(c,r,s,a,e,"iconset",R)}function R(e,t,n,l,i){q=!0;var c=o&&"EDIT"==o.mode?"CONDITIONAL_FORMAT_EDIT":"ICON_SET_APPLY";I.applyConditionalFormat(e,t,n,l,i,c,_)}function k(){for(var e={},n=t.querySelectorAll(".iCSelectBox.wd150 .mr5").length,o=n,l=n;l>=1;l--){if("table-row"===t.querySelector("#set"+l).style.display){1!=o&&(e["cr_ty"+o]=v.zcombo("#valueTypes"+(l-1),"getValue"),e["cval"+o]=E["value"+(l-1)].value,e["is_c"+o]=v.zcombo("#cd"+(l-1),"getValue"));var i=t.querySelector("#set"+l).querySelector(".iCSelectBox.wd50 span").className.replace("iS-","");e["icon_name"+o]=-1===i.indexOf("noiconC")?i.slice(0,-1):"None",e["icon_id"+o]="noiconC"!==i?i.slice(-1):-1}o--}return e.noofcond=n,e}function L(e){for(var t in T){var n=t,o=T[t];if(e.noofcond===o.noofcond){var l=!0;for(t=1;t<=e.noofcond;t++)e["icon_id"+t]==o["icon_id"+t]&&e["icon_name"+t]==o["icon_name"+t]||(l=!1);if(l)return n}}return"custom"}var x={keydown:function(e){13===(e.keyCode||e.which)&&(e.preventDefault(),O())}};function F(e){t.querySelectorAll(".iCSelectBox.wd150 .mr5").length;for(var n=e.noofcond?e.noofcond:Object.keys(e).length/5,o=n,l=1;l<=A;l++)if(n<l)t.querySelector("#set"+l).style.display="none";else{if(0!==n||e.mode){if(t.querySelector("#set"+l).style.display="table-row",v.zcombo("#cd"+l,"setValue",e["is_c"+(l+1)]?e["is_c"+(l+1)]:"gteq"),E["value"+l]&&(E["value"+l].value=e["cval"+(l+1)]||""),v.zcombo("#valueTypes"+l,"setValue",e["cr_ty"+(l+1)]),l>1){var i=l-1,c="gt"==v.zcombo("#cd"+i,"getValue")?">":">=",r=E["value"+i].value,a=B(r),s="FORMULA"!==v.zcombo("#valueTypes"+i,"getValue")&&a?r:"Formula",u=c+" "+s;t.querySelector("#set"+l).querySelector(".flt_left.mr5.mt5").innerText=l!==n?u+" and ":u+""}if(t.querySelector("#cd"+l))if(l===n)v.zcombo("#cd"+l,"getElement").style.display="none",t.querySelector("#inputVal"+l).style.display="none",v.zcombo("#valueTypes"+l,"getElement").style.display="none";else t.querySelector("#inputVal"+l).style.display="",v.zcombo("#cd"+l,"getElement").style.display="flex",v.zcombo("#valueTypes"+l,"getElement").style.display="flex"}var d=U(e["icon_name"+o],e["icon_id"+o]);t.querySelector("#set"+o).querySelector(".iCSelectBox.wd50 span").className="iS-None"!==d?U(e["icon_name"+o],e["icon_id"+o]):"noiconC",o--}t.querySelector("#RvIconOrder").checked=e.rio,t.querySelector("#hdCellConten").checked=e.hcc,t.querySelector("#kpDfltSize").checked=e.dis,z(e)}function U(e,t){return-1==t?"iS-None":b[e+t]?b[e+t]:"iS-"+e+t}function z(e){var n=L(e),o=t.querySelector(".iCSelectBox.wd150");if("custom"!=n){o.querySelector("#custom").style.display="none",o.querySelector("#iconsSpans").style.display="block";for(var l=o.querySelector("#iconsSpans").children,i=1;i<=A;i++){var c=l[i-1];"table-row"===t.querySelector("#set"+i).style.display?c.className=t.querySelector("#set"+i).querySelector(".iCSelectBox.wd50 span").className+" mr5":c.className=""}}else o.querySelector("#custom").style.display="block",o.querySelector("#iconsSpans").style.display="none"}function B(e){var t=new RegExp("^[-]?[0-9]*[.][0-9]*$"),n=new RegExp("^[-]?[0-9]*$");return!(!t.test(e)&&!n.test(e))}d.register(S.Listener,y.UserAction.CONDITIONAL_FORMAT.ICONSET,w,"ruleObj","isManageReq"),e.JSUtil.CFUtils.getIconClassName=U,e.JSUtil.CFUtils.isNumber=B,N.openDialog=w}(this);
!function(e){var t,a,r,i,n,o,s,c,l=e.sPlusPlus,d=e.ZSConstants,u=d.FeatureConstants,C=(d.ActionConstants,d.ConditionalFormatClassicOperator),h=e.document,m=(e.ZSConstants.wCC,e.ZSConstants.I18N),g=e.ZSEvents,E=g.Groups,p=g.Names,T=g.topic,A=(l.SML.Client,e.UIUtil.Component),b=e.ZSClass,O=b.Editors,v=b.RangePicker,N=e.UserAction,y=JSUtil.fn,f=h.getElementById("popupmenu"),_=l.view.Toolbar.Feature[u.CF_MANAGE],S={range:"CONDITIONAL_FORMAT_READ_RANGE",sheet:"CONDITIONAL_FORMAT_READ_SHEET",workbook:"CONDITIONAL_FORMAT_READ_WORKBOOK"},F={iconset:"i_s",colorscale:"c_s",classic:"c_f"},L={};function I(e){var d=l.view.getActiveGridID(),u=l.view.getVersionID(d),C=l.view.getResourceID(d),g={width:545,title:m["CFormat.Dialog.ManageRules"],dialogClass:"cfmanage"};if(!a){var E=N.getTemplate(["cf_manage"]).cf_manage;(t=h.createElement("div")).id="DI_CF_MANAGE",t.appendChild(E),a=new b.Dialog(t,g),function(e){A.initComponent(t),i=t.querySelector("#manage_container");var d=t.querySelector("#cf_range");r=new O.RangeEditor(d,!0),v.register(r,!0),t.querySelectorAll("#selRule").forEach(function(a,n){A.bind(a,"zselectboxchange",function(a,n){!function(e,a,n){if(i.innerHTML="",a==S.range){t.querySelector("#cf_range").parentNode.style.display="block";var o=l.view.getActiveGridID(),s=l.view.getSheetID(o),c=l.view.getSheetState(o,s);r.value=c.getActiveRange().getLabel(),r.focus()}else t.querySelector("#cf_range").parentNode.style.display="none";w(a,n)}(0,n.value,e)})}),t.querySelectorAll("#filterRule").forEach(function(e,t){A.bind(e,"zselectboxchange",function(e,t){!function(e){for(var t=i.children,a=0;a<t.length;a++)"all"!=e&&e==t[a].getAttribute("type")?t[a].style.display="block":t[a].style.display="all"==e?"block":"none"}(t.value)})}),A.sortable(i,{axis:"y",stop:function(t,a){var r=a.item[0],n=a.item.index();!function(e,t,a){var r={},n=t.getAttribute("asn");r.asn=n,r.csuid=t.getAttribute("csuid");for(var o=L[t.getAttribute("csuid")].datarange,s=i.querySelectorAll(".cFMng"),c=a-1;c>=0;c--)if(n==s[c].getAttribute("asn")){var d={};d.csuid=i.children[c].getAttribute("csuid"),r.to=d;break}var u=l.view.getActiveGridID(),C=l.view.getVersionID(u),h=l.data.getWorkBook(e,C),m=l.view.getSheetID(u),g=l.view.getSelectedSheets(u),E=h.getSheetObj(m).Prop.Name;N.reordeRules(e,m,g,C,E,r,o)}(e,r,n)}}),N.getTemplate(["cf_manage_rule"]).cf_manage_rule.children[0],n=N.getTemplate(["csToolTip"]).csToolTip.children[0],(s=h.createElement("span")).className="ZsLoader ZsLoaderSmall",(c=h.createElement("span")).innerText=m["CFormat.NoRules"],c.className="ZsNoMsg",o=N.getTemplate(["iconSetTitle"]).iconSetTitle.children[0],t.querySelector("#addNewRule").setAttribute("data-menu-id","addNewRules"),t.querySelector("#manage_close").addEventListener("click",R);var u=t.querySelector(".ZsRangeIco");b.RangePicker.Dialog.register(r,a,u,m["Chart.Range.select"]),C=!0,g={valueChanged:function(e){C&&(C=!1,setTimeout(function(){w(S.range,a.rID),C=!0},500))}},r.addListeners(g);var C,g}(C)}t.querySelector("#cf_range").parentNode.style.display="none",e&&function(e,a){var r=l.data.getWorkBook(e,a),i=r.SheetList.getSheets(!1),n=t.querySelector("#selRule"),o=l.view.getSheetID(l.view.getActiveGridID()),s=r.getSheetObj(o).Prop.Name;n.innerHTML="",n.appendChild(N.getTemplate(["selRuleOptions"]).selRuleOptions);for(var c=0,d=i.length;c<d;c++){var u=i[c].Name;if(0==i[c].isHidden){var C=h.createElement("option");C.value=u,C.innerText=u,n.appendChild(C)}}A.zcombo(n,"refresh"),A.zcombo(n,"setValue",s),w(s,e)}(C,u),a.open()}function R(){a.close()}function w(e,t){var a=l.view.getActiveGridID(),n=l.view.getSheetID(a),o=l.view.getVersionID(a),c=l.data.getWorkBook(t,o),d=c.getSheetObj(n).Prop.Name;e!=S.range&&e!=S.workbook&&(d=e,n=c.SheetList.getIdByName(d),e=S.sheet);var u=e==S.range?r.value:"";if(u){var C=JSUtil.Range.parseRange(t,o,u);d=C.sheetName,u=C.range}else u=new b.Range(-1,-1,-1,-1);var h=[n];i.innerHTML="",i.appendChild(s),N.readConditionalFormatRules(t,h,o,e,u,JSUtil.Range.getDateFormats())}function k(e,t,a,r,i){this.id=e,this.csuid=a,this.type=t,this.asn=i.sheetList[0][0],this.ruleObj=i,this.create()}function D(e,t){switch(a.close(),e){case F.colorscale:case F.iconset:var r=e==F.iconset?"ICONSET":"COLORSCALE";if(t){var i=t.cstyle1;for(var n in delete t.cstyle1,i)t[n]=i[n]}T.publish(E.Listener,p.UserAction.CONDITIONAL_FORMAT[r],{ruleObj:t,isManageReq:!0});break;case F.classic:t?T.publish(E.Listener,p.UserAction.CONDITIONAL_FORMAT.CLASSIC,{value:t?t.cr_ty1:"",type:t?t.cond1:"",ruleObj:t,isManageReq:!0}):T.publish(E.Listener,p.UserAction.CONDITIONAL_FORMAT.FIND_CLASSIC,{type:void 0,isManageReq:!0})}}function M(e,t,a){var r=parseInt(e),i="",n=t[0],o=t[1]?t[1]:"";switch(r){case C.TEXT_CONTAINING:i=m["CFormat.Condition.Contains"]+" '"+n+"'";break;case C.TEXT_NOTCONTAINING:i=m["CFormat.Condition.NotContains"]+" '"+n+"'";break;case C.TEXT_BEGINNINGWITH:i=m["CFormat.Condition.BeginsWith"]+" '"+n+"'";break;case C.TEXT_ENDINGWITH:i=m["CFormat.Condition.EndsWith"]+" '"+n+"'";break;case C.ISBLANK:i=m["CFormat.Condition.Blanks"];break;case C.ISNOTBLANK:i=m["CFormat.Condition.NoBlanks"];break;case C.ISERROR:i=m["CFormat.Condition.Errors"];break;case C.ISNOTERROR:i=m["CFormat.Condition.NoErrors"];break;case C.YESTERDAY:i=m["CFormat.Condition.Yesterday"];break;case C.TODAY:i=m["CFormat.Condition.Today"];break;case C.TOMORROW:i=m["CFormat.Condition.Tomorrow"];break;case C.LAST_7_DAYS:i=m["CFormat.Condition.Last7Days"];break;case C.NEXT_7_DAYS:i=m["CFormat.Condition.Next7Days"];break;case C.LAST_WEEK:i=m["CFormat.Condition.LastWeek"];break;case C.THIS_WEEK:i=m["CFormat.Condition.ThisWeek"];break;case C.NEXT_WEEK:i=m["CFormat.Condition.NextWeek"];break;case C.LAST_MONTH:i=m["CFormat.Condition.LastMonth"];break;case C.THIS_MONTH:i=m["CFormat.Condition.ThisMonth"];break;case C.NEXT_MONTH:i=m["CFormat.Condition.NextMonth"];break;case C.LAST_YEAR:i=m["CFormat.Condition.LastYear"];break;case C.THIS_YEAR:i=m["CFormat.Condition.ThisYear"];break;case C.NEXT_YEAR:i=m["CFormat.Condition.NextYear"];break;case C.DUPLICATE_VALUES:i=m["CFormat.Condition.Duplicate"];break;case C.UNIQUE_VALUES:i=m["CFormat.Condition.Unique"]}if(i)return i;if("WHOLENUMBER"==a||"DECIMAL"==a||"ANY_VALUE"==a||"TEXT_LENGTH"==a)switch(s=new Array(m["CFormat.AnyValue"],n,o),"WHOLENUMBER"==a?s=new Array(m["CFormat.WholeNumber"],n,o):"DECIMAL"==a?s=new Array(m["CFormat.Decimal"],n,o):"TEXT_LENGTH"==a&&(s=new Array(m["CFormat.TextLength"],n,o)),r){case C.LESS_THAN:i=y.replaceParams(m["CFormat.Condition.LessThan"],s);break;case C.GREATER_THAN:i=y.replaceParams(m["CFormat.Condition.GreaterThan"],s);break;case C.LESS_EQUAL:i=y.replaceParams(m["CFormat.Condition.LessThanOrEqual"],s);break;case C.GREATER_EQUAL:i=y.replaceParams(m["CFormat.Condition.GreaterThanOrEqual"],s);break;case C.EQUAL:i=y.replaceParams(m["CFormat.Condition.Equal"],s);break;case C.NOT_EQUAL:i=y.replaceParams(m["CFormat.Condition.NotEqual"],s);break;case C.BETWEEN:i=y.replaceParams(m["CFormat.Condition.Between"],s);break;case C.NOT_BETWEEN:i=y.replaceParams(m["CFormat.Condition.NotBetween"],s)}else if("DATE"==a){var s,c=-1;switch(r<=C.NOT_BETWEEN&&(n&&null!==n.match(/\s|:/g)&&(c=n.match(/\s|:/g).length),o&&null!==o.match(/\s|:/g)&&(c+=o.match(/\s|:/g).length)),r<=C.NOT_EQUAL?c>=2?s=new Array(m.DateTime,n):1==c?(n=y.replaceParams(m["CFormat.TimeHrs"],new Array(n)),s=new Array(m.Time,n)):s=new Array(m["Filter.date"],n):r!=C.BETWEEN&&r!=C.NOT_BETWEEN||(c>=4?s=new Array(m.DateTime,n,o):2==c?(n=y.replaceParams(m["CFormat.TimeHrs"],new Array(n)),o=y.replaceParams(m["CFormat.TimeHrs"],new Array(o)),s=new Array(m.Time,n,o)):s=new Array(m["Filter.date"],n,o)),r){case C.LESS_THAN:i=y.replaceParams(m["CFormat.Condition.DateBefore"],s);break;case C.LESS_EQUAL:i=y.replaceParams(m["CFormat.Condition.DateOnOrBefore"],s);break;case C.GREATER_THAN:i=y.replaceParams(m["CFormat.Condition.DateAfter"],s);break;case C.GREATER_EQUAL:i=y.replaceParams(m["CFormat.Condition.DateOnOrAfter"],s);break;case C.EQUAL:i=y.replaceParams(m["CFormat.Condition.DateOn"],s);break;case C.NOT_EQUAL:i=y.replaceParams(m["CFormat.Condition.DateNotOn"],s);break;case C.BETWEEN:i=y.replaceParams(m["CFormat.Condition.DateBetween"],s);break;case C.NOT_BETWEEN:i=y.replaceParams(m["CFormat.Condition.DateNotBetween"],s)}}else"LIST"===a?i=(n=n.length>55?n.substring(0,55)+"...":n).indexOf('"')>-1?y.replaceParams(m["CFormat.Condition.List"],new Array(n)):y.replaceParams(m["CFormat.Condition.Range"],new Array(n)):"FORMULA"===a&&(i=m["CFormat.Condition.Formula"]+" ="+n);return i}k.prototype={create:function(){var t=N.getTemplate(["cf_manage_rule"]).cf_manage_rule.cloneNode(!0);if(t.querySelector(".ml20").innerText=this.type==F.colorscale?"Color Scale":this.type==F.iconset?"Icon Set":"Classic",this.type!=F.iconset){var a=this.type===F.classic?function(e){var t="",a=e.split("~");t+="background-color:"+a[0]+";",t+="color:"+a[1]+";",t+="true"==a[2]?"font-weight:bold;":"",t+="true"==a[3]?"font-style:italic;":"",("true"==a[4]||"true"==a[5])&&("true"==a[4]&&"false"==a[5]?t+="text-decoration:underline;":"false"==a[4]&&"true"==a[5]?t+="text-decoration:line-through;":t+="text-decoration:line-through underline;");return t}(this.ruleObj.cstyle1):function(e){for(var t=6===Object.keys(e).length?y.getGradientColor(e.cs_c1,e.cs_c2,7):y.getGradientColor(e.cs_c1,e.cs_c2,e.cs_c3,7),a="linear-gradient(to right, ",r=0;r<7;r++)a+=t[r]+" "+Math.round(100/7*r)+"% ,"+t[r]+" "+Math.round(100/7*(r+1))+"%, ";return"background-image:"+(a=a.substring(0,a.lastIndexOf(","))+")")}(this.ruleObj.cstyle1);t.querySelector(".cFmanagePrv").setAttribute("style",a)}else this.setIconsInPreview(t.querySelector(".cFmanagePrv"),this.ruleObj);this.type===F.classic&&(t.querySelector(".cFmanagePrv").innerText="Preview");var r=this.type==F.colorscale?function(e){for(var t=e.cstyle1,a=h.createElement("div"),r=e.noofcond,i=1;i<=r;i++){var o=n.cloneNode(!0);o.children[0].innerText=1==i?"Min:":2==i&&2!=r?"Mid:":"Max:";var s="MINIMUM"===t["cr_ty"+i]||"MAXIMUM"===t["cr_ty"+i]?"Automatic":"PERCENT"===t["cr_ty"+i]?t["cval"+i]+"%":"PERCENTILE"===t["cr_ty"+i]?t["cval"+i]+" "+m["CFormat.CS.Percentile"]:t["cval"+i];o.children[1].innerText=s,a.appendChild(o)}return a.outerHTML.replace(/\"/g,"'")}(this.ruleObj):this.type==F.iconset?function(t){for(var a=function(t){for(var a={},r=t.cstyle1,i=t.noofcond,n=1;i>0;i--,n++){a.noOfCond=t.noofcond;var o=t.rio?n:i;a["icon_id"+o]=e.JSUtil.CFUtils.getIconClassName(r["icon_name"+i],r["icon_id"+i]);var s=e.JSUtil.CFUtils.isNumber(r["cval"+i]);if(a["val"+i]="FORMULA"!==r["cr_ty"+i]&&s?"PERCENTILE"===r["cr_ty"+i]?r["cval"+i]+" "+m["CFormat.CS.Percentile"]:"PERCENT"===r["cr_ty"+i]?r["cval"+i]+"%":r["cval"+i]:"Formula",i==t.noofcond)a["is_c"+i]=("gteq"===r["is_c"+i]?" >= ":" > ")+a["val"+i];else{var c="gteq"==r["is_c"+(i+1)]?" < ":"<=",l=1!=i?("gteq"==r["is_c"+i]?" >= ":" > ")+a["val"+i]:"";l=l?l+=" and ":l,a["is_c"+i]=l+c+a["val"+(i+1)]}}return a}(t),r=(t.cstyle1,h.createElement("div")),i=1,n=t.noofcond;i<=n;i++){var s=o.cloneNode(!0);s.querySelector("span").className=a["icon_id"+i],s.querySelector(".cnt").innerText=a["is_c"+i],r.appendChild(s)}return r.outerHTML.replace(/\"/g,"'")}(this.ruleObj):M(this.ruleObj.cond1,this.ruleObj.cval1,this.ruleObj.cr_ty1);r.replace(/\"/g,"'");t.querySelector(".cfInfoTooltip").setAttribute("title"," "),t.querySelector(".cfInfoTooltip").setAttribute("data-title-inner-HTML",r),t.querySelector(".flt_left").innerText=this.ruleObj.datarange,t.querySelector(".flt_left").setAttribute("title",this.ruleObj.datarange);var s=this;t.querySelector(".cFMenu").addEventListener("click",function(e){s.showEditOption(e)}),t.querySelector(".cpy").onclick=this.copy.bind(this),t.querySelector(".edt").onclick=this.edit.bind(this),t.querySelector(".del").onclick=this.delete.bind(this);var c=h.createElement("div");c.className="dspTbl",c.appendChild(t),this.rowObj=h.createElement("div"),this.rowObj.classList.add("wid","wid100","cFDrag","cFMng"),this.rowObj.appendChild(c),this.rowObj.setAttribute("id",this.id),this.rowObj.setAttribute("csuid",this.csuid),this.rowObj.setAttribute("asn",this.asn),this.rowObj.setAttribute("type",this.type),this.rowObj.onclick=this.hideEditOption.bind(this),i.onclick=this.hideEditOption.bind(this),this.rowObj.ondblclick=this.edit.bind(this)},delete:function(){var e={};e.csuid=this.csuid,e.datarange=this.ruleObj.datarange,e.asn=this.asn,e.cs_type=this.type;var t=l.view.getActiveGridID(),r=l.view.getResourceID(t),i=l.view.getVersionID(t),n=(l.data.getWorkBook(r,i),l.view.getSheetID(t)),o=JSUtil.CFUtils.getRangeList(a.rID,a.version,this.ruleObj.datarange);N.deleteConditionalFormat(r,[n],o,JSON.stringify(e),this.ruleObj.datarange,this.rowObj)},edit:function(){this.ruleObj.mode="EDIT",D(this.type,this.ruleObj)},copy:function(){this.ruleObj.mode="COPY",D(this.type,this.ruleObj)},getElement:function(){return this.rowObj},getCSUID:function(){return this.csuid},getAssociatedSheetName:function(){return this.asn},showEditOption:function(e){this.hideEditOption(),e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),this.rowObj.querySelector(".cFMenuPopUp").classList.add("edtOption")},hideEditOption:function(){var e=t.querySelector(".edtOption");e&&e.classList.remove("edtOption")},setIconsInPreview:function(e,t){for(var a=1;a<=t.noofcond;a++){var r=h.createElement("span");r.appendChild(h.createElement("span"));var i="iS-"+t.cstyle1["icon_name"+a]+t.cstyle1["icon_id"+a];r.classList.add(i,"mr5"),e.appendChild(r)}}},_.openDialog=I,e.JSUtil.CFUtils.getInfoTitle=M,T.register(E.UI,p.Layout.TEMPLATE_LOADED,function(){var e=N.getTemplate(["addRules"]).addRules,t=h.createElement("ul");t.appendChild(e),t.querySelectorAll("li").forEach(function(e,t){e.addEventListener("click",function(t,a){D(e.getAttribute("id"))})}),f.appendChild(t.children[0])}),T.register(E.Listener,p.UserAction.CONDITIONAL_FORMAT.READ_RULES,function(e){i.innerHTML="",0==e.length&&i.appendChild(c),L={};for(var t=0,a=e.length;t<a;t++){var r=e[t],n=r.csuid,o=r.asn,s=new k("rule"+t,r.cs_type,n,o,r);L[n]=r,i.appendChild(s.getElement())}},"RESPONSE"),T.register(E.Listener,p.UserAction.CONDITIONAL_FORMAT.MANAGE,I,"isServerRequestNeed")}(this);
!function(e){var t=e.sPlusPlus,n=e.document,i=e.ZSEvents,r=i.topic,s=i.Groups,o=i.Names,a=e.ZSConstants,l=(a.FeatureConstants,e.ZSClass),c=l.Editors,d=l.Editors.Utility,u=(e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),v=l.Range,E={},g=void 0,R=void 0,m=void 0,h=void 0,p=t.view.Toolbar.Feature[a.FeatureConstants.DEFINE_NAME],D={buttons:[{text:u.OK,primary:!0,click:function(){m.focus()}}],title:u["Alert.Title.InvalidDefinedName"]},A=u.CellNamecannotbeassameasZohoSheetdefinedcelllabels;function y(e){13===(e.keyCode||e.which)&&(S(),e.preventDefault())}function S(){for(var e=m.value,n=t.view.getActiveGridID(),i=t.view.getResourceID(n),r=(t.view.getSheetID(n),t.view.getVersionID(n)),s=t.data.getWorkBook(i,r).NamedRange.allNames,o=s.keys(),a=0;a<s.size;a++){if(o.next().value.toLowerCase()==e.toLowerCase())return void l.ZSAlert(u["Error.NamedExpression.Already.Exists"],{title:u["Alert.Title.DefinedNameExists"]})}if(function(e,t){if("CELL_REF"==t){var n=new RegExp("^[a-zA-Z0-9_\\u00A1-\\uFFFF!:]+$");return!n.test(e)}if("DEFINE_NAME"==t){var n=new RegExp("^[a-zA-Z0-9_\\u00A1-\\uFFFF]+$");return!n.test(e)}if("SHEET_NAME"==t){var n=new RegExp("^[a-zA-Z0-9_ \\u00A1-\\uFFFF]+$");return!n.test(e)}return!1}(e,"DEFINE_NAME")||!isNaN(e.charAt(0))||JSUtil.LinkMaker.isCellLabel(e.trim()))l.ZSAlert(A,D);else if(e.trim()&&h.value){var c=R.querySelector("#nR_container"),d=new l.UIDefinedRangeRow(e,h.value);E[e]=d;var v=t.view.getSelectedSheets(n);c.appendChild(d.getElement()),UserAction.addNamedRange(i,v,r,e,h.value),m.value="",h.value="",m.focus(),R.querySelector("#nR_addBtn").disabled=!0,c.scrollIntoView(!1)}else l.ZSAlert(u.Rangecannotbeempty,{title:u["Alert.Title.InvalidCellRange"]})}function w(){var e=this.value,t=R.querySelector("#nR_addBtn");t.disabled=!e}function f(e,t,n){var i=R.querySelector("#nR_container"),r=R.querySelector("#nR_noResult");for(var s in r.style.display="none",i.style.display="",n){var o=n[s][0],a=n[s][2],c=JSUtil.FormRange(a),d=E[o];d||(d=new l.UIDefinedRangeRow(o,c),E[o]=d,i.appendChild(d.getElement()))}}function N(e,t,n){for(var i in n){var r=n[i][0];E[r].setExpression(n[i][2])}}function I(e,t,n){for(var i in n){var r=n[i][0],s=E[r].getElement();s&&s.remove(),delete E[r]}JSUtil.Object.isEmpty(E)&&(R.querySelector("#nR_container").style.display="none",R.querySelector("#nR_noResult").style.display="")}p.openDialog=function(){var i,a;g||(i={width:580,title:u["MenuItem.InsertTab.DefineName"],dialogClass:"nRtD",close:function(){r.unregister(s.Listener,o.DocAction.NAMED_RANGE.ADD,f),r.unregister(s.Listener,o.DocAction.NAMED_RANGE.MODIFY,N),r.unregister(s.Listener,o.DocAction.NAMED_RANGE.REMOVE,I),R.querySelector("#nR_container").innerHTML=""},open:function(){m.focus(),r.register(s.Listener,o.DocAction.NAMED_RANGE.ADD,f,"RID","VERSION","NAMEDRANGE","CLIENT_ID"),r.register(s.Listener,o.DocAction.NAMED_RANGE.MODIFY,N,"RID","VERSION","NAMEDRANGE","CLIENT_ID"),r.register(s.Listener,o.DocAction.NAMED_RANGE.REMOVE,I,"RID","VERSION","NAMEDRANGE","CLIENT_ID")}},(a=e.UserAction.getTemplate(["namedRangeTemplate"]).namedRangeTemplate).querySelector("#nR_addBtn").onclick=S,a.querySelector("#cancelBtn").addEventListener("click",function(){g.close()}),(R=n.createElement("div")).id="DI_NAMEDRANGE",R.appendChild(a),g=new e.ZSClass.Dialog(R,i),function(e){var t=e.querySelector("#nR_name"),n=e.querySelector("#nR_expression");m=new c.TextAreaEditor(t,!0),h=new c.RangeEditor(n,!0),l.RangePicker.register(h,!1,!1,1);var i=n.nextElementSibling;l.RangePicker.Dialog.register(h,g,i,"Select Range"),m.addListeners({input:w,keydown:y}),h.addListeners({keydown:y})}(R)),setTimeout(function(){!function(){var e=R.querySelector("#nR_container"),i=R.querySelector("#nR_noResult"),a=function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),r=(t.view.getSheetID(e),t.view.getVersionID(e)),s=t.data.getWorkBook(i,r),o=s.NamedRange.getAllKeys(),a=n.createDocumentFragment();E={};var c=o.size;if(0!=c)for(var d=o.keys(),u=0;u<c;u++){var v=d.next(),g=v.value,R=s.NamedRange.get(g),m=JSUtil.FormRange(R),h=new l.UIDefinedRangeRow(g,m);E[g]=h,a.appendChild(h.getElement())}return a}();a.childElementCount?(i.style.display="none",e.style.display="",e.appendChild(a)):(i.style.display="",e.style.display="none");var c=t.view.getActiveGridID(),u=t.view.getResourceID(c),g=t.view.getSheetID(c),m=t.view.getVersionID(c),c=(t.data.getWorkBook(u,m).getSheetObj(g).Prop.getName(),t.view.getActiveGridID()),p=t.view.getSheetState(c,g).getActiveRange();new v(p.startRow,p.startCol,p.endRow,p.endCol),h.value="",h.focus(),r.publish(s.Listener,o.RangePicker.Update,{RID:u,SHEETID:g,VERSION:m,RANGE:p}),d.animateLabel.trigger(h)}(),m.focus()},10),g.open()}}(this),function(e){var t=e.sPlusPlus,n=e.document,i=e.ZSClass,r=i.Editors;function s(e,t){this.name=e,this.expression=t,this.create()}function o(e){var t,n=e.querySelectorAll("[name=view]"),i=e.querySelectorAll("[name=edit]");for(t=0;t<n.length;t++)n[t].style.display="none"==n[t].style.display?"":"none";for(t=0;t<i.length;t++)i[t].style.display="none"==i[t].style.display?"":"none"}s.prototype={create:function(){this.template=e.UserAction.getTemplate(["namedRangeDetailTemplate"]).namedRangeDetailTemplate,this.template.querySelector("#nR_textContent").innerText=this.expression;var t=this.template.querySelector("#nR_nameField");t.innerText=this.name,t.addEventListener("click",UserAction.Goto.bind(null,this.name)),this.rowElement=n.createElement("div"),this.rowElement.className="dspTblRow";var s=this.template.querySelector("#nR_editContent");this.editContentEditor=new r.RangeEditor(s,!0),this.editContentEditor.value=this.expression,i.RangePicker.register(this.editContentEditor,!0,!1,1);var o=this.template.querySelector("#nR_editDelete");o.querySelector("#nR_editRange").addEventListener("click",this.edit.bind(this)),o.querySelector("#nR_deleteRange").addEventListener("click",this.delete.bind(this)),o.querySelector("#nR_updateRange").addEventListener("click",this.update.bind(this)),o.querySelector("#nR_cancelEdit").addEventListener("click",this.cancel.bind(this)),this.rowElement.appendChild(this.template)},edit:function(){var e;(e=n.createElement("span")).setAttribute("class","rangeSelectOut");this.expression="string"==typeof this.expression?this.expression:JSUtil.FormRange(this.expression),this.editContentEditor.value=this.expression,o(this.rowElement),this.editContentEditor.focus()},delete:function(){var n=this.name;if(n){var i=t.view.getActiveGridID(),r=t.view.getResourceID(i),s=t.view.getVersionID(i),o=t.view.getSelectedSheets(i);e.UserAction.deleteNamedRange(r,o,s,n),this.rowElement.remove()}},update:function(){this.expression=this.editContentEditor.value,this.rowElement.querySelector("#nR_textContent").innerText=this.expression,o(this.rowElement);var e=t.view.getActiveGridID(),n=t.view.getResourceID(e),i=(t.view.getSheetID(e),t.view.getVersionID(e)),r=t.view.getSelectedSheets(e);UserAction.modifyNamedRange(n,r,i,this.name,this.expression)},cancel:function(){this.editContentEditor.value=this.expression,o(this.rowElement)},getElement:function(){return this.rowElement},setExpression:function(e){this.expression=e}},i.UIDefinedRangeRow=s}(this);
!function(e){var t,i,a,n=e.sPlusPlus,r=(e.document,e.ZSConstants),l=r.I18N,s=(r.wCC,r.FeatureConstants,r.ConditionalFormatClassicOperator),o=(r.ActionConstants,r.JSKeyCode),c=e.ZSEvents,u=e.ZSClass,d=u.Editors,h=u.RangePicker,v=c.topic,g=c.Groups,p=c.Names,E=JSUtil.fn,f=(e.JSUtil.CFUtils,e.UIUtil.Component),A={},I=!1,T={DECIMAL:l["CFormat.Decimal"].toLowerCase(),WHOLENUMBER:l["CFormat.WholeNumber"].toLowerCase(),TEXT_LENGTH:l["CFormat.TextLength"].toLowerCase(),DATE:l["Filter.date"].toLowerCase(),ANY_VALUE:l.Number.toLowerCase(),TIME:l.Time.toLowerCase(),DATETIME:l.DateTime.toLowerCase()};function D(e,r){var c,E,f,T,D={width:580,title:l["DataVal.DV"],close:function(){i.closeDialog()},open:function(){}};t||((a=document.createElement("div")).id="DI_DATA_VALIDATION",a.appendChild((f=UserAction.getTemplate(["DATA_VALIDATION"]).DATA_VALIDATION,(T=document.createElement("div")).id="dvDialog",T.appendChild(f),T=UserAction.renderJsTemplate(T.outerHTML,s),(new DOMParser).parseFromString(T,"text/html").getElementById("dvDialog"))),t=new u.Dialog(a,D),a.querySelector("#createDV").addEventListener("click",S),a.querySelector("#cancelDV").addEventListener("click",function(){t.close(),I&&v.publish(g.Listener,p.UserAction.DATA_VALIDATION.MANAGE_DIALOG,{REQ_NEED:!1})}),["#dvDataRange","#rangeList"].forEach(function(e){var i=a.querySelector(e),n=new d.RangeEditor(i,!0);"#rangeList"!=e?h.register(n,!1):h.register(n,!1,!1,1);var r=i.nextSibling;u.RangePicker.Dialog.register(n,t,r,"Select Range"),A[i.getAttribute("id")]=n}),c=!0,E={valueChanged:function(e){c&&(c=!1,setTimeout(function(){i.setRangeValue(),c=!0},500))}},A.rangeList.addListeners(E),t.getKeyContext().keyDown[o.ENTER]=function(e){}),setTimeout(function(){!function(e,t,r,l){i=new y(l);var s=a.querySelector("#dvDataRange").parentNode;if(l&&l.disable?s.classList.add("zsDisable"):s.classList.remove("zsDisable"),A.dvDataRange.value="",!l&&A.dvDataRange.focus(),l&&l.RANGENAME)A.dvDataRange.value=l.RANGENAME;else{A.dvDataRange.focus();var o=n.data.getWorkBook(e,r),c=(o.getSheetObj(t),n.view.getSheetState(n.view.getActiveGridID(),t)),d=c.getRanges();u.RangePicker.setRanges(e,t,r,d)}}(t.rID,t.sheetID,t.version,e)},0),I=r||!1,t.open()}function S(){var e=n.view.getActiveGridID(),a=n.view.getSheetID(e);a!==t.sheetID&&UserAction.SwitchSheet(t.rID,a,t.version,t.sheetID);var r,s=t.rID,o=(t.gridID,t.version),c=function(){var e={};e.cr_nu=i.condition,e.cr_ty="CELL_RANGE"==i.criteria?"LIST":i.criteria;var t=i.getHintObj();e.cv_hi={is_dis:t.is_dis,v:encodeURIComponent(t.v)},e.cv_err=i.getErrorObj(),e.cv_abc=i.container.querySelector("#ignoreBlank").checked,e.cv_ldt=i.listDisplayType(),e.val1=encodeURIComponent(i.value1),i.value2&&(e.val2=encodeURIComponent(i.value2));return e}();if(!(""==c.val1||c.val2&&""==c.val2)||"DATE"==c.cr_ty&&c.cr_nu>14&&c.cr_nu<29){for(var d=[],h=(A.dvDataRange.value.trim().replace(";",","),A.dvDataRange.value.trim().replace(/;/g,",").split(",")),v=0;v<h.length;v++){var g=JSUtil.Range.parseRange(t.rID,t.version,h[v].trim());0==v&&(r=g.sheetID),d.push(g.range)}var p=[r];c.asn=r,i.validate?UserAction.ValidateInput(s,p,o,c,d,m,b):m(s,p,o,c,d)}else u.ZSAlert(l["CFormat.FieldsBlank"],{title:l["Alert.Title.EnterValue"]})}function b(e,t){var i,a=e.valinp.errorMsg;switch(e.valinp.errorMsg){case"DataVal.MaxMinSwap":a=l["DataVal.MaxMinSwap"];break;case"DataVal.InputError":case"DataVal.InputError2":case"DataVal.InputError1":a=JSUtil.fn.replaceParams(l["DataVal.InputError2"],new Array(T[t.cr_ty])),i=l["Alert.Title.InvalidValueType"]}u.ZSAlert(a,{title:i})}function m(e,i,a,n,r){UserAction.CreateDataValidation(e,i,a,n,r,I),t.close(),I=!1}function y(e){this.dvObj=e,this.criteria=e?e.isRange?"CELL_RANGE":e.cr_ty:"DECIMAL",this.condition=e?e.cr_nu:7,this.stopMsg=l["DataVal.StopErrorMsg"],this.infoMsg=l["DataVal.InfoErrorMsg"],this.container=a,this.create()}function x(e){e.val1=e.lval1?e.lval1:e.val1,e.val2=e.lval2?e.lval2:e.val2}y.prototype={create:function(){f.zcombo("#criteriaOpn","setValue",this.criteria),this.criteriaIndex=f.zcombo("#criteriaOpn","getAttribute","selectedIndex"),this.errorElem=this.container.querySelector("#errSel"),this.hintFieldChanged=!1,this.appendAction(),this.setValueTag(),this.dvObj&&this.loadRule(this.dvObj),this.changeErrorMsg(),this.checkBoxHandling()},appendAction:function(){var e=this;this.selectTags=this.container.querySelectorAll("select"),this.selectTags.forEach(function(t,i){f.bind(t,"zselectboxchange",function(){e.changeComboValue(t,t.getAttribute("id"))})}),this.doColorPickerChanges(void 0,void 0),this.container.querySelector("#helpTxt").addEventListener("change",function(){e.container.querySelector("#helpTxt").checked?e.container.querySelector("#helpTextCombo").classList.remove("disabledCheck"):e.container.querySelector("#helpTextCombo").classList.add("disabledCheck")}),this.container.querySelector("#invalidData").addEventListener("change",function(){e.container.querySelector("#invalidData").checked?e.container.querySelector("#errSelCombo").classList.remove("disabledCheck"):e.container.querySelector("#errSelCombo").classList.add("disabledCheck")}),this.container.querySelectorAll("input").forEach(function(t,i){t.addEventListener("keyup",function(){"helpText"!==t.id&&"helpTxt"!==t.id&&e.setHintText(),"helpText"==t.id&&(e.hintFieldChanged=!0)})}),this.container.querySelector("#list").addEventListener("keyup",function(){e.setHintText()})},doColorPickerChanges:function(){var t=this;["#date1","#date2","#date3"].forEach(function(i){var a={format:e.JSUtil.Range.getDateFormats(),forElement:i};f.zdatefield(t.container.querySelector(i),"setAttributes",a),f.bind(i,"zdatefieldpickerdateselect",function(){t.setHintText()})})},changeComboValue:function(e,t){switch(t){case"criteriaOpn":this.criteria=f.zcombo(e,"getValue"),this.criteriaIndex=f.zcombo(e,"getAttribute","selectedIndex"),this.setValueTag(),this.checkBoxHandling();break;case"errSel":this.changeErrorMsg();break;default:this.showInputBox()}},changeErrorMsg:function(){var e=f.zcombo("#errSel","getValue");this.container.querySelector("#err_txt").value="STOP"==e?this.stopMsg:this.infoMsg},setValueTag:function(){this.criteriaIndex>=0&&this.criteriaIndex<=3?(this.valueTag=2==this.criteriaIndex?"textOpn":"numberOpn",this.inputId="decimalInputData"):4==this.criteriaIndex?(this.valueTag="dateOpn",this.inputId="dateInputData"):(this.valueTag="",this.inputId=5==this.criteriaIndex?"listInput":"cellRangeData"),this.showSelectTag()},getValueTag:function(){return this.criteriaIndex>=0&&this.criteriaIndex<=3?this.valueTag=2==this.criteriaIndex?"textOpn":"numberOpn":4==this.criteriaIndex&&(this.valueTag="dateOpn"),this.valueTag},showSelectTag:function(){var e=this;e.selectTags.forEach(function(t,i){0==i||4==i||t.getAttribute("id")==e.valueTag?f.zcombo(t,"getElement").style.display="flex":f.zcombo(t,"getElement").style.display="none"}),this.showInputDiv()},checkBoxHandling:function(){this.container.querySelector("#inputBoxes").style.display="LIST"===this.criteria||"CELL_RANGE"==this.criteria||"FORMULA"==this.criteria?"block":"none"},showInputDiv:function(){var e=this;this.inputContainer=this.container.querySelector("#inputContainer"),Array.from(this.inputContainer.children).forEach(function(t){t.getAttribute("id")==e.inputId?(e.inputDiv=t,t.style.display="block"):t.style.display="none"}),this.showInputBox()},showInputBox:function(e){var t=this;this.validate=!1,this.condition=this.valueTag?e||parseInt(f.zcombo("#"+this.valueTag,"getValue")):-1,this.criteriaIndex>=0&&this.criteriaIndex<=4?(this.condition===s.BETWEEN||this.condition===s.NOT_BETWEEN?(this.validate=!0,this.inputElem=this.inputDiv.querySelector("#doubleInput"),this.inputElem.style.display="block",this.inputDiv.querySelector("#singleInput").style.display="none"):this.condition>=s.YESTERDAY&&this.condition<=s.NEXT_YEAR?(this.inputDiv.querySelector("#doubleInput").style.display="none",this.inputDiv.querySelector("#singleInput").style.display="none",this.inputElem=""):(this.validate=!0,this.inputElem=this.inputDiv.querySelector("#singleInput"),this.inputElem.style.display="block",this.inputDiv.querySelector("#doubleInput").style.display="none"),this.inputElem&&this.inputElem.querySelectorAll("input").forEach(function(e){4!=t.criteriaIndex&&(e.value="")}),4!=this.criteriaIndex&&this.inputElem&&this.inputElem.querySelector("input").focus()):5==this.criteriaIndex?(this.inputElem=this.container.querySelector("#list"),this.inputElem.value="",this.inputElem.focus()):(this.inputElem=A.rangeList,this.validate=!0,A.rangeList.focus()),this.setHintText()},setHintText:function(){var e="DataVal.LIST",t=new Array("","");if(this.criteriaIndex>=0&&this.criteriaIndex<=4){e="DataVal."+this.criteria+this.condition;var i=this.inputElem?this.inputElem.querySelectorAll("input"):"";this.condition===s.BETWEEN||this.condition===s.NOT_BETWEEN?(4==this.criteriaIndex?(this.value1=f.zdatefield("#date1","getValue").dateObject?f.zdatefield("#date1","getValue").dateString+" "+i[2].value.trim():i[2].value.trim(),this.value2=f.zdatefield("#date2","getValue").dateObject?f.zdatefield("#date2","getValue").dateString+" "+i[3].value.trim():i[3].value.trim()):(this.value1=i[0].value,this.value2=i[1].value),t=new Array(this.value1,this.value2)):this.condition<=s.NOT_EQUAL?(4==this.criteriaIndex?this.value1=f.zdatefield("#date3","getValue").dateObject?f.zdatefield("#date3","getValue").dateString+" "+i[1].value.trim():i[1].value.trim():this.value1=i[0].value,t=new Array(this.value1)):(this.value1=i[0]?i[0].value:"",t=new Array(this.value1))}else 5==this.criteriaIndex?(this.value1=this.container.querySelector("#list").value+"\n",this.value1=this.value1.replace(/\n/g,"\\n").replace(/\";\"/g,"\\;")):7==this.criteriaIndex?(e="DataVal.CUSTOM",this.value1=A.rangeList.value,t=new Array(this.value1)):this.value1=A.rangeList.value;this.hintFieldChanged||(this.hintText=E.replaceParams(l[e],t),this.container.querySelector("#helpText").value=this.hintText),this.bindPickerEvent()},bindPickerEvent:function(){var e=!0,t=this,i={valueChanged:function(i){e&&(e=!1,setTimeout(function(){if(7==t.criteriaIndex){t.value1=A.rangeList.value;var i=new Array(t.value1);t.hintText=E.replaceParams(l["DataVal.CUSTOM"],i),t.container.querySelector("#helpText").value=t.hintText}e=!0},200))}};A.rangeList.addListeners(i)},setRangeValue:function(){this.value1=A.rangeList.value},loadRule:function(e){var t=this.container;if(f.zcombo("#criteriaOpn","setValue",this.criteria),this.criteriaIndex=f.zcombo("#criteriaOpn","getAttribute","selectedIndex"),this.valueTag=this.getValueTag(),f.zcombo("#dateOpn","setValue",e.cr_nu),this.showInputBox(e.cr_nu),this.criteriaIndex>=0&&this.criteriaIndex<=4){var i=this.inputElem?this.inputElem.querySelectorAll("input"):"";if(this.condition===s.BETWEEN||this.condition===s.NOT_BETWEEN)if(4==this.criteriaIndex){var a=void 0!=this.dvObj.val3?this.dvObj.val1+" "+this.dvObj.val3:this.dvObj.val1,n=void 0!=this.dvObj.val4?this.dvObj.val2+" "+this.dvObj.val4:this.dvObj.val2;a=a.split(" "),n=n.split(" "),2==a.length?(f.zdatefield("#date1","setValue",a[0]),i[2].value=a[1]||""):-1!==a[0].indexOf("/")?(f.zdatefield("#date1","setValue",a[0]),i[2].value=""):i[2].value=a[0],2==n.length?(f.zdatefield("#date2","setValue",n[0]),i[3].value=n[1]||""):-1!==n[0].indexOf("/")?(f.zdatefield("#date2","setValue",n[0]),i[3].value=""):i[3].value=n[0],this.value1=a[0],this.value2=n[0]}else this.value1=i[0].value=this.dvObj.val1,i[0].value=this.dvObj.val1,this.value2=i[1].value=this.dvObj.val2,i[1].value=this.dvObj.val2;else if(this.condition<=s.NOT_EQUAL){if(4==this.criteriaIndex)2==(a=this.dvObj.val1.split(" ")).length?(f.zdatefield("#date3","setValue",a[0]),i[1].value=a[1]||""):-1!==a[0].indexOf("/")?(f.zdatefield("#date3","setValue",a[0]),i[1].value=""):i[1].value=a[0];else this.value1=i[0].value=this.dvObj.val1}else 4!=this.criteriaIndex&&(this.value1=i[0].value=this.dvObj.val1)}else if(5==this.criteriaIndex){var r="string"==typeof e.val1?e.val1.replace(/"/g,"").split(";"):e.val1;r=e.mode?r:decodeURIComponent(r).split(","),this.inputElem.value=r.join("\n"),this.value1=this.inputElem.value.replace(/\n/g,"\\n").replace(/";"/g,"\\;")}else e.val1&&(this.value1=e.val1,A.rangeList.value=e.val1);t.querySelector("#ignoreBlank").checked=this.dvObj.cv_abc,t.querySelector("#alertText").checked=!0,t.querySelector("#helpTxt").checked=this.dvObj.cv_hi.is_dis,t.querySelector("#helpText").value="undefined"!=this.dvObj.cv_hi.v?this.dvObj.cv_hi.v:this.hintText,t.querySelector("#invalidData").checked=this.dvObj.cv_err.is_dis,t.querySelector("#err_txt").value=this.dvObj.cv_err.v,f.zcombo(this.errorElem,"setValue",this.dvObj.cv_err.msgt),this.hintFieldChanged=!0,this.setHintText(),"STOP"==this.dvObj.cv_err.msgt?this.stopMsg=this.dvObj.cv_err.v:this.infoMsg=this.dvObj.cv_err.v},getHintObj:function(){var e={};return e.is_dis=this.container.querySelector("#helpTxt").checked,e.v=e.is_dis?this.container.querySelector("#helpText").value:"undefined",e},getErrorObj:function(){var e={};return e.is_dis=this.container.querySelector("#invalidData").checked,e.v=this.container.querySelector("#err_txt").value,e.msgt=f.zcombo(this.errorElem,"getValue"),e},listDisplayType:function(){return(5==this.criteriaIndex||6==this.criteriaIndex)&&this.container.querySelector("#showList").checked?this.container.querySelector("#listAsc").checked?"SORT_ASCENDING":"UNSORTED":"NO"},closeDialog:function(){this.checkBoxHandling(),this.container.querySelector("#helpTxt").checked=!0,this.container.querySelector("#alertText").checked=!1,this.container.querySelectorAll("input").forEach(function(e){e.value=""}),["#date1","#date2","#date3"].forEach(function(e){var t={value:void 0};f.zdatefield(e,"setAttributes",t)}),A.rangeList.value=""}},v.register(g.Listener,p.UserAction.DATA_VALIDATION.DV_DIALOG,D,"DV_JSON","MANAGE_REQ"),v.register(g.Listener,p.UserAction.DATA_VALIDATION.VALIDATION,function(e){var t=A,i=n.view.getActiveGridID(),a=n.view.getResourceID(i),r=n.view.getVersionID(i);if(0!=Object.keys(e).length){var s={buttons:[{text:l.Yes,primary:!0},{text:l.No},{text:l["Dialog.Button.Cancel"]}]};if("OVERWRITE"===e.RangeValidate)s.buttons[0].click=function(){x(e),D(e)},s.buttons[2].click=function(){},s.title=l["Alert.Title.VaidationDetected"],u.ZSAlert(l["DataVal.OverwriteSelection"],s);else if("EDIT"==e.RangeValidate||"EXTEND"===e.RangeValidate)if("EDIT"==e.RangeValidate&&void 0==e.RANGENAME)D(e);else{s.buttons[0].click=function(){e.RANGENAME=e.RANGENAME?e.RANGENAME:function(e,t,i){return n.data.getWorkBook(e,i).getSheetObj(t),n.view.getSheetState(n.view.getActiveGridID(),t).getActiveRange().getLabel()}(a,n.view.getSheetID(i),r),D(e),t.dvDataRange.value=e.RANGENAME},s.buttons[1].click=function(){delete e.RANGENAME,x(e),D(e)},s.buttons[2].click=function(){};var o=e.RANGENAME?l["DataVal.ExpandSelection"]:l["DataVal.ExtendSelection"];s.title=e.RANGENAME?l["Alert.Title.ValidationDetected"]:l["Alert.Title.ExtendValidation"],u.ZSAlert(o,s)}else D(e)}else D()},"DV_JSON"),v.register(g.Listener,p.DocMeta.DOCUMENT_LOCALE,function(e,t){i&&i.doColorPickerChanges()},"LANGUAGE","COUNTRY")}(this);
!function(e){var t,n,i,r,o,a,s,l=e.sPlusPlus,c=e.document,d=e.ZSConstants,u=d.I18N,g=(d.wCC,d.FeatureConstants),v=(d.ConditionalFormatClassicOperator,d.ActionConstants,d.JSKeyCode,e.UIUtil.Component),h=e.ZSEvents,p=h.topic,A=h.Groups,S=h.Names,D=ZSClass.Editors,C=ZSClass.RangePicker,E=e.UserAction,R=(c.getElementById("popupmenu"),{readRange:"DATA_VALIDATION_READRANGE",readSheet:"DATA_VALIDATION_READSHEET",readBook:"DATA_VALIDATION_READWORKBOOK"}),m=[],b=l.view.Toolbar.Feature[g.MANAGE_DATA_VALIDATION];function y(e){var c,d,g,h=l.view.getActiveGridID(),p=l.view.getResourceID(h),A=l.view.getVersionID(h),S={width:545,title:u["DataVal.Dialog.ManageRules"],dialogClass:"dvManage",close:function(){}};if(!n){var m=E.getTemplate(["dv_manage"]).dv_manage;(i=document.createElement("div")).id="DI_DV_MANAGE",i.appendChild(m),n=new ZSClass.Dialog(i,S),v.initComponent(i),v.bind(i.querySelector("#rulesFor"),"zselectboxchange",function(e,t){f(t.value)}),i.querySelector("#dvClose").addEventListener("click",function(){n.close()}),i.querySelector("#dvCreate").addEventListener("click",function(){N()}),(a=document.createElement("span")).className="ZsLoader ZsLoaderSmall",(s=document.createElement("span")).innerText=u["CFormat.NoRules"],s.className="ZsNoMsg",c=i.querySelector("#dv_range"),o=new D.RangeEditor(c,!0),C.register(o,!0),ZSClass.RangePicker.Dialog.register(o,n,c.nextSibling,"Select Range"),d=!0,g={valueChanged:function(e){d&&(d=!1,setTimeout(function(){I(o.value),d=!0},500))}},o.addListeners(g),r=E.getTemplate(["dv_manage_rule"]).dv_manage_rule.firstElementChild,t=i.querySelector(".mngCtn")}e&&function(e,n){!function(e,t){var n=l.data.getWorkBook(e,t),r=n.SheetList.getSheets(!1),o=i.querySelector("#rulesFor"),a=l.view.getSheetID(l.view.getActiveGridID()),s=n.getSheetObj(a).Prop.Name;o.innerHTML="",o.appendChild(E.getTemplate(["dvRuleOptions"]).dvRuleOptions);for(var c=0,d=r.length;c<d;c++){var u=r[c].Name,g=document.createElement("option");g.value=u,g.innerText=u,o.appendChild(g)}v.zcombo(o,"refresh"),v.zcombo(o,"setValue",s)}(e,n);var r=l.view.getActiveGridID(),o=l.data.getWorkBook(e,n),s=l.view.getSelectedSheets(r),c=l.view.getSheetID(r),n=l.view.getVersionID(r),d=(o.getSheetObj(c).Prop.Name,R.readBook);t.innerHTML="",t.appendChild(a),E.ReadDataValidation(e,s,c,n,d,"",JSUtil.Range.getDateFormats())}(p,A),n.open()}function f(e){var t=l.view.getActiveGridID(),n=l.view.getResourceID(t),r=l.view.getSheetID(t),a=l.view.getVersionID(t);switch(e){case R.readBook:for(var s=0;s<m.length;s++)m[s].ruleContainer.style.display="block";i.querySelector("#dvSelRange").style.display="none";break;case R.readRange:o.value="",o.focus();var c=l.view.getSheetState(l.view.getActiveGridID(),r).getActiveRange().getLabel();o.value=c,I(c);break;default:for(var s in m){e===JSUtil.Range.parseRange(n,a,m[s].obj.RANGENAME.trim()).sheetName?m[s].ruleContainer.style.display="block":m[s].ruleContainer.style.display="none"}i.querySelector("#dvSelRange").style.display="none"}}function I(e){var t=n.rID,r=n.version,o=JSUtil.Range.parseRange(t,r,e);for(var a in m)for(var s=m[a].obj.RANGENAME,l=0;l<s.split(",").length;l++){var c=s.split(",")[l],d=JSUtil.Range.parseRange(t,r,c.trim()),u=new ZSClass.Range(o.range.startRow,o.range.startCol,o.range.endRow,o.range.endCol),g=new ZSClass.Range(d.range.startRow,d.range.startCol,d.range.endRow,d.range.endCol);if(u.intersects(g)&&o.sheetID===d.sheetID){m[a].ruleContainer.style.display="block";break}m[a].ruleContainer.style.display="none"}i.querySelector("#dvSelRange").style.display="block"}function w(e,t,n){this.id=e,this.obj=t,this.range=n,this.obj.RANGENAME=n,this.create()}function N(e){n.close(),p.publish(A.Listener,S.UserAction.DATA_VALIDATION.DV_DIALOG,{DV_JSON:e,MANAGE_REQ:!0})}w.prototype={create:function(){var e=r.cloneNode(!0);e.querySelector("p").innerText=this.range,e.querySelector(".txtOverflow").innerText=JSUtil.CFUtils.getInfoTitle(this.obj.cr_nu,this.obj.VALUE,this.obj.cr_ty),this.ruleContainer=c.createElement("div").appendChild(e),this.editRule()},editRule:function(){var e=this.ruleContainer;e.onclick=this.hideEditOption.bind(this),e.querySelector(".cFMenu").onclick=this.showEditOption.bind(this),e.querySelector(".cpy").onclick=this.copy.bind(this),e.querySelector(".edt").onclick=this.edit.bind(this),e.querySelector(".del").onclick=this.delete.bind(this),e.ondblclick=this.edit.bind(this),this.modifyObj()},modifyObj:function(){this.obj.val1=this.obj.VALUE[0],this.obj.val2=this.obj.VALUE[1]},copy:function(){this.obj;var e=JSON.parse(JSON.stringify(this.obj));e.mode="COPY",delete e.RANGENAME,N(e)},edit:function(){this.obj.mode="EDIT",this.obj.disable=!0,N(this.obj)},showEditOption:function(e){this.hideEditOption();var t=window.event||e;t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),this.ruleContainer.querySelector(".cFMenuPopUp").classList.add("shwEdtOpn")},hideEditOption:function(){var e=i.querySelector(".shwEdtOpn");e&&e.classList.remove("shwEdtOpn")},delete:function(){var e=l.view.getActiveGridID(),t=l.view.getResourceID(e),n=l.view.getSelectedSheets(e),i=l.view.getVersionID(e),r=[],o=this.range.split(",");for(var a in o)r.push(JSUtil.Range.parseRange(t,i,o[a].trim()).range);E.RemoveDataValidation(t,n,i,r,this.ruleContainer,s)},getRuleContainer:function(){return this.ruleContainer}},b.openDialog=y,p.register(A.Listener,S.UserAction.DATA_VALIDATION.MANAGE,function(e){var n=i.querySelector(".mngCtn");for(var r in n.innerHTML="",m=[],e)for(var o=e[r].RANGENAME.split(","),a=0;a<o.length;a++){var l=new w(r,e[r],o[a]);m.push(l),n.appendChild(l.ruleContainer)}f(v.zcombo("#rulesFor","getValue")),0==e.length&&t.appendChild(s)},"ALL_DV"),p.register(A.Listener,S.UserAction.DATA_VALIDATION.MANAGE_DIALOG,y,"REQ_NEED")}(this);
!function(e){var t,i,n,r,s,a,l=e.sPlusPlus,o=e.document,h=e.ZSEvents,c=h.topic,d=h.Groups,u=h.Names,D=(e.UIUtil.Component,o.getElementById("popupmenu"),e.ZSConstants.FeatureConstants),m=e.ZSConstants.I18N,I=(e.ZSConstants.wCC,e.ZSDevTools.Logger),p=(m=e.ZSConstants.I18N,l.view.Toolbar.Feature[D.MANAGE_LINK_EXTERNAL]);function E(){var e,o,h,c,d,u={width:850,title:m["Data.ManageExternalData"],dialogClass:"leTMCls",close:function(){i.querySelector("#manageTable").innerHTML=""}};if(!t){var D=UserAction.getTemplate(["letManage"]).letManage;(i=document.createElement("div")).id="DI_WEBDATA",i.appendChild(D),t=new ZSClass.Dialog(i,u),e=UserAction.getTemplate(["letManageRule"]).letManageRule,(a=document.createElement("div")).appendChild(e),s=i.querySelector("#manageTable"),(n=document.createElement("span")).className="ZsLoader ZsLoaderSmall",(r=document.createElement("span")).innerText=m.NoExternalDataLinkedWithDocument,r.className="ZsNoMsg"}t.open(),o=l.view.getActiveGridID(),h=l.view.getVersionID(o),c=l.view.getResourceID(o),l.data.getWorkBook(c,h).SheetList,d=l.view.getSheetID(o),s.appendChild(n),UserAction.getWebDataList(c,d,h,1)}function g(e){this.parent=i.querySelector("#manageTable"),this.ruleObj=e,this.URL=e.URL,this.startCell=e.cellName,this.interval=e.interval,this.schTime=e.schTime,this.wdCellId=e.wdCellId,this.webDataID=e.webDataId,this.fullURL=e.fullURL,this.sheetID=e.sheetId,this.create(),I.error("creation",e.webDataId)}g.prototype={create:function(){this.rowElement=a.children[0].cloneNode(!0),this.rowElement.setAttribute("id",this.webDataID);var e=this.rowElement;e.querySelector("#webURL").innerText=this.URL,e.querySelector("#webURL").setAttribute("title",this.fullURL),e.querySelector("#rangeID").innerText=this.startCell,e.querySelector("#webInterval").innerText=this.interval,e.querySelector("#nxtSch").innerText=this.schTime,this.setEditActions()},setEditActions:function(){this.rowElement.querySelector("#letEdit").onclick=this.edit.bind(this),this.rowElement.querySelector("#letEdit").style.display="none",this.rowElement.querySelector("#letRefresh").onclick=this.refresh.bind(this),this.rowElement.querySelector("#letDel").onclick=this.delete.bind(this)},edit:function(){var e=this.ruleObj;c.publish(d.Listener,u.UserAction.WEB_DATA.EDIT_DIALOG,{EV:void 0,EDIT_OBJ:e}),t.close()},sendReq:function(e){var i=t.sheetID,n=l.data.getWorkBook(t.rID,t.version).getSheetObj(i).Prop.Name,r=JSUtil.Range.parseRange(t.rID,t.version,this.startCell).sheetID,s=this.startCell.split(".")[1],a=[r];r="refresh"==e?r:this.sheetID,I.error("webDataID",this.webDataID),UserAction.refreshWebData(t.rID,a,i,n,t.version,e,r,this.webDataID,!1,s)},refresh:function(){this.sendReq("refresh"),t.close()},delete:function(){this.sendReq("delete"),this.parent.removeChild(this.rowElement),0==this.parent.children.length&&s.appendChild(r)}},p.openDialog=E,c.register(d.Listener,u.UserAction.WEB_DATA.LIST,function(e){for(var t in I.error("webListAry",e),s.innerHTML="",0==e.length&&s.appendChild(r),e){var n=new g(e[t]);i.querySelector("#manageTable").appendChild(n.rowElement)}},"LIST_ARRAY"),c.register(d.Listener,u.UserAction.WEB_DATA.MANAGE_DIALOG,E),l.view.Toolbar.transient.destructor[D.LINK_EXTERNAL_DATA]=function(){}}(this);
!function(e){var t,E=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,r=e.document,s=(e.ZSConstants.I18N,e.ZSConstants.wCC),A=(E.view.Toolbar.Feature[n.LINK_EXTERNAL_DATA],e.ZSEvents),T=A.topic,a=A.Groups,o=A.Names,u=r.getElementById("popupmenu"),i=E.view.Toolbar.Feature[n.CREATE_LINK_EXTERNAL],l=E.view.Toolbar.Feature[n.MANAGE_LINK_EXTERNAL];(t=r.createElement("ul")).setAttribute("ctype","zmenu"),t.id=s.SUBMENUITEM+n.LINK_EXTERNAL_DATA+s.IDENTITY,i&&i.createElement(t),l&&l.createElement(t),u.appendChild(t),T.register(a.Listener,o.UserAction.WEB_DATA.UPDATE_WEB_DATA,function(e,t,E,n,r,s){var A=[n];UserAction.refreshWebData(e,A,t,null,E,"refresh",n,r,s,null)},"RID","SHEETID","VERSION","WEBDATA_SHEETID","WEB_DATA_ID","FEEDUPDATE")}(this);
!function(e){var t,a=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,o=e.document,i=(e.ZSConstants.I18N,e.ZSConstants.wCC),r=e.UIUtil.Component,l=(a.view.Toolbar.Feature[n.LOCK_CELLS],o.getElementById("popupmenu")),s=e.ZSEvents,c=s.topic,u=s.Groups,p=s.Names,b=a.view.Toolbar.Feature[n.LOCK],C=a.view.Toolbar.Feature[n.LOCK_SHEET],E=a.view.Toolbar.Feature[n.MANAGE_LOCK_SETTINGS],m=a.view.Toolbar.Feature[n.HIGHLIGHT_LOCKS],T=a.view.Toolbar.Feature[n.HIGHLIGHT_LOCKS];(t=o.createElement("ul")).setAttribute("data-ctype","zmenu"),t.setAttribute("data-content-type","text"),t.setAttribute("relativeto","parent"),t.id=i.SUBMENUITEM+n.LOCK_CELLS+i.IDENTITY,b&&b.createElement(t),C&&C.createElement(t),E&&E.createElement(t),function(e){var t=o.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}(t),m&&m.createMenuElement(t),l.appendChild(t),r.bind(t,"zmenuitemclick",function(e,t){switch(t.data.action){case"lockcells":b.openDialog(!1);break;case"locksheet":C.openDialog(!0);break;case"managelock":E.openDialog();break;case"highlightlock":T.execute()}}),r.bind(t,"zmenubeforeshow",function(){c.publish(u.UI,p.Toolbar.INIT_MENU,{DOM:t})})}(this);
!function(e){var t,r,o=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,a=e.document,i=e.ZSConstants.I18N,s=(e.ZSConstants.wCC,e.ZSEvents),c=s.topic,l=s.Groups,d=s.Names,u=e.UserAction,g=(a.getElementById("popupmenu"),e.UIUtil.Component),v=e.JSUtil,S=(e.ZSConstants.ActionConstants,ZSClass.Editors.RangeEditor),h=(ZSClass.Editors.TextAreaEditor,ZSClass.Editors.Utility),f=!1,p=o.data.AppRegistry.USER_PHOTO_SERVER_URL,C=o.view.Toolbar.Feature[n.LOCK_CELLS],w=o.view.Toolbar.Feature[n.LOCK],y=(o.view.Toolbar.Feature[n.LOCK_SHEET],void 0),R=void 0,k=void 0;function E(n,a){f=n,k=a;var s,c={modal:!1,width:500,title:i["ProtectRange.UI.Menu.ProtectRange"],close:function(){!function(){for(var e=t.querySelectorAll('input[type="checkbox"]'),r=0;r<e.length;r++)e[r].checked=!1;t.innerHTML=""}()},open:function(){var t,r,n,a,i,s;R.querySelector("#lockCellsLoader").style.display="block",g.disable("#saveBtn"),t=o.view.getActiveGridID(),r=o.view.getResourceID(t),n=o.view.getSheetID(t),a=o.view.getVersionID(t),o.data.getWorkBook(r,a).getSheetObj(n).Prop.getName(),i=o.view.getSheetState(o.view.getActiveGridID(),n),s=void 0==k?i.getRanges():[k],R.querySelector("#appliestofieldcs").focus(),ZSClass.RangePicker.setRanges(r,n,a,s),function(){var t=o.view.getActiveGridID(),r=o.view.getResourceID(t),n=o.view.getVersionID(t),a=o.view.getSelectedSheets(t);e.UserAction.checkRangeLockInfo(r,a,n,!1,f,k)}()}};y||(s=e.UserAction.getTemplate(["LOCKCELL"]).LOCKCELL,(R=document.createElement("div")).id="DI_LOCK_CELLS",R.appendChild(s),t=R.querySelector("#usersContainer"),R.querySelector("#saveBtn").addEventListener("click",P),R.querySelector("#cancelBtn").addEventListener("click",I),R.querySelector("#select12").addEventListener("change",b),y=new e.ZSClass.Dialog(R,c),function(){var t=R.querySelector("#appliestofieldcs");r=new S(t,!0),ZSClass.RangePicker.register(r,!1,!1,!1,!1,!0);var o=t.nextSibling;ZSClass.RangePicker.Dialog.register(r,y,o,i["ProtectRange.UI.Menu.ProtectRange"]),r.addListeners(m),h.animateLabel(r),h.addValidator(r,function(){return e.JSUtil.REGEXP.validCell.test(r.value)},function(){r.Editor.style.borderBottomColor="#dfdfdf"},function(){r.Editor.style.borderBottomColor="#ff8d00"},200)}()),R.querySelector("#appliestorange").style.display="block",R.querySelector("#Note").innerText=i["ProtectedRange.UI.RangeLockCollaboratorsInfo"],y.open()}function I(){y.close()}function L(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),r=o.view.getSheetID(e),n=o.view.getVersionID(e),a=o.data.getWorkBook(t,n),s=(o.data.DocRegistry[t][n],a=o.data.getWorkBook(t,n),o.view.getSheetState(e,r).getActiveRange()),c=a.getSheetObj(r).ProtectedRanges.getIntersectedRanges(s);if(0!=c.length&&(s.startRow<c[0].startRow||s.endRow>c[0].endRow||s.startCol<c[0].startCol||s.endCol>c[0].endCol)){var l=i["ProtectedRange.confirm.Extend"];if(c[0].equals(s))E(!1);else{var d={buttons:[{text:i.Yes,primary:!0,click:function(){E(!0)}},{text:i.No,click:function(){E(!1)}}],title:i["Alert.Title.ExtendLock"]};ZSClass.ZSAlert(l,d)}}else E(!1)}var m={keydown:function(e){13===(e.keyCode||e.which)&&(e.preventDefault(),I())}};function b(){for(var e=R.querySelector("#select12").checked,r=t.querySelectorAll('input[type="checkbox"]'),o=0;o<r.length;o++)r[o].checked=e;g.enable("#saveBtn")}function D(){var e=R.querySelector("#select12"),r=t.querySelectorAll('[type="checkbox"]:checked').length,o=Object.keys(T).length;o>r?e.checked=!1:o==r&&(e.checked=!0)}var A=new v.StringBuffer,U=new v.StringBuffer,q=new v.StringBuffer,O=new v.StringBuffer,T={};function P(){for(var n=o.view.getActiveGridID(),a=o.view.getResourceID(n),i=o.view.getVersionID(n),s=o.data.getWorkBook(a,i),c=o.view.getSelectedSheets(n),l=t.querySelectorAll('[type="checkbox"]'),d=[],u=[],g=[],v=[],S=[],h=[],p=0;p<l.length;p++){var C=l[p].value,w=l[p].getAttribute("utype"),y=l[p].checked;switch(w){case"coG":case"rwG":case"roG":case"rcG":y&&g.push(C),!y&&v.push(C);break;case"roO":case"rwO":case"rcO":y&&S.push(C),!y&&h.push(C);break;default:y&&d.push(C),!y&&u.push(C)}}A=d.join(","),U=u.join(","),O=h.join(","),q=v.join(",");for(var R=function(e,t,r){for(var o=[],n=(r.value.trim().replace(";",","),r.value.trim().replace(/;/g,",").split(",")),a=0;a<n.length;a++){var i=JSUtil.Range.parseRange(e,t,n[a].trim());0==a&&i.sheetID,o.push(i.range)}return o}(a,i,r),k=o.view.getSheetID(n),E=s.getSheetObj(k),L=E.ProtectedRanges,m=!1,b=0;b<R.length;b++){for(var D=R[b],T=L.getIntersectedRangesAll(D),P=0;P<T.length;P++)T[P].equals(D)&&(m=!0);if(E.Merge.isXists(D.startRow,D.startCol)){var B=E.Merge.isXists(D.startRow,D.startCol).root;R[b].endRow=Math.max(B.endRow,D.endRow),R[b].endCol=Math.max(B.endCol,D.endCol)}}m&&0==d.length&&0==g.length&&0==S.length?e.UserAction.RemoveLockRange(a,c,R,i):e.UserAction.LockRange(a,c,R,i,U,A,q,O,!1,f),I()}var B={};function x(e,t){this.parent=e,this.addCollaborators(t.pr)}x.prototype={createUser:function(e,t,r,n,a){var i=e.zuid,s=u.getTemplate(["LOCK_USERS_TEMPLATE"]).LOCK_USERS_TEMPLATE,c=document.createElement("div");c.className="dspTblRow",c.appendChild(s),c.querySelector("#profile").src=p+"/file?fs=thumb&ID="+i+a,c.querySelector("#name").textContent=e.name,c.querySelector("#name").title=e.email,c.querySelector("#userType").textContent=n;var l=c.querySelector('input[type="checkbox"]');l.setAttribute("utype",r),e.lock&&(l.checked=!0),i==o.data.UserInfo.zuid&&(c.querySelector("#me").style.display="block"),l.value=i,l.addEventListener("change",function(){g.enable("#saveBtn"),D()}),T[i]=i,this.parent.appendChild(c)},addCollaborators:function(e){var t=o.view.getActiveGridID(),r=(o.view.getResourceID(t),0);for(var n in e.owner&&this.createUser(e.owner,r,"owner",i["ProtectRange.UI.Owner"],w.userImgBasedOnType("owner")),e)for(var a=w.getUserTypeMsg(n),s=0;s<e[n].length;s++,r++)this.createUser(e[n][s],r,n,a,w.userImgBasedOnType(n));D()}},w.openDialog=L,C.openDialog=L,C.showDialog=E,c.register(l.Listener,d.UserAction.SHOW_LOCK_INFO,function(e,r){if(!r){for(;t.firstChild;)t.removeChild(t.firstChild);R.querySelector("#lockCellsLoader").style.display="none",new x(t,e)}},"lockInfo","isSheet"),c.register(l.Listener,d.SheetMeta.PROTECTED_RANGES,function(e,t){B[e]=t},"SHEETID","RangeList")}(this);
!function(e){var t,n=e.sPlusPlus,a=e.ZSEvents,o=a.topic,r=a.Groups,s=a.Names,i=e.ZSConstants.I18N,c=e.ZSConstants.FeatureConstants,l=void 0,g=e.UIUtil.Component,d=n.view.Toolbar.Feature[c.MANAGE_LOCK_SETTINGS];function p(){if(!l){var a={modal:!0,width:580,title:i["MenuItem.DataTab.Lock.ManageLockSettings"],close:function(){d.SheetLocksContainer.container.innerHTML="<span id='sheetLocksLoader'  class='ZsLoader ZsLoaderSmall'></span>",d.RangeLocksContainer.container.innerHTML="<span id='rangeLocksLoader'  class='ZsLoader ZsLoaderSmall'></span>",d.sheetLocksConstructed=!1,d.rangeLocksConstructed=!1,d.selectedSheetId="",t.innerHTML="",d.manageDlgWrapper.querySelector("#noLocksMsg").style.display="none"},open:function(){var a,o,r,s,c;a=n.view.getActiveGridID(),o=n.view.getResourceID(a),r=n.view.getVersionID(a),s=n.view.getSelectedSheets(a),c=n.view.getSheetID(a),d.selectedSheetId=c,function(){var a=n.view.getActiveGridID(),o=n.view.getResourceID(a),r=n.view.getVersionID(a),s=n.data.getWorkBook(o,r).SheetList.getSheets(!1),c=n.view.getSheetID(a),l=i.WholeDocument;(L=document.createElement("option")).value="All",L.innerText=l,t.appendChild(L),d.loadedSheets.All=0;for(var p=0;p<s.length;p++){l=s[p].Name;var L=document.createElement("option");L.value=s[p].Id,L.innerText=l,t.appendChild(L),d.loadedSheets[s[p].Id]=0}g.zcombo("#appliestofieldM","refresh"),g.bind("#appliestofieldM","zselectboxchange",function(a,o){d.IsRangeTab&&function(a,o){var r=n.view.getActiveGridID(),s=n.view.getResourceID(r),i=n.view.getVersionID(r),c=n.view.getSelectedSheets(r);n.data.getWorkBook(s,i),d.selectedSheetId=o.value,d.RangeLocksContainer.isWholeDocument=!1,"All"===d.selectedSheetId&&(d.RangeLocksContainer.isWholeDocument=!0),g.zcombo(t,"setValue",d.selectedSheetId),0==d.loadedSheets[d.selectedSheetId]?e.UserAction.readProtectedRanges(s,c,d.RangeLocksContainer.isWholeDocument?n.view.getSheetID(r):d.selectedSheetId,i,d.RangeLocksContainer.isWholeDocument):d.RangeLocksContainer.show()}(0,o)}),g.zcombo("#appliestofieldM","setValue",c)}(),e.UserAction.readProtectedRanges(o,s,c,r,!1)}};l=new e.ZSClass.Dialog((o=e.UserAction.getTemplate(["MANAGE_LOCKCELL"]).MANAGE_LOCKCELL,d.manageDlgWrapper=document.createElement("div"),d.manageDlgWrapper.id="DI_MANAGE_LOCKCELL",d.manageDlgWrapper.appendChild(o),t=d.manageDlgWrapper.querySelector("#appliestofieldM"),d.manageDlgWrapper.querySelector("#rangeOpt").addEventListener("click",function(){d.RangeLocksContainer.show()}),d.manageDlgWrapper.querySelector("#sheetOpt").addEventListener("click",function(){d.SheetLocksContainer.show()}),d.manageDlgWrapper.querySelector("#saveBtn").onclick=S,d.manageDlgWrapper.querySelector("#cancelBtn").onclick=L,d.manageDlgWrapper),a)}var o;d.manageDlgWrapper.querySelector("#saveBtn").style.display="none",d.manageDlgWrapper.querySelector("#manageLockInfo").style.display="none",d.modifiedRanges=[],d.sheetLocks={},d.rangeLocks={},d.SheetLocksContainer=new ZSClass.SheetLocksContainer(d.manageDlgWrapper.querySelector("#sheetLocksContainer")),d.RangeLocksContainer=new ZSClass.RangeLocksContainer(d.manageDlgWrapper.querySelector("#rangeLocksContainer")),d.RangeLocksContainer.isWholeDocument=!1,l.open()}function L(){l.close()}function S(){var t=n.view.getActiveGridID(),a=n.view.getResourceID(t),o=(n.view.getSheetID(t),n.view.getVersionID(t)),r=(n.data.getWorkBook(a,o),n.view.getSelectedSheets(t));d.enableManageLocks(!1),e.UserAction.manageLockRange(a,d.modifiedRanges,r,o,d.isSheetTabSelected)}d.isSheetTabSelected=!1,d.manageDlgWrapper=void 0,d.loadedSheets={},d.selectedSheetId="",d.openDialog=p,o.register(r.Listener,s.UserAction.MANAGE_LOCK_DLG,p)}(this);
!function(e){var t,n,o=e.sPlusPlus,i=e.document,r=e.UIUtil.Component,a=e.ZSClass,l=e.ZSConstants.FeatureConstants,s=(e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),c=(e.ZSConstants.wCC,e.ZSEvents),u=a.Editors.TextAreaEditor,d=(a.Editors.Utility,c.topic),v=c.Groups,g=c.Names;function p(e){UserAction.Goto(e),t.close()}var S=void 0;var f={input:function(e){S.value?r.enable("#gt_submit"):m()},keydown:function(e){13==e.which&&(E(),e.stopPropagation())}};function m(){return r.disable("#gt_submit"),!1}function w(){S.focus()}function D(){m(),S.value="",n.querySelector("#gt_namelist").innerText=""}function E(){var e=S.value;UserAction.Goto(e),t.close()}o.view.Toolbar.Feature[l.GOTO].openDialog=function(r){t||function(){var o={width:310,title:s.Goto,close:D,open:w},r=UserAction.getTemplate(["gotoTemplate"]);(n=i.createElement("div")).id="DI_GOTO",n.appendChild(r.gotoTemplate),n.querySelector("#gt_submit").addEventListener("click",E),t=new e.ZSClass.Dialog(n,o);var a=n.querySelector("#gt_input");(S=new u(a)).addListeners(f)}();var a=function(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),n=o.view.getVersionID(e),i=(o.view.getSheetID(e),o.data.getWorkBook(t,n).NamedRange.getAllKeys());return Array.from(i)}();a.length&&(document.querySelector(".dNc").style.display="block",function(e){var t=n.querySelector("#gt_namelist"),o=i.createElement("div");if(o.className="txtOverflow boxBorder",t)for(var r=0;r<e.length;r++){var a=e[r],l=o.cloneNode();l.innerText=a,l.title=a,l.addEventListener("click",p.bind("null",a)),t.appendChild(l)}}(a)),t.open(),r.preventDefault();var l=o.view.getActiveGridID(),c=o.view.getResourceID(l),m=o.view.getSheetID(l),C=o.view.getVersionID(l);d.publish(v.Selector.BoundUpdate.CellEdit,g.Selection.BOUND_UPDATE.REMOVE,{RID:c,SHEETID:m,VERSION:C,isSubmittable:!0})}}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,n=e.UIUtil.Component,i=e.document,s=e.ZSClass,a=e.ZSEvents,r=a.topic,u=a.Groups,l=a.Names,v=t.view.Toolbar.Feature[o.OPEN];function c(){var e=new function(){s.KeyMapping.call(this)};t.view.Events.Key.Entry.Dialog.Node.addChildNode(e);var o=i.querySelector("#attachopenfiledialogdiv");o&&(o.addEventListener("mousedown",function(){var e;(e=t.view.Events.Key).focusContext(e.Entry.Dialog.Context)}),n.bind(o,"dialogclose",function(){var e;(e=t.view.Events.Key).focusContext(e.Entry.CellEditor.Context)}))}function d(){var e=t.view.getActiveGridID(),o=t.view.getResourceID(e),i=t.data.PageRegistry.wmsOptions.langCode;n.getDocsCompI18N(i,o)}r.register(u.UI,l.Toolbar.INIT_MENU,function(e){v.parent==e&&d()},"DOM"),r.register(u.UI,l.Layout.TEMPLATE_LOADED_DEFER,d),n.addDocsFiles(),v.openDialog=function(e){var o=t.view.getActiveGridID(),i=t.view.getResourceID(o),s=t.view.getVersionID(o),a=t.view.getSheetID(o);r.publish(u.Selector.BoundUpdate.Copy,l.Selection.BOUND_UPDATE.HIDE,{RID:i,SHEETID:a,VERSION:s,VisualCueStatus:0}),n.showOpenDialog(c),e.preventDefault()}}(this);
!function(e){var t,i,n,a=e.sPlusPlus,r=e.UIUtil.Component,d=e.ZSConstants,o=e.ZSClass,s=(e.window,d.FeatureConstants),l=d.I18N,c=d.wCC,p=(a.view.measures,a.view.Toolbar.Feature[s.PRINT]),h=a.view.Toolbar.Feature[s.PRINT_SETTINGS];function u(u,m,b,f){var S,w,y,O,I,x,L,E,z,T,W,q,D,M,C;if(-1==d.Meta.HideFeaturesList.indexOf(s.PRINT)){if(u.repeat)return;p.printPreviewObj=void 0;var H={modal:!0,width:650,title:l["Print.PrintSettings"],open:function(){P()}};n||(C=e.UserAction.getTemplate(["PRINT_TEMPLATE"]).PRINT_TEMPLATE,(i=document.createElement("div")).id=c.DI+s.PRINT+c.IDENTITY,i.appendChild(C),S=i.querySelector("#printPaperSize"),w=i.querySelector("#printPaperWidth"),y=i.querySelector("#printPaperHeight"),O=i.querySelector("#printPortraitOrient"),I=i.querySelector("#printLandscapeOrient"),x=i.querySelector("#printTopMargin"),L=i.querySelector("#printBottomMargin"),E=i.querySelector("#printLeftMargin"),z=i.querySelector("#printRightMargin"),T=i.querySelector("#printAddGridLines"),W=i.querySelector("#printAddImages"),q=i.querySelector("#printAddCharts"),D=i.querySelector("#printAddButtons"),M=i.querySelector("#printFitToWidth"),t=i.querySelector(".printPrvPge"),r.bind(S,"zselectboxchange",function(e,t){(function(){var e=h.PaperDim[this.value];e&&(h.Options.PageSize=this.value,h.Options.PageWidth=e.w,h.Options.PageHeight=e.h)}).call(t),v.call(t,"PageSize")}),r.bind(w,"znumberfieldspin",function(e,t){v.call(t,"PageWidth"),g()}),r.bind(y,"znumberfieldspin",function(e,t){v.call(t,"PageHeight"),g()}),r.bind(w,"znumberfieldinput",function(e,t){v.call(t,"PageWidth"),g()}),r.bind(y,"znumberfieldinput",function(e,t){v.call(t,"PageHeight"),g()}),r.bind(x,"znumberfieldchange",function(e,t){v.call(t,"MarginTop")}),r.bind(L,"znumberfieldchange",function(e,t){v.call(t,"MarginBottom")}),r.bind(E,"znumberfieldchange",function(e,t){v.call(t,"MarginLeft")}),r.bind(z,"znumberfieldchange",function(e,t){v.call(t,"MarginRight")}),O.addEventListener("change",v.bind(O,"Orientation")),I.addEventListener("change",v.bind(I,"Orientation")),T.addEventListener("change",v.bind(T,"addGridLines")),D.addEventListener("change",v.bind(D,"addButton")),W.addEventListener("change",v.bind(W,"addImage")),q.addEventListener("change",v.bind(q,"addChart")),M.addEventListener("change",v.bind(M,"FitToWidth")),i.querySelector("#printPreviewBtn").addEventListener("click",function(){p.execute("PREVIEW"),n.close()}),i.querySelector("#printBtn").addEventListener("click",function(){p.execute("PRINT"),n.close()}),i.querySelector("#clBtn").addEventListener("click",function(){n.close()}),n=new o.Dialog(i,H)),function(t,n,r){var d=i.querySelector("#printAddImages"),o=i.querySelector("#printAddCharts"),s=i.querySelector("#printAddButtons"),l=a.view.getActiveGridID();!t&&(t=a.view.getResourceID(l)),!n&&(n=a.view.getSheetID(l)),!r&&(r=a.view.getVersionID(l));var c=a.data.getWorkBook(t,r).getSheetObj(n),p=a.view.getSheetState(l,n).getActiveRange(),u=c.Merge.isXists(p.startRow,p.startCol)&&c.Merge.isXists(p.endRow,p.endCol);if(e.isCanvasGrid)return c.Charts.length()&&(o.checked=!0,h.Options.addChart=!0),c.Buttons.length()&&(s.checked=!0,h.Options.addButton=!0),void(c.Images.length()&&(d.checked=!0,h.Options.addImage=!0));u||p.isSingle()?(d.parentElement.classList.remove("zsDisable"),o.parentElement.classList.remove("zsDisable"),s.parentElement.classList.remove("zsDisable"),c.Charts.length()&&(o.checked=!0,h.Options.addChart=!0),c.Buttons.length()&&(s.checked=!0,h.Options.addButton=!0),c.Images.length()&&(d.checked=!0,h.Options.addImage=!0)):(d.parentElement.classList.add("zsDisable"),o.parentElement.classList.add("zsDisable"),s.parentElement.classList.add("zsDisable"),o.checked=!1,s.checked=!1,d.checked=!1,h.Options.addChart=!1,h.Options.addButton=!1,h.Options.addImage=!1)}(m,b,f),n.open()}}function g(){var e=function(){var e=h.Options.PageWidth,t=h.Options.PageHeight;for(var i in h.PaperDim)if(h.PaperDim[i].w==e&&h.PaperDim[i].h==t)return i;return"custom"}();r.zcombo("#printPaperSize","setValue",e)}function v(e){h.Options[e]="checkbox"==this.type?this.checked:this.value,"checkbox"!=this.type&&("custom"==h.Options.PageSize&&"Orientation"!=e||function(e){var t,i,n=h.PaperDim[e];n?(t=n.w,i=n.h):(t=h.Options.PageWidth,i=h.Options.PageHeight);var a=h.Options.Orientation;r.zspinner("#printPaperWidth","setValue",0==a?t:i),r.zspinner("#printPaperHeight","setValue",0==a?i:t)}(this.value),P())}function P(){i.querySelector(".noPreview").style.display="none",t.style.display="none";var e,n,a=(e=r.zspinner("#printPaperWidth","getValue"),n=r.zspinner("#printPaperHeight","getValue"),{w:Math.round(100*parseFloat(e))/100,h:Math.round(100*parseFloat(n))/100}),d=a.w,o=a.h,s=Math.floor(6*parseInt(d)),l=Math.floor(6*parseInt(o));t.style.width=s+"px",t.style.height=l+"px",t.dataset.widthinch=d+"''",t.dataset.heightinch=o+"''",t.style.display="block"}h.PaperDim={a3:{n:"A3",w:"11.69",h:"16.54",i:"0",iW:"62px",iH:"85px"},a4:{n:"A4",w:"8.27",h:"11.69",i:"0",iW:"53px",iH:"72px"},a5:{n:"A5",w:"5.83",h:"8.27",i:"2",iW:"43px",iH:"59px"},b4:{n:"B4",w:"9.84",h:"13.90",i:"3",iW:"62px",iH:"83px"},b5:{n:"B5",w:"6.93",h:"9.84",i:"4",iW:"50px",iH:"70px"},letter:{n:"Letter",w:"8.5",h:"11",i:"1",iW:"59px",iH:"70px"},legal:{n:"Legal",w:"8.5",h:"14",i:"2",iW:"59px",iH:"78px"},executive:{n:"Executive",w:"7.25",h:"10.5",i:"3",iW:"50px",iH:"69px"},envelope10:{n:"Envelope #10",w:"4.13",h:"9.5",i:"4",iW:"26px",iH:"61px",dO:"1"}},h.Options={PageSize:"a4",PageWidth:"8.27",PageHeight:"11.69",Orientation:0,MarginLeft:.5,MarginRight:.5,MarginTop:.5,MarginBottom:.5,addGridLines:!1,addImage:!1,addButton:!1,addChart:!1,FitToWidth:!1},p.openDialog=u,h.openDialog=u}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,n=e.UIUtil.Component,i=e.document,r=e.ZSClass,a=e.ZSEvents,s=a.topic,u=a.Groups,c=a.Names,l=t.view.Toolbar.Feature[o.SHARE];function d(){var e=new function(){r.KeyMapping.call(this)},o=t.view.Events.Key;o.Entry.Dialog.Node.addChildNode(e),o.focusContext(o.Entry.Dialog.Context);var a,s=i.querySelector("#sharedialogdiv");s?((a=s).addEventListener("mousedown",function(){v()}),n.bind(a,"dialogclose",function(){E()}),setTimeout(function(){a.querySelector("#zd_sharetextarea")&&a.querySelector("#zd_sharetextarea").focus(),a.querySelector("#zd_initial_sharetextarea")&&a.querySelector("#zd_initial_sharetextarea").focus()},300)):setTimeout(function(){var e=i.querySelector("#docscomponent");e&&function(e){e.addEventListener("mousedown",function(){v()});var t=e.querySelector(".close");t&&t.addEventListener("click",function(){E()})}(e)},1e3)}function v(){var e=t.view.Events.Key;e.focusContext(e.Entry.Dialog.Context)}function E(){var e=t.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}s.register(u.UI,c.Layout.TEMPLATE_LOADED_DEFER,function(){var e=t.view.getActiveGridID(),o=t.view.getResourceID(e),i=t.data.PageRegistry.wmsOptions.langCode;n.getDocsCompI18N(i,o)}),n.addDocsFiles(),l.openDialog=function(e){var o=t.view.getActiveGridID(),i=t.view.getResourceID(o),r=t.view.getSheetID(o),a=t.view.getVersionID(o);s.publish(u.Selector.BoundUpdate.Copy,c.Selection.BOUND_UPDATE.HIDE,{RID:i,SHEETID:r,VERSION:a,VisualCueStatus:0}),n.showShareDialog(i,d)}}(this);
!function(e){var t,o,i=e.sPlusPlus,r=e.document,l=e.ZSClass,n=e.ZSConstants.FeatureConstants,a=e.ZSConstants.I18N,s=e.ZSConstants.wCC,c=e.ZSEvents;c.topic,c.Groups,c.Names;function u(){var e=i.data.getSharePublishMeta(t.rID).getPublishMeta(),r=void 0==e.isAllowExport()||e.isAllowExport(),l=void 0!=e.isShowFormula()&&e.isShowFormula();o.querySelector("#allowExport").checked=r,o.querySelector("#lockFormula").checked=l}function d(){var e=t.rID,i=t.version,r=o.querySelector("#allowExport").checked,l=o.querySelector("#lockFormula").checked;UserAction.PublishSpreadsheet(e,i,"external",r,l,"Make Public",E),t.close()}function E(){UserAction.UIViewEmbedURL()}i.view.Toolbar.Feature[n.EMBED].openDialog=function(c){var E=i.view.getActiveGridID(),h=i.view.getResourceID(E);if(i.data.getSharePublishMeta(h).getPublishMeta().isPublished())UserAction.UIViewEmbedURL();else{var S,g;t||(S=e.UserAction.getTemplate(["PUBLISH_TEMPLATE","OK_CANCEL_TEMPLATE"]),g={modal:!0,width:520,title:a.EmbedToWebsiteBlog,open:u},(o=r.createElement("div")).Id=s.DI+n.EMBED+s.IDENTITY,o.appendChild(S.PUBLISH_TEMPLATE),o.appendChild(S.OK_CANCEL_TEMPLATE),t=new l.Dialog(o,g),o.querySelector("#okBtn").addEventListener("click",d),o.querySelector("#clBtn").addEventListener("click",function(){t.close()})),i.data.UserInfo.orgName,o.querySelector("#publicInfoMessage").innerText="org"==c?a["Public.Org.Warning"]:a.MakingThisDocumentPublicMsg,t.open()}}}(this);
!function(e){var t,i,n,r,l,a,o,c,s,u=e.sPlusPlus,g=e.ZSConstants,S=e.ZSClass,d=e.ZSEvents,P=e.UIUtil.Component,p=g.FeatureConstants,h=g.I18N,E=g.wCC,b=d.topic,R=d.Groups,v=d.Names,f=u.view.Toolbar.Feature[p.PUBLISH_RANGE],m=void 0,I=S.Editors;function T(){((function(e){var i=u.view.getActiveGridID(),n=u.view.getResourceID(i),r=u.view.getSheetID(i),l=u.view.getVersionID(i),a=u.data.getWorkBook(n,l).getSheetObj(r).Prop.getName(),o=u.view.getSheetState(i,r).getActiveRange().getLabel(),c=a+"."+o,s=e.querySelector("#nR_expression");(m=new I.RangeEditor(s,!0)).value=c,S.RangePicker.register(m,!0,!1);var g=s.nextElementSibling;S.RangePicker.Dialog.register(m,t,g,"Select Range"),m.focus()})(i),void 0!=n)&&(i.querySelector("#withinNetwork").checked=!0,i.querySelector("#withinNetworkLabel").innerText=JSUtil.fn.replaceParams(h["Share.Public.MakePublicWithin"],[n]),i.querySelector("#publicRangeInfoMessage").innerText=JSUtil.fn.replaceParams(h["RangePublish.PublishRangeDialog.OrganizationPublicConfirmMsg"],[n,n]),i.querySelector("#externalWorld").addEventListener("change",function(){i.querySelector("#publicRangeInfoMessage").innerText=h["RangePublish.PublishRangeDialog.ExternalPublicConfirmMsg"]}),i.querySelector("#withinNetwork").addEventListener("change",function(){i.querySelector("#publicRangeInfoMessage").innerText=JSUtil.fn.replaceParams(h["RangePublish.PublishRangeDialog.OrganizationPublicConfirmMsg"],[n,n])}))}function C(){var e=t.rID,r=t.sheetList,a=t.version;l="external",void 0!=n&&(l=i.querySelector("#externalWorld").checked?"external":"org");var o=m.value;UserAction.publishRange(e,r,a,o,l,_),t.close()}function _(t){if("Failure"!=t){var i=t.id;if(a=i,!c){var l=e.UserAction.getTemplate(["CHANGE_RANGE_PUBLISH_OPTIONS","VIEW_RANGE_PUBLISH_URL","EMBED_SNIPPET_TEMPLATE","EMBED_REVERT_CANCEL_TEMPLATE"]),s={width:520,title:h.PublishRange,modal:!0,open:L,close:A};o=document.createElement("div"),void 0!=n&&(o.appendChild(l.CHANGE_RANGE_PUBLISH_OPTIONS),o.querySelector("option[value='org']").innerText=JSUtil.fn.replaceParams(h["Share.Public.MakePublicWithin"],[n])),o.appendChild(l.VIEW_RANGE_PUBLISH_URL),o.appendChild(l.EMBED_SNIPPET_TEMPLATE),o.appendChild(l.EMBED_REVERT_CANCEL_TEMPLATE),c=new S.Dialog(o,s),o.querySelector("#btnRemovePublic").addEventListener("click",function(){(function(e){var t={type:"warning",noIcon:!0,title:h["Alert.Title.RemovePublicMode"],buttons:[{primary:!0,text:h.OK,click:function(){!function(e){var t=c.rID,i=c.sheetList,n=c.version;UserAction.updatePublishRange(t,i,n,e,"public","Remove")}(e),c.close()}},{text:h["Dialog.Button.Cancel"]}]};S.ZSAlert(h["RangePublish.ShowPublishedRangeDialog.RevertRangePublishAlert.ConfirmMsg"],t)}).call(null,i)}),o.querySelector("#btnCancel").addEventListener("click",function(){c.close()}),r=o.querySelector("#zsPublicUrlLink");var g=o.querySelector("#publicURL"),d={inputToSelect:r,cssClass:"frmSnpt"};new S.CopyToClipboard(g,d).createElement();var P=o.querySelector("#embedCode"),p=o.querySelector("#embedSnippetCode"),E={inputToSelect:P,cssClass:"frmSnpt"};new S.CopyToClipboard(p,E).createElement()}var f=function(e){var t=JSUtil.fn.getServerPath();return t+=u.data.AppRegistry.ctxpath,t+="publishrange.do?id="+e}(i);o.querySelector("#embedCode").innerText='<iframe style="height:200px; width:335px;" marginwidth="0" marginheight="0" scrolling="auto" frameborder=0 src="'+f+'"></iframe>',r.href=f,r.innerText=f,c.open()}else b.publish(R.Listener,v.ERROR.SHOW,{ERRORMSG:"Error.Internal.Server"})}function A(){s&&s.remove()}function L(){if(o.querySelector("#embedSnipetMsg").innerText=JSUtil.fn.replaceParams(h["Dialog.Publish.EmbedMessage"],[h["Dialog.Publish.Range"]]),void 0!=n){o.querySelector("#publishMsg").innerText=JSUtil.fn.replaceParams(h["Share.Public.PublishType"],[h["Dialog.Publish.Range"]]);var e=o.querySelector("#pubRangeOption");"external"==l?P.zcombo(e,"setValue","external"):P.zcombo(e,"setValue","org"),P.bind(e,"zselectboxchange",function(e,t){var i=c.rID,n=c.version,r=t.previousValue,l=t.selectedValue;UserAction.changePublishRangeType(i,n,l,r,a,N)})}}function N(e){var t=c&&c.getDialog(),i="org"==e?h["Publish.Organization.Notification"]:h["Publish.External.Notification"];s=new S.TBNotification(i,{type:"info",timeOut:3e4,showCloseBtn:!0,parent:t}),t&&s.show()}f.openDialog=function(){var e=u.view.getActiveGridID(),r=u.view.getSheetID(e);if(u.view.getSheetState(e,r).isMultiRangeSelected())S.ZSAlert(h["action.not.support.multiselection"],h["Alert.Title.InvalidCellRange"]);else{if(!t){var l=UserAction.getTemplate(["PUBLISH_RANGE_OPTIONS","RANGE_PUBLISH_TEMPLATE","PUBLISH_RANGE_PICKER"]),a={width:560,title:h.PublishRange,dialogClass:"publshRange",open:T};(i=document.createElement("div")).Id=E.DI+p.PUBLISH_RANGE+E.IDENTITY,i.appendChild(l.PUBLISH_RANGE_PICKER),void 0!=(n=sPlusPlus.data.UserInfo.orgName)&&i.appendChild(l.PUBLISH_RANGE_OPTIONS),i.appendChild(l.RANGE_PUBLISH_TEMPLATE),t=new S.Dialog(i,a),i.querySelector("#cancelBtn").addEventListener("click",function(){t.close()})}i.querySelector("#publicRangeInfoMessage").innerText=h["RangePublish.PublishRangeDialog.ExternalPublicConfirmMsg"],i.querySelector("#continueBtn").addEventListener("click",C),t.open()}}}(this);
!function(e){var t,i,n,r,a,l,o,s=e.sPlusPlus,c=e.ZSConstants,u=e.ZSClass,d=e.ZSEvents,p=c.FeatureConstants,S=c.I18N,g=c.wCC,h=(d.topic,d.Groups,d.Names,e.UserAction),v=u.Editors,y=s.view.Toolbar.Feature[p.MANAGE_PUBLISH_RANGE],E=e.UIUtil.Component;function m(e){var i=t&&t.getDialog(),n="org"==e?S["Publish.Organization.Notification"]:S["Publish.External.Notification"];o=new u.TBNotification(n,{type:"info",timeOut:3e4,showCloseBtn:!0,parent:i}),i&&o.show()}function P(e){var t=i.querySelector("#viewPublishTable");if("false"==e.NORANGESPUBLISHED){var r=document.createDocumentFragment();l=e.PUB_SHEETS.length;var a=e.PUB_SHEETS,o=e.PUB_RANGE_SROW,s=e.PUB_RANGE_SCOL,c=e.PUB_RANGE_EROW,u=e.PUB_RANGE_ECOL,d=e.PUB_DATE,p=e.PUB_ENC_URL,S=e.PUB_TYPE;i.querySelector("#viewPublishHead").style.display="";for(var g=0;g<l;g++)new b(r,a[g],o[g],s[g],c[g],u[g],d[g],p[g],S[g]);t.appendChild(r)}else{var v=h.getTemplate(["NO_RANGE_PUBLISHED"]);i.querySelector("#viewPublishHead").style.display="none",t.appendChild(v.NO_RANGE_PUBLISHED)}n.remove()}function b(e,i,n,l,o,s,c,u,d){var p,g,v,y,P,b,f,R;c=c.substring(c.indexOf(" ")+1),this.range=function(e,t,i,n,r){var a;a=t==n&&i==r?JSUtil.Cell.getReference(t,i):JSUtil.Cell.getReference(t,i)+":"+JSUtil.Cell.getReference(n,r);return e+"."+a}(i,n,l,o,s),this.Dom=function(e,t,i,n){a=sPlusPlus.data.UserInfo.orgName;var r=h.getTemplate(["PUBLISHED_RANGE_ROW"]).PUBLISHED_RANGE_ROW;r.querySelector("option[value='org']").innerText=JSUtil.fn.replaceParams(S["Share.Public.MakePublicWithin"],[a]),r.querySelector("#rangeName").innerText=e,r.querySelector("#publishedOn span").innerText=t,r.querySelector(".rPubOnCombo").id="pubRangeOption_"+n;var l=document.createElement("div");return l.className="dspTblRow",l.appendChild(r),E.initComponent(l),l}(this.range,c,0,u),this.rangeID=u,this.type=d,g=(p=this).Dom,v=g.querySelector("#editRange"),y=g.querySelector("#removeRange"),P=g.querySelector("#updateRange"),b=g.querySelector("#cancelEdit"),f=g.querySelector("#showSnippet"),R=g.querySelector("#hideSnippet"),v.addEventListener("click",function(){p.edit.call(p)}),y.addEventListener("click",function(){p.remove.call(p)}),f.addEventListener("click",function(){r&&(r.classList.remove("active"),r.querySelector("#showSnippet").style.display="",r.querySelector("#hideSnippet").style.display="none"),g.classList.add("active"),p.showSnippet.call(p)}),R.addEventListener("click",function(){g.classList.remove("active"),p.hideSnippet.call(p)}),P.addEventListener("click",function(){p.update.call(p)}),b.addEventListener("click",function(){p.cancelEdit.call(p)}),function(e){var i=e.Dom,n=e.type,r=e.rangeID;if(void 0!=a){var l=i.querySelector(".rPubOnCombo");"public"==n?E.zcombo(l,"setValue","external"):E.zcombo(l,"setValue","org"),E.bind(l,"zselectboxchange",function(i,n){var a=t.rID,l=t.version,o=n.previousValue,s=n.selectedValue;e.type=s,h.changePublishRangeType(a,l,s,o,r,m)})}}(p),e.appendChild(this.Dom)}function f(e,t){e.querySelector("#editRange").style.display="view"==t?"":"none",e.querySelector("#removeRange").style.display="view"==t?"":"none",e.querySelector("#rangeName").style.display="view"==t?"":"none",e.querySelector("#updateRange").style.display="view"==t?"none":"",e.querySelector("#cancelEdit").style.display="view"==t?"none":"",e.querySelector("#rangeNameEdit").style.display="view"==t?"none":""}y.openDialog=function(){if(!t){var e=h.getTemplate(["VIEW_PUBLISHED_RANGE","CLOSE_BUTTON_TEMPLATE"]),a={width:800,title:S["MenuItem.data.ManagePublish"],dialogClass:"pubRangeMng",close:function(){!function(){o&&o.remove(),r=void 0;var e=i.querySelector("#embedSnipet");e&&(e.style.display="none")}()}};(i=document.createElement("div")).id=g.DI+p.MANAGE_PUBLISH_RANGE+g.IDENTITY,i.appendChild(e.VIEW_PUBLISHED_RANGE),i.appendChild(e.CLOSE_BUTTON_TEMPLATE),i.querySelector("#closeBtn").addEventListener("click",function(){t.close()}),t=new u.Dialog(i,a)}var l,c,d,v;t.open(),function(){(n=document.createElement("div")).classList.add("ZsLoader");var e=i.querySelector("#viewPublishTable");e.innerHTML="",e.appendChild(n)}(),l=t.rID,c=t.sheetList,d=t.version,v=s.data.UserInfo.orgName,h.getPublishRanges(l,c,d,v,P)},b.prototype={edit:function(){f(this.Dom,"edit"),this.rangeEditor||function(){var e=this.Dom.querySelector("#nR_expression");this.rangeEditor=new v.RangeEditor(e,!0),u.RangePicker.register(this.rangeEditor,!0,!1);var i=e.nextElementSibling;u.RangePicker.Dialog.register(this.rangeEditor,t,i,"Select Range")}.call(this),this.rangeEditor.value=this.range,this.rangeEditor.focus()},update:function(){var t,i,n,r,a,l,o,c;f(this.Dom,"view"),this.range=this.rangeEditor.value,this.Dom.querySelector("#rangeName").innerText=this.range,t=this.range,i=this.rangeID,n=this.type,r=s.view.getActiveGridID(),a=s.view.getResourceID(r),l=s.view.getVersionID(r),o=s.view.getSelectedSheets(r),c=JSUtil.Range.parseRange(a,l,t),e.UserAction.updatePublishRange(a,o,l,i,n,"Update",c)},remove:function(){var t,n,r,a,o=this;t=this.rangeID,n=this.type,r=function(){if(o.Dom.remove(),0==(l-=1)){i.querySelector("#viewPublishHead").style.display="none";var e=h.getTemplate(["NO_RANGE_PUBLISHED"]);i.querySelector("#viewPublishTable").appendChild(e.NO_RANGE_PUBLISHED)}},a={type:"warning",noIcon:!0,title:S["Alert.Title.RemovePublicMode"],buttons:[{primary:!0,text:S.OK,click:function(){!function(t,i){var n=s.view.getActiveGridID(),r=s.view.getResourceID(n),a=s.view.getVersionID(n),l=s.view.getSelectedSheets(n);e.UserAction.updatePublishRange(r,l,a,t,i,"Remove")}(t,n);var a=i.querySelector("#embedSnipet"),l=i.querySelector("#embedCode"),o=l?l.getAttribute("domvalue"):void 0;o&&t==o&&(a.style.display="none"),r()}},{text:S["Dialog.Button.Cancel"]}]},u.ZSAlert(S["RangePublish.ShowPublishedRangeDialog.RevertRangePublishAlert.ConfirmMsg"],a)},showSnippet:function(){var e=i.querySelector("#embedCode");if(!e){var t=h.getTemplate(["EMBED_SNIPPET_TEMPLATE"]).EMBED_SNIPPET_TEMPLATE;t.className="publishRangeSnippet",i.appendChild(t),i.querySelector("#embedSnipetMsg").innerText=JSUtil.fn.replaceParams(S["Dialog.Publish.EmbedMessage"],[S["Dialog.Publish.Range"]]),e=i.querySelector("#embedCode");var n=i.querySelector("#embedSnippetCode"),a={inputToSelect:e,cssClass:"frmSnpt"};new u.CopyToClipboard(n,a).createElement()}e.setAttribute("domvalue",this.rangeID),r=this.Dom;var l=JSUtil.fn.getServerPath();l+=s.data.AppRegistry.ctxpath,l+="publishrange.do?id="+this.rangeID,e.innerText='<iframe style="height:200px; width:335px;" marginwidth="0" marginheight="0" scrolling="auto" frameborder=0 src="'+l+'"></iframe>',i.querySelector("#embedSnipet").style.display="",this.Dom.querySelector("#showSnippet").style.display="none",this.Dom.querySelector("#hideSnippet").style.display=""},hideSnippet:function(){this.Dom.querySelector("#showSnippet").style.display="",this.Dom.querySelector("#hideSnippet").style.display="none",i.querySelector("#embedSnipet").style.display="none"},cancelEdit:function(){f(this.Dom,"view")}}}(this);
!function(e){var t,r,n,i,o=e.sPlusPlus,l=e.ZSConstants.FeatureConstants,a=e.document,c=e.ZSConstants.I18N,s=e.ZSConstants.wCC,u=e.ZSEvents,d=(u.topic,u.Groups,u.Names,e.ZSConstants),S=o.view.Toolbar.Feature[l.PUBLISH],P=o.view.Toolbar.Feature[l.PUBLISH+"_ViewPublish"];function h(){var e=o.data.getSharePublishMeta(t.rID).getPublishMeta(),i=void 0==e.isAllowExport()||e.isAllowExport(),a=void 0!=e.isShowFormula()&&e.isShowFormula();(r.querySelector("#allowExport").checked=i,r.querySelector("#lockFormula").checked=a,void 0!=n&&-1==d.Meta.HideFeaturesList.indexOf(l.PUBLISH_ORG))&&(r.querySelector("#withinNetworkLabel").innerText=JSUtil.fn.replaceParams(c["Share.Public.MakePublicWithin"],[n]),r.querySelector("#withinNetwork").checked=!0,r.querySelector("#publicInfoMessage").innerText=c["Public.Org.Warning"],r.querySelector("#externalWorld").addEventListener("change",function(){r.querySelector("#publicInfoMessage").innerText=c.MakingThisDocumentPublicMsg}),r.querySelector("#withinNetwork").addEventListener("change",function(){r.querySelector("#publicInfoMessage").innerText=c["Public.Org.Warning"]}))}function g(){var e=t.rID,o=t.version,a=r.querySelector("#allowExport").checked,c=!r.querySelector("#lockFormula").checked;void 0!=n&&-1==d.Meta.HideFeaturesList.indexOf(l.PUBLISH_ORG)&&(i=r.querySelector("#externalWorld").checked?"external":"org"),UserAction.PublishSpreadsheet(e,o,i,a,c,"Make Public",p),t.close()}function p(){P.openDialog()}S.openDialog=function(o){i=o||"external",t||(u=e.UserAction.getTemplate(["PUBLISH_OPTIONS","PUBLISH_TEMPLATE","OK_CANCEL_TEMPLATE"]),S={width:520,title:c["Publish.Spreadsheet"],modal:!0,open:h},(r=a.createElement("div")).Id=s.DI+l.PUBLISH+s.IDENTITY,void 0!=(n=sPlusPlus.data.UserInfo.orgName)&&-1==d.Meta.HideFeaturesList.indexOf(l.PUBLISH_ORG)&&r.appendChild(u.PUBLISH_OPTIONS),r.appendChild(u.PUBLISH_TEMPLATE),r.appendChild(u.OK_CANCEL_TEMPLATE),t=new ZSClass.Dialog(r,S),r.querySelector("#okBtn").addEventListener("click",g),r.querySelector("#clBtn").addEventListener("click",function(){t.close()}));var u,S;var P="org"==o?c["Public.Org.Warning"]:c.MakingThisDocumentPublicMsg;r.querySelector("#publicInfoMessage").innerText=P,t.open()}}(this);
!function(e){var t,o,s=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,n=e.document,a=e.ZSConstants.I18N,l=e.ZSConstants.wCC,r=e.ZSEvents,u=(r.topic,r.Groups,r.Names,s.view.Toolbar.Feature[i.PUBLISH+"_RemovePublish"]);s.view.Toolbar.Feature[i.PUBLISH+"_ViewPublish"];function c(){var e=t.rID,o=t.version,i=s.data.getSharePublishMeta(e).getPublishMeta();UserAction.PublishSpreadsheet(e,o,i.getType(),i.isAllowExport(),i.isShowFormula(),"Remove Public"),t.close()}u.openDialog=function(){var s,r;t||(s=e.UserAction.getTemplate(["REMOVE_PUBLISH_TEMPLATE"]),r={width:520,title:a.RemovePublic},(o=n.createElement("div")).Id=l.DI+i.PUBLISH+"_RemovePublish"+l.IDENTITY,o.appendChild(s.REMOVE_PUBLISH_TEMPLATE),t=new ZSClass.Dialog(o,r),o.querySelector("#removeBtn").addEventListener("click",c),o.querySelector("#dontRemoveBtn").addEventListener("click",function(){t.close()})),t.open()}}(this);
!function(e){var t,o,n,i,r,l,a=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,c=e.document,u=e.ZSConstants.I18N,p=e.ZSConstants.wCC,S=e.UIUtil.Component,d=ZSConstants.CommandConstants,E=ZSConstants.JSKeyCode,P=e.ZSEvents,h=P.topic,L=P.Groups,b=P.Names,T=a.view.Toolbar.Feature[s.PUBLISH+"_ViewPublish"],v=a.view.Toolbar.Feature[s.PUBLISH+"_RemovePublish"],C=e.ZSClass;function m(e){var o=t&&t.getDialog(),n="org"==e?u["Publish.Organization.Notification"]:u["Publish.External.Notification"];l=new C.TBNotification(n,{timeOut:3e4,type:"info",showCloseBtn:!0,parent:o}),o&&l.show()}function A(){var e=a.data.getSharePublishMeta(t.rID).getPublishMeta(),n=void 0==e.isAllowExport()||e.isAllowExport(),i=void 0!=e.isShowFormula()&&e.isShowFormula();if(o.querySelector("#vpAllowExport").checked=n,o.querySelector("#vpLockFormula").checked=!i,o.querySelector("#embedSnipetMsg").innerText=JSUtil.fn.replaceParams(u["Dialog.Publish.EmbedMessage"],[u["Dialog.Publish.Spreadsheet"]]),void 0!=r){o.querySelector("#publishMsg").innerText=JSUtil.fn.replaceParams(u["Share.Public.PublishType"],[u["Dialog.Publish.Spreadsheet"]]);var l=o.querySelector("#pubOption");"external"==e.type?S.zcombo(l,"setValue","external"):S.zcombo(l,"setValue","org")}}function I(){l&&l.remove();var e=o.querySelector("#btnEmbed");U&&function(){var e=o.querySelector("#embedSnipet");U?(e.style.display="none",this.classList.remove("zsbtn-ArrowOpen")):(e.style.display="block",this.classList.add("zsbtn-ArrowOpen"));U=!U}.call(e)}function f(){var e="",t=this.value;"html"==t?e="&mode=html":"print"==t&&(e="&mode=print"),n.href=i+e,n.innerText=i+e}function g(e){var o,n,i=t.rID,r=t.version;e==d.ALLOW_EXPORT?(o="ALLOWEXPORT",n=this.checked):e==d.LOCK_FORMULA&&(o="SHOWFORMULAS",n=!this.checked);var l=a.data.getSharePublishMeta(t.rID).getPublishMeta();UserAction.changePublishOptions(i,r,l.getType(),o,n,"Change Options")}function y(t){var o=e.location.protocol,n=e.location.host,r=a.data.AppRegistry.ctxpath,l=a.view.getActiveGridID(),s=t||a.view.getResourceID(l);i||(i=o+"//"+n+r+"published.do?rid="+s)}T.openDialog=function(){t||(y(),function(){var l=e.UserAction.getTemplate(["CHANGE_PUBLISH_OPTIONS","VIEW_PUBLIC_TEMPLATE","EMBED_SNIPPET_TEMPLATE","EMBED_REVERT_CANCEL_TEMPLATE"]),a=l.EMBED_SNIPPET_TEMPLATE,S=a.querySelector("#embedCode");S.innerText='<iframe width="600" height="400" style="border:1px solid #ccc" frameborder="0" scrolling="no" src="'+i+'&mode=embed"></iframe>';var d={width:620,title:u["Share.ViewPublicURL"],modal:!0,open:A,close:I};(o=c.createElement("div")).Id=p.DI+s.PUBLISH+"_ViewPublish"+p.IDENTITY,void 0!=(r=sPlusPlus.data.UserInfo.orgName)&&(o.appendChild(l.CHANGE_PUBLISH_OPTIONS),o.querySelector("option[value='org']").innerText=JSUtil.fn.replaceParams(u["Share.Public.MakePublicWithin"],[r])),o.appendChild(l.VIEW_PUBLIC_TEMPLATE),o.appendChild(a),o.appendChild(l.EMBED_REVERT_CANCEL_TEMPLATE),n=o.querySelector("#zsPublicUrlLink");var P=o.querySelector("#publicURL"),h={inputToSelect:n,cssClass:"frmSnpt"};new C.CopyToClipboard(P,h).createElement();var L=o.querySelector("#embedSnippetCode"),b={inputToSelect:S,cssClass:"frmSnpt"};new C.CopyToClipboard(L,b).createElement(),(t=new C.Dialog(o,d)).getKeyContext().keyDown[E.SUPER+"+"+E.C]=function(e){return!1},n.href=i,n.innerText=i}(),function(){o.querySelector("#btnRemovePublic").addEventListener("click",_),o.querySelector("#btnCancel").addEventListener("click",function(){t.close()}),o.querySelectorAll("[name=publishTab]").forEach(function(e){e.addEventListener("change",f)});var e=o.querySelector("#vpAllowExport");e.addEventListener("change",g.bind(e,d.ALLOW_EXPORT));var n=o.querySelector("#vpLockFormula");n.addEventListener("change",g.bind(n,d.LOCK_FORMULA));var i=o.querySelector("#pubOption");S.bind(i,"zselectboxchange",function(e,n){if(n.fromUI){var i=t.rID,r=t.version,l=(o.querySelector("#vpAllowExport").checked,o.querySelector("#vpLockFormula").checked,n.previousValue);UserAction.changePublishType(i,r,n.value,l,m)}})}()),t.open()};var U=0;function _(){t.close(),v.openDialog()}function O(){window.open(i,"_blank")}function D(e){h.publish(L.Listener,b.DocAction.TOPBAND_ICONS.ADD,{SPACE:"PUBLIC",TEMPLATE_NAME:"org"==e?"ORG_PUBLISH_ICON":"EXTERNAL_PUBLISH_ICON",CALLBACK:O})}h.register(L.Listener,b.ShareMeta.UPDATE,function(e,t){t&&t[d.PUBLISH]&&t[d.PUBLISH][d.PUBLISH_TYPE]&&(y(e),D(t[d.PUBLISH][d.PUBLISH_TYPE]))},"RID","META"),h.register(L.Listener,b.DocAction.DOCUMENT.PUBLISHED,function(e,t){t&&t.type?(y(),D(t.type)):h.publish(L.Listener,b.DocAction.TOPBAND_ICONS.REMOVE,{SPACE:"PUBLIC"})},"RID","META")}(this);
!function(e){var t,n,a,s,o,i=e.sPlusPlus,l=e.ZSConstants.FeatureConstants,r=e.ZSConstants.wCC,c=ZSConstants.I18N,d=ZSConstants.JSKeyCode,S=i.view.Toolbar.Feature[l.SAVEAS],u=void 0,v=void 0;function g(){t.close()}function p(){var t=i.view.getActiveGridID(),a=i.view.getResourceID(t),l=i.view.getVersionID(t),r=n.value;r&&0!==r.trim().length?(s.className="Zsbtn ZsRt",o.nodeValue=c["Dialog.Button.Saving"]+"...",v.style.display="none",e.UserAction.saveAs(a,l,r)):ZSClass.ZSAlert(c["InvalidMsg.SpreadsheetName"],{title:c["Alert.Title.EnterFileName"]})}S.openDialog=function(S){t||function(i){var c=e.UserAction.getTemplate(["SP_SAVEAS"]).SP_SAVEAS,S=document.createElement("div");S.id=r.DI+l.SAVEAS+r.IDENTITY,S.appendChild(c),(t=new e.ZSClass.Dialog(S,i)).getKeyContext().keyDown[d.ENTER]=function(){p()},s=S.getElementsByTagName("button")[0],v=S.getElementsByTagName("button")[1],s.addEventListener("click",function(){p()}),v.addEventListener("click",g),o=s.childNodes[1],n=S.querySelector("#copiedSpreadsheetName"),S.querySelector("#copiedSpreadsheetLink"),a=S.querySelector(".zssucState"),u=S.querySelector("#saveAsInp")}({modal:!0,width:340,title:c["SaveAs.New.SpreadSheet"],dialogClass:"",close:function(){},open:function(){var e,t,l,r;e=i.view.getActiveGridID(),t=i.view.getResourceID(e),l=i.view.getVersionID(e),r=i.data.getWorkBook(t,l),s.className="Zsbtn",o.nodeValue=c["Dialog.Button.Save"],a.style.display="none",u.style.display="block",v.style.display="block",n.value=JSUtil.fn.replaceParams(c.CopyOfName,new Array(r.Name)),n.select()}}),t.open(),S.preventDefault()},S.closeDialog=g}(this);
!function(e){var t,s,a,l,n,o,i,r,c,u=e.sPlusPlus,S=e.ZSConstants.FeatureConstants,T=e.ZSConstants.wCC,A=e.document,p=e.ZSEvents,v=p.topic,d=p.Groups,m=p.Names,E=e.ZSConstants.I18N,y=ZSClass.Editors,g=e.ZSConstants.JSKeyCode,C=u.view.Toolbar.Feature[S.SAVE_AS_TEMPLATE];function D(t,s){var i=o.value;i&&0!==i.trim().length?(a.className="Zsbtn ZsRt",n.nodeValue=E["Dialog.Button.Saving"]+"...",l.style.display="none",e.UserAction.saveAsTemplate(t,s,i)):ZSClass.ZSAlert(E["InvalidMsg.TemplateName"],{title:E["Alert.Title.EnterTemplateName"]})}v.register(d.Listener,m.UserAction.SaveAsTemplateResponse,function(e,s,a){t.close();var l=UserAction.getTemplate(["STATUS_ALERT"]).STATUS_ALERT;l.querySelector("#msg").innerText=E["SaveAsTemplate.SuccessMsg"];var n=l.querySelector("#fileLink");n.href=u.data.AppRegistry.ctxpath+u.data.AppRegistry.ClientURI+s,n.innerText=e,n.title=e,ZSClass.ZSAlert(l,{type:"success",title:E["Alert.Title.TemplateSaved"],isHtml:!0,buttons:[{text:E.Close}]})},"NEWDOCNAME","NEWDOCRID"),C.openDialog=function(){var p=e.UserAction.getTemplate(["SAVEAS_TEMPLATE"]).SAVEAS_TEMPLATE,v=u.view.getActiveGridID(),d=u.view.getResourceID(v),m=u.view.getVersionID(v),C=(u.view.getSheetID(v),{modal:!0,width:340,title:E["MenuItem.FileTab.SaveAsTemplate"],open:function(){!function(e,t,s){var S;a.className="Zsbtn",n.nodeValue=E["Dialog.Button.Save"],r.style.display="none",c.style.display="block",l.style.display="block",S=function(e,t,s){return u.data.getWorkBook(e,s).Name}(e,0,s),o.value=S,i.select()}(d,0,m)}});t||((s=A.createElement("div")).id=T.DI+S.SAVE_AS_TEMPLATE+T.IDENTITY,s.appendChild(p),t=new e.ZSClass.Dialog(s,C),a=s.querySelector("#saveTemplate"),l=s.querySelector("#cancelTemplate"),a.addEventListener("click",function(){D(d,m)}),l.addEventListener("click",function(){t.close()}),n=a.childNodes[1],i=s.querySelector("#saveAsTemplateName"),s.querySelector("#savedTemplateLink"),s.querySelector("#savedTemplateCalloutLink"),r=s.querySelector(".zssucState"),c=s.querySelector("#saveAsTemplateInp"),function(e,s){t.getKeyContext().keyDown[g.ENTER]=function(){D(e,s)}}(d,m),o=new y.TextAreaEditor(i)),t.open()},C.closeDialog=function(){t.close()}}(this);
!function(e){var t,n,o,a,i,r,s,l=e.sPlusPlus,c=e.ZSConstants.FeatureConstants,d=e.ZSConstants.wCC,u=ZSConstants.I18N,v=ZSClass.Editors,g=l.view.Toolbar.Feature[c.CREATE_FORM];function C(){var e=o.value;if(""===(e=e.trim())||e.length>40)ZSClass.ZSAlert(u["Form.InvalidNameMessage"],{title:u["Alert.Title.InvalidFormName"]});else{var t,n;i.className="Zsbtn ZsRt",r.textContent=u["Dialog.Button.Creating"]+"...",s.style.display="none",t=e.trim(),n=new RegExp("['\"<>#?/%&\\\\]","g"),e=t.replace(n,"-");var c=a.value,d=l.view.getActiveGridID(),v=l.view.getSheetID(d),g=l.view.getResourceID(d),C=l.view.getVersionID(d),m=l.view.getSelectedSheets(d),E=l.data.getWorkBook(g,C).getSheetObj(v).Prop.getName();UserAction.createForm(g,m,C,e,c,E)}}g.openDialog=function(){if(!t){var g={width:540,title:u["FormTab.CreateForm"],open:function(){i.className="Zsbtn",r.textContent=u["Dialog.Button.Create"],s.style.display="",a.value=""}};!function(){var l=e.UserAction.getTemplate(["CREATEFORM"]).CREATEFORM,u=l.querySelector("#formName"),g={keydown:function(e){var n=e.keyCode||e.which;n==ZSConstants.JSKeyCode.ENTER&&(e.stopPropagation(),C(),t.close())}};(o=new v.TextAreaEditor(u)).addListeners(g);var m=l.querySelector("#description");(a=new v.TextAreaEditor(m)).addListeners(g),i=l.querySelector("#createBtn"),r=i.childNodes[1],i.addEventListener("click",function(){C()}),(s=l.querySelector("#cancelBtn")).addEventListener("click",function(){t.close()}),(n=document.createElement("div")).id=d.DI+c.CREATE_FORM+d.IDENTITY,n.appendChild(l)}(),t=new e.ZSClass.Dialog(n,g)}t.open();var m=l.view.getActiveGridID(),E=l.view.getResourceID(m),S=l.view.getVersionID(m),w=l.data.getWorkBook(E,S).Name;w&&w.length>40&&(w=w.substring(0,40)),o.value=w,o.setSelectionRange(0,w.length),o.focus()},g.closeDialog=function(){t&&t.close()}}(this);
!function(e){var t=e.sPlusPlus,o=ZSConstants.CommandConstants,s=e.ZSConstants.FeatureConstants,n=t.view.Toolbar.Feature[s.DELETE_FORM],r=e.ZSConstants.I18N;n.openDialog=function(){var e={buttons:[{text:r.Yes,primary:!0,click:function(){var e=t.view.getActiveGridID(),s=t.view.getResourceID(e),n=t.view.getSheetID(e),r=t.view.getVersionID(e),i=t.data.getWorkBook(s,r).FormSheets[n][o.FORM_RID];UserAction.deleteForm(s,n,r,i)}},{text:r.No}],title:r["Alert.Title.FormDelete"]};ZSClass.ZSAlert(r["Alert.Message.FormDeleteConfirmation"],e)}}(this);
!function(e){var t,n,i,r,s,a,o,l,c,d,u,S,v,g,y,A,I,C,D=e.sPlusPlus,w=e.ZSConstants.FeatureConstants,f=e.ZSConstants.wCC,h=ZSConstants.I18N,p=e.UIUtil.Component,L=D.view.Toolbar.Feature[w.AUDIT_TRAIL],U="AUDIT_TRAIL",q=e.document.createElement("span");function T(e,n,w){w&&function(e,n,w){var f=D.view.actionListManager;f.appendAction(w);var h=!0;y&&(h=!1);y=new ZSClass.UIAuditUser(e,r,f,i,l,h);var p=new Event("change");y.select.dispatchEvent(p);var L=!0;A&&(L=!1);A=new ZSClass.UIAuditSheet(n,a,f,i,d,t,L),new ZSClass.UIAuditDate(s,f,i,c,S,v,g,t),!I&&(I=new ZSClass.UIAuditRange(o,f,i,u,t)),Object.keys(w).length<1e3?C.style.display="none":C.style.display=""}(e,n,w)}q.className="ZsLoader ZsLoaderSmall",L.openDialog=function(y){var A={width:600,title:h.AT,close:function(){var t,n,i,r;t=D.view.getActiveGridID(),n=D.view.getResourceID(t),i=D.view.getSheetID(t),r=D.view.getVersionID(t),e.UserAction.clearActionList(n,i,r),S=p.zdatefield("#from","setAttributes",{value:void 0}),v=p.zdatefield("#to","setAttributes",{value:void 0})},open:function(){r.click(),S=p.zdatefield("#from","getElement"),v=p.zdatefield("#to","getElement"),S.hide(),v.hide()}};if(!t){var I=UserAction.getTemplate([U])[U];(n=document.createElement("div")).id=f.DI+w.AUDIT_TRAIL+f.IDENTITY,t=new ZSClass.Dialog(n,A),function(e){r=e.querySelector("#byUser"),l=e.querySelector("#userList"),s=e.querySelector("#byDate"),c=e.querySelector("#dateList"),g=e.querySelector("#showDetails"),a=e.querySelector("#bySheet"),d=e.querySelector("#sheetList"),o=e.querySelector("#byRange"),u=new ZSClass.Editors.RangeEditor(e.querySelector("#rangePickerDiv")),C=e.querySelector("#thousandEdits"),e.querySelector("#cancelBtn").addEventListener("click",function(){t.close()}),ZSClass.RangePicker.register(u,!0);var n=e.querySelector("#rangePickerIcon");ZSClass.RangePicker.Dialog.register(u,t,n,h.AT),i=e.querySelector("#actionLogContainer")}(I),n.appendChild(I)}t.open(),i.innerHTML="",i.appendChild(q),e.UserAction.getActionList(t.rID,t.version,!0,!0,T)}}(this);
!function(t){var n=ZSClass.UIActionLog;function s(t,n,s,e){this.Tab=t,this.Container=n,this.listManager=s,this.noEditsMsg=e}var e=t.document.createElement("span");function i(t,s){var e=new n;return e.setColorCode(t.cc),e.setName(t.un),e.setTime(t.ts),t.irb&&e.setAsRollBackAction(),e.setMessage(e.processMessage(t)),e.append(s),e}e.classList.add("ZsNoMsg"),s.prototype={place:function(t){t=t||{};var n=Object.keys(t),s=n.length;this.Container.innerHTML="",s||(e.textContent=this.noEditsMsg,this.Container.appendChild(e));for(var a=s-1;a>=0;a--)i(t[n[a]],this.Container)},getTab:function(){return this.Tab},getContainer:function(){return this.Container},getListManager:function(){return this.listManager},getNoEditMsg:function(){return this.noEditsMsg}},ZSClass.UIAudit=s}(this);
!function(e){e.ZSClass.UIAudit;var t=e.UIUtil.Component,n=e.ZSConstants.I18N,s=e.ZSClass.UIActionLog,a=e.document.createElement("span");a.classList.add("ZsNoMsg");var i="selectAll",c="All Users";function o(e,s,a,o,r,l){this.audit=new ZSClass.UIAudit(s,o,a,n["AT.NoEdits.User"]),this.select=r,this.userMap=e,function(e){var n,s=document.createDocumentFragment(),a=Object.keys(e),o=a.length;o>1&&(s=function(e,t){var n=document.createDocumentFragment(),s=document.createElement("option");s.value=e,s.textContent=t;var a=document.createElement("optGroup");return a.setAttribute("mtype","seperator"),n.appendChild(s),n.appendChild(a),n}(n=i,c));for(var r=0;r<o;r++){var l=document.createElement("option");l.value=l.textContent=e[a[r]],s.appendChild(l)}this.select.innerHTML="",this.select.appendChild(s),t.zcombo(this.select,"refresh"),t.zcombo(this.select,"setValue",n||e[a[0]])}.call(this,e),l&&function(){var e=this;t.bind(this.select,"zselectboxchange",function(t){var n=new Event("change");e.select.dispatchEvent(n)}),e.audit.getTab().addEventListener("click",function(t){var n=new Event("change");e.select.dispatchEvent(n)}),this.select.addEventListener("change",function(t){var n=e.audit.getListManager(),s=this.value==i?n.getActionList():n.getByUser(this.value),a=s?Object.keys(s).length:0;a?e.place(s):e.showNoEditMsg()})}.call(this)}function r(e,t){var n=new s;return n.setColorCode(e.cc),n.setName(e.un),n.setTime(e.ts),e.irb&&n.setAsRollBackAction(),n.setMessage(n.processMessage(e)),n.append(t),n}o.prototype={place:function(e){var t=Object.keys(e),n=t.length,s=this.audit.getContainer();s.innerHTML="";for(var a=n-1;a>=0;a--)r(e[t[a]],s)},showNoEditMsg:function(){var e=this.audit.getContainer();e.innerHTML="",this.select.value==i?a.textContent=n["AT.NoEdits.Spreadsheet"]:a.textContent=this.select.value+" "+this.audit.getNoEditMsg(),e.appendChild(a)}},ZSClass.UIAuditUser=o}(this);
!function(t){t.ZSClass.UIAudit;var e=t.UIUtil.Component,i=t.ZSConstants.I18N;var a=ZSConstants.ConditionalFormatClassicOperator,n=["Condition.Today","Condition.Yesterday","Condition.ThisWeek","Condition.LastWeek","Condition.ThisMonth","Condition.LastMonth","Condition.DateOn","Condition.DateBefore","Condition.DateAfter","Condition.Between","Condition.NotBetween"],s=[a.TODAY,a.YESTERDAY,a.THIS_WEEK,a.LAST_WEEK,a.THIS_MONTH,a.LAST_MONTH,a.EQUAL,a.LESS_THAN,a.GREATER_THAN,a.BETWEEN,a.NOT_BETWEEN];function l(t,e,i){t?this.fromDateInput.hide():this.fromDateInput.show(),e?this.toDateInput.hide():this.toDateInput.show(),this.showDetailsBtn.style.display=i}ZSClass.UIAuditDate=function(t,o,c,d,r,u,h,T){this.audit=new ZSClass.UIAudit(t,c,o,i["AT.NoEdits.Date"]),this.select=d,this.fromDateInput=r,this.toDateInput=u,this.showDetailsBtn=h,this.auditTrailDialog=T,function(){for(var t=function(t,e){var i=document.createDocumentFragment(),a=document.createElement("option");a.value=t,a.textContent=e;var n=document.createElement("optGroup");return n.setAttribute("mtype","seperator"),i.appendChild(a),i.appendChild(n),i}("all",i["AT.All"]),a=0;a<n.length;a++){var l=document.createElement("option");l.value=s[a],l.textContent=i[n[a]],t.appendChild(l)}this.select.innerHTML="",this.select.appendChild(t),e.zcombo(this.select,"refresh"),e.zcombo(this.select,"setValue","all")}.call(this),function(){var t=this;e.bind(this.select,"zselectboxchange",function(e){var i=new Event("change");t.select.dispatchEvent(i)}),this.audit.getTab().addEventListener("click",function(e){var i=new Event("change");t.select.dispatchEvent(i)}),this.select.addEventListener("change",function(e){var i=t.audit.getListManager();"all"==this.value?(l.call(t,"none","none","none"),t.audit.place(i.getActionList())):function(t){switch(t){case a.TODAY:case a.YESTERDAY:case a.THIS_WEEK:case a.LAST_WEEK:case a.THIS_MONTH:case a.LAST_MONTH:l.call(this,"none","none","none"),UserAction.AuditFilterByDate(this.auditTrailDialog.rID,this.auditTrailDialog.version,t,void 0,void 0,this.audit.place.bind(this.audit));break;case a.EQUAL:case a.LESS_THAN:case a.GREATER_THAN:l.call(this,"","none","");break;case a.BETWEEN:case a.NOT_BETWEEN:l.call(this,"","","")}}.call(t,~~this.value)}),this.showDetailsBtn.addEventListener("click",function(n){var s,l,o,c,d,r,u,h;switch(t.audit.getListManager(),~~t.select.value){case a.EQUAL:case a.LESS_THAN:case a.GREATER_THAN:if(!(s=e.zdatefield("#from","getValue").dateObject)||!s.getTime())return void ZSClass.ZSAlert(i["AT.Alert.Date"],{title:i["Alert.Title.InvalidDate"]});o=s.getDate(),c=s.getMonth(),d=s.getFullYear(),UserAction.AuditFilterByDate(t.auditTrailDialog.rID,t.auditTrailDialog.version,~~t.select.value,c+1+"/"+o+"/"+d,void 0,t.audit.place.bind(t.audit));break;case a.BETWEEN:case a.NOT_BETWEEN:if(s=e.zdatefield("#from","getValue").dateObject,l=e.zdatefield("#to","getValue").dateObject,!s||!s.getTime()||!l||!l.getTime()||s>l||(s&&s.getTime())>(l&&l.getTime()))return void ZSClass.ZSAlert(i["AT.Alert.Date"],{title:i["Alert.Title.InvalidDate"]});o=s.getDate(),c=s.getMonth(),d=s.getFullYear(),r=l.getDate(),u=l.getMonth(),h=l.getFullYear(),UserAction.AuditFilterByDate(t.auditTrailDialog.rID,t.auditTrailDialog.version,~~t.select.value,c+1+"/"+o+"/"+d,u+1+"/"+r+"/"+h,t.audit.place.bind(t.audit))}})}.call(this)}}(this);
!function(t){t.ZSClass.UIAudit,t.UIUtil.Component;var i=t.ZSConstants.I18N,e=t.JSUtil.REGEXP,a=t.document.createElement("span");function n(t,a,n,s,o){this.audit=new ZSClass.UIAudit(t,n,a,i["AT.NoEdits.Range"]),this.rangePickerEditor=s,this.auditTrailDialog=o,function(){var t=this;t.audit.getTab().addEventListener("click",function(i){t.rangePickerEditor.focus(),t.audit.place()});var i=!0,a={valueChanged:function(a){i&&(i=!1,setTimeout(function(){e.rangeRegex.test(t.rangePickerEditor.value)&&t.filterByRange(t.rangePickerEditor.value),i=!0},500))}};this.rangePickerEditor.addListeners(a),this.rangePickerEditor.customPreventDefault=r}.call(this)}function r(t){if((t.keyCode||t.which)==ZSConstants.JSKeyCode.ENTER)return t.preventDefault(),!0}a.className="ZsLoader ZsLoaderSmall",n.prototype.filterByRange=function(t){var i=this.audit.getContainer();i.innerHTML="",i.appendChild(a),UserAction.AuditFilterByRange(this.auditTrailDialog.rID,this.auditTrailDialog.version,t,this.audit.place.bind(this.audit))},ZSClass.UIAuditRange=n}(this);
!function(t){t.ZSClass.UIAudit;var e=t.UIUtil.Component,i=t.ZSConstants.I18N,n=t.document.createElement("span");function a(t,n,a,s,o,c,r){this.audit=new ZSClass.UIAudit(n,s,a,i["AT.NoEdits.Sheet"]),this.select=o,this.auditTrailDialog=c,this.sheetMap=t,function(t){var n,a=document.createDocumentFragment(),s=Object.keys(t),o=s.length;o>=1&&(a=function(t,e){var i=document.createDocumentFragment(),n=document.createElement("option");n.value=t,n.textContent=e;var a=document.createElement("optGroup");return a.setAttribute("mtype","seperator"),i.appendChild(n),i.appendChild(a),i}(n="workbook",i["CFormat.WholeDocument"]));for(var c=0;c<o;c++){var r=document.createElement("option");r.value=r.textContent=t[s[c]],a.appendChild(r)}this.select.innerHTML="",this.select.appendChild(a),e.zcombo(this.select,"refresh"),e.zcombo(this.select,"setValue",n||t[s[0]])}.call(this,t),r&&function(){var t=this;e.bind(t.select,"zselectboxchange",function(e){var i=new Event("change");t.select.dispatchEvent(i)}),t.audit.getTab().addEventListener("click",function(e){var i=new Event("change");t.select.dispatchEvent(i)}),this.select.addEventListener("change",function(e){var i=t.audit.getListManager();"workbook"==this.value?t.audit.place(i.getActionList()):t.filterBySheet(this.value)})}.call(this)}n.className="ZsLoader ZsLoaderSmall",a.prototype.filterBySheet=function(t){this.audit.Container.innerHTML="",this.audit.Container.appendChild(n),UserAction.AuditFilterBySheet(this.auditTrailDialog.rID,this.auditTrailDialog.version,t,this.audit.place.bind(this.audit))},ZSClass.UIAuditSheet=a}(this);
!function(e){var t,n,i,o,s,r=e.sPlusPlus,c=e.ZSConstants.FeatureConstants,a=e.ZSConstants.I18N,l=e.document,u=e.ZSConstants.wCC,v=ZSClass.Editors;function d(e){switch(e.keyCode||e.which){case 13:o.click();break;case 27:s.click()}}r.view.Toolbar.Feature[c.RENAME_VERSION].openDialog=function(E){var S={modal:!0,width:360,title:a["AT.Version.Mark"],close:function(){},open:function(){}};t||(function(){var E=e.UserAction.getTemplate(["RENAME_VERSION"]).RENAME_VERSION,S=E.querySelector("#versionName");i=new v.TextAreaEditor(S),(o=E.querySelector("#createBtn")).addEventListener("click",function(){!function(){var e=i.value;if(""!==(e=e.trim())){var t=r.view.getActiveGridID(),n=r.view.getResourceID(t),o=r.view.getVersionID(t);UserAction.renameVersion(n,o,e,function(){r.view.getVersionState(t).getActiveVersionLog().setDescription(e)})}else ZSClass.ZSAlert(a.Namecannotbeempty,{title:a["Alert.Title.EnterName"]})}(),t.close()}),(s=E.querySelector("#cancelBtn")).addEventListener("click",function(){t.close()}),i.addListeners({keydown:d}),(n=l.createElement("div")).id=u.DI+c.RENAME_VERSION+u.IDENTITY,n.appendChild(E)}(),t=new e.ZSClass.Dialog(n,S)),t.open();var g=r.view.getActiveGridID(),w=r.view.getVersionState(g).getActiveVersionLog().getVersionName();i.value=w,i.focus()}}(this);
!function(e){var t,n,i,o=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,r=e.ZSConstants.I18N,a=e.document,c=e.ZSConstants.wCC,l=e.ZSEvents,v=l.topic,u=l.Groups,E=l.Names;o.view.Toolbar.Feature[s.REVERT_VERSION].openDialog=function(l){var R,V={modal:!0,width:390,title:r["Version.RevertVersion"],close:function(){},open:function(){}};t||(R=e.UserAction.getTemplate(["REVERT_VERSION"]).REVERT_VERSION,i=R.querySelector("#message"),R.querySelector("#okBtn").addEventListener("click",function(){!function(){var t=o.view.getActiveGridID(),n=o.view.getResourceID(t),i=o.view.getVersionID(t);v.publish(u.Listener,E.UserAction.REVERT_VERSION);var s=r["Version.RevertingMessage"],a=new e.ZSClass.TBNotification(s,{mode:"STD",type:"info"});a&&a.show(!0),UserAction.revertVersion(n,i,a)}(),t.close()}),R.querySelector("#cancelBtn").addEventListener("click",function(){t.close()}),(n=a.createElement("div")).id=c.DI+s.REVERT_VERSION+c.IDENTITY,n.appendChild(R),t=new e.ZSClass.Dialog(n,V));var S=o.view.getActiveGridID(),d=o.view.getVersionState(S).getVersionNumber(),I=JSUtil.fn.replaceParams(r["AT.RevertVersion.Alert"],["#"+parseFloat(d)]);i.innerText=I,t.open()}}(this);
!function(e){var t,n,i,o=e.sPlusPlus,r=e.ZSConstants.FeatureConstants,s=e.ZSConstants.I18N,a=e.document,c=e.ZSConstants.wCC;o.view.Toolbar.Feature[r.DELETE_VERSION].openDialog=function(l){var v,E={modal:!0,width:390,title:s["Version.DeleteVersion"],close:function(){},open:function(){}};t||(v=e.UserAction.getTemplate(["DELETE_VERSION"]).DELETE_VERSION,i=v.querySelector("#message"),v.querySelector("#okBtn").addEventListener("click",function(){var e,n,i;e=o.view.getActiveGridID(),n=o.view.getResourceID(e),i=o.view.getVersionID(e),UserAction.deleteVersion(n,i,function(){var t=o.view.getVersionState(e),n=t.getActiveVersionLog(),i=n.getVersionNumber();n.remove();var r,s=t.getVersionLogMap();for(var a in delete s[i],s){r=s[a];break}r&&r.dom.click()}),t.close()}),v.querySelector("#cancelBtn").addEventListener("click",function(){t.close()}),(n=a.createElement("div")).id=c.DI+r.DELETE_VERSION+c.IDENTITY,n.appendChild(v),t=new e.ZSClass.Dialog(n,E));var u=o.view.getActiveGridID(),d=o.view.getVersionState(u).getVersionNumber(),g=JSUtil.fn.replaceParams(s["AT.DeleteVersion.Alert"],["#"+parseFloat(d)]);i.innerText=g,t.open()}}(this);
!function(t){var e,n,o=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,a=t.ZSConstants.wCC,i=o.view.Toolbar.Feature[s.EXPORT],l=t.document;i.openDialog=function(){if(!e){var t=UserAction.getTemplate(["passwordprotected"]).passwordprotected;(n=l.createElement("div")).id=a.DI+s.AUDIT_TRAIL+a.IDENTITY,e=new ZSClass.Dialog(n,{width:400,title:"Apply Password",close:function(){},open:function(){}}),n.appendChild(t)}e.open()}}(this);
!function(e){var t,s,n,o,a,i,l,r,c=e.sPlusPlus,d=e.ZSConstants.FeatureConstants,u=ZSConstants.I18N,E=e.ZSEvents,S=E.topic,v=E.Groups,y=E.Names;function C(){var s=n.value;if(s){o.className="Zsbtn ZsRt",i.nodeValue=u["Dialog.Button.Creating"]+"...",a.style.display="none";var l=c.view.getActiveGridID(),r=c.view.getResourceID(l),d=c.view.getVersionID(l);e.UserAction.CreateVersion(r,d,s),t.close()}else ZSClass.ZSAlert(u.Namecannotbeempty,{title:u["Alert.Title.EnterName"]})}c.view.Toolbar.Feature[d.CREATE_VERSION].openDialog=function(){var c=e.UserAction.getTemplate(["SP_CREATEVERSION"]).SP_CREATEVERSION,d={modal:!0,width:360,title:u["VersionDialog.CreateVersion"],dialogClass:"",open:function(){s.querySelector("#cv_versionLabel").value="",o.className="Zsbtn",i.nodeValue=u["Dialog.Button.Create"],a.style.display="block",l.style.display="block",r.style.display="none"}};if(!t){(s=document.createElement("div")).id="DI_CREATEVERSION",s.appendChild(c);var E=s.querySelector("#cv_versionLabel"),S={keydown:function(e){(e.keyCode||e.which)==ZSConstants.JSKeyCode.ENTER&&(e.stopPropagation(),C())}};(n=new e.ZSClass.Editors.TextAreaEditor(E)).addListeners(S),o=s.querySelector("#cv_createBtn"),a=s.querySelector("#cv_cancelBtn"),o.addEventListener("click",C),a.addEventListener("click",function(){t.close()}),i=o.childNodes[1],l=s.querySelector("#createVersionInp"),r=s.querySelector(".zssucState"),t=new e.ZSClass.Dialog(s,d)}t.open(),n.focus()},S.register(v.Listener,y.UserAction.CreateVersionResponse,function(e,t,s){l.style.display="none",r.style.display="block"},"VERSION_NAME","RID","VERSION")}(this);
!function(e){var t,i,o,r,n,a,l,c,s,u,S,P=e.sPlusPlus,d=e.ZSConstants.FeatureConstants,E=e.ZSConstants.wCC,I=ZSConstants.I18N,v=e.ZSEvents,p=v.topic,h=v.Groups,g=v.Names,m=ZSConstants.CommandConstants,T=e.UIUtil.Component,b=P.view.Toolbar.Feature[d.PUBLISH_FORM],L=P.data.AppRegistry.FORM_SERVER_URL,_="/published.do?rid=",D={ORG:1,PUBLIC:2},C=e.JSUtil;function f(){M(),p.unregister(h.Listener,g.DocAction.FORM_SHEETS.MODIFY,f)}function R(){(t=D.ORG,void 0!=r)&&(o.querySelector("#withinNetworkLabel").innerText=C.fn.replaceParams(I["Share.Public.MakePublicWithin"],[r]),o.querySelector("#withinNetwork").checked=!0,o.querySelector("#publicInfoMessage").innerText=C.fn.replaceParams(I["Form.Public.Org.Warning.WithDomain"],[r]),o.querySelector("#externalWorld").addEventListener("change",function(){t=D.PUBLIC,o.querySelector("#publicInfoMessage").innerText=I["FormTab.Dialog.LinkExternalDataMsg"]}),o.querySelector("#withinNetwork").addEventListener("change",function(){t=D.ORG,o.querySelector("#publicInfoMessage").innerText=C.fn.replaceParams(I["Form.Public.Org.Warning.WithDomain"],[r])}))}function M(){var i=P.view.getActiveGridID(),o=P.view.getSheetID(i),v=P.view.getResourceID(i),p=P.view.getVersionID(i),h=P.data.getWorkBook(v,p).FormSheets[o][m.FORM_RID];if(!u){var g={width:540,title:I["Share.ViewPublicURL"],close:function(){w&&w.remove()},open:function(){}};!function(){var i=e.UserAction.getTemplate(["CHANGE_PUBLISH_OPTIONS","VIEW_PUBLISH_URL","EMBED_SNIPPET_TEMPLATE","EMBED_REVERT_CANCEL_TEMPLATE"]),o=i.CHANGE_PUBLISH_OPTIONS,a=i.VIEW_PUBLISH_URL,v=i.EMBED_SNIPPET_TEMPLATE,p=i.EMBED_REVERT_CANCEL_TEMPLATE;n=a.querySelector("#zsPublicUrlLink"),l=v.querySelector("#embedCode"),c='<iframe width="600" height="400" style="border:1px solid #ccc" frameborder="0" scrolling="no" src="',s='"></iframe>';var h=a.querySelector("#publicURL"),g={inputToSelect:n,cssClass:"frmSnpt"};new ZSClass.CopyToClipboard(h,g).createElement();var b=v.querySelector("#embedSnippetCode"),L={inputToSelect:l,cssClass:"frmSnpt"};if(new ZSClass.CopyToClipboard(b,L).createElement(),p.querySelector("#btnCancel").addEventListener("click",function(){u.close()}),p.querySelector("#btnRemovePublic").addEventListener("click",function(){F(),u.close()}),(S=document.createElement("div")).id=E.DI+d.PUBLISH_FORM+"_VIEW_PUBLISH_URL"+E.IDENTITY,void 0!=(r=P.data.UserInfo.orgName)){S.appendChild(o);var _=t==D.PUBLIC?I["Share.Public.MakePublicToExternal"]:C.fn.replaceParams(I["Share.Public.MakePublicWithin"],[r]);S.querySelector("#publishMsg").innerText=C.fn.replaceParams(I["Share.Public.PublishType"],[I["Dialog.Publish.Form"]])+" "+_}S.appendChild(a),S.appendChild(v),S.appendChild(p),S.querySelector("#embedSnipetMsg").innerText=C.fn.replaceParams(I["Dialog.Publish.EmbedMessage"],[I["Dialog.Publish.Form"]]);var f=S.querySelector("#pubOption");T.bind(f,"zselectboxchange",function(e,i){t="external"==i.value?D.PUBLIC:D.ORG;var o=P.view.getActiveGridID(),r=P.view.getSheetID(o),n=P.view.getResourceID(o),a=P.view.getVersionID(o),l=P.data.getWorkBook(n,a),c=l.FormSheets[r],s=c[m.FORM_RID];UserAction.publishForm(n,r,a,s,t,!0,B)})}(),u=new e.ZSClass.Dialog(S,g)}i=P.view.getActiveGridID(),v=P.view.getResourceID(i),o=P.view.getSheetID(i),p=P.view.getVersionID(i);var b=P.data.getWorkBook(v,p).FormSheets[o];if(t=b[m.FORM_PUBLISH_TYPE],u.open(),void 0!=r){S.querySelector("option[value='org']").innerText=C.fn.replaceParams(I["Share.Public.MakePublicWithin"],[r]);var f=S.querySelector("#pubOption");t==D.PUBLIC?T.zcombo(f,"setValue","external"):T.zcombo(f,"setValue","org"),S.querySelector("#publishMsg").innerText=C.fn.replaceParams(I["Share.Public.PublishType"],[I["Dialog.Publish.Form"]])}var R=L+_+h;n.href=R,n.text=R,a=c+R+s,l.textContent=a}var w,U,O;function B(e){var t=u&&u.getDialog(),i=1==e?I["Publish.Organization.Notification"]:I["Publish.External.Notification"];w=new ZSClass.TBNotification(i,{type:"info",timeOut:3e4,showCloseBtn:!0,parent:t}),t&&w.show()}function F(t){if(!U){var i={width:540,title:I.RemovePublic,close:function(){},open:function(){}};(o=e.UserAction.getTemplate(["REMOVE_PUBLISH_TEMPLATE"]).REMOVE_PUBLISH_TEMPLATE).querySelector(".publishWarning").textContent=I["FormTab.Dialog.RemovePublicMsg"],o.querySelector("#removeBtn").addEventListener("click",function(){var e,t,i,o,r,n,a;e=P.view.getActiveGridID(),t=P.view.getSheetID(e),i=P.view.getResourceID(e),o=P.view.getVersionID(e),r=P.data.getWorkBook(i,o).FormSheets[t],n=r[m.FORM_RID],a=r[m.FORM_PUBLISH_TYPE],UserAction.publishForm(i,t,o,n,a,!1),U.close()}),o.querySelector("#dontRemoveBtn").addEventListener("click",function(){U.close()}),(O=document.createElement("div")).id=E.DI+d.PUBLISH_FORM+"_REMOVE_PUBLIC"+E.IDENTITY,O.appendChild(o),U=new e.ZSClass.Dialog(O,i)}var o;U.open()}b.showPublishDialog=function(){if(!i){var n={width:540,title:I["Publish.Form"],close:function(){},open:R};(a=e.UserAction.getTemplate(["PUBLISH_OPTIONS","FORM_PUBLISH_TEMPLATE","OK_CANCEL_TEMPLATE"])).PUBLISH_OPTIONS,l=a.FORM_PUBLISH_TEMPLATE,(c=a.OK_CANCEL_TEMPLATE).querySelector("#okBtn").addEventListener("click",function(){var e=P.view.getActiveGridID(),o=P.view.getSheetID(e),r=P.view.getResourceID(e),n=P.view.getVersionID(e),a=P.data.getWorkBook(r,n).FormSheets[o][m.FORM_RID];UserAction.publishForm(r,o,n,a,t,!0),p.register(h.Listener,g.DocAction.FORM_SHEETS.MODIFY,f),i.close()}),c.querySelector("#clBtn").addEventListener("click",function(){i.close()}),(o=document.createElement("div")).id=E.DI+d.PUBLISH_FORM+E.IDENTITY,void 0!=(r=sPlusPlus.data.UserInfo.orgName)&&o.appendChild(a.PUBLISH_OPTIONS),o.appendChild(l),o.appendChild(c),i=new e.ZSClass.Dialog(o,n)}var a,l,c;i.open()},b.showPublishedUrl=M,b.showRemovePublishDialog=F}(this);
!function(e){var t,r,i,n,c,a,o,s,l,d,u,v,M,g,m,A,E,C,S,p,y,R,f,L,T,I,N,D,w,h=e.sPlusPlus,k=e.ZSConstants.FeatureConstants,O=e.document,q=e.ZSConstants.I18N,Z=e.ZSConstants.wCC,_=e.UserAction,b=(e.UIUtil.Component,e.ZSEC),x=e.ZSEvents,F=x.topic,P=x.Groups,U=x.Names,B=ZSClass.Editors,G=[],H={},V=h.data.AppRegistry.MACRO,W=h.view.Toolbar.Feature[k.CREATE_MACRO],Y=h.view.Toolbar.Feature[k.RECORD_MACRO],j=h.view.Toolbar.Feature[k.MACRO_STOP_RECORDING],z=h.view.Toolbar.Feature[k.DELUGE],$=Y.RecordingObj||(Y.RecordingObj={});function J(){Y.isRecording=!1,$.rr=C.checked,m.innerText=q["Macro.Player.Stopping"];var e=h.view.getActiveGridID(),t=(h.view.getSheetID(e),h.view.getResourceID(e)),r=h.view.getVersionID(e);_.stopRecordingMacro(t,r,$,K)}function K(e){$={},M.isAlive()&&Q(!1)}function Q(e){e?(m.innerText=q["Macro.Player.RecordingMacro"],m.classList.remove("mcrRecNoANi"),A.style.display="",E.style.display="none",C.checked=$.rr):(m.innerText=q["Macro.Player.RecordSuccessfully"],m.classList.add("mcrRecNoANi"),A.style.display="none",E.style.display="")}function X(r){if("Error.Macro.Name"==r.mk)ZSClass.ZSAlert(q["Error.Macro.Name"],{title:q["Alert.Title.MacroNameExists"]});else{var i=d.value;H.assignMacro&&H.callback("Macros",i),t.close();var n=O.createElement("div");n.classList.add("mcrRecCls");var c={width:240,title:n,maskToolbar:!1,top:100,left:window.innerWidth-240-25,closeOnEsc:!1,isClosable:!1,close:function(){Y.isRecording=!1},open:function(){Q(!0)}};M||(!function(e){var t=_.getTemplate(["MacroRecordingPlayer"]).MacroRecordingPlayer,r=t.querySelector("#stopRecording"),i=t.querySelector("#unsupportedActions");m=t.querySelector(".mcrRecTxt"),E=t.querySelector("#viewCode"),A=t.querySelector("#recordingPart"),C=t.querySelector("#isRelativeRef");var n=t.querySelector("#openVBAEditor"),c=t.querySelector("#openMacroList");r.addEventListener("click",function(){J()}),i.addEventListener("click",function(){window.open(V.UNSUPPORTED_ACTIONS,"_blank")}),n.addEventListener("click",function(){M.close(),F.publish(P.UserAction,U.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:"Macros",macName:d.value,refetchFromServer:!0})}),c.addEventListener("click",function(){M.close(),F.publish(P.UserAction,U.UserAction.MACRO.VIEW_MACRO)}),e.addEventListener("click",function(){M.close()}),C.addEventListener("change",function(){$.rr=C.checked}),(g=document.createElement("div")).id=Z.DI+k.CREATE_MACRO+Z.IDENTITY,g.appendChild(t)}(n),M=new e.ZSClass.Dialog(g,c),g.parentElement.classList.add("mcrRec")),M.open()}}function ee(e){if(oe(!1),"Error.Macro.Name"==e.mk)ZSClass.ZSAlert(q["Error.Macro.Name"],{title:q["Alert.Title.MacroNameExists"]});else{var r=d.value;H.assignMacro&&H.callback("Macros",r),t.close(),F.publish(P.UserAction,U.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:"Macros",macName:r,refetchFromServer:!0})}}function te(e,t,r,i){H.assignMacro=!0,H.rid=e,H.sheetID=t,H.version=r,H.callback=i}function re(e,t){if(f.style.display="none",y.innerHTML="",t?I=e:N=e,e.length>0)for(var r in e){var i=e[r],n=i[0],c=i[1],a=document.createElement("li");a.textContent=c,a.setAttribute("data-macrotype",n),a.addEventListener("click",ie.bind(null,a)),y.appendChild(a),G.push(c),p.innerText==c&&ie(a)}else{if(!L){var o=_.getTemplate(["EMPTY_MACRO_LIST"]).EMPTY_MACRO_LIST;L=o.querySelector("#noMacros")}y.appendChild(L)}}function ie(e){T&&T.classList.remove("active"),e.classList.add("active"),T=e}function ne(e,t,r,i,n){f.style.display="",_.getMacroList(e,t,r,i)}function ce(i){var n={width:540,title:q["Macro.CreateMacro"],modal:!0,close:function(){H={}},open:function(){d.value="",u.value="",oe(!1),v.focus()}};t||(!function(){var e=_.getTemplate(["createMacro"]).createMacro;v=e.querySelector("#macroName"),d=new B.TextAreaEditor(v);var i=e.querySelector("#macroDescription");u=new B.TextAreaEditor(i),c=e.querySelector("#createBtn"),a=e.querySelector("#recordBtn");var n=e.querySelector("#cancelBtn"),M=e.querySelector("#isRelativeReference");o=e.querySelector("#relativeReferenceDiv"),s=e.querySelector("#recordPlay"),l=e.querySelector("#writeCode"),v.addEventListener("keydown",function(e){13==e.keyCode&&(""==c.style.display?c.click():a.click())}),c.addEventListener("click",function(){!function(e,t){if(se(e=e.trim())){oe(!0);var r=h.view.getActiveGridID(),i=H.assignMacro?H.rid:h.view.getResourceID(r),n=H.assignMacro?H.version:h.view.getVersionID(r);_.createMacro(i,n,e,t,ee)}}(d.value,u.value)}),a.addEventListener("click",function(){!function(e,t,r){if(se(e)){Y.isRecording=!0;var i=h.view.getActiveGridID(),n=H.assignMacro?H.sheetID:h.view.getSheetID(i),c=H.assignMacro?H.rid:h.view.getResourceID(i),a=H.assignMacro?H.version:h.view.getVersionID(i),o=h.data.getWorkBook(c,a),s=h.view.getSheetState(i,n),l=s.getActiveRange(),d=s.getActiveRow(),u=s.getActiveCol(),v=h.view.getSelectedSheets(i);r=r,($={}).sr=l.startRow,$.sc=l.startCol,$.er=l.endRow,$.ec=l.endCol,$.r=d,$.c=u,$.sn=o.getSheetObj(n).Prop.getName(),$.mn=e,$.rr=r,$.des=encodeURIComponent(t),$.actionIds=[],_.recordMacro(c,n,a,e,t,v,l,d,u,r,X)}}(d.value,u.value,M.checked)}),n.addEventListener("click",function(){t.close()}),s.addEventListener("click",function(){ae(!0)}),l.addEventListener("click",function(){ae(!1)}),(r=document.createElement("div")).id=Z.DI+k.CREATE_MACRO+Z.IDENTITY,r.appendChild(e)}(),t=new e.ZSClass.Dialog(r,n)),ae(i),t.open()}function ae(e){a.style.display=e?"":"none",c.style.display=e?"none":"",o.style.display=e?"":"none",s.checked=e,l.checked=!e}function oe(e){if(e){c.classList.add("ZsRt"),c.textContent=q["Macro.Creating"],c.disabled=!0;var t=document.createElement("span");c.appendChild(t)}else c.classList.remove("ZsRt"),c.textContent=q["Macro.Create"],c.disabled=!1}function se(e,t){var r={title:q["Macro.ErrorMsg.Title"]};if(t&&(r.title=q["Alert.Title.InvalidFunctionName"]),""==e.trim())return r.title=q["Alert.Title.EnterMacroName"],ZSClass.ZSAlert(q["Macros.MacroNameCannotBeEmpty"],r),!1;var i=function(e){var t=new RegExp("[\\u00A1-\\uFFFF]+");return t.test(e)?3:(t=new RegExp("^[a-zA-Z0-9_]+$")).test(e)?(t=new RegExp("^[a-zA-Z][a-zA-Z0-9_]*$")).test(e)?0:2:1}(e);if(r.title=t?q["Alert.Title.InvalidFunctionName"]:q["Alert.Title.InvalidMacroName"],i>0){if(1==i){var n=t?q["Deluge.NameCannotContainMsg"]:q["Macros.MacroNameCannotContainMsg"];ZSClass.ZSAlert(n,r)}else if(2==i){n=t?q["Deluge.NameStartWithMsg"]:q["Macros.MacroNameStartWithMsg"];ZSClass.ZSAlert(n,r)}else{n=t?q["Deluge.NameInEnglish"]:q["Macros.MacroNameInEnglish"];ZSClass.ZSAlert(n,r)}return!1}return!0}_.CreateAndAssignMacro=function(e,t,r,i){te(e,t,r,i),ce(!1)},_.RecordAndAssignMacro=function(e,t,r,i){te(e,t,r,i),ce(!0)},_.assignExistingMacro=function(t,r,c,a,o){te(t,r,c,o),i||function(){var t=_.getTemplate(["ASSIGN_MACRO"]).ASSIGN_MACRO,r=t.querySelector("#assignMacroContainer");w=t.querySelector("#viewMacroList"),D=t.querySelector("#viewDelugeList"),t.querySelector("manageMacroList");var c=t.querySelector("#writeMacro"),a=t.querySelector("#recordMacro");S=t.querySelector("#currentlyAssigned"),p=S.querySelector("#macName");var o=S.querySelector("#edit");f=t.querySelector(".ZsLoader");var s=t.querySelector("#assign"),l=t.querySelector("#cancel");s.addEventListener("click",function(){if(T){var e=T.dataset.macrotype;R(e,b.Encoder.encodeForJavaScript(T.innerHTML)),i.close()}}),l.addEventListener("click",function(){i.close()}),D.addEventListener("click",function(){w.classList.remove("active"),D.classList.add("active"),manageMacroList.innerHTML="",re(""==I||null==I||void 0===I?I=z.getDelugeFunctionNameList():I,!0)}),w.addEventListener("click",function(){D.classList.remove("active"),w.classList.add("active"),manageMacroList.innerHTML="",(N=null==N||void 0===N)?ne(H.rid,H.version,[H.sheetID],re):re(N,!1)}),o.addEventListener("click",function(){var e=p.dataset.macrotype,t=p.innerHTML;"Deluge"==e?z.editMacro(t,!0):(i.close(),F.publish(P.UserAction,U.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:e,macName:t}))}),c.addEventListener("click",function(){i.close(),ce(!1)}),a.addEventListener("click",function(){i.close(),ce(!0)}),y=t.querySelector(".asgnMcrList");var d={width:540,title:q["Button.ActionBar.AssignMacro"],modal:!0,close:function(){y.innerHTML="",!1,T=void 0,p.innerHTML="",S.style.display="none",G=[],N="",I="",D.classList.add("active"),D.classList.remove("active"),w.classList.add("active"),w.classList.remove("active")},open:function(){ne(H.rid,H.version,[H.sheetID],re),w.classList.add("active")}};(n=document.createElement("div")).id=Z.DI+k.CREATE_MACRO+Z.IDENTITY,n.appendChild(r),i=new e.ZSClass.Dialog(n,d)}(),R=o,i.open();var s=a.getScript();if(s){var l=s.getModule(),d=s.getMacroName();"undefined"!==d?(p.innerText=d,p.setAttribute("data-macrotype",b.Encoder.encodeForHTMLAttribute(l)),!0,S.style.display=""):S.style.display="none"}},_.isValidMacroName=se,W.openDialog=ce,Y.openDialog=ce,j.execute=J,F.register(P.Listener,U.DocMeta.ACTION_IDENTIFIER,function(e){Y.isRecording&&$.actionIds.push(e)},"xaid"),F.register(P.UserAction,U.UserAction.MACRO.CREATE_MACRO,ce,"isFromRecordMacro")}(this);
!function(e){var t,n,i,o,r,c,s,a=e.sPlusPlus,l=e.ZSConstants.FeatureConstants,u=(e.document,e.ZSConstants.I18N),d=e.ZSConstants.wCC,v=e.UserAction,g=e.ZSEvents,S=g.topic,m=g.Groups,w=g.Names,L=(ZSClass.Editors,e.UIUtil.Component,a.view.Toolbar.Feature[l.DELUGE_EDITOR]),C=a.view.Toolbar.Feature[l.RUN_MACRO],D=new ZSClass.TBNotification("Running...",{mode:"STD",type:"info"});function y(e){o.style.display=e?"":"none"}function I(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),n=a.view.getVersionID(e);v.delugeGetFunctionName(t,n,1235,M)}function M(e,t){t?s=e:c=e,y(!1);var n=v.getTemplate(["runMacroRecords"]).runMacroRecords.querySelector("#runMacroRecord");if(e.length>0){r.style.display="none";for(var o=0;o<e.length;o++){var a=e[o],l=n.cloneNode();l.innerText=a[1],l.title=a[1],l.addEventListener("click",f.bind(null,e[o][0],e[o][1])),i.appendChild(l)}}else r.style.display=""}function f(e,n){t&&t.close(),D.show();var i=a.view.getActiveGridID(),o=a.view.getSheetID(i),r=a.view.getResourceID(i),c=a.view.getVersionID(i),s=a.data.getWorkBook(r,c).SheetList.getById(o).getName(),l=a.view.getSheetState(i,o).getActiveRange(),u=a.view.getSelectedSheets(i);"Deluge"==e?L.runMacro(n):v.runMacro(r,o,c,e,n,u,s,l,p)}function p(t,n,i,o,r){D.remove(),o&&r&&e.UserAction.ScrollCellIntoView(t,n,i,o,r)}C.openDialog=function(){var g={width:540,dialogClass:"runMcr",title:u["Macro.RunMacro"],modal:!0,close:function(){i.innerHTML="",r.style.display="none",c=null,s=null},open:function(){var e,t,n,i;y(!0),e=a.view.getActiveGridID(),t=a.view.getResourceID(e),n=a.view.getVersionID(e),i=a.view.getSelectedSheets(e),v.getMacroList(t,n,i,M)}};t||(function(){var e=v.getTemplate(["macroList"]).macroList,a=e.querySelector("#macroListContainer");i=e.querySelector("#macroListTable"),o=e.querySelector(".ZsLoaderSmall"),r=e.querySelector(".ZsNoMsg");var u=e.querySelector("#viewMacroList"),g=e.querySelector("#viewDelugeList");g.addEventListener("click",function(){y(!0),u.classList.remove("active"),g.classList.add("active"),i.innerHTML="",null==s||void 0===s?(y(!0),I()):M(s)}),u.addEventListener("click",function(){y(!0),g.classList.remove("active"),u.classList.add("active"),i.innerHTML="",null==c||void 0===c?(y(!0),I()):M(c)}),e.querySelector("#cancelBtn").addEventListener("click",function(){t.close()}),(n=document.createElement("div")).id=d.DI+l.CREATE_MACRO+d.IDENTITY,n.appendChild(a)}(),t=new e.ZSClass.Dialog(n,g)),t.open()},S.register(m.UserAction,w.UserAction.MACRO.RUN_MACRO,f,"modName","macName")}(this);
!function(e){var t,n,i,r,o,a,c,l,s,d,u,v,g,p,E=e.sPlusPlus,S=e.ZSConstants.FeatureConstants,m=(e.document,e.ZSConstants.I18N),D=e.ZSConstants.wCC,y=e.UserAction,M=e.JSUtil,C=(e.ZSConstants.JSKeyCode,e.ZSEvents),A=C.topic,L=C.Groups,f=C.Names,N=(ZSClass.Editors,E.view.Toolbar.Feature[S.MANAGE_MACRO]),T=E.view.Toolbar.Feature[S.CREATE_MACRO],R=E.view.Toolbar.Feature[S.DELUGE],h=!1,I="ERRORBANNER";function w(g){var p=m["Deluge.ManageDialog.Title"],M=m["VBAMacros.Title"];t=1==g;var C,N,T={width:540,title:m["Macro.ViewMacros"],modal:!0,close:function(){v.style.display="none",a.innerHTML="",o=null,r=null,s.classList.add("active"),s.classList.remove("active"),l.classList.add("active"),l.classList.remove("active"),A.unregister(L.Listener,f.DocAction.DELUGE_FUNCTIONS.INSERT,_),A.unregister(L.Listener,f.DocAction.DELUGE_FUNCTIONS.REMOVE,V)},open:function(){t?(s.click(),n.setTitle(p)):(l.click(),n.setTitle(M)),A.register(L.Listener,f.DocAction.DELUGE_FUNCTIONS.INSERT,_,"RID","VERSION","DELUGE"),A.register(L.Listener,f.DocAction.DELUGE_FUNCTIONS.REMOVE,V,"RID","VERSION","DELUGE")}};n||(C=y.getTemplate(["manageMacroList","manageMacro"]).manageMacroList,N=C.querySelector("#manageMacroContainer"),a=N.querySelector("#manageMacroTable"),c=N.querySelector("#manageMacro"),l=C.querySelector("#viewMacroList"),s=C.querySelector("#viewDelugeList"),C.querySelector("#cancelBtn").addEventListener("click",function(){n.close()}),d=N.querySelector(".ZsLoaderSmall"),v=N.querySelector(".ZsNoMsg"),u=N.querySelector("#noMsg"),l.addEventListener("click",function(){var e,t,n,i;q(!0),s.classList.remove("active"),l.classList.add("active"),a.innerHTML="",v.style.display="none",null==o||void 0===o?(e=E.view.getActiveGridID(),t=E.view.getResourceID(e),n=E.view.getVersionID(e),i=E.view.getSelectedSheets(e),y.getMacroList(t,n,i,U)):U(o,!1)}),s.addEventListener("click",function(){q(!0),v.style.display="none",l.classList.remove("active"),s.classList.add("active"),a.innerHTML="",U(null==r||void 0===r?r=R.getDelugeFunctionNameList():r,!0)}),(i=document.createElement("div")).id=D.DI+S.CREATE_MACRO+D.IDENTITY,i.appendChild(N),n=new e.ZSClass.Dialog(i,T)),n.open()}function O(){"active"==s.classList.value?(n.close(),R.createInsertDialog()):(n.close(),A.publish(L.UserAction,f.UserAction.MACRO.CREATE_MACRO,{isFromRecordMacro:!1}))}function U(e,t){q(!1);var n=y.getTemplate(["viewMacroRecords"]).viewMacroRecords.querySelector(".viewMacroRecord"),i=n.querySelector(".macroNameCell"),l=(C=n.querySelector(".macroActionsCell")).querySelector(".runThisMacro"),s=C.querySelector(".editThisMacro"),d=C.querySelector(".deleteThisMacro"),g=E.view.getActiveGridID(),p=E.view.getResourceID(g),S=(E.view.getSheetID(g),E.view.getVersionID(g)),m=E.data.getWorkBook(p,S);if(e.length>0){v.style.display="none";for(var D=0;D<e.length;D++){var M=n.cloneNode();(i=i.cloneNode()).textContent=e[D][1],M.appendChild(i);var C=C.cloneNode();if(m.isEditable())(l=l.cloneNode(!0)).addEventListener("click",b.bind(null,e[D][0],e[D][1])),C.appendChild(l);if((s=s.cloneNode(!0)).addEventListener("click",k.bind(null,e[D][0],e[D][1])),C.appendChild(s),m.isEditable()&&T)(d=d.cloneNode(!0)).addEventListener("click",Z.bind(null,e[D][0],e[D][1],M)),C.appendChild(d);M.appendChild(C),a.appendChild(M)}c.appendChild(a)}else v.style.display="",u.innerHTML="",P(t);t?r=e:o=e}function q(e){d.style.display=e?"":"none"}function k(e,t){"Deluge"==e?R.editMacro(t,!0,n):(n.close(),A.publish(L.UserAction,f.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:e,macName:t}))}function b(e,t){"Deluge"==e?(n.close(),R.runMacro(t,!1)):(n.close(),A.publish(L.UserAction,f.UserAction.MACRO.RUN_MACRO,{modName:e,macName:t}))}function Z(t,n,i){var r={buttons:[{text:m.Yes,primary:!0,click:function(){var r=E.view.getActiveGridID(),o=E.view.getSheetID(r),a=E.view.getResourceID(r),c=E.view.getVersionID(r),l=(E.data.getWorkBook(a,c).SheetList.getById(o),E.view.getSelectedSheets(r));"Deluge"==t?(e.UserAction.delugeDeleteAction(a,c,n,F,i),h=!0):(y.deleteMacro(a,o,c,l,t,n,F,i),h=!1)}},{text:m.No}]},o="Deluge"==t?m["Deluge.AreYouSureToDelete"]:m.AreYouSureToDeleteMacro;r.title="Deluge"==t?m["Alert.Title.FunctionDelete"]:m["Alert.Title.MacroDelete"],ZSClass.ZSAlert(M.fn.replaceParams(o,[n]),r)}function F(t,n){var o=!1;h?(!function(t,n){var o=t.delugeResponse;if(o&&"success"==o.status){n.classList.add("bOr","aDd"),setTimeout(function(){n.remove()},600);for(var a=o.function.name,c=0;c<r.length;c++)r[c][1]==a&&r.splice(c,1)}else!function(){(p=i.parentNode.querySelector(".shNtfyWrpr"))&&i.parentNode.removeChild(p);var t=e.UserAction.getTemplate([I]);(p=t[I]).querySelector(".shNtfyCtn").innerText="Sorry! The function could not be deleted. Please try after sometime.",g&&clearTimeout(g);g=setTimeout(G,5e3),i.parentNode.appendChild(p)}()}(t,n),o=1==a.childElementCount):(n.remove(),o=0==a.childElementCount),o&&(P(h),v.style.display="")}function G(){i.parentNode.querySelector(".shNtfyWrpr").style.display="none"}function _(e,t,n){var i=n[0];r?r[r.length]=["Deluge",i]:(r=[])[0]=["Deluge",i]}function V(e,t,n){for(var i=0;i<n.length;i++)for(var o=0;o<r.length;o++)r[o][1]==n[i]&&r.splice(o,1)}function P(e){if(e){var t=E.data.UserInfo.Permission;if(0==t.isCoOwner&&1==t.isEditable)u.innerHTML=M.fn.replaceParams(m["Deluge.EmptyState"],new Array("<span id='create' class='ZsLink' >","</span>")),u.querySelector("#create").addEventListener("click",function(){O()});else u.innerText=m["Deluge.Owner.EmptyState"]}else{u.innerHTML=M.fn.replaceParams(m["Macros.NoMacrosFound"],new Array("<span id='create' class='ZsLink' >","</span>")),u.querySelector("#create").addEventListener("click",function(){O()})}}A.register(L.UserAction,f.UserAction.MACRO.VIEW_MACRO,w),N.openDialog=w}(this);
!function(t,i){var o=t.ZSClass.Editors;function e(t,i,o){return this.Editor.getSearchCursor(t,o||this.getCursor(),i)}function n(t,o){var e=this;this.Editor=i.fromTextArea(t,o),this.Editor.on("keyup",function(t,o){if(!e.Editor.getOption("readOnly"))if(o.which>=65&&o.which<=90||190==o.which)t.showHint({hint:i.hint.vision,completeSingle:!1});else if(8==o.which){var n=t.getTokenAt(t.getCursor()).string,r=n.charCodeAt(n.length-1);(r>=65&&r<=90||r>=97&&r<=122||46==r)&&t.showHint({hint:i.hint.vision,completeSingle:!1})}}),this.Editor.on("keydown",function(t,i){70==i.which&&(i.metaKey||i.ctrlKey)&&i.preventDefault()})}n.prototype={set value(t){this.Editor.setValue(t)},get value(){return this.Editor.getValue()},select:function(t,i){this.Editor.setSelection(t,i)},selections:function(t){this.Editor.setSelections(t)},focus:function(){this.Editor.focus()},blur:function(){this.Editor.focus()},setSize:function(t,i){this.Editor.setSize(t,t)},undo:function(){this.Editor.undo()},redo:function(){this.Editor.redo()},goto:function(t,i){isNaN(t)||isNaN(i)&&void 0!=i||(this.focus(),this.setCursor(t,i))},find:function(t,i){var o=e.call(this,t,i);if(o.findNext()){this.select(o.from(),o.to());o.to();return!0}return!1},findFromOrigin:function(t,i,o){var n=e.call(this,t,i,{line:0,ch:0});if(n.findNext()){n.to();return o?this.goto(n.from().line+1):this.select(n.from(),n.to()),!0}return!1},findPrev:function(t,i){var o=e.call(this,t,i);if(o.findPrevious()){o.from();return this.select(o.from(),o.to()),!0}return!1},replace:function(t,i,o){var n=e.call(this,t,o);if(n.findNext()||(n=(n=e.call(this,t,o,{line:0,ch:0})).findNext()?n:null),null!=n){n.replace(i);n.to();return this.select(n.from(),n.to()),!0}return!1},replaceAll:function(t,i,o){for(var n=e.call(this,t,o,{line:0,ch:0}),r=[];n.findNext();){var s={};n.replace(i),s.anchor=n.from(),s.head=n.to(),r.push(s)}this.selections(r)},getCursor:function(){return this.Editor.getCursor()},setCursor:function(t,i){var o={line:t,ch:i};this.Editor.setCursor(o)},clearUndo:function(){this.Editor.clearHistory()},getLineCount:function(){return this.Editor.lineCount()},setOption:function(t,i){this.Editor.setOption(t,i)},getOption:function(t){return this.Editor.getOption(t)}},o.MacroEditor=n}(this,CodeMirror);
!function(e){var t=e.UserAction,i=e.sPlusPlus;t.Macro={};var o=t.Macro;function n(e,t,i,o){this.dom=e,this.name=t,this.events=o,this.state={content:i,position:{line:0,ch:0}}}function s(e,t){this.editor=e,this.header={nameHolder:t.querySelector("#moduleName"),eventHolder:t.querySelector("#eventList")},this.ModuleList={}}n.prototype={setContent:function(e){this.state.content=e},setPosition:function(e){this.state.position=e},getDom:function(){return this.dom},getName:function(){return this.name},getContent:function(){return this.state.content},getPosition:function(){return this.state.position},getEvents:function(){return this.events}},o.Module=n,s.prototype={setMacroModule:function(e,t,i,o){this.ModuleList[t]=new n(e,t,i,o)},getMacroModule:function(e){return this.ModuleList[e]},setActiveModule:function(e){this.ActiveModule=e},getActiveModule:function(){return this.ActiveModule},save:function(){this.ActiveModule.setContent(this.editor.value),this.ActiveModule.setPosition(this.editor.getCursor()),this.ActiveModule.getDom().classList.remove("active")},revoke:function(){this.editor.value=this.ActiveModule.getContent();var e=this.ActiveModule.getPosition();this.editor.focus(),this.editor.setCursor(e.line,e.ch),this.ActiveModule.getDom().classList.add("active"),this.header.nameHolder.textContent=this.ActiveModule.getName();var t=i.view.getActiveGridID(),o=i.view.getResourceID(t),n=(i.view.getSheetID(t),i.view.getVersionID(t)),s=i.data.getWorkBook(o,n),r=this.ActiveModule.getEvents();if(r&&s.isEditable()){this.header.eventHolder.innerHTML="";var d=document.createElement("option");for(var u in d.innerText="-Select Event-",this.header.eventHolder.appendChild(d),r)(d=document.createElement("option")).innerText=u,this.header.eventHolder.appendChild(d);this.header.eventHolder.style.display=""}else this.header.eventHolder.style.display="none";this.editor.clearUndo()}},o.MacroModule=s}(this);
!function(e){var t,i,o=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,r=e.ZSConstants.wCC,a=e.ZSConstants.I18N,s=e.UserAction.Macro,c=e.UserAction,l=e.ZSConstants.JSKeyCode,d=e.ZSEvents,u=d.topic,h=d.Groups,m=d.Names,g=ZSClass.Editors,M=e.ZSConstants.FeatureConstants,v=o.view.Toolbar.Feature[M.CREATE_MACRO],B=o.view.Toolbar.Feature[M.MANAGE_MACRO];function p(){this.init()}function y(e,t,i){var n,r,a=c.getTemplate(["MACRO_MODULES"]).MACRO_MODULES,l=a.querySelector(".macroModules"),d=a.querySelector(".forMacroModules"),u=i.macroEditorWrapper.querySelector("#eventContainer");i.MacroModule=new s.MacroModule(i.editor,u),i.showLoader(!1);var h=o.view.getActiveGridID(),m=o.view.getResourceID(h),g=(o.view.getSheetID(h),o.view.getVersionID(h)),M=o.data.getWorkBook(m,g);for(var B in e){if("ThisWorkbook"==B)n=i.thisWorkbook,M.isEditable()&&v&&(r={Open:{fName:"Workbook_Open",scope:"Private",type:"Sub"},"New Sheet":{fName:"Workbook_NewSheet",scope:"Private",type:"Sub",arguments:{argName:"sh",type:"Object"}}});else if(e[B].referenceName){p=l.cloneNode(!0);(f=d.cloneNode()).for=B,f.addEventListener("click",i.loadModule.bind(i,B)),f.textContent=B+"("+e[B].referenceName+")",p.appendChild(f),i.spreadsheetObjects.appendChild(p),n=p,M.isEditable()&&v&&(r={Change:{fName:"Worksheet_Change",scope:"Private",type:"Sub",arguments:{argName:"Target",type:"Range"},defaultContent:"\nApplication.EnableEvents = false\nOn Error Goto ENEV\nREM add your code below\n\nENEV:\nApplication.EnableEvents = true\n"}})}else{var p=l.cloneNode(!0);(f=d.cloneNode()).textContent=B,f.addEventListener("click",i.loadModule.bind(i,B)),p.appendChild(f),i.customMacroObjects.appendChild(p),n=p,r=void 0}var y=e[B].moduleContent;i.MacroModule.setMacroModule(n,B,y,r)}if(void 0==i.MacroModule.getMacroModule("Macros")){var f;p=l.cloneNode(!0);(f=d.cloneNode()).textContent="Macros",f.addEventListener("click",i.loadModule.bind(i,"Macros")),p.appendChild(f),i.customMacroObjects.appendChild(p),n=p,i.MacroModule.setMacroModule(n,"Macros","",void 0)}i.showLoader(!1),i.loadModule(i.cache.modName),i.goto(i.cache.lineNumber?i.cache.lineNumber:t)}function f(e,t){t.menuBar.changeMenuButtonState(!1,!0,t.menuBar.saveButton,a["Macro.Editor.Save"]),t.menuBar.changeMenuButtonState(!1,!0,t.menuBar.saveAndRunButton,a["Macro.Editor.SaveAndRun"])}function E(t,i,o,n,r,s,c){if(n){var l=n.me;if(l){var d=l.m;c.errorMsgbox.innerHTML=JSUtil.fn.replaceParams(a.EncounteredErrorLNCN,new Array(l.l,l.c))+d,c.showMessagePanel(!0,"error")}var u=n.MACROTABLE;u&&S(u)}c.menuBar.changeMenuButtonState(!1,!1,c.menuBar.runButton,a["Macro.Editor.Run"]),r&&s&&e.UserAction.ScrollCellIntoView(t,i,o,r,s)}function S(o){var n={width:340,title:a["Macro.RunMacro"],model:!0,closePreviousDialog:!1,open:function(){!function(e){i.innerHTML="";for(var t=0;t<e.length;t++){var o=e[t],n=o.MACRONAME,r=o.MODULENAME,a=document.createElement("li");a.innerText=n,a.title=n,a.addEventListener("click",b.bind(null,r,n)),i.appendChild(a)}}(o)}};if(!t){var s=function(){t=c.getTemplate(["macrosList"]).macrosList,i=t.querySelector("#macroListTable"),t.querySelector("#cancelBtn").addEventListener("click",function(){t.close()});var e=document.createElement("div");return e.id=r.DI+M.CREATE_MACRO+r.IDENTITY,e.appendChild(t),e}();t=new e.ZSClass.Dialog(s,n)}t.open()}function b(e,i){t.close(),u.publish(h.UserAction,m.UserAction.MACRO.RUN_MACRO,{modName:e,macName:i})}function w(t,i,o,n,r,s,c){if(n){var l=n.me;if(l){var d=l.m;c.errorMsgbox.innerHTML=JSUtil.fn.replaceParams(a.EncounteredErrorLNCN,new Array(l.l,l.c))+d,c.showMessagePanel(!0,"error")}var u=n.MACROTABLE;u&&S(u)}c.menuBar.changeMenuButtonState(!1,!0,c.menuBar.saveButton,a["Macro.Editor.Save"]),c.menuBar.changeMenuButtonState(!1,!0,c.menuBar.saveAndRunButton,a["Macro.Editor.SaveAndRun"]),r&&s&&e.UserAction.ScrollCellIntoView(t,i,o,r,s)}function C(e){return!1}function A(){return this.menuBar.changeMenuButtonState(!1,!1,this.menuBar.saveButton,a["Macro.Editor.Save"]),this.menuBar.changeMenuButtonState(!1,!1,this.menuBar.saveAndRunButton,a["Macro.Editor.SaveAndRun"]),!1}p.prototype={init:function(){this.initComponents(),this.initTitleBar(),this.initMenuBar(),this.initDialog(),this.initSearchBar(),this.initMessagePanel()},initComponents:function(){this.fragments=c.getTemplate(["MACRO_EDITOR_TITLE","MACRO_EDITOR","MACRO_GOTO","MACRO_PROCEDURE"]);var e=this.fragments.MACRO_EDITOR,t=this;this.spreadsheetObjects=e.querySelector("#spreadsheetObjects"),this.thisWorkbook=e.querySelector("#thisWorkbook"),this.customMacroObjects=e.querySelector("#customMacroObjects"),this.loader=e.querySelector("#macroEditorLoading"),this.spreadsheetTree=e.querySelector("#mcr-tree-1-1"),this.macroTree=e.querySelector("#mcr-tree-1-2"),this.macroBody=e.querySelector("#macroBody"),this.leftPanel=e.querySelector(".mcrLfn"),this.collapseDiv=e.querySelector(".mcrClpse"),this.thisWorkbook.addEventListener("click",function(){t.loadModule("ThisWorkbook")}),this.collapseDiv.addEventListener("click",function(){"0px"==t.leftPanel.style.marginLeft||""==t.leftPanel.style.marginLeft?t.leftPanel.style.marginLeft="-210px":t.leftPanel.style.marginLeft="0px"}),this.eventList=e.querySelector("#eventList"),this.eventList.addEventListener("change",function(){t.addPredefinedFunction(this.value),this.selectedIndex=0})},initDialog:function(){var t=this,i={width:1e3,title:this.fragments.MACRO_EDITOR_TITLE,modal:!0,closeOnEsc:!1,close:function(){t.menuBar.saveButton.disabled||t.menuBar.saveMacro(),t.gotoDialog&&t.gotoDialog.close(),t.insertProcedureDialog&&t.insertProcedureDialog.close(),function(){for(var e=this.macroEditorWrapper.querySelectorAll(".macroModules"),t=0;t<e.length;t++)e[t].remove();this.searchBar&&this.showSearchBar(!1);var i=this.MacroModule.getActiveModule();i&&i.getDom().classList.remove("active"),this.showMessagePanel(!1),this.spreadsheetTree.checked=!0,this.macroTree.checked=!0,this.titleBar.clearCache(),this.editor.value="",this.cache={}}.call(t),t.clearMessagePanelCache()},open:function(){!t.editor&&t.initEditor(),t.showLoader(!0),t.menuBar.changeMenuButtonState(!1,!0,t.menuBar.saveButton,a["Macro.Editor.Save"]),t.menuBar.changeMenuButtonState(!1,!0,t.menuBar.saveAndRunButton,a["Macro.Editor.SaveAndRun"]),function(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),i=o.view.getSheetID(e),n=o.view.getVersionID(e),r=(o.data.getWorkBook(t,n).SheetList.getById(i),o.view.getSelectedSheets(e));c.getMacroEditorInfo(t,n,r,this.cache.modName,this.cache.macName,y,this)}.call(t)}};this.macroEditorWrapper=document.createElement("div"),this.macroEditorWrapper.id=r.DI+n.MACRO_EDITOR+r.IDENTITY,this.macroEditorWrapper.appendChild(this.fragments.MACRO_EDITOR),this.dialog=new e.ZSClass.Dialog(this.macroEditorWrapper,i),this.dialog.Dom.classList.add("mcrEdtr"),function(){var e=this.dialog.getKeyContext().keyDown;e[l.PURE_PRINTABLE_CHAR]=A.bind(this),e[l.DELETE]=A.bind(this),e[l.TAB]=A.bind(this),e[l.ENTER]=A.bind(this),e[l.BACKSPACE]=A.bind(this),e[l.ESC]=function(){return this.showMessagePanel(!1),this.searchBar&&this.showSearchBar(!1),!1}.bind(this),e[l.SUPER+"+"+l.C]=C,e[l.SUPER+"+"+l.V]=A.bind(this),e[l.SUPER+"+"+l.F]=function(e){e.preventDefault();var t=o.view.getActiveGridID(),i=o.view.getResourceID(t),n=(o.view.getSheetID(t),o.view.getVersionID(t));if(o.data.getWorkBook(i,n).isEditable())return this.showSearchBar(!0),!1}.bind(this),e[l.SUPER+"+"+l.S]=function(e){e.preventDefault(),this.menuBar.saveButton.disabled||this.menuBar.saveMacro()}.bind(this),e[l.SUPER+"+"+l.Z]=function(){A.call(this),this.editor.undo()}.bind(this),e[l.SUPER+"+"+l.SHIFT+"+"+l.Z]=function(){A.call(this),this.editor.redo()}.bind(this)}.call(this)},initTitleBar:function(){this.titleBar=new s.MacroVBAEditorTitle(this)},initSearchBar:function(){this.searchBar=this.macroEditorWrapper.querySelector("#searchBar"),this.searchPanel=new s.MacroVBAEditorSearchBar(this)},initMessagePanel:function(){var e=this;this.bottomBanner=this.macroEditorWrapper.querySelector("#bottomBanner"),this.errorMsgbox=this.macroEditorWrapper.querySelector("#errorMsgbox"),this.infoMsgbox=this.macroEditorWrapper.querySelector("#infoMsgbox"),this.warningMsgbox=this.macroEditorWrapper.querySelector("#warningMsgbox"),this.infoTab=this.macroEditorWrapper.querySelector("#infoTab"),this.errorTab=this.macroEditorWrapper.querySelector("#errorTab"),this.warningTab=this.macroEditorWrapper.querySelector("#warningTab"),this.infoPart=this.macroEditorWrapper.querySelector("#infoPart"),this.errorPart=this.macroEditorWrapper.querySelector("#errorPart"),this.warningPart=this.macroEditorWrapper.querySelector("#warningPart"),this.infoTab.addEventListener("click",function(){e.showMessagePanel(!0,"info")}),this.errorTab.addEventListener("click",function(){e.showMessagePanel(!0,"error")}),this.warningTab.addEventListener("click",function(){e.showMessagePanel(!0,"warning")})},initMenuBar:function(){this.menuBar=new s.MacroVBAEditorMenu(this)},open:function(e,t,i,n){n?(this.dialog.close(),this.open(e,t,i)):this.dialog.isMinimize()?(this.titleBar.maximize(),this.loadModule(e),this.find(t),this.goto(this.editor.getCursor().line+2)):(this.cache={modName:e,macName:t,lineNumber:i},this.dialog.open(),function(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),i=(o.view.getSheetID(e),o.view.getVersionID(e));o.data.getWorkBook(t,i).isEditable()?(v?(this.menuBar.undoButton.style.display="",this.menuBar.redoButton.style.display="",this.menuBar.findButton.style.display="",this.menuBar.insertProcedureButton.style.display="",this.menuBar.saveButton.style.display="",this.menuBar.saveAndRunButton.style.display="",this.enableReadOnlyMode(!1)):(this.menuBar.undoButton.style.display="none",this.menuBar.redoButton.style.display="none",this.menuBar.findButton.style.display="none",this.menuBar.insertProcedureButton.style.display="none",this.menuBar.saveButton.style.display="none",this.menuBar.saveAndRunButton.style.display="none",this.enableReadOnlyMode(!0)),B?(this.menuBar.runButton.style.display="",this.menuBar.errorButton.style.display="",this.menuBar.infoButton.style.display="",this.menuBar.warningButton.style.display=""):(this.menuBar.runButton.style.display="none",this.menuBar.errorButton.style.display="none",this.menuBar.infoButton.style.display="none",this.menuBar.warningButton.style.display="none")):(this.menuBar.undoButton.style.display="none",this.menuBar.redoButton.style.display="none",this.menuBar.findButton.style.display="none",this.menuBar.insertProcedureButton.style.display="none",this.menuBar.saveButton.style.display="none",this.menuBar.runButton.style.display="none",this.menuBar.saveAndRunButton.style.display="none",this.menuBar.errorButton.style.display="none",this.menuBar.infoButton.style.display="none",this.menuBar.warningButton.style.display="none",this.enableReadOnlyMode(!0))}.call(this))},close:function(){this.dialog.close()},minimize:function(){this.dialog.minimize()},maximize:function(){this.dialog.maximize()},isAlive:function(){return this.dialog.isAlive()},setValue:function(e){this.editor.value=e},isMinimize:function(){return this.dialog.isMinimize()},getValue:function(){return this.editor.value()},initEditor:function(){var e=this.macroEditorWrapper.querySelector("#macroEditorCodeArea");this.editor=new g.MacroEditor(e,{mode:"vbscript",lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,autoFocus:!0,extraKeys:{"Ctrl-Space":"autocomplete"},electricChars:!1,smartIndent:!1,showCursorWhenSelecting:!0})},openGotoDialog:function(){!this.gotoDialog&&(this.gotoDialog=new s.MacroVBAEditorGoto(this)),this.gotoDialog.open()},closeGotoDialog:function(){this.gotoDialog&&this.gotoDialog.close()},openInsertProcedureDialog:function(){!this.insertProcedureDialog&&(this.insertProcedureDialog=new s.MacroVBAEditorInsertProcedure(this)),this.insertProcedureDialog.open()},closeInsertProcedureDialog:function(){this.insertProcedureDialog&&this.insertProcedureDialog.close()},showSearchBar:function(e){e?(this.searchBar.style.display="",this.searchPanel.searchBox.focus()):this.searchBar.style.display="none"},showMessagePanel:function(e,t){if(e){switch(t){case"info":if(""==this.bottomBanner.style.display&&this.infoPart.checked)return void(this.bottomBanner.style.display="none");this.infoPart.checked=!0;break;case"error":if(""==this.bottomBanner.style.display&&this.errorPart.checked)return void(this.bottomBanner.style.display="none");this.errorPart.checked=!0;break;case"warning":if(""==this.bottomBanner.style.display&&this.warningPart.checked)return void(this.bottomBanner.style.display="none");this.warningPart.checked=!0}this.bottomBanner.style.display=""}else this.bottomBanner.style.display="none"},clearMessagePanelCache:function(){this.infoMsgbox.innerHTML="",this.errorMsgbox.innerHTML="",this.warningMsgbox.innerHTML=""},showLoader:function(e){e?(this.loader.style.display="",this.macroBody.style.display="none"):(this.loader.style.display="none",this.macroBody.style.display="")},loadModule:function(e){this.MacroModule.getActiveModule()&&this.MacroModule.save();var t=this.MacroModule.getMacroModule(e);this.MacroModule.setActiveModule(t),this.MacroModule.revoke()},saveMacro:function(e,t,i,o){this.clearMessagePanelCache(),this.showMessagePanel(!1);var n=this.MacroModule.getActiveModule().getName(),r=JSON.stringify([{mname:n,mcontent:encodeURIComponent(this.editor.value)}]);c.saveMacro(e,o,i,t,r,f,this)},runMacro:function(){this.clearMessagePanelCache(),this.showMessagePanel(!1);var e,t=this.MacroModule.getActiveModule().getName(),i=o.view.getActiveGridID(),n=o.view.getSheetID(i),r=o.view.getResourceID(i),a=o.view.getVersionID(i),s=o.data.getWorkBook(r,a).SheetList.getById(n).getName(),l=o.view.getSheetState(i,n).getActiveRange(),d=this.editor.getCursor().line+1,u=o.view.getSelectedSheets(i);this.menuBar.saveButton.disabled||(e=JSON.stringify([{mname:t,mcontent:encodeURIComponent(this.editor.value)}])),c.runMacroByLineNumber(r,n,a,t,e,d,u,s,l,E,this)},saveAndRunMacro:function(){this.clearMessagePanelCache(),this.showMessagePanel(!1);var e=this.MacroModule.getActiveModule().getName(),t=JSON.stringify([{mname:e,mcontent:encodeURIComponent(this.editor.value)}]),i=o.view.getActiveGridID(),n=o.view.getResourceID(i),r=o.view.getSheetID(i),a=o.view.getVersionID(i),s=o.data.getWorkBook(n,a).SheetList.getById(r).getName(),l=o.view.getSelectedSheets(i),d=o.view.getSheetState(i,r).getActiveRange(),u=this.editor.getCursor().line;c.saveAndRunMacro(n,r,a,e,t,l,d,u,s,w,this)},undo:function(){this.editor.undo()},redo:function(){this.editor.redo()},goto:function(e){var t=(e=e.toString()).split(":");this.editor.goto(t[0]-1,t[1])},getLineCount:function(){return this.editor.getLineCount()},isFunctionExists:function(e){return this.editor.findFromOrigin(e+"(",!0,!0)},addPredefinedFunction:function(e){var t=this.MacroModule.getActiveModule().getEvents()[e];void 0!=t&&(this.isFunctionExists(t.fName)||this.insertProcedure(t.fName,t.type,t.scope,t.arguments,t.defaultContent))},insertProcedure:function(e,t,i,o,n){if(""!=e.trim()){var r=i+" "+t+" "+e+(o?"(ByVal "+o.argName+" As "+o.type+")":"()")+(n||"\n\n")+"End "+t,a=(void 0!=this.editor.value?this.editor.value+"\n":"")+r;this.editor.value=a}A.call(this)},find:function(e,t){this.editor.find(e,t)||this.editor.findFromOrigin(e,t)},replace:function(e,t,i){this.editor.replace(e,t,i)},replaceAll:function(e,t,i){this.editor.replaceAll(this.searchBoxNameEditor.value,this.replaceBoxNameEditor.value,this.caseSensitive.checked)},enableReadOnlyMode:function(e){this.editor.setOption("readOnly",e)}},s.MacroEditorDialog=p}(this);
!function(t){var e=t.UserAction.Macro,o=t.ZSConstants.I18N,i=ZSClass.Editors,n=t.ZSConstants.FeatureConstants,s=t.ZSConstants.wCC;function r(t){this.parent=t,this.fragment=t.fragments.MACRO_GOTO,this.init()}r.prototype={init:function(){var e=this;this.lineNumber=this.fragment.querySelector("#goto"),this.lineNumEditor=new i.TextAreaEditor(this.lineNumber),this.gotoBtn=this.fragment.querySelector("#gotoBtn"),this.cancelBtn=this.fragment.querySelector("#cancel"),this.gotoBtn.addEventListener("click",function(){e.goto(e.lineNumEditor.value)}),this.lineNumber.addEventListener("keypress",function(t){13==t.keyCode&&e.goto(e.lineNumEditor.value)}),this.cancelBtn.addEventListener("click",function(){e.close()});var r={width:300,title:o["Macro.Editor.Goto"],model:!0,closePreviousDialog:!1,open:function(){e.lineNumber.value="",e.lineNumber.focus()},close:function(){e.parent.dialog.focus()}};this.gotoWrapper=document.createElement("div"),this.gotoWrapper.id=s.DI+n.MACRO_GOTO+s.IDENTITY,this.gotoWrapper.appendChild(this.fragment),this.dialog=new t.ZSClass.Dialog(this.gotoWrapper,r)},open:function(){this.dialog&&this.dialog.open()},close:function(){this.dialog.close()},goto:function(t){isNaN(t)?ZSClass.ZSAlert(o["Macros.PleaseEnterAnInteger"]):(this.parent.goto(t),this.close())}},e.MacroVBAEditorGoto=r}(this);
!function(e){var r=e.UserAction.Macro,t=e.ZSConstants.I18N,i=e.ZSClass.Editors,n=(e.ZSConstants.FeatureConstants,e.ZSConstants.wCC);function o(e){this.parent=e,this.fragment=e.fragments.MACRO_PROCEDURE,this.init()}o.prototype={init:function(){var r=this;this.name=this.fragment.querySelector("#procedureName"),this.nameEditor=new i.TextAreaEditor(this.name),this.create=this.fragment.querySelector("#createProcedure"),this.cancel=this.fragment.querySelector("#cancel"),this.create.addEventListener("click",function(){var e=r.insertProcedureWrapper.querySelectorAll("[name=moduleType]:checked")[0],t=r.insertProcedureWrapper.querySelectorAll("[name=scope]:checked")[0];r.nameEditor.value.trim();r.insertProcedure(r.nameEditor.value,e.value,t.value)}),this.name.addEventListener("keypress",function(e){if(13==e.keyCode){var t=r.insertProcedureWrapper.querySelectorAll("[name=moduleType]:checked")[0],i=r.insertProcedureWrapper.querySelectorAll("[name=scope]:checked")[0];r.nameEditor.value.trim();r.insertProcedure(r.nameEditor.value,t.value,i.value)}}),this.cancel.addEventListener("click",function(){r.close()});var o={width:400,title:t["Macro.Editor.InsertProcedure"],model:!0,closePreviousDialog:!1,open:function(){r.name.value="",r.name.focus(),r.insertProcedureWrapper.querySelectorAll("[name=moduleType]")[0].checked=!0,r.insertProcedureWrapper.querySelectorAll("[name=scope]")[0].checked=!0},close:function(){r.parent.dialog.focus()}};this.insertProcedureWrapper=document.createElement("div"),this.insertProcedureWrapper.id=n.DI+"11111"+n.IDENTITY,this.insertProcedureWrapper.appendChild(this.fragment),this.dialog=new e.ZSClass.Dialog(this.insertProcedureWrapper,o)},isFunctionExists:function(e){return!!this.parent.isFunctionExists(e)&&(ZSClass.ZSAlert(t["Error.Macro.Name"],{title:t["Alert.Title.MacroNameExists"]}),!0)},open:function(){this.dialog.open()},close:function(){this.dialog.close()},insertProcedure:function(e,r,t,i,n){UserAction.isValidMacroName(e)&&!this.isFunctionExists(e)&&(this.close(),this.parent.insertProcedure(e,r,t,i,n),this.parent.goto(this.parent.getLineCount()-1))}},r.MacroVBAEditorInsertProcedure=o}(this);
!function(t){var n=t.UserAction.Macro,e=t.sPlusPlus,i=(t.ZSConstants.FeatureConstants,t.ZSConstants.wCC,t.ZSConstants.I18N),o=(t.UserAction.Macro,t.UserAction,t.ZSEvents);o.topic,o.Groups,o.Names,ZSClass.Editors;function r(t){this.dialog=t,this.fragment=t.fragments.MACRO_EDITOR,this.init()}r.prototype={init:function(){this.undoButton=this.fragment.querySelector("#mcrundo"),this.redoButton=this.fragment.querySelector("#mcrredo"),this.findButton=this.fragment.querySelector("#mcrfind"),this.gotoButton=this.fragment.querySelector("#mcrgoto"),this.insertProcedureButton=this.fragment.querySelector("#mcrinsertProcedure"),this.saveButton=this.fragment.querySelector("#mcrsave"),this.runButton=this.fragment.querySelector("#mcrrun"),this.saveAndRunButton=this.fragment.querySelector("#mcrsaveAndRun"),this.errorButton=this.fragment.querySelector("#mcrerror"),this.infoButton=this.fragment.querySelector("#mcrinfo"),this.warningButton=this.fragment.querySelector("#mcrwarning"),this.bindEvents()},bindEvents:function(){var t=this;this.undoButton.addEventListener("click",function(){t.dialog.undo()}),this.redoButton.addEventListener("click",function(){t.dialog.redo()}),this.findButton.addEventListener("click",function(){t.dialog.showSearchBar(!0)}),this.gotoButton.addEventListener("click",function(){t.dialog.openGotoDialog()}),this.insertProcedureButton.addEventListener("click",function(){t.dialog.openInsertProcedureDialog()}),this.saveButton.addEventListener("click",function(){t.saveMacro()}),this.runButton.addEventListener("click",function(){t.runMacro()}),this.saveAndRunButton.addEventListener("click",function(){t.saveAndRunMacro()}),this.errorButton.addEventListener("click",function(){t.dialog.showMessagePanel(!0,"error")}),this.infoButton.addEventListener("click",function(){t.dialog.showMessagePanel(!0,"info")}),this.warningButton.addEventListener("click",function(){t.dialog.showMessagePanel(!0,"warning")})},saveMacro:function(){var t=e.view.getActiveGridID(),n=e.view.getResourceID(t),o=e.view.getSheetID(t),r=e.view.getVersionID(t),s=e.data.getWorkBook(n,r),a=(s.SheetList.getById(o),e.view.getSelectedSheets(t));s.isEditable()&&(this.changeMenuButtonState(!0,!0,this.saveButton,i["Macro.Editor.Saving"]),this.dialog.saveMacro(n,o,a,r,s))},runMacro:function(){this.changeMenuButtonState(!0,!0,this.runButton,i["Macro.Editor.Running"]),this.dialog.runMacro()},saveAndRunMacro:function(){this.changeMenuButtonState(!0,!0,this.saveAndRunButton,i["Macro.Editor.Processing"]),this.dialog.saveAndRunMacro()},changeMenuButtonState:function(t,n,e,i){t?e.classList.add("ZsLoadingIcon"):e.classList.remove("ZsLoadingIcon"),e.disabled=n,e.querySelector("span").textContent=i}},n.MacroVBAEditorMenu=r}(this);
!function(t){var r=t.UserAction.Macro;function i(t){this.fragment=t,this.init()}i.prototype={init:function(){this.errorTab=this.fragment.querySelector("#errorTab"),this.warningTab=this.fragment.querySelector("#warningTab"),this.infoTab=this.fragment.querySelector("#infoTab"),this.errorPart=this.fragment.querySelector("#errorPart"),this.infoPart=this.fragment.querySelector("#infoPart"),this.warningPart=this.fragment.querySelector("#warningPart")},bindEvents:function(){this.errorTab.addEventListener("click",function(){this.errorPart.checked=!0}),this.warningTab.addEventListener("click",function(){this.warningPart.checked=!0}),this.infoTab.addEventListener("click",function(){this.infoPart.checked=!0})}},r.MacroVBAEditorMessagePanel=i}(this);
!function(e){var t=e.UserAction.Macro,r=e.ZSClass.Editors;function a(e){this.parent=e,this.init()}a.prototype={init:function(){this.searchBox=this.parent.searchBar.querySelector("#search"),this.searchBoxNameEditor=new r.TextAreaEditor(this.searchBox),this.searchBtn=this.parent.searchBar.querySelector("#searchBtn"),this.replaceBox=this.parent.searchBar.querySelector("#replace"),this.replaceBoxNameEditor=new r.TextAreaEditor(this.replaceBox),this.replaceBtn=this.parent.searchBar.querySelector("#replaceBtn"),this.replaceAllbtn=this.parent.searchBar.querySelector("#replaceAllBtn"),this.caseSensitive=this.parent.searchBar.querySelector("#caseSensitive"),this.searchClose=this.parent.searchBar.querySelector(".mcrFindClose"),this.bindEvents()},bindEvents:function(){var e=this;this.searchBtn.addEventListener("click",function(){e.find(e.searchBoxNameEditor.value,e.caseSensitive.checked)}),this.searchBox.addEventListener("keydown",function(t){13==t.keyCode&&e.find(e.searchBoxNameEditor.value,e.caseSensitive.checked)}),this.replaceBtn.addEventListener("click",function(){e.replace(e.searchBoxNameEditor.value,e.replaceBoxNameEditor.value,e.caseSensitive.checked)}),this.replaceBox.addEventListener("keydown",function(t){13==t.keyCode&&(t.preventDefault(),e.replace(e.searchBoxNameEditor.value,e.replaceBoxNameEditor.value,e.caseSensitive.checked))}),this.replaceAllbtn.addEventListener("click",function(){e.replaceAll(e.searchBoxNameEditor.value,e.replaceBoxNameEditor.value,e.caseSensitive.checked)}),this.searchClose.addEventListener("click",function(){e.close()})},find:function(e,t){this.parent.find(e,t)},replace:function(e,t,r){this.parent.replace(e,t,r)},replaceAll:function(e,t,r){this.parent.replaceAll(this.searchBoxNameEditor.value,this.replaceBoxNameEditor.value,this.caseSensitive.checked)},close:function(){this.parent.showSearchBar(!1)}},t.MacroVBAEditorSearchBar=a}(this);
!function(t){var i=t.sPlusPlus,e=t.UserAction.Macro,n=(t.ZSConstants.FeatureConstants,t.ZSConstants.wCC),a=t.ZSConstants.I18N,o=i.data.AppRegistry.MACRO,l=t.UIUtil.Component;function s(t){this.minimizeButton.style.display=t?"none":"",this.maximizeButton.style.display=t?"":"none",this.helpButton.style.display=t?"none":""}function r(t){this.dialog=t,this.fragment=t.fragments.MACRO_EDITOR_TITLE,this.init()}r.prototype={init:function(){var t=this;this.closeButton=this.fragment.querySelector("#closeDialog"),this.minimizeButton=this.fragment.querySelector("#minimizeDialog"),this.maximizeButton=this.fragment.querySelector("#maximizeDialog"),this.helpButton=this.fragment.querySelector("#macroHelp"),this.closeButton.addEventListener("click",function(){t.dialog.close()}),this.minimizeButton.addEventListener("click",function(){t.minimize()}),this.maximizeButton.addEventListener("click",function(){t.maximize()}),this.clearCache(),this.initHelpMenu()},initHelpMenu:function(){this.helpButton.setAttribute("data-menu-id",n.SUBMENUITEM+"MACRO_HELP"+n.IDENTITY);var t={id:n.SUBMENUITEM+"MACRO_HELP"+n.IDENTITY,ctype:"zmenu",relativeto:"parent",data:'{"componentOptions":{"type":"text_only"}}'},e=[{data:'{"label": "'+a.VBAProgramming+'","url":"'+o.VBA_PROGRAMMING+'"}'},{data:'{"label": "'+a.VBAObjectExplorer+'","url":"'+o.VBA_OBJECT_EXPLORER+'"}'},{data:'{"label": "'+a.WhatIsMacro+'","url":"'+o.VBA_PROGRAMMING+'"}'},{data:'{"label": "'+a.SampleMacros+'","url":"'+o.SAMPLE_MACROS+'"}'},{data:'{"label": "'+a.UserContributedMacros+'", "url":"'+o.USER_CONTRIBUTED_MACROS+'"}'}];i.view.Menu.create(e,t).then(function(){l.bind("#"+n.SUBMENUITEM+"MACRO_HELP"+n.IDENTITY,"zmenuitemclick",function(t,i){var e=i.data;window.open(e.url)})})},minimize:function(){s.call(this,!0),this.dialog.minimize()},maximize:function(){s.call(this,!1),this.dialog.maximize()},clearCache:function(){s.call(this,!1)}},e.MacroVBAEditorTitle=r}(this);
!function(e){e.sPlusPlus;var t=e.ZSConstants.FeatureConstants,s=e.ZSConstants.wCC,i=e.UserAction.Macro,n=e.UserAction,o=e.ZSConstants.I18N;function a(){this.init()}a.prototype={init:function(){var i=this,a=n.getTemplate(["MSGBOX","MSGLIST"]),r=a.MSGBOX;this.container=r.querySelector("#messageBoxContainer"),this.header=r.querySelector("#msgHead"),this.list=r.querySelector("#msgList"),this.cancel=r.querySelector("#close");var c=a.MSGLIST;this.msg=c.querySelector("#msg"),this.content=c.querySelector("#content"),this.link=c.querySelector("#link"),this.cancel.addEventListener("click",function(){i.dialog.close()});var l={width:500,modal:!0,title:o["Macro.MessageBox.MessageBox"],close:this.clearCache.bind(this)};this.messageBoxWrapper=document.createElement("div"),this.messageBoxWrapper.id=s.DI+t.MACRO_EDITOR+s.IDENTITY,this.messageBoxWrapper.appendChild(this.container),this.dialog=new e.ZSClass.Dialog(this.messageBoxWrapper,l)},open:function(){this.dialog.open()},clearCache:function(){this.list.innerHTML=""},close:function(){this.dialog.close()}},i.MessageBox=a}(this);
!function(e){e.sPlusPlus;var r=e.ZSConstants.FeatureConstants,t=e.ZSConstants.wCC,i=e.UserAction.Macro,o=e.UserAction,s=e.ZSConstants.I18N,n=e.ZSEvents,a=n.topic,c=n.Groups,l=n.Names;function h(e){this.parent=e,this.init()}h.prototype={init:function(){var i=this,n=o.getTemplate(["ERRORBOX"]).ERRORBOX;this.container=n.querySelector("#errorBoxContainer"),this.header=n.querySelector("#errorHead"),this.list=n.querySelector("#errorList"),this.debug=n.querySelector("#debug"),this.close=n.querySelector("#close"),this.close.addEventListener("click",function(){i.dialog.close()}),this.debug.addEventListener("click",function(){var e=i.errorLine;i.dialog.close(),a.publish(c.UserAction,l.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:i.moduleName,macName:"",lineNumber:e})});var h={width:500,modal:!0,title:s["Macro.MessageBox.ErrorBox"],close:this.clearCache.bind(this)};this.errorBoxWrapper=document.createElement("div"),this.errorBoxWrapper.id=t.DI+r.MACRO_EDITOR+t.IDENTITY,this.errorBoxWrapper.appendChild(this.container),this.dialog=new e.ZSClass.Dialog(this.errorBoxWrapper,h)},open:function(){this.dialog.open()},setErrorDetails:function(e,r){this.errorLine=e,this.moduleName=r},clearCache:function(){this.list.innerHTML="",this.errorLine=""},close:function(){this.dialog.close()}},i.ErrorBox=h}(this);
!function(e){var t,n,o,r=e.sPlusPlus,i=e.ZSConstants.FeatureConstants,a=e.ZSConstants.CommandConstants,s=e.ZSConstants.I18N,E=(e.UIUtil.Component,e.ZSConstants.JSKeyCode,e.ZSConstants.wCC),c=e.UserAction,l=(e.document,e.JSUtil),d=e.ZSEvents,M=d.topic,C=d.Groups,N=d.Names,A=(ZSClass.Editors,e.UserAction.Macro),u={TYPE:0,META:1},v={MODULENAME:0,MESSAGE:1,LINENUMBER:2};function I(e,n,o,r){t||(t=new A.MacroEditorDialog),t.open(e,n,o,r)}function g(e,t){var n=r.view.getActiveGridID(),o=r.view.getResourceID(n),i=r.view.getSheetID(n),a=r.view.getVersionID(n);c.pullMacroContent(o,i,a,e,t,U)}function U(e){for(var n=e.mc,o=0;o<n.length;o++){var r=n[o].c,i=n[o].n;t.loadModule(i),t.setValue(r)}}r.view.Toolbar.Feature[i.VBA_EDITOR].openDialog=I,M.register(C.UserAction,N.UserAction.MACRO.MACRO_CONTENT_CHANGED,function(e,n){if(t)if(t.isMinimize())g(e,n);else if(t.isAlive()){var o={buttons:[{text:s.Yes,primary:!0,click:function(){g(e,n)}},{text:s.No}],title:s["Alert.Title.MacroUpdated"]};ZSClass.ZSAlert(l.fn.replaceParams(s["Macros.UserhasModifiedTheModule"],[n,e]),o)}},"moduleNames","actionOwner"),M.register(C.UserAction,N.UserAction.MACRO.OPEN_MACRO_EDITOR,I,"modName","macName","lineNumber","refetchFromServer"),M.register(C.UserAction,N.UserAction.MACRO.UPDATE_MACROACTION_RESULTS,function(e){for(var r in t&&t.clearMessagePanelCache(),e){var i=e[r],E=i[u.TYPE],c=i[u.META],l=t&&t.isAlive();switch(E){case a.MACRO_INFO:n||(n=new A.MessageBox);var d=c.length;for(var M in c){var C=c[M],N=n.msg.cloneNode(),I=n.content.cloneNode(),g=n.link.cloneNode(),U=n.list.cloneNode();g.addEventListener("click",function(){n.close(),l?t.goto.bind(t,C[v.LINENUMBER]):(t=new A.MacroEditorDialog).open("Macros","",C[v.LINENUMBER])}),I.textContent=C[v.MESSAGE],g.textContent=C[v.MODULENAME]+"("+C[v.LINENUMBER]+")",N.appendChild(I),N.appendChild(g),U.appendChild(N),l?(t.infoMsgbox.appendChild(U),N.addEventListener("click",t.goto.bind(t,C[v.LINENUMBER]))):(n.header.innerText=d+s["Macro.Editor.Messages"],n.list.appendChild(U))}l?t.showMessagePanel(!0,"info"):n.open();break;case a.MACRO_ERROR:if(o||(o=new A.ErrorBox),l){var S="Encountered error at line "+c[v.LINENUMBER]+" : "+c[v.MESSAGE];t.errorMsgbox.appendChild(document.createTextNode(S)),t.showMessagePanel(!0,"error")}else o.header.innerText="Encountered error at line "+c[v.LINENUMBER],o.list.innerText=c[v.MESSAGE],o.setErrorDetails(c[v.LINENUMBER],c[v.MODULENAME]),o.open();break;case a.MACRO_WARNING:}}},"meta"),M.register(C.UI,N.Menu.INIT_SHEET_CONTEXT,function(e){i.ContextConstant;var t=document.createElement("li");t.setAttribute("data",'{"label":"View Code", "relatedButton": "#'+E.MI+"VIEWCODE"+E.MENU+'" }'),t.id=E.MI+"TABCOLOR"+E.MENU,t.addEventListener("click",function(){var e=r.view.getActiveGridID(),t=r.view.getResourceID(e),n=r.view.getSheetID(e),o=r.view.getVersionID(e);I(r.data.getWorkBook(t,o).SheetList.getById(n).getName())}),e[ZSConstants.ContextConstant.SHEET_VIEWCODE]=t},"MENU_BAG")}(this);
!function(e){var t=e.sPlusPlus,i=(e.document,e.ZSConstants),n=i.FeatureConstants,o=i.I18N,l=(i.wCC,e.ZSEvents),s=(l.topic,l.Groups,l.Names,i.JSKeyCode),r=e.UIUtil.Component;var a,c=void 0,u=void 0;function v(i){c||function(){var i=e.UserAction.getTemplate(["ColumnCustomFitTemplate"]).ColumnCustomFitTemplate;(u=document.createElement("div")).id="DI_COLCUSTOMFIT",u.appendChild(i),a="#col_width";var n={width:250,title:o.ColumnWidth,open:function(){var e,i,n,o,l,s,c,v;e=t.view.getActiveGridID(),i=t.view.getResourceID(e),n=t.view.getSheetID(e),o=t.view.getVersionID(e),l=t.view.getSheetState(e,n).getActiveCol(),s=t.data.getWorkBook(i,o),c=s.ColStyle.getStyleDef(),v=s.getSheetObj(n).Column.axis.getDim(l),r.zspinner(a,"setValue",v),r.zspinner(a,"getElement")[0].getElementsByTagName("input")[0],u.querySelector("#cWidthDefault").innerText=c}};(c=new e.ZSClass.Dialog(u,n)).getKeyContext().keyDown[s.ENTER]=function(){C(r.zspinner(a,"getValue"))},u.querySelector("#okBtn").addEventListener("click",function(){C(r.zspinner(a,"getValue"))}),u.querySelector("#clBtn").addEventListener("click",g)}(),c.open()}function g(){c.close()}function C(i){var n=t.view.getActiveGridID(),o=t.view.getResourceID(n),l=t.view.getVersionID(n),s=t.view.getSheetID(n),r=t.view.getSheetState(n,s).getActiveRange(),a=r.endCol,c=r.startCol,u=a-c+1,v=t.view.getSelectedSheets(n),C=parseInt(i);C?e.UserAction.ResizeCol(o,v,l,C,c,u,!1,!0):e.UserAction.HideCol(o,v,l,"HIDE",r),g()}t.view.Toolbar.Feature[n.COL_OPTIONS].showDialog=v}(this);
!function(e){var t,i=e.sPlusPlus,n=e.document,o=e.ZSConstants,s=o.FeatureConstants,a=(o.wCC,o.I18N),r=e.ZSEvents,c=(r.topic,r.Groups,r.Names,o.JSKeyCode),l=(i.data.Defaults,e.UIUtil.Component),g=void 0,u=void 0;function w(){g.close()}function v(t){var n=i.view.getActiveGridID(),o=i.view.getResourceID(n),s=i.view.getSheetID(n),a=i.view.getVersionID(n),r=i.view.getSheetState(n,s).getActiveRange(),c=r.endRow,l=r.startRow,g=c-l+1,u=i.view.getSelectedSheets(n),v=parseInt(t);v?e.UserAction.ResizeRow(o,u,a,v,l,g,!1,!0):e.UserAction.HideRow(o,u,a,"HIDE",r),w()}i.view.Toolbar.Feature[s.ROW_OPTIONS].showDialog=function(o){g||function(){var o=e.UserAction.getTemplate(["RowCustomFitTemplate"]).RowCustomFitTemplate;(u=n.createElement("div")).id="DI_ROWCUSTOMFIT",u.appendChild(o),t="#row_height";var s={width:250,title:a.RowHeight,open:function(){var e,n,o,s,a,r,c,g;e=i.view.getActiveGridID(),n=i.view.getResourceID(e),o=i.view.getSheetID(e),s=i.view.getVersionID(e),a=i.view.getSheetState(e,o).getActiveRow(),r=i.data.getWorkBook(n,s),c=r.RowStyle.getStyleDef(),g=r.getSheetObj(o).Row.axis.getDim(a),l.zspinner(t,"setValue",g),l.zspinner(t,"getElement")[0].getElementsByTagName("input")[0],u.querySelector("#rHidhtDefault").innerText=c}};(g=new e.ZSClass.Dialog(u,s)).getKeyContext().keyDown[c.ENTER]=function(){v(l.zspinner(t,"getValue"))},u.querySelector("#okBtn").addEventListener("click",function(){v(l.zspinner(t,"getValue"))}),u.querySelector("#clBtn").addEventListener("click",w)}(),g.open()}}(this);
!function(e){var t,i,s,n,a,l=e.sPlusPlus,r=e.document,o=e.ZSEvents,m=(o.topic,o.Groups,o.Names,e.ZSConstants),p=m.FeatureConstants,d=m.I18N,c=(m.wCC,ZSConstants.JSKeyCode),h=e.UserAction,u=e.JSUtil,v=0,T=l.data.AppRegistry;function E(){var e=l.view.getActiveGridID(),t=l.view.getResourceID(e),i=l.view.getVersionID(e);h.getMyTemplates(t,i,L)}function f(){n.innerHTML="",v=0}function L(e){if(i=e,n.removeChild(a),i.templateInfo){var t=new A(h.getTemplate(["NEW_TEMPLATE_SMALL"]).NEW_TEMPLATE_SMALL);n.appendChild(t.dom);for(var s=i.templateInfo,l=s.length-1;l>=0;l--){var r=new S(s[l].rid,s[l].dn);n.appendChild(r.dom),v++}}else{t=new A(h.getTemplate(["NEW_TEMPLATE_LARGE"]).NEW_TEMPLATE_LARGE);n.appendChild(t.dom)}}function A(e){this.dom=e.querySelector("#newTemplateItem"),this.init()}function S(e,t){this.rID=e,this.templateName=t;var i=h.getTemplate(["TEMPLATE_ITEM"]).TEMPLATE_ITEM;this.dom=i.querySelector("#templateItem"),this.init()}function g(){var i={import:function(){var t,i,s,n,a,r;t=this.files,i=this.isURLImport,s=l.view.getActiveGridID(),n=l.view.getResourceID(s),a=l.view.getVersionID(s),r=l.view.getSelectedSheets(s),e.UserAction.fileImport(n,r,a,t,i,"IMPORT_AS_TEMPLATE",void 0,I)},importCancel:function(){t.close()},openDialog:function(){},closeDialog:function(){}};t||(t=new ZSClass.ImportDialog(i,!1)),t.open()}function I(e,i,n,a,r){if(a&&a.url){t.close(),s.close();var o=h.getTemplate(["STATUS_ALERT"]).STATUS_ALERT;o.querySelector("#msg").innerText=d["Import.SuccessMsg"];var m=o.querySelector("#fileLink");m.href=l.data.AppRegistry.ctxpath+l.data.AppRegistry.ClientURI+a.rid,m.innerText=a.fname,m.title=a.fname;var p=[{text:d["MenuItem.FileTab.Open"],primary:!0,click:function(){window.open(m.href,"_blank")}},{text:d.Close,cilck:function(){t.close()}}];ZSClass.ZSAlert(o,{type:"success",isHtml:!0,buttons:p,title:d["Alert.Title.ImportSuccessful"]})}}l.view.Toolbar.Feature[p.MY_TEMPLATES].openDialog=function(){s||function(){(a=r.createElement("div")).classList.add("ZsLoader");var e=r.createElement("div");e.id="DI_MY_TEMPLATES";var t=h.getTemplate(["TEMPLATE_CONTAINER"]).TEMPLATE_CONTAINER;e.appendChild(t),n=e.querySelector("#tmplHolder");var i={modal:!0,width:761,title:d.SystemTemplatesTitle,close:f,open:E};s=new ZSClass.Dialog(e,i)}(),n.appendChild(a),s.open()},A.prototype={init:function(){var t=this.dom.querySelector("#crtTmpl"),i=null;i=T.DOCS_SERVER_URL&&T.DOCS_SERVER_URL===e.window.location.hostname?"https://"+T.DOCS_SERVER_URL+"/createnew.do?service=zohosheet&parentid=-1&type=template":"https://"+e.window.location.hostname+"/sheet/new?doctype=template",t.href=i,t.rel="noopener",t.target="_blank",this.dom.querySelector("#impTmpl").addEventListener("click",g),this.dom.addEventListener("mouseover",function(){this.classList.add("tmplHover")}),this.dom.addEventListener("mouseleave",function(){this.classList.remove("tmplHover")})}},S.prototype={init:function(){this.bindEventsAndAttributes(),this.setImage()},bindEventsAndAttributes:function(){this.dom.useBtn=this.dom.querySelector("#useTmpl"),this.dom.useBtn.addEventListener("click",this.useTemplate.bind(this));var e=this.dom.querySelector("#tmplDel");e.addEventListener("click",this.deleteTemplate.bind(this)),e.title=d["File.MyTemplates.Delete"];var t=this.dom.querySelector("#tmplName");t.value=this.templateName,t.addEventListener("blur",this.renameTemplate.bind(this)),t.addEventListener("keydown",function(e){if(e.keyCode==c.ENTER){var t=new Event("mouseleave");e.target.blur(),this.dom.dispatchEvent(t)}}.bind(this));var i=this.dom.querySelector("#viewTmpl");i.rel="noopener",i.target="_blank",i.href=l.data.AppRegistry.ctxpath+l.data.AppRegistry.ClientURI+this.rID,this.dom.addEventListener("mouseover",function(){this.classList.add("tmplHover")}),this.dom.addEventListener("mouseleave",function(){this.classList.remove("tmplHover")})},setImage:function(){var e=this.dom.querySelector("#tmlImg");e.onerror=function(){this.src=l.data.AppRegistry.ctxpath+"appsheet/styles/images/thumbNailPlaceHolder.svg",this.classList.remove("tmplImg"),this.classList.add("tmplNoImg")},e.src="https://"+l.data.AppRegistry.DOCS_SERVER_URL+"/thumbnail/"+this.rID+"?width=200&height=150",e.classList.add("tmplImg")},renameTemplate:function(e){var t=e.target.value;""==t?(ZSClass.ZSAlert(d["InvalidMsg.TemplateName"],{title:d["Alert.Title.InvalidTemplateName"]}),e.target.value=this.templateName):(h.renameTemplate(this.rID,s.version,t),this.templateName=t)},deleteTemplate:function(){var e=d["File.MyTemplates.DeleteConfirmationMsgOnTemplates"];e=u.fn.replaceParams(e,[this.templateName]);var t=this,i={buttons:[{text:d.Yes,primary:!0,click:function(){h.deleteTemplate(t.rID,s.version),t.dom.remove(),v--,function(){if(0==v){n.innerHTML="";var e=h.getTemplate(["NEW_TEMPLATE_LARGE"]).NEW_TEMPLATE_LARGE,t=new A(e);n.appendChild(t.dom)}}()}},{text:d.No}],title:d["Delete.Template"]};ZSClass.ZSAlert(e,i)},useTemplate:function(){var e=this.dom.useBtn;e.classList.add("ZsRt");var t=r.createElement("SPAN");e.appendChild(t),h.useTemplate(this.rID,s.version,this.templateName,function(t){if(t&&t.di){var i=l.data.AppRegistry.ctxpath+l.data.AppRegistry.ClientURI+t.di;e.classList.remove("ZsRt"),e.removeChild(e.querySelector("SPAN")),window.location.href=i}})}}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,o=i.topic,n=i.Groups,a=i.Names,c=e.ZSConstants,s=c.FeatureConstants,r=(e.document,c.I18N),l=(c.wCC,e.ZSClass),S=(l.Editors.RangeEditor,l.Editors.TextAreaEditor,l.Editors.Utility,l.Range,e.UIUtil.Component,c.ActionConstants),v=t.view.Toolbar.Feature[s.COMMENTS],d=void 0,g=void 0;function T(i){var o,n={width:550,title:r["Notification.EmailSettings"],close:function(){},open:function(){!function(){var e;switch(v.MailNotifyType){case 0:e="#notifyNothing";break;case 1:e="#notifyAllComment";break;case 2:e="#notifyMentioned"}g.querySelector(e).checked=!0}()}};d||(o=e.UserAction.getTemplate(["NotificationSettingsTemplate"]).NotificationSettingsTemplate,(g=document.createElement("div")).id="DI_GOALSEEK",g.className="gSd",g.appendChild(o),g.querySelector("#okBtn").addEventListener("click",function(){var e,i,o,n,a,c,s,r=g.querySelectorAll("input[name=notifyComments]:checked")[0],l=r.value;e=l,i=t.view.getActiveGridID(),o=t.view.getResourceID(i),n=t.view.getVersionID(i),t.data.getWorkBook(o,n),a=t.view.getSelectedSheets(i),c=t.view.getSheetID(i),s=t.view.getSheetState(i,c).getActiveRange(),v.MailNotifyType=parseInt(e),UserAction.emailNotificationType(o,n,a,s,void 0,parseInt(e),S.NOTIFICATION_SETTINGS_SETSTATE),d.close()}),g.querySelector("#cancelBtn").addEventListener("click",function(){d.close()}),d=new e.ZSClass.Dialog(g,n)),d.open()}function u(){d.close()}v.openNotificationSetingsDialog=function(){var e,i,o,n,a,c,s;e=T,i=t.view.getActiveGridID(),o=t.view.getResourceID(i),n=t.view.getVersionID(i),t.data.getWorkBook(o,n),a=t.view.getSelectedSheets(i),c=t.view.getSheetID(i),s=t.view.getSheetState(i,c).getActiveRange(),UserAction.emailNotificationType(o,n,a,s,e,void 0,S.NOTIFICATION_SETTINGS_GETSTATE)},v.closeDialog=u,o.register(n.Listener,a.UserAction.REVIEW_COMMENTS.UPDATE_NOTIFICATION_STATE,function(e,t){void 0!=t&&(v.MailNotifyType=e,t())},"state","callback")}(this);
!function(e){var t,i,n,r,o,c,s,a,u,l,d,g,v,h,I,S,f,p,D,k,m,w,A,N,F,C,y,b,E=e.sPlusPlus,q=e.ZSEvents,R=e.ZSClass,_=e.JSUtil,L=q.topic,T=q.Groups,O=q.Names,U=e.document,x=e.UIUtil.Component,M=e.ZSConstants,B=M.FeatureConstants,P=M.I18N,G=M.wCC,W=M.JSKeyCode,z=M.ActionConstants,V=e.UserAction,K=(E.SML.Client,R.Editors),H=R.Range,Q=E.view.Events.Key,X=E.view.measures,Z=!1,Y=0,j=!1,J=!1,$="sheet",ee=!1,te=!1,ie=!0,ne="",re="",oe=!1,ce=!1,se=(new R.TBNotification(P["Find.NoDataFound"],{type:"error"}),U.querySelector(".shFindBar")),ae=E.view.Toolbar.Feature[B.FIND],ue={range:P["Find.SearchInRange"],sheet:P["Find.SearchInSheet"],wb:P["Find.SearchInWorkbook"],more:P["Find.MoreOptions"]+"..."};function le(){var e=E.view.getActiveGridID(),t=E.view.getSheetID(e);E.view.getSheetState(e,t).getActiveRange().isSingle()?x.zcombo("#"+C,"setValue","sheet"):(x.zcombo("#"+C,"setValue","range"),de())}function de(){var e=E.view.getActiveGridID(),t=E.view.getSheetID(e),i=E.view.getSheetState(e,t).getActiveRange();N=i}function ge(i,n){var r=e.UserAction.getTemplate([i])[i],o=r.querySelector("#searchInput");v=new K.TextAreaEditor(o);var c=r.querySelector("#replaceInput");return c&&new K.TextAreaEditor(c),function(e){e.querySelector("#searchInput").addEventListener("input",he),e.querySelector("#searchNext").addEventListener("click",Ge);var i=e.querySelector("#replaceButton");i&&i.addEventListener("click",We);var n=e.querySelector("#replaceAllButton");n&&n.addEventListener("click",ze);e.querySelector("#searchCloseBtn").addEventListener("click",pe),v.addListeners({keydown:function(e){switch(e.keyCode||e.which){case 13:"find"==this?t.querySelector("#searchNext").disabled||Ge():t.querySelector("#replaceButton").disabled||We()}}.bind("find"),input:Ie})}(r),de(),(n=U.createElement("div")).id=G.DI+B.FIND+G.IDENTITY,n.appendChild(r),n}function ve(i){var n=e.UserAction.getTemplate([i])[i];n.querySelector(".shNtfyClose").style.display="none",function(e){(b=t.parentNode.querySelector(".shNtfyWrpr"))&&t.parentNode.removeChild(b);t.parentNode.appendChild(e),(b=t.parentNode.querySelector(".shNtfyWrpr")).style.display="none",Y=0}(n)}function he(){Y&&(b.style.display="none",Y=0)}function Ie(){var e=v.value?1:0;t.querySelector("#searchNext").disabled=!e;var i=t.querySelector("#replaceButton");i&&(i.disabled=!e);var n=t.querySelector("#replaceAllButton");n&&(n.disabled=!e)}function Se(){return{findString:s.value,replaceString:a?a.value:"",searchIn:x.zcombo(u,"getValue"),matchCase:l.checked,matchCell:d.checked,isNext:g.checked}}function fe(e){switch(e){case"workbook":return z.FIND_IN_WORKBOOK;case"sheet":return z.FIND_IN_SHEET;case"row":return z.FIND_IN_ROW;case"column":return z.FIND_IN_COL;case"range":return z.FIND_IN_RANGE;default:return z.FIND_IN_SHEET}}function pe(){i.close()}function De(){var e=E.view.getActiveGridID(),t=E.view.getResourceID(e),i=E.view.getVersionID(e),n=E.view.getSheetID(e),r=(E.view.getSelectedSheets(e),function(e,t,i,n){var r,o=E.data.Defaults,c=o.MAX_COL,s=o.MAX_ROW,a=E.view.getActiveGridID(),u=E.view.getSheetID(a),l=E.view.getSheetState(a,u),d=l.getActiveCellRange(),g=l.getActiveRange(),v=d.startRow,h=d.startCol;switch(n){case z.FIND_IN_ROW:r=new H(v,0,v,c-1);break;case z.FIND_IN_COL:r=new H(0,h,s-1,h);break;case z.FIND_IN_RANGE:g.isRowRange()||g.isColRange()||de(),r=N}return r}(0,0,0,fe(Se().searchIn)));j&&(!function(e,t,i){var n=E.view.getActiveGridID(),r=(t=E.view.getSheetID(n),E.view.getSheetState(n,t).getActiveCellRange());V.gotoCell(e,t,i,r,r.startRow,r.startCol)}(t,n,i),j=!1),r&&(!function(e,t,i,n){L.publish(T.Selector.BoundUpdate.Range,O.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:n})}(t,n,i,r),j=!0)}function ke(e,t){A==t||(A={col:t.col,row:t.row,sheet:t.sheet}),b&&(b.style.display="none"),Y=0}function me(e,t){var i,n;switch(fe(Se().searchIn)){case z.FIND_IN_WORKBOOK:n="Workbook";break;case z.FIND_IN_SHEET:n="Sheet";break;case z.FIND_IN_COL:n="Column";break;case z.FIND_IN_ROW:n="Row";break;case z.FIND_IN_RANGE:n="Range"}switch(e){case 0:i=P["Find.StartOf"+n];break;case 1:i=P["Find.EndOf"+n];break;case 2:t?i=1==t?P["Find.replaceMsgForOne"]:_.fn.replaceParams(P["Find.replaceMsg"],[t]):(ve("ERRORBANNER"),i=P["Find.NoMoreOccurrrence"])}b.querySelector(".shNtfyCtn").textContent=i,b.style.display="block",Y=1,F&&clearTimeout(F),F=setTimeout(he,3e3)}function we(e){e.contains("CannotFindSearch")&&(Y&&he(),ve("INFOBANNER"),me(2,0))}function Ae(e,t,i){return e>i.left&&e<i.right&&t>i.top&&t<i.bottom}function Ne(){if(J){var e=E.view.getActiveGridID(),t=E.view.getResourceID(e),n=E.view.getSheetID(e),r=E.view.getVersionID(e),o=E.view.getSheetState(e,n),c=o.getActiveCellRange(),s=o.getZoom(),a=E.data.getWorkBook(t,r).getSheetObj(n),u=a.Row.FreezedCount,l=a.Column.FreezedCount,d=a.Row.auxiliaryAxis,g=a.Column.auxiliaryAxis,v=i.getDialog(),h=X.gridTop,I=X.gridLeft,S={top:d.getPos(c.startRow)*s-(o.sTops[0]-d.getPos(u)*s),bottom:d.getPos(c.startRow+1)*s-(o.sTops[0]-d.getPos(u)*s),left:g.getPos(c.startCol)*s-(o.sLefts[0]-g.getPos(l)*s),right:g.getPos(c.startCol+1)*s-(o.sLefts[0]-g.getPos(l)*s)},f={top:v.offsetTop-h,bottom:v.offsetTop-h+v.offsetHeight,left:v.offsetLeft-I,right:v.offsetLeft-I+v.offsetWidth},p=Ae(S.left,S.top,f),D=Ae(S.right,S.top,f),k=Ae(S.right,S.bottom,f),m=Ae(S.left,S.bottom,f);(D||p||k||m)&&(window.innerWidth-S.right>=v.offsetWidth?v.style.left=S.right+I+"px":S.left>=v.offsetWidth&&(v.style.left=S.left-v.offsetWidth+I+"px"))}}function Fe(){return Q.Stack[Q.Stack.length-1]}function Ce(e){Q.focusContext(e)}function ye(e){te=!1,ce=!0,S=e.target}function be(){var e=U.getElementById("popupmenu"),t=U.createElement("ul");for(var i in t.id="quickFindMenu",t.setAttribute("data-ctype","zmenu"),t.setAttribute("data-content-type","icon-text"),ue){var n=U.createElement("li");if(n.id="quickFind_"+i,n.textContent=ue[i],"more"==i){var r=U.createElement("li");r.setAttribute("data-item-type","separator"),t.appendChild(r)}else"sheet"==i?(n.setAttribute("data-item-type","checkbox"),n.setAttribute("data-checked",!0)):n.setAttribute("data-item-type","checkbox");t.appendChild(n)}e.appendChild(t),x.bind(t,"zmenuitemclick",function(e,t){!function(e,t){switch(xe(),t.data.id){case"quickFind_range":$="range",h.placeholder=ue.range,x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_sheet"],"checked",!1),x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_wb"],"checked",!1);break;case"quickFind_wb":$="workbook",h.placeholder=ue.wb,x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_range"],"checked",!1),x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_sheet"],"checked",!1);break;case"quickFind_sheet":$="sheet",h.placeholder=ue.sheet,x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_range"],"checked",!1),x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_wb"],"checked",!1);break;case"quickFind_more":ae.openDialog(),y=Fe(),Ue(!0)}h.focus()}(0,t)})}function Ee(){p.classList.add("zsDisable"),f.classList.add("zsDisable")}function qe(){p.classList.remove("zsDisable"),f.classList.remove("zsDisable")}function Re(){""==h.value?Ee():qe(),I.innerText="",re="",xe()}function _e(){te=!1,Ue(!0),x.zmenu("#quickFindMenu","hide")}function Le(e){te&&Oe()}ae.openDialog=function(e,v,I,S){var f=E.view.getActiveGridID();v=v||E.view.getResourceID(f),S=S||E.view.getVersionID(f),I=I||E.view.getSheetID(f);var p=E.data.getWorkBook(v,S),D=1==E.data.UserInfo.Permission.isEditable?p.isEditable():E.data.UserInfo.Permission.isEditable,k={width:460,title:P[D?"Find.Dialog.Title":"Find.Title"],close:function(){J=!1,function(){var e=E.view.getActiveGridID(),t=(E.view.getResourceID(e),E.view.getVersionID(e),E.view.getSelectedSheets(e),E.view.getSheetID(e));E.view.getSheetState(e,t).getActiveCellRange(),A=void 0,he();for(var i=U.querySelectorAll(".cellSelection"),n=U.querySelectorAll(".fillSeriesCue"),r=0;r<i.length;r++)i[r].classList.remove("cellFndHlt"),n[r].classList.remove("dsp_none");L.unregister(T.Listener,O.CellAction.VALUE.FIND.SHOWERRORMSG,we),L.unregister(T.Listener,O.CellAction.VALUE.FIND.STATUS,ke),L.unregister(T.Listener,O.CellAction.VALUE.FIND.WRAP,me),L.unregister(T.Gesture.Selector.Range,O.GESTURE.ACTION.END,le),L.unregister(T.Selector.BoundUpdate.Cell,O.Selection.BOUND_UPDATE.ADD,Ne)}()},open:function(){s=t.querySelector("#searchInput"),h&&(s.value=h.value),Ie(),s.focus(),s.select(),a=t.querySelector("#replaceInput"),u=t.querySelector("#"+C),l=t.querySelector("#matchCaseChkBox"),d=t.querySelector("#matchCellChkBox"),t.querySelector("#dirUpRadio"),g=t.querySelector("#dirDownRadio"),setTimeout(function(){x.zcombo("#"+C,"setValue",$)},10)}};D?function(e,n){if(!o){c=ge("FIND_REPLACE_DIALOG",c);var r=(o=new R.Dialog(c,n)).getKeyContext(),s=r.keyDown;s[W.ENTER]=function(e){return e.stopPropagation(),!1},x.bind("#searchInComboFR","combochange",function(){De()})}C="searchInComboFR",i=o,t=c}(0,k):function(e,o){if(!n){r=ge("FIND_DIALOG",r);var c=(n=new R.Dialog(r,o)).getKeyContext(),s=c.keyDown;s[W.ENTER]=function(e){return e.stopPropagation(),!1},x.bind("#searchInCombo","combochange",function(){De()})}C="searchInCombo",t=r,i=n}(0,k),i.open(),J=!0,le(),L.register(T.Listener,O.CellAction.VALUE.FIND.SHOWERRORMSG,we,"ERRORMSG"),L.register(T.Listener,O.CellAction.VALUE.FIND.STATUS,ke,"STATUS","RESPONSE"),L.register(T.Listener,O.CellAction.VALUE.FIND.WRAP,me,"isEOS","replaceCount"),L.register(T.Gesture.Selector.Range,O.GESTURE.ACTION.END,le),L.register(T.Selector.BoundUpdate.Cell,O.Selection.BOUND_UPDATE.ADD,Ne)},ae.quickFind=function(e){se?(e,Oe()):ae.openDialog()};var Te=!1;function Oe(){te=!0,ce=!1,!Te&&(L.register(T.Listener,O.Browser.WINDOW.VISIBILITY_CHANGE,Le,"visible"),Te=!0),D.style.display="block";var e=U.querySelector("#ancBnr");!w&&(w=D.offsetTop),!Z&&e&&"none"!=e.style.display?(D.style.top=w+X.Top.announcementBanner+"px",Z=!0):Z&&e&&"none"==e.style.display&&(D.style.top=w+"px"),Pe();var t=E.view.Events.Key.Entry.QuickFind.Context;Fe()!=t&&(y=Fe()),h.focus(),h.select(),Ce(Q.Entry.QuickFind.Context),k.classList.add("shDummyAni"),U.querySelector(".mainGrid").addEventListener("mousedown",_e),U.addEventListener("mousedown",ye),""!=h.value&&(I.innerText=""==re?"":ne+" / "+re,qe())}function Ue(e){if(!0!==e){if(S)switch(S.hasAttribute&&S.hasAttribute("xlink:href")?S.parentNode.parentNode.id:""==S.id?S.parentNode.id:S.id){case"quickFindPopup":case"quickFindMoreIcon":case"quickFind_wb":case"quickFind_sheet":case"quickFind_range":case"quickPrev":case"quickNext":case"quickMenu":case"quickFind":return te=!0,void h.focus();default:te=!1}te=!ce&&!e.relatedTarget}else te=!1;D.style.display="none",k.classList.remove("shDummyAni"),U.querySelector(".mainGrid").removeEventListener("mousedown",_e);for(var t=U.querySelectorAll(".cellSelection"),i=U.querySelectorAll(".fillSeriesCue"),n=0;n<t.length;n++)t[n].classList.remove("cellFndHlt"),i[n].classList.remove("dsp_none");Ce(y||Q.Entry.CellEditor.Context),I.innerText="",xe(),U.removeEventListener("mousedown",ye),!te&&(Te&&L.unregister(T.Listener,O.Browser.WINDOW.VISIBILITY_CHANGE,Le),Te=!1)}function xe(){ie=!0}function Me(){ie=!1}function Be(e,t){h.value&&(Ge(e,{findString:h.value,replaceString:"",isNext:t,matchCase:!1,matchCell:!1,searchIn:$}),Me())}function Pe(){if(oe){var e=E.view.getActiveGridID(),t=E.view.getResourceID(e),i=E.view.getSheetID(e),n=E.view.getVersionID(e),r=E.view.getSheetState(e,i).getActiveRange(),o=$;ee||"workbook"!=o?"sheet"==$&&(ee=!1):ee=!0;var c=E.data.getWorkBook(t,n).getSheetObj(i);c.Merge.isXists(r.startRow,r.startCol)&&c.Merge.isXists(r.endRow,r.endCol)||r.isSingle()?"range"==$&&(ee?(m&&(m.innerText=ue.wb),h&&(h.placeholder=ue.wb),$="workbook"):(m&&(m.innerText=ue.sheet),h&&(h.placeholder=ue.sheet),$="sheet"),x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_range"],"checked",!1),x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_wb"],"checked",ee),x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_sheet"],"checked",!ee)):(m.innerText=ue.range,h.placeholder=ue.range,$="range",x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_wb"],"checked",!1),x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_range"],"checked",!0),x.zmenu("#quickFindMenu","setMenuItemsAttribute",["#quickFind_sheet"],"checked",!1),de()),o!=$&&xe()}}function Ge(e,t){!1;var i=E.view.getActiveGridID(),n=E.view.getResourceID(i),r=E.view.getVersionID(i),o=E.view.getSelectedSheets(i);!A||-1!=A.row&&-1!=A.col||(A=void 0);var c=E.view.getSheetID(i),s=E.view.getSheetState(i,c).getActiveRange();s.isColRange()||s.isRowRange()||(N=s),Y&&he(),!t&&ve("INFOBANNER");var a=t||Se(),u=!!t;!u&&Me(),V.Find(n,c,o,r,a.findString,a.isNext,a.matchCase,a.matchCell,fe(a.searchIn),A,u,ie)}function We(){!0;var e=E.view.getActiveGridID(),t=E.view.getResourceID(e),i=E.view.getVersionID(e),n=E.view.getSelectedSheets(e),r=E.view.getSheetID(e);Y&&he(),ve("INFOBANNER");var o=Se();V.Replace(t,r,n,i,o.findString,o.replaceString,o.isNext,o.matchCase,o.matchCell,fe(o.searchIn))}function ze(){var e=E.view.getActiveGridID(),t=E.view.getResourceID(e),i=E.view.getVersionID(e),n=E.view.getSelectedSheets(e),r=Se();Y&&he(),ve("INFOBANNER"),V.ReplaceAll(t,n,i,r.findString,r.replaceString,r.isNext,r.matchCase,r.matchCell,fe(r.searchIn))}L.register(T.UI,O.Layout.TEMPLATE_LOADED,function(){if(se){oe=!0;var e=V.getTemplate(["QUICK_FIND","QUICK_FIND_POPUP"]),t=e.QUICK_FIND,i=e.QUICK_FIND_POPUP;U.body.appendChild(i),D=U.querySelector("#quickFindPopup"),(h=D.querySelector("#quickFind")).placeholder=ue.sheet,h.addEventListener("input",Re),h.addEventListener("blur",Ue),I=D.querySelector("#quickCount"),(f=D.querySelector("#quickNext")).addEventListener("click",function(e){Be(e,!0)}),(p=D.querySelector("#quickPrev")).addEventListener("click",function(e){Be(e,!1)}),Ee(),(k=t.querySelector(".shFindDummy")).addEventListener("click",Oe),m=k.querySelector("#dummyTB"),se.appendChild(t),be(),D.querySelector("#quickMenu").setAttribute("data-menu-id","quickFindMenu")}}),L.register(T.Listener,O.CellAction.VALUE.FIND.QUICKFIND,Be,"ev","isNext"),L.register(T.Listener,O.CellAction.VALUE.FIND.BLURQUICKFIND,_e),L.register(T.Selector.DomUpdate.Range,O.Selection.BOUND_UPDATE.ADD,Pe),L.register(T.Listener,O.CellAction.VALUE.FIND.QUICKCOUNTUPDATE,function(e,t){var i,n;-1===e.row||-1===e.col?i=0:e.nom?(i=e.nom,n=e.ma):(i=re,t?(n=ne+1)>i&&(n=1):(n=ne-1)<1&&(n=i)),qe(),re=i,ne=n,I.innerText=""==re||""==ne?"":ne+" / "+re,i||(I.innerText="0 / 0")},"resp","isNext")}(this);
!function(e){var t,o,n,i=e.sPlusPlus,r=e.document,s=e.UIUtil.Component,a=e.ZSClass,c=e.ZSConstants.FeatureConstants,u=e.ZSConstants.I18N,v=a.Editors,l=e.ZSEvents,d=l.topic,m=l.Groups,p=l.Names,g=e.ZSConstants.wCC;function E(){var e;(e=i.view.Events.Key).focusContext(e.Entry.DocName.Context);var n=i.view.getActiveGridID(),r=i.view.getResourceID(n),s=(i.view.getSheetID(n),i.view.getVersionID(n)),a=(i.data.getWorkBook(r,s),o.querySelector("#tbDocNameInput"));a.value=t.innerText,a.focus(),a.select()}function D(e){13==(e.keyCode||e.which)&&n.value&&(I(),e.stopPropagation())}function I(){var e=i.view.getActiveGridID(),o=i.view.getResourceID(e),r=i.view.getVersionID(e),c=i.data.getWorkBook(o,r).Name,v=n.value;if(v&&0!==v.trim().length){if(v.length>255&&(v=v.substring(0,255)),v===c)return void s.zpopover(t,"close");t.innerText=v,t.title=v,UserAction.RenameDocument(o,r,encodeURIComponent(v)),s.zpopover(t,"close")}else a.ZSAlert(u["Topband.SpreadsheetName.EmptyErrorMsg"],{title:u["Rename.InvalidDocumentName"]})}i.view.Toolbar.Feature[c.RENAME].openDialog=function(){s.zpopover(t,"open",{target:t})},d.register(m.UI,p.Layout.TEMPLATE_LOADED,function(){if(-1==ZSConstants.Meta.HideFeaturesList.indexOf(c.RENAME)){t=r.getElementById(g.MI+"DOCNAME"+g.HOLDER);var e=UserAction.getTemplate(["docNameTemplate"]).docNameTemplate;(o=r.createElement("div")).appendChild(e);var a=UIUtil.Component.getJQueryElement(o);s.zpopover(t,{isContentHTMLEncoded:!0,className:"shRenameAni",content:a,open:function(){setTimeout(function(){var e,t,o,n,r;e=E,t=i.view.getActiveGridID(),o=i.view.getResourceID(t),n=i.view.getVersionID(t),(r=i.data.DocRegistry[o].isNewDoc)?UserAction.changeDocStatus(o,n,r,e()):e()},100)},close:function(){setTimeout(function(){var e;(e=i.view.Events.Key).focusContext(e.Entry.CellEditor.Context)},50)}}),function(e){var t=e.querySelector("#tbDocNameInput"),o=e.querySelector("#tbDocNameBtn");(n=new v.TextAreaEditor(t)).addListeners({keydown:D}),o.addEventListener("click",I)}(o)}}),d.register(m.Listener,p.Browser.RESIZE,function(){s.zpopover(t,"close")})}(this);
!function(e){var t,l,i=e.sPlusPlus,r=e.ZSConstants.FeatureConstants,a=e.document,n=e.ZSConstants.I18N,o=(e.ZSConstants.wCC,e.ZSConstants.JSKeyCode),s=e.ZSClass,c=(s.Editors.RangeEditor,s.Editors.Utility,s.Editors),u=(e.UIUtil.Component,e.ZSEvents),v=u.topic,d=u.Groups,g=u.Names,h=e.JSUtil,f=void 0,S=void 0,y=void 0,p=void 0,k=void 0,m=void 0,I=void 0,b=void 0,E=void 0,N=void 0,D=i.view.Toolbar.Feature[r.HYPERLINK],L={0:"WEB_LINK",1:"INDOCUMENT",2:"EMAIL_LINK",3:"PHONENO"},A={WEB_LINK:"webLink",INDOCUMENT:"pDocLink",EMAIL_LINK:"emailLink",PHONENO:"telLink"},q={},w=!1;function R(){var e,t=i.view.getActiveGridID(),l=E.rID,r=E.sheetID,a=E.version,n=i.data.getWorkBook(l,a).getSheetObj(r).Prop.getName(),o=i.view.getSheetState(t,r).getActiveCellRange().getLabel(),s=x(this.id),c=J(l,r,a),u=c.tab;s!=u?(e=T(s,!1),c.tab=s):(e=T(u,!1),c.tab=u),""!=e.text&&(c.cellVal=e.text),""!=e.link?c.cellhyperlink=e.link:s==L[1]?c.cellhyperlink=n+"."+o:c.cellhyperlink="",w=!0,C(c)}function x(e){if(e){var t=N.querySelector("li[name=hyperlink].active"),l=t.id;if(e!=l)t.removeAttribute("class"),N.querySelector("#"+l+"_content").style.display="none";N.querySelector("#"+e).className="active",N.querySelector("#"+e+"_content").style.display="block"}else e=N.querySelector("li[name=hyperlink].active").id;return Object.keys(A)[Object.values(A).indexOf(e)]}function T(e,t){var l,i,r=e;return r==L[0]?l=function(){var e=f.value;if(e){var t=e.substring(0,e.indexOf(":"));t=""==t?e.substring(0,e.indexOf(".")):t;var l=/^(https|www|http|gopher|telnet|nntp|rlogin|url)$/.test(t);l||(e="https://"+e)}return{link:e,text:S.value}}():r==L[1]?l=function(e){return{link:e?"#"+y.value:y.value,text:p.value}}(t):r==L[2]?l=function(){var e=k.value;e.indexOf("mailto:");return{link:e,text:m.value}}():r==L[3]&&(l={link:-1==(i=I.value).indexOf("tel:")&&i?"tel:"+i:i,text:b.value}),l}function C(e){var t=e.tab,l=e.cellVal,r=e.cellhyperlink;if(t==L[0])!function(e,t){f.value=t,S.value=e,f.focus()}(l,r);else if(t==L[1]){var a;if(!w&&r){var n=i.view.getActiveGridID(),o=i.view.getResourceID(n),s=i.view.getVersionID(n),c=(i.view.getSheetID(n),i.data.getWorkBook(o,s));if(-1!=r.indexOf(".")){var u=r.split(".")[0],v=r.split(".")[1],d=u.substr(1,u.length),g=c.getSheetObj(d);if(g)r=g.Prop.getName()+"."+v;else a=r="#REF!."+v}}F(l,a?r:-1!=r.indexOf("#")?r.substring(1,r.length):r),y.valueChanged(),w=!1}else t==L[2]?function(e,t){k.value=t,m.value=e,k.focus()}(l,r):t==L[3]&&function(e,t){I.value=t,b.value=e,I.focus()}(l,r)}function O(){f.value="",S.value="",y.value="",p.value="",k.value="",m.value="",I.value="",b.value=""}function U(){var e=[],t=N.querySelector("#NamedRangeTab").querySelector("ul"),l=N.querySelector("#SheetNamesTab").querySelector("ul");e.push(t),e.push(l);for(var i=0;i<e.length;i++)for(;e[i].hasChildNodes();)e[i].removeChild(e[i].lastChild)}function P(e,t){var l=null==t?e:e+"."+t;y.value=l,y.focus(),y.valueChanged(),p.value||(p.value=l)}function B(e,t,l,i,r,a){P(e.target.getAttribute("range"),null),y.valueChanged(),Y(r),a.classList?a.classList.add("highlightSelection"):a.className+=" highlightSelection"}function V(e,t,l,r,a,n){var o=i.view.getActiveGridID(),s=i.view.getSheetState(o,l).getActiveCellRange().getLabel(),c=e.target.getAttribute("range"),u=y.value,v=u.indexOf("."),d=s;-1!=v&&(d=u.substring(v+1,u.length)),P(c,d),Y(a),n.classList?n.classList.add("highlightSelection"):n.className+=" highlightSelection"}function H(e,t,l,i,r,n,o,s){var c=a.createElement("li");c.className="txtOverflow curPtr",o||(o=r),c.title=o,c.setAttribute("range",r),c.addEventListener("click",function(){n(event,e,t,l,s,c)}),c.innerText=r,i.appendChild(c)}var W=/[^a-zA-Z]/g,G=/[^0-9]/g;function Z(e,t){var l=parseInt(e,10),i=parseInt(t,10);if(isNaN(l)&&isNaN(i)){var r=e.replace(W,""),a=t.replace(W,"");if(r===a){var n=parseInt(e.replace(G,""),10),o=parseInt(t.replace(G,""),10);return n===o?0:n>o?1:-1}return r>a?1:-1}return isNaN(l)?1:isNaN(i)?-1:l>i?1:-1}function _(e,t){return i.data.getWorkBook(e,t).SheetList.getAllSheetNames()}function K(e,t){return i.data.getWorkBook(e,t).NamedRange.getAllKeys()}function J(t,l,r){var a=N.querySelector("#removeLinkBtn"),n={},o=function(t,l,r){var a=i.view.getActiveGridID(),n=(i.data.getWorkBook(t,r).getSheetObj(l),i.view.getSheetState(a,l).getActiveCellRange()),o={};return i.view.fetchCellData(t,l,r,n.startRow,n.startCol,["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType","hasLink"],a,function(e){o.displayValue=e[n.startRow][n.startCol].DisplayValue,o.hyperlink=e[n.startRow][n.startCol].Hyperlink,o.hasLink=e[n.startRow][n.startCol].hasLink},function(t){e.ZSClass.Logger.log("couldn't retrieve data",t)}),o}(t,l,r),s=o.displayValue,c=o.hyperlink,u=o.hasLink;c||1!=u||(c=function(e){for(var t=h.Cell.splitDisplayValue(e),l=0;l<t.length;l++)if(h.Cell.isWhiteListed(t[l])||t[l].startsWith("www."))return t[l]}(s));var v=L[0];return c?(a.style.display="block",c.startsWith("#")?v=L[1]:c.startsWith("mailto:")?v=L[2]:c.startsWith("tel:")&&(v=L[3])):a.style.display="none",n.cellVal=null!=s?s:"",n.cellhyperlink=null!=c?c:"",n.tab=v,n}function F(e,t){y.value=t,p.value=e,y.focus()}function j(e){return 0===e.length||!e.trim()}function M(t,l,r){l=E.sheetID;var a=i.view.getActiveGridID(),n=i.view.getSheetID(a);l!=n?e.UserAction.SwitchSheet(t,n,r,l,void 0,!1,X):X()}function X(){var t=E.rID,l=E.version,r=x(),a=T(r,!0),o=a.link,c=a.text,u=(E.sheetID,i.view.getActiveGridID()),v=(i.view.getSheetID(u),o),d=y.value;if(r==L[1]&&-1!=d.indexOf(".")){var g=i.data.getWorkBook(t,l),h=d.split(".")[0],f=d.split(".")[1],S=g.SheetList.getIdByName(h);v="#"+S+"."+f}c||(c=r==L[1]&&-1!=o.indexOf("#")?o.substring(1,o.length):o),function(e,t,l,i){var r=e;if(t==L[2]){var a=JSUtil.REGEXP.validEmail;if(!a.test(r))return s.ZSAlert(n.PleaseEnterValidEmailAddress,{title:n["Alert.Title.InvalidEmail"]}),!1}else if(t==L[0]){var a=JSUtil.REGEXP.validURL;if(!a.test(r))return s.ZSAlert(n["Error.Hyperlink.Invalid.Url"],{title:n["Alert.Title.InvalidURL"]}),!1}else if(t==L[3]){var a=JSUtil.REGEXP.phoneNo;if(!a.test(r))return s.ZSAlert(n.PhoneNumberValidation,{title:n["Alert.Title.InvalidPhone"]}),!1}else{var r=y.value,o=(JSUtil.REGEXP.rangeTest.test(r),K(l,i)),c=function(e,t,l){for(var i=_(e,t),r=0;r<i.length;r++)if(i[r]===l)return!0;return!1}(l,i,r),u=c||JSUtil.REGEXP.rangeTest.test(r)||o.has(r);if(!u)return s.ZSAlert(n["Hyperlink.validInDocument"],{title:n["Alert.Title.InvalidCellRange"]}),!1}return!0}(o,r,t,l)&&o&&setTimeout(function(){e.UserAction.HyperLink(E.rID,[E.sheetID],E.version,"add",c,v),E.close()},10)}function z(e){var i=E.rID,r=E.version,a=function(e,t,i){var r=l,a=Array.from(r);Y("#NamedRangeTab");for(var n=0;n<a.length;n++)if(i==a[n]){var o=N.querySelectorAll("#NamedRangeTab > ul > li")[n];o.classList?o.classList.add("highlightSelection"):o.className+=" highlightSelection";var s=N.querySelector("#NamedRangeTab");return s.scrollTop=o.offsetTop,!0}return!1}(0,0,e);!function(e,t,l){var i=_(e,t);Y("#SheetNamesTab");for(var r=0;r<i.length;r++){var a=l.substring(0,l.indexOf("."));if(i[r]==a){var n=N.querySelectorAll("#SheetNamesTab > ul > li")[r];n.classList?n.classList.add("highlightSelection"):n.className+=" highlightSelection";var o=N.querySelector("#SheetNamesTab");return o.scrollTop=n.offsetTop,!0}}}(i,r,e);t=a?"#NamedRange":"#sheetNames"}function Y(e){for(var t=N.querySelectorAll(e+" > ul > li"),l=0;l<t.length;l++)t[l].classList&&t[l].classList.remove("highlightSelection")}D.openDialog=function(r){var u=i.view.getActiveGridID(),h=i.view.getResourceID(u),L=i.view.getSheetID(u),w=i.view.getVersionID(u);if(D.isSingleCell()){var x={width:570,title:n["MenuItem.InsertTab.Hyperlink"],close:function(){O(),U(),q={}},open:function(){var e,t,l,r,a,n,o,s;e=E.rID,t=E.gridID,l=E.sheetID,r=E.version,a=i.data.getWorkBook(e,r).getSheetObj(l),n=i.view.getSheetState(t,l).getRanges(),o=J(e,l,r),s=o.tab,o.cellVal,o.cellhyperlink,N.querySelector("#"+A[s]).click(),C(o),a.Picklist.isXists(n[0].startRow,n[0].startCol)?(N.querySelector("#displayURLtxt").disabled=!0,N.querySelector("#displayplaceInDoctxt").disabled=!0,N.querySelector("#displayemaillinktxt").disabled=!0,N.querySelector("#displayphonenumbertxt").disabled=!0):(N.querySelector("#displayURLtxt").disabled=!1,N.querySelector("#displayplaceInDoctxt").disabled=!1,N.querySelector("#displayemaillinktxt").disabled=!1,N.querySelector("#displayphonenumbertxt").disabled=!1)}};E||(function(l,i,r){var n=e.UserAction.getTemplate(["hyperlinkTemplate"]).hyperlinkTemplate;(N=a.createElement("div")).id="DI_HYPERLINK",N.appendChild(n),N.classList.add("hlD"),N.classList.add("hlDResize");for(var o=N.querySelectorAll("li[name=hyperlink]"),s=0;s<o.length;s++)o[s].addEventListener("click",R);N.querySelector("#openaccordion").addEventListener("click",function(){this.querySelector("#sheetListTabs").classList.toggle("dsp_none"),this.querySelector("#openaccordion").classList.toggle("openAccActive"),this.classList.toggle("hlDResize"),j(y.value)||z(y.value),this.querySelector(t).click()}.bind(N)),N.querySelector("#removeLinkBtn").addEventListener("click",function(){D.Clear(),E.close()}),N.querySelector("#okBtn").addEventListener("click",function(){M(l,i,r)}),N.querySelector("#clBtn").addEventListener("click",function(){E.close()})}(h,L,w),E=new s.Dialog(N,x),function(){var e=N.querySelector("#URLtxt");f=new c.TextAreaEditor(e);var t=N.querySelector("#displayURLtxt");S=new c.TextAreaEditor(t);var l=N.querySelector("#placeInDoctxt");y=new c.RangeEditor(l),s.RangePicker.register(y,!0);var i=N.querySelector("#HrangePickerIcon");s.RangePicker.Dialog.register(y,E,i,"Hyperlink");var r=N.querySelector("#displayplaceInDoctxt");p=new c.TextAreaEditor(r);var a=N.querySelector("#emaillinktxt");k=new c.TextAreaEditor(a);var n=N.querySelector("#displayemaillinktxt");m=new c.TextAreaEditor(n);var o=N.querySelector("#phonenumbertxt");I=new c.TextAreaEditor(o);var u=N.querySelector("#displayphonenumbertxt");b=new c.TextAreaEditor(u)}()),function(e,t,r){var a=i.data.getWorkBook(e,r),o=K(e,r),s=Array.from(o).sort(Z);l=s;var c=N.querySelector("#NamedRangeTab").querySelector("ul"),u=s.length;if(0!=u){s.keys();for(var v=0;v<u;v++){var d=s[v],g=a.NamedRange.get(d);q[d]=g;var h=JSUtil.FormRange(g);h.contains("#REF!")||H(e,t,r,c,d,B,h,"#NamedRangeTab")}}else{var f=document.createElement("li");f.innerText=n["Hyperlink.NonamesDefined"],f.className="noHover",c.appendChild(f)}}(h,L,w),function(e,t,l){for(var i=_(e,l),r=N.querySelector("#SheetNamesTab").querySelector("ul"),a=0;a<i.length;a++){var n=i[a];H(e,t,l,r,n,V,"","#SheetNamesTab")}}(h,L,w),E.open(),E.rID,E.sheetID,E.version,E.getKeyContext().keyDown[o.ENTER]=function(e,t,l,i){return M(t,l,i),e.preventDefault(),!1},v.publish(d.Selector.BoundUpdate.CellEdit,g.Selection.BOUND_UPDATE.REMOVE,{RID:E.rID,SHEETID:E.sheetID,VERSION:E.version,isSubmittable:!0}),N.querySelector("#sheetListTabs").classList.contains("dsp_none")||(j(y.value)||z(y.value),N.querySelector(t).click()),r.preventDefault()}}}(this);
!function(e){var t,r,o,n,a,i,l=e.sPlusPlus,c=e.document,s=e.UserAction,d=e.ZSConstants.FeatureConstants,u=e.ZSConstants.I18N,v=e.UIUtil.Component,S=e.ZSClass,g=e.ZSEvents,f=g.topic,h=g.Groups,R=g.Names,C=e.JSUtil,w="FALSE",y="TRUE",A="FALSE",p=l.view.Toolbar.Feature[d.SORT];function D(){var d=e.UserAction.getTemplate(["SORT","SORT_BY"]),g=d.SORT,f=d.SORT_BY,h={modal:!0,width:400,title:u["MenuItem.DataTab.Sort.CustomSort"],dialogClass:"",close:function(){r.querySelector("#groupHolder").innerHTML=""}};t||((r=c.createElement("div")).id="DI_SORT",r.appendChild(g),t=new S.Dialog(r,h),function(){r.querySelector("#okBtn").addEventListener("click",m),r.querySelector("#clBtn").addEventListener("click",function(){t.close()}),r.querySelector("#containsHeader").addEventListener("click",E),r.querySelector("#caseSenstive").addEventListener("click",T);for(var e=r.querySelectorAll("[name=orientation]"),o=0;o<e.length;o++)e[o].addEventListener("click",b)}()),function(e){for(var t="",n=0;n<3;n++){var i,c=e.cloneNode(!0);i=0==n?u.Sort:u.Thenby;var d={sortHeader:"sortHeader"+n,GroupLabel:i,ascendingRadio:"ascendingRadio"+n,descendingRadio:"descendingRadio"+n,thenby:"thenby"+n},v=c.children[0].outerHTML,S=s.renderJsTemplate(v,d);t+=S}r.querySelector("#groupHolder").innerHTML=t,I(o=function(){var e=l.view.getActiveGridID(),t=l.view.getResourceID(e),r=l.view.getSheetID(e),o=l.view.getVersionID(e),n=l.data.getWorkBook(t,o).getSheetObj(r).MaxUsedCol,i=l.data.Defaults,c=a,s=new Array;s.push(u.None),c.endCol+1===i.MAX_COL&&(c.endCol=n);for(var d=c.startCol;d<=c.endCol;d++){var v=q(d+1),S=C.fn.replaceParams(u["Sort.Orientation.Column"],[v]);s.push(S)}return s}(),!1)}(f),H(r.querySelector("#containsHeader"),!1),y="TRUE",H(r.querySelector("#caseSenstive"),!0),H(r.querySelector("#topBottom"),!0),v.initComponent(r);var R="true"==i,A=r.querySelector("#containsHeader");R&&(k(A,!1),w="TRUE",A.click()),t.open(),n=function(){var e=l.data.getWorkBook(t.rID,t.version).getSheetObj(t.sheetID).MaxUsedRow,r=l.data.Defaults,o=a,n=new Array;n.push(u.None),o.endRow+1===r.MAX_ROW&&(o.endRow=e);for(var i=o.startRow;i<=o.endRow;i++){var c=C.fn.replaceParams(u["Sort.Orientation.Row"],[i+1]);n.push(c)}return n}(),O()}function m(){var e=function(){for(var e=new Array,t=r.querySelector("#groupHolder"),o=t.querySelectorAll("select"),n=0;n<o.length;n++){var a={},i=o[n].selectedIndex-1;a.f=i;var l="FALSE",c=t.querySelector("[name=thenby"+n+"]").checked;c&&(l="TRUE"),a.s=l,e.push(a)}return e}(),o=w,n=y,i=A,c=l.view.getActiveGridID(),d=l.view.getResourceID(c),u=l.view.getVersionID(c),v=(l.data.getWorkBook(d,u),l.view.getSelectedSheets(c));s.executeSort(d,v,u,e,a,i,o,n),t.close()}function E(){(w=r.querySelector("#containsHeader").checked)?(w="TRUE",function(){var t=l.view.getActiveGridID(),r=l.view.getVersionID(t),o=l.view.getResourceID(t),n=l.view.getSheetID(t),a=l.data.getWorkBook(o,r),i=l.view.getSheetState(t,n).getActiveRange(),c=i.startRow,s=i.startCol,d=(i.endRow,i.endCol),v=a.getSheetObj(n).MaxUsedCol,g=l.data.Defaults,f=new S.Range(c,s,c,d);f.endCol+1===g.MAX_COL&&(f.endCol=v);var h=new Array;h.push(u.None);l.view.fetchRangeData(o,n,r,f,["DisplayValue"],!1,t,function(e){for(var t=f.startCol;t<=f.endCol;t++)if(A&&""===e[f.startRow][t].DisplayValue){var r=q(t+1),o=C.fn.replaceParams(u["Sort.Orientation.Column"],new Array(r));h.push(o)}else h.push(e[f.startRow][t].DisplayValue);I(h,!0)},function(t){e.ZSClass.Logger.log("Couldnt retrieve cell content",t)})}()):I(o,!0)}function T(){var e=r.querySelector("#caseSenstive").checked;y=e?"TRUE":"FALSE"}function b(e){var t,a=e.target.id,i=r.querySelector("#containsHeader");"topBottom"===a?(t=o,H(i,!1),k(i,!1),O()):(A="TRUE",t=n,H(i,!1),k(i,!0)),I(t,!0)}function I(e,t){var o=r.querySelectorAll("select"),n=e.length;n-1;for(var a=0;a<o.length;a++){o[a].innerHTML="";for(var i=0;i<n;i++){var l=c.createElement("option");l.innerText=e[i],o[a].appendChild(l)}v.bind("#"+o[a].id,"zselectboxchange",L)}!function(){for(var e=r.querySelectorAll("select"),t=0;t<e.length;t++)v.zcombo(e[t],"refresh")}(),r.querySelector("#sortHeader0").selectedIndex=1,v.zcombo("#sortHeader0","setAttribute","selectedIndex",1),function(e){for(var t=e,o=r.querySelector("#groupHolder").childNodes,n=0;n<o.length;n++){var a=o[n].querySelectorAll("div")[1];t-1<n?a.classList.add("zsDisable"):a.classList.remove("zsDisable")}}(n>3?3:n-1),L()}function L(){var e=v.zcombo("#sortHeader0","getValue"),t=v.zcombo("#sortHeader1","getValue"),r=v.zcombo("#sortHeader2","getValue");"None"==e&&"None"==t&&"None"==r||"None"==e?v.disable("#okBtn"):v.enable("#okBtn")}function q(e){if(e){if(e<=26)return String.fromCharCode(e+64);var t=e%26,r=Math.floor(e/26);return 0===t?q(r-1)+"Z":q(r)+String.fromCharCode(t+64)}}function H(e,t){e.checked=!!t}function k(e,t){e.disabled=t?"disabled":""}function O(){var e=r.querySelector("#containsHeader"),o=l.view.getSheetState(t.gridID,t.sheetID).getActiveRange(),n=l.data.Defaults;o.endCol+1===n.MAX_COL&&o.endRow-o.startRow==0&&(k(e,!0),w="FALSE")}f.register(h.Listener,R.CellAction.VALUE.CUSTOM_SORT_EXPANDRANGE,function(e,t){a=e,i=t,D()},"ACTIVERANGE","HEADER_DETAILS"),p.openDialog=D}(this);
!function(e){var t,r,o,a,n,i,l,c,s,u,d,S=e.sPlusPlus,p=e.ZSConstants,v=e.ZSClass,g=e.UIUtil.Component,f=p.FeatureConstants,T=e.document,h=p.I18N,C=(p.wCC,e.ZSEvents),m=C.topic,y=C.Groups,b=C.Names,k=e.UserAction,w=v.Editors,D=(v.Editors.RangeEditor,"none"),O=[],I=!1,R={},A={},q=!1,E=void 0,x="~`!@#$%^&*()_-+={[}]|\\;:'?/>.<,\t \"",L=S.view.Toolbar.Feature[f.TEXT_TO_COLUMN],U={},N=["tabSeparator","commaSeparator","otherSeparator","spaceSeparator","semicolonSeparator","mergeDelimiters","textDelimiter"],V={tabSeparator:"\t",commaSeparator:",",spaceSeparator:" ",semicolonSeparator:";"};function M(){if(q)_(c);else{d=[];if(-1==function(t){var r=S.view.getActiveGridID(),o=S.view.getResourceID(r),a=S.view.getSheetID(r),n=S.view.getVersionID(r),i=S.view.getSheetState(r,a),l=S.data.getWorkBook(o,n).getSheetObj(a),c=i.getActiveRange(),s=(c.startRow,c.startCol),u=(c.endRow,c.endCol),d=l.Merge.getInfo(c.startRow,c.startCol),p=d&&d.equals(c);if(c.isRow()||s!=u&&!p)return-1;c.isCol()&&(c.endRow=14);S.view.fetchRangeData(o,a,n,c,["DisplayValue"],!0,r,t,function(t){e.ZSDevTools.Logger.log("couldn't retrieve data",t)})}(function(e){!function(e){var t=S.view.getActiveGridID(),r=S.view.getResourceID(t),o=S.view.getVersionID(t),a=S.view.getSheetID(t),n=S.data.getWorkBook(r,o).getSheetObj(a);for(var i in e)for(var l in e[i]){var c=n.Merge.isXists(parseInt(i),parseInt(l)),s=e[i][l].DisplayValue;if(""!==s&&(!c||c&&c.isRoot)){var u=[s];d.push(u)}}_(d)}(e)}))return void v.ZSAlert(h["TexttoColumns.ConvertsOneColumnAtATime"],{title:h["Alert.Title.InvalidCellRange"]})}}function _(d){if(0!=d.length){void 0==n&&(n=d,i=d);var p=k.getTemplate(["TEXTTOCOLUMN"]);o=p.TEXTTOCOLUMN;var f,C,m,y,b,R,L={width:540,title:h["MenuItem.DataTab.TextToColumns"],dialogClass:"txtCol",close:function(){A={},n=void 0,i=void 0,I=!1,O=[],W(),r.querySelector("#importSettings").style.display="none",q=!1,c=void 0,E=void 0,F(1),u.resetTempValue(),r.querySelector("#otherSeparatorValue").value=""},open:function(){(function(e){var t;switch(e){case"\t":t=N[0];break;case",":t=N[1];break;case" ":t=N[3];break;case";":t=N[4];break;default:r.querySelector("#otherSeparatorValue").value=e,t=N[2]}r.querySelector("#"+t).checked=!0,P(t)})(new k.DelimiterDetector(n.join("\n"),{ignoreEmptyLines:!0},x).detect(['"'])),s&&r.querySelector("#"+s+"Separator").click()}};t||((r=T.createElement("div")).id="DI_TEXTTOCOLUMN",r.appendChild(o),function(){if(S.data.AppRegistry.localeInfo){var t=S.data.AppRegistry.localeInfo.CURRENCY_LIST;t.sort(function(e,t){var r=e.COUNTRY.toUpperCase(),o=t.COUNTRY.toUpperCase();return r<o?-1:r>o?1:0});for(var o=r.querySelector("#importLocale"),a=0;a<t.length;a++){var n=T.createElement("option"),i=t[a].KEY,l=i.substring(i.indexOf(0),i.indexOf("(")),c=i.substring(i.indexOf("(")+1,i.length-1);n.value=l+"_"+c,n.innerText=t[a].COUNTRY+" ( "+t[a].LANGUAGE+" )",o.appendChild(n)}}else e.ZSDevTools.Logger.log("Locale Info Empty. Please chcek API call response")}(),r.querySelector("#submit").addEventListener("click",X),r.querySelector("#cancel").addEventListener("click",function(){t.close()}),t=new e.ZSClass.Dialog(r,L),function(){var e=r.querySelector("#destinationCell");a=new w.RangeEditor(e),v.RangePicker.register(a,!0);var o=r.querySelector("#rangePickerIcon");v.RangePicker.Dialog.register(a,t,o,h["MenuItem.DataTab.TextToColumns"])}(),function(){for(var e=r.querySelectorAll("input[type=checkbox]"),t=0;t<e.length;t++)e[t].addEventListener("click",P.bind(null,e[t].id))}(),r.querySelector("#otherSeparatorValue").addEventListener("keyup",function(e){r.querySelector("#otherSeparator").checked=!0,P(e.target.id)}),r.querySelector("#otherSeparatorValue").addEventListener("click",function(e){r.querySelector("#otherSeparator").checked=!0,P(e.target.id)}),g.bind("#textDelimiter","zselectboxchange",function(){D=g.zcombo("#textDelimiter","getValue"),P(this.id)}),g.bind("#TTCtype","zmenuitemclick",function(e,t){var r=t.data,o=t.target[0].parentElement,a=o.children[0],n=r.label;a.innerText=n;var i=o.getAttribute("index"),l=parseInt(i);!function(e,t){-1!=t.indexOf("(")&&(t=t.substring(t.indexOf("(")+1,t.indexOf(")"))),U[e]=t}(l,n)}),g.bind("#StartRowCount","znumberfieldchange",function(){u.setStartRow(B())}),g.bind("#StartRowCount","znumberfieldspinend",function(){u.setStartRow(B())})),q&&(r.querySelector("#importSettings").style.display="block"),t.open(),f=t.gridID,C=t.rID,m=t.version,y=S.view.getSheetID(f),b=S.data.getWorkBook(C,m).getSheetObj(y).Prop.getName(),R=S.view.getSheetState(f,y).getActiveCellRange().getLabel(),a.value=b+"."+R,a.focus(),g.zcombo("#importLocale","setValue",l)}else v.ZSAlert(h["TexttoColumns.NoDataWasSelectedToParse"],{title:h["Alert.Title.InvalidCellRange"]})}function P(e){switch(function(e){if(r.querySelector("#"+N[2]).checked)if(r.querySelector("#otherSeparatorValue").value){var t=r.querySelector("#otherSeparatorValue").value;V[N[2]]=t,Z("otherSeparator",t)}else V.hasOwnProperty(N[2])&&V[N[2]]!=t&&G(V[N[2]]);else V.hasOwnProperty(N[2])&&V[N[2]]!=t&&G(V[N[2]])}(),e){case N[0]:Z(e,V[N[0]]);break;case N[1]:Z(e,V[N[1]]);break;case N[3]:Z(e,V[N[3]]);break;case N[4]:Z(e,V[N[4]]);break;case N[5]:(I=!!r.querySelector("#"+N[5]).checked)&&k.splitOperation(n,O,I,D,z);break;case N[6]:i=n}"none"!=D&&(i=n),e==N[5]&&I||k.splitOperation(i,O,I,D,z)}function z(e){I||(i=e),r.querySelector("#TTCtable").innerHTML="";var t=e;e.length>15&&(t=t.slice(0,16)),U={},function(e,t){var o=r.querySelector("#TTCtable"),a={width:100,height:20,colHeader:[void 0],cellClick:Y,rowClick:!1};q&&(n=e,g.znumberfield("#StartRowCount","setAttribute","max",n),a.rowClick=j);var n;var i=new k.ZSTable(o,a,t);i.setActiveCol(0),i.setStartRow(B()),u=i}(e.length,t)}function Z(e,t){r.querySelector("#"+e).checked?function(e){-1==O.indexOf(e)&&O.push(e)}(t):G(t)}function G(e){e&&-1!=O.indexOf(e)&&O.splice(O.indexOf(e),1),i=n}function X(){var e,o,n,i,c,s,u,d,p=t.rID,v=t.sheetID,f=t.version,T=t.gridID,h=a.value.trim(),C=S.view.getSheetState(T,v).getActiveRange(),m=(o=r.querySelector("#tabSeparator"),n=r.querySelector("#commaSeparator"),i=r.querySelector("#otherSeparator"),c=r.querySelector("#otherSeparatorValue"),s=r.querySelector("#spaceSeparator"),u=r.querySelector("#semicolonSeparator"),r.querySelector("#mergeDelimiters").checked,d=D,e=o.checked?o.value+"TTC":"",e+=n.checked?n.value+"TTC":"",e+=u.checked?u.value+"TTC":"",e+=s.checked?s.value+"TTC":"",{textSeparatorsList:e+=i.checked?c.value:"",textDelimiter:d}),y=g.zcombo("#importLocale","getValue"),b=B(),w=JSUtil.Range.parseRange(p,f,a.value.trim()),O="";q?O=E:y=l,Object.keys(U).forEach(function(e){var t=U[e],r=parseInt(e),o=A.hasOwnProperty(t);o||(A[t]=[]),A[t].push(r)}),k.ApplyTexttoColumn(p,[v],f,h,C,m.textSeparatorsList,m.textDelimiter,I,A,O,y,b,w.range,q),t.close()}function Y(e,t){-1==e&&(e=0),R.index=e,R.element=t;R.element.innerText;var o=void r.querySelector("#TTCtype");g.zcombo("#TTCtype","setValue",o)}function j(e){F(e)}function W(){for(var e=r.querySelectorAll("input[type=checkbox]"),t=1;t<e.length;t++)e[t].checked=!1}function B(){return g.zspinner("#StartRowCount","getValue")}function F(e){g.zspinner("#StartRowCount","setValue",e)}m.register(y.Listener,b.DocMeta.DOCUMENT_LOCALE,function(e,t){l=e+"_"+t},"LANGUAGE","COUNTRY"),m.register(y.Listener,b.UserAction.OPEN_TEXT_TO_COLUMNS,function(e,t,r,o){q=e,c=t,s=r,E=o,M()},"ISOUTSIDE_DATA","DATA","DELIMITER","ORIGINALDATA"),S.view.Toolbar.transient.destructor[f.TEXT_TO_COLUMN]=function(){},L.openDialog=M}(this);
!function(e){var t,n,a=e.sPlusPlus,i=e.ZSConstants,r=e.ZSConstants.JSKeyCode,s=i.FeatureConstants,o=i.I18N,l=e.UserAction,c=e.ZSConstants.wCC,g=e.ZSClass,S=g.Editors,u=g.RangePicker,R=a.data.Defaults.MAX_COL,d=e.JSUtil.Math,I=e.ZSEvents,v=I.topic,E=I.Groups,A=I.Names,w=a.view.Toolbar.Feature[s.SPARKLINE],h={},N={buttons:[{text:o.OK,primary:!0}]};function C(){T(h.sourceRange.value,h.destinationRange.value,function(){var e=n.querySelector("#line"),t=n.querySelector("#column");n.querySelector("#winloss");return e.checked?"line":t.checked?"column":"winloss"}(),void 0,"SPARKLINE_CREATE")}function f(){t.close()}function D(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!0}function T(e,n,i,r,s){var o=a.view.getActiveGridID(),c=a.view.getResourceID(o),S=a.view.getSheetID(o),u=a.view.getVersionID(o),R=a.view.getSelectedSheets(o),d=a.data.getWorkBook(c,u).getSheetObj(S),I=new g.ParamGenerator(R,c,u,!0,!0,!0),w=I.getParmsFromDataString(e),h=I.getParmsFromDataString(n),N=e.split(";").length,C=n.split(";").length,f=[];for(var D in w.ranges){var T=w.ranges[D];for(var _ in T)f.push(T[_])}0!=f.length&&f.length==N?0!=h.ranges.length&&0!=h.ranges[0].length&&h.ranges[0].length==C?h.ranges.length>1?p("MULTI_SHEET_DESTINATION"):"EDIT_SPARKLINE_GROUP_DATA"!==s||h.sheets[0][0]==S?(k(f,h.ranges[0],!1)||(h.ranges[0]=function(e,t,n){for(var a=[],i=0;i<t.length;i++){var r=t[i],s=e[i];if(void 0==r||void 0==s)return;var o=n.Merge.getInfo(r.startRow,r.startCol);if(void 0!=o&&(r.startRow==o.startRow&&r.endRow==o.endRow&&r.startCol==o.startCol&&r.endCol==o.endCol)){var l=n.Merge.getIntersectedRanges(r);if(l)if(s.startRow==s.endRow||s.startCol==s.endCol){var c={};c=new g.Range(r.startRow,r.startCol,r.startRow,r.startCol),a.push(c)}else a.push(r)}}return a}(f,h.ranges[0],d)),k(f,h.ranges[0],!0)&&(l.createSparklines(c,o,h.sheets,h.ranges,w.sheets,w.ranges,S,i,r,s,I.getActiveCell()),h.sheets[0][0]===S&&v.publish(E.UI,A.SidePanel.Sparklines.SELECT,{RID:c,SHEETID:h.sheets[0][0],VERSION:u,RANGES:h.ranges[0]}),"SPARKLINE_CREATE"==s&&t.close())):p("INVALID_DESTINATION_RANGE"):p("INVALID_DESTINATION_RANGE"):p("INVALID_SOURCE_RANGE")}function k(e,t,n){for(var a="NONE",i=0,r=0,s=0,o=0;o<e.length;o++){i+=(l=e[o]).endRow-l.startRow+1,r+=l.endCol-l.startCol+1}for(o=0;o<t.length;o++){var l;(l=t[o]).endRow-l.startRow>0&&l.endCol-l.startCol>0&&(a="MULTI_ROL_COL"),s+=(l.endRow-l.startRow+1)*(l.endCol-l.startCol+1)}switch(i!=s&&r!=s&&(a="INCONSISTENT_RANGES"),a){case"NONE":return!0;default:n&&p(a)}return!1}function p(e){switch(e){case"MULTI_SHEET_DESTINATION":N.buttons[0].click=function(){h.destinationRange&&h.destinationRange.focus()},N.title=o["Alert.Title.InvalidDestination"],g.ZSAlert(o["SidePanel.Sparklines.Alert.MultiSheet"],N);break;case"MULTI_ROL_COL":N.buttons[0].click=function(){h.destinationRange&&h.destinationRange.focus()},N.title=o["Alert.Title.InvalidDestination"],g.ZSAlert(o["SidePanel.Sparklines.Alert.MultiRowDest"],N);break;case"INVALID_DESTINATION_RANGE":N.buttons[0].click=function(){h.destinationRange&&h.destinationRange.focus()},N.title=o["Alert.Title.InvalidDestination"],g.ZSAlert(o["SidePanel.Sparklines.Alert.DestInvalid"],N);break;case"INVALID_SOURCE_RANGE":N.buttons[0].click=function(){h.sourceRange&&h.sourceRange.focus()},N.title=o["Alert.Title.InvalidSourceRange"],g.ZSAlert(o["SidePanel.Sparklines.Alert.SourceInvalid"],N);break;case"INCONSISTENT_RANGES":N.buttons[0].click=function(){h.destinationRange&&h.destinationRange.focus()},N.title=o["Alert.Title.InvalidCellRange"],g.ZSAlert(o["SidePanel.Sparklines.Alert.Inconsistent"],N)}}JSUtil.SparklinePool.create=T,w.openDialog=function(i){var I=a.view.getActiveGridID(),w=a.view.getResourceID(I),N=a.view.getSheetID(I),T=a.view.getVersionID(I),k=(a.view.getSelectedSheets(I),a.view.getSheetState(I,N).getActiveCellRange()),p=a.data.getWorkBook(w,T).getSheetObj(N);d.hash(k.startRow,k.startCol,R),p.sparklines.getInfo(k.startRow,k.startCol)&&!i?v.publish(E.UI,A.SidePanel.Sparklines.OPEN):(_={width:400,dialogClass:"",title:o["SidePanel.Sparklines.Insert"]},P=l.getTemplate(["sparklineCreateTemplate"]).sparklineCreateTemplate,(n=document.createElement("div")).id=c.DI+s.SPARKLINE+c.IDENTITY,n.appendChild(P),t=new e.ZSClass.Dialog(n,_),function(){!function(e,t,n){e.forEach(function(e,a){var i=t.querySelector("#"+e),r=new S.RangeEditor(i,!0);r.customPreventDefault=D,u.register(r,!0);var s=i.nextSibling;g.RangePicker.Dialog.register(r,n,s,"Select Range"),h[e]=r})}(["sourceRange","destinationRange"],n,t);var e=n.querySelector("#ok"),a=n.querySelector("#cancel");e.addEventListener("click",C),a.addEventListener("click",f)}(),t.getKeyContext().keyDown[r.ENTER]=function(e){C()},setTimeout(function(){var e,t,n,i,r;e=a.view.getActiveGridID(),t=a.view.getResourceID(e),n=a.view.getSheetID(e),i=a.view.getVersionID(e),a.data.getWorkBook(t,i).getSheetObj(n),r=a.view.getSheetState(e,n).getActiveRange(),h.sourceRange.value="",h.sourceRange.focus(),v.publish(E.Listener,A.RangePicker.Update,{SHEETID:n,RANGE:r,RID:t,VERSION:i}),h.destinationRange.focus()},0),t.open());var _,P}}(this);
!function(t){var e,i,o,s,a,l,r,n,c=t.sPlusPlus,u=t.ZSConstants,d=u.FeatureConstants,v=t.ZSConstants.wCC,h=t.ZSClass,m=h.Editors,p=h.RangePicker,f=u.I18N,g=t.UIUtil.Component,I=c.view.Toolbar.Feature[d.PICKLIST],k=!0,D={},L="http://www.w3.org/2000/svg",y={rangePicker:"#rangePicker",itemList:"#itemList",addItem:"#addItem",defaultItem:"#pLdi",create:"#pLcreate",sort:"#pLsort",cancel:"#pLcancel",defaultBox:"#defaultBox",popup:"#pckClrPop",popupClose:"#pckPopClose",fontPicker:"#PckFntClr",bgPicker:"#PckBgClr",clearColor:"#pckClr"},w={buttons:[{text:f.OK,primary:!0}]},S=[{text:f.Yes,primary:!0},{text:f.No,primary:!1},{text:f["Dialog.Button.Cancel"],primary:!1}],C={},A=[{text:f.Yes,primary:!0},{text:f["Dialog.Button.Cancel"],primary:!1}],b=[{text:f["Picklist.Dialog.Alert.Remove"],primary:!0},{text:f["Picklist.Dialog.Alert.Revert"],primary:!1}],P={};function x(){I.refreshManage(),K()}function E(u,I,k,D,L){var w={width:450,closeOnEsc:!1,closePreviousDialog:!1,dialogClass:"pckLstDlg",title:f["Picklist.Dialog.Create"],close:x};if(!e){var S=UserAction.getTemplate(["picklistDialog"]).picklistDialog;(i=document.createElement("div")).id=v.DI+d.PICKLIST+v.IDENTITY,i.appendChild(S),e=new t.ZSClass.Dialog(i,w);var C=i.querySelector(y.itemList),A=i.querySelector(y.defaultItem);s=new O(C,A),r=UserAction.getTemplate(["pl_popup"]).pl_popup,document.body.appendChild(r);var b=(r=document.querySelector(y.popup)).querySelector(y.fontPicker),P=r.querySelector(y.bgPicker);g.zcolorpicker(b,{type:"inline",change:_,valueColorModel:"hex",defaultPaletteType:"custom",customPalette:c.view.ZSheetPalette}),g.zcolorpicker(P,{type:"inline",change:W,valueColorModel:"hex",defaultPaletteType:"custom",customPalette:c.view.ZSheetPalette}),r.querySelector(y.clearColor).addEventListener("click",j),function(){var t=i.querySelector(y.rangePicker),s=new m.RangeEditor(t,!0);s.customPreventDefault=function(t){var e=t.keyCode||t.which;if(13===e)return t.preventDefault(),!0},p.register(s,!1);var a=t.nextElementSibling;h.RangePicker.Dialog.register(s,e,a,"Select Range"),o=s}(),function(){document.addEventListener("keydown",function(t){n&&27==t.keyCode&&(K(),t.stopPropagation(),t.preventDefault())}),document.addEventListener("click",function(t){n&&!r.contains(t.target)&&s.popupItem&&!t.fromPopup&&K()}),i.querySelector(y.create).addEventListener("click",R),r.querySelector(y.popupClose).addEventListener("click",K),i.querySelector(y.sort).addEventListener("click",function(){s.sort.call(s)}),i.querySelector(y.cancel).addEventListener("click",M);var t=i.querySelector(y.itemList);t.addEventListener("click",function(e){s.dragItem&&s.dragItem.dom.classList.remove("pckDrg"),s.dragItem=void 0,t.removeEventListener("mousemove",z),q&&(clearInterval(q),q=void 0),s.rearrangeListUsingTops(),s.setTops(),s.listDOM.style.userSelect="auto"})}()}e.open(),function(t,r,n,u,d){var v=c.view.getActiveGridID(),m=c.view.getResourceID(v),p=c.view.getSheetID(v),g=c.view.getVersionID(v),I=c.view.getSheetState(v,p).getRanges();if(s.reset(),o.value="",o.focus(),t)r?e.setTitle(f["Picklist.Dialog.Edit"]):e.setTitle(f["Picklist.Dialog.Create"]),function(t,e){var i=c.view.getActiveGridID(),a=c.view.getVersionID(i),l=c.view.getResourceID(i),r=c.view.getSheetID(i),n=c.data.getWorkBook(l,a),u=n.getSheetObj(r),d=t.getItemList(),v="",m=t.id;for(var p in n.SheetList){var r=n.SheetList[p].Id,f=n.SheetList[p].Name;if(void 0==r)break;var u=n[r],g=u.Picklist.RangeList.getAllNodes();for(var I in g){var k=g[I];if(k.properties.id==m){var D=new h.Range(k.startRow,k.startCol,k.endRow,k.endCol);v+=f+"."+D.getLabel()+";"}}}e&&(v=v.length>0?v.substring(0,v.length-1):v,o.value=v);var L=t.getItemById(t.defaultIndex);for(var I in d){var y=d[I],w=s.addNewItem(y.id,y.displayString,!1);L&&y.id==L.id&&(w.defaultBox.children[0].checked=!0),w.setStyle(y.style)}if(e){var S=s.addNewItem(void 0,void 0,!1);setTimeout(function(){S&&S.focusInput(),S&&S.setActiveState()},0)}s.setDeletedIDs(t.deletedIDs),void 0==L?s.setDefaultItem(new N(-1,"blank",s)):(L=s.getItemByValue(L.displayString),s.setDefaultItem(L))}(t,r),a=2,l=t.id,r||(a=3,setTimeout(function(){o.focus()},0)),d&&(o.value=d);else if(e.setTitle(f["Picklist.Dialog.Create"]),a=1,h.RangePicker.setRanges(m,p,g,I),void 0==n){var k=s.addNewItem(void 0,void 0,!1);s.addNewItem(void 0,void 0,!1),s.addNewItem(void 0,void 0,!1),s.setDefaultItem(new N(-1,"blank",s)),k.focusInput(),k.input.select(),k.setActiveState()}else{var D;for(var L in n){var w=n[L],k=s.addNewItem(void 0,w,!1);L==n.length-1&&(D=k)}if(D){var k=s.addNewItem(void 0,void 0,!0);k&&k.setActiveState()}}u&&setTimeout(function(){o.focus()},0);i.querySelector(y.create).innerText=r?f["Picklist.Dialog.SaveButton"]:f["Picklist.Dialog.CreateButton"];J()}(u,I,k,D,L)}function M(){e.close(),a=void 0,l=void 0,q&&(clearInterval(q),q=void 0)}function R(){var t=c.view.getActiveGridID(),r=c.view.getResourceID(t),n=c.view.getVersionID(t),u=c.view.getSelectedSheets(t);if(!J()){var d=o.value,v=s.defaultItem?s.defaultItem.id:-1;try{var m=new h.ParamGenerator(u,r,n,!0,!0,!0),p=m.getParmsFromDataString(d);if(0==p.ranges.length)throw 1;var g=m.getActiveCell()}catch(t){return w.buttons[0].click=function(){o&&o.focus()},w.title=f["Picklist.Alert.Title.Range"],h.ZSAlert(f["Picklist.Alert.Range"],w),!1}if(function(t){var e={};for(var i in s.itemList){var o=s.itemList[i],a=o.value;if(void 0==e[a])e[a]=o;else if(void 0!=a&&a.length>0)return w.title=f["Picklist.Alert.Title.Duplicate"],h.ZSAlert(f["Picklist.Alert.Duplicate"],w),!1}if(void 0==t)return w.title=f["Picklist.Alert.Title.Default"],h.ZSAlert(f["Picklist.Alert.Default"],w),!1;return!0}(v)){var I=s.getListValues(),k=function(){e.isAlive()&&e.close()},D=function(){e.isAlive()&&(i.querySelector(y.create).disabled=!1)};i.querySelector(y.create).disabled=!0,1==a||3==a?UserAction.createPicklist(I,p,g,v,k,D):UserAction.editPicklist(l,I,p,g,v,s.deletedItems,k,D)}}}C.buttons=S,C.title=f["Picklist.Alert.Title.Extend"],C.buttons[1].click=function(){},C.buttons[2].click=function(){};var T=function(t,e){var i=c.view.getActiveGridID(),o=c.view.getResourceID(i),s=c.view.getVersionID(i),a=c.data.getWorkBook(o,s),l=function(t){t?E(void 0,void 0,t=t.length>0?t:void 0,!1,void 0):(w.buttons[0].click=function(){E(void 0,void 0,void 0,!1,void 0)},w.title=f["Picklist.Alert.Title.Exceeded"],h.ZSAlert(f["Picklist.Alert.Exceeded"],w))};switch(t.picklist.case){case 1:var r=t.picklist.values;l(r);break;case 2:var n=t.picklist.ranges.join(";"),u=(e=t.picklist.id,a.Picklist.getPicklistById(e));C.buttons[0].click=function(){E(u,!0,void 0,!1,n)},C.buttons[1].click=function(){new B(l)},C.buttons[2].click=function(){},h.ZSAlert(f["Picklist.Alert.Extend"],C);break;case 3:r=t.picklist.values;var d={buttons:A};d.buttons[0].click=function(){new B(l)},d.buttons[1].click=function(){},h.ZSAlert(f["Picklist.Alert.Erase"],d)}};var B=function(t){var e=c.view.getActiveGridID(),i=c.view.getResourceID(e),o=c.view.getSheetID(e),s=c.view.getVersionID(e),a=c.view.getSheetState(e,o).getRanges(),l=c.data.getWorkBook(i,s).getSheetObj(o);if(1==a.length&&a[0].isSingle())return void t([]);this.callback=t,this.maxUsedRow=l.MaxUsedRow,this.maxAccumulatedRow=0,this.ranges=this.start(a),this.rangeIndex=0,this.values=new Set,this.exceeded=!1,this.caseMap={},this.accumulateData()};B.prototype={start:function(t){for(var e=[],i=0;i<t.length;i++){var o=t[i];if(this.isSplitRequired(o))for(var s=this.splitRange(o),a=0;a<s.length;a++)e.push(s[a]);else e.push(o)}return e},isSplitRequired:function(t){return t.getRowSpan()*t.getColSpan()>500},splitRange:function(t){for(var e=[],i=t.startRow;i<t.endRow;){var o=500/t.getColSpan(),s=i+o-1>65536?65535:i+o-1;if(i<this.maxUsedRow){var a=new h.Range(i,t.startCol,s,t.endCol);e.push(a)}i+=o}return e},accumulateData:function(){if(this.values.size<500&&this.rangeIndex<this.ranges.length){var t=this.ranges[this.rangeIndex];t.startRow>this.maxUsedRow?(this.rangeIndex++,this.accumulateData.call(this)):(this.getData(t),this.rangeIndex++)}else this.callback&&this.callback(this.getValuesAsArray())},getData:function(t){var e=c.view.getActiveGridID(),i=c.view.getResourceID(e),o=c.view.getVersionID(e),s=c.view.getSheetID(e),a=t.startRow,l=t.startCol,r=t.endRow,n=t.endCol,u=new Set,d=this;c.view.fetchRangeDataFromWorker(i,s,o,t,["DisplayValue"],!0,e,function(t){for(var e=a;e<=r;e++)for(var i=l;i<=n;i++){var o=t[e]&&t[e][i];void 0!=o&&u.add(o.DisplayValue)}d.addData.call(d,u),d.accumulateData.call(d)},function(){})},addData:function(t){var e=this;t.forEach(function(t){if(e.values.size>=500)e.exceeded=!0;else if(""!==t){var i=t.toLowerCase();void 0==e.caseMap[i]?e.caseMap[i]=t:t=e.caseMap[i],e.values.add(t)}})},getValuesAsArray:function(){if(!this.exceeded)return Array.from(this.values)}};var O=function(t,e){this.itemCount=0,this.itemList=[],this.listDOM=t,this.defaultItemDOM=e,this.idMap={},this.deletedItems=[],this.defaultItem,this.itemHeight=0};O.prototype={addNewItem:function(t,e,i,o){if(!(this.itemCount>=500)){var s="Item "+(this.itemCount+1),a=!1;t&&(this.idMap[t]=!0,a=!0),t=t||this.getNewId();var l=new N(t,e,this,s);return a&&(l.recordDelete=!0),e&&(D[e.toLowerCase()]=l),o?(this.listDOM.insertBefore(l.getDOM(),o.getDOM().nextSibling),this.itemList.splice(o.getPosition()+1,0,l),this.setTops()):(l.setTop(this.itemCount*this.itemHeight),this.listDOM.appendChild(l.getDOM()),this.itemList.push(l)),this.itemHeight||(this.itemHeight=l.dom.offsetHeight),i&&(l.focusInput(),l.input.select()),l.dom.scrollIntoView(),1==this.itemCount&&this.itemList[0].removeActiveState(),this.listDOM.addEventListener("mousemove",function(){k=!0}),this.itemCount++,l}},getNewId:function(){for(var t=0;;){if(void 0==this.idMap[t])return this.idMap[t]=!0,t;t++}},setDeletedIDs:function(t){if(t)for(var e=0;e<t.length;e++){var i=t[e];this.idMap[i]=!0}},reset:function(){for(this.itemCount=0,this.itemList=[],this.idMap={},this.deletedItems=[],this.defaultItem=void 0,D={};this.listDOM.hasChildNodes();)this.listDOM.removeChild(this.listDOM.lastChild)},setTops:function(){var t=0;for(var e in this.itemList){this.itemList[e].setTop(t*this.itemHeight),t++}},onEnter:function(t,e){k=!1;var i=e.getPosition();if(i+1!=this.itemCount||t.shiftKey){var o;e.input.blur(),t.shiftKey?i-1>=0&&(o=this.itemList[i-1]):o=this.itemList[i+1],o&&o.input.focus(),o&&o.setActiveState()}else{var s=this.addNewItem(void 0,void 0,!0);void 0!=s?s.setActiveState():e.input.blur()}},onDeleteItem:function(t){var e;for(e in t.recordDelete&&s.deletedItems.push(t.id),t.value&&(D[t.value.toLowerCase()]=void 0),this.listDOM.removeChild(t.dom),this.itemCount--,this.itemList){var i=this.itemList[e];if(t.id===i.id)break}1==this.itemCount&&this.itemList[0].setActiveState(),this.itemList.splice(e,1),this.setTops(),J()},loadSelectMenu:function(){},getListValues:function(){var t=[];for(var e in this.itemList){var i={},o=this.itemList[e];void 0!=o.value&&0!=o.value.length&&(i.dv=encodeURIComponent(o.value),i.s=o.getStyle(),i.id=o.id,t.push(i))}return t},sort:function(){var t=[],e=[];for(var i in this.itemList){var o=this.itemList[i];if(0!=t.length)if(""!=o.value&&void 0!=o.value){var s=!1;for(var a in t){var l=t[a];if(o.value<l.value){t.splice(a,0,o),s=!0;break}}s||t.push(o)}else e.push(o);else t.push(o)}for(var i in e){o=e[i];t.push(o)}this.itemList=t,this.setTops()},getItemByValue:function(t){for(var e in this.itemList){var i=this.itemList[e];if(i.value===t)return i}},onInputChange:function(t){this.defaultItem&&(t.id,this.defaultItem.id)},setDefaultItem:function(t){this.defaultItem&&(this.defaultItem.dom.classList.remove("pckLstDefault"),this.defaultItem.defaultBox.title=f["Picklist.Dialog.SetAsDefault"]),this.defaultItem=t,this.defaultItem&&(this.defaultItem.dom.classList.add("pckLstDefault"),this.defaultItem.defaultBox.title=f["Picklist.Dialog.Default"])},getItemById:function(t){for(var e in this.itemList){var i=this.itemList[e];if(i.id==t)return i}},getItem:function(t){return this.itemList[t]},onMouseEnter:function(t){t.setHoverState()},onMouseLeave:function(t){this.dragItem||(t.removeHoverState(),t.input==document.activeElement||t.lockState||1==this.itemCount||t.removeActiveState())},rearrangeListUsingTops:function(){var t=[];for(var e in this.itemList)if(0!=t.length){var i=this.itemList[e],o=!1;for(var s in t)if(i.top<t[s].top){t.splice(s,0,i),o=!0;break}o||t.push(i)}else t.push(this.itemList[e]);this.itemList=t}};var N=function(t,e,i,o){this.id=t,this.itemFactory=i,this.dom=this.createDOM(e,t,o),this.value=e,this.input,this.iconHolder,this.defaultBox,this.top,this.recordDelete,this.style={textColor:void 0,bgColor:void 0}};N.prototype={createDOM:function(t,e,i){var o=document.createElement("li"),s=document.createElement("div"),a=document.createElement("label");a.classList.add("ZsSelectionBox","pickLstCheck"),a.title=f["Picklist.Dialog.SetAsDefault"];var l=document.createElement("input");l.type="radio",l.name="defaultItem",l.id="defaultBox";var r=document.createElement("span");a.appendChild(l),a.appendChild(r);var n=document.createElement("input"),c=document.createElement("div");s.classList.add("pckLstDrg"),n.type="text",t&&(n.value=t),n.placeholder=i,n.classList.add("pckLstInp","flxGrow"),c.classList.add("pckLstIco","ml10"),o.appendChild(s),o.appendChild(a),o.appendChild(n),o.appendChild(c),o.setAttribute("id","pLlE"+e),this.input=n,this.iconHolder=c,this.defaultBox=a;for(var u=0;u<3;u++){var d=document.createElement("span"),v=document.createElementNS(L,"svg"),h=document.createElementNS(L,"use"),m="http://www.w3.org/1999/xlink";switch(u){case 0:v.classList.add("clrPop"),d.classList.add("ml10","curPtr","flt_left"),v.setAttribute("height","22"),v.setAttribute("width","24"),v.setAttribute("viewBox","-1 0 22 22"),h.setAttributeNS(m,"href","#txtBGIco"),h.classList.add("svgBlckFill");break;case 1:d.classList.add("ml20","curPtr","flt_left","mt3"),v.setAttribute("height","18"),v.setAttribute("width","18"),v.setAttribute("viewBox","-1 -1 16 18"),h.setAttributeNS(m,"href","#addListIco");break;case 2:d.classList.add("ml10","curPtr","flt_left","pckLstTrash","mt3"),v.setAttribute("height","18"),v.setAttribute("width","18"),v.setAttribute("viewBox","-1 -1 16 18"),h.setAttributeNS(m,"href","#removeListIco")}d.appendChild(v),v.appendChild(h),c.appendChild(d),g.initComponent(v)}return this.addEventListeners(this,this.itemFactory,o,s,n,c,l),o},addEventListeners:function(t,e,i,o,s,a,l){o=o;var r=function(t,e){e.lockedItem=void 0,P.buttons=b,P.title=f["Picklist.Alert.Title.Duplicate"],P.buttons[0].click=function(){e.defaultItem&&e.defaultItem.id==t.id&&e.setDefaultItem(void 0),e.onDeleteItem.call(e,t)},P.buttons[1].click=function(){t.value&&(t.input.value=t.value),t.setActiveState(),t.focusInput(),t.input.select()},h.ZSAlert(f["Picklist.Alert.Duplicate"],P)};s.addEventListener("keypress",function(i){if(13==i.keyCode){var o=D[s.value.toLowerCase()];void 0!=s.value&&s.value.length>0&&o&&o.id!=t.id?r(t,e):e.onEnter.call(e,i,t)}}),s.addEventListener("blur",function(i){var o=D[s.value.toLowerCase()];if(J(),void 0!=s.value&&s.value.length>0&&o&&o.id!=t.id){if(t.value&&(D[t.value.toLowerCase()]=void 0),e.lockedItem=void 0,i.relatedTarget&&"#"+i.relatedTarget.id==y.cancel)return;i.stopPropagation(),r(t,e)}else D[s.value.toLowerCase()]=t,t.value=s.value,e.onInputChange.call(e,t),t.lockState||(t.removeActiveState(),t.lockState=!1),e.lockedItem=void 0}),s.addEventListener("mousedown",function(i){e.mouseDownInput=t}),s.addEventListener("mouseup",function(t){e.mouseDownInput&&(e.mouseDownInput.setActiveState(),e.mouseDownInput.focusInput())}),o.addEventListener("mousedown",function(i){s===document.activeElement&&i.target&&i.target.classList.contains("pckLstInp")||t.onMouseDown.call(t,e.listDOM,i)}),o.addEventListener("mouseup",function(i){i.target&&i.target.classList.contains("pckLstInp")||t.onMouseUp.call(t,e.listDOM)}),a.children[2].addEventListener("click",function(i){K(),t.lockState=!0,e.defaultItem&&e.defaultItem.id==t.id&&e.setDefaultItem(void 0),e.onDeleteItem.call(e,t)}),a.children[0].addEventListener("mousedown",function(){t.lockState=!0,e.lockedItem=t,t.setActiveState()}),a.children[0].addEventListener("click",function(i){i.fromPopup=!0,e&&e.popupItem&&e.popupItem===t?K():(Y.call(t),e.lockedItem=t)}),a.children[1].addEventListener("click",function(){K(),void 0==e.addNewItem(void 0,void 0,void 0,t)&&(w.title=f["Picklist.Alert.Title.Exceeded"],h.ZSAlert(f["Picklist.Alert.Exceeded"],w))}),i.addEventListener("mouseenter",function(i){e.onMouseEnter.call(e,t)}),i.addEventListener("mouseleave",function(i){e.onMouseLeave.call(e,t)}),s.addEventListener("focus",function(){e.lockedItem=t,t.setActiveState()}),l.addEventListener("click",function(i){e.defaultItem&&e.defaultItem.id==t.id&&(l.checked=!1),l.checked?s.value&&s.value.length>0?e.setDefaultItem(t):l.checked=!1:e.setDefaultItem(void 0)})},onMouseDown:function(t,e){e.preventDefault(),this.itemFactory.dragItem=this,this.dom.classList.add("pckDrg"),this.itemFactory.listDOM.addEventListener("mousemove",z)},onMouseUp:function(t){this.itemFactory.dragItem&&this.itemFactory.dragItem.dom.classList.remove("pckDrg"),this.itemFactory.dragItem=void 0},getDOM:function(){return this.dom},setTop:function(t){this.top=t,this.dom.style.top=t+"px"},focusInput:function(){this.itemFactory.popupItem&&K(),this.input.focus(),s.lockedItem=this},getPosition:function(){return this.top/this.itemFactory.itemHeight},getStyle:function(){return(this.style.textColor?this.style.textColor:"")+"-"+(this.style.bgColor?this.style.bgColor:"")},setStyle:function(t){void 0!=t&&(this.style.textColor=t.tc,this.style.bgColor=t.bg,this.input.style.color=this.style.textColor,this.input.style.backgroundColor=this.style.bgColor,g.zcolorselectbox(this.iconHolder.children[0],"setValue",this.style.textColor),g.zcolorselectbox(this.iconHolder.children[1],"setValue",this.style.bgColor))},setActiveState:function(){this.itemFactory.hoverItem&&this.itemFactory.hoverItem.removeHoverState.call(s.hoverItem),this.dom.classList.add("active")},removeActiveState:function(){this.dom.classList.remove("active")},setHoverState:function(){k&&(this.itemFactory.hoverItem=this,this.dom.classList.add("hover"))},removeHoverState:function(){this.dom.classList.remove("hover")}};var q,V,H,F=!1,U=!1,Z=function(){if(U?s.listDOM.scrollTop=s.listDOM.scrollTop+8:F?s.listDOM.scrollTop=s.listDOM.scrollTop-8:clearInterval(q),(U||F)&&V){var t=s.listDOM.getBoundingClientRect(),e=V-t.y+s.listDOM.scrollTop-10,i=s.dragItem;i.setTop(e);var o=i.dom.getBoundingClientRect();H||(G(o.y-t.y+s.listDOM.scrollTop,i),H=!0,setTimeout(function(){H=!1},50))}},z=function(t){t.stopPropagation(),s.mouseDownInput=void 0;var e=s.dragItem,i=s.listDOM.getBoundingClientRect(),o=!1;t.pageY-i.y<13?(0==F&&(q=setInterval(Z,25)),F=!0,o=!0):i.y+150-t.pageY<13&&(0==U&&(q=setInterval(Z,25)),U=!0,o=!0),!F&&!U||o||(clearInterval(q),q=void 0,F=!1,U=!1),V=t.pageY;var a=t.pageY-i.y+s.listDOM.scrollTop-10;e.setTop(a);var l=e.dom.getBoundingClientRect();H||(G(l.y-i.y+s.listDOM.scrollTop,e),H=!0,setTimeout(function(){H=!1},50))};function G(t,e){var i=s.itemList,o=0;for(var a in i){var l=i[a],r=l.top;l.id!=e.id&&(t<=r+4?l.setTop((parseInt(o)+1)*s.itemHeight):l.setTop(o*s.itemHeight),o++)}}function Y(){K(),n=!0,s.popupItem=this,r.style.display="";var t=this.iconHolder.children[0].getBoundingClientRect();r.style.left=t.x+30+"px",r.style.top=t.y-141+"px";var e=r.querySelector(y.fontPicker),i=r.querySelector(y.bgPicker);g.zcolorpicker(e,"setValue",this.style.textColor?this.style.textColor:"#000000"),g.zcolorpicker(i,"setValue",this.style.bgColor?this.style.bgColor:"none")}function K(){s.popupItem&&(n=!1,s.popupItem.lockState=!1,s.popupItem.removeActiveState(),s.popupItem=void 0,s.lockedItem=void 0,r.style.display="none")}function W(t,e){var i=s.popupItem;i.style.bgColor="transparent"==e.value?void 0:e.value,i.input.style.backgroundColor="transparent"==e.value?"":e.value}function _(t,e){var i=s.popupItem;i.style.textColor=e.value,i.input.style.color=e.value}function j(){var t=s.popupItem;t.style.textColor="#000000",t.input.style.color="#000000",t.style.bgColor=void 0,t.input.style.backgroundColor="";var e=r.querySelector(y.fontPicker),i=r.querySelector(y.bgPicker);g.zcolorpicker(e,"setValue","#000000"),g.zcolorpicker(i,"setValue","none")}function J(){for(var t in s.itemList){var e=s.itemList[t];if(void 0!=e.input.value&&e.input.value.length>0)return i.querySelector(y.create).removeAttribute("disabled"),!1}return i.querySelector(y.create).disabled=!0,!0}I.openDialog=function(t,e,i,o){t?E(t,e,void 0,o,void 0):!function(){var t=c.view.getActiveGridID(),e=c.view.getResourceID(t),i=c.view.getSheetID(t),o=c.view.getVersionID(t),s=c.view.getSheetState(t,i).getRanges(),a=c.data.getWorkBook(e,o).getSheetObj(i).Picklist.RangeList.getAllNodes();for(var l in a){var r=a[l],n=new h.Range(r.startRow,r.startCol,r.endRow,r.endCol);for(var u in s){var d=s[u];if(n.intersects(d)||d.subset(n)||d.isSuperSet(n))return!0}}return!1}()?new B(function(t){t?E(void 0,void 0,t=t.length>0?t:void 0,!1,void 0):(w.buttons[0].click=function(){E(void 0,void 0,void 0,!1,void 0)},w.title=f["Picklist.Alert.Title.Exceeded"],h.ZSAlert(f["Picklist.Alert.Exceeded"],w))}):UserAction.checkPicklistIntersection(T)}}(this);
!function(e){var t,i,n,r,o,a,l,s=e.sPlusPlus,c=e.ZSConstants,d=c.FeatureConstants,g=e.ZSConstants.wCC,v=c.I18N,u=e.JSUtil,p=e.UIUtil.Component,h=e.ZSClass,m=(h.Editors,h.RangePicker,s.view.Toolbar.Feature[d.PICKLIST]),f={manageContainer:"#plMngCnt",create:"#plCreate",close:"#plClose",viewFor:"#viewfor",rangePicker:"#rangePicker"};var S=function(e,t){var n=s.view.getActiveGridID(),r=s.view.getVersionID(n),o=s.view.getResourceID(n),a=s.data.getWorkBook(o,r);i.querySelector(f.manageContainer).innerHTML="";var c=[];if(e)for(var d in l){var g=l[d];for(var v in g.sheetList){(h=g.sheetList[v])===e&&c.push(g)}}else if(t){t=t.split(";");var p=new Set;for(var d in t){var h=t[d];if(m=u.Range.parseRange(o,r,h)){e=m.sheetID;for(var m=m.range,S=a.getSheetObj(e),k=m.startRow;k<=m.endRow;k++)for(var w=m.startCol;w<=m.endCol;w++){(g=S.Picklist.getInfo(k,w))&&p.add(g.properties.id)}}}for(var d in l){var C=l[d];p.has(C.plid)&&c.push(C)}}else c=l;D(c)};function k(){t.close()}function w(){var e=i.querySelector(f.manageContainer);e.innerHTML="",e.appendChild(r),l=void 0,i.querySelector(f.rangePicker).parentNode.style.display="none"}var D=function(e){var t=s.view.getActiveGridID(),r=s.view.getVersionID(t),o=s.view.getResourceID(t),a=s.data.getWorkBook(o,r),l=i.querySelector(f.manageContainer),c=UserAction.getTemplate(["pl_manage_rule"]).pl_manage_rule;l.innerHTML="",void 0!=e&&0!=e.length||l.appendChild(n);for(var d=0;d<e.length;d++){for(var g=e[d],v=g.plid,u=g.rangeList,p=g.plits,h=a.Picklist.getPicklistById(v),m="",S=0;S<u.length;S++){if((m+=u[S]+";").length>35){m=m.substring(0,35)+"...";break}}m.length>0&&(m=m.substring(0,m.length-1));var k="";p=h.getItemList();for(var S in p){if((k+=p[S].displayString+",").length>75){k=k.substring(0,75)+"....";break}}k=k.substring(0,k.length-1);var w=new I(h,c);w.setDOMValues(m,k),l.appendChild(w.getDOM())}};function C(){var e=s.view.getActiveGridID(),t=s.view.getVersionID(e),n=s.view.getResourceID(e),r=s.view.getSheetID(e),o=s.data.getWorkBook(n,t),a=o.SheetList.getSheets(),c=i.querySelector(f.viewFor);p.zcombo(c,"removeAllOptions");var d=[];for(var g in d.push({label:v["Picklist.Dialog.Whole"],value:""}),a){var u=a[g].Id,h=a[g].Name;o.getSheetObj(u);d.push({label:h,value:u})}p.zcombo(c,"addOption",d),p.zcombo(c,"setValue",r),UserAction.getPicklistsForManage(function(e){l=e.picklists,S(r,void 0)})}var I=function(e,t){this.picklist=e,this.dom=this.createDOM(t),this.attachEventListeners()};I.prototype={createDOM:function(e){var t=e.cloneNode(!0),i=document.createElement("div");return i.appendChild(t),i},setDOMValues:function(e,i){if(e.length>0)this.dom.querySelector("#pl_rule_range").innerHTML=e,this.rangeString=e;else{var n=this;this.rangeString=void 0;var r=o.cloneNode(!0);this.dom.querySelector("#pl_rule_range").appendChild(r),this.dom.querySelector("#pl_rule_range").children[0].addEventListener("click",function(e){t.hide(),m.openDialog(n.picklist,!0,void 0,!0)})}this.dom.querySelector("#pl_rule_items").innerText=i},attachEventListeners:function(){var e=this;this.dom.onclick=this.hideEditOption.bind(this),this.dom.ondblclick=function(){t.hide(),m.openDialog(e.picklist,!0)},this.dom.querySelector(".cpy").onclick=function(){t.hide(),m.openDialog(e.picklist,!1)},this.dom.querySelector(".edt").onclick=function(){t.hide(),m.openDialog(e.picklist,!0)},this.dom.querySelector(".del").onclick=function(){var t=i.querySelector(f.manageContainer);t.removeChild(e.dom),0==t.children.length&&t.appendChild(n),UserAction.removePicklist(e.picklist.id,e.rangeString)},this.dom.querySelector(".cFMenu").onclick=function(t){e.showEditOption.call(e,t)}},showEditOption:function(e){this.hideEditOption();var t=window.event||e;t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),this.dom.querySelector(".cFMenuPopUp").classList.add("shwEdtOpn")},hideEditOption:function(){var e=i.querySelector(".shwEdtOpn");e&&e.classList.remove("shwEdtOpn")},getDOM:function(){return this.dom}},m.openManage=function(){var l={width:460,dialogClass:"pcLstManage",title:v["Picklist.Dialog.Manage"]};if(!t){var c=UserAction.getTemplate(["pl_manage"]).pl_manage;(i=document.createElement("div")).id=g.DI+d.PICKLIST+g.IDENTITY,i.appendChild(c),t=new e.ZSClass.Dialog(i,l),i.querySelector(f.create).addEventListener("click",function(){t.hide(),m.openDialog()}),i.querySelector(f.close).addEventListener("click",k),(n=document.createElement("span")).innerText=v["Picklist.Dialog.NoPicklist"],n.className="ZsNoMsg",(r=document.createElement("span")).className="ZsLoader ZsLoaderSmall",o=UserAction.getTemplate(["pl_no_range"]).pl_no_range;var u=i.querySelector(f.viewFor);p.bind(u,"zselectboxchange",function(){var e;if("cell"==(r=p.zcombo(u,"getValue"))){var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),r=s.view.getSheetID(t),o=s.view.getVersionID(t),l=s.view.getSheetState(t,r).getRanges();i.querySelector(f.rangePicker),a.value="",a.focus(),h.RangePicker.setRanges(n,r,o,l),e=a.value}else i.querySelector(f.rangePicker);"Whole Spreadsheet"==r&&(r=void 0),S(r,e)})}t.open(),w(),C()},m.refreshManage=function(){t&&t.alive&&(t.show(),w(),C())}}(this);
!function(e){var t=e.sPlusPlus,n=e.document,i=e.ZSConstants,l=e.ZSClass,s=l.Editors,r=e.ZSConstants.I18N,o=void 0,a=void 0,d=void 0,c=t.view.getActiveGridID(),p=t.view.getResourceID(c),u=t.view.Toolbar.Feature[i.FeatureConstants.LINK_SPREADSHEET];r.OK,r["Alert.Title.InvalidDefinedName"],r.CellNamecannotbeassameasZohoSheetdefinedcelllabels;function S(e){for(var t=e.lastElementChild;t;)e.removeChild(t),t=e.lastElementChild}function m(e){13===(e.keyCode||e.which)&&(h(),e.preventDefault())}function h(){var e=d.value;UserAction.linkSpreadSheet(p,e,function(e){let t=e.response;if("Supplier ADDED"==t.msg){l.ZSAlert(t.msg,{title:"Supplier ADDED"});let e=y([{dn:t.dn,id:t.id,access:"Read access"}]);if(e.childElementCount){let t=a.querySelector("#linkS_SuppContainer");a.querySelector("#linkS_SuppNoResult").style.display="none",t.style.display="",t.appendChild(e)}}else l.ZSAlert(t.msg,{title:"Can't add supplier"})})}function v(){var e=this.value,t=a.querySelector("#linkS_addBtn");t.disabled=!e}function y(e){var t=n.createDocumentFragment();for(let n=0;n<e.length;n++){let s=e[n],r=s.id,o=s.dn;var i=new l.UILinkedSheetRangeRow(r,o);t.appendChild(i.getElement())}return t}u.openDialog=function(){var t,i,r;o||(t={width:580,title:"Link SpreadSheet",dialogClass:"nRtD",close:function(){},open:function(){d.focus()}},(i=e.UserAction.getTemplate(["linkSpreadSheetTemplate"]).linkSpreadSheetTemplate).querySelector("#linkS_addBtn").onclick=h,i.querySelector("#cancelBtn").addEventListener("click",function(){o.close()}),(a=n.createElement("div")).id="DI_LINKSPREADSHEET",a.appendChild(i),o=new e.ZSClass.Dialog(a,t),r=a.querySelector("#linkS_name"),(d=new s.TextAreaEditor(r,!0)).addListeners({input:v,keydown:m})),setTimeout(function(){UserAction.linkedSpreadSheets(p,function(e){let t=[],i=[];for(var s in e.response.consumers)s=e.response.consumers[s],t.push(s);for(var r in e.response.suppliers)r=e.response.suppliers[r],i.push(r);var o=a.querySelector("#linkS_container"),d=a.querySelector("#linkS_noResult");S(o);var c=function(e){var t=n.createDocumentFragment();for(let n=0;n<e.length;n++){let s=e[n],r=s.id,o=s.dn;var i=new l.UILinkedSheetRangeRow(r,o);t.appendChild(i.getElement())}return t}(t);c.childElementCount?(d.style.display="none",o.style.display="",o.appendChild(c)):(d.style.display="",o.style.display="none");let p=a.querySelector("#linkS_SuppContainer"),u=a.querySelector("#linkS_SuppNoResult");S(p);let m=y(i);m.childElementCount?(u.style.display="none",p.style.display="",p.appendChild(m)):(u.style.display="",p.style.display="none")}),d.focus()},10),o.open()}}(this),function(e){var t=e.sPlusPlus,n=e.document,i=e.ZSClass;function l(e,t){this.docName=t,this.docRsid=e,this.create()}l.prototype={create:function(){this.template=e.UserAction.getTemplate(["linkSpreadSheetTemplateDetailTemplate"]).linkSpreadSheetTemplateDetailTemplate,this.template.querySelector("#linkS_textContent").innerText=this.docName,this.template.querySelector("#linkS_nameField").innerText=this.docRsid,this.rowElement=n.createElement("div"),this.rowElement.className="dspTblRow",this.template.querySelector("#linkS_editDelete").querySelector("#linkS_deleteRange").addEventListener("click",this.delete.bind(this)),this.rowElement.appendChild(this.template)},delete:function(){var e=this.docRsid;if(e){var n=t.view.getActiveGridID(),l=t.view.getResourceID(n);t.view.getVersionID(n),t.view.getSelectedSheets(n);if("linkS_SuppContainer"==this.rowElement.parentElement.id){var s=function(e){var t=t=e.response.msg;void 0===t&&(t="Supplier Removed"),i.ZSAlert(t,{title:"Remove Supplier"})};UserAction.RemoveSupplier(l,e,s)}else{s=function(e){var t=e.response.msg;void 0===t&&(t="Consumer Removed"),i.ZSAlert(t,{title:"Remove Consumer"})};UserAction.RemoveConsumer(l,e,s)}this.rowElement.remove()}},getElement:function(){return this.rowElement}},i.UILinkedSheetRangeRow=l}(this);
!function(e){var t,o,n=e.sPlusPlus,i=(e.document,e.UIUtil.Component),r=e.ZSClass,a=(e.ZSConstants.FeatureConstants,e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),l=(e.ZSConstants.wCC,e.ZSEvents),s=(r.Editors.TextAreaEditor,r.Editors.Utility,l.topic),d=l.Groups,c=l.Names,v=n.view.Toolbar.Feature.MOVE_SHEET;var S=!1,g=document.createElement("option");function u(){t.close()}v.openDialog=function(){var l=n.view.getActiveGridID(),v=n.view.getResourceID(l),E=n.view.getSheetID(l),h=n.view.getVersionID(l),p={modal:!0,width:320,title:a.MoveThisSheet};t||(function(t,r,a){var l=e.UserAction.getTemplate(["MOVE_SHEET"]).MOVE_SHEET;(function(t,r,a,l){t.querySelector("#moveDlgOk").addEventListener("click",function(t,r,a){var l,v=n.data.getWorkBook(t,a),S=(v.getSheetObj(r),n.view.getActiveGridID()),g=(I=v.SheetList).getSheets(),E=o.querySelector("#moveDlgSelect"),h=i.zcombo(E,"getValue"),p=0;if("MoveEnd"==h)p=g.length-1,l=I.getByPos(p).Id;else if("MoveStart"==h)p=0,l=I.getByPos(p).Id;else{p=I.getPosById(h,!0);var m=I.getPosById(r,!0);p<m&&p++,l=h}var I=n.view.getSelectedSheets(S);e.UserAction.MoveSheet(t,I,a,p),s.publish(d.Listener,c.DocMeta.SCROLL_SHEET,{RID:t,SHEETID:l,VERSION:a}),u()}.bind(this,r,a,l)),t.querySelector("#moveDlgCancel").addEventListener("click",u)})(l,t,r,a),(o=document.createElement("div")).id="DI_SHEET_RENAME",o.appendChild(l)}(v,E,h),t=new r.Dialog(o,p));var m=o.querySelector("#newLocMsg"),I=n.data.getWorkBook(v,h).SheetList.getById(E).Name,f=JSUtil.fn.replaceParams(a.NewLocation,[I]);m.innerText=f,function(e,t,r){var l,s,d=n.data.getWorkBook(e,r),c=(d.getSheetObj(t),d.SheetList),v=d.SheetList.getSheets(),u=c.getPosById(t),E=v.length,h=o.querySelector("#moveDlgSelect");if(h.innerHTML="",u>0&&(l=h,(s=g.cloneNode()).title=a.MoveStart,s.value="MoveStart",s.innerText=a.MoveStart,l.appendChild(s)),u!=E-1&&function(e){var t=g.cloneNode();t.title=a.MoveEnd,t.value="MoveEnd",t.innerText=a.MoveEnd,e.appendChild(t)}(h),E>2){var p=document.createElement("optgroup");p.label="or After",p.setAttribute("data-item-type","group"),function(e,t,o){for(var n=0;n<t.length;n++)if(n!=o-1&&n!=o){var i=t[n].Name,r=t[n].Id,a=g.cloneNode();a.title=i,a.value=r,a.innerText=i,e.appendChild(a)}}(p,v,u),h.appendChild(p)}S?i.zcombo(h,"refresh"):S=!0}(v,E,h),t.open()}}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSConstants,i=e.document,c=(o.FeatureConstants,e.UserAction,e.ZSEvents),n=(c.topic,c.Groups,c.Names,e.ZSConstants.I18N),r=void 0,s=void 0,l=void 0;t.view.Toolbar.Feature.PASTE_SHEET.openDialog=function(o,c){l=c;var a,d=t.view.getActiveGridID(),S=t.view.getResourceID(d),h=(t.view.getSheetID(d),t.view.getVersionID(d)),v=t.view.getSelectedSheets(d),u={width:570,open:function(){!function(){!function(){for(var e=s.querySelector("#sheetsList"),t=s.querySelectorAll("#sheetsList li"),o=0;o<t.length;o++)e.removeChild(t[o])}();for(var e=s.querySelector("#sheetsList"),t=0;t<l.length;t++){var o=i.createElement("li");o.innerText=l[t],e.appendChild(o)}}()},close:function(){var e;(e=s.querySelector("#includeSheets")).checked&&(e.checked=!1)},title:n.ZohoSheet};r||(a=e.UserAction.getTemplate(["copyRefSheets"]).copyRefSheets,(s=i.createElement("div")).id="DI_PASTESHEET",s.appendChild(a),s.querySelector("#okBtn").addEventListener("click",function(){!function(o,i,c,n){var l=t.view.getActiveGridID(),a=t.data.getWorkBook(o,c),d=t.view.getSheetID(l),S=a.getSheetObj(d).Prop.Name,h=s.querySelector("#includeSheets");"sdoc"==n?h.checked?UserAction.serverClipCopytoNewSheet(o,i,c,S,!0):UserAction.serverClipCopytoNewSheet(o,i,c,S,!1):"ddoc"==n&&(h.checked?e.UserAction.PasteSheet(o,i,c,S,!0):e.UserAction.PasteSheet(o,i,c,S,!1)),r.close()}(S,v,h,o)}),s.querySelector("#clBtn").addEventListener("click",function(){r.close()}),r=new ZSClass.Dialog(s,u)),r.open()}}(this);
!function(e){var t,n,r,i,o,c,a,s,l,u,d,v,E,g,f,D,p,m,S,L,I,y,C,R,w,T=e.sPlusPlus,U=e.ZSConstants.FeatureConstants,A=(e.ZSConstants.CommandConstants,e.ZSConstants.I18N),q=e.UIUtil.Component,N=(e.ZSConstants.JSKeyCode,e.ZSConstants.wCC),h=e.UserAction,k=(e.document,e.ZSEvents),G=k.topic,_=k.Groups,x=k.Names,M=ZSClass.Editors,O=(e.UserAction.Macro,T.view.Toolbar.Feature[U.DELUGE]),b=e.ZSConstants,V=(q=e.UIUtil.Component,A=e.ZSConstants.I18N,b.ActionConstants),z=void 0,Z=[],P=0,F="",H=!1,B=(ZSClass.RangePicker.register,{}),Y="ERRORBANNER",X=!1,J=!1;function W(n){var r;z||(!function(){var n=h.getTemplate(["DELUGE_EDITOR_TITLE","DELUGE_EDITOR","DELUGE_RUN","DELUGE_INSERT","DELUGE_ERROR"]),r=n.DELUGE_EDITOR;s=n.DELUGE_EDITOR_TITLE,i=r.querySelector("#delugeEditorArea");var c=r.querySelector("#undo"),a=r.querySelector("#redo"),l=r.querySelector("#find"),d=r.querySelector("#goto"),v=r.querySelector("#insertProcedure");u=r.querySelector("#save"),L=r.querySelector("#run");var E=s.querySelector("#minimizeDialog"),g=s.querySelector("#maximizeDialog"),f=s.querySelector("#closeDialog"),D=s.querySelector("#macroHelp"),p=r.querySelector(".mcrClpse"),S=r.querySelector(".mcrLfn");m=r.querySelector(".delugeEditor"),f.title=A.Close,u.addEventListener("click",function(){ve(!0,!0,u,"Saving"),o.editor.saveScript()}),L.addEventListener("click",function(){o.isEditorContentModified()?pe(!0):j(null,!0)}),c.addEventListener("click",function(){o.editor.undo()}),a.addEventListener("click",function(){o.editor.redo()}),l.addEventListener("click",function(){o.editor.execCommand("replace")}),d.addEventListener("click",function(){o.editor.execCommand("goToLine")}),v.addEventListener("click",function(){K(!1)}),E.addEventListener("click",function(){$(!0),z.minimize()}),g.addEventListener("click",function(){$(!1),z.maximize()}),f.addEventListener("click",function(){o.isEditorContentModified()?pe(!1,!0):z.close()}),D.addEventListener("click",function(){!function(e){e.setAttribute("data-menu-id",N.SUBMENUITEM+"DELUGE_HELP"+N.IDENTITY);var t={id:N.SUBMENUITEM+"DELUGE_HELP"+N.IDENTITY,ctype:"zmenu",relativeto:"parent",data:'{"componentOptions":{"type":"text_only"}}'},n=[{data:'{"label":"'+A["Deluge.SheetHelp"]+'","url":"https://www.zoho.com/docs/help/custom-functions.html"}'},{data:'{"label":"'+A["Deluge.Learn"]+'","url":"https://creator.zoho.com/learndeluge/"}'}];T.view.Menu.create(n,t).then(function(){q.bind("#"+N.SUBMENUITEM+"DELUGE_HELP"+N.IDENTITY,"zmenuitemclick",function(e,t){var n=t.data;window.open(n.url)})})}(D)}),p.addEventListener("click",function(){"0px"==S.style.marginLeft||""==S.style.marginLeft?(S.style.marginLeft="-210px",i.style.width="990px",o.resize()):(S.style.marginLeft="0px",i.style.width="808px",o.resize())});var y={width:1e3,modal:!0,title:s,closeOnEsc:!1,open:function(){G.register(_.Listener,x.DocAction.DELUGE_FUNCTIONS.INSERT,fe,"RID","VERSION","DELUGE"),G.register(_.Listener,x.DocAction.DELUGE_FUNCTIONS.REMOVE,De,"RID","VERSION","DELUGE"),C?C.click():o.setEditorContent(""),C=""},close:function(){o.V1Response.hide(),G.unregister(_.Listener,x.DocAction.DELUGE_FUNCTIONS.REMOVE,De),G.unregister(_.Listener,x.DocAction.DELUGE_FUNCTIONS.INSERT,fe),o.setEditorContent(""),I&&I.open(),I=""}};(t=document.createElement("div")).id=N.DI+U.DELUGE_EDITOR+N.IDENTITY,t.appendChild(n.DELUGE_EDITOR),(z=new e.ZSClass.Dialog(t,y)).Dom.classList.add("mcrEdtr")}(),initializeDelugeEditor(i,ee),document.getElementById("dreTopBar").style.display="none");var c=T.view.getActiveGridID(),a=te(T.view.getResourceID(c));a&&(re(a),n&&(r=B&&B[n],C=r)),$(!1),z.isMinimize()?z.maximize():z.open()}function K(t){var i=h.getTemplate(["DELUGE_INSERT"]).DELUGE_INSERT;if(!n){g=i.querySelector("#procedureName"),f=i.querySelector("#macroDescription"),d=i.querySelector("#createProcedure"),v=i.querySelector("#createProcedure").childNodes[1],D=i.querySelector("#returntype");var o=i.querySelector("#addArgument");p=i.querySelector("#argumentsDiv");var c=i.querySelector("#cancel"),a={width:500,modal:!0,title:A["Deluge.Create.Title"],open:function(){g.focus()},close:function(){p.innerHTML="",f.value="",g.value="",de(!1,!1,d,v,"Save")}};g.addEventListener("keydown",function(e){13==e.keyCode&&d.click()}),d.addEventListener("click",function(){var i=g.value;i=i.toUpperCase();var o=T.view.getActiveGridID(),c=te(T.view.getResourceID(o));if(c&&c.get(i))!function(){(R=r.parentNode.querySelector(".shNtfyWrpr"))&&r.parentNode.removeChild(R);var t=e.UserAction.getTemplate([Y]);(R=t[Y]).querySelector(".shNtfyCtn").innerText=A["Deluge.FunctionName"],w&&clearTimeout(w);w=setTimeout(me,2e3),r.parentNode.appendChild(R)}();else if(h.isValidMacroName(i,!0)){var a=f.value;a||(a=A["Deluge.DefaultDescription"]);var s=D.value,l=[];if(P>0)for(var u=0;u<P;u++){var E=Z[u];if(E){var p=E.querySelector(".params").value,m=[E.querySelector(".paramName").value,p];l[u]=m}}Z=[],P=0,function(e,t,r,i,o){var c="",a="";if(null!=i)for(var s=i.length,l=0;l<s;l++){var u=i[l];c+=u[1]+" "+u[0],l!=s-1&&(c+=",")}switch(r){case"int":a="return 0;";break;case"bool":a="return false;";break;case"date":case"datetime":a="return zoho.currentdate;";break;case"decimal":a="return 0;";break;case"collection":a="return Collection()";break;case"map":a="return Map(); ";break;case"list":a="return List();";break;case"string":a="return null;"}var E=r+" "+e.toUpperCase()+"("+c+"){\n"+a+"\n } ",g=T.view.getActiveGridID(),f=T.view.getResourceID(g),D=T.view.getVersionID(g),p=V.DRE_CREATE;S=E,o?(n.close(),h.delugeCreateAction(f,D,p,E,t,ue)):(de(!0,!0,d,v,"Creating"),h.delugeCreateAction(f,D,p,E,t,Ee))}(i,a,s,l,t)}}),c.addEventListener("click",function(){n.close()}),o.addEventListener("click",function(){!function(e){var t=h.getTemplate(["DELUGE_SELECT"]).DELUGE_SELECT;e.classList.add("addList");var n=t.querySelector(".params"),r=t.querySelector(".paramName"),i=t.querySelector(".selectDiv");t.querySelector(".delugeClose").addEventListener("click",function(){i.parentNode.removeChild(i);var t=Z.indexOf(i);Z.splice(t,1),0==Z.length&&e.classList.remove("addList")}),i.setAttribute("id","selectDiv"+P),ge(n,!0),e.appendChild(t),q.zcombo(n),r.focus(),Z[P++]=i}(p)}),ge(D,!1),(r=document.createElement("div")).id=N.DI+U.DELUGE_EDITOR+"_1"+N.IDENTITY,r.appendChild(i),n=new e.ZSClass.Dialog(r,a)}n.open()}function j(t,n){var r=h.getTemplate(["DELUGE_RUN"]).DELUGE_RUN;if(null==t){var i=getEditorValue();t=i.substring(i.indexOf(" "),i.indexOf("(")).trim()}var s=se(t);if(s&&s.length>0)!function(t,n,r){r&&(o.isEditorContentModified()?pe(!0):z.close());t.querySelector("#run");for(var i=se(n),s=t.querySelector("#param"),l=[],u=!1,d=0;d<i.length;d++){var v=i[d],E=v.name,g=h.getTemplate(["DELUGE_PARAMS"]),f=g.DELUGE_PARAMS,D=f.querySelector(".zsRangePicker"),p=f.querySelector("#paramName");p.innerText=E;var m=f.querySelector("#paramValue");m.setAttribute("id",E),s.appendChild(f),D.setAttribute("id",E+"_zsRangePicker"),u=!0}var S=t.querySelector("#executeBtn"),L=t.querySelector("#executeBtn").childNodes[1],I=t.querySelector("#cancel");S.addEventListener("click",function(){de(!0,!0,S,L,"Running");for(var e=se(n),t={},r=0;r<e.length;r++){var i=e[r],o=i.name;a.querySelector("#"+o),a.querySelector("#_"+o);t[o]=l[r].value}ie(t,n)}),I.addEventListener("click",function(){c.close()});var y={width:350,title:A["Deluge.Execute.Title"],open:function(){var e=i[0],t=e.name;a.querySelector("#"+t).focus()},close:function(){r&&W(),a=""}};(a=document.createElement("div")).classList.add("executeMacroDlg"),a.id=N.DI+U.MACRO_GOTO+N.IDENTITY,a.appendChild(t),c=new e.ZSClass.Dialog(a,y),u&&(l=function(e,t,n,r){for(var i=[],o=0;o<e.length;o++){var c=e[o],a=c.name,s=n.querySelector("#"+a),l=n.querySelector("#"+a+"_zsRangePicker"),u=new M.RangeEditor(s);ZSClass.RangePicker.register(u,!0);var r=l.querySelector("#DelugerangePickerIcon");i[o]=u,ZSClass.RangePicker.Dialog.register(u,t,r,A["Deluge.Execute.Title"])}return i}(i,c,a))}(r,t,n),c.open();else{var l=ae(t),u=T.view.getActiveGridID(),d=T.view.getResourceID(u),v=T.view.getVersionID(u);h.delugeExecuteAction(d,v,V.DRE_EXECUTE,l,null,oe)}}function Q(e){var n=h.getTemplate(["DELUGE_TREE"]).DELUGE_TREE,r=n.querySelector(".customMacro");return n.querySelector(".sheetMacros").innerText=e,r.addEventListener("click",function(){J||!o.isEditorContentModified()?(J=!1,m.classList.add("loader"),""!=F&&F.classList.remove("active"),r.classList.add("active"),F=r,le(e,!1)):pe(!1,!1,r)}),(E=t.querySelector("#macroTree")).appendChild(n),r}function $(e){var t=z.getDialog(),n=t.querySelector("#minimizeDialog"),r=t.querySelector("#maximizeDialog"),i=t.querySelector("#macroHelp");n.style.display=e?"none":"",r.style.display=e?"":"none",i.style.display=e?"none":""}var ee={save:function(){!function(){var e=getEditorValue(),t=e.substring(e.indexOf(" "),e.indexOf("(")).trim(),n=t.toUpperCase();e=e.replace(t,n);var r=ae(n),i=T.view.getActiveGridID(),o=T.view.getResourceID(i),c=T.view.getVersionID(i);if(null==r||""==r||void 0===r){var a=V.DRE_CREATE;e=encodeURIComponent(e);var s=A["Deluge.DefaultDescription"];h.delugeCreateAction(o,c,a,e,s,ce)}else{var a=V.DRE_UPDATE;e=encodeURIComponent(e),h.delugeUpdateAction(o,c,a,r,e,ce)}}()},execute:function(){ie()},callback:function(e){o=e}};function te(e){return T.data.DocRegistry[e].delugeFunctions}function ne(e){var t=e.delugeResponse,n=t.function,r=n.workflow.name,i=n.script;"success"==t.status&&(m.classList.remove("loader"),delugeEditor.setEditorContent(i),function(e,t){var n=T.view.getActiveGridID(),r=T.view.getResourceID(n),i=te(r),o=i&&i.get(e);o.setScript(t),T.data.DocRegistry[r].delugeFunctions.set(e,o)}(r,i))}function re(e){var t,n=0;E&&(E.innerHTML="",B={});var r=e.getMap();for(var i in r){var o,c=(o=r[i]).getScope();if("docs"==c||"user"==c)if(0==n)Q(i);else(o=e.get(i))&&(t=o.getId()),B[t]=Q(i),n++}}function ie(e,t){if(null==t){var n=getEditorValue();t=n.substring(n.indexOf(" "),n.indexOf("(")).trim()}var r=ae(t),i=T.view.getActiveGridID(),o=T.view.getResourceID(i),c=T.view.getVersionID(i),a=JSON.stringify(e);if(null==r||""==r||void 0===r){var s=V.DRE_CREATEANDEXECUTE;h.delugeCreateAndExecuteAction(o,c,s,n,a,oe)}else{s=V.DRE_EXECUTE;h.delugeExecuteAction(o,c,s,r,a,oe)}}function oe(e,t){var n=t.delugeResponse;a&&c.close(),ve(!1,!1,L,A["Macro.Editor.Run"]),W(e),o.V1Response.show(n)}function ce(e){var t=e.delugeResponse;if(ve(!1,!1,u,A["Macro.Editor.Save"]),o.V1Response.show(t),t&&"success"==t.status){var n=T.view.getActiveGridID(),r=T.view.getResourceID(n),i=(T.view.getVersionID(n),te(r)),c=t.function.workflow.name,a=i&&i.get(c);a&&(a.setScript(t.function.script),a.setArguments(t.function.workflow.params)),H?(H=!1,j(t.function.workflow.name,!0)):X?(X=!1,z.close()):(y&&y.click(),y="")}}function ae(e){var t=T.view.getActiveGridID(),n=T.view.getResourceID(t),r=(T.view.getVersionID(t),te(n)),i=r&&r.get(e);return i?i.getId():null}function se(e){var t=T.view.getActiveGridID(),n=T.view.getResourceID(t),r=(T.view.getVersionID(t),te(n)),i=r&&r.get(e);return i?i.getArguments():null}function le(e,t,n){I=n;var r=T.view.getActiveGridID(),i=te(T.view.getResourceID(r)),o=i&&i.get(e);if(o){var c=o.getScript();c?(m.classList.remove("loader"),delugeEditor.setEditorContent(c)):function(e){var t=T.view.getActiveGridID(),n=T.view.getResourceID(t),r=T.view.getVersionID(t);h.delugeGetDetailsAction(n,r,e,ne)}(e)}t&&W()}function ue(e){if(null!=e){var t=e.delugeResponse;"success"==t.status&&l(t.function.workflow.name)}}function de(e,t,n,r,i){e?n.classList.add("ZsLoadingIcon"):n.classList.remove("ZsLoadingIcon"),r.nodeValue=i}function ve(e,t,n,r){n&&(e?n.classList.add("ZsLoadingIcon"):n.classList.remove("ZsLoadingIcon"),n.disabled=t,n.querySelector("span").textContent=r)}function Ee(e){var t=e.delugeResponse;if(de(!1,0,d,v,"Save"),n.close(),W(),t)if(o.V1Response.show(t),"success"==t.status){o.setEditorContent(t.function.script);var r=t.function.id;B[r]||(B[r]=Q(t.function.workflow.name))}else"failure"==t.status&&o.setEditorContent(S)}function ge(e,t){for(var n=["string","int","float","date","bool","map","list"],r=0;r<n.length;r++){var i=document.createElement("option");i.setAttribute("value",n[r]),i.text=n[r],e.appendChild(i)}}function fe(e,t,n){var r=n[0],i=n[1];n[2],n[3],n[4],n[5];if(!B[i]){var o=Q(r);B[i]=o,o.click()}}function De(e,t,n){re(te(e)),o.setEditorContent("")}function pe(e,t,n){var r={buttons:[{text:A.Yes,primary:!0,click:function(){o.editor.saveScript()}},{text:A.No,click:function(){n?(J=!0,n.click()):t&&z.close()}}],title:A["Alert.Title.SaveChanges"]};ZSClass.ZSAlert(A["Deluge.SaveChanges"],r),y=n,H=e,X=t}function me(){r.parentNode.querySelector(".shNtfyWrpr").style.display="none"}O.openDialog=W,O.openHelpPage=function(){window.open("https://www.zoho.com/docs/help/custom-functions.html")},O.editMacro=le,O.runMacro=j,O.buttonAssignMacro=function(e){K(!0),l=e},O.createInsertDialog=K,O.getDelugeFunctionNameList=function(){var e=new Array,t=T.view.getActiveGridID(),n=te(T.view.getResourceID(t));if(n){var r=n.getMap();for(var i in r){var o=r[i].getScope();if("docs"==o||"user"==o){var c=["Deluge",i];e.push(c)}}}return e}}(this);
!function(e){var t=e.sPlusPlus,r=e.ZSConstants.FeatureConstants,a=(e.document,e.ZSConstants.wCC,e.ZSConstants.I18N),i=e.ZSEvents,o=i.topic,n=i.Groups,s=i.Names,l=e.ZSClass,c=l.Editors,v=l.Pivot,g=l.RangePicker,u=e.ZSConstants.CommandConstants,d=void 0,S=void 0,R=void 0,p=void 0,m=void 0,I=void 0,w=void 0,P=void 0,D=t.view.Toolbar.Feature[r.PIVOT_TABLE];function f(){I.close()}function C(e){var t=new l.Range(e.sr,e.sc,e.er,e.ec);p.value=d+"."+t.getLabel(),P.focus(),w.querySelector("#confirmPivot").classList.remove("zsDisable")}function h(){m.value.length>0?w.querySelector("#confirmPivot").classList.remove("zsDisable"):w.querySelector("#confirmPivot").classList.add("zsDisable")}function T(){w.querySelector("#targetLoc").classList.add("pvtHide"),w.querySelector("#confirmPivot").classList.contains("zsDisable")&&w.querySelector("#confirmPivot").classList.remove("zsDisable")}function E(){w.querySelector("#targetLoc").classList.remove("pvtHide"),m.value="",h(),w.querySelector("#pivotTargetCell").focus()}function L(){if(!w.querySelector("#confirmPivot").classList.contains("zsDisable")&&function(){if(S=t.view.getActiveGridID(),!w.querySelector("#nSheet").checked){var e,r=t.view.getResourceID(S),i=t.view.getVersionID(S),o=JSUtil.Range.parseRange(r,i,m.value.trim()),n=!0;if(o)if(t.data.getWorkBook(r,i).PivotCollection.isPivotCell(o.sheetID,o.range.startRow,o.range.startCol)){var s=o.sheetName+"."+new l.Range(o.range.startRow,o.range.startCol,o.range.endRow,o.range.endCol).getLabel();v=a["Error.Pivot.Table.Overlaps"],e=a["Alert.Title.InvalidDestination"],v=JSUtil.fn.replaceParams(v,new Array(s)),(c=document.createElement("div")).innerHTML=v,n=!1}else t.data.getWorkBook(r,i).PivotCollection.isPivotSourceCell(o.sheetID,o.range.startRow,o.range.startCol)?(v=a["Error.Pivot.Table.Overlaps.With.Source"],e=a["Alert.Title.InvalidCellRange"],v=JSUtil.fn.replaceParams(v,new Array(s)),(c=document.createElement("div")).innerHTML=v,n=!1):t.data.getWorkBook(r,i).PivotCollection.isPivotRange(o.sheetID,o.range.startRow,o.range.startCol,o.range.startRow+10,o.range.startCol+2)&&(s=o.sheetName+"."+new l.Range(o.range.startRow,o.range.startCol,o.range.startRow+10,o.range.startCol+2).getLabel(),v=a["Error.Pivot.Table.Overlaps"],e=a["Alert.Title.InvalidDestination"],v=JSUtil.fn.replaceParams(v,new Array(s)),(c=document.createElement("div")).innerHTML=v,n=!1);else{var c,v=a["GoalSeek.Msg.InvalidCell"];e=a["Alert.Title.InvalidCellRange"],(c=document.createElement("div")).innerHTML=v,n=!1}if(n)return!0;var g={buttons:[{text:a.OK,primary:!0,click:function(){m.value="",m.focus()}}],isHtml:!0,title:e};return l.ZSAlert(c,g),!1}return!0}())(function(){var e=t.view.getActiveGridID(),r=t.view.getResourceID(e),a=t.view.getVersionID(e),i=JSUtil.Range.parseRange(r,a,p.value.trim()),c=i.range;if(c.isSingle())return o.publish(n.Listener,s.ERROR.SHOW,{ERRORMSG:"Error.Pivot.Source.Selection"}),!1;v.ID="temp",v.currentPivotId="temp";var g=c.startRow,u=c.startCol,d=c.endRow,S=c.endCol,R=[];R.push(i.sheetID);var I=new l.ParamGenerator(R,r,a).getSheets(),w=new l.Range(g,u,d,S),P=JSUtil.Range.parseRange(r,a,m.value.trim());UserAction.getPivotFields(r,I[0],a,w,v.ID,P,!1)})()}o.register(n.Listener,s.UserAction.PIVOT.DETECT_RANGE,C,"resp_Range"),o.register(n.Listener,s.UserAction.PIVOT.NEW_GET_FIELDS,function(e,r){S=t.view.getActiveGridID();var a=t.view.getResourceID(S),i=t.view.getVersionID(S),l=t.data.getWorkBook(a,i).PivotCollection;v.ID="temp";var c={id:"temp",af:e,pf:[],rf:[],cf:[],df:[],fn:[],ptid:"2tc1",uf:{},sto:!0,rgto:!0,cgto:!0,aRef:!0,aExp:!0,fieldsExist:!1,overwrite:r},g=JSUtil.Range.parseRange(a,i,p.value.trim());if(c[u.SOURCE]=[g.sheetID,g.range.startRow,g.range.startCol,g.range.endRow,g.range.endCol],l.add("temp",c),w.querySelector("#nSheet").checked){var d=t.view.getSelectedSheets(S);f(),v.InsertSheetCallBack="NEW_PIVOT",UserAction.InsertSheet(a,d,i,void 0,void 0,!0,void 0)}else{var R=JSUtil.Range.parseRange(a,i,m.value.trim());c[u.TARGET]=[R.sheetID,R.range.startRow,R.range.startCol,R.range.startRow,R.range.startCol],f();var I=R.range;o.publish(n.Listener,s.UserAction.PIVOT.PIVOTPLACEHOLDER_ADD,{RID:a,SHEETID:R.sheetID,VERSION:i,ID:v.ID,RANGE:I}),o.publish(n.UI,s.SidePanel.PIVOT.SHOW_ICON),o.publish(n.UI,s.SidePanel.PIVOT.OPEN)}},"allFields","overwrite"),t.view.Toolbar.transient.destructor[r.PIVOT_TABLE]=function(){},D.openDialog=function(r){var i,o,n={width:358,title:a["Data.Pivot.CreatePivotTable"],resizable:!1,autoOpen:!1,close:function(){p.value="",m&&(m.value=""),w.querySelector("#nSheet").checked=!0,w.querySelector("#targetLoc").classList.add("pvtHide")},open:function(){!function(){S=t.view.getActiveGridID();var r=t.view.getResourceID(S);R=t.view.getSheetID(S);var a=t.view.getSelectedSheets(S),i=t.view.getVersionID(S),o=t.data.getWorkBook(r,i).getSheetObj(R);d=o.Prop.getName();var n=t.view.getSheetState(S,R).getRanges()[0];if(n.startRow===n.endRow&&n.startCol===n.endCol)e.UserAction.getPivotSRange(r,a,i),w.querySelector("#confirmPivot").classList.add("zsDisable");else{var s={sr:n.startRow,sc:n.startCol,er:n.endRow,ec:n.endCol};C(s)}w.querySelector("#nSheet").checked=!0}()}};I||(o=e.UserAction.getTemplate(["pivotSourceTemplate","pivotDestinationTemplate","pivotButtonTemplate"]),(w=document.createElement("div")).id="DI_PIVOT_PROMPT",w.appendChild(o.pivotSourceTemplate),w.appendChild(o.pivotDestinationTemplate),w.appendChild(o.pivotButtonTemplate),w.querySelector("#confirmPivot").addEventListener("click",L),w.querySelector("#cancelPivot").addEventListener("click",f),w.querySelector("#nSheet").addEventListener("click",T),w.querySelector("#eSheet").addEventListener("click",E),I=new e.ZSClass.Dialog(w,n),i=w.querySelector("#pivotTargetCell"),m=new c.RangeEditor(i,!0),g.register(m,!0,!0),m.addListeners({valueChanged:h}),function(){P=w.querySelector("#pivotSourceRange"),p=new c.RangeEditor(P,!0),g.register(p,!0);var e=w.querySelector("#pivotSourceRangeIcon");l.RangePicker.Dialog.register(p,I,e,"Select Range")}()),I.open()},D.handleError=function(e){if("Error.Pivot.Overwrite.Data.Generate"!==e){o.publish(n.UI,s.SidePanel.PIVOT.CLOSE);var r=a[e];return g={buttons:[{text:a.OK,primary:!0}],isHtml:!1},l.ZSAlert(r,g),!1}var i=a[e];a["Error.Pivot.Overwrite.Data.Header"],i=JSUtil.fn.replaceParams(i,new Array(m.value.trim()));var c=document.createElement("div");c.innerHTML=i;var g={buttons:[{text:a.Yes,primary:!0,click:function(){var e=t.view.getActiveGridID(),r=t.view.getResourceID(e),a=t.view.getVersionID(e),i=JSUtil.Range.parseRange(r,a,p.value.trim()),o=i.range;v.ID="temp",v.currentPivotId="temp";var n=o.startRow,s=o.startCol,c=o.endRow,g=o.endCol,u=[];u.push(i.sheetID);var d=new l.ParamGenerator(u,r,a).getSheets(),S=new l.Range(n,s,c,g),R=JSUtil.Range.parseRange(r,a,m.value.trim());UserAction.getPivotFields(r,d[0],a,S,v.ID,R,!0)}},{text:a.No,click:function(){m&&(m.value=""),w.querySelector("#pivotTargetCell").focus()}}],isHtml:!0};l.ZSAlert(c,g)}}(this);
!function(t){var e=t.sPlusPlus,i=t.ZSClass,s=t.document,l=t.UIUtil.Component,r=t.ZSConstants,a=r.I18N,o=(r.ActionConstants,i.Pivot),n=t.ZSConstants.PivotConstant,c=o.Dialog||(o.Dialog={}),h=function(t){this.callback=t,this.init()};function p(t){t="(Blanks)"==t?"":t;var e=this.getIndexOfSelectedItem(t);-1==e?this.addSelectItem(t):this.removeSelectedItem(e),v.call(this)}function v(){var t=this.selectedItems.length,e="autoCellFilterSelect";t==Object.keys(this.activeTabData).length?(!this.DOM[e].classList.contains("filterItemSelect")&&this.DOM[e].classList.add("filterItemSelect"),this.DOM[e].classList.remove("filterPartialSelection")):t<1?(this.DOM[e].classList.remove("filterItemSelect"),this.DOM[e].classList.remove("filterPartialSelection")):(this.DOM[e].classList.contains("filterItemSelect")&&this.DOM[e].classList.remove("filterItemSelect"),!this.DOM[e].classList.contains("filterPartialSelection")&&this.DOM[e].classList.add("filterPartialSelection"))}function d(){pvtFltCrit.classList.contains("betweenData")&&pvtFltCrit.classList.remove("betweenData"),pvtFltCrit.classList.contains("topBotm")&&pvtFltCrit.classList.remove("topBotm");var t=pvtCriteria1.value;"btwn"===t?pvtFltCrit.classList.add("betweenData"):"top"!==t&&"bottom"!==t||pvtFltCrit.classList.add("topBotm");"Td"==this.fieldDetails.type&&0==this.fieldDetails.gr&&-1!=["lt","lte","gt","gte","btwn"].indexOf(t)&&pivotFilterByMenu.value<0?"btwn"===t?(l.zdatefield(this.DOM.pvtBetTxt1,{format:"dd/MM/yyyy",width:"118px",picker:!0}),l.zdatefield(this.DOM.pvtCustomTxt2,{format:"dd/MM/yyyy",width:"118px",picker:!0})):l.zdatefield(pvtCustomTxt1,{format:"dd/MM/yyyy",picker:!0}):(l.zdatefield(pvtCustomTxt1,"destroy"),l.zdatefield(pvtBetTxt1,"destroy"),l.zdatefield(pvtCustomTxt2,"destroy"))}function u(){var t=this.fieldDetails.type,e=(this.DOM.pvtCriteria1,pvtCriteria1.value);if(l.zdatefield(pvtCustomTxt1,"destroy"),l.zdatefield(pvtCustomTxt2,"destroy"),l.zdatefield(pvtBetTxt1,"destroy"),"Tn"===t||pivotFilterByMenu.value>=0)l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes",[this.DOM.pvtCriteriaStringOP,this.DOM.pvtCriteriaRegexOP],"hidden",!0),"Tn"===t?(this.fieldDetails.hasOwnProperty("pgmn")&&this.fieldDetails.hasOwnProperty("pgmx")&&this.fieldDetails.hasOwnProperty("pgrz")?l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes",[this.DOM.pvtCriteriaRelationalOP],"hidden",!0):l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes",[this.DOM.pvtCriteriaRelationalOP],"hidden",!1),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes",[this.DOM.pvtCriteriTopBottomOP],"hidden",!0)):l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes",[this.DOM.pvtCriteriaRelationalOP,this.DOM.pvtCriteriTopBottomOP],"hidden",!1),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","gt","label",a["Condition.GreaterThan"]),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","gte","label",a["Condition.GreaterThanOrEqualTo"]),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","lt","label",a["Condition.LessThan"]),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","lte","label",a["Condition.LessThanOrEqualTo"]);else switch(t){case"Tt":l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes",[this.DOM.pvtCriteriaRelationalOP,this.DOM.pvtCriteriTopBottomOP],"hidden",!0),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes",[this.DOM.pvtCriteriaStringOP,this.DOM.pvtCriteriaRegexOP],"hidden",!1);break;case"Td":l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes",[this.DOM.pvtCriteriaRelationalOP],"hidden",!1),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes",[this.DOM.pvtCriteriaStringOP,this.DOM.pvtCriteriaRegexOP,this.DOM.pvtCriteriTopBottomOP],"hidden",!0),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","gt","label",a["Condition.DateAfter"]),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","gte","label",a["Condition.DateOnOrAfter"]),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","lt","label",a["Condition.DateBefore"]),l.zcombo(this.DOM.pvtCriteria1,"setOptionAttributes","lte","label",a["Condition.DateOnOrBefore"]),0==this.fieldDetails.gr&&-1!=["lt","lte","gt","gte","btwn"].indexOf(e)&&("btwn"===e?(l.zdatefield(this.DOM.pvtBetTxt1,{format:"dd/MM/yyyy",width:"118px",picker:!0}),l.zdatefield(this.DOM.pvtCustomTxt2,{format:"dd/MM/yyyy",width:"118px",picker:!0})):l.zdatefield(pvtCustomTxt1,{format:"dd/MM/yyyy",picker:!0}))}}function f(t,e){l[e]("#"+t)}function O(t,e){t.style.display=e?"":"none"}h.prototype={init:function(){var e=t.UserAction.getTemplate(["pivotFilter"]).pivotFilter;this.container=s.createElement("div"),this.container.id="DI_PIVOT_FILTER",this.container.className="flWrapper fltPvtDlg",this.container.appendChild(e),s.body.appendChild(this.container),this.selectedItems=[],l.initComponent("#"+this.container.id),function(){var t=this.container;this.DOM={autoFilterCnt:t.querySelector("#autoFilterCnt"),clearbtn:t.querySelector("#clearbtn"),filterbtn:t.querySelector("#filterbtn"),autoFilter:t.querySelector("#autoFilter"),autoCellFilterSearch:t.querySelector("#autoSearch"),autoCellFilterSelect:t.querySelector("#autoSelect"),pivotSortSelectTag:t.querySelector("#pivotSortByMenu"),pvtCriteria1:t.querySelector("#pvtCriteria1"),pvtCriteriaRelationalOP:t.querySelector("#relationalOp"),pvtCriteriaStringOP:t.querySelector("#stringOp"),pvtCriteriaRegexOP:t.querySelector("#regexOp"),pvtCriteriTopBottomOP:t.querySelector("#topBottomOp"),pvtFltCrit:t.querySelector("#pvtFltCrit"),pvtCustomTxt1:t.querySelector("#pvtCustomTxt1"),pvtCustomTxt2:t.querySelector("#pvtCustomTxt2"),pvtBetTxt1:t.querySelector("#pvtBetTxt1"),pvtFspinner:t.querySelector("#pvtFspinner"),pFcategory:t.querySelector("#pFcategory"),pivotFilterByMenu:t.querySelector("#pivotFilterByMenu"),labelOptGrp:t.querySelector("#labelOptGrp"),valueOptGrp:t.querySelector("#valueOptGrp"),toggleCustFilter:t.querySelector("#toggleCustFilter")}}.call(this),function(){var t=function(t){var e=this.DOM.pivotSortSelectTag.value;this.callback.sortPivot(this.pivotFilterCell.pId,this.pivotFilterCell.pft,this.pivotFilterCell.hidx,t,e),this.close()}.bind(this),e=this.container.querySelector("#sortAsc"),i=this.container.querySelector("#sortDesc");e.onclick=function(){t("true")},i.onclick=function(){t("false")};var s=function(t,e){for(var i=t.children,s=0;s<i.length;s++){var l=i[s],r=e&&!l.classList.contains("filterItemSelect")||!e;if(r){var a=l.getAttribute("value");if(e)l.classList.add("filterItemSelect"),l.classList.remove("filterPartialSelection"),this.addSelectItem(a),f("filterbtn","enable");else{l.classList.remove("filterPartialSelection"),l.classList.remove("filterItemSelect");var o=this.getIndexOfSelectedItem(a);this.removeSelectedItem(o),f("filterbtn","disable")}}}v.call(this)}.bind(this),l=this.DOM.autoFilterCnt;this.DOM.autoCellFilterSelect.onclick=function(){var t=!(!this.classList.contains("filterPartialSelection")&&this.classList.contains("filterItemSelect"));s(l,t)};var r=this,a=this.container.querySelector("#pvtFltmtBackBtn");a&&(a.onclick=function(){r.close()})}.call(this)},setConfiguration:function(t){this.callback.config=t},getDialogPos:function(){return this.container.style.display="",{height:this.container.clientHeight,width:this.container.clientWidth}},show:function(t,i,s,l,r){this.callback.config&&this.callback.config.hasHeader&&this.setHeader(this.callback.config.header),this.callback.config&&this.callback.config.hasEvents&&this.callback.config.events.onOpen(),this.container.style.top=t+s+e.view.measures.gridTop+"px",this.container.style.left=i+l+e.view.measures.gridLeft+"px",this.pivotFilterCell=r},generatePivotData:function(t){this.data=t,this.fFilterDetails=t[n.PIVOT_FILTER_DETAILS],this.fSortDetails=t[n.PIVOT_SORT_DETAILS];var e=this.container.querySelector("#autoFilterCntloader");O(e,!0);var i=o.Util.getsortByValues(this.pivotFilterCell.pId,this.pivotFilterCell.pft,this.pivotFilterCell.hidx);this.fieldDetails=i[0];var s=i[1];this.constructPivotSortMenu(s);var r=this.fFilterDetails.fType;r&&r>0?(this.DOM.toggleCustFilter.checked=!0,this.constructCustomFilter(s),this.constructPivotAutofilter(s)):(this.DOM.toggleCustFilter.checked=!1,this.constructPivotAutofilter(s),this.constructCustomFilter(s)),O(e,!1),function(){var t=function(){var t=this.pivotFilterCell;this.callback.applyFilter(t.pId,t.pft,t.hidx,void 0,!0),this.close()}.bind(this),e=function(){var t=this.pivotFilterCell;if(this.DOM.toggleCustFilter.checked){var e=pvtCriteria1.value,i=""!==this.DOM.pvtCustomTxt1.value?this.DOM.pvtCustomTxt1.value:"",s=""!==this.DOM.pvtCustomTxt2.value?this.DOM.pvtCustomTxt2.value:void 0;if("Td"==this.fieldDetails.type&&0==this.fieldDetails.gr&-1!=["lt","lte","gt","gte","btwn"].indexOf(e)&&pivotFilterByMenu.value<0)"btwn"===e?(i=l.zdatefield(this.DOM.pvtBetTxt1,"getValue").dateString,s=l.zdatefield(this.DOM.pvtCustomTxt2,"getValue").dateString):i=l.zdatefield(this.DOM.pvtCustomTxt1,"getValue").dateString;else if("btwn"===e)i=""!==this.DOM.pvtBetTxt1.value?this.DOM.pvtBetTxt1.value:"";else if("top"==e||"bottom"==e){i=pvtFspinner.value;var r=this.container.querySelector("#pvtFoCategory").value;e=e+" "+r}if(pivotFilterByMenu.value<0)var a=1;else var a=2,o=pivotFilterByMenu.value;var n=this.DOM.autoCellFilterSelect.classList.contains("filterItemSelect"),c=JSON.stringify([]);this.callback.applyFilter(t.pId,t.pft,t.hidx,c,n,a,e,i,s,o)}else{var a=0,n=this.DOM.autoCellFilterSelect.classList.contains("filterItemSelect"),c=void 0;!1===n&&(c=JSON.stringify(this.selectedItems)),this.callback.applyFilter(t.pId,t.pft,t.hidx,c,n,a)}this.close()}.bind(this);this.DOM.clearbtn.onclick=function(){t()},this.DOM.filterbtn.onclick=function(){e()}}.call(this)},constructPivotAutofilter:function(){var t="autoFilterCnt",e=this.fFilterDetails.cD,s=[];if(0==this.fFilterDetails.selectedItemIndexes.length)for(var l in{})s.push(0);else s=this.fFilterDetails.selectedItemIndexes;for(var r=[],a=0;a<e.length;a++){var o=""==e[a]?"(Blanks)":e[a];e[a];r.push(o)}this.activeTabData=r,v.call(this);t=this.DOM[t];var n=0,c=p.bind(this);new i.AutoSuggest.filterSuggest({editor:this.DOM.autoCellFilterSearch,container:t,data:r,dataType:"Array",fuzzy:!0,dontCreateSpan:!0,callBack:function(t){var e=t.text;new i.Filter.selectItems(void 0,c).generateAutoFilterItems(e,s[n],t.dom),t.decorate=function(){},n++}})},constructPivotSortMenu:function(t){document.createDocumentFragment();var e=this.fSortDetails[n.PIVOT_DATAFIELDINDEX],i=this.fSortDetails[n.ASCENDING_SORT],s=this.container.querySelector("#sortAsc"),r=this.container.querySelector("#sortDesc");this.fSortDetails[n.PIVOT_SORTMODE]<1?(s.classList.remove("selected"),r.classList.remove("selected")):i?(s.classList.add("selected"),r.classList.remove("selected")):(r.classList.add("selected"),s.classList.remove("selected")),this.DOM.pivotSortSelectTag.innerHTML="";for(var a=-1,o=0;o<t.length;o++){var c=document.createElement("option");c.value=a,c.textContent=t[o],this.DOM.pivotSortSelectTag.appendChild(c),a++}l.zcombo(this.DOM.pivotSortSelectTag,"refresh"),l.zcombo(this.DOM.pivotSortSelectTag,"setValue",e)},constructCustomFilter:function(t){var e=this.fFilterDetails.fc1,i=this.fFilterDetails.fv,s=this.fFilterDetails.fv1,r=this.fFilterDetails[n.PIVOT_DATAFIELDINDEX];f("filterbtn","enable");var a=-2;r>-1&&(a=r),this.DOM.labelOptGrp.innerHTML="",this.DOM.valueOptGrp.innerHTML="";for(var o=-1,c=0;c<t.length;c++){var h=document.createElement("option");h.value=o,h.textContent=t[c],0==c?(h.value=-2,this.DOM.labelOptGrp.appendChild(h)):this.DOM.valueOptGrp.appendChild(h),o++}l.zcombo(this.DOM.pivotFilterByMenu,"setValue",a),u.call(this),l.zcombo(this.DOM.pvtCriteria1,"setValue",e),d.call(this);"Td"==this.fieldDetails.type&&0==this.fieldDetails.gr&&-1!=["lt","lte","gt","gte","btwn"].indexOf(e)&&a<0?"btwn"===e?(l.zdatefield(this.DOM.pvtBetTxt1,"setValue",i),l.zdatefield(this.DOM.pvtCustomTxt2,"setValue",s)):l.zdatefield(this.DOM.pvtCustomTxt1,"setValue",i):"btwn"===e?(pvtFltCrit.classList.add("betweenData"),this.DOM.pvtBetTxt1.value=i,this.DOM.pvtCustomTxt2.value=s):"top"===e||"bottom"===e?(pvtFltCrit.classList.add("topBotm"),l.zspinner(this.DOM.pvtFspinner,"setValue",i)):i&&(this.DOM.pvtCustomTxt1.value=i),l.zcombo(this.DOM.pivotFilterByMenu,"refresh"),l.unbind(this.DOM.pvtCriteria1,"zselectboxchange"),l.bind(this.DOM.pvtCriteria1,"zselectboxchange",d.bind(this)),l.unbind(this.DOM.pivotFilterByMenu,"zselectboxchange"),l.bind(this.DOM.pivotFilterByMenu,"zselectboxchange",u.bind(this))},close:function(){this.clean(),this.selectedItems=[],this.container&&""===this.container.style.display&&(this.container.style.display="none",function(){this.DOM.autoFilterCnt.innerHTML="",l.zdatefield(pvtCustomTxt1,"destroy")}.call(this)),pvtFltCrit.classList.contains("betweenData")&&pvtFltCrit.classList.remove("betweenData"),pvtFltCrit.classList.contains("topBotm")&&pvtFltCrit.classList.remove("topBotm"),l.zcombo(this.DOM.pivotFilterByMenu,"setValue",-1),l.zcombo(this.DOM.pvtCriteria1,"setValue",-1),this.DOM.pvtCustomTxt1.value="",this.DOM.pvtCustomTxt2.value="",this.DOM.pvtBetTxt1.value=""},clean:function(){this.callback.config&&this.callback.config.hasEvents&&this.callback.config.events.onClose(),this.callback.config&&this.callback.config.hasHeader&&this.removeHeader(),delete this.callback.config},setHeader:function(t){var e=this.container.querySelector("#pvtFltmtHeaderWrapper");e.querySelector("#pvtFltmtHeadertxt").innerText=t.text,e.classList.remove("dsp_none")},removeHeader:function(){this.container.querySelector("#pvtFltmtHeaderWrapper").classList.add("dsp_none")},getIndexOfSelectedItem:function(t){return this.selectedItems.indexOf(t)},removeSelectedItem:function(t){this.selectedItems.splice(t,1)},initActiveTab:function(){this.filterTypes[this.activeTab]={},this.filterTypes[this.activeTab].selectedItems=[],v.call(this)},addSelectItem:function(t){t="(Blanks)"==t?"":t;this.selectedItems.push(t)},getActiveTab:function(){return this.filterTypes[this.activeTab]}},c.Filter=h}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,r=(e.document,e.ZSConstants.wCC,e.ZSConstants.I18N),l=e.ZSEvents,d=l.topic,o=l.Groups,a=l.Names,s=e.ZSClass,c=(s.Editors,e.ZSConstants.CommandConstants),h=e.UIUtil.Component,v=e.ZSConstants.PivotConstant,u=e.JSUtil,p=t.view.Toolbar.Feature[n.PIVOT_BUILDER],f=void 0,g=void 0,m=void 0,D=void 0,F=void 0,E=void 0,L=void 0,S=void 0,A=[],I=void 0,y=0,_=void 0;function T(){y=0;var i=t.view.getActiveGridID(),n=t.view.getResourceID(i),l=t.view.getVersionID(i);L=s.Pivot.currentPivotId;var d=t.data.getWorkBook(n,l).PivotCollection.get(L)[c.SOURCE];m=d[1],D=d[2],F=d[3],E=d[4],d[0],f||function(){Math.round(screen.height/10);" top";var t={width:418,title:r["Pivot.UI.Builder.Title"],resizable:!1,autoOpen:!1,left:400,close:function(){!function(){_&&_.unbindEvent();C("#pB_allFields"),C("#pf ul,#rf ul,#cf ul,#df ul")}()},open:function(){}},i=e.UserAction.getTemplate(["pivotBuilderTemplate","pivotBuilderDateTemplate"]);(g=document.createElement("div")).id="DI_PIVOT_BUILDER",g.classList.add("pivotBuilder"),g.appendChild(i.pivotBuilderTemplate),g.querySelector("#createPivot").addEventListener("click",b),g.querySelector("#cancelPivot").addEventListener("click",N),g.querySelector("#resetPivot").addEventListener("click",P),f=new e.ZSClass.Dialog(g,t),function(){var e,t,i=[r.None,r["Pivot.Submenu.Year"],r["Pivot.Submenu.Quarter"],r["Pivot.Submenu.Month"],r["Pivot.Submenu.Day"],r["Pivot.Submenu.Day.Week"],r["Pivot.Submenu.Quarter.Year"],r["Pivot.Submenu.Month.Year"]],n=document.getElementById("popupmenu"),l=document.createElement("ul");l.id="dateDropDown",l.setAttribute("ctype","zmenu"),l.setAttribute("relativeto","parent");for(var d=i.length,o=0;o<d;o++){var a=i[o],s=document.createElement("li"),c=o+1;s.id="gr"+c,s.textContent=a,l.appendChild(s)}n.appendChild(l),h.bind(l,"menushow",function(i,n){var r=n.target[0],l=r.parentNode;t=l.textContent.trim();for(var d,o=S[v.ALL_FIELDS],a=0;a<o.length;a++){var s=o[a];"Td"===s.type&&s.content===t&&(d=s[v.GROUP])}e=void 0===d?"gr1":"gr"+(d+1),h.zmenu("#dateDropDown","changeIcon",e,"ui-individual-icon ui-icon-ztick")}),h.bind(l,"menuhide",function(t,i){e&&h.zmenu("#dateDropDown","changeIcon",e,"ui-zmenu-no-icon")}),h.bind(l,"menuitemclicked",function(e,i){for(var n=i.menu.prevObject[0].id,r=n.substring(2)-1,l=S[v.ALL_FIELDS],d=0;d<l.length;d++){var o=l[d];"Td"===o.type&&o.content===t&&(o[v.GROUP]=r)}})}()}(),function(){var e=t.view.getActiveGridID(),i=t.view.getResourceID(e),n=t.view.getSelectedSheets(e),r=t.view.getVersionID(e),l=new s.Range(m,D,F,E);UserAction.getPivotFields(i,n,r,l)}(),f.open()}function C(e){document.querySelectorAll(e).forEach(function(e){if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild)})}function b(){for(var e,i,n,l=t.view.getActiveGridID(),d=t.view.getResourceID(l),o=t.view.getSelectedSheets(l),a=t.view.getVersionID(l),s=S[v.ALL_FIELDS],c={},h=0;h<s.length;h++){var u=s[h],p=u[v.GROUP];if(void 0!==p)c[u.colIndex.toString()]=p}S[v.GROUP]=c,e=!1,n=g.querySelector("#createPivot"),f.isAlive()&&(e?(n.classList.remove("ZsRt"),n.children[0].classList.remove("generate"),n.children[1].innerText=r["Pivot.UI.Generate"],i&&n.classList.add("ui-button-disabled","ui-state-disabled")):(n.children[1].innerText=r["Pivot.UI.Progress"],n.children[0].classList.add("generate"),n.classList.add("ZsRt"))),UserAction.createPivot(d,o,a,S)}function N(){f.close()}function P(){for(var e=[v.PAGE_FIELDS,v.ROW_FIELDS,v.COLUMN_FIELDS,v.DATA_FIELDS],t=0;t<e.length;t++){for(var i=e[t],n=g.querySelector("#"+i+" ul");n.firstChild;)n.removeChild(n.firstChild);S[i]=[]}var r=g.querySelector("#pB_allFields").children;for(t=0;t<r.length;t++){r[t].classList.remove("used-element")}A=[],S[v.FUNCTION]=[],g.querySelector("#createPivot").classList.add("ui-button-disabled","ui-state-disabled")}function U(t){return e.UserAction.getTemplate([t])}function x(e,t){S=t,A=[],this.allFields=S[v.ALL_FIELDS],this.selection={draggingField:void 0,sender:null,receiver:null,dropped:!1,usedElement:!1},this.placeholder={element:void 0,parent:void 0,position:void 0}}function O(){var e=e||window.event,t=e.target,n=t.className,r=t.parentNode.className,l=t.parentNode.parentNode.className,d=n;-1!=n.indexOf("ui-zcombo-select-item")?d=r:-1!=n.indexOf("ui-icon-triangle-1-s")?d=l:-1==n.indexOf("ui-zmenu-item")&&-1==n.indexOf("ui-zmenu-text")||(d="pDtmBox");var o=document.getElementsByClassName("pvtDataMenuBox");if(-1==d.indexOf("pDtmBox")){for(i=0;i<o.length;i++)o[i].style.display="none";document.body.removeEventListener("mousedown",O)}}x.prototype={init:function(e){this.constructFieldList(),this.constructMainList(),this.bindEvent()},constructMainList:function(){for(var e=g.querySelector("#pB_allFields"),t=S.af,i=document.createDocumentFragment(),n=0;n<t.length;n++){var r=t[n],l=r.colIndex,d=r.content,o=r.type;if(-1!==l){r.i=n+1;var a=U("allFieldsTemplate").allFieldsTemplate,s=a.querySelector("li"),c=a.querySelector(".fldL");a.querySelector(".fldIns").addEventListener("click",this.insertField.bind(this),!1),c.parentNode.children[0].className="fld"+o,c.innerText=d,this.isUsedField(l)&&(s.className+=" used-element"),i.appendChild(a)}}e.appendChild(i),g.querySelector("#createPivot").classList.add("ui-button-disabled","ui-state-disabled")},constructFieldList:function(){for(var e=[v.PAGE_FIELDS,v.ROW_FIELDS,v.COLUMN_FIELDS,v.DATA_FIELDS],t=S[v.ALL_FIELDS],i=S[v.FUNCTION],n=0;n<e.length;n++){var l=e[n],d=S[l],o=g.querySelector("#"+l+" ul");if(d&&d.length>0)for(var a=0;a<d.length;a++){var s=d[a];if(-1===s){var c={content:"Values",colIndex:-1,type:"Tt"},h=document.createDocumentFragment(),p=(y=U("fieldTemplate").fieldTemplate).querySelector("li");y.querySelector(".fldRmv").addEventListener("click",this.removeField.bind(this),!1),y.querySelector(".fldL").innerText=c.content,h.appendChild(p),o.appendChild(h),A.push({content:c.content,colIndex:c.colIndex,field:l}),this.allFields.push(c)}else for(var f=0;f<t.length;f++){var m=t[f];if(s===m.colIndex){var D=m.content;if(l===v.DATA_FIELDS){var F,E=i[a];for(F in E)var L=E[F];var I=F.charAt(0).toUpperCase()+F.slice(1);D=u.fn.replaceParams(r["Pivot.UI.Datafield.Content."+I],new Array(m.content));"none"!=L&&(D="% "+D)}var y;h=document.createDocumentFragment(),p=(y=U("fieldTemplate").fieldTemplate).querySelector("li");if("Td"===m.type)(_=y.querySelector(".pDrpdwn")).style.visibility="visible",_.setAttribute("popup","dateDropDown");else if(l===v.DATA_FIELDS){var _;p.setAttribute("content",m.content),(_=y.querySelector(".pDrpdwn")).style.visibility="visible",_.addEventListener("click",this.showPivotBuilderDataMenu.bind(this),!1)}p.addEventListener("dragover",this,!1),p.addEventListener("dragstart",this,!1),p.addEventListener("dragenter",this,!1),y.querySelector(".fldRmv").addEventListener("click",this.removeField.bind(this),!1),y.querySelector(".fldL").innerText=D,h.appendChild(p),o.appendChild(h),A.push({content:m.content,colIndex:m.colIndex,field:l})}}}}},isUsedField:function(e){for(var t=[v.PAGE_FIELDS,v.ROW_FIELDS,v.COLUMN_FIELDS,v.DATA_FIELDS],i=!1,n=0;n<t.length;n++){if(S[t[n]].indexOf(e)>-1){i=!0;break}}return i},getUsedField:function(e){for(var t=0;t<A.length;t++){var i=A[t];if(i.content===e&&i.field!==v.DATA_FIELDS)return i.field}},insertField:function(e){var t,i=e.target.parentNode.parentNode,n=i.textContent.trim();if(!this.getUsedField(n)){var r=i.children[0].children[0];if(t=this.getDefaultField(r)){i.className+=" used-element";var l=g.querySelector("#"+t+" ul"),d=l.children.length;this.selection.sender="allFields",t===v.DATA_FIELDS?this.addDataField(l,n,d):this.addField(t,n,d)}}},removeField:function(e){var t,i=e.target.parentNode.parentNode,n=i.parentNode.parentNode.id;t=n===v.DATA_FIELDS?i.getAttribute("content"):i.textContent.trim(),n&&this.removeDroppedElement(n,t,!0,void 0)},addValuesField:function(){var e=v.COLUMN_FIELDS;if((t=g.querySelector("#"+e+" ul").children.length)>=5){e=v.ROW_FIELDS;var t=g.querySelector("#"+e+" ul").children.length}if(t>=5)return!1;return this.addListElement(e,"Values",t),this.allFields.push({content:"Values",colIndex:-1,type:"Tt"}),this.addElementToUsedField(e,"Values",t),!0},addDataField:function(e,t,i){var n=v.DATA_FIELDS;return!this.isMaxField(n,t)&&(!(1===this.getFieldLength(v.DATA_FIELDS)&&!this.addValuesField())&&(this.addListElement(v.DATA_FIELDS,t,i),this.addElementToUsedField(v.DATA_FIELDS,t,i),!0))},addField:function(e,t,i){if(!this.isMaxField(e,t)){if(e===v.DATA_FIELDS){g.querySelector("#"+v.DATA_FIELDS+" ul").children;if(1===this.getFieldLength(v.DATA_FIELDS)&&!this.addValuesField())return!1}"allFields"!==this.selection.sender&&this.selection.sender!==v.DATA_FIELDS||(this.addListElement(e,t,i),this.addElementToUsedField(e,t,i))}},addListElement:function(e,t,i){var n,l=g.querySelector("#"+e+" ul"),d=this.getFieldType(t);if(e===v.DATA_FIELDS){var o,a={},s=S[v.FUNCTION];0==s.length?(a[o="Tn"===d?"sum":"count"]="none",s.splice(i,0,a)):o=s[i],o=o.charAt(0).toUpperCase()+o.slice(1),"data",n=t,t=u.fn.replaceParams(r["Pivot.UI.Datafield.Content."+o],new Array(t))}else"Td"===d&&"date";var c=document.createDocumentFragment(),h=U("fieldTemplate").fieldTemplate,p=h.querySelector(".pDrpdwn"),f=h.querySelector("li");e===v.DATA_FIELDS?(f.setAttribute("content",n),p.style.visibility="visible",p.addEventListener("click",this.showPivotBuilderDataMenu.bind(this),!1)):"Td"===d&&(p.style.visibility="visible",p.setAttribute("popup","dateDropDown")),h.querySelector(".fldRmv").addEventListener("click",this.removeField.bind(this),!1),h.querySelector(".fldL").innerText=t,c.appendChild(h),f.addEventListener("dragstart",this,!1),f.addEventListener("dragover",this,!1),f.addEventListener("dragenter",this,!1);var m=l.querySelector(".dropPos");m?m.replaceWith(c):l.appendChild(c)},replacePlaceHolderWithElem:function(){if(this.selection.sender===v.DATA_FIELDS&&this.selection.receiver!=v.DATA_FIELDS){var e=this.selection.draggingField.getAttribute("content"),t=this.selection.draggingField.querySelector(".pDrpdwn");t.style.visibility="hidden",t.removeEventListener("click",this.showPivotBuilderDataMenu.bind(this)),this.selection.draggingField.querySelector(".fldL").innerText=e}var i=this.selection.receiver,n=g.querySelector("#"+i+" ul").querySelector(".dropPos");i=this.selection.receiver;n&&("none"==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="block"),n.replaceWith(this.selection.draggingField))},addElementToUsedField:function(e,t,i){var n=this.getColIndex(t);A.push({content:t,colIndex:n,field:e}),this.changeElementInFieldArray(n,i,e)},changeElementInFieldArray:function(e,t,i,n,r){A.length>0?g.querySelector("#createPivot").classList.remove("ui-button-disabled","ui-state-disabled"):g.querySelector("#createPivot").classList.add("ui-button-disabled","ui-state-disabled");var l=void 0;if(n){var d=S[n];if(void 0!==r&&r>-1&&n===v.DATA_FIELDS){d.splice(r,1);var o=S[v.FUNCTION];l=o.splice(r,1)[0]}else for(var a=0;a<d.length;a++)if(d[a]===e){d.splice(a,1),n===v.DATA_FIELDS&&(l=(o=S[v.FUNCTION]).splice(a,1)[0]);break}}i&&(S[i].splice(t,0,e),l&&i===v.DATA_FIELDS&&o.splice(t,0,l))},removeALLDataField:function(){for(var e=g.querySelector("#"+v.DATA_FIELDS+" ul").children,t=e.length,i=0;i<t;i++){var n=e[0];this.removeDroppedElement(v.DATA_FIELDS,n.getAttribute("content"),!0)}},removeDroppedElement:function(e,t,i,n){this.removeListElement(e,t,n);var r=this.removeElementFromUsedField(e,t,i,n);i&&-1===r&&this.removeALLDataField()},removeListElement:function(e,t,i){var n,r=g.querySelector("#"+e+" ul").children,l=e===v.DATA_FIELDS;if(void 0!==i&&i>-1)"dropPos"===(n=r[i]).getAttribute("class")?(n=r[i+1]).parentNode.removeChild(n):n.parentNode.removeChild(n);else for(var d=0;d<r.length;d++){n=r[d],(l?n.getAttribute("content"):n.textContent.trim())===t&&n.parentNode.removeChild(n)}if(l&&this.getFieldLength(v.DATA_FIELDS)<=1){var o=this.getUsedField("Values");o&&this.removeDroppedElement(o,"Values",!1)}},getFieldLength:function(e){for(var t=0,i=g.querySelector("#"+e+" ul").children,n=0;n<i.length;n++){i[n].classList.contains("dropPos")||t++}return t},removeElementFromUsedField:function(e,t,i,n){for(var r=-2,l=0;l<A.length;l++){var d=A[l];if(d.field===e&&d.content===t){r=d.colIndex,A.splice(l,1);break}}return r>=-1&&this.changeElementInFieldArray(r,void 0,void 0,e,n),i&&-1!==r&&this.toggleAllFieldCheck(t,r,!1),r},toggleAllFieldCheck:function(e,t,i){if(!this.isUsedField(t))for(var n=g.querySelector("#pB_allFields").children,r=0;r<n.length;r++){var l=n[r];if(l.textContent.trim()===e){i?l.classList.add("used-element"):l.classList.remove("used-element");break}}},getFieldType:function(e){for(var t=0;t<this.allFields.length;t++){var i=this.allFields[t];if(i.content===e)return i.type}return"Tt"},isMaxField:function(e,t){return!1},unbindEvent:function(){for(var e=g.querySelector("#pB_allFields").children,t=0;t<e.length;t++){e[t].removeEventListener("dragstart",this,!1)}var i=g.querySelectorAll("#pf ul,#rf ul,#cf ul,#df ul");for(t=0;t<i.length;t++){var n=i[t];n.removeEventListener("dragenter",this,!1),n.removeEventListener("dragover",this,!1),n.removeEventListener("drop",this,!1),n.removeEventListener("dragend",this,!1)}},bindEvent:function(){var e=document.createElement("li");e.className="dropPos",this.placeholder.element=e;for(var t=g.querySelector("#pB_allFields").children,i=0;i<t.length;i++){t[i].addEventListener("dragstart",this,!1)}var n=g.querySelectorAll("#pf ul,#rf ul,#cf ul,#df ul");for(i=0;i<n.length;i++){var r=n[i];r.addEventListener("dragenter",this,!1),r.addEventListener("dragover",this,!1),r.addEventListener("drop",this,!1),r.addEventListener("dragleave",this,!1)}},handleEvent:function(e){var t=e.target.parentNode,i=e.target.nodeName;if("dragend"===e.type)this.pFieldDragEnd(e);else if("LI"===i){var n=t.id?t.id:t.parentNode.id;if("pB_allFields"===n)switch(e.type){case"dragstart":this.allField_dragstart(e)}else if("pf"===n||"rf"===n||"cf"===n||"df"===n)switch(e.type){case"dragstart":this.field_dragstart(e);break;case"dragenter":this.field_dragEnter(e);break;case"dragover":this.field_dragover(e);break;case"drop":this.fieldContainer_drop(e)}}else if("UL"===i)switch(e.type){case"dragenter":this.fieldContainer_dragEnter(e);break;case"dragover":this.fieldContainer_dragover(e);break;case"drop":this.fieldContainer_drop(e);break;case"dragend":this.fieldContainer_dropEnd(e);break;case"dragleave":this.fieldContainer_dragLeave(e)}else if("SPAN"===i)switch(e.type){case"dragenter":case"dragover":this.field_eventDPrevent(e);break;case"drop":this.fieldContainer_drop(e)}},pFieldDragEnd:function(){var e=this.selection.draggingField.textContent.trim();if(this.selection.dropped){this.getUsedField(e)&&(this.selection.draggingField.className+=" used-element")}else{var t=this.selection.sender;"allFields"!=t&&this.removeDroppedElement(t,e,!0)}for(var i=[v.PAGE_FIELDS,v.ROW_FIELDS,v.COLUMN_FIELDS,v.DATA_FIELDS],n=0;n<i.length;n++){var r=g.querySelector("#"+i[n]).children[0];r.contains(this.placeholder.element)&&r.removeChild(this.placeholder.element)}this.applyOrRemoveHoverClass(!1),document.body.removeEventListener("dragend",this,!1)},addSelection:function(e){if(this.selection.owner){if(this.selection.owner!=e.parentNode)return}else this.selection.owner=e.parentNode;this.selection.draggingField=e},clearSelections:function(){this.selection={draggingField:void 0,sender:null,receiver:null,dropped:!1,usedElement:!1}},allField_dragstart:function(e){var t=e.target;this.clearSelections(),this.addSelection(e.target),e.dataTransfer.effectAllowed="copy",e.dataTransfer.setData("text/html",this.outerHTML),this.selection.sender="allFields",t.classList.contains("used-element")?this.selection.usedElement=!0:this.selection.usedElement=!1,document.body.addEventListener("dragend",this,!1),this.applyOrRemoveHoverClass(!0)},field_dragstart:function(e){e.dataTransfer.effectAllowed="move",e.stopImmediatePropagation();var t=e.target;this.clearSelections(),this.addSelection(t),this.selection.sender=t.parentNode.parentNode.id,this.selection.receiver=t.parentNode.parentNode.id,document.body.addEventListener("dragend",this,!1),this.applyOrRemoveHoverClass(!0)},fieldContainer_dragEnter:function(e){e.preventDefault(),"UL"==e.target.nodeName&&(this.selection.receiver=e.target.parentNode.id,e.target.contains(this.placeholder.element)||e.target.appendChild(this.placeholder.element))},fieldContainer_dragover:function(e){e.preventDefault(),e.stopPropagation()},field_dragEnter:function(){event.preventDefault(),event.stopPropagation()},field_dragover:function(e){e.preventDefault(),e.stopPropagation();var t=e.target,i=this._index(this.placeholder.element),n=this._index(t);this.placeholder.position=i,"allFields"!=this.selection.sender&&"none"!==this.selection.draggingField.style.display&&(this.selection.draggingField.style.display="none"),i<n?this._after(t,this.placeholder.element):this._before(t,this.placeholder.element)},fieldContainer_drop:function(e){e.target.parentNode,e.target.nodeName;e.preventDefault(),e.stopPropagation(),this.checkAddField(),this.selection.dropped=!0},field_eventDPrevent:function(e){e.preventDefault()},fieldContainer_dragLeave:function(e){var t=e.target.parentNode.id,i=this.placeholder.parent;"pf"!==t&&"rf"!==t&&"cf"!==t&&"df"!==t||"pf"!==i&&"rf"!==i&&"cf"!==i&&"df"!==i||e.target.contains(this.placeholder.element)&&e.target.removeChild(this.placeholder.element)},checkAddField:function(){var e=this.selection.draggingField.textContent.trim();this.selection.sender===v.DATA_FIELDS&&(e=this.selection.draggingField.getAttribute("content"));var t=this.placeholder.position,i=this.selection.receiver;if("allFields"===this.selection.sender)if(this.selection.usedElement){var n=this.getUsedField(e);n?n===this.selection.receiver||this.isMaxField(this.selection.receiver,e)||(this.removeDroppedElement(n,e,!1),this.addField(i,e,t)):this.addField(i,e,t)}else this.addField(i,e,t);else if(this.selection.receiver===v.DATA_FIELDS)if(d=this.getColIndex(e),this.selection.sender===v.DATA_FIELDS)this.replacePlaceHolderWithElem(),this.changeElementInFieldArray(d,t,this.selection.sender,this.selection.sender);else{this.removeElementFromUsedField(this.selection.sender,e,!1);var r=g.querySelector("#df").children[0];r.contains(this.placeholder.element)&&r.removeChild(this.placeholder.element);var l=g.querySelector("#df ul");this.addDataField(l,e,t)}else if(this.selection.sender===this.selection.receiver){var d=this.getColIndex(e);t>=0&&(this.replacePlaceHolderWithElem(),this.changeElementInFieldArray(d,t,this.selection.sender,this.selection.sender))}else this.replacePlaceHolderWithElem(),this.removeElementFromUsedField(this.selection.sender,e,!1),this.addElementToUsedField(i,e,t)},_index:function(e){return e.parentElement?Array.prototype.indexOf.call(e.parentElement.children,e):0},_before:function(e,t){e.parentElement.insertBefore(t,e)},_after:function(e,t){e.parentElement.insertBefore(t,e.nextElementSibling)},applyOrRemoveHoverClass:function(e,t,i){i=this.selection.draggingField.textContent.trim(),t=this.selection.sender;for(var n=[v.PAGE_FIELDS,v.ROW_FIELDS,v.COLUMN_FIELDS,v.DATA_FIELDS],r=0;r<n.length;r++){var l=n[r],d=g.querySelector("#"+l+" ul"),o=void 0;"allFields"===t&&i&&(o=this.getUsedField(i)),e&&o!==l&&(d.children.length<5||l===this.selection.sender)?d.classList.add("dragStart"):d.classList.remove("dragStart")}},getDefaultField:function(e){return e.classList.contains("fldTn")&&S[v.DATA_FIELDS].length<5?v.DATA_FIELDS:e.classList.contains("fldTd")&&S[v.ROW_FIELDS].length<5?v.ROW_FIELDS:this.getMinUsedField()},getColIndex:function(e){for(var t=0;t<this.allFields.length;t++){var i=this.allFields[t];if(i.content===e)return i.colIndex}},getMinUsedField:function(){var e=S[v.ROW_FIELDS].length,t=S[v.COLUMN_FIELDS].length;return e<5||t<5?t<e?v.COLUMN_FIELDS:v.ROW_FIELDS:0===S[v.DATA_FIELDS].length?v.DATA_FIELDS:S[v.PAGE_FIELDS].length<5?v.PAGE_FIELDS:void 0},showPivotBuilderDataMenu:function(t){var n=e.UserAction.getTemplate(["pivotBuilderDataMenuTemplate"]),l=e.UIUtil.Component;document.getElementById("DI_PIVOT_BUILDER_DATAMENU")||((I=document.createElement("div")).id="DI_PIVOT_BUILDER_DATAMENU",I.appendChild(n.pivotBuilderDataMenuTemplate),document.body.appendChild(I));var d=document.getElementsByClassName("pvtDataMenuBox");for(i=0;i<d.length;i++)d[i].style.display="none";var o,a,s,c=event.target.parentNode.parentNode,h=c.parentNode,p=Array.prototype.slice.call(h.children).indexOf(c),f=c.children,g=I.querySelector("#pvtDataMenus");if(f.length<2){(o=g.cloneNode(!0)).removeAttribute("id");var m=o.getElementsByTagName("select"),D=m[0],F=m[1];y+=1,D.setAttribute("id","Data"+y),l.bind(D,"combochange",function(e){var t=new Event("change");D.dispatchEvent(t)}),D.addEventListener("change",function(e,t){var i=e.target.parentNode.parentNode.parentNode.parentNode,n=i.parentNode,l=Array.prototype.slice.call(n.children).indexOf(i),d=this.value,o=S[v.FUNCTION],a="none",s=o[l];for(var c in s)a=s[c];var h={};h[d.toLowerCase()]=a,o[l]=h;var p=i.getAttribute("content"),f=u.fn.replaceParams(r["Pivot.UI.Datafield.Content."+d],new Array(p));"none"!=a&&(f="% "+f),(p=i.querySelector(".fldL")).innerText=f}),y+=1,F.setAttribute("id","Data"+y),l.bind(F,"combochange",function(e){var t=e.target.parentNode.parentNode.parentNode.parentNode,i=t.parentNode,n=Array.prototype.slice.call(i.children).indexOf(t),l=this.value,d=S[v.FUNCTION],o=d[n];for(var a in o)T=o[a];var s={};s[a]=l,d[n]=s;var c=t.getAttribute("content"),h=a.charAt(0).toUpperCase()+a.slice(1),p=u.fn.replaceParams(r["Pivot.UI.Datafield.Content."+h],new Array(c));"none"!=l&&(p="% "+p),(c=t.querySelector(".fldL")).innerText=p}),l.initComponent(o),c.appendChild(o)}a=c.children[1],s=c.offsetTop-(parseInt(g.style.height)+c.offsetHeight-5),a.style.top=s+"px",a.style.display="block";var E=p+(p+1),L="#Data"+E,A="#Data"+(E+1),_="Sum",T="none",C=S[v.FUNCTION][p];for(_ in C)T=C[_];var b=_.charAt(0).toUpperCase()+_.slice(1);a.querySelector(L).value=b,a.querySelector(A).value=T,l.zcombo(D,"refresh"),l.zcombo(F,"refresh"),setTimeout(function(e){document.body.addEventListener("mousedown",O)},10)}},d.register(o.Listener,a.UserAction.PIVOT.OPEN_PIVOTBUILDER,T),d.register(o.Listener,a.UserAction.PIVOT.BEFORE_BUILDEROPEN,function(e){var i=t.view.getActiveGridID(),n=t.view.getResourceID(i),r=t.view.getVersionID(i);L=s.Pivot.currentPivotId;var l=t.data.getWorkBook(n,r).PivotCollection.get(L);e&&(l[c.TARGET]=[e,0,0,0,0]),T()},"NEWSHEETID"),p.openDialog=T}(this);
!function(e){var t=e.sPlusPlus,o=(e.document,e.UIUtil.Component,e.ZSClass),n=e.ZSConstants.FeatureConstants,i=(e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),a=(e.ZSConstants.wCC,e.ZSEvents),r=o.Editors,s=o.Editors.Utility,l=a.topic,v=a.Groups,c=a.Names,g=e.ZSConstants.CommandConstants,u=void 0,C=void 0,d=void 0;function S(){var e=o.Pivot.currentPivotId,n=t.view.getActiveGridID(),i=t.view.getResourceID(n),a=t.view.getVersionID(n),r=t.data.getWorkBook(i,a).PivotCollection.get(e),s=r[g.SOURCE],l=JSUtil.Range.parseRange(i,a,d.value.trim()),v=!1;if(s[0]!==l.sheetID||s[1]!==l.range.startRow)v=!0;else if(s[2]!==l.range.startCol||s[4]!==l.range.endCol){for(var c=s[4],u=s[2],C=[PivotConstants.PAGE_FIELDS,PivotConstants.ROW_FIELDS,PivotConstants.COLUMN_FIELDS,PivotConstants.DATA_FIELDS],S=0;S<C.length;S++){var E=r[C[S]];if(E&&E.length>0)for(var I=0;I<E.length;I++){var P=E[I];P<c&&(c=P),P>u&&(u=P)}}(c<l.range.startCol||u>l.range.endCol)&&(v=!0)}if(v);else{r[g.SOURCE]=[l.sheetID,l.range.startRow,l.range.startCol,l.range.endRow,l.range.endCol];var R=t.view.getSelectedSheets(n);p(),UserAction.changePivotSource(i,R,a,e,l.range,!1)}}function p(){u.close()}t.view.Toolbar.Feature[n.PIVOT_CHANGE_SOURCE].openDialog=function(n){var a,E;u||(a={width:358,title:i["Pivot.UI.Source.Title"],close:function(){d.value=""},open:function(){}},E=e.UserAction.getTemplate(["pivotSourceTemplate","pivotButtonTemplate"]),(C=document.createElement("div")).id="DI_PIVOT_CHANGE_SOURCE",C.appendChild(E.pivotSourceTemplate),C.appendChild(E.pivotButtonTemplate),C.querySelector("#confirmPivot").addEventListener("click",S),C.querySelector("#cancelPivot").addEventListener("click",p),u=new e.ZSClass.Dialog(C,a),function(e){var t=C.querySelector("#pivotSourceRange");t.focus(),d=new r.RangeEditor(t,!0),o.RangePicker.register(d,!0);var n=t.nextSibling;o.RangePicker.Dialog.register(d,u,n,"Select Range")}()),setTimeout(function(){var e,n,i,a,r,u,C,S;e=o.Pivot.currentPivotId,n=t.view.getActiveGridID(),i=t.view.getResourceID(n),a=t.view.getVersionID(n),r=t.data.getWorkBook(i,a).PivotCollection.get(e)[g.SOURCE],u=r[0],C=t.data.getWorkBook(i,a).getSheetObj(r[0]).Prop.getName(),S=new o.Range(r[1],r[2],r[3],r[4]),d.value=C+"."+S.getLabel(),d.focus(),l.publish(v.Listener,c.RangePicker.Update,{RID:i,SHEETID:u,VERSION:a,RANGE:S}),s.animateLabel.trigger(d)},10),u.open()}}(this);
!function(e){var t,i,o,r,a=e.sPlusPlus,n=(e.document,e.UIUtil.Component,e.ZSClass),l=e.ZSConstants.FeatureConstants,s=e.ZSConstants.CommandConstants,c=(e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),v=(e.ZSConstants.wCC,e.ZSEvents),d=n.Editors,u=(n.Editors.TextAreaEditor,n.Editors.Utility,v.topic,v.Groups,v.Names,!1),S=!1,g=n.Pivot,m=a.view.Toolbar.Feature[l.PIVOT_MOVE],P=void 0;function I(a){var l,s,v;u=!1,S=!1,i||(l={width:358,title:c["Pivot.UI.Move.Title"],close:function(){P.value=""},open:function(){}},s=e.UserAction.getTemplate(["pivotDestinationTemplate","pivotButtonTemplate"]),(o=document.createElement("div")).id="DI_PIVOT_MOVE",o.appendChild(s.pivotDestinationTemplate),o.appendChild(s.pivotButtonTemplate),o.querySelector("#confirmPivot").addEventListener("click",T),o.querySelector("#cancelPivot").addEventListener("click",D),o.querySelector("#nSheet").addEventListener("click",p),o.querySelector("#eSheet").addEventListener("click",C),i=new e.ZSClass.Dialog(o,l),v=o.querySelector("#pivotTargetCell"),P=new d.RangeEditor(v,!0),n.RangePicker.register(P,!0,!0),P.addListeners({valueChanged:O})),"move"==a?(u=!0,t="move"):"copy"==a?(t="copy",S=!0):"move"==t?u=!0:"copy"==t&&(S=!0),(u||S)&&(r=n.Pivot.ID),u?i.setTitle(c["Pivot.UI.Move.Title"]):i.setTitle(c["Pivot.UI.Select.Location.Title"]),o.querySelector("#nSheet").checked=!0,i.open()}function p(){o.querySelector("#targetLoc").classList.add("pvtHide"),o.querySelector("#confirmPivot").classList.contains("zsDisable")&&o.querySelector("#confirmPivot").classList.remove("zsDisable")}function C(){O(),o.querySelector("#targetLoc").classList.remove("pvtHide"),P.value="",o.querySelector("#pivotTargetCell").focus()}function T(){var e=a.view.getActiveGridID(),i=a.view.getResourceID(e),l=a.view.getSelectedSheets(e),v=a.view.getVersionID(e),d=r;if(o.querySelector("#nSheet").checked)D(),u?g.InsertSheetCallBack="MOVE_PIVOT":S&&(g.InsertSheetCallBack="COPY_PIVOT"),"INSERT_PIVOT"===g.InsertSheetCallBack?n.Pivot.Util.insertFromRecommendation(!0,!1):UserAction.InsertPivotSheet(i,l,v,void 0,void 0,!0,t);else if(u||S){if(g.LastAction=u?"DIALOG_MOVE":"DIALOG_COPY",!(C=JSUtil.Range.parseRange(i,v,P.value.trim()))){var m=c["GoalSeek.Msg.InvalidCell"],I={buttons:[{text:c.OK,primary:!0,click:function(){P.value="",P.focus()}}],title:c["Alert.Title.InvalidCellRange"]};return n.ZSAlert(m,I),!1}D(),UserAction.movePivot(i,l,v,d,C,!1,!1,t)}else{g.LastAction="DIALOG_INSERT";e=a.view.getActiveGridID(),i=a.view.getResourceID(e),v=a.view.getVersionID(e);var p=a.data.getWorkBook(i,v).PivotCollection.get("temp"),C=JSUtil.Range.parseRange(i,v,P.value.trim());p[s.TARGET]=[C.sheetID,C.range.startRow,C.range.startCol,C.range.startRow,C.range.startCol],D(),n.Pivot.Util.insertFromRecommendation()}}function O(){P.value.trim().length>0?o.querySelector("#confirmPivot").classList.remove("zsDisable"):o.querySelector("#confirmPivot").classList.add("zsDisable")}function D(){o.querySelector("#nSheet").checked=!0,p(),i.close()}m.openDialog=I,m.handleError=function(e){var t=e.split("#"),i=t[0],o=t[1],r=t.slice(1,t.length),l=n.Pivot.ID;if(r.length<1){var v=a.view.getActiveGridID(),d=a.view.getResourceID(v),u=a.view.getVersionID(v),S=a.data.getWorkBook(d,u).PivotCollection.get(l)[s.TARGET];r=a.data.getWorkBook(d,u).getSheetObj(S[0]).Prop.getName()+"."+new n.Range(S[1],S[2],S[3],S[4]).getLabel()}if("Error.Pivot.Table.Part.Change"===i||"Error.Pivot.Table.Overlaps.With.Source"===i){var m=c[i],P={buttons:[{text:c.OK,primary:!0,click:function(){I()}}],title:"Error.Pivot.Table.Part.Change"===i?c["Alert.Title.PivotTable"]:c["Alert.Title.InvalidCellRange"]};n.ZSAlert(m,P)}else if("Error.Pivot.Table.Overlaps.Create"===i||i.contains("Error.Pivot.Overwrite.Data")){var p;if("Error.Pivot.Table.Overlaps.Create"===i)m=c["Error.Pivot.Table.Overlaps.Create"],c["Error.Pivot.Table.Overlaps.Header"],m=JSUtil.fn.replaceParams(m,new Array(r)),(p=document.createElement("div")).innerHTML=m,P={buttons:[{text:c.OK,primary:!0,click:function(){I()}}],isHtml:!0,title:c["Alert.Title.InvalidDestination"]},n.ZSAlert(p,P);else m=c[i],c["Error.Pivot.Overwrite.Data.Header"],m=JSUtil.fn.replaceParams(m,new Array(r)),(p=document.createElement("div")).innerHTML=m,P={buttons:[{text:c.Yes,primary:!0,click:function(){switch(g.LastAction){case"SP_MOVE":case"SP_COPY":case"DIALOG_MOVE":case"DIALOG_COPY":var e=JSUtil.fn.getPosFromLabel(o),t=JSUtil.fn.getPosFromLabel(o).ranges[0],i=a.view.getActiveGridID(),r=a.view.getResourceID(i),l=a.view.getSelectedSheets(i),s=a.view.getVersionID(i),c=n.Pivot.ID;if("DIALOG_MOVE"==g.LastAction||"SP_MOVE"==g.LastAction)var v="move";else"DIALOG_COPY"!=g.LastAction&&"SP_COPY"!=g.LastAction||(v="copy");var d=a.data.getWorkBook(r,s).SheetList.getIdByName(e.sheetName),u={};u.sheetID=d,u.range=t,UserAction.movePivot(r,l,s,c,u,!0,!1,v);break;case"DIALOG_INSERT":n.Pivot.Util.insertFromRecommendation(!1,!0)}}},{text:c.No}],isHtml:!0},n.ZSAlert(p,P)}}}(this);
!function(e){var t,i,n,o=e.sPlusPlus,r=(e.document,e.UIUtil.Component),u=e.ZSClass,a=e.ZSConstants.FeatureConstants,l=(e.ZSConstants.CommandConstants,e.ZSConstants.JSKeyCode,e.ZSConstants.I18N),p=(e.ZSConstants.wCC,e.ZSEvents),c=(u.Editors,u.Editors.TextAreaEditor,u.Editors.Utility,p.topic),s=p.Groups,d=p.Names,g=u.Pivot,v=o.view.Toolbar.Feature[a.PIVOT_GROUP];function m(e){var t=e.target.id;"pvtGroupMinChBox"===t?r.zspinner("#groupMin","setValue",n.minVal):"pvtGroupMaxChBox"===t&&r.zspinner("#groupMax","setValue",n.maxVal)}function x(e){"min"===e?i.querySelector("#pvtGroupMinChBox").checked=!1:"max"===e&&(i.querySelector("#pvtGroupMaxChBox").checked=!1)}function S(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),r=o.view.getSelectedSheets(e),a=o.view.getVersionID(e),l=u.Pivot.currentPivotId,p=i.querySelector("#groupMin").value,v=i.querySelector("#groupMax").value,m=i.querySelector("#rangeSize").value;if(g.Group.Action.validate(p,v,m)){if(i.querySelector("#pvtGroupMinChBox").checked&&(p="auto"),i.querySelector("#pvtGroupMaxChBox").checked&&(v="auto"),n){if(p==n.pgmn&&v==n.pgmx&&m==n.pgrz)return void f();var x=g.Group.Action.getFieldPositioninPivot(n);if(!x)return c.publish(s.Listener,d.UserAction.PIVOT.SET_GROUP_VALUE,{colIndex:n.colIndex,min:p,max:v,size:m}),void f();var S=x.fieldType,I=x.headerIndex}else{var h=g.Group.Action.getNumFieldInfoDetails();if(h){S=h.fieldType,I=h.headerIndex;n=h.colInfo}}UserAction.groupFields(t,r,a,l,S,I,p,v,m),f()}}function f(){t.close()}v.openDialog=function(a){var p,c,s,d;n=a,t||(p={width:250,title:l["SidePanel.Sparklines.Group"],close:function(){var e,t,n;e=i.querySelector("#groupMin"),t=i.querySelector("#groupMax"),n=i.querySelector("#rangeSize"),e.value="",t.value="",n.value=""},open:function(){!function(e,t){e.querySelector("#groupMin"),e.querySelector("#groupMax");var i=e.querySelector("#pvtGroupMinChBox"),a=e.querySelector("#pvtGroupMaxChBox"),l=(e.querySelector("#rangeSize"),o.view.getActiveGridID());if(o.view.getResourceID(l),o.view.getVersionID(l),u.Pivot.currentPivotId,n)n=t;else{var p=g.Group.Action.getNumFieldInfoDetails();p&&(n=p.colInfo)}if(n){i.checked=!n.pgmn||"auto"==n.pgmn,a.checked=!n.pgmx||"auto"==n.pgmx;var c=n.pgmn&&"auto"!=n.pgmn?n.pgmn:n.minVal,s=n.pgmx&&"auto"!=n.pgmx?n.pgmx:n.maxVal,d=-1!=c.toString().indexOf(".")?c.toString().split(".")[1].length:0,v=-1!=s.toString().indexOf(".")?s.toString().split(".")[1].length:0;r.zspinner("#groupMin","setAttribute","decimalPlaces",d),r.zspinner("#groupMax","setAttribute","decimalPlaces",v),r.zspinner("#groupMin","setValue",n.pgmn&&"auto"!=n.pgmn?n.pgmn:n.minVal),r.zspinner("#groupMax","setValue",n.pgmx&&"auto"!=n.pgmx?n.pgmx:n.maxVal);var m=1;n.pgrz?m=n.pgrz:n.maxVal-n.minVal>30&&(m=n.maxVal<100?10:n.maxVal<1e3?100:n.maxVal<1e4?1e3:1e4),r.zspinner("#rangeSize","setValue",m)}}(i,n)}},c=e.UserAction.getTemplate(["PivotGroupingTemplate"]),(i=document.createElement("div")).id="DI_PIVOT_GROUP",i.className="pivotGroup",i.appendChild(c.PivotGroupingTemplate),i.querySelector("#createBtn").addEventListener("click",S),i.querySelector("#cancelBtn").addEventListener("click",f),i.querySelector("#pvtGroupMinChBox").addEventListener("click",m),i.querySelector("#pvtGroupMaxChBox").addEventListener("click",m),s=i.querySelector("#groupMin"),d=i.querySelector("#groupMax"),r.bind(s,"znumberfieldspin",function(e,t){x("min")}),r.bind(s,"znumberfieldinput",function(e,t){x("min")}),r.bind(d,"znumberfieldspin",function(e,t){x("max")}),r.bind(d,"znumberfieldinput",function(e,t){x("max")}),t=new e.ZSClass.Dialog(i,p)),t.open()},v.closeDialog=f,v.submit=S,v.unGroupSubmit=function(e){var t=o.view.getActiveGridID(),i=o.view.getResourceID(t),r=o.view.getSelectedSheets(t),a=o.view.getVersionID(t),l=u.Pivot.currentPivotId;if(n||e){var p=n||e,c=g.Group.Action.getFieldPositioninPivot(p);if(c)var s=c.fieldType,d=c.headerIndex}else{var v=g.Group.Action.getNumFieldInfoDetails();v&&(s=v.fieldType,d=v.headerIndex)}UserAction.groupFields(i,r,a,l,s,d)}}(this);
!function(e){var t=e.document;!e.ZSChart&&(e.ZSChart={});var n=e.ZSChart;!n.Wrapper&&(n.Wrapper={});var r={};function l(e,t){Object.keys(t).forEach(function(n){e.style[n]=t[n]})}function i(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}r.Events={KEYDOWN:"keydown",BLUR:"blur",FOCUSOUT:"focusout",INPUT:"input",SEARCH:"search",CHANGE:"change",CLICK:"click",MOUSEDOWM:"mousedown",MOUSEOVER:"mouseover",SUBMIT:"submit",KEYUP:"keyup",MOUSELEAVE:"mouseleave",MOUSEWHEEL:"mousewheel",DOMMOUSEWHEEL:"DOMMouseScroll"},r.getIndex=function(e){var t=this.getAllPrevElement(e,[]);return t?t.length:0},r.getAllPrevElement=function(e,t){for(var n=e.parentNode.firstChild;n&&n!==e;)3!==n.nodeType&&t.push(n),n=n.nextElementSibling||n.nextSibling;return t},r.getElementByClassName=function(e){return t.getElementsByClassName(e)[0]},r.getElementsByClassName=function(e){return t.getElementsByClassName(e)},r.getElementById=function(e){return t.getElementById(e)},r.removeClass=function(e,t){if(null!=e)if(this.isArray(e))for(var n=0;n<e.length;n++){e[n].classList.remove(t)}else e.classList.remove(t)},r.toggleActive=function(e){var t="";return this.hasClass(e,"active")?(this.removeClass(e,"active"),t=""):(this.addClass(e,"active"),t="active"),t},r.updateActive=function(e,t){var n="";return t?(this.addClass(e,"active"),n="active"):(this.removeClass(e,"active"),n=""),n},r.addClass=function(e,t){e&&e.classList.add(t)},r.hasClass=function(e,t){return null!=e&&e.classList&&e.classList.contains(t)},r.hideById=function(e){var n=t.getElementById(e);null!=n&&this.hide(n)},r.showById=function(e){var n=t.getElementById(e);null!=n&&this.show(n)},r.hide=function(e){e&&!e.style&&(e.style={}),e&&(e.style.display="none")},r.isVisible=function(e){return!("none"==e.style.display)},r.show=function(e){e&&(!e.style&&(e.style={}),e.style.display="")},r.hideByClassName=function(e){var t=this.getElementByClassName(e);this.hide(t)},r.hideElementsByClassName=function(e){for(var t=this.getElementsByClassName(e),n=0;n<t.length;n++)this.hide(t[n])},r.showByClassName=function(e){var t=this.getElementByClassName(e);this.show(t)},r.getElementStack=function(e,n){var r,l=n||e;return 0==(r=t.querySelectorAll(l)).length&&(r=t.querySelectorAll("."+l)),0==r.length&&(r=t.querySelectorAll("#"+l)),n&&(r=this.getChildStack(e,r)),r},r.isArray=function(e){var t=Object.prototype.toString.call(e);return"[object Array]"===t||"[object Array Iterator]"===t||"[object NodeList]"===t||"[object HTMLCollection]"==t},r.getChildStack=function(e,t){var n,r=[];if(this.isArray(t))for(var l,i=t.length,o=0;o<i;o++)0==(n=(l=t[o]).querySelectorAll(e)).length&&(n=l.querySelectorAll("."+e)),0==n.length&&(n=l.querySelectorAll("#"+e)),r.push(n);else 0==(n=t[0].querySelectorAll(e)).length&&(n=t[0].querySelectorAll("."+e)),0==n.length&&(n=t[0].querySelectorAll("#"+e)),r.push(n);return r},r.addChild=function(e,n,r){e="string"==typeof e?t.createElement("div"):e;var l="string"==typeof n?document.querySelector("#"+n):n;return!l&&(l=document.querySelector("."+n)),Object.keys(r).forEach(function(t){e.setAttribute(t,r[t])}),l&&l.appendChild(e),e},r.addChildByIndex=function(e,n,r,l){e="string"==typeof e?t.createElement("div"):e;var i="string"==typeof n?document.getElementById(n):n;return!i&&(i=document.getElementsByClassName(n)),Object.keys(r).forEach(function(t){e.setAttribute(t,r[t])}),i[l]?i[l].appendChild(e):i.appendChild(e),e},r.addChildAtIndex=function(e,n,r,l){e="string"==typeof e?t.createElement("div"):e;var i="string"==typeof n?document.getElementById(n):n;return!i&&(i=document.getElementsByClassName(n)),r&&Object.keys(r).forEach(function(t){e.setAttribute(t,r[t])}),i.children[l]?i.insertBefore(e,i.children[l]):i.appendChild(e),e},r.getActiveElement=function(e,t){for(var n=this.getElementByClassName(e).children,r=n.length,l=0;l<r;l++)if(n[l].classList.contains(t))return n[l]},r.getActiveStatus=function(e){var t=e.dataset;return t&&t.active&&"true"==t.active},r.getAttribute=function(e,t){return e.getAttribute(t)},r.getDatasetAttribute=function(e,t){return r=t,(n=e)&&n.dataset&&n.dataset[r];var n,r},r.setInnerHTML=function(e,t,n,r){var l=document.querySelector("#"+e);!l&&(l=document.querySelector("."+e)),!l&&(l=document.querySelector(e)),n&&(l.children[r].innerHTML=t),!n&&(l.innerHTML=t)},r.addEvent=function(e,t,n,r){var l=document.querySelectorAll("#"+e);0==l.length&&(l=document.querySelectorAll("."+e)),0==l.length&&(l=document.querySelectorAll(e));for(var i=0;i<l.length;i++)r&&this.addListenerIfNotAvailable(l[i],t,n,!1),!r&&l[i].removeEventListener(t,n,!1),!r&&l[i].addEventListener(t,n,!1)},r.getNodeInNode=function(e,t){var n=e.querySelectorAll("#"+t);return 0==n.length&&(n=e.querySelectorAll("."+t)),0==n.length&&(n=e.querySelectorAll(t)),n},r.getNodeInParent=function(e,t){var n;return n="string"==typeof e?this.getElements(e)[0]:e,this.getNodeInNode(n,t)},r.addStyle=function(e,t){var n,r;"string"==typeof e?(0==(n=document.querySelectorAll("#"+e)).length&&(n=document.querySelectorAll("."+e)),0==n.length&&(n=document.querySelectorAll(e))):(n=[]).push(e);for(var i=0;i<n.length;i++)(r=n[i])&&l(r,t)},r.addAttributes=function(e,t){var n;if("string"==typeof e){0==(n=document.querySelectorAll("#"+e)).length&&(n=document.querySelectorAll("."+e)),0==n.length&&(n=document.querySelectorAll(e));for(var r=0;r<n.length;r++)i(n[r],t)}else n=e,Object.keys(t).forEach(function(e){n&&n.setAttribute(e,t[e])})},r.addEventByNode=function(e,t,n,r){if(this.isArray(e))for(var l=e.length,i=0;i<l;i++){var o=e[i];this.addEventByNode(o,t,n,r)}r&&this.addListenerIfNotAvailable(e,t,n,!1),!r&&e&&e.removeEventListener&&e.removeEventListener(t,n,!1),!r&&e&&e.addEventListener&&e.addEventListener(t,n,!1)},r.addListenerIfNotAvailable=function(e,t,n,r){this.hasEvents(e,t)||(this.addBinder(e,t),e&&e.addEventListener&&e.addEventListener(t,n,r))},r.addBinder=function(e,t){try{var n=e.dataset,r=n?n.evts:null;r=r?r+" _"+t:t,e.setAttribute&&e.setAttribute("data-evts",r)}catch(e){}},r.hasEvents=function(e,t){if(!e)return!1;var n=e.dataset;return n&&n.evts&&-1!==n.evts.indexOf(t)},r.toggle=function(e){var t,n=document.querySelectorAll("#"+e);0==n.length&&(n=document.querySelectorAll("."+e)),0==n.length&&(n=document.querySelectorAll(e));for(var r=0;r<n.length;r++)t=n[r],this.isVisible(t)?this.hide(t):this.show(t)},r.getElements=function(e){var t=document.querySelectorAll("#"+e);return 0==t.length&&(t=document.querySelectorAll("."+e)),0==t.length&&(t=document.querySelectorAll(e)),0==t.length&&(t=document.getElementsByName(e)),t},r.findByClassName=function(e,t){for(var n,r=this.getElements(e),l=[],i=0;i<r.length;i++){(n=r[i]).classList.contains(t)&&l.push(n)}return l},r.findNodeByClassName=function(e,t){for(var n,r=[],l=0;l<e.length;l++){(n=e[l]).classList.contains(t)&&r.push(n)}return r},r.findByElementType=function(e,t){var n,r=[];if(!(n=this.getElements(e)[0]))return r;for(var l=n.children,i=0;i<l.length;i++)l[i].tagName===t&&r.push(l[i]);return r},r.findPreviousSibling=function(e){return e.previousSibling},r.findNextSibling=function(e){return e.nextSibling},r.findNodeByElementType=function(e,t){for(var n=[],r=e.children,l=0;l<r.length;l++)r[l].tagName===t&&n.push(r[l]);return n},r.findNodeByElementId=function(e,t){for(var n=[],r=e.children,l=0;l<r.length;l++)r[l].id===t&&n.push(r[l]);return n},r.findMatchingElementByAttribute=function(e,t,n){var r,l=[];r=e;for(var i=0;i<r.length;i++)this.getAttribute(r[i],t)===n&&l.push(r[i]);return l},r.remove=function(e){var t;if("string"==typeof e){if(0==(t=document.querySelectorAll("#"+e)).length&&(t=document.querySelectorAll("."+e)),0==t.length&&(t=document.querySelectorAll(e)),!t)return;for(var n,r=0;r<t.length;r++)(n=t[r])&&n.remove()}else(t=e)&&t.remove()},r.createTxtNode=function(e){return document.createTextNode(e)},r.getElementsByName=function(e){return t.getElementsByName(e)},r.flipState=function(e,t){e.target.checked=!t},r.createElement=function(e,t){var n=document.createElement(e);return t&&Object.keys(t).forEach(function(e){n.setAttribute(e,t[e])}),n},r.createElementNS=function(e,t,n){var r=document.createElementNS(e,t);return n&&Object.keys(n).forEach(function(e){r.setAttribute(e,n[e])}),r},r.removeAll=function(e){for(var t in e)this.remove(e[t])},r.appendChild=function(e,t){e&&e.appendChild(t)},r.isSameNode=function(e,t){return e===t},r.getParentNode=function(e){return e.parentNode},r.getElementStyle=function(e,t){var n,r="string"==typeof e?this.getElementById(e):e;return window.getComputedStyle?n=document.defaultView.getComputedStyle(r,null).getPropertyValue(t):r.currentStyle&&(n=r.currentStyle[t]),n},function(e){Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(e){function t(e,t){return{start:e,length:t,end:e+t}}function n(t,n){return!1===e||n.start<t.end&&t.start<n.end?Math.min(t.start,Math.max(n.start,t.end-n.length)):(t.start+t.end-n.length)/2}function r(e,t){return{x:e,y:t,translate:function(n,l){return r(e+n,t+l)}}}function l(e,t){for(;e;)t=t.translate(e.offsetLeft,e.offsetTop),e=e.offsetParent;return t}for(var i,o=l(this,r(0,0)),s=r(this.offsetWidth,this.offsetHeight),u=this.parentNode;u instanceof HTMLElement;)i=l(u,r(u.clientLeft,u.clientTop)),u.scrollLeft=n(t(o.x-i.x,s.x),t(u.scrollLeft,u.clientWidth)),u.scrollTop=n(t(o.y-i.y,s.y),t(u.scrollTop,u.clientHeight)),o=o.translate(-u.scrollLeft,-u.scrollTop),u=u.parentNode})}(),n.Wrapper.DOMUtils=r}(this);
!function(e){var t=e.sPlusPlus,r=e.ZSClass,i=(e.UserAction,e.ZSChart),o=i.Constants.ChartType,n=i.Constants.UnitConversion,s=i.Constants.ConversionType,a=i.Constants.UnitFormat,l=i.Constants.ServiceType,p=e.JSUtil,c=(i.Constants.ChartRangePickerType,i.Constants.TitleConstants);function g(){}function y(e,t){!e.yAxis[t.index].plotLines&&(e.yAxis[t.index].plotLines=[]),e.yAxis[t.index].plotLines&&!e.yAxis[t.index].plotLines[t.plIndex]&&(e.yAxis[t.index].plotLines[t.plIndex]={});var r="plot-line"+t.index+"_"+t.plIndex,i=e.yAxis[t.index].plotLines[t.plIndex];!i.id&&(i.id=r),!i.dashStyle&&(i.dashStyle="shortDash"),!i.width&&(i.width=2),!i.zIndex&&(i.zIndex=6)}function h(e,t,r,i,o){switch(!i&&(i=s.UNITS),i){case s.UNITS:e=function(e,t){if(0===e)return g(e);var r;switch(t){case a.DEFAULT:r=function(e){return e>=n.Thousand.MaxUnit&&e<n.Millions.Unit||o.call(this,e)?l(e):e>=n.Millions.Unit&&e<n.Billions.Unit?p(e):e>=n.Billions.Unit&&e<n.Trillions.Unit?c(e):e>=n.Trillions.Unit?function(e){return{cv:e/n.Trillions.Unit,symbol:n.Trillions.Symbol}}(e):g(e)}(e);break;case a.THOUSANDS:r=l(e);break;case a.MILLIONS:r=p(e);break;case a.BILLIONS:r=c(e);break;default:r=g(e)}return r}(e,r);break;case s.SCALES:e=function(e,t){return{cv:e/t,symbol:""}}(e,t);break;case s.NONE:e=g(e)}function l(e){return{cv:e/n.Thousand.Unit,symbol:n.Thousand.Symbol}}function p(e){return{cv:e/n.Millions.Unit,symbol:n.Millions.Symbol}}function c(e){return{cv:e/n.Billions.Unit,symbol:n.Billions.Symbol}}function g(e){return{cv:e,symbol:""}}return e}function u(e,t,r,o,n,s){var a=i.Constants.NumberFormat,l="";switch(n){case a.DEFAULT:l+=Highcharts.numberFormat(Math.abs(e),-1);break;case a.NONE:case a.CUSTOM:default:l+=Highcharts.numberFormat(Math.abs(e),-1,void 0,"")}return function(e,r,i,o,n){return"%"==t?e+o+r+i+n:e+o+i+r+n}(s,l,a.DEFAULT==n?t:"",r,o)}function d(e,t,r,s,l,p,c){var g=i.Constants.NumberFormat,y=(new i.Utility.ChartAgent).pickCurrency(s,t,r),d=e[t].nfCode||g.DEFAULT,f=e[t].prefix||"",v=e[t].suffix||"",x=e[t].unitFactor||a.DEFAULT;l=l||e[t].scaleFactor||1;var C=c?n.Thousand.Unit:n.Thousand.MaxUnit,A="";e[t].labels={enabled:e[t].labels.enabled,style:e[t].labels.style,isAxisDirty:e[t].labels.isAxisDirty,formatter:function(){var e=this.value;if(A=e<0?"-":"",-1!==r.toUpperCase().indexOf(o.PARETO)&&1==t||-1!==r.toUpperCase().indexOf("STACKEDCOL_PERCENT")||-1!==r.toUpperCase().indexOf("STACKEDBAR_PERCENT"))return Highcharts.numberFormat(Math.abs(e),0)+"%";if("%"==y)return u(Math.abs(e)/l,y,f,v,d,A);var i,s=h(Math.abs(e),l,x,p,(i=this.axis.getExtremes().max,function(e){return i>=C&&e<n.Thousand.MaxUnit&&e>=n.Thousand.Unit}));return u(s.cv,y,f,s.symbol+v,d,A)}}}function f(e,t){if(e){for(var r=e.length,i=[],o=0;o<r;o++){var n=e[o];n.sIndex&&n.sIndex==t||i.push(n)}e=i}return e}function v(e,t){for(var r=e.length,i=0;i<r;i++){if(x(e[i],t))return i}return-1}function x(e,t){var r=!1;return t.sIndex&&e.sIndex&&(r=t.sIndex==e.sIndex),t.pIndex&&e.pIndex&&(r=t.pIndex==e.pIndex),r}g.prototype.checkRedrawProperty=function(e,t,r,i){var n=t&&t.xAxis.type===l.STOCK,s=t?t.series:[],a=r&&r.options.series?r.options.series.length:0,p=s?s.length:0,c=p*(s[0]&&s[0].data?s[0].data.length:1),g=t.chart.type.toUpperCase()===o.WATERFALL.toUpperCase()||t.chart.type.toUpperCase()===o.PARETO.toUpperCase()||t.chart.type.toUpperCase()===o.WORDCLOUD.toUpperCase()||c>300||e.secYAxisSymbol,y=e.grouping,h=a!==p,u=-1!==e.type.indexOf("TIME"),d=i>=100,f=107==i||138==i||137==i||148==i||151==i||-1==i;t.chart.type.toUpperCase(),o.WORDCLOUD.toUpperCase();return n||g||y||h||u||d||f},g.prototype.isRecommendationCallNeeded=function(e){return!e||0==e},g.prototype.getCustomColorForActiveChart=function(){return this.getActiveChartMeta()[0].getCustomChartColor()},g.prototype.clone=function(e,t){var r=e instanceof Array?[]:{};for(var i in e)t&&e[i]&&"object"==typeof e[i]&&"renderTo"!=i?r[i]=this.clone(e[i],t):r[i]=e[i];return r},g.prototype.addInstance=function(e,r,i,o,n,s,a){var l=t.data.getWorkBook(e,i).getSheetObj(r).Charts,p=l.get(o);!p&&(p=this.addInSheetChartRegister(l,o,s,a)),this.updateInstance(o,r,l,n,p)},g.prototype.addInSheetChartRegister=function(e,t,r,o){var n=new i.Model.ChartGridMeta;return n.setOptions(r),n.setDetails(o),e.set(t,n),e.get(t)},g.prototype.updateInstance=function(e,t,r,i,o){o&&o.setInstance(i,!1),o&&(o.isLoaded=!0),o&&o.setAssociatedSheetId(t),r.set(e,o)},g.prototype.getInstance=function(e,r,i,o){return t.data.getWorkBook(e,i).getSheetObj(r).Charts.get(o)},g.prototype.isLockedSheet=function(e){var r=t.view.getActiveGridID(),i=t.view.getResourceID(r),o=t.view.getVersionID(r),n=e||t.view.getSheetID(r);return t.data.getWorkBook(i,o).ProtectedSheets.isSheetLocked(n)},g.prototype.setInstanceSize=function(e,t,r,o,n,s){var a=this.getInstance(e,t,r,o),l=(a.getType(),a.getInstance()),p=a.chartMeta,c=a.chartOptions,g={},y={};if(-1==p.type.indexOf("3D")&&-1==p.type.indexOf("STACKEDCOL_PERCENT")&&-1==p.type.indexOf("STACKEDCOL")&&-1==p.type.indexOf("STACKEDBAR")&&-1==p.type.indexOf("STACKEDBAR_PERCENT")&&-1==p.type.indexOf("ANIMATION_CHART")&&(-1!=p.type.indexOf("COL")||-1!=p.type.indexOf("BAR")||-1!=p.type.indexOf("HISTOGRAM")||-1!=p.type.indexOf("PARETO")||-1!=p.type.indexOf("COMBO"))){var h=function(e,t){t.series.length;for(var r=0,i=0;i<t.series.length;i++)(!t.series[i].type||"column"==t.series[i].type)&&(r+=t.series[i].data.length);var o=e.wd;"bar"===e.type&&(o=e.ht);var n=2,s=5-o/r/1.75/20+1;return n=s>5?5:s<1?1:s,n=parseFloat(n).toFixed(2),n+="%"}(p,c);c.plotOptions&&c.plotOptions.series&&(c.plotOptions.series.borderRadiusTopLeft=h)&&(c.plotOptions.series.borderRadiusTopRight=h)}c.plotOptions&&c.plotOptions.series&&c.plotOptions.dataLabels&&(c.plotOptions[c.chart.type]||(c.plotOptions[c.chart.type]={}),c.plotOptions[c.chart.type].dataLabels||(c.plotOptions[c.chart.type].dataLabels={}),c.plotOptions[c.chart.type].dataLabels.enabled=c.plotOptions.dataLabels.enabled),"N"!=p.lf&&(c.plotOptions[c.chart.type]||(c.plotOptions[c.chart.type]={}),c.plotOptions[c.chart.type].dataLabels||(c.plotOptions[c.chart.type].dataLabels={}),c.plotOptions[c.chart.type].dataLabels.enabled=!0);var u={tickWidth:p.grouping?1:0};g.xAxis=u,g.plotOptions=c.plotOptions,y.width=s,y.height=n,g.chart=y,i.Utility.updateChart.fn.call(this,l,g),a.isClientActionDone=!a.isClientActionDone},g.prototype.addNewPlotline=function(e,t){y(e,t);var r=e.yAxis[t.index].plotLines[t.plIndex];return r.value=t.plValue,e.yAxis[t.index].plotLines[t.plIndex]=r,e},g.prototype.removePlotlineByIndex=function(e,t){y(e,t);var r=e.yAxis[t.index].plotLines;return r&&r.splice(t.plIndex,1),e},g.prototype.updatePlotLineName=function(e,t){y(e,t);var r=e.yAxis[t.index].plotLines[t.plIndex];return r.label={text:t.title},e.yAxis[t.index].plotLines[t.plIndex]=r,e},g.prototype.getFormatLabels=function(e,t,r,i,o,n){for(var s=0;s<e.length;s++)d(e,s,r,t,i,o,n);return e},g.prototype.updateSeriesColor=function(e,t){-1===t.mType.indexOf("PIE")&&-1===t.cType.indexOf("pie")||(t.isSeries=!0),function(e,t){var r=t.pIndex,i=t.sIndex,o=t.cValue,n=t.isSeries;return e=function(e,t,r,i,o){var n=e.colorObject,s=n.pointColors,a=n.seriesColors;if(o)s=function(e,t){if(e){for(var r=e.length,i=[],o=0;o<r;o++){var n=e[o];n.sIndex&&n.sIndex==t||i.push(n)}e=i}return e}(s,r),a=function(e,t,r,i){return e?i?e=f(e,t):(e=f(e,t)).push({color:r,sIndex:t}):(e=[]).push({color:r,sIndex:t}),e}(a,r,i,!1);else{s||(s=[]);var l={color:i,pIndex:t},p=v(s,l),c=p>=0?s[p]:[];if(c.sIndex){p=v(c.points,l);var g=c.points?c.points:[];-1!=p?g[p]=l:g.push(l),c.points=g}else c.sIndex=r,c.points=[l];s.push(c)}return s&&s.length>=1&&(n.pointColors=s),a&&a.length>=1&&(n.seriesColors=a),e}.call(this,e,r,i,o,n)}.call(this,e,t)},g.prototype.setColorOptions=function(e,t,r){if(-1!==e.toUpperCase().indexOf(o.PIE.toUpperCase())||-1!==e.toUpperCase().indexOf(o.FUNNEL.toUpperCase())||-1!==e.toUpperCase().indexOf(o.WATERFALL.toUpperCase())||-1!==e.toUpperCase().indexOf(o.DOUGHNUT.toUpperCase()))for(var i=(p=t.seriesColors)?p.length:0,n=0;n<i;n++)for(var s=p[n],a=0;a<r.length;a++){var l=isNaN(parseInt(s.sIndex))?-1:parseInt(s.sIndex);r[a]&&r[a].data[parseInt(l)]&&(r[a].data[parseInt(l)].color=s.color)}else if(-1!==e.indexOf(o.COMBOCHART))for(i=(p=t.seriesColors)?p.length:0,n=0;n<i;n++)for(s=p[n],a=0;a<r.length;a++){l=isNaN(parseInt(s.sIndex))?-1:parseInt(s.sIndex);r[a]&&(-1!==r[a].type.toUpperCase().indexOf(o.PIE.toUpperCase())||-1!==r[a].type.toUpperCase().indexOf(o.FUNNEL.toUpperCase())||-1!==r[a].type.toUpperCase().indexOf(o.WATERFALL.toUpperCase()))&&r[a].data[parseInt(l)]?r[a].data[parseInt(l)].color=s.color:r[l]?r[l].color=s.color:r&&r.length>=1&&r[0].regressionSettings&&r[l-parseInt(r.length)]&&(r[l-parseInt(r.length)].regressionSettings.color=s.color)}else{var p;for(i=(p=t.seriesColors)?p.length:0,n=0;n<i;n++){r[l=void 0!==(s=p[n]).sIndex?parseInt(s.sIndex):-1]?r[l].color=s.color:r&&r.length>=1&&r[0].regressionSettings&&r[l-parseInt(r.length)]&&(r[l-parseInt(r.length)].regressionSettings.color=s.color)}}return function(e,t){var r=e&&e.pointColors?e.pointColors:null;if(!r)return;for(var i=r.length,o=0;o<i;o++)for(var n=r[o],s=n.points?n.points.length:0,a=0;a<s;a++){var l=n.points[a],p=l.pIndex,c=n.sIndex,g=l.color;t[c]&&(t[c].data[p].color=g)}}.call(this,t,r),r},g.prototype.getInstanceByCId=function(e){var r=t.view.getActiveGridID(),i=t.view.getResourceID(r),o=t.view.getVersionID(r),n=t.view.getSheetID(r);return t.data.getWorkBook(i,o).getSheetObj(n).Charts.get(e)},g.prototype.getAllMetaOfSheet=function(e,r,i){var o=t.data.getWorkBook(e,i).getSheetObj(r).Charts.getMap(),n=[];for(var s in o){var a=o[s];a.getSheetAssociatedId()==r&&n.push(a)}return n},g.prototype.getAllChartByColumnBoundary=function(e,t,r,i){var o=this.getAllMetaOfSheet(e,t,r),n=[];for(var s in o){var a=o[s];i<=a.getStartColIndex()&&n.push({id:a.getID()})}return n},g.prototype.getAllChartByRowBoundary=function(e,t,r,i){var o=this.getAllMetaOfSheet(e,t,r),n=[];for(var s in o){var a=o[s];i<=a.getStartRowIndex()&&n.push({id:a.getID()})}return n},g.prototype.getMaximumDataLength=function(e){if(e){for(var t=e.options.series.length,r=0,i=0;i<t;i++){var o=0;e.options.series[i]&&e.options.series[i].data&&(o=e.options.series[i].data.length),r=o>r?o:r}return r}},g.prototype.getAllChartID=function(e,r,i){var o=t.data.getWorkBook(e,i).getSheetObj(r).Charts.getMap(),n=[];for(var s in o){var a=o[s];a.getSheetAssociatedId()==r&&n.push(a.getID())}return n},g.prototype.mergeChartMeta=function(e,r,i,o){var n=t.data.getWorkBook(e,i).getSheetObj(r).Charts.getMap();for(var s in n){var a=n[s];if(o.id==a.getID()){var l=a.getDetails(),p={};return a.merge(p,l,o),void a.setDetails(p)}}},g.prototype.resetChartMetaVisitedProperty=function(e,t){for(var r in e){var i=e[r];void 0!==t?activeMeta.isLoaded=t:i.toggleVisited()}},g.prototype.getChartSvgByID=function(e){return this.getChartMeta(e).getSVG()},g.prototype.filterMeta=function(e,r,i,o,n,s){o=o||t.view.getActiveGridID();var a=r||t.view.getResourceID(o),l=(i=i||t.view.getVersionID(o),t.data.getWorkBook(a,i));if(l){var p=l.getSheetObj(e);if(p.Visited){var c=p.Charts.getMap(),g=[],y=[],h=[];for(var u in c){var d=c[u],f=d.getSheetAssociatedId(),v=d.isDirty,x=!n&&d.isLoaded;f==e&&(v&&g.push(d.getID()),(!v||s)&&!x&&y.push(d.getComputedChartMeta()),x&&!v&&h.push(d.getID()),d.toggleVisited())}return{afftectedCharts:g,CHARTS:y,CACHED:h}}}},g.prototype.getActiveChartID=function(){return i.Utility.getActiveChart()},g.prototype.getActiveChartMeta=function(){var e=i.Utility.getActiveChart(),t=[];for(var r in e)t.push(this.getChartMeta(e[r]));return t},g.prototype.getChartMeta=function(e){var r=t.view.getActiveGridID(),i=t.view.getResourceID(r),o=t.view.getVersionID(r),n=t.view.getSheetID(r);return this.getChartMetaOfSheet(n,i,o,r,e)},g.prototype.getChartMetaOfSheet=function(e,r,i,o,n){o=o||t.view.getActiveGridID();var s=r||t.view.getResourceID(o);i=i||t.view.getVersionID(o);return t.data.getWorkBook(s,i).getSheetObj(e).Charts.get(n)},g.prototype.filterRegressionSettings=function(e){var t=e.series,r=e.colors;for(var i in t){var o=t[i];o.hasOwnProperty("regressionSettings")&&(o.regressionSettings.color=r[i%r.length])}return e},g.prototype.isUniqueValue=function(e,t){return e!==t},g.prototype.isArray=function(e){e=e||"";var t=Object.prototype.toString.call(e);return"[object Array]"===t||"[object Array Iterator]"===t||"[object NodeList]"===t},g.prototype.merge=function(e,t,r,o){var n=new i.Utility.CommanAgent;return o?e=n.mergeRecursively(t,r):(Object.keys(t).forEach(function(r){e[r]=t[r]}),Object.keys(r).forEach(function(t){e[t]=r[t]})),e},g.prototype.getXAxisCatgeories=function(e,r,i,o){var n=t.data.getWorkBook(e,r).getSheetObj(i).Charts.get(o).getOptions();return(this.isArray(n.xAxis)?n.xAxis[0]:n.xAxis).categories},g.prototype.constructStyleProperty=function(e){var t={chart:{},caption:{},yAxis:[],xAxis:{},chartTitle:{},chartSubTitle:{},chartLegend:{},colorObject:{}};if(e.caption&&0==Object.keys(e.caption.style).length?(e.caption.style.fontSize="56px",e.caption.style.fontWeight="bold",e.caption.style.fontStyle="normal",e.caption.style.color="#a9a9a9",e.caption.style.display="block",t.caption=e.caption.style):e.caption&&e.caption.style?t.caption=e.caption.style:(t.caption.fontSize="56px",t.caption.fontWeight="bold",t.caption.fontStyle="normal",t.caption.color="#a9a9a9",t.caption.display="block"),e.chart.backgroundColor&&(t.chart.backgroundColor=e.chart.backgroundColor),e.chart.borderColor&&(t.chart.borderColor=e.chart.borderColor),e.chart.inverted&&(t.chart.inverted=e.chart.inverted),e.chart.plotBackgroundColor&&(t.chart.plotBackgroundColor=e.chart.plotBackgroundColor),e.chart.style&&(t.chart.style=e.chart.style),e.legend.itemStyle&&(t.chartLegend=e.legend.itemStyle),e.title.style&&(e.title.style.fill&&delete e.title.style.fill,t.chartTitle.style=e.title.style),e.subtitle.style&&(e.subtitle.style.fill&&delete e.subtitle.style.fill,t.chartSubTitle.style=e.subtitle.style),e.colorOptions&&(t.colorObject=e.colorOptions),e.xAxis&&e.xAxis.title&&e.xAxis.title.style?(e.xAxis.title.style.fill&&delete e.xAxis.title.style.fill,t.xAxis.style=e.xAxis.title.style,e.xAxis.labels.style&&(t.xAxis.labelStyle=e.xAxis.labels.style)):e.xAxis[0]&&e.xAxis[0].title&&e.xAxis[0].title.style&&(t.xAxis.style=e.xAxis[0].title.style,e.xAxis[0].labels.style&&(t.xAxis.labelStyle=e.xAxis[0].labels.style)),e.yAxis&&e.yAxis.length>=1)for(var r=0;r<e.yAxis.length;r++)t.yAxis[r]={},t.yAxis[r].index=r,e.yAxis[r].title.style&&(e.yAxis[r].title.style.fill&&delete e.yAxis[r].title.style.fill,t.yAxis[r].style=e.yAxis[r].title.style),e.yAxis[r].gridLineColor&&(t.yAxis[r].gridLineColor=e.yAxis[r].gridLineColor),e.yAxis[r].labels.style&&(t.yAxis[r].labelStyle=e.yAxis[r].labels.style);return t},g.prototype.getMaxColorLength=function(e){var t=e.chart.type;return-1!==t.indexOf(o.PIE)||-1!==t.indexOf(o.FUNNEL)||-1!==t.indexOf(o.WATERFALL)?this.getMaximumSeriesLength(e)[1]:e.chart.customChartType&&-1!==e.chart.customChartType.indexOf(o.BULLET)?3:e.series.length},g.prototype.getRowPosbyTop=function(e){var r=t.view.getActiveGridID(),i=t.view.getResourceID(r),o=t.view.getVersionID(r),n=t.view.getSheetID(r);return t.data.getWorkBook(i,o).getSheetObj(n).Row.auxiliaryAxis.findAbs(e)},g.prototype.getleftByColPos=function(e){var r=t.view.getActiveGridID(),i=t.view.getResourceID(r),o=t.view.getVersionID(r),n=t.view.getSheetID(r);return t.data.getWorkBook(i,o).getSheetObj(n).Column.auxiliaryAxis.getPos(e)},g.prototype.getTopByRowPos=function(e){var r=t.view.getActiveGridID(),i=t.view.getResourceID(r),o=t.view.getVersionID(r),n=t.view.getSheetID(r);return t.data.getWorkBook(i,o).getSheetObj(n).Row.auxiliaryAxis.getPos(e)},g.prototype.getColPosbyLeft=function(e){var r=t.view.getActiveGridID(),i=t.view.getResourceID(r),o=t.view.getVersionID(r),n=t.view.getSheetID(r);return t.data.getWorkBook(i,o).getSheetObj(n).Column.auxiliaryAxis.findAbs(e)},g.prototype.getMaximumSeriesLength=function(e){for(var t,r=0,i=0;i<e.series.length;i++)e.series[i].data&&e.series[i].data.length>r&&(t=i,r=e.series[i].data.length);return[t,r]},g.prototype.filterCurrency=function(e,t){e="string"==typeof e?JSON.parse(e):e;var r=0;for(var i in e)r++;var o=e||{},n=r-t;return n>0&&(o=function(e,t,r){for(var i=[],o=t,n=0;o<r;o++,n++)i[n]=e[o];return i}(o,n,r)),o},g.prototype.isMutipleAxiesChart=function(e){var t=!1;return i.Constants.MULTI_AXIES_CHART_TYPE.forEach(function(r){r==e&&(t=!0)}),t},g.prototype.isFallUnderThesholdSupportedTypes=function(e){switch(e){case o.COLUMNCHART.toUpperCase():case o.BAR.toUpperCase():case o.XYLINE.toUpperCase():case o.SPLINE.toUpperCase():case o.STEPCHART.toUpperCase():case o.XYAREA.toUpperCase():return!0}return!1},g.prototype.pickCurrency=function(e,t,r){var i="string"==typeof e?JSON.parse(e):e;if(this.isMutipleAxiesChart(r))return i[t]||"";for(var o=0;o<Object.keys(e).length;o++)if(e[o])return e[o];return""},g.prototype.pickPrecision=function(e,t){return!e&&(e={}),e[t]||0},g.prototype.getColorSchemenColors=function(e,t,r,n,s){e=this.resetChartColorCode(e);var a=i.Constants.ColorSchemeType;if(-1!==r.indexOf(a.COLORFUL)){l="ANIMATION_CHART"==s?e.series[0].data.length:this.getMaxColorLength(e),c=this.generateColorTheme(t,l,!0),e.colors=c}else{var l;l="ANIMATION_CHART"==s?e.series[0].data.length:this.getMaxColorLength(e);var p=!(!e.chart.customChartType||-1===e.chart.customChartType.indexOf(o.BULLET)&&-1===e.chart.customChartType.indexOf(o.GROUPED)),c=this.generateColorTheme(t,l,!1,!1,p),g=(n="string"==typeof n?"true"==n:n)?c.reverse():c;e.colors=g}return e},g.prototype.generateColorTheme=function(e,t,r,o,n){e="string"==typeof e&&-1!==e.indexOf("[")?JSON.parse(e):e;var s=[];if(r){var a=e.length,l=Math.min(Math.ceil(t/a),3);s=new i.Utility.SheetChartColor(e).getColorCombination(l)}else for(var p=0,c=1/(n?t:t+2),g=0;g<t;g++)s.push(o?new i.Utility.SheetChartColor(e).darken(p).getColor():new i.Utility.SheetChartColor(e).brighten(p).getColor()),p+=c;return s},g.prototype.resetChartColorCode=function(e){var t=e.chart.type;if(-1!==t.indexOf("pie")||-1!==t.indexOf("funnel")||-1!==t.indexOf("waterfall"))for(var r=0;r<e.series.length;r++)for(var i=0;i<e.series[r].data.length;i++)e.series[r].data[i].color&&delete e.series[r].data[i].color;else for(r=0;r<e.series.length;r++)e.series[r].color&&delete e.series[r].color;return e},g.prototype.fetchRangeUniqueValue=function(e,i,o,n){var s=t.view.getActiveGridID(),a=t.view.getResourceID(s),l=t.view.getVersionID(s),p=t.view.getSheetID(s);new r.UniqueData(a,p,l,e,i,o,n||{})},g.prototype.fetchRangeValue=function(e,r,i,o){var n=t.view.getActiveGridID(),s=t.view.getResourceID(n),a=t.view.getVersionID(n);e.trim().split(";").forEach(function(e){if(e.length>1){var l=p.Range.parseRange(s,a,e);if(l){var c=l.sheetID;t.view.fetchRangeData(s,c,a,l.range,[r||"DisplayValue"],!0,n,i,o)}}})},g.prototype.getCellValue=function(e,r,i){var o=t.view.getActiveGridID(),n=t.view.getResourceID(o),s=t.view.getVersionID(o),a=p.Range.parseRange(n,s,e);if(a){var l=a.range.startRow,c=a.range.startCol,g=a.sheetID;t.view.fetchCellData(n,g,s,l,c,["DisplayValue"],o,r,i)}else i(e)},g.prototype.detectTable=function(e,r,o){var n=t.view.getActiveGridID(),s=t.view.getResourceID(n),a=t.view.getVersionID(n),l=t.view.getSheetID(n);i.Server.doDetectTable(s,l,a,e,r,o)},g.prototype.generateMonochromaticShades=function(e,t){(new i.Utility.AgentDom).generateMonochromaticShades(e,t)},g.prototype.getActiveChartIDForSP=function(){return"preview"},g.prototype.reverseMonoColor=function(e,t){(new i.Utility.AgentDom).reverseAllLiItems(e,t)},g.prototype.addChartBoundary=function(e,t){e.chart.width=t.wd,e.chart.height=t.ht;var r=e.chart;return-1!==r.type.indexOf(o.PIE)||-1!==r.type.indexOf(o.FUNNEL)?(r.spacingLeft=r.spacingTop=r.spacingRight=10,r.spacingBottom=15):(r.spacingLeft=r.spacingTop=r.spacingRight=30,r.spacingBottom=20),e},g.prototype.applySeriesColorToPlotLines=function(e){e.yAxis;for(var t=0;t<e.yAxis.length;t++)if(e.yAxis[t].plotLines)for(var r=0;r<e.yAxis[t].plotLines.length;r++)e.yAxis[t].plotLines[r].color=e.colors?e.colors[t]:e.colorOptions.colorTheme.basecolor[t];return e},g.prototype.applySeriesColorToPlotLinesOnLoad=function(e,t){for(var r=0;r<e.length;r++)if(e[r].plotLines)for(var i=0;i<e[r].plotLines.length;i++)t[r]&&!e[r].plotLines[i].isPlColorChanged&&(e[r].plotLines[i].color=t[r].color);return e},g.prototype.applySeriesColorToAxis=function(e,t,r){if(!r)return e;e.yAxis;for(var i=0;i<e.yAxis.length;i++)e.yAxis[i]&&e.yAxis[i].labels&&(e.yAxis[i].labels.isAxisDirty||(e.yAxis[i].labels.style.color=t.colorTheme.basecolor[i]),e.yAxis[i].title.isAxisDirty||(e.yAxis[i].title.style.color=t.colorTheme.basecolor[i]));return e},g.prototype.applySeriesColorToYAxisOnLoad=function(e,t,r){if(r)for(var i=0;i<e.length;i++)e[i]&&e[i].labels&&(!e[i].labels.isAxisDirty&&t[i]&&(e[i].labels.style.color=t[i].color),!e[i].title.isAxisDirty&&t[i]&&(e[i].title.style.color=t[i].color));return e},g.prototype.applyLegendStyle=function(e,t){for(var r=Object.keys(t),i=0;i<r.length;i++)e.legend.itemStyle[r[i]]=t[r[i]];return e},g.prototype.applyChartLevelStyles=function(e,t,r){return e.chart[t]=r,e},g.prototype.applyTitleLevelStyles=function(e,t,r){return e.title[t]=r,e},g.prototype.applySubTitleLevelStyles=function(e,t,r){return e.subtitle[t]=r,e},g.prototype.getRenderTo=function(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.renderTo)return r.renderTo}},g.prototype.checkIfChartIsGrouped=function(e){return i.Utility.getChartMeta([e],!0).getOptions().aggregation.enabled},g.prototype.getRGBAColor=function(e){return-1!==e.indexOf("#")?(new i.Model.ChartModel).getRGBA(e):e},g.prototype.updateTypeForYAxis=function(e,t,r){return"logarithmic"===r?(e.yAxis[t].type="logarithmic",e.yAxis[t].min=1,e.yAxis[t].tickInterval=1):e.yAxis[t].type="linear",e},g.prototype.applyYAxisLevelStyles=function(e,t,r,i,o){return-1==r?("labelStyle"===i&&(e.yAxis[t].labels.style=o),"titleStyle"===i&&(e.yAxis[t].title.style=o),"labels"===i&&(e.yAxis[t].labels.enabled=o),"type"===i&&(e=this.updateTypeForYAxis(e,t,o)),"labelStyle"!==i&&"titleStyle"!==i&&"labels"!==i&&(e.yAxis[t][i]=o)):"plotLines"===i?o.plValue&&(e.yAxis[t].plotLines[r].value=o.plValue):("labelStyle"===i&&(e.yAxis[t].plotLines[r].labels.style=o),"titleStyle"===i&&(e.yAxis[t].plotLines[r].title.style=o),"labelStyle"!==i&&"titleStyle"!==i&&(e.yAxis[t].plotLines[r][i]=o)),e},g.prototype.applyGridLineColorForAllAxisObjects=function(e,t,r){if(!e.yAxis)return e;for(var o=(new i.Model.ChartModel).getRGBA(t,"0.5"),n=0;n<e.yAxis.length;n++)e.yAxis[n].gridLineColor=t,r&&(e.yAxis[n].gridLineWidth=r),e.yAxis[n].minorGridLineColor=o;return e},g.prototype.applyXAxisLevelStyles=function(e,t,r,i){return"labelStyle"===r&&(e.xAxis.labels.style=i),"titleStyle"===r&&(e.xAxis.title.style=i),"labels"===r&&(e.xAxis.labels.enabled=i,!i&&(e.xAxis.tickWidth=0),!i&&(e.xAxis.lineWidth=1),i&&(e.xAxis.lineWidth=1),i&&(e.xAxis.tickWidth=0)),"labelStyle"!==r&&"titleStyle"!==r&&"labels"!==r&&(e.xAxis[r]=i),e},g.prototype.applyChartDefaultStyle=function(e,t){for(var r=Object.keys(t),i=0;i<r.length;i++)e.chart[r[i]]=t[r[i]];return e},g.prototype.updateChartTitle=function(e){var r=e,o=i.Manager.SidePanelManager,n=t.view.getActiveGridID(),s=t.view.getVersionID(n),a=t.view.getResourceID(n),l=t.data.getWorkBook(a,s),p=t.view.getSheetID(n),c=l.getSheetObj(p).Charts,g=o.getActiveChartID(),y=new i.Controller.ZSCController,h=[],u={};Object.keys(g).forEach(function(e){var t=g[e],i=c.get(t);i.getOptions();u.title=r,i&&h.push(i)}),y.updateChartTitle(a,p,s,h[0],u)},g.prototype.updateYAxisTitle=function(e,r){var o=e,n=i.Manager.SidePanelManager,s=t.view.getActiveGridID(),a=t.view.getVersionID(s),l=t.view.getResourceID(s),p=t.data.getWorkBook(l,a),c=t.view.getSheetID(s),g=p.getSheetObj(c).Charts,y=[n.getActiveChartID()],h=new i.Controller.ZSCController,u=[],d={};Object.keys(y).forEach(function(e){var t=y[e],i=g.get(t);i.getOptions();d.title=o,d.index=r,i&&u.push(i)}),h.updateYAxisTitle(l,c,a,u[0],d)},g.prototype.updateChartSubTitle=function(e){var r=e,o=i.Manager.SidePanelManager,n=t.view.getActiveGridID(),s=t.view.getVersionID(n),a=t.view.getResourceID(n),l=t.data.getWorkBook(a,s),p=t.view.getSheetID(n),c=l.getSheetObj(p).Charts,g=[o.getActiveChartID()],y=new i.Controller.ZSCController,h=[],u={};Object.keys(g).forEach(function(e){var t=g[e],i=c.get(t);i.getOptions();u.title=r,i&&h.push(i)}),y.updateChartSubTitle(a,p,s,h[0],u)},g.prototype.updateXAxisTitle=function(e){var r=e,o=i.Manager.SidePanelManager,n=t.view.getActiveGridID(),s=t.view.getVersionID(n),a=t.view.getResourceID(n),l=t.data.getWorkBook(a,s),p=t.view.getSheetID(n),c=l.getSheetObj(p).Charts,g=[o.getActiveChartID()],y=new i.Controller.ZSCController,h=[],u={};Object.keys(g).forEach(function(e){var t=g[e],i=c.get(t);i.getOptions();u.title=r,i&&h.push(i)}),y.updateXAxisTitle(a,p,s,h[0],u)},g.prototype.getChartMapFromSheet=function(){var e=[],r=t.view.getActiveGridID(),i=t.view.getVersionID(r),o=t.view.getResourceID(r),n=t.data.getWorkBook(o,i),s=t.view.getSheetID(r),a=n.getSheetObj(s).Charts;return e.push(o),e.push(s),e.push(i),e.push(a),e},g.prototype.getSPActiveChartID=function(){return i.Manager.SidePanelManager.getActiveChartID()},g.prototype.fetchTitleLabelBasedOnSubAction=function(e){return e==c.CHART_TITLE_STYLE?"CHART_TITLE":e==c.CHART_SUB_TITLE_STYLE?"CHART_SUB_TITLE":e==c.CHART_X_AXIS_TITLE_STYLE?"XAXIS_TITLE":e==c.CHART_Y_AXIS_TITLE_STYLE?"YAXIS_TITLE":void 0},g.prototype.getRequestObject=function(e,t,r){var i={};return i.parameters={currentSheet:e.getActiveSheet(),id:"preview"==t||e.isCloned()?"":e.getChartID(),chartType:e.getType(),dataRange:e.getRange(),seriesIn:e.getSeriesIn(),frl:e.getFirstRowAsLabel(),fcl:e.getFirstColAsLabel(),lpos:e.getLPos(),sr:e.getStartRowIndex(),sc:e.getStartColIndex(),srd:e.getStartRowDiff(),scd:e.getStartColDiff(),left:e.getLeft("edit"===t),top:e.getTop("edit"===t),wd:e.getWidth(),ht:e.getHeight(),title:e.getTitle(!0),titleAlign:e.getTitleAlignment(),subTitleAlign:e.getSubTitleAlignment(),subTitle:e.getSubTitle(!0),xTitle:e.getXTitle(!0),tooltip:e.getToolTip(),inverted:e.getInverted(),spline:e.getSpline(),zoom:e.getZoomType(),animation:e.getAnimation(),trendline:e.getTrendline(),isFloating:e.getFloating(),majorGridLineWidth:e.getMajorGridWidth(),minorTickInterval:e.getMinorTickInterval(),xLabel:e.getXLabel(),yLabel:e.getYLabel(),isSingleYAxis:e.getYAxisState(),isIncludeHiddenCells:e.getHiddenCellState(),slant:e.getXSlant(),labelFormat:e.getLabelFormat(),appedingWay:e.getCombinedWay(),isMarker:e.getMarkerState(),trendlineType:e.getTrendlineTypes(),threshold:e.getThreshold(),degree:e.getDegreeOrElse(),autoExpand:e.getAutoExpandState(),actionList:JSON.stringify(e.getCustomStyle()),isPivotChart:e.getPivotState(),isCloned:e.isCloned(),comboChartTypes:JSON.stringify(e.getComboTypes()),yAxis:JSON.stringify(e.getYAxis(!0)),lineStyles:JSON.stringify(e.getLineStyles()),pivotId:e.getPivotId(),sline:e.getStaggerState(),aggregation:JSON.stringify(e.getAggregation()),rc:JSON.stringify(e.getRaceChartOptions()),filter:JSON.stringify(e.getFilter()),reversed:r?e.getType().toLowerCase()==o.BAR:e.getXReverse(),isFromZia:r,binning:JSON.stringify(e.getBinning())},i.url={preview:"previewaction",new:"chartaction",edit:"chartaction"}[t],i.action={preview:"CHART_PREVIEW",new:"CHART_NEW",edit:"CHART_EDIT"}[t],i},i.Utility.removeCursorPointer=function(e){for(var t=0;t<e.length;t++)delete e[t].title.style.cursor,e[t].labels.style&&delete e[t].labels.style.cursor;return e},!i.Utility&&(i.Utility={}),i.Utility.ChartAgent=g}(this);
!function(e){var t=e.ZSEvents,n=t.Groups,i=t.Names,a=t.topic,r=(e.ZSConstants.wCC,e.sPlusPlus),o=e.ZSChart,l=e.ZSConstants.I18N,s=(o.Controller,o.Constants),c=(e.ZSConstants.FeatureConstants,s.CAConstant,e.UIUtil.Component),T=(ZSDevTools.Logger,o.Constants.MessageConstant,o.Constants.ChartType),d=null,I=null,E={LIGHT:"#FFFFFF",DARK:"#000000"},S={CHART_LEGEND:".highcharts-legend",CHART_TITLE:".highcharts-title",CHART_SUBTITLE:".highcharts-subtitle",CHART_BACKGROUND:".highcharts-background",CHART_PLOT:".highcharts-plot-background",CHART_XAXIS_LABELS:".highcharts-xaxis-labels",CHART_YAXIS_LABELS:".highcharts-yaxis-labels",CHART_YAXIS_TITLE:".highcharts-yaxis",CHART_XAXIS_TITLE:".highcharts-xaxis",CHART_NAVIGATOR:".highcharts-navigator",CHART_SCROLLBAR:".highcharts-scrollbar-button",CHART_SCROLLBAR_THUMB:".highcharts-scrollbar-thumb",CHART_TIME_RANGE_INPUT:".highcharts-range-input"},C={zID:"#chartTitleCombo",cRelative:{1:"CHART_TITLE",2:"CHART_SUBTITLE",3:"CHART_X_AXIES",4:"LA",5:"RA"}};const A={SERIES_COLOR:"SERIES_COLOR",CHART_BACKGROUND:"CHART_BACKGROUND",CHART_SERIES:"SERIES",CHART_TITLE:"CHART_TITLE",CHART_SUBTITLE:"CHART_SUBTITLE",CHART_XAXIS_LABELS:"CHART_XAXIS_LABELS",CHART_YAXIS_LABELS:"CHART_YAXIS_LABELS",CHART_YAXIS_TITLE:"CHART_YAXIS_TITLE",CHART_XAXIS_TITLE:"CHART_XAXIS_TITLE",CHART_LEGEND:"CHART_LEGEND",CHART_NAVIGATOR:"CHART_NAVIGATOR",CHART_SCROLLBAR:"CHART_SCROLLBAR",CHART_SCROLLBAR_THUMB:"CHART_SCROLLBAR_THUMB",CHART_TIME_RANGE_INPUT:"CHART_TIME_RANGE_INPUT"},g={STYLES:"STYLES",TITLES:"TITLES",VAXIS:"VAXIS",HAXIS:"HAXIS",SERIES:"SERIES",LEGEND:"LEGEND"},p={CHART:"chartArea",PLOT:"plotArea",SERIES:"series",STYLES:"chartArea",TITLES:"titlesWrapper",VAXIS:"verticalAxies",HAXIS:"titlesWrapper",LEGEND:"titlesWrapper"};function u(){this.ID=null,this.config={},this.evName=null,this.reason={clean:-1}}function h(e,t){t.isSeries;var r=e.getInstance()[0].options,l=O(e.getOptions(),t.sIndex,t.pIndex,e.getInstance()[0],t.isSeries),s=o.Utility.getColorCodeFromGradient(r.chart.plotBackgroundColor?r.chart.plotBackgroundColor:r.chart.backgroundColor),c=!!l&&new o.Utility.SheetChartColor(l).isLuminance(),T=!!s&&new o.Utility.SheetChartColor(s).isLuminance();return a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.INIT_PROPERTY,{CONFIG:{META:e,NAME:A.SERIES_COLOR,COLOR:l}}),c||T?E.LIGHT:E.DARK}function R(e){return(new o.Utility.CommanAgent).isFallUnderCompositionType(e)||-1!=e.indexOf(T.WATERFALL.toUpperCase())}function v(e,t,n){return-1!==t.indexOf(T.COMBOCHART)&&-1!==e.series[n].type.indexOf(T.PIE)?T.PIE:t}function b(t){var n=o.Wrapper.DOMUtils.getElementById("DI_CHART_CONTEXT");return n||t?n:function(){var t=o.Wrapper.DOMUtils,n=t.getElementById("DI_CHART_CONTEXT");if(n)return n;var i=e.UserAction.getTemplate(["CHART_TRANSPARANCY_POPOVER"]),a=e.UserAction.getTemplate(["CHART_SERIES_TRANSPARANCY_POPOVER"]),r=document.getElementById("popupmenu"),l=!!document.getElementById("cTchrtPopOver"),s=!!document.getElementById("sTchrtPopOver");!l&&t.appendChild(r,i.CHART_TRANSPARANCY_POPOVER),!s&&t.appendChild(r,a.CHART_SERIES_TRANSPARANCY_POPOVER);var T=e.UserAction.getTemplate(["CHART_CONTEXTUAL_TEMPLATE"]);return t.appendChild(document.body,T.CHART_CONTEXTUAL_TEMPLATE),n=t.getElementById("DI_CHART_CONTEXT"),c.initComponent("#DI_CHART_CONTEXT"),(d=n.querySelector("#seriesTransparencyWrappper")).setAttribute("data-is-content-html-encoded",!0),d.setAttribute("data-position","bottom"),(I=n.querySelector("#chartTransparencyWrappper")).setAttribute("data-is-content-html-encoded",!0),I.setAttribute("data-position","bottom"),c.initComponent("#cTchrtPopOver"),c.initComponent("#sTchrtPopOver"),c.zpopover(I),c.zpopover(d),n}()}function O(e,t,n,i,a,r){return a?s()||l():l()||s();function l(){try{var a=e.series.length,r=e.series[t%a].data[n].color||i.series[t].data[n].color;return o.Utility.getColorCodeFromGradient(r)}catch(e){return null}}function s(){try{var n=e.series.length,a=null;r||e.series[t];return r&&(a=e.series[t-e.series.length].regressionSettings.color||i.series[t].color),a=e.series[t%n].color||i.series[t].color,o.Utility.getColorCodeFromGradient(a)}catch(e){return null}}}function P(e,t){var n=new o.Utility.CommanAgent;if(n.isFallUnderCompositionType(e.getType()))return!1;if(-1!=e.getType().indexOf(T.COMBOCHART)){var i=t.sIndex,a=e.getOptions().series,r=a?a[i]:null;if(r&&n.isFallUnderCompositionType(r.type))return!1}return!0}u.prototype={init:function(){this.ID=null,this.config={},this.evName=null,this.reason={clean:-1}},setProperty:function(e){this.ID=e.ID,this.config=e.CONFIG,this.evName=e.NAME},getID:function(){if(!this.ID){new o.Utility.ChartAgent;this.ID=o.Utility.getActiveChart().pop()}return this.ID},getActiveMeta:function(){return(new o.Utility.ChartAgent).getChartMeta(this.getID())},getConfigMeta:function(){return this.config||{}},getEventName:function(){return this.evName},setCleanerReason:function(e){this.reason.clean=e||-1},isMoved:function(){return-1!==this.reason.clean}},o.Utility.getTitleRelative=function(e){return C.cRelative[e]},o.Utility.isContextMenuAlive=function(){var e=o.Manager.SidePanelManager;return e&&e.isPanelOpen()},o.Client.Action.getClassMapping=function(e,t){if(!t)return S[e]},o.Client.Action.initCutomEventProperty=function(e){var t=e.META,n=e.NAME,i=e.props;switch(n){case A.CHART_SERIES:r(a=t.getID(),"sIndex",i.sIndex),r(a,"pIndex",i.pIndex),r(a,"isSeries",i.isSeries),r(a,i.sIndex,{ds:function(e,t){var n=e.getOptions(),i=t.sIndex,a=n.series.length,r=i>=a;return function(e,t,n){if(e){for(var i=e.length,a=n?"dot":"solid",r=0;r<i;r++)if(e[r].seriesIndex==t){a=e[r].lineStyleType;break}return a}}(n.lineStyles,i,r)}(t,i)});break;case A.CHART_TITLE:case A.CHART_SUBTITLE:case A.CHART_BACKGROUND:case A.CHART_XAXIS_LABELS:case A.CHART_YAXIS_LABELS:case A.CHART_YAXIS_TITLE:case A.CHART_XAXIS_TITLE:case A.CHART_LEGEND:r("svg","ID",e.ID),r("svg","ACTION",n),r("svg","INDEX",e.index);break;case A.SERIES_COLOR:var a;r(a=t.getID(),"color",e.COLOR)}function r(e,t,n){E[e]||(E[e]={}),E[e][t]=n}},o.Client.Action.removeCutomEventProperty=function(){E={LIGHT:"#FFFFFF",DARK:"#000000"}},o.Client.Action.destroyContextualToolbar=function(e,t){try{var n=o.Wrapper.DOMUtils.getElementById("DI_CHART_CONTEXT");c.zpopover(d,"destroy"),c.zpopover(I,"destroy");var i=new Event("mousedown");!t&&document.dispatchEvent(i),n&&n.remove(),o.Manager.ZSChartCutomEventManager.setCleanerReason(e)}catch(e){}},o.Client.Action.resetChartSelection=function(e){var t=e.ID;if(t){var n=(new o.Utility.ChartAgent).getChartMeta(t);n&&n.resetSelection()}},o.Client.Action.removeBorderAnimation=function(e){var t=e.ID;if(t){var r=e.Props||E[t];if(r){var l=(new o.Utility.ChartAgent).getChartMeta(t);P(l,r)&&function(e,t){var n=e.getInstance();e.getOptions();for(var i in n){for(var a=n[i],r=a.container,l=r.querySelector(".highcharts-series-"+t.sIndex),s=l.children,c=s?s.length:0,i=0;i<c;i++){var T=s[i];T.classList.remove("animateLinePath")}var d=t[t.sIndex];t.isSeries?(d&&a.updateSeriesByCustomProperty(t.sIndex,{dashStyle:d.ds}),t.color&&a.updateSeriesByCustomProperty(t.sIndex,{borderWidth:1,borderColor:new o.Utility.SheetChartColor(o.Utility.getColorCodeFromGradient(t.color)).darken(.7).getColor()})):t.color&&a.updatePointByCustomProperty(t.sIndex,t.pIndex,{borderWidth:1,borderColor:new o.Utility.SheetChartColor(o.Utility.getColorCodeFromGradient(t.color)).darken(.7).getColor()})}}(l,r),o.Client.Action.removeCutomEventProperty(),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:t})}}},o.Client.Action.applyContextualToolbar=function(e){var t,s,T,d=e.META,I=e.NAME,E=e.EREF,S=e.props;switch(S&&(S.isSeries=d.getSelectionState(S.sIndex)),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.INIT_PROPERTY,{CONFIG:e}),a.publish(n.UI,i.SidePanel.CHARTS.SETFOCUS),I){case g.STYLES:case g.TITLES:case g.VAXIS:case g.HAXIS:case g.SERIES:case g.LEGEND:T=function(){var e,t;switch(I){case g.SERIES:t=parseInt(E.pageX)-60,e=parseInt(E.pageY)-54;break;case g.STYLES:t=parseInt(E.pageX)-127,e=parseInt(E.pageY)-58;break;case g.TITLES:t=parseInt(E.pageX)-107,e=parseInt(E.pageY)-90;break;case g.VAXIS:t=parseInt(E.pageX)-107,e=parseInt(E.pageY)-88;break;case g.HAXIS:case g.LEGEND:t=parseInt(E.pageX)-107,e=parseInt(E.pageY)-53}return{TOPX:e,LEFTX:t}}(),function(e,t){var n=o.Wrapper.DOMUtils;e.style.left=t.LEFTX+"px",e.style.top=t.TOPX+"px",n.show(e)}((t=b(),s=o.Wrapper.DOMUtils,function(){switch(I){case g.SERIES:c.unbind("#ctxSeriesfillColor","zcolorchooserchange"),c.bind("#ctxSeriesfillColor","zcolorchooserchange",function(e,t){var r=d.getType(),l=S.sIndex,T=S.pIndex,I=t.color,E=d.getSelectionState(l)||!1,C=d.getID(),A=d.getCType(),g=c.zslider("#seriesTransparency","getValue");g=parseFloat(parseFloat((100-g)/100).toFixed(2));var p=(new o.Model.ChartModel).getRGBA(I,g),u=d.getOptions().series,h=!u[S.sIndex]&&u[S.sIndex-u.length].regressionSettings,b=O(d.getOptions(),l,T,d.getInstance()[0],E,h);b=(new o.Model.ChartModel).getRGBA(b,g);var P=s.getElementById("ctxSeriesfillColor");s.addStyle(P.previousElementSibling,{"border-bottom-color":p});var U=new o.Utility.ChartAgent,y=U.isUniqueValue(b.replace(/ /g,""),p.replace(/ /g,""));y&&a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES,{PROPERTIES:{isSeries:E||R(v(d.getOptions(),d.getType(),l)),color:p,sIndex:R(v(d.getOptions(),d.getType(),l))?T:l,pIndex:T,cType:A,cID:C,mCType:r}})}),c.unbind("#seriesTransparency","zsliderchange"),c.bind("#seriesTransparency","zsliderchange",function(e,t){var r=t.value,l=parseFloat(parseFloat((100-r)/100).toFixed(2)),s=S.sIndex,c=S.pIndex,T=d.getSelectionState(s),I=d.getCType(),E=d.getType(),C=d.getOptions().series,A=!C[S.sIndex]&&C[S.sIndex-C.length].regressionSettings,g=O(d.getOptions(),s,c,d.getInstance()[0],T,A),p=new o.Model.ChartModel,u=p.getTransparency(g);g=p.getRGBA(g,l),u!=r&&a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES,{PROPERTIES:{isSeries:T||R(v(d.getOptions(),d.getType(),s)),color:g,sIndex:R(v(d.getOptions(),d.getType(),s))?c:s,pIndex:c,cType:I,cID:d.getID(),mCType:E}})});break;case g.STYLES:c.unbind("#chartQukfontfamilys","zselectboxchange"),c.bind("#chartQukfontfamilys","zselectboxchange",function(e,t){var r=t.value,o=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.CANVAS.FONT_FAMILY,{PROPERTIES:{fontFamily:r,cID:o}})}),c.unbind("#chartTransparencySlder","zsliderchange"),c.bind("#chartTransparencySlder","zsliderchange",function(e,t){var n=t.value,i=parseFloat(parseFloat((100-n)/100).toFixed(2)),a=(d.getID(),new o.Model.ChartModel),r=o.Utility.getColorCodeFromGradient(d.getOptions().chart.backgroundColor||a.getRGBA("#FFFFFF",1)),l=a.getRGBA(r,i),s=new o.Utility.ChartAgent,T=s.isUniqueValue(l.replace(/ /g,""),r.replace(/ /g,""));T&&c.zslider("#caTransparency","setValue",n)}),c.unbind("#ctxChartfillColor","zcolorchooserchange"),c.bind("#ctxChartfillColor","zcolorchooserchange",function(e,t){var r=t.color,l=o.Utility.getColorCodeFromGradient(d.getOptions().chart.backgroundColor||"#FFFFFF"),T=c.zslider("#chartTransparencySlder","getValue");T=parseFloat(parseFloat((100-T)/100).toFixed(2));var I=new o.Utility.ChartAgent,l=(new o.Model.ChartModel).getRGBA(l,T),E=(new o.Model.ChartModel).getRGBA(r,T),S=I.isUniqueValue(E.replace(/ /g,""),l.replace(/ /g,"")),C=d.getID(),A=s.getElementById("ctxChartfillColor");s.addStyle(A.previousElementSibling,{"border-bottom-color":E}),S&&a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.CANVAS.FILL,{PROPERTIES:{color:E,cID:C}})});break;case g.TITLES:c.unbind("#titleQckFontSize","zselectboxchange"),c.bind("#titleQckFontSize","zselectboxchange",function(e,t){if(t.fromUI){var r=t.value,o=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_SIZE,{PROPERTIES:{fontSize:r,cID:o,props:S}})}},!0),c.unbind("#titleQckFntColor","zcolorchooserchange"),c.bind("#titleQckFntColor","zcolorchooserchange",function(e,t){var r=t.color,o=d.getID(),l=s.getElementById("titleQckFntColor");s.addStyle(l.previousElementSibling,{"border-bottom-color":r}),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_COLOR,{PROPERTIES:{color:r,cID:o,props:S}})},!0),s.addEvent("titleQckBld",s.Events.CLICK,function(){var e=s.getActiveStatus(this),t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_WEIGHT,{PROPERTIES:{bold:e,cID:t,props:S}}),s.addAttributes(this,{"data-active":!e})},!0),s.addEvent("titleQckItalic",s.Events.CLICK,function(){var e=s.getActiveStatus(this),t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_STYLE,{PROPERTIES:{italic:e,cID:t,props:S}}),s.addAttributes(this,{"data-active":!e})},!0),function(){switch(S.subAction){case 1:s.getElementById("TITLE_ALIGNMENT_QCK_POPUP")&&s.getElementById("TITLE_ALIGNMENT_QCK_POPUP").remove(),t=s.getElementById("titleQckAlign"),I=[{id:(T=["TITLE_LEFT_ALIGN","TITLE_CENTER_ALIGN","TITLE_RIGHT_ALIGN"])[0],data:'{"SVGIconId":"#alignmentIco svgWidHgt","label":"'+l["MenuItem.HomeTab.Align.Left"]+'", "direction":"left", "align":"halign", "itemType":"radio"}'},{id:T[1],data:'{"SVGIconId":"#centerAlignIco svgWidHgt","label":"'+l["MenuItem.HomeTab.Align.Center"]+'", "direction":"center", "align":"halign", "itemType":"radio"}'},{id:T[2],data:'{"SVGIconId":"#rightAlignIco svgWidHgt","label":"'+l["MenuItem.HomeTab.Align.Right"]+'", "direction":"right", "align":"halign", "itemType":"radio"}'}],r.view.Menu.create(I,{id:"TITLE_ALIGNMENT_QCK_POPUP","data-type":"list","data-content-type":"icon-text"},t),t.setAttribute("data-ctype","zsbutton"),t.setAttribute("data-menu-id","TITLE_ALIGNMENT_QCK_POPUP"),s.getElementById("titlesWrapper").style.width="245px";var e=o.Manager.SidePanelManager;e.getDialogUtil(),c.unbind("#TITLE_ALIGNMENT_QCK_POPUP","zmenuitemclick"),c.bind("#TITLE_ALIGNMENT_QCK_POPUP","zmenuitemclick",function(e,t){var r=t.data.direction,o=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.ALIGNMENT,{PROPERTIES:{alignment:r,cID:o,props:S}})}),c.unbind("#TITLE_ALIGNMENT_QCK_POPUP","zmenubeforeshow"),c.bind("#TITLE_ALIGNMENT_QCK_POPUP","zmenubeforeshow",function(e,t){var n=new o.Utility.ChartAgent,i=n.getSPActiveChartID(),a=n.getChartMapFromSheet();if(o.Manager.SidePanelManager,!(a.length<4)){var r=a[3],l=r.get(i),c="center";l.chartOptions.title&&(c=l.chartOptions.title.align?l.chartOptions.title.align:c);var T="TITLE_CENTER_ALIGN";switch(c){case"left":T="TITLE_LEFT_ALIGN";break;case"center":T="TITLE_CENTER_ALIGN";break;case"right":T="TITLE_RIGHT_ALIGN"}s.getElementById("TITLE_LEFT_ALIGN").classList.remove("is-selected"),s.getElementById("TITLE_CENTER_ALIGN").classList.remove("is-selected"),s.getElementById("TITLE_RIGHT_ALIGN").classList.remove("is-selected"),s.getElementById(T).classList.add("is-selected")}});break;default:s.hideById("titleQckAlign"),s.getElementById("titlesWrapper").style.width="183px"}var t,T,I}(),s.addEvent("titleInputBx",s.Events.CHANGE,function(e){var t=this.value,r=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.TEXT,{PROPERTIES:{txt:t,cID:r,props:S}}),e.stopPropagation()},!0),s.addEvent("titleInputBx",s.Events.KEYDOWN,function(e){e.stopPropagation()},!0),s.addEvent("titleInputBx",s.Events.BLUR,function(){var e=this.value,t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.TEXT,{PROPERTIES:{txt:e,cID:t,props:S}})},!0);break;case g.HAXIS:c.unbind("#titleQckFontSize","zselectboxchange"),c.bind("#titleQckFontSize","zselectboxchange",function(e,t){if(t.fromUI){var r=t.value,o=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_SIZE,{PROPERTIES:{fontSize:r,cID:o,props:S}})}}),c.unbind("#titleQckFntColor","zcolorchooserchange"),c.bind("#titleQckFntColor","zcolorchooserchange",function(e,t){var r=t.color,l=d.getID(),c=new o.Utility.ChartAgent,T=d.getXAxis(),I=T.labels||{},E=I.style||{},C=E.color||(new o.Model.ChartModel).getRGBA("#4d4d4d",1),A=c.isUniqueValue(C.replace(/ /g,""),r.replace(/ /g,"")),g=s.getElementById("titleQckFntColor");s.addStyle(g.previousElementSibling,{"border-bottom-color":r}),A&&a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_COLOR,{PROPERTIES:{color:r,cID:l,props:S}})}),s.addEvent("titleQckBld",s.Events.CLICK,function(){var e=s.getActiveStatus(this),t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_WEIGHT,{PROPERTIES:{bold:e,cID:t,props:S}}),s.addAttributes(this,{"data-active":!e})},!0),s.addEvent("titleQckItalic",s.Events.CLICK,function(){var e=s.getActiveStatus(this),t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_STYLE,{PROPERTIES:{italic:e,cID:t,props:S}}),s.addAttributes(this,{"data-active":!e})},!0);break;case g.VAXIS:c.unbind("#vAxiesQckFontSize","zselectboxchange"),c.bind("#vAxiesQckFontSize","zselectboxchange",function(e,t){if(t.fromUI){var r=t.value,o=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_SIZE,{PROPERTIES:{fontSize:r,cID:o,props:S}})}}),c.unbind("#vAxiesQckFontColor","zcolorchooserchange"),c.bind("#vAxiesQckFontColor","zcolorchooserchange",function(e,t){var r=t.color,o=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_COLOR,{PROPERTIES:{color:r,cID:o,props:S}})}),s.addEvent("vXaiesBld",s.Events.CLICK,function(){var e=s.getActiveStatus(this),t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_WEIGHT,{PROPERTIES:{bold:e,cID:t,props:S}}),s.addAttributes(this,{"data-active":!e})},!0),s.addEvent("vXaiesItalic",s.Events.CLICK,function(){var e=s.getActiveStatus(this),t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_STYLE,{PROPERTIES:{italic:e,cID:t,props:S}}),s.addAttributes(this,{"data-active":!e})},!0),s.addEvent("cMinQck",s.Events.CHANGE,function(){var e=this.value,t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.MIN,{PROPERTIES:{min:e,cID:t,props:S}})},!0),s.addEvent("cMinQck",s.Events.KEYDOWN,function(e){e.stopPropagation()},!0),s.addEvent("cMaxQck",s.Events.CHANGE,function(){var e=this.value,t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.MAX,{PROPERTIES:{max:e,cID:t,props:S}})},!0),s.addEvent("cMaxQck",s.Events.KEYDOWN,function(e){e.stopPropagation()},!0),s.addEvent("cIntervalQck",s.Events.CHANGE,function(){var e=this.value,t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.INTERVAL,{PROPERTIES:{interval:e,cID:t,props:S}})},!0),s.addEvent("cIntervalQck",s.Events.KEYDOWN,function(e){e.stopPropagation()},!0);break;case g.LEGEND:c.unbind("#titleQckFontSize","zselectboxchange"),c.bind("#titleQckFontSize","zselectboxchange",function(e,t){if(t.fromUI){var r=t.value,o=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_SIZE,{PROPERTIES:{fontSize:r,cID:o}})}}),c.unbind("#titleQckFntColor","zcolorchooserchange"),c.bind("#titleQckFntColor","zcolorchooserchange",function(e,t){var r=t.color,l=d.getID(),c=new o.Utility.ChartAgent,T=d.getLegend(),I=T.itemStyle||{},E=I.color||(new o.Model.ChartModel).getRGBA("#4d4d4d",1),S=c.isUniqueValue(E.replace(/ /g,""),r.replace(/ /g,"")),C=s.getElementById("titleQckFntColor");s.addStyle(C.previousElementSibling,{"border-bottom-color":r}),S&&a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_COLOR,{PROPERTIES:{color:r,cID:l}})}),s.addEvent("titleQckBld",s.Events.CLICK,function(){var e=s.getActiveStatus(this),t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_WEIGHT,{PROPERTIES:{bold:e,cID:t}}),s.addAttributes(this,{"data-active":!e})},!0),s.addEvent("titleQckItalic",s.Events.CLICK,function(){var e=s.getActiveStatus(this),t=d.getID();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_STYLE,{PROPERTIES:{italic:e,cID:t}}),s.addAttributes(this,{"data-active":!e})},!0)}}(),Object.keys(p).forEach(function(e){s.hide(t.querySelector("#"+p[e]))}),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENT.INIT_TOOLBAR,{EVENT:I}),s.show(t.querySelector("#"+p[I])),t),T)}},o.Client.Action.applyCustomEvents=function(e,t,r,l){var s=o.Manager.ZSChartCutomEventManager,d=s.isMoved();if(o.Client.Action.destroyContextualToolbar(),e.getType()!=T.WORDCLOUD)if(e.getPivotState()&&a.publish(n.Listener,i.SheetAction.PIVOT.FILTER_CLOSE),d)s.setCleanerReason();else{var I=o.Manager.SidePanelManager;if(I&&I.isPanelOpen())switch(o.Client.Action.removeBorderAnimation({ID:e.getID()}),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:e.getID()}),!I.isRangeEditing()&&a.publish(n.UI,i.SidePanel.CHARTS.ACCORDION.OPEN,{NAME:t.toUpperCase()}),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENT.SET_PROPERTY,{PROPERTIES:{ID:e.getID(),NAME:t,CONFIG:r}}),t){case g.SERIES:!function(e,r){e.getSelectionState(r.sIndex);var s=o.Utility.isCompositionChart(o.Utility.getChartMetaByIndex(e.getOptions(),e.getType(),r.sIndex));a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:l,META:e,props:r}}),c.zcombo("#chartSeries","setValue",""+(s?r.pIndex:r.sIndex)),a.publish(n.UI,i.SidePanel.CHARTS.ACCORDION.SERIES.UPDATE)}(e,r);break;case g.STYLES:!function(e){e.resetSelection(),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:l,META:e}})}(e);break;case g.TITLES:!function(e,r){e.resetSelection();var s=o.Manager.SidePanelManager;c.zcombo(C.zID,"setValue",C.cRelative[r.subAction]+r.suffix),s.getDialogUtil().updateTitleForSp(e.getID(),C.cRelative[r.subAction]+r.suffix),s.getDialogUtil().updateTitleIndex(e.getID(),C.cRelative[r.subAction]+r.suffix),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:l,META:e,props:r}})}(e,r);break;case g.HAXIS:!function(e,r){e.resetSelection(),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:l,META:e,props:r}})}(e,r);break;case g.VAXIS:!function(e,r){e.resetSelection();var s=o.Manager.SidePanelManager,T=0==r.index?"LA":"RA"+r.index;c.zcombo("#yaxisMulti","setValue",T),s.getDialogUtil().updateMultiYAxiesDom(e.getID(),{value:0==r.index?"LA":"RA"+r.index}),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:l,META:e,props:r}})}(e,r);break;case g.LEGEND:!function(e){a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENTS,{PROPERTIES:{NAME:t.toUpperCase(),EREF:l,META:e,props:r}})}(e)}}},o.Client.Action.removeHoverRect=function(e){try{o.Wrapper.DOMUtils;for(var t=(new o.Utility.ChartAgent).getChartMeta(e).getInstance(),n=t?t.length:0,i=0;i<n;i++)for(var a=t[i].container.querySelectorAll("#rectHover"),r=a?a.length:0,l=0;l<r;l++){var s=a[l];s&&s.remove()}}catch(e){}},o.Client.Action.removeRect=function(e){try{o.Wrapper.DOMUtils;var t=(new o.Utility.ChartAgent).getChartMeta(e);if(!t)return;for(var n=t.getInstance(),i=n?n.length:0,a=0;a<i;a++)for(var r=n[a].container.querySelectorAll("#rectAttach"),l=r?r.length:0,s=0;s<l;s++){var c=r[s];c&&c.remove()}}catch(e){}},o.Client.Action.reApplyCustomHoverSvg=function(){var e=E.svg;if(e)if(b(!0)){var t=e.ID,r=e.ACTION,l=e.INDEX;a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:t}),a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:r,INDEX:l})}else{var s=o.Manager.ZSChartCutomEventManager;a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:s.getID()})}},o.Client.Action.applyCustomHoverSvg=function(e,t,l,s){var c=o.Manager.SidePanelManager;if(c&&c.isPanelOpen()){var T=s?"rectHover":"rectAttach";s||a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.INIT_PROPERTY,{CONFIG:{NAME:t,ID:e,index:l}});var d=o.Wrapper.DOMUtils,I=(new o.Utility.ChartAgent).getChartMeta(e);switch(t){case A.CHART_TITLE:case A.CHART_SUBTITLE:case A.CHART_BACKGROUND:case A.CHART_XAXIS_LABELS:case A.CHART_YAXIS_LABELS:case A.CHART_YAXIS_TITLE:case A.CHART_XAXIS_TITLE:case A.CHART_LEGEND:!function(){var e=function(){var e,n,i="http://www.w3.org/2000/svg",a=r.data.AppRegistry.IMAGEPath;if(-1!==t.indexOf("CHART_BACKGROUND"))n=d.createElementNS(i,"rect",{fill:"none","fill-opacity":.3,stroke:"#a5d5c2","stroke-width":1});else{e=d.createElementNS(i,"svg");var o=d.createElementNS(i,"defs"),l=d.createElementNS(i,"pattern"),c=d.createElementNS(i,"image");n=d.createElementNS(i,"rect",{stroke:"#a5d5c2","stroke-width":s?0:1}),c.setAttributeNS("http://www.w3.org/1999/xlink","href",a+"Pattern2.png"),c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("width","5"),c.setAttribute("height","5"),l.setAttribute("x","0"),l.setAttribute("y","0"),l.setAttribute("width","5"),l.setAttribute("height","5"),l.setAttribute("id","pattern"),l.setAttribute("patternUnits","userSpaceOnUse"),d.appendChild(l,c),d.appendChild(o,l),d.appendChild(e,o)}return{SVG:e,RECT:n}}(),n=e.RECT,i=e.SVG;n.setAttributeNS(null,"id",T);var a=function(){var e,n,i=I.getInstance()[0],a=i.container;switch(t){case A.CHART_TITLE:n=a.querySelector(S[t]),i.title&&(e=i.title.getBBox(!0));break;case A.CHART_SUBTITLE:n=a.querySelector(S[t]),i.subtitle&&(e=i.subtitle.getBBox(!0));break;case A.CHART_XAXIS_LABELS:n=a.querySelector(S[t]),e=n.getBBox(!0);break;case A.CHART_YAXIS_LABELS:n=a.querySelectorAll(S[t]),e=n[l].getBBox(!0);break;case A.CHART_YAXIS_TITLE:var r=(n=(n=a.querySelectorAll("div"+S[t]))[l]).children,o=r[0].getBoundingClientRect(),s=d.getParentNode(n).getBoundingClientRect();e={width:parseInt(o.width)+10,height:parseInt(o.height)+10,x:parseInt(o.x)-parseInt(s.x)-5,y:parseInt(o.y)-parseInt(s.y)-5};break;case A.CHART_XAXIS_TITLE:var r=(n=a.querySelector("div"+S[t])).children,o=r[l||0].getBoundingClientRect(),s=d.getParentNode(n).getBoundingClientRect();e={width:parseInt(o.width)+10,height:parseInt(o.height)+10,x:parseInt(o.x)-parseInt(s.x)-5,y:parseInt(o.y)-parseInt(s.y)-5};break;case A.CHART_LEGEND:var o=(n=a.querySelector(S[t])).getBoundingClientRect(),s=d.getParentNode(n).getBoundingClientRect();e={width:parseInt(o.width)+10,height:parseInt(o.height)+10,x:parseInt(o.x)-parseInt(s.x)-5,y:parseInt(o.y)-parseInt(s.y)-5}}return{BOX:e,ELEM:n}}(),c=a.BOX;a.ELEM;if(!c)return;var E=function(e){var n,i,a,r;switch(t){case A.CHART_TITLE:case A.CHART_SUBTITLE:case A.CHART_XAXIS_LABELS:case A.CHART_YAXIS_LABELS:case A.CHART_YAXIS_TITLE:case A.CHART_XAXIS_TITLE:case A.CHART_LEGEND:n=parseInt(e.x)-5,i=parseInt(e.y)-5,e.height&&(a=parseInt(e.height)+10),e.width&&(r=parseInt(e.width)+10)}return{x:n,y:i,height:a,width:r}}(c);if(!E.width)return void o.Client.Action.destroyContextualToolbar();d.addAttributes(n,{fill:"url(#pattern)",x:E.x,y:E.y,width:E.width,height:E.height});var C=I.getHeight(),g=I.getWidth();i?(i.setAttributeNS(null,"width",g),i.setAttributeNS(null,"height",C),i.setAttributeNS(null,"id",T),d.appendChild(i,n)):i=n;for(var p=I.getInstance(),u=p?p.length:0,h=0;h<u;h++){var R=p[h],v=R.container,b=v.getElementsByTagName("svg")[0],O=b.querySelector(S.CHART_BACKGROUND);b.insertBefore(i,O.nextSibling)}}()}}},o.Utility.getSeriesColor=O,o.Utility.isCompositionChart=R,o.Utility.getChartMetaByIndex=v,o.Manager.ZSChartCutomEventManager=new u,o.Constants.CustomEventName=A,o.Constants.CustomEventGroupName=g,a.register(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENT.INIT_TOOLBAR,function(e){var t=o.Manager.ZSChartCutomEventManager,n=t.getActiveMeta(),i=t.getConfigMeta(),a=o.Wrapper.DOMUtils;switch(e){case g.STYLES:!function(){var e=o.Utility.getColorCodeFromGradient(n.getOptions().chart.backgroundColor||"#FFFFFF"),t=(new o.Model.ChartModel).getTransparency(e);c.zslider("#chartTransparencySlder","setValue",t);var i=n.getOptions().chart.style?n.getOptions().chart.style.fontFamily:"Lato";c.zcombo("#chartQukfontfamilys","setValue",i);var r=a.getElementById("ctxChartfillColor");a.addStyle(r.previousElementSibling,{"border-bottom-color":e}),c.zcolorchooser("#ctxChartfillColor","setValue",e)}();break;case g.TITLES:!function(){a.addStyle("titleInputBx",{display:""});var e=o.Manager.SidePanelManager.getDialogUtil(),t=n.getID(),r=o.Utility.getTitleRelative(i.subAction),l=e.getTitleStyle(r,[t]),s=!!l.fontWeight&&"bold"==l.fontWeight;a.addAttributes("titleQckBld",{"data-active":s});var T=!!l.fontStyle&&"italic"==l.fontStyle;a.addAttributes("titleQckItalic",{"data-active":T}),c.zcombo("#titleQckFontSize","setValue",l.fontSize||"12px"),c.zcolorchooser("#titleQckFntColor","setValue",l.color||"#2d2d2d");var d=a.getElementById("titleQckFntColor");a.addStyle(d.previousElementSibling,{"border-bottom-color":l.color||(new o.Model.ChartModel).getRGBA("#4d4d4d",1)});var I=n.getOptions(),E="";switch(i.subAction){case 1:var S=I.title;E=S.text;break;case 2:var S=I.subtitle;E=S.text;break;case 3:var S=I.xAxis.title;E=S.text;break;default:var S=I.yAxis[i.subAction-4].title;E=S.text}var C=a.getElementById("titleInputBx");C.value=o.Utility.getDecodeString(E);var A=new Event("mousedown");C.dispatchEvent(A)}();break;case g.HAXIS:!function(){a.hideById("titleInputBx"),a.hideById("titleQckAlign"),a.getElementById("titlesWrapper").style.width="183px";var e=(n.getXAxis().labels||{}).style||{},t=!!e.fontWeight&&"bold"==e.fontWeight;a.addAttributes("titleQckBld",{"data-active":t});var i=!!e.fontStyle&&"italic"==e.fontStyle;a.addAttributes("titleQckItalic",{"data-active":i}),c.zcombo("#titleQckFontSize","setValue",e.fontSize||"12px"),c.zcolorchooser("#titleQckFntColor","setValue",e.color||(new o.Model.ChartModel).getRGBA("#4d4d4d",1));var r=a.getElementById("titleQckFntColor");a.addStyle(r.previousElementSibling,{"border-bottom-color":e.color||(new o.Model.ChartModel).getRGBA("#4d4d4d",1)})}();break;case g.VAXIS:!function(){var e=i.index,t=n.getYAxis()[e||0],r=(t.labels||{}).style||{},l=!!r.fontWeight&&"bold"==r.fontWeight;a.addAttributes("vXaiesBld",{"data-active":l});var s=!!r.fontStyle&&"italic"==r.fontStyle;a.addAttributes("vXaiesItalic",{"data-active":s}),c.zcombo("#vAxiesQckFontSize","setValue",r.fontSize||"12px"),c.zcolorchooser("#vAxiesQckFontColor","setValue",r.color||(new o.Model.ChartModel).getRGBA("#4d4d4d",1));var T=a.getElementById("vAxiesQckFontColor");a.addStyle(T.previousElementSibling,{"border-bottom-color":r.color||(new o.Model.ChartModel).getRGBA("#4d4d4d",1)}),a.getElementById("cMinQck").value=t.min||"",a.getElementById("cMaxQck").value=t.max||"",a.getElementById("cIntervalQck").value=t.tickInterval||""}();break;case g.SERIES:!function(e,t){P(e,t)&&function(e,t){var n=e.getInstance();for(var i in n){var a=n[i],r=a.container;t.isSeries?a.updateSeriesByCustomProperty(t.sIndex,{borderWidth:1,borderColor:h(e,t)}):a.updatePointByCustomProperty(t.sIndex,t.pIndex,{borderWidth:1,borderColor:h(e,t)});var o=r.querySelector(".highcharts-series-"+t.sIndex),l=o.children,s=l?l.length:0;if(t.isSeries)for(var i=0;i<s;i++){var c=l[i];c.classList.add("animateLinePath")}else{var c=l[t.pIndex];c.classList.add("animateLinePath")}}}(e,t)}(n,i),function(){var e=n.getOptions().series,t=!e[i.sIndex]&&e[i.sIndex-e.length].regressionSettings,r=O(n.getOptions(),i.sIndex,i.pIndex,n.getInstance()[0],i.isSeries,t),l=(new o.Model.ChartModel).getTransparency(r);c.zslider("#seriesTransparency","setValue",l);var s=a.getElementById("ctxSeriesfillColor");a.addStyle(s.previousElementSibling,{"border-bottom-color":r}),c.zcolorchooser("#ctxSeriesfillColor","setValue",r)}();break;case g.LEGEND:!function(){a.hideById("titleInputBx"),a.hideById("titleQckAlign"),a.getElementById("titlesWrapper").style.width="183px";var e=n.getLegend().itemStyle||{},t=!!e.fontWeight&&"bold"==e.fontWeight;a.addAttributes("titleQckBld",{"data-active":t});var i=!!e.fontStyle&&"italic"==e.fontStyle;a.addAttributes("titleQckItalic",{"data-active":i}),c.zcombo("#titleQckFontSize","setValue",e.fontSize||"12px"),c.zcolorchooser("#titleQckFntColor","setValue",e.color||(new o.Model.ChartModel).getRGBA("#4d4d4d",1));var r=a.getElementById("titleQckFntColor");a.addStyle(r.previousElementSibling,{"border-bottom-color":e.color||(new o.Model.ChartModel).getRGBA("#4d4d4d",1)})}()}},"EVENT"),a.register(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENT.INIT,function(){o.Manager.ZSChartCutomEventManager.init()}),a.register(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENT.SET_PROPERTY,function(e){o.Manager.ZSChartCutomEventManager.setProperty(e)},"PROPERTIES"),a.register(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENT.SYNC_PROPERTY_TO_TOOLBAR,function(e){if(b(!0)){var t=o.Manager.ZSChartCutomEventManager.getEventName();a.publish(n.UI,i.SidePanel.CHARTS.CUSTOM.EVENT.INIT_TOOLBAR,{EVENT:t})}},"PROPERTIES")}(this);
!function(t){var n=t.sPlusPlus,e=(t.ZSClass,t.JSUtill,t.UIUtil.Component,t.ZSEvents,t.ZSChart);function i(t,n,e,u){e<u&&function(t,n,e){return new Promise(function(i,u){t[e].updateXAxis(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){i(t,n,++e,u)})}function u(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].setPositiveExtreme(!1),t[e].updateYAxis(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){u(t,n,++e,i)})}function o(t,e,i,u){i<u&&function(t,e,i){return new Promise(function(u,o){var f=n.view.getActiveGridID(),c=n.view.getSheetID(f),r=n.view.getSheetState(f,c),a=r.getZoom();e.width=e.width*a,e.height=e.height*a,t[i].updateChartObject(e),setTimeout(function(){u()},100)})}(t,e,i).then(function(){o(t,e,++i,u)})}function f(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateChartCaption(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){f(t,n,++e,i)})}function c(t,e,i,u,o,f){u<o&&function(t,e,i,u,o){return new Promise(function(f,c){var r=n.view.getActiveGridID(),a=n.view.getSheetID(r),l=n.view.getSheetState(r,a),s=l.getZoom();t[u].setZSCSize(i*s,e*s),"WORDCLOUD"===o&&t[u].redraw(),setTimeout(function(){f()},10)})}(t,e,i,u,f).then(function(){c(t,e,i,++u,o,f)})}function r(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateDataLabels(n),setTimeout(function(){i()},200)})}(t,n,e).then(function(){r(t,n,++e,i)})}function a(t,n,e,i,u){e<i&&function(t,n,e,i){return new Promise(function(u,o){for(var f=0;f<i;f++)n&&t[e].addYMajorGrid(f),!n&&t[e].removeYMajorGrid(f);setTimeout(function(){u()},100)})}(t,n,e,u).then(function(){a(t,n,++e,i,u)})}function l(t,n,e,i,u){e<i&&function(t,n,e,i){return new Promise(function(u,o){for(var f=0;f<i;f++)n&&t[e].addYMinorGrid(f),!n&&t[e].removeYMinorGrid(f);setTimeout(function(){u()},100)})}(t,n,e,u).then(function(){l(t,n,++e,i,u)})}function s(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateAnimation(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){s(t,n,++e,i)})}function h(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateTooltip(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){h(t,n,++e,i)})}function d(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateInverted(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){d(t,n,++e,i)})}function m(t,n,e,i,u){i<u&&function(t,n,e,i){return new Promise(function(u,o){t[i].updateSortingEnabledOp(n,e),setTimeout(function(){u()},100)})}(t,n,e,i).then(function(){m(t,n,e,++i,u)})}function p(t,n,e,i,u){i<u&&function(t,n,e,i){return new Promise(function(u,o){t[i].updateSortingOptions(n,e),setTimeout(function(){u()},100)})}(t,n,e,i).then(function(){p(t,n,e,++i,u)})}function g(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateSpline(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){g(t,n,++e,i)})}function T(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateMarker(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){T(t,n,++e,i)})}function w(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateTitleStyle(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){w(t,n,++e,i)})}function S(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateTitleAlignment(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){S(t,n,++e,i)})}function y(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateLegend(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){y(t,n,++e,i)})}function v(t,n,e,i){e<i&&function(t,n,e){return new Promise(function(i,u){t[e].updateSubTitleAlignment(n),setTimeout(function(){i()},100)})}(t,n,e).then(function(){v(t,n,++e,i)})}function U(t,n,i,u){i<u&&function(t,n,i){return new Promise(function(u,o){var f=t[i];f.updateChartObject(n.getChartObject()),f.setAnimation(!1);var c=n.getTitle();f.updateTitle(c.text);var r=n.getSubTitle();f.updateSubTitle(r.text);var a=n.getXAxis();f.updateXAxis(a);var l=n.getYAxis();f.updateYAxis(l);var s=n.getSeriesObject();f.updateSeries(s);var h,d,m,p,g=n.getChartDetails(),T=(h=n.constructChartOptions(),d=g.lf,m={type:g.type,isSingleYaxis:g.isSingleYaxis,secYAxisSymbl:g.secYAxisSymbl,currency:g.currency,ds:g.ds,ts:g.ts,precisions:g.precision},p=new e.Utility.CommanAgent,!m&&(m=p.getDefaultDataLabelConfig(h.chart.renderTo)),m.lf=d,p.getDataLabelsUpdate(h,m));f.updateDataLabels(T),setTimeout(function(){u()},100)})}(t,n,i).then(function(){U(t,n,++i,u)})}e.Utility.updateChart={fn:function(t,e){!function t(e,i,u,o){u<o&&function(t,e,i){return new Promise(function(u,o){var f=n.view.getActiveGridID(),c=n.view.getSheetID(f),r=n.view.getSheetState(f,c),a=r.getZoom();e.chart.width=e.chart.width*a,e.chart.height=e.chart.height*a,t[i].updateChart(e),setTimeout(function(){u()},100)})}(e,i,u).then(function(){t(e,i,++u,o)})}(t,e,0,t.length)}},e.Utility.updateTitle={fn:function(t,n){!function t(n,e,i,u){i<u&&function(t,n,e){return new Promise(function(i,u){t[e].updateTitle(n),setTimeout(function(){i()},100)})}(n,e,i).then(function(){t(n,e,++i,u)})}(t,n,0,t.length)}},e.Utility.redraw={fn:function(t){!function t(n,e,i){e<i&&function(t,n){return new Promise(function(e,i){t[n].redraw(),setTimeout(function(){e()},100)})}(n,e).then(function(){t(n,++e,i)})}(t,0,t.length)}},e.Utility.updateSubTitle={fn:function(t,n){!function t(n,e,i,u){i<u&&function(t,n,e){return new Promise(function(i,u){t[e].updateSubTitle(n),setTimeout(function(){i()},100)})}(n,e,i).then(function(){t(n,e,++i,u)})}(t,n,0,t.length)}},e.Utility.updateXTitle={fn:function(t,n){!function t(n,e,i,u){i<u&&function(t,n,e){return new Promise(function(i,u){t[e].updateXTitle(n,0),setTimeout(function(){i()},100)})}(n,e,i).then(function(){t(n,e,++i,u)})}(t,n,0,t.length)}},e.Utility.updateXAxis={fn:function(t,n){i(t,n,0,t.length)}},e.Utility.updateYAxis={fn:function(t,n){u(t,n,0,t.length)}},e.Utility.updateChartObject={fn:function(t,n){o(t,n,0,t.length)}},e.Utility.updateChartCaption={fn:function(t,n){f(t,n,0,t.length)}},e.Utility.setSize={fn:function(t,n,e,i){c(t,n,e,0,t.length,i)}},e.Utility.updateDataLabels={fn:function(t,n){r(t,n,0,t.length)}},e.Utility.updateMajorGrid={fn:function(t,n,e){a(t,n,0,t.length,e)}},e.Utility.updateMinorGrid={fn:function(t,n,e){l(t,n,0,t.length,e)}},e.Utility.updateAnimation={fn:function(t,n){s(t,n,0,t.length)}},e.Utility.updateTooltip={fn:function(t,n){h(t,n.enabled,0,t.length)}},e.Utility.updateInverted={fn:function(t,n){d(t,n.inverted,0,t.length)}},e.Utility.updateSpline={fn:function(t,n){g(t,n.type,0,t.length)}},e.Utility.updateSortingEnabledOp={fn:function(t,n,e){m(t,n,e,0,t.length)}},e.Utility.updateSortingOptions={fn:function(t,n,e){p(t,n,e,0,t.length)}},e.Utility.updateMarker={fn:function(t,n){T(t,n,0,t.length)}},e.Utility.updateTitleStyle={fn:function(t,n){w(t,n,0,t.length)}},e.Utility.updateSubTitleAlignment={fn:function(t,n){v(t,n,0,t.length)}},e.Utility.updateTitleAlignment={fn:function(t,n){S(t,n,0,t.length)}},e.Utility.updateLegend={fn:function(t,n){y(t,n,0,t.length)}},e.Utility.updateChartClient={fn:function(t,n){U(t,n,0,t.length)}}}(this);
!function(t){t.sPlusPlus;var i=t.ZSChart;const s={Comparison:1,Composion:2,Relationship:3,Distribution:4,Comparison_Composition:5};function e(t,i,e,h,a){this.isSingleRowDataAllowed=t||!1,this.dateTypeAllowed=i||!1,this.isGroupedChartAllowed=e||!1,this.chartCategory=h||s.Comparison,this.ChartType=a}function h(){e.call(this),this.init()}h.prototype.init=function(){this.SUPPORTED_CHART_LIST=["XYLINE","SCATTER","BAR","COL","PIE","COMBOCHART","DOUGHNUT"],this.RULE_SET={},this.META_DATA=null,this.SELECTED_CHART_TYPE=null,this.isSingleRowData=!1,this.dataLengthInSeries=0,this.dateType=!1,this.isGroupedChart=!1,this.noOfSeries=0,this.firstColAsLabel=!1,this.firstRowAsLabel=!1,this.initRuleSet()},h.prototype.initRuleSet=function(){this.SUPPORTED_CHART_LIST.forEach(function(t){switch(t){case"XYLINE":this.RULE_SET[t]=new e(!0,!0,!0,s.Relationship,t);break;case"SCATTER":this.RULE_SET[t]=new e(!0,!1,!1,s.Relationship,t);break;case"BAR":case"COL":this.RULE_SET[t]=new e(!0,!0,!0,s.Comparison,t);break;case"PIE":case"DOUGHNUT":this.RULE_SET[t]=new e(!0,!1,!1,s.Composion,t);break;case"COMBOCHART":this.RULE_SET[t]=new e(!1,!0,!0,s.Comparison_Composition,t)}}.bind(this))},h.prototype.setMetaData=function(t,i){this.META_DATA=t,i&&(this.SELECTED_CHART_TYPE=t.type)},h.prototype.predict=function(){return this.analyzedData(),this.getPossibility(3)},h.prototype.analyzedData=function(){this.isDateType(),this.isSingleRowDataType(),this.dataFilter()},h.prototype.isDateType=function(){this.dateType="datetime"==this.META_DATA.co.xAxis.type},h.prototype.isSingleRowDataType=function(){this.isSingleRowData=1==this.META_DATA.co.series.length},h.prototype.dataFilter=function(){this.noOfSeries=this.META_DATA.co.series.length||0,this.isGroupedChart=this.META_DATA.grouping||!1,this.firstColAsLabel=this.META_DATA.fcl,this.firstRowAsLabel=this.META_DATA.frl,this.noOfSeries>=1&&(this.dataLengthInSeries=this.META_DATA.co.series[0].data.length)},h.prototype.getPossibility=function(t){var i=[];return this.SELECTED_CHART_TYPE&&i.push(this.SELECTED_CHART_TYPE),this.SELECTED_CHART_TYPE&&-1==this.SUPPORTED_CHART_LIST.indexOf(this.SELECTED_CHART_TYPE)?i:(this.parse(i),t?i.splice(0,t):i)},h.prototype.parse=function(t){this.SUPPORTED_CHART_LIST.forEach(function(i){switch(i){case"XYLINE":(function(t,i){if(-1!==i.indexOf(t.ChartType))return;this.dateType&&this.noOfSeries>=1&&i.push(t.ChartType)}).call(this,this.RULE_SET[i],t);break;case"SCATTER":(function(t,i){if(-1!==i.indexOf(t.ChartType))return;if(this.dateType||this.isGroupedChart)return;this.noOfSeries>=2&&!this.firstRowAsLabel&&!this.firstColAsLabel&&i.push(t.ChartType)}).call(this,this.RULE_SET[i],t);break;case"BAR":case"COL":(function(t,i){if(-1!==i.indexOf(t.ChartType))return;i.push(t.ChartType)}).call(this,this.RULE_SET[i],t);break;case"PIE":(function(t,i){if(-1!==i.indexOf(t.ChartType))return;if(this.dateType||this.isGroupedChart)return;this.isSingleRowData&&this.dataLengthInSeries<=6&&i.push(t.ChartType)}).call(this,this.RULE_SET[i],t);break;case"COMBOCHART":(function(t,i){if(-1!==i.indexOf(t.ChartType))return;if(this.isSingleRowData)return;if(!this.frl||!this.fcl)return;i.push(t.ChartType)}).call(this,this.RULE_SET[i],t)}}.bind(this))},i.Manager.ZRecommendation=h}(this);
!function(e){var t=e.sPlusPlus,r=(e.ZSClass,e.UserAction,e.ZSChart),o=r.Constants.ChartType,n=e.UIUtil.Component,a=!1,i=[],s=null,p=(e.ZSDevTools.Logger,{}),l={},h=null,c=e.ZSEvents,u=c.Groups,g=c.Names,m=c.topic;function y(){}y.prototype.setDialogStatus=function(e){a=e},y.prototype.isAllowToDraw=function(e){try{for(var t=e.co.series,r=!0,o=0;o<t.length&&r;o++){r=!0;var n=t[o].data;if(n)for(var a=0;a<n.length;a++)if(n[a].y||n[a].weight){r=!1;break}}return!r}catch(e){return!1}},y.prototype.setRangeState=function(e,t){l[e]=t},y.prototype.getRangeState=function(e){return l[e]},y.prototype.resetRangePicker=function(){p={}},y.prototype.setMoveMenuRefreshedSheetName=function(e){h=e},y.prototype.getMoveMenuRefreshSheetName=function(){return h},y.prototype.resetMoveMenu=function(){h=null},y.prototype.addRangePicker=function(e,t){p[e]=t},y.prototype.getRangePicker=function(e){return p[e]},y.prototype.pickIntegerFromString=function(e,t){var r=e.match(/\d+/g);return t?r:r?r[0]:0},y.prototype.isFallUnderCompositionType=function(e){var t=[];return t.push(o.PIE),t.push(o.SEMIPIE),t.push(o.FUNNEL),t.push(o.SEMIDOUGHNUT),t.push(o.DOUGHNUT),t.push(o.DOUGHNUT3D),t.push(o.PIE3D),-1!==t.indexOf(e.toLowerCase())},y.prototype.isFallUnderStackedtype=function(e){return-1!==e.toUpperCase().indexOf(o.STACKED)&&-1==e.toUpperCase().indexOf(o.PERCENT)},y.prototype.checkIfDataApplicableForChartType=function(e,t){var n=e.getType(),a=r.Utility.getSeriesLengthFromRange(e,t),i=!0;switch(n.toLowerCase()){case o.OHLCCHART:case o.CANDLESTICK:i=a>=4;break;case o.BUBBLE:i=a>1}return i},y.prototype.getRangeAry=function(e,t,r){return e&&""!==e?(ranges=e.split(";"),"COLS"==t&&"VERTICAL"==r||"ROWS"==t&&"HORIZONTAL"==r?ranges[0]:e):[]},y.prototype.getGroupedChartName=function(e){var t={GROUPEDCOL:"COL",GROUPEDBAR:"BAR"};return t[e]?t[e]:e},y.prototype.get3DChartName=function(e){var t={COL:"COL3D",BAR:"BAR3D",PIE:"PIE3D",DOUGHNUT:"DOUGHNUT3D"};return t[e]},y.prototype.isWordCloud=function(e){return"WORDCLOUD"===e},y.prototype.isAnimationChart=function(e){return"ANIMATION_CHART"===e},y.prototype.isHistogram=function(e){return"HISTOGRAM"===e},y.prototype.isFallUnder3D=function(e){var t=[];return t.push(o.PIE),t.push(o.DOUGHNUT),t.push(o.COLUMNCHART),t.push(o.BAR),-1!==t.indexOf(e.toLowerCase())||-1!==e.indexOf(o.STACKED)||-1!==e.indexOf("3D")},y.prototype.isFallUnderCorrelationType=function(e){var t=[];return t.push(o.SCATTER),t.push(o.XYLINE_SCATTER),t.push(o.XYLINE_SCATTER_SHAPES),-1!==t.indexOf(e.toLowerCase())},y.prototype.isComboChartContainsLine=function(e,t){var r=!1;if(e===o.COMBOCHART)for(var n=Object.keys(t),a=0;a<n.length;a++)if(-1!==t[n[a]].indexOf(o.XYLINE.toUpperCase())){r=!0;break}return r},y.prototype.getScaleFactorConstant=function(e){return-1!==r.Constants.ScaleRange.indexOf(e)?e:"custom"},y.prototype.isInvertedPossible=function(e){return"XYLINE"===e||"SPLINE"===e||"STEPCHART"===e||"XYAREA"===e||"XYSTACKEDAREA"===e||"XYSTACKEDAREA_PERCENT"===e||"SCATTER"===e||"XYLINE_SCATTER"===e||"XYLINE_SCATTER_SHAPES"===e||"HISTOGRAM"===e},y.prototype.isFallUnderLineType=function(e){var t=[];return t.push(o.XYLINE),t.push(o.SPLINE),t.push(o.STEPCHART),-1!==t.indexOf(e.toLowerCase())},y.prototype.isGroupingAllowedInChart=function(e){var t=[];return t.push(o.COLUMN),t.push(o.COLUMNCHART),t.push(o.BAR),t.push(o.GROUPEDCOL),t.push(o.GROUPEDBAR),-1!==t.indexOf(e.toLowerCase())},y.prototype.getDialogStatus=function(e){return a},y.prototype.setActiveChartID=function(e){i.push(e)},y.prototype.removeActiveChartID=function(){return i.pop()},y.prototype.getActiveChartID=function(){return i[i.length-1]},y.prototype.setDialogUtil=function(e){s=e},y.prototype.removeDailogUtil=function(){s=null},y.prototype.getDialogUtil=function(){return s},y.prototype.updateTheme=function(e){var t=this.getDialogStatus()||!1,o=r.Manager.SidePanelManager.getActiveChartID()||"preview";this.getDialogUtil().updateTheme(o,e,t);var n=new r.Controller.ZSCController;!t&&n.updateTheme(e)},y.prototype.resetSidePanel=function(){var e=r.Wrapper.DOMUtils;n.zcombo("#yaxisMulti","setValue","LA"),n.zcombo("#chartTitleCombo","setValue","CHART_TITLE");var t=new r.Utility.AgentDom;t.closeAggregationTab(),t.closeFilterTab(),!e.hasClass(e.getElementByClassName("generalTab"),"active")&&e.getElementByClassName("generalTab").click(),m.publish(u.UI,g.SidePanel.CHARTS.CLOSE_ALL_ACCORDIONS)},y.prototype.resetTitleCombo=function(){n.zcombo("#chartTitleCombo","setValue","CHART_TITLE")},y.prototype.reveseColorScheme=function(e){var t=this.getDialogStatus()||!1,o=r.Manager.SidePanelManager.getActiveChartID()||"preview";t&&this.getDialogUtil().reveseColorScheme(o,e);var n=new r.Controller.ZSCController;!t&&n.reveseColorScheme(e)},y.prototype.getAssociateParentThemeNameByChildThemeName=function(e){var t=r.Constants,o=(t=r.Constants).SupportedTheme,n=t.ColorSchemeType,a=e.match(/\d+/g);return-1!==e.indexOf(n.COLORFUL)?e:-1!==e.indexOf(n.CUSTOM)?o.SHEET_OFFICE_COLORFUL_THEME1:a>=1&&a<=6?o.SHEET_OFFICE_COLORFUL_THEME1:a>=7&&a<=12?o.SHEET_OFFICE_COLORFUL_THEME2:a>=13&&a<=18?o.SHEET_OFFICE_COLORFUL_THEME3:a>=19&&a<=24?o.SHEET_OFFICE_COLORFUL_THEME4:a>=25&&a<=30?o.SHEET_OFFICE_COLORFUL_THEME5:o.SHEET_OFFICE_COLORFUL_THEME6},y.prototype.getSupportedChartThemeObject=function(){return r.Constants.ColorThemeRange},y.prototype.mergeRecursively=function(e,t){return t&&Object.keys(t).forEach(function(r){"object"==typeof t[r]&&e[r]?e[r]=this.mergeRecursively(e[r],t[r]):e[r]=t[r]}.bind(this)),e},y.prototype.getLegendName=function(e){return["None","Bottom","Top","Right","Left","TopRight"][e]},y.prototype.getLegendPosition=function(e){var t=r.Manager.SidePanelManager;e||(t&&t.isPanelOpen()&&(e=n.zcombo("#legendPos","getValue")),t&&!t.isPanelOpen()&&(e="None"));return{Bottom:1,Left:4,Right:3,Top:2,None:0,TopRight:5}[e]},y.prototype.setDefaultLegendItemStylesOrElse=function(e,t){return t?e.itemStyle=t:e.itemStyle?e.itemStyle.fontWeight||(e.itemStyle.fontWeight="normal"):e.itemStyle={fontWeight:"normal"},e},y.prototype.getLegendUpdate=function(e,t,r,o){var n,a,i,s={},p=!0,l={x:0,y:0};switch(e=this.getLegendName(e)){case"Top":case 2:n="horizontal",a="center",i="top";break;case"Bottom":case 1:n="horizontal",a="center",i="bottom";break;case"Left":case 4:n="vertical",a="left",i="middle";break;case"Right":case 3:n="vertical",a="right",i="middle";break;case"TopRight":case 5:n="vertical",a="right",i="top";var h=t&&!!o&&"right"==o.title.align,c=r&&!!o&&"right"==o.subtitle.align;h&&c&&(l.y=50),!h&&!c&&(l.y=0),!h&&c&&(l.y=30),h&&!c&&(l.y=30);break;case"None":case 0:p=!1}return n&&(s.layout=n),a&&(s.align=a),i&&(s.verticalAlign=i),s.maxHeight="bottom"!==i&&"top"!==i||"vertical"===n?"":55,s.y=l.y,s.symbolHeight=10,s.symbolWidth=10,s.borderWidth=0,s.enabled=p,o&&o.legend&&delete o.legend,s},y.prototype.getDataLabelsUpdate=function(e,t){var n=t.lf,a=t.currency,i=(t.ds,t.ts,t.type),s=new r.Utility.ChartAgent;a=s.filterCurrency(a,e.series?e.series.length:0),t.precisions;switch(n){case"N":e.plotOptions.series.dataLabels={enabled:!1};break;case"V":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){var e=s.pickCurrency(a,this.series.index,i),t=this.point.decimals;return this.y>=0?"%"===e?Highcharts.numberFormat(this.y,t)+e:e+Highcharts.numberFormat(this.y,t):"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),t)+e:"-"+e+Highcharts.numberFormat(Math.abs(this.y),t)}};break;case"L":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.key}};break;case"S":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.series.name}};break;case"P":(-1!==i.toLowerCase().indexOf(o.FUNNEL)||-1!==i.toLowerCase().indexOf(o.PIE)||-1!==i.toLowerCase().indexOf(o.DOUGHNUT)||e.plotOptions.series.stacking&&(-1!==e.plotOptions.series.stacking.indexOf("normal")||-1!==e.plotOptions.series.stacking.indexOf("percent")))&&(e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return Highcharts.numberFormat(this.percentage,2)+"%"}});break;case"L_P":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.key?this.key+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"S_V":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},currencySymbol:a,formatter:function(){var e=s.pickCurrency(a,this.series.index,i),t=this.point.decimals;return this.y>=0?"%"===e?this.series.name+" ("+Highcharts.numberFormat(this.y,t)+e+")":this.series.name+" ("+e+Highcharts.numberFormat(this.y,t)+")":"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),t)+e:this.series.name+" (-"+e+Highcharts.numberFormat(Math.abs(this.y),t)+")"}};break;case"L_V":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},currencySymbol:a,formatter:function(){var e=s.pickCurrency(a,this.series.index,i),t=this.point.decimals;return this.y>=0?"%"===e?this.key+" ("+Highcharts.numberFormat(this.y,t)+e+")":this.key+" ("+e+Highcharts.numberFormat(this.y,t)+")":"%"===e?"-"+Highcharts.numberFormat(Math.abs(this.y),t)+e:this.key+" (-"+e+Highcharts.numberFormat(Math.abs(this.y),t)+")"}};break;case"S_P":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.series.name?this.series.name+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"V_P":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.y?this.y+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"B":e.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.point.z}};break;default:e.plotOptions.series.dataLabels={enabled:!1}}return e},y.prototype.getDefaultDataLabelConfig=function(e){var r=t.view.getActiveGridID(),o=t.view.getVersionID(r),n=t.view.getResourceID(r),a=t.data.getWorkBook(n,o),i=t.view.getSheetID(r),s=a.getSheetObj(i).Charts.get(e);return{type:s.getType(),isSingleYaxis:s.isSingleYaxis(),secYAxisSymbl:s.getSecYAxisSymbol(),currency:s.getCurrency(),ds:s.getDecimalSeprator(),ts:s.getThousandSeprator(),precisions:s.getPrecisions()}},!r.Utility&&(r.Utility={}),r.Utility.CommanAgent=y}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSEvents,o=a.Groups,r=(a.Names,a.topic),n=e.ZSChart,l=e.UIUtil.Component,i=(n.Constants.ServiceProvider,n.Constants.ChartType),d=ZSConstants.I18N,s=e.document,p=n.Constants.ChartRangePickerType,c=(n.Constants.ChartClasses,n.Constants.ChartNames),g=n.Constants.defaultColor,m=e.ZSConstants.CommandConstants,u=n.Wrapper.DOMUtils;n.Constants.MULTI_AXIES_CHART_TYPE;function y(){}function h(e,t){var a=(new n.Utility.CommanAgent).pickIntegerFromString(t)-1,o=n.Wrapper.DOMUtils,r="12px",i="normal",d="normal",s="#2d2d2d";try{if(a>=0&&e){var p=e[a],c=p.label?p.label.style:{};l.zcombo("#chartPlotNameFont","setValue",c.fontSize||"12px"),l.zcolorselectbox("#chartPlotNameFontColor","setValue",c.color||"#2d2d2d");var g=o.getElementById("chartPlotNamebold"),m=o.getElementById("chartPlotNameitalic");"italic"==c.fontStyle?o.addClass(m,"active"):o.removeClass(m,"active"),"bold"==c.fontWeight?o.addClass(g,"active"):o.removeClass(g,"active"),l.zcolorchooser("#chartPlotLineColor","setValue",p.color)}}catch(e){l.zcombo("#chartPlotNameFont","setValue",r||"12px"),l.zcolorselectbox("#chartPlotNameFontColor","setValue",s||"#2d2d2d");g=o.getElementById("chartPlotNamebold"),m=o.getElementById("chartPlotNameitalic");"italic"==d?o.addClass(m,"active"):o.removeClass(m,"active"),"bold"==i?o.addClass(g,"active"):o.removeClass(g,"active"),l.zcolorchooser("#chartPlotLineColor","setValue",s)}}y.prototype.setDivContainerProperty=function(e,t,a,o,r,l,i,d,p,c,g,m,u){var y=s.createDocumentFragment(),h=n.Wrapper.DOMUtils,C=u||h.createElement("div",{context:"MI_CHART_CONTEXT"});C.id=o,y.appendChild(C);var v=new n.Controller.ZSCController;v.AddOle(e,t,a,o,d,i,l,r),v.AddContent(e,t,a,o,y)},y.prototype.generateMonochromaticShades=function(e){var t=n.Wrapper.DOMUtils,a=new n.Utility.CommanAgent;e=a.getAssociateParentThemeNameByChildThemeName(e);for(var o,r=a.getSupportedChartThemeObject()[e],l="",i=t.getElements("colorpaletteDialogMonochromatic > li"),d=r.startIndex;d<=r.endIndex;d++){o=r.basecolor[d-r.startIndex],l=new n.Utility.SheetChartColor(o).getLinerGradient(6);var s={"data-basecolor":o,"data-name":"SHEET-OFFICE-MONOCHORMATIC-THEME"+d};t.addAttributes(i[d-r.startIndex],s),t.addStyle(i[d-r.startIndex],{"background-image":l})}},y.prototype.resetFilterIfNeeded=function(){n.Wrapper.DOMUtils;l.zcombo("#filterType","setValue","NONE"),l.zspinner("#filterSpinner","setValue","0"),l.zcombo("#filterColumns","setValue","noFilter")},y.prototype.reverseAllLiItems=function(e){var t=n.Wrapper.DOMUtils,a="chartDialogCPalletteCode",o=t.getElements(a);for(var r in o){var l=(d=o[r]).children;for(var r in l){var i=l[r];1==i.nodeType&&i.setAttribute("data-reversed",e)}}a="colorDialogCustomPallete",o=t.getElements(a);for(var r in o){var d;1==(d=o[r]).nodeType&&d.setAttribute("data-reversed",e)}},y.prototype.resetColorDOMProperty=function(e,t){var l=n.Wrapper.DOMUtils,i=n.Constants.ColorSchemeType,d=this.getColorScaleProperty(e);if(t){l.addAttributes("chartThemePallate",d.property),-1!==l.getElementById("chartThemePallate").dataset.name.indexOf(i.COLORFUL)&&l.getElementById("chartThemePallate").setAttribute("data-reversed",!1),l.addStyle("chartThemePallate",d.css)}l.removeClass(l.findByClassName("cPaletteCode > li","active"),"active"),l.removeClass(l.getElementByClassName("colorDialogCustomPallete"),"active");for(var s="cPaletteCode li[data-name ="+d.property["data-name"]+"]",p=l.getElements(s),c=0;c<p.length;c++)l.addClass(p[c],"active");var g=d.property["data-reversed"];g="string"==typeof g?"true"==g:g;l.getElements("customColorToggle")[0].checked=g;var m=e.colorObject.colorTheme;-1!==m.name.indexOf(i.CUSTOM)&&(l.addStyle("colorDialogCustomPallete",d.css),l.addAttributes("colorDialogCustomPallete",d.property),l.addStyle("chartcustomcolorDropDown > span",{background:m.basecolor}),l.addClass(l.getElementByClassName("colorDialogCustomPallete"),"active")),this.reverseAllLiItems(g);var u=l.getElementById("chrtTypeLblValue");u&&r.publish(o.UI,a.Names.SidePanel.CHARTS.UPDATE_ICON_THEME,{PARENT:u});var y=l.getElementById("pivotChartTypeWrapper");y&&r.publish(o.UI,a.Names.SidePanel.CHARTS.UPDATE_ICON_THEME,{PARENT:y})},y.prototype.getColorScaleProperty=function(e){var t=e.colorObject.colorTheme,a=t.basecolor,o=n.Constants.ColorSchemeType;a="string"==typeof a&&-1!==a.indexOf("[")?JSON.parse(a):a;var r=t.name,l=-1!==r.indexOf(o.COLORFUL),i=new n.Utility.SheetChartColor(a),d=l?i.generateLinearGradient():i.getLinerGradient(6);(new n.Utility.ChartAgent).generateMonochromaticShades(r,!0);var s=t.isReversed;return void 0===s&&(s=t.reversed),{property:{"data-basecolor":a,"data-name":t.name,"data-reversed":s},css:{"background-image":d}}},y.prototype.refreshDataLabelsAsync=function(e){var t=new n.Utility.CommanAgent,a=n.Wrapper.DOMUtils;return new Promise(function(o,r){a.removeAll(["dataLabels_bubble_size","dataLabels_series_value","dataLabels_label_value","dataLabels_label_percent","dataLabels_value_percent","dataLabels_series_percent","dataLabels_percent"]);var n=a.getElementById("dataLabels");if(t.isFallUnderCompositionType(e)){var s=a.createElement("option",{id:"dataLabels_percent",value:"P"});s.innerText=d.ShowPercent,a.appendChild(n,s)}if(-1!==e.toLowerCase().indexOf(i.BUBBLE)){var p=a.createElement("option",{id:"dataLabels_bubble_size",value:"B"});p.innerText=d.ShowBubbleSize,a.appendChild(n,p)}var c=a.createElement("option",{id:"dataLabels_label_value",value:"L_V"});c.innerText=d.ShowLabelValue,a.appendChild(n,c);var g=a.createElement("option",{id:"dataLabels_series_value",value:"S_V"});if(g.innerText=d.ShowSeriesValue,a.appendChild(n,g),-1!==e.indexOf(i.STACKED)||t.isFallUnderCompositionType(e)){var m=a.createElement("option",{id:"dataLabels_label_percent",value:"L_P"});m.innerText=d.ShowLabelPercent,a.appendChild(n,m);var u=a.createElement("option",{id:"dataLabels_value_percent",value:"V_P"});u.innerText=d.ShowValuePercentage,a.appendChild(n,u);var y=a.createElement("option",{id:"dataLabels_series_percent",value:"S_P"});y.innerText=d.ShowSeriesPercentage,a.appendChild(n,y)}l.zcombo("#dataLabels","refresh"),setTimeout(function(){o()},10)})},y.prototype.updateYAxiesRelative=function(e,t){var a=(new n.Utility.CommanAgent).pickIntegerFromString(t.value),o=e.getYAxis(),r=o[a];e.setActiveYIndex(a),this.generatePlotline(o,a),r&&this.updateYAxiesRelativeByAxiesObjectSP(r,a)},y.prototype.refreshDialogDom=function(e){var t=this;this.updateSeriesDom(e).then(function(){this.refreshDataLabelsAsync(e.getType()).then(function(){this.refreshMuilipleAxiesLabelAsync(e).then(function(){this.updateSidePanelAysc(e,t)}.bind(this))}.bind(this))}.bind(this))},y.prototype.updateSeriesDom=function(e){var t=n.Wrapper.DOMUtils;return new Promise(function(d,s){var p=e.getOptions(),c=p.series,g=document.getElementById("chartSeries");if(g.innerHTML="",(new n.Utility.CommanAgent).isFallUnderCompositionType(e.getType())){var m=(new n.Utility.ChartAgent).getMaximumSeriesLength(p);for(u=m[1],y=0;y<u;y++){h=c[m[0]].data[y].name||"point "+(y+1),C="point_"+(y+1);(A=t.createElement("option",{id:C,value:y})).innerText=h,t.appendChild(g,A)}}else{for(var u=c?c.length:0,y=0;y<u;y++){var h=c[y].name||"series "+(y+1),C="series_"+(y+1);(A=t.createElement("option",{id:C,value:y})).innerText=h,t.appendChild(g,A)}for(var v=0,I=u;v<u;v++,I++)if(c[v]&&c[v].regressionSettings&&e.isTrendline()){var A,h=(c[v].name||"series "+(v+1))+" Trendline",C="series_"+(I+1);(A=t.createElement("option",{id:C,value:I})).innerText=h,t.appendChild(g,A)}}l.zcombo("#chartSeries","refresh"),l.zcombo("#chartSeries","setValue","0"),t.hideById("chartTypeMenuWrapper"),e.getType()==i.COMBOCHART&&t.addStyle("chartTypeMenuWrapper",{display:""}),setTimeout(function(){d()},10),r.publish(o.UI,a.Names.SidePanel.CHARTS.ACCORDION.SERIES.UPDATE)})},y.prototype.createPlotLineDom=function(t){var a=n.Wrapper.DOMUtils,o=e.UserAction.getTemplate(["CHART_PLOTLINE_TEMPLATE"]).CHART_PLOTLINE_TEMPLATE.cloneNode(!0);if(o.hasChildNodes()){var r=o.querySelectorAll("input"),l=o.querySelector("span"),i=r[0],d=r[1];i.setAttribute("data-index",t),d.setAttribute("data-index",t),i.id="PlotlineName"+t,d.id="PlotlineValue"+t,d.addEventListener("change",n.Action.updatePlotline),l.addEventListener("click",n.Action.removePlotLine),i.addEventListener("change",n.Action.updatePlotlineName)}a.getElementById("plotLineWrapper").appendChild(o),t<2?a.showById("addPlotLine"):a.hideById("addPlotLine")},y.prototype.generateDefaultPlotline=function(){var t=n.Wrapper.DOMUtils,a=e.UserAction.getTemplate(["CHART_PLOTLINE_DEFAULT_TEMPLATE"]).CHART_PLOTLINE_DEFAULT_TEMPLATE.cloneNode(!0);if(a.hasChildNodes()){var o=a.querySelectorAll("input"),r=o[0],l=o[1];r.setAttribute("data-index",0),l.setAttribute("data-index",0),r.id="PlotlineName0",l.id="PlotlineValue0",l.addEventListener("change",n.Action.updatePlotline),r.addEventListener("change",n.Action.updatePlotlineName)}t.getElementById("plotLineWrapper").appendChild(a)},y.prototype.generatePlotline=function(e,t){var a=n.Wrapper.DOMUtils,o=(e.length?e[t]:e).plotLines,r=o&&o.length||0;a.getElementById("plotLineWrapper").innerHTML="",this.generateDefaultPlotline(),this.addCustomPlotline(1,r),r>=3&&this.hideAddButton(),this.refreshPlotlineDom(o)},y.prototype.refreshPlotlineDom=function(e,t){return new Promise(function(a,o){var r=document.getElementById("plotlineValues"),n=l.zcombo("#plotlineValues","getValue");r.innerHTML="";for(var i=e?e.length:t||0,d=0;d<i;d++){var s="Plotline"+(d+1);(p=u.createElement("option",{id:s,value:s})).innerText=s,u.appendChild(r,p)}if(0==i){var p;s="None";(p=u.createElement("option",{id:s,value:s})).innerText=s,u.appendChild(r,p),u.hideById("plotlineCustomizationWrapper")}else u.addStyle("plotlineCustomizationWrapper",{display:""});l.zcombo("#plotlineValues","refresh"),l.zcombo("#plotlineValues","setValue",n||"Plotline1"),h(e,n||"Plotline1"),function(e){var t=this;l.unbind("#plotlineValues","zselectboxchange"),l.bind("#plotlineValues","zselectboxchange",function(e,a){var o=a.value;h(t,o)})}.call(e),setTimeout(function(){a()},10)})},y.prototype.hideAddButton=function(){var e=n.Wrapper.DOMUtils,t=e.getElementById("addPlotLine");e.hide(t)},y.prototype.addCustomPlotline=function(e,t){for(var a=e,o=e;a<t;a++,o++)this.createPlotLineDom(o)},y.prototype.refreshMuilipleAxiesLabelAsync=function(e){var t=n.Wrapper.DOMUtils;return new Promise(function(a,o){var r=t.getElementById("yaxisMulti");try{if(null!==r){var n=r.children.length,i=e.getOptions(),s=i.series?i.series.length:0;n==s&&a();for(var p=1;p<n;p++)t.remove("RA"+p);for(var c=1;c<s;c++){var g=t.createElement("option",{id:"RA"+c,value:"RA"+c,class:"RA"});g.innerText=d["Chart.SelectedAxis.RightAxis"]+c,t.appendChild(r,g)}l.zcombo("#yaxisMulti","refresh")}}catch(e){}setTimeout(function(){a()},10)})},y.prototype.updateDialog=function(e){this.refreshDialogDom(e);var t=n.Wrapper.DOMUtils,a=new n.Utility.CommanAgent;a.getRangePicker(p.DATA_RANGE).value=e.getRange().trim(),l.zcombo("#combinedRanges","setValue",e.combinedRange);var o=-1==e.seriesIn.indexOf("COLS");o&&(t.getElementById("rowChart").checked=!0),!o&&(t.getElementById("columnChart").checked=!0),t.getElementById("firstRow").checked=e.frl,t.getElementById("firstColumn").checked=e.fcl,a.getRangePicker(p.CHART_TITLE).value=e.getTitle(),a.getRangePicker(p.CHART_SUBTITLE).value=e.getSubTitle(),l.zcombo("#legendPos","setValue",e.getLegendName(e.lPostion)),l.zcombo("#dataLabels","setValue",e.dLables),l.zcombo("#trendlineType","setValue",e.trendlineType),l.zcombo("#trendlineDegree","setValue",e.trendlineDegree);var r=Math.max(2,e.options.series.length);l.zspinner("#trendlinePeriod","setValue",e.trendlineDegree),l.zspinner("#trendlinePeriod","setMaxValue",r),t.getElementById("ChartThreshold").value=e.threshold,t.getElementById("tooltipToggle").checked=e.tooltip,t.getElementById("invertedToggle").checked=e.options.chart.inverted,t.getElementById("splineToggle").checked="area"!=e.options.chart.type,t.getElementById("animationToggle").checked=e.animation,t.getElementById("zoomToggle").checked=e.zoom,t.getElementById("autoExpandToggle").checked=e.autoExpand,t.getElementById("hddCellToggle").checked=e.isIncludeHidden,t.getElementById("multiyaxisYes").checked=e.getYAxisState();var i=t.getElementById("yAxisWrapper");e.getYAxisState()?t.addClass(i,"wrapMultiAxies"):t.removeClass(i,"wrapMultiAxies"),this.resetColorDOMProperty(e.getStyleObject(),!0);var d=e.xAxis[0];a.getRangePicker(p.CHART_X_AXIES).value=d.title.text,t.getElementById("xAxisLabel").checked=d.labels.enabled,l.zcombo("#slant","setValue",e.slant),l.zcombo("#staggerLines","setValue",1==e.staggerLines?"auto":e.staggerLines);var s,c=a.pickIntegerFromString(l.zcombo("#yaxisMulti","getValue"));e.setActiveYIndex(c),s=e.yAxis[e.getActiveYIndex()],this.updateYAxiesRelativeByAxiesObject(s,e.getActiveYIndex()),t.getElementById("majorGridLines").checked=e.majorGridLine,t.getElementById("minorGridLines").checked=e.minorGridLine},y.prototype.updateTitleStyle=function(e){var t=n.Wrapper.DOMUtils;l.zcombo("#chartFont","setValue",e.fontSize);var a=!1,o=!1,r=document.querySelector("#chartTitlebold"),i=document.querySelector("#chartTitleitalic");e&&e.fontStyle&&(o="normal"!==e.fontStyle),e&&e.fontWeight&&(a="normal"!==e.fontWeight),t.updateActive(r,a),t.updateActive(i,o),e&&l.zcolorselectbox("#chartTitleFontColor","setValue",e.color)},y.prototype.updateLegendItemStyle=function(e){var t=n.Wrapper.DOMUtils,a=e&&e.fontSize?e.fontSize:"12px",o=!1,r=!1,i=document.querySelector("#chartBold"),d=document.querySelector("#chartitalic");e&&e.fontStyle&&(r="normal"!==e.fontStyle),e&&e.fontWeight&&(o="normal"!==e.fontWeight),l.zcombo("#legendFont","setValue",a),t.updateActive(i,o),t.updateActive(d,r),e&&l.zcolorselectbox("#chartFontColor2","setValue",e.color)},y.prototype.updateChartFontFamily=function(e){l.zcombo("#chartfontfamilys","setValue",e.getFontFamily())},y.prototype.updateTitleRelatedDom=function(e){var t=n.Wrapper.DOMUtils,a=(new n.Utility.CommanAgent,l.zcombo("#chartTitleCombo","getValue")),o=e.getTitleJsonForSP(a),r=e.getTitleStyleJsonForSP(a);t.getElementById("titleTextBox").value=n.Utility.getDecodeString(o),r&&this.updateTitleStyle(r)},y.prototype.updateLegendRelatedDom=function(e){l.zcombo("#legendPos","setValue",e.getLegendName(e.lPostion)),this.updateLegendItemStyle(e.getLegendStyle())},y.prototype.updateDataLabelsDom=function(e){var t=n.Wrapper.DOMUtils;l.zcombo("#dataLabels","setValue",e.dLables);var a=e.getOptions().colorOptions.dataLabels||{};l.zcombo("#dataLabelsFontSize","setValue",a.fontSize||"12px"),l.zcolorselectbox("#dataLabelsFontColor","setValue",a.color||"#2d2d2d");var o=t.getElementById("dataLabelsBold"),r=t.getElementById("dataLabelsItalic");"bold"==a.fontWeight?t.addClass(o,"active"):t.removeClass(o,"active"),"italic"==a.fontStyle?t.addClass(r,"active"):t.removeClass(r,"active")},y.prototype.updateTrendlineRelatedDom=function(e){n.Wrapper.DOMUtils.getElementById("trendLineToggle").checked=e.trendline&&"none"!=e.trendlineType,l.zcombo("#trendlineType","setValue",e.trendlineType),l.zcombo("#trendlineDegree","setValue",e.trendlineDegree);var t=(new n.Utility.ChartAgent).getMaximumDataLength(e);t=Math.max(2,t),l.zspinner("#tlPeriod","setValue",e.trendlineDegree),l.zspinner("#tlPeriod","setAttribute","max",t)},y.prototype.updateTooltipToggle=function(e){u.getElementById("tooltipToggle").checked=e.tooltip},y.prototype.updateInvertedToggle=function(e){u.getElementById("invertedToggle").checked=e.options.chart.inverted},y.prototype.updateSplineToggle=function(e){var t=e.options.chart.type;u.getElementById("splineToggle").checked="areaspline"==t},y.prototype.updateAnimationToggle=function(e){u.getElementById("animationToggle").checked=e.animation},y.prototype.updateRaceChartOptions=function(e){if("ANIMATION_CHART"==e.type){var t=e.options.chart.animation?e.options.chart.animation.duration:200;t/=1e3,l.zspinner("#animationSpeed","setValue",t);var a,o=e.options.series[0].data.length<10?e.options.series[0].data.length:10,r=e.options.xAxis.max?e.options.xAxis.max+1:o;l.zspinner("#barCount","setValue",r),e.options.plotOptions.series.dataSorting?(void 0!=typeof e.options.plotOptions.series.dataSorting.enabled&&e.options.plotOptions.series.dataSorting.enabled,a=e.options.plotOptions.series.dataSorting.order?e.options.plotOptions.series.dataSorting.order:"descending"):(!0,a="descending"),void 0!=e.options.rc.cumulate&&(u.getElementById("sumToggle").checked=e.options.rc.cumulate),e.options.rc.date?(u.showById("interpolationWrapper"),u.getElementById("interpolationToggle").checked=e.options.rc.interpolate):u.hideById("interpolationWrapper");var n=e.options.rc.mvo;switch(n){case 0:n="TreatZero";break;case 1:n="Interpolate";break;case 2:n="LastValid"}l.zcombo("#missingValues","setValue",n);var i="ascending"==a?"BOTTOM":"TOP";l.zcombo("#sortingOrder","setValue",i)}},y.prototype.updateCaptionOptions=function(e){if("ANIMATION_CHART"==e.type&&e.options.caption&&e.options.caption.style){l.zcombo("#captionFont","setValue",e.options.caption.style.fontSize);var t=document.querySelector("#captionBold"),a=(document.querySelector("#captionitalic"),e.options.caption.style.fontWeight),o=e.options.caption.style.fontStyle,r="normal"!=a&&void 0!=a,n="normal"!=o&&void 0!=o;u.updateActive(t,r),u.updateActive(captionItalic,n),l.zcolorselectbox("#captionFontColor","setValue",e.options.caption.style.color),u.getElementById("caption").checked="none"!=e.options.caption.style.display}},y.prototype.updateHiddenCellToggle=function(e){u.getElementById("hddCellToggle").checked=e.isIncludeHidden},y.prototype.updateMultiAxisToggle=function(e){u.getElementById("multiyaxisYes").checked=e.getYAxisState();var t=u.getElementById("yAxisWrapper");e.getYAxisState()?u.addClass(t,"wrapMultiAxies"):u.removeClass(t,"wrapMultiAxies")},y.prototype.updateAutoExpandToggle=function(e){u.getElementById("autoExpandToggle").checked=e.autoExpand},y.prototype.updateDataLabelsTotal=function(e){u.getElementById("totalDataLabls").checked=e.dlt;var t=e.getStyleObject().colorObject.dataLabelsTotal;l.zcombo("#dltFontSize","setValue",t.fontSize),l.zcolorselectbox("#dltColor","setValue",t.color);var a=u.getElementById("dltBold"),o=u.getElementById("dltItalic");"bold"==t.fontWeight?u.addClass(a,"active"):u.removeClass(a,"active"),"italic"==t.fontStyle?u.addClass(o,"active"):u.removeClass(o,"active")},y.prototype.updateXAxisRelatedDom=function(e){var t=e.xAxis[0];u.getElementById("xAxisLabel").checked=t.labels.enabled;var a=null==e.slant?"Auto":e.slant;l.zcombo("#slant","setValue",a),l.zcombo("#staggerLines","setValue","1"==e.staggerLines?"auto":e.staggerLines),u.getElementById("xReverseToggle").checked=t.reversed;var o=t.labels.style||{};l.zcombo("#xAxisLabelFont","setValue",o.fontSize||"12px"),l.zcolorselectbox("#chartAxisFontColor","setValue",o.color||"#2d2d2d");var r=u.getElementById("chartXAxisBold"),n=u.getElementById("chartAxisItalic");"bold"==o.fontWeight?u.addClass(r,"active"):u.removeClass(r,"active"),"italic"==o.fontStyle?u.addClass(n,"active"):u.removeClass(n,"active")},y.prototype.updateYAxisRelatedDom=function(e){var t,a=(new n.Utility.CommanAgent).pickIntegerFromString(l.zcombo("#yaxisMulti","getValue"));e.setActiveYIndex(a),(t=e.yAxis[e.getActiveYIndex()])&&this.updateYAxiesRelativeByAxiesObjectSP(t,e.getActiveYIndex())},y.prototype.updateMajorMinor=function(e){u.getElementById("majorGridLines").checked=e.majorGridLine,u.getElementById("minorGridLines").checked=e.minorGridLine},y.prototype.updateBackgroundColorDom=function(e){var t=e.getOptions().chart.backgroundColor||g,a=(new n.Model.ChartModel).getRGBA(t);l.zcolorselectbox("#chartcustomcolorDropDown1","setValue",a);var o=(new n.Model.ChartModel).getTransparency(e.getOptions().chart.backgroundColor);l.zslider("#caTransparency","setValue",o)},y.prototype.updateBorderColorDom=function(e){var t=e.getOptions().chart.borderColor||"#cccccc";l.zcolorselectbox("#borderColorDropDown","setValue",t)},y.prototype.updateGlColorDom=function(e){var t=e.getOptions().yAxis[0].gridLineColor||g,a=(new n.Model.ChartModel).getRGBA(t);l.zcolorselectbox("#chartcustomcolorDropDown3","setValue",a)},y.prototype.updateTheshold=function(e){var t=e.getThreshold(),a=u.getElementById("thresholdValue"),o=u.getElementById("thresholdToggle"),r=e.getStyleObject().colorObject.thresholdColor;null!=t&&void 0!==t&&(a.value=t),l.zcolorselectbox("#thrsholdColor","setValue",r),o.checked=null!=t&&void 0!==t},y.prototype.updateSidePanel=function(e){this.refreshDialogDom(e)},y.prototype.updateSidePanelAysc=function(e,l){return new Promise(function(i,d){var s=e.getType(),g=new n.Utility.CommanAgent,y=UserAction.getTemplate(["COL_ICON","XYLINE_SCATTER_SHAPES_ICON","GROUPEDCOL_ICON","GROUPEDBAR_ICON","STACKEDCOL_ICON","STACKEDCOL_PERCENT_ICON","BAR_ICON","STACKEDBAR_ICON","STACKEDBAR_PERCENT_ICON","XYLINE_ICON","SPLINE_ICON","STEPCHART_ICON","PIE_ICON","SEMIPIE_ICON","SEMIPIE_ICON","DOUGHNUT_ICON","SEMIDOUGHNUT_ICON","XYAREA_ICON","XYSTACKEDAREA_ICON","XYSTACKEDAREA_PERCENT_ICON","SCATTER_ICON","XYLINE_SCATTER_ICON","BUBBLE_ICON","TIMELINE_ICON","TIMEAREA_ICON","CANDLESTICK_ICON","OHLCCHART_ICON","POLAR_ICON","SPIDERWEB_ICON","BULLETCOL_ICON","BULLETBAR_ICON","COMBOCHART_ICON","WATERFALL_ICON","FUNNEL_ICON","PARETO_ICON","HISTOGRAM_ICON","ANIMATION_CHART_ICON","WORDCLOUD_ICON"]),h="BUBBLECHART"===s?"BUBBLE":s;-1!==h.indexOf("3D")&&(h=n.Utility.get3DMapping(s,!1)),-1!==h.indexOf("GROUPED")&&(h=g.getGroupedChartName(s));var C=y[h+"_ICON"],v=u.getElementById("chrtTypeLblValue"),I=u.getElementById("chartTypeSpan");e.isPivotChart?(u.getElementById("SP_CHART_PIVOT_WRAPPER").style.display="block",v=u.getElementById("pivotChrtTypeLblValue"),I=u.getElementById("pivotChartTypeSpan")):u.getElementById("SP_CHART_PIVOT_WRAPPER").style.display="none";v&&r.publish(o.UI,a.Names.SidePanel.CHARTS.UPDATE_ICON_THEME,{PARENT:v});var A=u.getElementById("pivotChartTypeWrapper");A&&r.publish(o.UI,a.Names.SidePanel.CHARTS.UPDATE_ICON_THEME,{PARENT:A}),u.addAttributes(v,{class:"spChrtTypeImg"}),s="BUBBLECHART"===s?"BUBBLE":s,v.innerHTML="",u.appendChild(v,C),I.innerText=c[s]||s,r.publish(o.UI,a.Names.SidePanel.CHARTS.UPDATE_ICON_THEME,{PARENT:v});var T=g.getRangePicker(p.DATA_RANGE);if(e.isPivotChart){u.getElementById("pivotChartTypes").querySelector("#"+s).checked=!0;var b=t.view.getActiveGridID(),E=t.view.getResourceID(b),B=t.view.getVersionID(b),S=t.data.getWorkBook(E,B).PivotCollection.get(e.pivotId)[m.TARGET],f=t.data.getWorkBook(E,B).getSheetObj(S[0]).Prop.Name;f=f?-1!==f.indexOf(" ")?"'"+f+"'":f:"";var O=new ZSClass.Range(S[1],S[2],S[3],S[4]);T.value=f+"."+O.getLabel()}else T.value=null!=e.getRange()&&""!==e.getRange()?e.getRange().trim():"";T.valueChanged(),"HORIZONTAL"===e.combinedRange&&(u.getElementById("horizontally").checked=!0),"VERTICAL"===e.combinedRange&&(u.getElementById("vertically").checked=!0);var L=-1==e.seriesIn.indexOf("COLS");L&&(u.getElementById("rowChart").checked=!0),!L&&(u.getElementById("columnChart").checked=!0),u.getElementById("firstRow").checked=e.frl,u.getElementById("firstColumn").checked=e.fcl;var x=e.yAxis.length;l.generateTitleOptions(x,s),l.updateTitleRelatedDom(e),l.updateChartFontFamily(e),l.updateDataLabelsDom(e),l.updateLegendRelatedDom(e),l.updateTrendlineRelatedDom(e),l.updateTooltipToggle(e),l.updateInvertedToggle(e),l.updateSplineToggle(e),l.updateAnimationToggle(e),l.updateHiddenCellToggle(e),l.updateMultiAxisToggle(e),l.updateAutoExpandToggle(e),l.resetColorDOMProperty(e.getStyleObject(),!0),l.updateXAxisRelatedDom(e),l.updateYAxisRelatedDom(e),l.updateMajorMinor(e),l.updateBackgroundColorDom(e),l.updateBorderColorDom(e),l.updateGlColorDom(e),l.updateDataLabelsTotal(e),l.updateTheshold(e),l.updateRaceChartOptions(e),l.updateCaptionOptions(e),n.Manager.SidePanelManager.TABEL_DEFINATION||n.Action.doDeclarativeTableCall(e),u.getElementById("c3DToggle").checked=-1!==s.indexOf("3D"),u.getElementById("binningInterval").value="",0!=e.getBinningInterval()&&(u.getElementById("binningInterval").value=e.getBinningInterval()),l.updateGradientStatus(e),setTimeout(function(){i()},10)})},y.prototype.updateAggFilterProperties=function(e){this.populateFilterColumns(e),"NONE"!==e.getFilterType()&&l.zcombo("#filterType","setValue",e.getFilterType()),"NONE"===e.getFilterType()&&l.zcombo("#filterType","setValue","TOP"),e.getFilterLimit()&&l.zspinner("#filterSpinner","setValue",e.getFilterLimit()),(!e.getFilterLimit()||e.getFilterLimit()<=0)&&l.zspinner("#filterSpinner","setValue",5),this.populateAggregationColumns(e)},y.prototype.updateGradientStatus=function(e){var t=n.Wrapper.DOMUtils,a=e.getGradient(),o=(a&&a.enabled&&a.ias,a&&a.enabled&&a.iab);t.getElementById("chartGradientReverse").checked=o||!1},y.prototype.populateFilterColumns=function(e){this.setFilterColumnBasedOnInput(e),e.isFilterEnabled()?this.openFilterTab():this.closeFilterTab()},y.prototype.rePopulateFilterColumns=function(e){var t=n.DecTable.getRangeDecTableMap(e.getRange());n.DecTable.populateFilterColumns(e,t)},y.prototype.rePopulateNumericColumns=function(e){var t=n.DecTable.getRangeDecTableMap(e.getRange());n.Aggregation.populateNumberColumns(e,t.getDepthIndices(),0)},y.prototype.setFilterColumnBasedOnInput=function(e){var t="",a=n.DecTable;e.setFilterColumnOnEnabled(),e.getFilterColumn()&&(t=a.constructRangeString(e.getFilterColumn())),!e.isFilterEnabled()&&"NONE"===t&&(t="noFilter"),""!==t&&l.zcombo("#filterColumns","setValue",t)},y.prototype.constructAggregationDom=function(e){var t=n.Wrapper.DOMUtils.getElementsByClassName("aggHldr"),a=e.getAggregationColHeaders().length;if(e.getAggregationEnabled()&&a>1&&t.length<a)for(var o=1;o<e.getAggregationColHeaders().length;o++)n.Aggregation.constructNewcombo(o)},y.prototype.populateAggregationColumns=function(e){for(var t=e.getAggregationColHeaders(),a=e.getAggregationNumericColumns(),o=n.Wrapper.DOMUtils,r=n.Manager.SidePanelManager,i=(o.getElementById("chartAggCombo0"),[]),d=[],s=(e.getAggregationDateOperations(),e.isAxisInAggregationAvailable()),p=0;p<t.length;p++)"Choose"!==e.getAggregationHeader(p)&&i.push(e.getAggregationHeader(p));for(p=0;p<a.length;p++)"Choose"!==e.getNumberColumn(p)&&d.push(e.getNumberColumn(p));t.length>0&&n.Aggregation.disableLabelCheckBox(e.getSeriesIn(),e.getFirstColAsLabel(),e.getFirstRowAsLabel()),n.Aggregation.setHeadersInAggregationDom(i,s,e),n.Aggregation.setNumbersInAggregationDom(d,e),n.Aggregation.hideShowDateOperations(e.getRange()),r.isCurrentActionOwner()||(e.getAggregationEnabled()&&l.zcombo("#aggreoperation","setValue",e.getAggregationOperation()),!e.getAggregationEnabled()&&l.zcombo("#aggreoperation","setValue","NONE")),r.resetCurrentActionOwner(),e.getAggregationEnabled()&&this.openAggregationTab()},y.prototype.openAggregationTab=function(){var e=n.Wrapper.DOMUtils.getElementById("chartAggregation");e.classList.add("selected"),e.checked=!0},y.prototype.closeAggregationTab=function(){var e=n.Wrapper.DOMUtils.getElementById("chartAggregation");e.classList.remove("selected"),e.checked=!1},y.prototype.isAggregationTabOpen=function(){return n.Wrapper.DOMUtils.getElementById("chartAggregation").checked},y.prototype.openFilterTab=function(){var e=n.Wrapper.DOMUtils.getElementById("chartFilter");e.classList.add("selected"),e.checked=!0},y.prototype.closeFilterTab=function(){var e=n.Wrapper.DOMUtils.getElementById("chartFilter");e.classList.remove("selected"),e.checked=!1},y.prototype.getDepthHeaderCombos=function(){var e=[],t=n.Wrapper.DOMUtils.getElementsByClassName("depthHeadersCombo");for(var a in t)"SELECT"===t[a].tagName&&e.push(t[a]);return e},y.prototype.getDateElemsCombos=function(){var e=[],t=n.Wrapper.DOMUtils.getElementsByClassName("dateCombo");for(var a in t)"SELECT"===t[a].tagName&&e.push(t[a]);return e},y.prototype.updateYAxiesRelativeByAxiesObject=function(e,t){var a=n.Wrapper.DOMUtils,o=(new n.Utility.CommanAgent,e.plotLines);this.generatePlotline(e,t),a.getElementById("yAxisLabel").checked=e.labels.enabled;for(var r=o&&o.length||0,l=0;l<r;l++)a.getElementById("PlotlineValue"+l).value=o[l].value||"";a.getElementById("min").value=e.min?e.min:"",a.getElementById("max").value=e.max?e.max:"",a.getElementById("interval").value=e.tickInterval?e.tickInterval:""},y.prototype.updateYAxiesRelativeByAxiesObjectSP=function(e,t){var a=n.Wrapper.DOMUtils,o=new n.Utility.CommanAgent,r=e.plotLines,i={display:"table-row"};this.generatePlotline(e,t),a.getElementById("yAxisLabel").checked=e.labels.enabled,a.getElementById("scaleCustomValue").value="";var d=r&&r.length||0;a.getElementById("plotlineToggle").checked=d>=1,a.hideById("plotlineCustomizationWrapper"),d>=1&&a.addStyle("plotlineCustomizationWrapper",{display:""});for(var s=0;s<d;s++)a.getElementById("PlotlineValue"+s).value=r[s].value||"",a.getElementById("PlotlineName"+s).value=r[s].label.text||"";a.getElementById("LogarthimicToggle").checked="logarithmic"===e.type,l.zspinner("#baseValue","setValue",e.baseValue),a.getElementById("min").value=e.min?e.min:"","logarithmic"===e.type?a.addStyle("baseValueWrapper",i):a.hideById("baseValueWrapper"),a.getElementById("max").value=e.max?e.max:"",a.getElementById("interval").value=e.tickInterval?e.tickInterval:"",a.hideById("scaleCustomWrapper");var p=n.Constants.ConversionType,c=e.conversionType||p.UNITS;c==p.UNITS?l.zcombo("#scaleType","setValue",e.unitFactor):c==p.SCALES&&("custom"===o.getScaleFactorConstant(e.scaleFactor)?(l.zcombo("#scaleType","setValue","custom"),a.addStyle("scaleCustomWrapper",i),e.scaleFactor&&(a.getElementById("scaleCustomValue").value=e.scaleFactor)):l.zcombo("#scaleType","setValue",e.scaleFactor));var g=n.Constants.NumberFormat,m=e.nfCode||g.DEFAULT;m=function(e){var t=n.Constants.UnitFormat,a=n.Constants.NumberFormat,o=e;switch(e){case t.THOUSANDS:case t.MILLIONS:case t.BILLIONS:o=a.DEFAULT}return o}.call(this,m),l.zcombo("#numberFormatType","setValue",m),a.hideById("zsCustomNubFormatWrapper"),g.CUSTOM==m&&(a.addStyle("zsCustomNubFormatWrapper",{display:"table-row"}),a.getElementById("prefixNumberFormat").value=e.prefix,a.getElementById("suffixNumberFormat").value=e.suffix);var u=e.labels.style||{};l.zcombo("#chartYAxisFontSize","setValue",u.fontSize||"12px"),l.zcolorselectbox("#chartYAxisFontColor","setValue",u.color||"#2d2d2d");var y=a.getElementById("chartYAxisBold"),h=a.getElementById("chartYAxisItalic");"bold"==u.fontWeight?a.addClass(y,"active"):a.removeClass(y,"active"),"italic"==u.fontStyle?a.addClass(h,"active"):a.removeClass(h,"active")},y.prototype.generateTitleOptions=function(e,t){var a=n.Wrapper.DOMUtils,o=new n.Utility.CommanAgent,r=a.getElementById("chartTitleCombo"),i=o.isFallUnderCompositionType(t)||o.isWordCloud(t),s=a.findByElementType("chartTitleCombo","OPTION").length,p=a.findByElementType("chartTitleCombo","OPTION");if(i)for(var c=2;c<s;c++)a.remove(p[c]),0;else{for(c=2;c<s;c++)a.remove(p[c]),0;var g=a.createElement("option",{id:"chartXAxisValue",value:"CHART_X_AXIES"});a.appendChild(r,g),a.getElementById("chartXAxisValue").innerText=d["ChartLayout.HorizontalAxisTitle"]}if(!i&&e>=1){var m=e;for(c=0;c<m;c++){if(0==c)g=a.createElement("option",{id:"LA",value:"LA"}),a.appendChild(r,g),a.getElementById("LA").innerText=d["ChartLayout.VerticalAxisTitle"];else{var u="RA"+c;g=a.createElement("option",{id:u,value:u,class:"RA"});a.appendChild(r,g),a.getElementById(u).innerText="Right Vertical Axis "+c}}}else if(!i&&s>4){c=4;for(var y=1;c<s;c++,y++){u="RA"+y;a.remove(u)}}l.zcombo("#chartTitleCombo","refresh")},y.prototype.showRecommendationDOM=function(){var e=n.Wrapper.DOMUtils;e.showById("chartRecommendTitle"),e.showById("chartRecommend")},y.prototype.hideRecommendationDOM=function(){var e=n.Wrapper.DOMUtils;e.hideById("chartRecommendTitle"),e.hideById("chartRecommend")},y.prototype.hidePropertyBasedOnMeta=function(e,t,a){var o=n.Wrapper.DOMUtils,r=new n.Utility.CommanAgent,i=new n.Utility.ChartAgent,d=o.getElementById("LogarthimicToggle").checked,s=l.zcombo("#scaleType","getValue"),p=e.getRange(),c={display:"table-row"},g={display:""};e.isPivotChart?o.hideById("combinedRangesWrapper"):null!=p&&""!==p&&p.split(";").length>1?o.addStyle("combinedRangesWrapper",c):o.hideById("combinedRangesWrapper");var m=e.getType(),u=e.getTrendline(),y=e.getTrendlineTypes();if(o.hideById("tredlineWrapper"),o.hideById("trendlineOrdr"),o.hideById("trendlinePeriod"),o.hideById("baseValueWrapper"),o.hideById("markerWrapper"),o.hideById("chart3DWrapper"),o.hideById("invertedWrapper"),o.hideById("splineWrapper"),o.hideById("scaleCustomWrapper"),o.hideById("binningIntervalWrapper"),o.hideById("raceChartAccordian"),o.hideById("captionAccordian"),o.hideById("totalDataLablsWrapper"),o.hideById("multipleYAxisWrapper"),r.isFallUnderStackedtype(m)&&o.addStyle("totalDataLablsWrapper",c),i.isMutipleAxiesChart(m)&&o.addStyle("multipleYAxisWrapper",c),o.hideById("thresholdWrapper"),i.isFallUnderThesholdSupportedTypes(m)&&o.addStyle("thresholdWrapper",g),o.hideById("chrtBanner"),e.isCellExceeded()&&!r.isAnimationChart(m)&&o.addStyle("chrtBanner",g),t){var h=o.getElementByClassName("chrtTabList").children;r.isFallUnderCompositionType(m)?(o.hide(h[3]),o.hideById("tredlineWrapper"),o.hideById("chrtThresholdWrapper"),o.hideById("zoomWrapper")):(o.show(h[3]),o.addStyle("tredlineWrapper",c),o.addStyle("chrtThresholdWrapper",c),o.addStyle("zoomWrapper",c)),o.hideById("trendlinePeriodWrapper"),o.hideById("trendlineDegreeWrapper")}else{r.isFallUnderCompositionType(m)?(o.hideById("xAxis"),o.hideById("yAxis"),o.hideById("majorMinorGridLines"),o.hideById("tredlineWrapper"),o.hideById("trendlineOrdr"),o.hideById("trendlinePeriod"),o.hideById("gridlinecolordom"),o.addStyle("aggregationDiv",g),o.addStyle("filterDiv",g),o.addStyle("chartBox",g),o.addStyle("seriesAccordion",g),o.addStyle("legendAccordian",g),o.addStyle("dataLabelsAccordian",g)):r.isWordCloud(m)?(o.hideById("xAxis"),o.hideById("yAxis"),o.hideById("majorMinorGridLines"),o.hideById("tredlineWrapper"),o.hideById("trendlineOrdr"),o.hideById("trendlinePeriod"),o.hideById("gridlinecolordom"),o.hideById("aggregationDiv"),o.hideById("filterDiv"),o.hideById("chartBox"),o.hideById("seriesAccordion"),o.hideById("dataLabelsAccordian"),o.hideById("legendAccordian")):r.isAnimationChart(m)?(o.hideById("aggregationDiv"),o.hideById("filterDiv"),o.addStyle("raceChartAccordian",g),o.addStyle("captionAccordian",g),o.hideById("animationWrapper"),o.hideById("legendAccordian"),o.hideById("seriesAccordion")):r.isHistogram(m)?(o.hideById("tredlineWrapper"),o.hideById("trendlineOrdr"),o.hideById("trendlinePeriod"),o.hideById("aggregationDiv"),o.hideById("filterDiv"),o.addStyle("xAxis",c),o.addStyle("yAxis",c),o.addStyle("chartBox",g),o.addStyle("seriesAccordion",g),o.addStyle("majorMinorGridLines",g),o.addStyle("gridlinecolordom",g),o.addStyle("binningIntervalWrapper",g),o.addStyle("legendAccordian",g),o.addStyle("dataLabelsAccordian",g)):(o.addStyle("xAxis",c),o.addStyle("yAxis",c),o.addStyle("majorMinorGridLines",g),o.addStyle("tredlineWrapper",c),o.addStyle("gridlinecolordom",g),o.addStyle("chartBox",g),o.addStyle("aggregationDiv",g),o.addStyle("filterDiv",g),o.addStyle("seriesAccordion",g),o.addStyle("legendAccordian",g),o.addStyle("dataLabelsAccordian",g),o.addStyle("animationWrapper",g)),r.isFallUnder3D(m)&&o.addStyle("chart3DWrapper",g),r.isInvertedPossible(m)&&o.addStyle("invertedWrapper",g),-1!=m.indexOf("AREA")&&o.addStyle("splineWrapper",g);var C=e.yAxis.length;void 0===a||133!=a&&107!=a||this.generateTitleOptions(C,m);var v=e.getComboChartTypes()||[];r.isFallUnderLineType(m)||r.isComboChartContainsLine(m,v)?(o.addStyle("markerWrapper",{display:""}),o.getElementById("markerToggle").checked=e.getMarkerState()):o.hideById("linemarkerDiv"),r.isGroupingAllowedInChart(m)&&e.getSeriesLength()>1?o.addStyle("groupDiv",c):o.hideById("groupDiv")}u&&(-1!==y.indexOf("Average")?o.addStyle("trendlinePeriodWrapper",c):-1!==y.indexOf("Polynomial")&&o.addStyle("trendlineDegreeWrapper",c),-1!==y.indexOf("average")?o.addStyle("trendlinePeriod",c):-1!==y.indexOf("polynomial")&&o.addStyle("trendlineOrdr",c),l.zcombo("#trendlineDegree","setValue",e.trendlineDegree),l.zspinner("#trendlinePeriod","setValue",e.trendlineDegree)),d&&o.addStyle("baseValueWrapper",g),"custom"===s&&o.addStyle("scaleCustomWrapper",c),e.getGroupingStatus()?(o.hideById("staggerWrapper"),o.hideById("slantWrapper")):(o.addStyle("slantWrapper",c),o.addStyle("staggerWrapper",c))},!n.Utility&&(n.Utility={}),n.Utility.AgentDom=y}(this);
!function(t){var e=t.ZSEvents,o=e.topic,r=e.Groups,i=e.Names,a=t.sPlusPlus,n=t.ZSChart;function l(){}l.prototype.constructChartPlayBack=function(t,e){for(var o="PLAYBACK"+t,r="#"+o+".playPause",i=[],a=document.querySelectorAll(".ZSOLEChart"),n=0;n<a.length;n++)a[n].id==t&&i.push(a[n]);for(var l=0;l<i.length;l++){var s=i[l];if(null==s.querySelector(r)){var u=UserAction.getTemplate([e]),d=(u=u&&u[e])&&u.children[0];d&&(d.id=o),d&&s&&(s.insertBefore(d,s.childNodes[0]),this.addEventsToPBOptions(s,t),this.addMouseMoveToChartDiv(s))}}},l.prototype.addEventsToPBOptions=function(t,e){var o="PLAYBACK"+e;this.addEventToPlay(t.querySelector("#"+o),e)},l.prototype.addEventToPlay=function(t,e){t&&t.addEventListener("click",function(t){var o=new n.Controller.ZSCController;if(n.Utility.getChartMeta([e],!0).chartMeta.isDataChanged)UserAction.updateChartOptions(e);else{var r=n.Utility.getPaused(e,0)||n.Utility.getPaused(e,1)||n.Utility.getPaused(e,2)||n.Utility.getPaused(e,3),i=n.Utility.getAnimating(e,0)||n.Utility.getAnimating(e,1)||n.Utility.getAnimating(e,2)||n.Utility.getAnimating(e,3);r?o.doResumeAction(e):i?o.doPauseAction(e):o.doReplay(e),t.stopPropagation()}})},l.prototype.addEventToPause=function(t,e){t&&t.addEventListener("click",function(t){(new n.Controller.ZSCController).doPauseAction()})},l.prototype.addMouseMoveToChartDiv=function(t){var e=this;t&&t.addEventListener("mousemove",function(o){new n.Controller.ZSCController;var r=n.Utility.getAnimating(t.id,0),i=n.Utility.getPaused(t.id,0);r||i?e.displayAndFadeOut(t.id):e.displayButton(t.id)})},l.prototype.handleMouseMove=function(t){new n.Controller.ZSCController;var e=n.Utility.getAnimating(t.id),o=n.Utility.getPaused(t.id);e||o?this.displayAndFadeOut(t.id):this.displayButton(t.id)},l.prototype.displayAndFadeOut=function(t){var e=this,o=n.Utility.getPlaybackFunction(t);o&&clearTimeout(o),this.displayButton(t);var r=setTimeout(function(){e.fadeOutButton(t)},n.Constants.Time);n.Utility.setPlaybackFunction(r,t)},l.prototype.addPauseClass=function(t){for(var e=[],o=document.querySelectorAll(".ZSOLEChart"),r=0;r<o.length;r++)o[r].id==t&&e.push(o[r]);for(var i=0;i<e.length;i++){var a=e[i].querySelector("#PLAYBACK"+t);a&&a.classList.remove("resume"),a&&a.classList.add("pause")}},l.prototype.addResumeClass=function(t){for(var e=[],o=document.querySelectorAll(".ZSOLEChart"),r=0;r<o.length;r++)o[r].id==t&&e.push(o[r]);for(var i=0;i<e.length;i++){var a=e[i].querySelector("#PLAYBACK"+t);a&&a.classList.add("resume"),a&&a.classList.remove("pause")}},l.prototype.removePauseResume=function(t){for(var e=[],o=document.querySelectorAll(".ZSOLEChart"),r=0;r<o.length;r++)o[r].id==t&&e.push(o[r]);for(var i=0;i<e.length;i++){var a=e[i].querySelector("#PLAYBACK"+t);a&&a.classList.remove("resume"),a&&a.classList.remove("pause")}},l.prototype.fadeOutButton=function(t){for(var e=[],o=document.querySelectorAll(".ZSOLEChart"),r=0;r<o.length;r++)o[r].id==t&&e.push(o[r]);for(var i=0;i<e.length;i++)e[i]&&e[i].classList.add("removePlay")},l.prototype.displayButton=function(t){var e=n.Utility.getPlaybackFunction(t);e&&clearTimeout(e);for(var o=[],r=document.querySelectorAll(".ZSOLEChart"),i=0;i<r.length;i++)r[i].id==t&&o.push(r[i]);for(var a=0;a<o.length;a++)o[a]&&o[a].classList.remove("removePlay")},n.Controller.PlayBackController=l,o.register(r.Listener,i.UserAction.CHARTS.UPDATE_OPTIONS,function(t){var e=t.chart.renderTo,o=a.view.getActiveGridID(),r=a.view.getResourceID(o),i=a.view.getSheetID(o),l=a.view.getVersionID(o),s=(a.view.getSheetState(o,i),a.data.getWorkBook(r,l).getSheetObj(i).Charts,n.Utility.getChartMeta([e],!0));s.chartMeta.isDataChanged=!1;var u=new n.Controller.ZSCController;u.stopChartAnimation(e),delete s.chartOptions,s.chartOptions=t,u.doReplay(e)},"CO")}(this);
!function(t){var i=t.Tick.prototype.addLabel;t._modules["parts/Utilities.js"].objectEach;t.Tick.prototype.addLabel=function(){var t,e=this.axis;return i.call(this),!(!e.categories||!(t=e.categories[this.pos]))&&(this.label&&(this.label.attr("text",this.axis.labelFormatter.call({axis:e,chart:e.chart,isFirst:this.isFirst,isLast:this.isLast,value:t.name,pos:this.pos})),this.label.textPxLength=this.label.getBBox().width),e.isGrouped&&e.options.labels.enabled&&this.addGroupedLabels(t),!0)}}(Highcharts),function(t){var i=t.defined,e=t.isNumber,s=t.pick,a=t.isArray,n=t.isString;t.Series.prototype.updateData=function(t){var s,a,n,o,r=this.options,h=this.points,c=[],l=this.requireSorting,p=t.length===h.length,d=!0,u=r.dataSorting;if(this.xIncrement=null,t.forEach(function(t,a){var n,d,g=u?t:i(t)&&this.pointClass.prototype.optionsToObject.call({series:this},t)||{};n=g.x,(g.id||e(n))&&(-1===(d=u?a:this.findPointIndex(g,o))||void 0===d||d>=h.length?c.push(t):h[d]&&t!==r.data[d]?(h[d].update(t,!1,null,!1),h[d].touched=!0,l&&(o=d+1)):h[d]&&(h[d].touched=!0),p&&a===d&&!this.hasDerivedData||(s=!0))},this),s)for(a=h.length;a--;)(n=h[a])&&!n.touched&&n.remove(!1);else p?t.forEach(function(t,i){h[i].update&&t!==h[i].y&&h[i].update(t,!1,null,!1)}):d=!1;return h.forEach(function(t){t&&(t.touched=!1)}),!!d&&(c.forEach(function(t){this.addPoint(t,!1,null,null,!1)},this),!0)},t.Series.prototype.setData=function(i,o,r,h){var c,l,p,d,u=this,g=u.points,O=g&&g.length||0,y=u.options,f=y.dataSorting,b=u.chart,x=null,m=u.xAxis,A=y.turboThreshold,v=this.xData,C=this.yData,j=u.pointArrayMap,D=j&&j.length,S=y.keys,T=0,k=1;if(c=(i=i||[]).length,o=s(o,!0),f&&f.enabled&&(i=this.sortData(i)),!1!==h&&c&&O&&!u.cropped&&!u.hasGroupedData&&u.visible&&!u.isSeriesBoosting&&(d=this.updateData(i)),!d){if(u.xIncrement=null,u.colorCounter=0,this.parallelArrays.forEach(function(t){u[t+"Data"].length=0}),A&&c>A){for(l=0;null===x&&l<c;)x=i[l],l++;if(e(x))for(l=0;l<c;l++)v[l]=this.autoIncrement(),C[l]=i[l];else if(a(x))if(D)for(l=0;l<c;l++)p=i[l],v[l]=p[0],C[l]=p.slice(1,D+1);else for(S&&(T=S.indexOf("x"),k=S.indexOf("y"),T=T>=0?T:0,k=k>=0?k:1),l=0;l<c;l++)p=i[l],v[l]=p[T],C[l]=p[k];else t.error(12,!1,b)}else for(l=0;l<c;l++)void 0!==i[l]&&(p={series:u},u.pointClass.prototype.applyOptions.apply(p,[i[l]]),u.updateParallelArrays(p,l));for(C&&n(C[0])&&t.error(14,!0,b),u.data=[],u.options.data=u.userOptions.data=i,l=O;l--;)g[l]&&g[l].destroy&&g[l].destroy();m&&(m.minRange=m.userMinRange),u.isDirty=b.isDirtyBox=!0,u.isDirtyData=!!g,r=!1}"point"===y.legendType&&(this.processData(),this.generatePoints()),o&&b.redraw(r)},t.Series.prototype.sortData=function(t){var e,s=this.options.dataSorting.order;return t.forEach(function(e,s){t[s]=i(e)&&this.pointClass.prototype.optionsToObject.call({series:this},e)||{}},this),e=t.slice(),"descending"===s?e.sort(function(t,i){return i.y-t.y}):e.sort(function(t,i){return t.y-i.y}),t.forEach(function(t){t.x=e.indexOf(t)}),t}}(Highcharts),function(t){let i={};t.wrap(t.Tooltip.prototype,"refresh",function(t){let e;e=Array.isArray(arguments[1])?arguments[1].map(t=>t.category+" "+t.series.name+": "+t.x+" "+t.y).join(", "):arguments[1].series.name;const s=this.chart.options.tooltip.delayForDisplay?this.chart.options.tooltip.delayForDisplay:1e3;i[e]&&(clearTimeout(i[e]),delete i[e]),i[e]=window.setTimeout(function(){this.refreshArguments[0]===this.chart.hoverPoint&&t.apply(this.tooltip,this.refreshArguments)}.bind({refreshArguments:Array.prototype.slice.call(arguments,1),chart:this.chart,tooltip:this}),s)})}(Highcharts),function(t){var i=t.ZSChart,e=t.sPlusPlus,s=(i.Manager,t.ZSEvents,t.document,i.Constants.ChartType,i.Constants.ServiceProvider,t.ZSDevTools.Logger),a=i.Controller.PlayBackController;function n(t,i,e,s,a,n,o,r,h,c,l,p,d,u,g,O,y,f,b){this.isStock=O||!1,this.chartId=t,this.caption=f,this.chartDetails=i,this.chartObject=e,this.colorOptions=s,this.xAxis=a,this.yAxis=n,this.series=o,this.title=r,this.subtitle=h,this.tooltip=c,this.plotOptions=l,this.legend=p,this.credits=d,this.decimalSeparator=g,this.thousandSeparator=u,this.responsive=null,this.lineStyles=y,this.animationNeeded=!0,b&&(this.dataForAnimationChart=b)}function o(t){return t.substring(t.indexOf("(")+1,t.indexOf(")")).split(",")}function r(t){var i=t[0],e=t[1],s=t[2],a=Math.max(i,e,s),n=Math.min(i,e,s),o=0;o=a===n?0:a===i?(60*((e-s)/(a-n))+360)%360:a===e?60*((s-i)/(a-n))+120:60*((i-e)/(a-n))+240,o/=360;var r=(a+n)/510,h=0;return h=a===n?0:r<=.5?(a-n)/(2*r):(a-n)/(2-2*r),[o,h/=255,r]}function h(t){return parseInt(t,16)}function c(t,i){if(3==(t=t.replace("#","")).length&&(t+=t),6!=t.length){if(!i)return"rgb(0, 0, 0)";t=i}var e="rgb(",s="",a=t.split("");for(var n in a){var o=a[n];if(s=!n%2?o:s+o,n%2){var r=h(s);isNaN(r)&&(r=0),e+=r,n<=4&&(e+=","),s=""}}return e+=")"}function l(){if(-1==this.options.chart.type.indexOf("wordcloud")){var t={},i={},e=r(this.options.chart&&this.options.chart.backgroundColor?this.options.chart.backgroundColor instanceof Object?-1!=this.options.chart.backgroundColor.stops[1][1].indexOf("#")?o(c(this.options.chart.backgroundColor.stops[1][1])):o(this.options.chart.backgroundColor.stops[1][1]):-1!=this.options.chart.backgroundColor.indexOf("#")?o(c(this.options.chart.backgroundColor)):o(this.options.chart.backgroundColor):[255,255,255])[2]>.5?"#000000":"#ffffff";i.lineColor=e,i.lineWidth=1,t.xAxis=i,this.update(t)}}function p(t){return t.title&&t.title.text&&""!=t.title.text.trim()}function d(t){return t.subtitle&&t.subtitle.text&&""!=t.subtitle.text.trim()}function u(t){return""!=t.xAxis.title.text.trim()}function g(t){return t.title&&t.title.text&&""!=t.title.text.trim()}function O(t){return t.labels.enabled}function y(t){switch(-1==t.chartObject.type.indexOf("bar")?(function(t){var i=p(t),e=d(t);2===t.chartDetails.legendPos?(t.chartObject.spacingTop=i||e?20:0,i&&(t.title.margin=e?0:5),e&&(t.title||(t.title={}))&&(t.title.margin=5)):(t.chartObject.spacingTop=i||e?20:30,i&&(t.title.margin=20),e&&(t.title||(t.title={}))&&(t.title.margin=20))}(t),function(t){for(var i=t.chartDetails.legendPos,e=!1,s=1;s<t.yAxis.length;s++){var a=g(t.yAxis[s]);if(O(t.yAxis[s]),a){e=!0;break}}(3===i||5===i||e)&&(t.chartObject.spacingRight=20)}(t),function(t){var i=g(t.yAxis[0]);O(t.yAxis[0]),4===t.chartDetails.legendPos?(t.chartObject.spacingLeft=20,i&&(t.yAxis[0].title.margin=20)):i&&(t.chartObject.spacingLeft=20,t.yAxis[0].title.margin=20)}(t),function(t){var i=u(t),e=function(t){return t.xAxis.labels.enabled}(t);1!=t.chartDetails.legendPos?i||e?!i&&e?t.chartObject.spacingBottom=20:i&&!e&&(t.chartObject.spacingBottom=20,t.xAxis.title.margin=10):t.chartObject.spacingBottom=30:i||e?!i&&e?t.chartObject.spacingBottom=10:i&&!e?t.chartObject.spacingBottom=10:i&&e&&(t.chartObject.spacingBottom=10):t.chartObject.spacingBottom=10}(t)):function(t){for(var i=t.chartDetails.legendPos,e=g(t.yAxis[0]),s=(O(t.yAxis[0]),u(t)),a=t.yAxis.length,n=p(t),o=d(t),r=!1,h=0;h<a;h++){var c=g(t.yAxis[h]);O(t.yAxis[h]),c&&(t.yAxis[h].title.margin=10,r=!0)}2===i?(t.chartObject.spacingTop=n||o?20:0,n&&(t.title.margin=o?0:5),o&&(t.title||(t.title={}))&&(t.title.margin=5)):(n||o||r)&&(t.chartObject.spacingTop=20),1!=i?e?e&&(t.chartObject.spacingBottom=20,t.yAxis[0].title.margin=10):t.chartObject.spacingBottom=30:t.chartObject.spacingBottom=10,4===i?(t.chartObject.spacingLeft=20,s&&(t.xAxis.title.margin=20)):s&&(t.chartObject.spacingLeft=20,t.xAxis.title.margin=20),3!==i&&5!==i||(t.chartObject.spacingRight=20)}(t),t.chartDetails.legendPos){case 0:case 1:case 2:case 3:case 4:break;case 5:var i=p(t)&&"right"==t.title.align,e=d(t)&&"right"==t.subtitle.align;i&&e?t.legend.y=50:(i||e)&&(t.legend.y=30)}}function f(t,e,s,n,o,r){if(t&&t.series&&t.series[0]){var h=t.series[0],c=(h.points,e[s].data);t.setCaption({text:e[s].name}),h.setName(e[s].name),h.setData(c),n&&function(t,e,s,n,o,r){var h;r=r||0,s<e.length&&(h=setTimeout(function(){f(t,e,s,n,o,r)},t.options.chart.animation.duration/2),i.Utility.setPauseIndex(s,o,r),i.Utility.setAnimatingFunction(h,o,r));if(s==e.length){f(t,e,e.length-1,!1),i.Utility.setAnimating(!1,o,r),i.Utility.setPaused(!1,o,r);var c=new a,l=i.Utility.getPlaybackFunction(o,r);l&&clearTimeout(l),c.addPauseClass(o,r),c.displayButton(o)}}(t,e,++s,n,o,r)}}n.prototype.getChartObject=function(){return this.chartObject},n.prototype.getChartDetails=function(){return this.chartDetails},n.prototype.getXAxis=function(){return this.xAxis},n.prototype.getYAxis=function(){return this.yAxis},n.prototype.getTitle=function(){return this.title},n.prototype.getSubTitle=function(){return this.subtitle},n.prototype.getSeriesObject=function(){return this.series},n.prototype.getDataLabel=function(){return this.plotOptions.series.dataLabels},n.prototype.init=function(t,i,e,s){this.setLocale(),this.filterProperties(),this.initColorOptions(),this.decodeOptionString(),this.parseOptionString(),this.initChartOptions(s),this.initTitleOptions(),this.initSubtitleOptions(),this.initLegendOptions(),this.initPlotOptions(i),this.initCaptionOptions(),this.initSeriesOptions(),this.initXAxisOptions(),this.initYAxisOptions(),this.initTooltipOptions(),this.applyGradient(),this.addNoDataSupport(),this.initLineStyles(),!t&&!e&&this.adjustChartItems()},n.prototype.addNoDataSupport=function(){var t,e,s,a;this.lang={noData:(t=i.Constants.Message,e=document.createElement("div"),s=document.createElement("span"),a=document.createElement("span"),s.classList.add("sPNoDataEmpLine"),a.classList.add("sPNoDataTxt"),a.innerText=t.NODATA||"No Chart Data",e.appendChild(s),e.appendChild(a),e.innerHTML)},this.noData={useHTML:!0,classList:["sPNoData"],style:{position:"absolute",left:0,right:0,bottom:0,top:0,background:"#fff"}}},n.prototype.setLocale=function(){(new i.Wrapper.ZSChart).setLocale(this.decimalSeparator||".",this.thousandSeparator||",")},n.prototype.show=function(t,i){var e;return!t&&(e=this.renderChart(void 0,void 0,void 0,i)),e},n.prototype.setDivContainerProperty=function(t,e,s,a,n,o,r,h,c,l,p,d){(new i.Utility.AgentDom).setDivContainerProperty(t,e,s,a,n,o,r,h,c,l,p,d)},n.prototype.setDivContainerSize=function(t,i){document.getElementById(this.chartId).style.height=t+"px",document.getElementById(this.chartId).style.width=i+"px"},n.prototype.setSeparatorOptions=function(){Highcharts.setOptions({lang:{decimalPoint:this.decimalSeparator,thousandsSep:this.thousandSeparator}})},n.prototype.constructAdditionalChartOptions=function(t){var e,s;if(t&&(e=t.forChartRecommendation||!1,s=t.forZIA||!1),this.chartObject&&this.chartDetails&&this.chartDetails.type&&-1==this.chartDetails.type.indexOf("SPIDERWEB")&&-1==this.chartDetails.type.indexOf("POLAR")&&-1==this.chartDetails.type.indexOf("ANIMATION_CHART")&&(this.chartObject.events||(this.chartObject.events={}),this.chartObject.events.load=function(){this.count=0,l.call(this)},this.chartObject.events.redraw=function(){0==this.count?(this.count++,l.call(this)):this.count>0&&(this.count=0)}),this.chartDetails.aggregation&&this.chartDetails.aggregation.enabled&&(-1!=this.chartObject.type.indexOf("column")||-1!=this.chartObject.type.indexOf("bar"))){if(this&&this.series&&1==this.series.length&&this.series[0]){var a={order:"descending",enabled:!0};this.series[0].dataSorting=a,this.xAxis.type="category";for(var n=this.series[0].data,o=this.xAxis.categories,r=0;r<o.length;r++)void 0!=n[r]&&(n[r].name=o[r]);delete this.xAxis.categories}}else if(this.chartDetails.aggregation&&!this.chartDetails.aggregation.enabled&&(-1!=this.chartObject.type.indexOf("column")||-1!=this.chartObject.type.indexOf("bar"))&&this&&this.series&&1==this.series.length&&this.series[0]){a={enabled:!1};this.series[0].dataSorting=a}if(-1!=this.chartDetails.type.indexOf("ANIMATION_CHART")){if(this.chartObject&&(this.chartObject.animation||(this.chartObject.animation={}),this.chartObject.animation.duration=this.chartObject.animation.duration?this.chartObject.animation.duration:200,this.xAxis&&this.xAxis.labels&&this.xAxis.labels.enabled)){n=this.dataForAnimationChart[0].data;var h,c=this.yAxis[0].labels.style.fontSize;h=i.Utility.findMargin(c,n),this.chartObject.marginLeft=h,this.chartObject.marginRight=40}if(this&&this.series&&this.series[0]){this.plotOptions.series.dataSorting||(this.plotOptions.series.dataSorting={})&&(this.plotOptions.series.dataSorting.enabled=!0)&&(this.plotOptions.series.dataSorting.order="descending"),this.xAxis.type="category",this.xAxis.min=0,this.xAxis.lineColor="#000";var p=this.dataForAnimationChart[0].data.length<10?this.dataForAnimationChart[0].data.length-1:9;void 0!=this.xAxis.max&&(p=this.dataForAnimationChart[0].data.length<=this.xAxis.max?this.dataForAnimationChart[0].data.length-1:this.xAxis.max),this.xAxis.max=p,this.xAxis.labels&&(this.xAxis.labels.overflow="justify")&&(this.xAxis.labels.animate=!0),this.yAxis[0]&&(this.yAxis[0]&&(this.yAxis[0].startOnTick=!1),this.yAxis[0]&&(this.yAxis[0].endOnTick=!1),this.yAxis[0].labels||(this.yAxis[0].labels={}),this.yAxis[0].labels.style||(this.yAxis[0].labels.style={})),"ascending"==this.plotOptions.series.dataSorting.order?(this.caption.verticalAlign="top",this.yAxis[0]&&(this.yAxis[0].opposite=!1)):(this.caption.verticalAlign="bottom",this.yAxis[0]&&(this.yAxis[0].opposite=!0)),this.legend&&(this.legend.enabled=!1,this.legend.symbolPadding=0,this.legend.symbolWidth=.001,this.legend.symbolHeight=.001,this.legend.symbolRadius=.001,this.legend.align="right",this.legend.verticalAlign="bottom",this.legend.floating=!0,delete this.legend.maxHeight,this.legend.itemStyle={},this.legend.itemStyle.fontSize="50px",this.legend.itemStyle.color="#999999",this.legend.itemHoverStyle=function(t){t.preventDefault()},this.plotOptions&&this.plotOptions.series&&this.plotOptions.series.events&&this.plotOptions.series.events.legendItemClick&&(this.plotOptions.series.events.legendItemClick=function(t){t.preventDefault()}))}this.chartObject&&(this.chartObject.spacingBottom=10,this.chartObject.spacingTop=30,this.chartObject.spacingLeft=30,this.chartObject.spacingRight=30),this.plotOptions&&(this.plotOptions.series||(this.plotOptions.series={}),this.plotOptions.series.dataLabels||(this.plotOptions.series.dataLabels={}),this.plotOptions.series.dataLabels.style||(this.plotOptions.series.dataLabels.style={}),this.plotOptions.bar.dataLabels.enabled=this.plotOptions.series.dataLabels.enabled,this.plotOptions.bar.dataLabels.crop=!0,this.plotOptions.bar.colorByPoint=!0)}if(this.plotOptions&&(this.plotOptions.series||(this.plotOptions.series={}),this.plotOptions.series.dataLabels||(this.plotOptions.series.dataLabels={}),this.plotOptions.series.dataLabels.style||(this.plotOptions.series.dataLabels.style={}),this.plotOptions[this.chartObject.type].dataLabels.enabled=this.plotOptions.series.dataLabels.enabled,this.plotOptions[this.chartObject.type].dataLabels.overflow="justify",this.plotOptions.series.marker&&this.plotOptions[this.chartObject.type].marker&&(this.plotOptions[this.chartObject.type].marker.enabled=this.plotOptions.series.marker.enabled)),-1==this.chartDetails.type.indexOf("3D")&&-1==this.chartDetails.type.indexOf("STACKEDCOL_PERCENT")&&-1==this.chartDetails.type.indexOf("BULLETCOL")&&-1==this.chartDetails.type.indexOf("BULLETBAR")&&-1==this.chartDetails.type.indexOf("STACKEDCOL")&&-1==this.chartDetails.type.indexOf("STACKEDBAR")&&-1==this.chartDetails.type.indexOf("STACKEDBAR_PERCENT")&&(-1!=this.chartDetails.type.indexOf("COL")||-1!=this.chartDetails.type.indexOf("ANIMATION_CHART")||-1!=this.chartDetails.type.indexOf("BAR")||-1!=this.chartDetails.type.indexOf("HISTOGRAM")||-1!=this.chartDetails.type.indexOf("PARETO")||-1!=this.chartDetails.type.indexOf("COMBO"))){var d=function(t){t.series.length;for(var i=0,e=0;e<t.series.length;e++)(!t.series[e].type||"column"==t.series[e].type)&&(i+=t.series[e].data.length);var s=t.chartObject.width||t.chartDetails.wd;"bar"===t.chartObject.type&&(s=t.chartObject.height||t.chartDetails.ht);var a=2,n=5-s/i/1.75/20+1;return a=n>5?5:n<1?1:n,a="NaN"!=(a=parseFloat(a).toFixed(2))?a:2,a+="%"}(this);this.plotOptions&&this.plotOptions.series&&(this.plotOptions.series.borderRadiusTopLeft=d)&&(this.plotOptions.series.borderRadiusTopRight=d)}if(this.plotOptions&&this.plotOptions[this.chartObject.type]&&(this.plotOptions[this.chartObject.type].crisp=!1),this.plotOptions&&this.plotOptions.series&&(this.plotOptions.series.crisp=!1),this.plotOptions.series.states||(this.plotOptions.series.states={}),this.plotOptions.series.states.inactive||(this.plotOptions.series.states.inactive={}),this.plotOptions.series.states.inactive.opacity=1,!e){if(this.chartObject){if(this.chartObject.style?this.chartObject.style.fontFamily||(this.chartObject.style.fontFamily="Lato"):(this.chartObject.style={})&&(this.chartObject.style.fontFamily="Lato"),this.chartObject.borderColor){var u=document.getElementById(this.chartId);if(u)u.parentElement.parentElement.style["outline-color"]=this.chartObject.borderColor,delete this.chartObject.borderColor,delete this.chartObject.borderWidth;else this.chartObject.borderWidth=1}"pie"!==this.chartObject.type&&"funnel"!==this.chartObject.type||this.plotOptions&&this.plotOptions[this.chartObject.type]&&this.plotOptions[this.chartObject.type].dataLabels&&(this.plotOptions[this.chartObject.type].dataLabels.distance=10),this.xAxis&&(this.xAxis.endOnTick=!1),"areaspline"!==this.chartObject.type&&"area"!==this.chartObject.type||(this.xAxis.startOnTick=!1,this.xAxis&&(this.xAxis.min=.5)&&(this.xAxis.categories&&0!=this.xAxis.categories.length?this.xAxis.max=this.xAxis.categories.length-1.5:0!=this.series.length&&(this.xAxis.max=this.series[0].data.length-1.5)),this.plotOptions&&this.plotOptions[this.chartObject.type]&&(this.plotOptions[this.chartObject.type].fillOpacity||(this.plotOptions[this.chartObject.type].fillOpacity=.5))),this.xAxis.tickWidth=this.chartDetails.grouping?1:0}this.xAxis&&this.xAxis.labels&&(this.xAxis.labels.overflow="justify"),-1==this.chartObject.type.indexOf("line")&&-1==this.chartObject.type.indexOf("scatter")||this.plotOptions&&this.plotOptions[this.chartObject.type]&&(this.plotOptions[this.chartObject.type].marker||(this.plotOptions[this.chartObject.type].marker={}))&&(this.plotOptions[this.chartObject.type].marker.radius=5)&&(this.plotOptions[this.chartObject.type].marker.symbol="circle"),-1!=this.chartDetails.type.indexOf("ANIMATION_CHART")?this.plotOptions&&this.plotOptions.series&&(this.plotOptions.series.pointPadding=.07)&&(this.plotOptions.series.groupPadding=.001):-1==this.chartObject.type.indexOf("histogram")&&(this.series.length>1&&(!this.chartObject.customChartType||"groupedChart"!=this.chartObject.customChartType)&&(this.plotOptions.series.groupPadding=.17),-1!=this.chartObject.type.indexOf("bar")?this.plotOptions&&this.plotOptions.series&&(this.plotOptions.series.pointPadding=.065):this.plotOptions&&this.plotOptions.series&&(this.plotOptions.series.pointPadding=.035)),this.legend&&(this.legend.itemMarginBottom=3);for(r=0;r<this.yAxis.length;r++)this.yAxis[r]&&(this.yAxis[r].maxPadding=0);s||y(this)}},n.prototype.constructChartOptions=function(t,i){return this.constructAdditionalChartOptions(i),{isStockChart:this.isStock,chart:this.chartObject,caption:this.caption,colors:this.colorTheme,xAxis:this.xAxis,yAxis:this.yAxis,series:this.series,title:this.title,subtitle:this.subtitle,tooltip:this.tooltip,plotOptions:this.plotOptions,legend:this.legend,credits:this.credits,lang:this.lang||{},noData:this.noData||{},responsive:t?null:this.responsive}},n.prototype.renderChart=function(t,s,n,o){var r=[];if(e&&e.view){var h=e.view.getActiveGridID(),c=e.view.getResourceID(h),l=e.view.getSheetID(h),p=e.view.getVersionID(h),d=(e.view.getSheetState(h,l),e.data.getWorkBook(c,p).getSheetObj(l));r.push(0);var u=d.Row&&d.Row.FreezedCount,g=d.Column&&d.Column.FreezedCount;u?g?r.push(1,2,3):r.push(2):g&&r.push(3)}var O=this.constructChartOptions(t,s),y=this.createNew(O);if(y&&y.setPositiveExtreme(!0),this.clearRegressionRender(),-1!=this.chartDetails.type.indexOf("ANIMATION_CHART")){var b=new a;b.constructChartPlayBack(this.chartId,"PLAYBACK_OPTIONS"),i.Utility.setCaptionTopCSS(this.chartId,O.plotOptions.series.dataSorting.order);var x=0==r.length||o in r;if(this.chartDetails.animate&&this.animationNeeded&&x){this.animationNeeded=!1;var m=i.Utility.getPlaybackFunction(this.chartId,o);m&&clearTimeout(m,o),b.removePauseResume(this.chartId);var A=this,v=setTimeout(function(){b.fadeOutButton(A.chartId)},i.Constants.Time);i.Utility.setPauseIndex(this.chartId,0,o),i.Utility.setPlaybackFunction(v,this.chartId,o),i.Utility.setAnimating(!0,this.chartId,o),f(y,this.dataForAnimationChart,0,!0,this.chartId,o)}}return y},n.prototype.addZoomBotton=function(t){return t.chart.resetZoomButton={},t.chart.resetZoomButton.theme={},t.chart.resetZoomButton.theme.states={},t.chart.resetZoomButton.theme.states.hover={fill:"#f0f0f0",stroke:"#DDDDDD"},!t.navigator&&(t.navigator={}),t.navigator.height=25,t},n.prototype.createNew=function(t,e){t=this.addZoomBotton(t);try{var a=new i.Wrapper.ZSChart;return e&&a.init(e),a.Chart(t)}catch(t){s.log("[Chart] Adapter throwing exception while constructing dom element",t)}},n.prototype.getId=function(){return this.chartDetails.id},n.prototype.showPreview=function(t){return this.renderChart(!0,t)},i.Model.ChartModel=n,i.Utility.refreshChart=f,i.Utility.stopAnimationFn=function(t,e){var s=i.Utility.getAnimatingFunction(t,e);s&&clearTimeout(s)},i.Utility.setAnimating=function(t,i,e){this.animating||(this.animating={}),this.animating[i]||(this.animating[i]={}),this.animating[i][e]=t},i.Utility.getAnimating=function(t,i){return this.animating&&this.animating[t]&&this.animating[t][i]||!1},i.Utility.setPaused=function(t,i,e){this.paused||(this.paused={}),this.paused[i]||(this.paused[i]={}),this.paused[i][e]=t},i.Utility.getPaused=function(t,i){return this.paused&&this.paused[t]&&this.paused[t][i]||!1},i.Utility.setAnimatingFunction=function(t,i,e){this.animatingFunction||(this.animatingFunction={}),this.animatingFunction[i]||(this.animatingFunction[i]={}),this.animatingFunction[i][e]=t},i.Utility.getAnimatingFunction=function(t,i){return this.animatingFunction&&this.animatingFunction[t]&&this.animatingFunction[t][i]||null},i.Utility.setPauseIndex=function(t,i,e){this.pauseIdxArr||(this.pauseIdxArr={}),this.pauseIdxArr[i]||(this.pauseIdxArr[i]={}),this.pauseIdxArr[i][e]=t},i.Utility.getPauseIndex=function(t,i){return this.pauseIdxArr&&this.pauseIdxArr[t]?this.pauseIdxArr[t][i]||0:null},i.Utility.setPlaybackFunction=function(t,i,e){this.playbackFunction||(this.playbackFunction={}),this.playbackFunction[i]||(this.playbackFunction[i]={}),this.playbackFunction[i][e]=t},i.Utility.getPlaybackFunction=function(t,i){return this.playbackFunction&&this.playbackFunction[t]&&this.playbackFunction[t][i]||null},i.Utility.setCaptionTopCSS=function(t,i){for(var e=[],s=document.querySelectorAll(".ZSOLEChart"),a=0;a<s.length;a++)s[a].id==t&&e.push(s[a]);for(var n=0;n<e.length;n++){var o=e[n];o&&("ascending"==i?o.classList.add("captionTop"):o.classList.remove("captionTop"))}},i.Utility.findMargin=function(t,i){var e=document.createElement("span");e.id="tempSpanEle",e.style.opacity=0,e.style.fontSize=t,document.body.append(e);for(var s=0,a=0;a<i.length;a++)e.textContent=i[a].name,s=Math.max(e.offsetWidth,s),i[a].name;return s+=40,s=Math.min(130,s),e.remove(),s},i.Utility.changeLineColor=function(t){if(-1==t.chart.type.indexOf("wordcloud")){var i=r(t.chart&&t.chart.backgroundColor?t.chart.backgroundColor instanceof Object?-1!=t.chart.backgroundColor.stops[1][1].indexOf("#")?o(c(t.chart.backgroundColor.stops[1][1])):o(t.chart.backgroundColor.stops[1][1]):-1!=t.chart.backgroundColor.indexOf("#")?o(c(t.chart.backgroundColor)):o(t.chart.backgroundColor):[255,255,255])[2]>.5?"#000000":"#ffffff";t.xAxis.lineColor=i,t.xAxis.lineWidth=1}}}(this);
!function(t,i){var e=ZSChart.Model.ChartModel.prototype,s=ZSChart.Constants.ChartType,o=t.ZSEC,h=ZSChart.Constants,n=i.Color,r=1;function a(t){if("object"==typeof t){var i=t.stops[0][1],e=t.stops[1][1];return n(i).brighten(r*h.GRADIENT_PERCENT).get("rgba")==e?i:e}return t}function l(t,i,e){return-1!==i.indexOf("radial")?function(t,i){return"string"!=typeof t?t:{radialGradient:{cx:.5,cy:.5,r:.25},stops:[[0,n(t).brighten(r*h.GRADIENT_PERCENT).get("rgba")],[1,t]]}}(t):function(t,i){return"string"!=typeof t?t:{linearGradient:{x1:0,y1:.95,x2:0,y2:.4},stops:[[0,n(t).brighten(r*h.GRADIENT_PERCENT).get("rgba")],[1,t]]}}(t)}function c(t){try{return ZSChart.Utility.getDecodeString(t)}catch(i){try{return unescape(decodeURI(t))}catch(i){try{return unescape(t)}catch(i){return t}}}}e.decodeOptionString=function(){this.title.text&&(this.title.text=o?o.Encoder.encodeForHTML(c(this.title.text)):c(this.title.text)),this.subtitle.text&&(this.subtitle.text=o?o.Encoder.encodeForHTML(c(this.subtitle.text)):c(this.subtitle.text)),this.xAxis.title&&this.xAxis.title.text?this.xAxis.title.text=o?o.Encoder.encodeForHTML(c(this.xAxis.title.text)):c(this.xAxis.title.text):this.xAxis[0]&&this.xAxis[0].title&&this.xAxis[0].title.text&&(this.xAxis[0].title.text=o?o.Encoder.encodeForHTML(c(this.xAxis[0].title.text)):c(this.xAxis[0].title.text));for(var t=0;t<this.yAxis.length;t++)this.yAxis[t].title&&this.yAxis[t].title.text&&(this.yAxis[t].title.text=o?o.Encoder.encodeForHTML(c(this.yAxis[t].title.text)):c(this.yAxis[t].title.text))},e.parseOptionString=function(){if(this.yAxis&&this.yAxis.length>=1)for(var t=0;t<this.yAxis.length;t++)this.yAxis[t].min&&(this.yAxis[t].min=parseFloat(this.yAxis[t].min)),this.yAxis[t].max&&(this.yAxis[t].max=parseFloat(this.yAxis[t].max)),this.yAxis[t].tickInterval&&(this.yAxis[t].tickInterval=parseFloat(this.yAxis[t].tickInterval))},e.initChartOptions=function(t){!t&&this.setChartSize(this.chartDetails.ht,this.chartDetails.wd),this.setChartSpacing(),this.setChartBackgroundColor(),this.setPlotBackgroundColor()},e.setPlotBackgroundColor=function(){this.chartObject.plotBackgroundColor=null},e.restoreDefaultSpacing=function(){this.chartObject.spacingTop=10,this.chartObject.spacingLeft=10,this.chartObject.spacingBottom=15,this.chartObject.spacingRight=10},e.initTitleOptions=function(){this.removeTitleOffset(),this.setOverflow(this.title.style);try{this.title.text=this.title.text}catch(t){}},e.initSubtitleOptions=function(){this.setOverflow(this.subtitle.style),this.subtitle.text=this.subtitle.text},e.initLegendOptions=function(){this.setLegendPosition(),this.setLegendStyle(),this.applySharedLegendForPie(),this.applySharedLegendForCombination()},e.initCaptionOptions=function(){!this.caption||this.caption.style&&0==Object.keys(this.caption.style).length?(this.caption||(this.caption={}),this.caption.style||(this.caption.style={}),this.caption.style.fontSize="56px",this.caption.style.fontWeight="bold",this.caption.style.fontStyle="normal",this.caption.style.color="#a9a9a9",this.caption.style.display="block"):(this.caption.style.fontSize||(this.caption.style.fontSize="56px"),this.caption.style.fontWeight||(this.caption.style.fontWeight="bold"),this.caption.style.fontStyle||(this.caption.style.fontStyle="normal"),this.caption.style.color||(this.caption.style.color="#a9a9a9"),this.caption.style.display||(this.caption.style.display="block"))},e.initPlotOptions=function(t){this.setDataLabel(),this.applyDataLabelStyle(),this.setLegend(),this.plotOptions.series.animation&&t&&(this.plotOptions[this.chartObject.type].animation=!1),this.plotOptions.series.animation&&t&&(this.plotOptions.series.animation=!1),this.plotOptions[this.chartObject.type].showInLegend=this.legend.enabled,!this.plotOptions.series.dataGrouping&&(this.plotOptions.series.dataGrouping={}),this.plotOptions.series.dataGrouping.enabled=!1,this.doSpecificHandling()},e.doSpecificHandling=function(){this.chartObject.type.toUpperCase()==s.BUBBLE.toUpperCase()&&(this.plotOptions[this.chartObject.type].marker.enabled=!0,this.plotOptions.series.marker.enabled=!0),this.chartObject.type.toUpperCase()==s.WORDCLOUD.toUpperCase()&&(this.legend.enabled=!1)},e.initSeriesOptions=function(){this.setDefaultColorIndex(),this.setPointColorIndex(),this.setGroupedChartProperty(),this.setBulletChartProperty(),this.updateWaterfallColor(),this.applyThreshold()},e.applyThreshold=function(){var t=this.plotOptions.series.threshold,i=this.chartDetails.type,e=this.colorOptions.thresholdColor;delete this.plotOptions.series.threshold,delete this.plotOptions.series.negativeColor,(new ZSChart.Utility.ChartAgent).isFallUnderThesholdSupportedTypes(i)&&void 0!==t&&null!=t&&(this.plotOptions.series.threshold=t,this.plotOptions.series.negativeColor=e)},e.initLineStyles=function(){try{for(var t=this.lineStyles,i=t?t.length:0,e=this.series,s=0;s<i;s++){var o=t[s];e[o.seriesIndex]?e[o.seriesIndex].dashStyle=o.lineStyleType:e[o.seriesIndex-e.length].regressionSettings&&(e[o.seriesIndex-e.length].regressionSettings.dashStyle=o.lineStyleType)}}catch(t){}},e.initColorOptions=function(){this.setColorScheme(this.chartDetails.type),"ANIMATION_CHART"!=this.chartDetails.type&&(this.applyRegressionColorIndex(),this.setColorOptions())},e.applyGradient=function(){try{var t=this.chartDetails.gradient,i=t&&t.enabled&&t.ias;if(t&&t.enabled&&(t.canvas||t.iab)&&(this.chartObject.backgroundColor=l(this.chartObject.backgroundColor||"#FFFFFF","radial",t.isReversed||t.cgReversed)),this.chartDetails.type==s.WORDCLOUD)return;if("ANIMATION_CHART"==this.chartDetails.type){for(var e=this.series[0].data,o=e?e.length:0,h=0;h<o;h++){var n=this.colorTheme[h%this.colorTheme.length],r=e[h];n&&i&&(n=l(n,t.gType||t.sgType,t.isReversed||t.sgReversed),r.borderWidth=1,r.borderColor=n,r.color=n)}if(this.colorOptions&&this.colorOptions.pointColors)for(var c=this.colorOptions.pointColors,p=0;p<c.length;p++)for(var d=c[p].points,x=c[p].sIndex,y=0;y<d.length;y++){var g=this.series[x].data,u=d[y].pIndex;g[u].borderColor=d[y].color,g[u].color=d[y].color}}else{var f=this.series;for(o=f?f.length:0,h=0;h<o;h++){var b=f[h].data,O=b?b.length:0,A=f[h].color||this.colorTheme[h%this.colorTheme.length],C=-1!==this.chartDetails.type.toUpperCase().indexOf(s.DOUGHNUT.toUpperCase())||this.chartDetails.type==s.PIE.toUpperCase()?"radial":t.gType||t.sgType;i&&(f[h].color=l(A,C,t.isReversed||t.sgReversed)),f[h].showInLegend=this.legend.enabled;for(p=0;p<O;p++){(r=b[p]).color&&i&&(r.color=l(r.color,t.gType||t.sgType,t.isReversed||t.sgReversed)),"ANIMATION_CHART"!=this.chartDetails.type&&(r.borderWidth=1,r.borderColor=this.chartDetails.type==s.HISTOGRAM||-1!==this.chartDetails.type.toUpperCase().indexOf(s.DOUGHNUT.toUpperCase())||-1!==this.chartDetails.type.toUpperCase().indexOf(s.SEMIPIE.toUpperCase())?this.getRGBA("#FFFFFF"):this.getRGBA(a(r.color||A)))}}}}catch(t){}},e.disableLabelsForWordCloud=function(){this.chartDetails.type===s.WORDCLOUD&&(this.xAxis[0]?(this.xAxis[0].tickWidth=0,this.xAxis[0].lineWidth=1,this.xAxis[0].labels.enabled=!1):this.xAxis&&(this.xAxis.tickWidth=0,this.xAxis.lineWidth=1,this.xAxis.labels.enabled=!1))},e.unEscapeTitleForXAxis=function(){this.xAxis[0]?this.xAxis[0].title.text=this.xAxis[0].title.text:this.xAxis&&(this.xAxis.title.text=this.xAxis.title.text)},e.unEscapeTitleForYAxis=function(){for(var t=this.yAxis.length,i=0;i<t;i++)this.yAxis[i].title.text=this.yAxis[i].title.text},e.initXAxisOptions=function(){this.formatXAxisLabel(),this.setGroupingOptions(),this.setAdvanceXAxisProperty(),this.disableLabelsForWordCloud(),this.unEscapeTitleForXAxis()},e.initYAxisOptions=function(){this.formatYAxisLabel(),this.unEscapeTitleForYAxis();var t=new ZSChart.Utility.ChartAgent;this.yAxis=t.applyGridLineColorForAllAxisObjects({yAxis:this.yAxis},this.yAxis[0].gridLineColor,this.yAxis[0].gridLineWidth).yAxis,this.yAxis=t.applySeriesColorToYAxisOnLoad(this.yAxis,this.series,this.chartDetails.isSingleYaxis),this.yAxis=t.applySeriesColorToPlotLinesOnLoad(this.yAxis,this.series),this.setDataLabelTotal()},e.setDataLabelTotal=function(){for(var t=this.yAxis.length,i=this.colorOptions.dataLabelsTotal||{},e=0;e<t;e++)this.yAxis[e].stackLabels={enabled:this.chartDetails.dlt,style:i}},e.initTooltipOptions=function(){this.chartDetails.type!=s.WORDCLOUD&&(this.formatTooltip(),this.tooltip.followTouchMove=!1,this.tooltip.useHTML=!1,this.tooltip.followPointer=!1)},e.adjustChartItems=function(){var t=this.getTextWidth;this.responsive={rules:[{condition:{callback:function(){var t=this.chartHeight,i=this.chartWidth;return t<300||i<300}},chartOptions:{plotOptions:{series:{dataLabels:{enabled:!1}}}}},{condition:{callback:function(){this.chartHeight;var i=this.chartWidth;if(!this.title)return i<100;var e=this.title.textStr,s=this.title.styles,o=this.options.chart.style?this.options.chart.style.fontFamily:null,h=t(e,o,s.fontSize,s.fontWeight,s.fontStyle);return i<Math.round(h.width)/2||i<100}},chartOptions:{title:{text:""}}},{condition:{callback:function(){this.chartHeight;var i=this.chartWidth;if(!this.subtitle)return i<200;var e=this.subtitle.textStr,s=this.subtitle.styles,o=this.options.chart.style?this.options.chart.style.fontFamily:null,h=t(e,o,s.fontSize,s.fontWeight,s.fontStyle);return i<Math.round(h.width)/2||i<100}},chartOptions:{subtitle:{text:""}}},{condition:{callback:function(){var t=this.chartHeight,i=this.chartWidth;if(!this.legend)return t<250||i<250;var e=this.options.chart.type;try{-1===e.indexOf(s.PIE)?this.series.length:this.series[0].data.length}catch(t){}if("vertical"===this.legend.options.layout){if(i<250)return!0}else if("horizontal"===this.legend.options.layout&&t<250)return!0;return!1}},chartOptions:{legend:{enabled:!1}}},{condition:{callback:function(){var t=this.chartWidth,i=(this.chartHeight,this.options.chart.type);return-1===i.indexOf(s.PIE)&&-1===i.indexOf(s.FUNNEL)&&t<350}},chartOptions:{yAxis:[{tickWidth:0,labels:{enabled:!1}}]}},{condition:{callback:function(){var t=this.chartWidth,i=this.chartHeight,e=this.options.chart.type;return-1===e.indexOf(s.BAR)&&-1===e.indexOf(s.PIE)&&-1===e.indexOf(s.FUNNEL)&&i<250||-1!==e.indexOf(s.BAR)&&t<200}},chartOptions:{xAxis:{tickWidth:0,labels:{enabled:!1}}}},{condition:{callback:function(){var i=this.yAxis[0].axisTitle;if(!i)return!1;var e=this.chartWidth,s=this.chartHeight,o=i.textStr,h=i.styles,n=this.options.chart.style?this.options.chart.style.fontFamily:null,r=t(o,n,h.fontSize,h.fontWeight,h.fontStyle);return!!(o&&o.length>0&&e<150&&s<Math.round(r.width))}},chartOptions:{yAxis:[{title:{text:""}}]}},{condition:{callback:function(){var i=this.xAxis[0].axisTitle;if(!i)return!1;var e=this.chartWidth,s=this.chartHeight,o=i.textStr,h=i.styles,n=this.options.chart.style?this.options.chart.style.fontFamily:null,r=t(o,n,h.fontSize,h.fontWeight,h.fontStyle);return!!(o&&o.length>0&&s<150&&e<Math.round(r.width))}},chartOptions:{xAxis:{title:{text:""}}}}]};var i=this.chartDetails.ht,e=this.chartDetails.wd,o=this.chartObject.type;i<250&&e<250&&o.indexOf(s.FUNNEL)&&(this.chartObject.marginRight=10)},e.disableZoom=function(){this.chartObject.zoomType="",this.chartObject.resetZoomButton={theme:{display:"none"}}},e.setChartSize=function(t,i){this.chartObject.reflow=!0,this.chartObject.height=t,this.chartObject.width=i,this.chartObject.zoomType=""},e.setChartSpacing=function(){-1!==this.chartObject.type.indexOf(s.PIE)||-1!==this.chartObject.type.indexOf(s.FUNNEL)?(this.chartObject.spacingLeft=this.chartObject.spacingTop=this.chartObject.spacingRight=10,this.chartObject.spacingBottom=15):(this.chartObject.spacingLeft=this.chartObject.spacingTop=this.chartObject.spacingRight=30,this.chartObject.spacingBottom=20)},e.setChartBackgroundColor=function(){var t=this.chartObject.type;-1!==t.indexOf(s.PIE)||-1!==t.indexOf(s.FUNNEL)||this.chartObject.polar?this.chartObject.plotBackgroundColor&&(this.chartObject.plotBackgroundColor=null):this.chartObject.plotBackgroundColor||(this.chartObject.plotBackgroundColor=this.chartObject.backgroundColor)},e.setLegendSymbol=function(){var t=this.legend;t.symbolHeight&&t.symbolWidth&&!t.symbolRadius&&(t.symbolRadius=0)},e.getMaximumSeriesLength=function(){for(var t,i=0,e=0;e<this.series.length;e++)this.series[e].data&&this.series[e].data.length>i&&(t=e,i=this.series[e].data.length);return[t,i]},ZSChart.Utility.getColorCodeFromGradient=a}(this,Highcharts);
!function(t){var e=t.ZSChart,s=e.Model.ChartModel.prototype;e.Constants.ChartType,e.Constants.MessageConstant;s.removeTitleOffset=function(){delete this.xAxis.title.offset},s.setOverflow=function(t){t.overflow="hidden",t.textOverflow="ellipsis"}}(this);
!function(e){var t=e.ZSChart,i=(e.sPlusPlus,t.Model.ChartModel.prototype),s=t.Constants.ChartType;t.Constants.MessageConstant;i.setLegendPosition=function(){0===this.chartDetails.legendPos?this.legend.enabled=!1:this.legend.enabled=!0,"horizontal"===this.legend.layout?this.legend.alignHorizontalToPlotArea=!0:"vertical"===this.legend.layout&&(this.legend.alignVerticalToPlotArea=!0)},i.setLegendStyle=function(){var e,t=this.legend.itemStyle?this.legend.itemStyle.color:null;t&&(this.legend.itemHoverStyle={color:this.getRGBA(t,"0.7")},this.legend.itemHiddenStyle={color:this.getRGBA(t,"0.5")}),this.legend=((e=this.legend).itemStyle||(e.itemStyle={}),e.itemStyle.fontWeight||(e.itemStyle.fontWeight="normal"),e.itemStyle.color||(e.itemStyle.color="#1D1D1D"),e)},i.applySharedLegendForPie=function(){var e=this.getMaximumSeriesLength(),i=e[0],r=e[1];if(this.rearrageColorForPie(r),1===this.series.length&&-1!==this.chartObject.type.indexOf(s.PIE)&&(this.plotOptions.pie.borderWidth=0),this.series.length>1&&-1!==this.chartObject.type.indexOf(s.PIE)){for(var n=0;n<this.series.length;n++)switch(i!==n&&(this.series[n].showInLegend=!1),n){case 1:2===this.series.length&&(this.series[n].size="70%",this.series[n].states={hover:{halo:{size:0}}});break;case 2:this.series[n].innerSize="55%",this.series[n].states={hover:{halo:{size:0}}};break;case 3:this.series[n].size="40%",this.series[n].states={hover:{halo:{size:0}}}}var o=this.applyPointVisibility;this.plotOptions.series.point={events:{legendItemClick:function(){var e=this.id,i=this.series.chart.renderTo.id;if(t.Mobile.isMobileView&&t.Mobile.isMobileView())var s=t.Mobile.getInstance();else s=(new t.Utility.ChartAgent).getChartMeta(i).getInstance();for(var r in s){var n=s[r].series;for(r=0;r<n.length;r++)for(var h=0;h<n[r].data.length;h++)o(n[r].data[h],e)}for(var r in s){s[r].redraw()}return!1}}}}},i.applySharedLegendForCombination=function(){if(-1!==this.chartObject.type.indexOf(s.LINE))for(var e=0;e<this.series.length;e++)this.series[e].showInLegend=this.plotOptions[this.chartObject.type].showInLegend},i.rearrageColorForPie=function(e){for(var t=0;t<this.series.length;t++)if(this.series[t].data&&this.series[t].data.length<e)for(var i=0;i<this.series[t].data.length;i++)this.series[t].data[i].color=this.colorTheme[(this.series[t].data[i].id-1)%this.colorTheme.length]},i.applyPointVisibility=function(e,t){e.id===t&&(e.visible?e.setVisible(!1,!1):e.setVisible(!0,!1))}}(this);
!function(t){var s=ZSChart.Model.ChartModel.prototype,i=ZSChart.Constants.ChartType;s.formatXAxisLabel=function(){var t=this.chartDetails.xAxisSymbol,s=this.chartObject.type;s!==i.SCATTER&&s!==i.BUBBLE||!t||(this.xAxis.labels.xAxisSymbol=t,this.xAxis.labels.formatter=function(){var s=this.value,i=t||"";return s<0?"%"==i?"- "+Math.abs(s)+i:i+"- "+Math.abs(s):"%"==i?this.value+i:i+this.value})},s.setAdvanceXAxisProperty=function(){this.xAxis.startOnTick=!0,this.xAxis.endOnTick=!0},s.setGroupingOptions=function(){this.xAxis.labels.groupedOptions=[];for(var t=0;t<=this.getGroupingDepth();t++)this.xAxis.labels.groupedOptions.push({rotation:0});var s=this.series&&this.series[0]&&this.series[0].hasOwnProperty("regressionSettings")?1:0;(this.chartDetails.grouping||this.xAxis&&this.xAxis.categories&&this.xAxis.categories[s]&&"object"==typeof this.xAxis.categories[s])&&this.getGroupingDepth()>=1&&(this.xAxis.tickmarkPlacement="between",this.xAxis.labels.step=1,-1!==this.chartObject.type.indexOf(i.BAR)?this.xAxis.labels.rotation=null:this.xAxis.labels.rotation=-90,delete this.xAxis.labels.staggerLines,this.chartObject.options3d&&this.chartObject.options3d.enabled&&-1===this.chartObject.type.indexOf(i.PIE)&&(this.chartObject.options3d.beta=0,this.chartObject.options3d.alpha=0))},s.getGroupingDepth=function(){var t,s=0,i=this.series&&this.series[0]&&this.series[0].hasOwnProperty("regressionSettings")?1:0,e=this.chartDetails.grouping;if(e||this.xAxis&&this.xAxis.categories&&this.xAxis.categories[i]&&"object"==typeof this.xAxis.categories[i])for(t=this.xAxis.categories[i],s=0;"object"==typeof t;s++)t=t.categories[0];else if(e||this.xAxis[0]&&this.xAxis[0].categories&&this.xAxis[0].categories[i]&&"object"==typeof this.xAxis[0].categories[i])for(t=this.xAxis[0].categories[i],s=0;"object"==typeof t;s++)t=t.categories[0];return s},s.formatYAxisLabel=function(){var t=this.chartDetails.currency,s=this.chartDetails.type;(new ZSChart.Utility.ChartAgent).getFormatLabels(this.yAxis,t,s,void 0,this.getConversionCode(),this.chartDetails.isSingleYaxis)},s.getConversionCode=function(){var t=ZSChart.Constants.ConversionType;return this.yAxis[0].conversionType||t.UNITS}}();
!function(t){var i,e=t.ZSChart,s=e.Model.ChartModel.prototype,r=e.Constants.ChartType;function h(){return(!e.Mobile.isMobileView||!e.Mobile.isMobileView())&&!!e.Utility.isContextMenuAlive()}s.formatTooltip=function(){var t=this.chartDetails.currency,s=(this.chartDetails.precision,this.chartDetails.type);if(s!==r.WORDCLOUD){var o=new e.Utility.ChartAgent;this.tooltip.enabled&&this.series&&this.series.length>=1&&(!this.chartObject.customChartType||-1===this.chartObject.customChartType.indexOf(r.BULLET)&&-1===this.chartObject.customChartType.indexOf(r.GROUPED)?-1===this.chartObject.type.indexOf(r.SCATTER)&&-1===this.chartObject.type.indexOf("ANIMATION_CHART")&&-1===this.chartObject.type.toUpperCase().indexOf(r.PARETO)&&-1===this.chartObject.type.indexOf(r.COLUMN)&&-1===this.chartObject.type.indexOf(r.BAR)&&-1===this.chartObject.type.indexOf(r.LINE)&&-1===this.chartObject.type.indexOf(r.AREA)&&-1===this.chartObject.type.indexOf(r.SPLINE)||!(this.xAxis.type&&-1===this.xAxis.type.indexOf("time")||void 0===this.xAxis.type||null==this.xAxis.type)?(this.chartObject&&-1!==this.chartObject.type.indexOf(r.PIE)||-1!==this.chartObject.type.indexOf(r.FUNNEL))&&(this.tooltip={backgroundColor:"#FFFFFF",shape:"square",enabled:!0,useHTML:!0,delayForDisplay:200,hideDelay:50,formatter:function(){if(h())return!1;var i,e=o.pickCurrency(t,this.series.index,s),r=this.point.decimals,a="";a+="<b>"+this.point.name+"</b>",a+="<br />",a+='<span style="color:'+this.point.color+'">●   </span><b>'+this.series.name+"</b>",i=parseFloat(this.y),i=Highcharts.numberFormat(Math.abs(i),r),a+="<b>: </b>",this.y<0&&(a+="-");var n;return a+="<b>"+((n=e||"")&&"%"!==n?n:"")+"</b>"+i+"<b>"+(n&&"%"===n?n:"")+"</b><br />"}}):(this.tooltip.currency=this.chartDetails.currency,this.tooltip.hasRegression=this.series&&this.series[0].hasOwnProperty("regressionSettings"),this.tooltip.chartType=this.chartObject.type,this.tooltip.borderColor=null,this.tooltip.useHTML=!0,this.tooltip.delayForDisplay=200,this.tooltip.hideDelay=50,this.tooltip.formatter=function(){if(h())return!1;var e,a="",n=o.pickCurrency(t,this.series.index,s),c=this.point.decimals,l=this.series.tooltipOptions.chartType,p=this.color||this.series.color;return this.series.tooltipOptions.hasRegression?(a+="<b>"+this.series.name+"</b>",e=parseFloat(this.y),e=Highcharts.numberFormat(Math.abs(e),c),-1!==l.indexOf(r.SCATTER)?(a+="<b><br> x : </b>",this.x<0&&(a+="-"),a+=Highcharts.numberFormat(Math.abs(parseFloat(this.x)),c),a+="<b><br> y : </b>"):a+="<b>: </b>",this.y<0&&(a+="-"),n&&"%"!==n&&(a+=n),a+=e+"<br>"):(a+='<span style="color:'+p+'">●</span> <b>'+this.series.name+"</b>",i=this.series.tooltipOptions.valueSuffix||"",e=parseFloat(this.y),e=Highcharts.numberFormat(Math.abs(e),c),-1!==l.indexOf(r.SCATTER)?(a+="<br><b> x : </b>",this.x<0&&(a+="-"),a+=Highcharts.numberFormat(Math.abs(parseFloat(this.x)),c),a+="<br> y : "):a+="<b>: </b>",this.y<0&&(a+="-"),n&&"%"!==n&&(a+=n),a+=e,a+=i+"<br>"),a}):(this.tooltip.shared=!0,this.tooltip.borderColor=null,this.tooltip.currency=this.chartDetails.currency,this.tooltip.useHTML=!0,this.tooltip.delayForDisplay=200,this.tooltip.hideDelay=50,this.tooltip.pointFormatter=function(){if(h())return!1;var e=o.pickCurrency(t,this.series.index,s),r="",a=this.decimals;r+='<span style="color:'+(this.color||this.series.color)+'">●   </span> <b>'+this.series.name,i=this.series.tooltipOptions.valueSuffix||"";var n=parseFloat(this.y);return n=Highcharts.numberFormat(Math.abs(n),a),r+=": </b>",this.y<0&&(r+="-"),e&&"%"!==e&&(r+="<b>"+e+"</b>"),r+="<b>"+n+"</b>",r+=i+"<br>"}))}}}(this);
!function(t){var e=t.ZSChart,s=e.Model.ChartModel.prototype,a=e.Constants.ChartType;e.Constants.MessageConstant;s.setLegend=function(){var t,e,s,a=!0;switch(this.chartDetails.legendPos){case"Top":case 2:t="horizontal",e="center",s="top";break;case"Bottom":case 1:t="horizontal",e="center",s="bottom";break;case"Left":case 4:t="vertical",e="left",s="middle";break;case"Right":case 3:t="vertical",e="right",s="middle";break;case"TopRight":case 5:t="vertical",e="right",s="top";break;case"None":case 0:a=!1}t&&(this.legend.layout=t),e&&(this.legend.align=e),s&&(this.legend.verticalAlign=s),this.legend.maxHeight="bottom"!==s&&"top"!==s||"vertical"===t?"":55,this.legend.y=0,this.legend.symbolHeight=10,this.legend.symbolWidth=10,this.legend.borderWidth=0,this.legend.enabled=a},s.setDataLabel=function(){var t=this.chartDetails.lf,s=this.chartDetails.currency,i=(this.chartDetails.precision,this.decimalSeparator,this.thousandSeparator,this.chartObject.type),r=this.chartDetails.type,n=new e.Utility.ChartAgent,h=this.colorOptions.dataLabels||{};switch(t){case"N":this.plotOptions.series.dataLabels={enabled:!1};break;case"V":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},currencySymbol:s,formatter:function(){var t=n.pickCurrency(s,this.series.index,r),e=this.point.decimals;return this.y>=0?"%"===t?Highcharts.numberFormat(this.y,e)+t:t+Highcharts.numberFormat(this.y,e):"%"===t?"-"+Highcharts.numberFormat(Math.abs(this.y),e)+t:"-"+t+Highcharts.numberFormat(Math.abs(this.y),e)}};break;case"L":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.key}};break;case"S":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.series.name}};break;case"P":(-1!==i.indexOf(a.FUNNEL)||-1!==i.indexOf(a.PIE)||this.plotOptions.series.stacking&&(-1!==this.plotOptions.series.stacking.indexOf("normal")||-1!==this.plotOptions.series.stacking.indexOf("percent")))&&(this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return Highcharts.numberFormat(this.percentage,2)+"%"}});break;case"L_P":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.key?this.key+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"S_V":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},currencySymbol:s,formatter:function(){var t=n.pickCurrency(s,this.series.index,r),e=this.point.decimals;return this.y>=0?"%"===t?this.series.name+" ("+Highcharts.numberFormat(this.y,e)+t+")":this.series.name+" ("+t+Highcharts.numberFormat(this.y,e)+")":"%"===t?"-"+Highcharts.numberFormat(Math.abs(this.y),e)+t:this.series.name+" (-"+t+Highcharts.numberFormat(Math.abs(this.y),e)+")"}};break;case"L_V":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},currencySymbol:s,formatter:function(){var t=n.pickCurrency(s,this.series.index,r),e=this.point.decimals;return this.y>=0?"%"===t?this.key+" ("+Highcharts.numberFormat(this.y,e)+t+")":this.key+" ("+t+Highcharts.numberFormat(this.y,e)+")":"%"===t?"-"+Highcharts.numberFormat(Math.abs(this.y),e)+t:this.key+" (-"+t+Highcharts.numberFormat(Math.abs(this.y),e)+")"}};break;case"S_P":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.series.name?this.series.name+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"V_P":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.y?this.y+" ("+Highcharts.numberFormat(this.percentage,2)+"%)":"("+Highcharts.numberFormat(this.percentage,2)+"%)"}};break;case"B":this.plotOptions.series.dataLabels={enabled:!0,style:{fontWeight:"normal"},formatter:function(){return this.point.z}};break;default:this.plotOptions.series.dataLabels={enabled:!1}}this.plotOptions.series.dataLabels.style=h,this.plotOptions.series.dataLabels.style.textOutline=0},s.applyDataLabelStyle=function(){var t=this.plotOptions.series.dataLabels;-1!==this.chartObject.type.indexOf(a.FUNNEL)&&(this.chartObject.marginRight=10),-1!==this.chartObject.type.indexOf(a.PIE)&&this.series.length>1&&this.series[0].hasOwnProperty("innerSize")&&t&&t.enabled&&(t.connectorColor="#000000")}}(this);
!function(e){var t=ZSChart.Model.ChartModel.prototype,s=ZSChart.Constants.ChartType;t.setDefaultColorIndex=function(){var e=this.chartObject.type;if(-1===e.indexOf(s.WATERFALL)&&this.series&&this.series.length>=1)if(-1!==e.indexOf(s.PIE)||-1!==e.indexOf(s.FUNNEL))for(var t=0;t<this.series.length;t++)for(var i=0;i<this.series[t].data.length;i++)this.series[t].data[i].color||(this.series[t].data[i].color=this.colorTheme[i%this.colorTheme.length]);else for(t=0;t<this.series.length;t++)this.series[t].color||(this.series[t].color=this.colorTheme[t%this.colorTheme.length])},t.setPointColorIndex=function(){var e=this.colorOptions,t=e&&e.pointColors?e.pointColors:null;if(t)for(var s=Object.keys(t),i=0;i<s.length;i++)for(var r=t[s[i]],h=0;h<r.length;h++){var o=r[h],n=o.pIndex,c=o.sIndex,l=o.color;this.series[c].data[n].color=l}},t.applyCustomizationToPlotLines=function(){for(var e=this.series,t=this.yAxis,s=0;s<t.length;s++)if(this.yAxis[s]&&this.yAxis[s].plotLines)for(var i=this.yAxis[s].plotLines,r=0;r<i.length;r++)this.yAxis[s].plotLines[r].isPlColorChanged||(this.yAxis[s].plotLines[r].color=e[s].color?e[s].color:"")},t.setGroupedChartProperty=function(){var e=this.chartObject.customChartType;if(e&&-1!==e.indexOf(s.GROUPED)){this.plotOptions[this.chartObject.type].grouping=!1,this.plotOptions[this.chartObject.type].groupPadding=0;for(var t=2===this.series.length?.3:.1,i=0;i<this.series.length;i++)this.series[i].pointPadding=t,t+=.1}},t.setBulletChartProperty=function(){if(this.chartObject.customChartType&&-1!==this.chartObject.customChartType.indexOf(s.BULLET)){var e,t,i=Math.max(0,this.series.length-2),r=.9,h=this.colorTheme,o=this.colorOptions.colorTheme,n=this.series.length-i;i>0&&-1===o.name.indexOf("COLORFUL")&&(e=this.generateColorTheme(h[2],i,!1,!1,!0),t=h.slice(0,2),o.isReversed&&(e=e.reverse(),t=t.reverse()),e=e.concat(t),this.colorTheme=e);for(var c=this.plotOptions[this.chartObject.type].showInLegend,l=0;l<this.series.length;l++)delete this.series[l].maxPointWidth,this.series[l].pointPadding=.2,this.series[l].color=this.colorTheme[l],r<0&&(r=.9),r-=.2,l<i?(this.series[l].stacking=!1,this.series[l].grouping=!1,this.series[l].zIndex=--n):l==i?(this.series[l].pointPadding=.4,this.series[l].showInLegend=c,this.series[l].zIndex=l):l>i&&(this.series[l].type="boxplot",this.series[l].pointPadding=.3,this.series[l].zIndex=l,this.plotOptions.boxplot={lineWidth:3,medianWidth:0,stemWidth:0,whiskerWidth:0,showInLegend:c})}},t.updateWaterfallColor=function(){this.series.length>=1&&-1!==this.chartObject.type.indexOf(s.WATERFALL)&&(this.series[0].upColor=this.colorTheme[0],this.series[0].color=this.colorTheme[1])},t.applyRegressionColorIndex=function(){if((-1!==this.chartObject.type.indexOf(s.SCATTER)||-1!==this.chartObject.type.indexOf(s.COLUMN)||-1!==this.chartObject.type.indexOf(s.BAR)||-1!==this.chartObject.type.indexOf(s.LINE)||-1!==this.chartObject.type.indexOf(s.SPLINE)||-1!==this.chartObject.type.indexOf(s.AREA))&&this.series.length>0&&this.series[this.series.length-1].hasOwnProperty("regressionSettings"))for(var e=0;e<this.series.length;e++)this.series[e].regressionSettings.color=this.colorTheme[e%this.colorTheme.length],this.series[e].regressionSettings.showInLegend=this.plotOptions[this.chartObject.type].showInLegend},t.clearRegressionRender=function(){if((-1!==this.chartObject.type.indexOf(s.SCATTER)||-1!==this.chartObject.type.indexOf(s.COLUMN)||-1!==this.chartObject.type.indexOf(s.BAR)||-1!==this.chartObject.type.indexOf(s.LINE)||-1!==this.chartObject.type.indexOf(s.SPLINE)||-1!==this.chartObject.type.indexOf(s.AREA))&&this.series.length>0&&this.series[this.series.length-1].hasOwnProperty("regressionSettings"))for(var e=0;e<this.series.length;e++)this.series[e].rendered&&(this.series[e].rendered=!1)}}();
!function(t){var e=ZSChart.Model.ChartModel.prototype;ZSChart.Constants.ChartType;e.setColorScheme=function(t){var e=this.colorOptions.colorTheme,r=e.basecolor,o=e.name,s=e.isReversed,i=new ZSChart.Utility.ChartAgent,h={};h.chart=this.chartObject,h.series=this.series,h=i.getColorSchemenColors(h,r,o,s,t),this.colorTheme=h.colors},e.getMaxColorLength=function(){var t=new ZSChart.Utility.ChartAgent,e={};return e.chart=this.chartObject,e.series=this.series,t.getMaxColorLength(e)},e.generateColorTheme=function(t,e,r,o,s){return(new ZSChart.Utility.ChartAgent).generateColorTheme(t,e,r,o,s)},e.setColorOptions=function(){var t=this.chartDetails.type;this.colorOptions;return(new ZSChart.Utility.ChartAgent).setColorOptions(t,this.colorOptions,this.series)}}();
!function(t){var e=ZSChart.Model.ChartModel.prototype;e.getTextWidth=function(t,e,r,i,n){var a=document.createElement("canvas").getContext("2d"),s=r+" "+(e=e||"Lato");return i&&(s=i+" "+s),n&&(s=n+" "+s),a.font=s,a.measureText(t)},e.getRGBA=function(t,e){if(null==t||void 0===t||-1!==t.indexOf("transparent"))return t;var r,i,n;if("#"===t.charAt(0)){var a=t.slice(1);r=this.hexToInt(a.slice(0,2)),i=this.hexToInt(a.slice(2,4)),n=this.hexToInt(a.slice(4,6))}else if("rgb("===t.slice(0,4)||"rgba"===t.slice(0,4)){var s=t.split("(")[1].split(")")[0].split(",");r=s[0],i=s[1],n=s[2],s[3]}if(void 0!==e&&null!==e)return"rgba("+r+","+i+","+n+","+e+")";return"rgb("+r+","+i+","+n+")"},e.getTransparency=function(t){if(null==t||void 0===t||-1!==t.indexOf("transparent"))return 0;var e;if("rgb("===t.slice(0,4)||"#"===t.charAt(0))return 0;if("rgba"===t.slice(0,4)){var r=t.split("(")[1].split(")")[0].split(",");r[0],r[1],r[2],e=r[3]}return 100-100*parseFloat(e)},e.getTransparencyQuotient=function(t){if(null==t||void 0===t||-1!==t.indexOf("transparent"))return 0;var e;if("rgb("===t.slice(0,4)||"#"===t.charAt(0))return 1;if("rgba"===t.slice(0,4)){var r=t.split("(")[1].split(")")[0].split(",");r[0],r[1],r[2],e=r[3]}return e},e.filterProperties=function(){var t=new ZSChart.Utility.ChartAgent;this.chartDetails.currency=t.filterCurrency(this.chartDetails.currency,this.getSeriesObject()?this.getSeriesObject().length:0)},e.hexToInt=function(t){return parseInt(t,16)}}();
!function(t,e){var i=t.ZSChart,n=i.Constants.ChartType,a=i.Constants.CAConstant;function s(t){return t=t.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\(("|&quot;)(\S+)("|&quot;)\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (|NS[0-9]+\:)href=/g," xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g," ").replace(/&shy;/g,"­")}i.transient[a.EXTENDING_NODATA_SUPPORT]=function(t){var e=t.seriesTypes,i=t.Chart.prototype,n=t.getOptions(),a=t.extend,s=t.each;a(n.lang,{noData:"No data to display"}),n.noData={position:{x:0,y:0,align:"center",verticalAlign:"middle"}},n.noData.style={fontWeight:"bold",fontSize:"12px",color:"#666666"},s(["bubble","gauge","heatmap","pie","sankey","treemap"],function(t){e[t]&&(e[t].prototype.hasData=function(){return!!this.points&&!!this.points.length})}),t.Series.prototype.hasData=function(){return void 0!==this.dataMax&&void 0!==this.dataMin},i.showNoData=function(t){var e=this.options,i=t||e&&e.lang.noData?e.lang.noData:"",n=e&&e.noData;if(this.noDataLabel&&this.noDataLabel.align(),!this.noDataLabel){var a=this.ZSCDrawing();this.noDataLabel=a.label(i,"no-data",!0),this.noDataLabel.attr(n.attr),this.noDataLabel.css(n.style),this.noDataLabel.class(n.classList,!1),this.noDataLabel.add(!1,!0),this.noDataLabel.align()}},i.hideNoData=function(){this.noDataLabel&&(this.noDataLabel=this.noDataLabel.destroy())},i.hasData=function(){for(var t=this.series||[],e=t.length;e--;)if(t[e].hasData()&&!t[e].options.isInternal)return!0;return this.loadingShown}},i.transient[a.EXTENDING_LEGEND_ITEM]=function(t){t.Legend.prototype.getAllItems=function(){var e=[],i=t.each;t.pick,t.defined,i(this.chart.series,function(t){var i=t&&t.options;t&&i.showInLegend&&(e=e.concat(t.legendItems||("point"===i.legendType?t.data:t)))});var n=[];return i(e,function(t){!t.series||-1===t.series.chart.options.chart.type.indexOf("pie")&&-1===t.series.chart.options.chart.type.indexOf("funnel")?n.push(t):t.y&&n.push(t)}),n}},i.transient[a.EXTENDING_SERIES_TYPE]=function(t){t.wrap(Highcharts.seriesTypes.column.prototype,"init",function(t){if(t.apply(this,[].slice.call(arguments,1)),this.chart.is3d()){var e=this.options,i=e.grouping,n=e.stacking,a=this.yAxis.options.reversedStacks,s=0;if(void 0===i||i){var o,r=this.chart.retrieveStacks(n),h=e.stack||0;for(o=0;o<r[h].series.length&&r[h].series[o]!==this;o++);s=10*r.totalStacks-10*(r.totalStacks-r[h].position)-(a?o:-o)}e.zIndex=s}})},i.transient[a.EXTENDING_LEGEND]=function(t){t.wrap(t.Legend.prototype,"render",function(t){if(this.options.alignHorizontalToPlotArea){var e=this.chart;this.options.itemStyle.width=e.plotWidth-this.options.symbolWidth-this.options.symbolPadding-this.padding,this.options.itemStyle.overflow="hidden",this.options.itemStyle.textOverflow="ellipsis"}else this.options.alignVerticalToPlotArea&&(e=this.chart,this.options.itemStyle.width=.2*e.chartWidth,this.options.itemStyle.overflow="hidden",this.options.itemStyle.textOverflow="ellipsis","right"===this.options.align&&"top"===this.options.verticalAlign&&-1!==e.userOptions.chart.type.indexOf(n.FUNNEL)&&(this.options.y=e.plotTop+e.options.chart.spacingTop));t.call(this)})},i.transient[a.EXTENDING_POINTER]=function(t){t.wrap(t.Pointer.prototype,"normalize",function(t,e){var i,n=t.call(this,e),a=this.chart.container.parentNode;return""!==a.style.zoom&&(i=parseFloat(a.style.zoom,10),n.chartX/=i,n.chartY/=i),n})},i.transient[a.EXTENDING_TOOLTIP]=function(t){t.wrap(t.Tooltip.prototype,"refresh",function(t,e,i){t.call(this,e,i),this.hide(3e3)})},i.transient[a.EXTENDING_POINTER_NORMALIZATION]=function(t){},i.transient[a.EXTENDING_EXPORTING]=function(t){t.defaultOptions;var e=t.doc,i=t.Chart,n=t.createElement,a=t.discardElement,o=(t.css,t.merge),r=t.each,h=t.extend;t.SVGRenderer,h(i.prototype,{SVGRenderer:function(t,e){var i=t.match(/<\/svg>(.*?$)/);return i&&i[1]&&(i='<foreignObject x="0" y="0" width="'+e.chart.width+'" height="'+e.chart.height+'"><body xmlns="ht""tp://www.w3.org/1999/xhtml">'+i[1]+"</body></foreignObject>",t=t.replace("</svg>",i+"</svg>")),s(t)},cleanSVG:function(t){return s(t)},getChartHTML:function(){return this.container.innerHTML},getSVG:function(i){var s,l,p,c,u,d,g,f,E=o(this.options,i);return l=n("div",null,{position:"absolute",top:"-9999em",width:this.chartWidth+"px",height:this.chartHeight+"px"},e.body),g=this.renderTo.style.width,f=this.renderTo.style.height,u=E.chart.width||/px$/.test(g)&&parseInt(g,10)||600,d=E.chart.height||/px$/.test(f)&&parseInt(f,10)||400,h(E.chart,{animation:!1,renderTo:l,forExport:!0,renderer:"SVGRenderer",width:u,height:d}),delete E.data,E.series=[],r(this.series,function(t){(c=o(t.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:t.visible})).isInternal||E.series.push(c)}),r(this.axes,function(e){e.userOptions.internalKey||(e.userOptions.internalKey=t.uniqueKey())}),s=new t.Chart(E,this.callback),i&&r(["xAxis","yAxis","series"],function(t){var e={};i[t]&&(e[t]=i[t],s.update(e))}),r(this.axes,function(e){var i=t.find(s.axes,function(t){return t.options.internalKey===e.userOptions.internalKey}),n=e.getExtremes(),a=n.userMin,o=n.userMax;!i||void 0===a&&void 0===o||i.setExtremes(a,o,!0,!1)}),p=s.cleanSVG(s.getChartHTML()),E=null,s.destroy(),a(l),p}})},i.transient[a.EXTENDING_LOG_SCALE]=function(t){t.Axis.prototype.log2lin=function(t){if(!this)return Math.log(t)/Math.LN10;var e,i=this&&this.userOptions&&this.userOptions.baseValue||10,n=t<0,a=Math.abs(t);return a<i&&(a+=(i-a)/i),e=Math.log(a)/Math.log(i),n?-e:e},t.Axis.prototype.lin2log=function(t){if(!this)return Math.pow(10,t);var e=this&&this.userOptions&&this.userOptions.baseValue||10,i=t<0,n=Math.abs(t),a=Math.pow(e,n);return a<e&&(a=e*(a-1)/(e-1)),i?-a:a}},i.transient[a.EXTENDING_LEGEND_ITEM](e),i.transient[a.EXTENDING_SERIES_TYPE](e),i.transient[a.EXTENDING_POINTER_NORMALIZATION](e),i.transient[a.EXTENDING_LOG_SCALE](e),i.transient[a.EXTENDING_EXPORTING](e),i.transient[a.EXTENDING_NODATA_SUPPORT](e)}(this,Highcharts);
!function(t){var r=t.ZSChart;function e(t,r){return parseInt(t,r||10)}function i(t){if(!(this instanceof i))return new i(t);this.rgba=void 0,this.color=void 0,this.defaultRGBA=void 0,this.depth=void 0,this.generatedColor=void 0,this.lowerLimit=7,this.colorRange=void 0,this.init(t)}i.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(t){return[e(t[1]),e(t[2]),e(t[3]),parseFloat(t[4],10)]}},{regex:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(t){return[e(t[1],16),e(t[2],16),e(t[3],16),1]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(t){return[e(t[1]),e(t[2]),e(t[3]),1]}}],names:{white:"#ffffff",black:"#000000",red:"#ff0000",green:"#00ff00",blue:"#0000ff",transparent:"#ffffff",default:"#ffffff"},init:function(t){if("object"==typeof t){var r,e,i=[];for(o=this.parsers.length-1,e=0,r=t.length;e<r;)o=o<0?2:o,(n=(a=a=this.parsers[o]).regex.exec(t[e]))&&(i.push(a.parse(n)),e++),o--;this.colorRange=i||[],this.defaultRGBA=JSON.parse(JSON.stringify(i))||[]}else{var n,s,o,a;for(this.color=t=this.names[t]||t,o=this.parsers.length;o--&&!s;)(n=(a=this.parsers[o]).regex.exec(t))&&(s=a.parse(n));this.rgba=s||[],this.defaultRGBA=JSON.parse(JSON.stringify(s))||[]}},polynomial:function(t,r){for(var e=arguments.length-1,i=arguments[e];e>1;)i=i*t+arguments[--e];return i},erf:function(t){var r=this.polynomial(Math.abs(t),1,.278393,.230389,972e-6,.078108);return r*=r,r=1-1/(r*=r),t<0?-r:r},getColorCombination:function(t){var r,e=this.colorRange,i=1/t,n=0,s=[],o=0;this.generatedColor=[];for(var a=0;a<t;a++){for(var h=0;a>0&&h<e.length;h++,o++)r=e[h],a%2==0?s.push(this.getBrighten(r,this.erf(n),o%3)):s.push(this.getDarken(r,this.erf(n),o%3));0==a&&(s=JSON.parse(JSON.stringify(e)));for(var f=0;f<s.length;f++)this.generatedColor.push(this.getRGB(s[f]));e=JSON.parse(JSON.stringify(this.defaultRGBA)),n=n>.6?.3:n,n+=i,s=[]}return this.generatedColor},getRGB:function(t){return"rgb("+t[0]+","+t[1]+","+t[2]+")"},getColor:function(t){var r=this.color,e=this.rgba;return e&&e[0]?"rgb"===t||!t&&1===e[3]?"rgb("+e[0]+","+e[1]+","+e[2]+")":"a"===t?e[3]:"rgba("+e.join(",")+")":r},getBrighten:function(t,r,i,n){for(i=0;i<=2;i++)t[i]=e(r*t[i]+255*(1-r)),t[i]<0&&(t[i]=0),t[i]>255&&(t[i]=255);return t},getDarken:function(t,r,i,n){for(i=0;i<=2;i++)t[i]=e(r*t[i]+100*(1-r)),t[i]<0&&(t[i]=0),t[i]>255&&(t[i]=255);return t},isLuminance:function(){var t=this.rgba;return.2126*t[0]+.7152*t[1]+.0722*t[2]<100},brighten:function(t){var r,i=this.rgba;if(t&&0!==t)for(r=0;r<3;r++)i[r]+=e(t*(255-i[r])),i[r]<0&&(i[r]=0),i[r]>255&&(i[r]=255);return this},darken:function(t){var r,i=this.rgba;if(t&&0!==t)for(r=0;r<3;r++)i[r]+=e(t*(150-i[r])),i[r]<0&&(i[r]=0),i[r]>255&&(i[r]=255);return this},setOpacity:function(t){return this.rgba[3]=t,this},getLinerGradient:function(t){var r;return this.setDepth(t),this.brightenNColors(),r=(r=this.getNColorCode()).slice(0,t),this.generateLinearGradient(r,t)},getRGBA:function(t){for(var r=[],e=0;e<t.length;e++){var i=t[e],n="rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")";r.push(n)}return r},generateLinearGradient:function(t,r){var e="linear-gradient(to right, ";t=t||this.getRGBA(this.defaultRGBA);for(var i=r=r||6,n=100/i,s=0;s<i;s++)e+=t[s]+" "+Math.round(n*s)+"% ,"+t[s]+" "+Math.round(n*(s+1))+"%, ";return e=e.substring(0,e.lastIndexOf(","))+")"},brightenNColors:function(){this.rgba;var t,r,e=Math.max(this.depth,this.lowerLimit);for(e+=2,t=0;t<e;t++)(r=this.brighten(t/e).getColor())&&(this.generatedColor||(this.generatedColor=[]),this.generatedColor.push(r),r=void 0);return this},getNColorCode:function(){return this.generatedColor},setDepth:function(t){return this.depth=t,this}},r.Utility.parseInteger=e,r.Utility.SheetChartColor=i}(this);
!function(t,e){var i=t.ZSChart;i.Constants.ServiceType;function o(){this.stockChart=!1,this.Chart=!1}o.prototype=e.Chart.prototype,o.prototype.setStockChart=function(t){this.stockChart=t},o.prototype.setLocale=function(t,i){t&&i&&e.setOptions({lang:{decimalPoint:t,thousandsSep:i}})},o.prototype.isStockChart=function(){return this.stockChart},o.prototype.setChart=function(t){this.Chart=t},o.prototype.isCommonChart=function(){return this.Chart},o.prototype.createZSChart=function(t){var e,i;return e=t.chart.renderTo,this.setStockChart(t.isStockChart||!1),(i=this.isStockChart()?this.ZSStockChart(e,t):this.ZSChart(e,t)).resetTitleFontFamily(),i},o.prototype.ZSStockChart=function(t,i){return e.stockChart(t,i)},o.prototype.ZSChart=function(t,i){return e.chart(t,i)},o.prototype.destroyChart=function(){this.destroy()},o.prototype.updateTitle=function(t){this.setTitle({text:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateTitleAlignment=function(t){this.setTitle({align:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateSubTitleAlignment=function(t){this.setSubtitle({align:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.getChartInstance=function(t){var e=i.Wrapper.DOMUtils.getDatasetAttribute(t,"highchartsChart");return Highcharts.charts[e]},o.prototype.updateSubTitle=function(t){this.setSubtitle({text:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateTitleStyle=function(t){this.setTitle({style:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateSubTitleStyle=function(t){this.setTitle(null,{style:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateTooltip=function(t){this.updateChart({tooltip:{enabled:t}})},o.prototype.updateSpline=function(t){var e={};e[t]={},e[t].borderWidth=0,e[t].dataLabels={enabled:!1},e[t].marker={enabled:!1},e[t].showInLegend=!0,e[t].zIndex=4,e[t].fillOpacity=.5,this.updateChart({chart:{type:t},plotOptions:e})},o.prototype.updateSortingOptions=function(t,e){var o=this.options.chart.renderTo.id||this.options.chart.renderTo,n={},r=[];r[0]={},i.Utility.setCaptionTopCSS(o,t.dataSorting.order),"ascending"==t.dataSorting.order?(n.verticalAlign="top",r[0].opposite=!1):(n.verticalAlign="bottom",r[0].opposite=!0),e[0].dataSorting=t.dataSorting;var a={};a.series=e,a.caption=n,a.yAxis=r,this.updateChart(a)},o.prototype.updateSortingEnabledOp=function(t,e){e[0].dataSorting=t.dataSorting,this.updateSeries(e)},o.prototype.updateInverted=function(t){this.updateChart({chart:{inverted:t}})},o.prototype.updateZoom=function(t){this.updateChart({chart:{zoomType:t?"xy":""}})},o.prototype.updateAnimation=function(t){this.updateChart({chart:{animation:t}})},o.prototype.updateMarker=function(t){var e=t.chart.type,i={};i.series=t.plotOptions.series,i[e]=t.plotOptions[e],this.updateChart({plotOptions:i})},o.prototype.setPositiveExtreme=function(t){var i=this;try{i&&i.yAxis.forEach(function(o){var n,r=o.getExtremes();r?(r.min<0&&r.dataMin>=0&&!i.options.yAxis[0].min&&(n=e.pick(o.min,r.dataMin,r.userMin,r.min)),o.setExtremes(n,void 0,!1,t)):o.setExtremes(void 0,void 0,!1,t)})}catch(t){}},o.prototype.updateXTitle=function(t,e){this.xAxis[e].setTitle({text:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.getCType=function(){return this.options.chart.type},o.prototype.isBarCType=function(){return-1!==this.getCType().indexOf("bar")},o.prototype.updateYTitle=function(t,e){this.yAxis[e].setTitle({text:t,rotation:this.isBarCType()?0:270}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateLegend=function(t){this.legend.update(t),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateDataLabels=function(t){this.updateChart(t),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateTrendtype=function(t){return this.createZSChart(t)},o.prototype.updateChart=function(t){this.update(t),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateXAxis=function(t){this.updateChart({xAxis:t})},o.prototype.wrapMinMaxInterval=function(t){if(t)for(var e=0;e<t.length;e++)void 0!==t[e].min&&"object"!=typeof t[e].min&&(t[e].min=parseFloat(t[e].min)),void 0!==t[e].tickInterval&&"object"!=typeof t[e].tickInterval&&(t[e].tickInterval=parseFloat(t[e].tickInterval)),void 0!==t[e].max&&"object"!=typeof t[e].max&&(t[e].max=parseFloat(t[e].max))},o.prototype.updateYAxis=function(t){this.wrapMinMaxInterval(t),this.updateChart({yAxis:t})},o.prototype.updateChartObject=function(t){this.updateChart({chart:t})},o.prototype.updateChartCaption=function(t){this.updateChart({caption:t})},o.prototype.updateYPlotLine=function(t,e){var i=t.id;this.removeYPlotLine(i,e),this.yAxis[e||0].addPlotLine(t),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.removeYPlotLine=function(t,e){this.yAxis[e||0].removePlotBandOrLine(t),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateMin=function(t,e){this.yAxis[e||0].update({min:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateMax=function(t,e){this.yAxis[e||0].update({max:t}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateInterval=function(t,e){var i=this.getIntervalValue(this.yAxis[e||0].getExtremes(),t);null!==t&&t<i||(this.yAxis[e||0].update({tickInterval:t}),this.removeUnwantedElements(),this.resetTitleFontFamily())},o.prototype.getIntervalValue=function(t,e){var i=t.min,o=(t.max-i)/200;return Math.round(o)},o.prototype.addYMajorGrid=function(t){this.yAxis[t||0].update({gridLineWidth:1}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.removeYMajorGrid=function(t){this.yAxis[t||0].update({gridLineWidth:0}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.addYMinorGrid=function(t){this.yAxis[t||0].update({minorTickInterval:"auto"}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.removeYMinorGrid=function(t){this.yAxis[t||0].update({minorTickInterval:null}),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.refresh=function(t){return this.createZSChart(t)},o.prototype.setAnimation=function(t){this.options.plotOptions.series.animation=t},o.prototype.setZSCSize=function(t,e){this.setSize(t,e),this.removeUnwantedElements(),this.resetTitleFontFamily()},o.prototype.updateSeries=function(t){this.updateChart({series:t})},o.prototype.updateSeriesByCustomProperty=function(t,e){this.series[t].update(e)},o.prototype.updatePointByCustomProperty=function(t,e,i){this.series[t].data[e].update(i)},o.prototype.removeUnwantedElements=function(){if(i.Wrapper&&i.Wrapper.DOMUtils){var t=i.Wrapper.DOMUtils,e=this.renderTo.id,o=(new i.Utility.ChartAgent).checkIfChartIsGrouped(e),n=t.getElementById(e);if(!n||o)return;for(var r=n.querySelector(".highcharts-container"),a=r.children,s=1;s<=a.length-2;s++)a[s].classList.contains("highcharts-axis-labels")&&r.removeChild(a[s]);i.Client.Action.OverrideHighchartEvents(e)}},o.prototype.resetTitleFontFamily=function(){if(i.Wrapper&&i.Wrapper.DOMUtils){var t=i.Wrapper.DOMUtils,e=this.renderTo.id,o=t.getElementById(e);if(!o)return;var n="Lato";this.options.chart&&this.options.chart.style&&(n=this.options.chart.style.fontFamily),setTimeout(function(){for(var t=o.querySelector(".highcharts-container").children,e=0;e<t.length;e++)t[e].classList.contains("highcharts-title")&&(t[e].style.fontFamily=n),t[e].classList.contains("highcharts-subtitle")&&(t[e].style.fontFamily=n)},10),i.Client.Action.OverrideHighchartEvents(e)}},o.prototype.hideToolip=function(){this.tooltip.hide()},o.prototype.getRenderElement=function(){return this.renderTo},o.prototype.hideToolip=function(){this.tooltip.hide()},o.prototype.addAsSiblings=function(t){this.renderTo.parentElement.appendChild(t.getElement())},o.prototype.ZSCDrawing=function(){return new i.Utility.ChartDrawing(this)},i.Wrapper.ZSHighChartWrapper=o}(this,Highcharts);
!function(t,e){var i=t.ZSChart,n=t.document;function s(t){this.parent=t}function r(t,e,i,n){this.parent=t,this.text=e||i,this.useHTML=n,this.init()}s.prototype.label=function(t,e,i){return new r(this.parent,t,e,i)},r.prototype.init=function(){var t=n.createElement("div"),e=n.createElement("span"),i=n.createElement("div");this.useHTML?i.innerHTML=this.text:e.innerText=this.text;var s=("ZSChart_DRAWING_"+Math.random()*(new Date).getUTCMilliseconds()).replace(/\./g,"_");t.id=s,t.classList.add("ZSChart_DRAWING"),this.useHTML?t.appendChild(i):t.appendChild(e),this.child=this.useHTML?i:e,this.DOM=t},r.prototype.attr=function(t){for(var e in t)this.DOM.setAttribute(e,t[e])},r.prototype.class=function(t,e){var i=t.join(",");e&&this.DOM.classList.add(i),!e&&this.child.classList.add(i)},r.prototype.css=function(t){Object.assign(this.DOM.style,t)},r.prototype.add=function(t,e){t&&this.parent.addAsSiblings(this),e&&this.parent.getRenderElement().appendChild(this.getElement())},r.prototype.align=function(t,e){var i=this.parent.getRenderElement().getBoundingClientRect();this.css({height:i.height+"px",width:i.width+"px"}),t&&Object.assign(this.DOM.style,t),e&&Object.assign(this.child.style,e)},r.prototype.destroy=function(){var t=this.DOM.parentElement;return t&&t.removeChild(this.DOM),!t&&this.DOM.remove(),null},r.prototype.getAssociateDOMSpace=function(){return this.parent.getAssociateSpace()},r.prototype.getElement=function(){return this.DOM},i.Utility.ChartDrawing=s}(this,Highcharts);
!function(r){var t=r.ZSChart,p={HIGHCHARTS:new(0,t.Wrapper.ZSHighChartWrapper)};function a(){}a.prototype={getAdaper:function(r){return t.Wrapper.ZSChartAdatperPlugins[r]}},t.Wrapper.ZSChartAdatperPlugins=p,t.Wrapper.ZSChartAdapter=a}(this);
!function(t){var e=t.ZSChart,r=e.Constants.ServiceProvider,i=r.HIGHCHARTS,a=e.Wrapper.ZSChartAdapter;function o(){this.serviceName=i,this.adapter=new a}o.prototype.init=function(t){this.serviceName=t},o.prototype.Chart=function(t){return this.adapter.getAdaper(this.serviceName).createZSChart(this.getRequiredChartProperty(t))},o.prototype.setLocale=function(t,e){this.adapter.getAdaper(this.serviceName).setLocale(t,e)},o.prototype.reposition=function(t,e){return this.adapter.getAdaper(this.serviceName).reposition(t)},o.prototype.getRequiredChartProperty=function(t){return this.serviceName,r.HIGHCHARTS,t},e.Wrapper.ZSChart=o}(this);
!function(t){var e=t.ZSChart,i=e.Model,n=t.sPlusPlus,o=e.Constants,a=t.ZSConstants.I18N,r=o.ColorSchemeType,c=(n.data.AppRegistry,t.document),s=e.Constants.ChartUpdate,l=e.Constants.QuickStyleActions,d=t.ZSEvents,p=d.Groups,u=d.Names,h=d.topic,A=e.Constants.ChartType,g=null,y=t.ZSDevTools.Logger;function v(){}function S(t,i,n,o,a){var r=new e.Utility.CommanAgent,c={legend:r.getLegendUpdate(i,n,o,t)};return(t=r.mergeRecursively(t,c)).plotOptions[t.chart.type].showInLegend=t.legend.enabled,t.legend=r.setDefaultLegendItemStylesOrElse(t.legend,a),t}function C(t,i,n){var o=new e.Utility.CommanAgent;return!n&&(n=o.getDefaultDataLabelConfig(t.chart.renderTo)),n.lf=i,o.getDataLabelsUpdate(t,n)}function I(t,i){var n=new e.Utility.ChartAgent,o=i||t.getYAxis(),a=t.getType(),r=n.filterCurrency(t.getCurrency(),t.getOptions().series?t.getOptions().series.length:0);return n.getFormatLabels(o,r,a,void 0,t.getConversionCode(),t.isSingleYaxis())}v.prototype.switchChart=function(t){new e.Utility.ChartAgent;var i=n.view.getActiveGridID(),o=n.view.getResourceID(i),a=n.view.getVersionID(i),r=n.view.getSheetID(i),c=e.Utility.getActiveChart();e.Server.Action.switchChart(o,r,a,{ID:c,dSN:t+"#",sSN:r},UserAction.SwitchSheet)},v.prototype.doServerCopy=function(t,i,n,o){e.Server.Action.doServerCopy(t,i,n,o)},v.prototype.updateDataRange=function(t,i,n,o){var a=new e.Utility.ChartAgent;for(var r in o){var c=o[r];a.mergeChartMeta(t,i,n,c)}},v.prototype.rePaintChartOnGrid=function(t,i,n){var o=new e.Utility.ChartAgent;(new e.Utility.CommanAgent).resetMoveMenu();var a=o.filterMeta(i,t,n);if(a){for(var r=a.CHARTS,c=a.afftectedCharts,s=a.CACHED,l=0;l<s.length;){if("ANIMATION_CHART"==o.getChartMeta(s[l]).chartMeta.type){var d=s[l];r.push(d),s.shift(l)}else l++}for(l=0;l<c.length;l++){if("ANIMATION_CHART"==o.getChartMeta(c[l]).chartMeta.type){d=c[l];r.push(d),c.shift(l)}else l++}new Promise(function(e,o){h.publish(p.Listener,u.SheetAction.CHARTS.ATTACH,{RID:t,SHEETID:i,VERSION:n,CHARTS:r,CACHED:s});var a=this;setTimeout(function(){e(a)},100)}.bind(this)).then(function(t){t.updateChartFromServer(i,c)})}},v.prototype.updateSidePanelMeta=function(t){t&&h.publish(p.UI,u.SidePanel.CHARTS.METACONVERSION,{CHART_ID:t})},v.prototype.renderSheetCharts=function(t,e,i,n){if(n){var o=n.shift();o&&this.attachAsync(t,e,i,o,o.ts,o.ds,this).then(function(o){o.renderSheetCharts(t,e,i,n)})}},v.prototype.attachAsync=function(t,i,n,o,a,r,c){return new Promise(function(a,r){var s=new e.Utility.AgentDom,l=o.getInstance().renderTo;s.setDivContainerProperty(t,i,n,o.id,o.ht,o.wd,o.top,o.left,o.sr,o.sc,o.srd,o.scd,l),o.getInstance().reflow(),setTimeout(function(){a(c)},100)})},v.prototype.updateChartFromServer=function(t,i){i.length>0&&e.Server.Action.RefreshChart(t,i,function(t){h.publish(p.Listener,u.SheetAction.CHARTS.UPDATE,{RID:t.rID,SHEETID:t.sheetID,CHARTS:t.CHARTS,VERSION:t.version,AOWNER:t.isActionOwner})})},v.prototype.setLoadedChartPropertyByChartId=function(t,i,n,o,a){var r=new e.Utility.ChartAgent,c=[],s=r.getInstance(t,i,n,o);s.setAssociatedSheetId(i),c.push(s),r.resetChartMetaVisitedProperty(c)},v.prototype.resetLoadedChartProperty=function(t,i,n){var o=new e.Utility.ChartAgent,a=o.getAllMetaOfSheet(t,i,n);o.resetChartMetaVisitedProperty(a)},v.prototype.insertChart=function(t,e,i,n,o,a,r,c){if(n){var s=n.shift();s&&this.renderAsync(t,e,i,s,s.ts,s.ds,!1,r,!0,this,c).then(function(o){o.insertChart(t,e,i,n)})}},v.prototype.renderAsync=function(t,o,a,r,c,s,l,d,p,u,h){return new Promise(function(p,A){new e.Utility.CommanAgent;var g=r.id,y=n.view.getActiveGridID();if(n.view.getSheetID(y)!=r.asn)return u.setLoadedChartPropertyByChartId(t,o,a,g,!1),void p(u);var v,S=new e.Utility.ChartAgent,C=r.co,I=S.clone(r,!0),f=S.clone(I.co,!0);I.aggregation&&f.aggregation&&(I.aggregation.enabled=f.aggregation.enabled),delete I.co;var T=new i.ChartModel(g,I,C.chart,C.colorOptions,C.xAxis,C.yAxis,C.series,C.title,C.subtitle,C.tooltip,C.plotOptions,C.legend,C.credits,c,s,C.isStockChart,C.lineStyles,C.caption,C.dataForAnimationChart);T.setSeparatorOptions(),T.init(l,d),v=T.show(l,h),S.addInstance(t,o,a,g,v,f,I),setTimeout(function(){p(u)},100)})},v.prototype.loadChart=function(t,e,i,n,o,a){if(n){var r=n.shift();r&&this.renderAsync(t,e,i,r,r.ts,r.ds,!1,!1,!0,this).then(function(o){o.loadChart(t,e,i,n)})}},v.prototype.reRenderChart=function(t,i,o,a){var r=n.view.getActiveGridID(),c=n.view.getSheetID(r);for(var s in a){var l=a[s],d=l.id||l.chartId;c==l.asn?(this.refreshChart(t,i,d,l,o,!0,!0),d===e.Utility.getActiveChart(!0)&&this.updateSidePanel(d,!1)):this.markChartAsDirty(t,i,d,o)}},v.prototype.updateChart=function(t,i,o,a){var r=n.view.getActiveGridID(),c=n.view.getSheetID(r),s=new e.Utility.ChartAgent;for(var l in a){var d=a[l];d.id=d.id||d.chartId;var g=d.id,y=d.asn,v=d.co,S=s.getInstance(t,i,o,g),C=d.subAction?d.subAction:-1;if(222!=C){e.Manager.SidePanelManager;var I=v&&s.checkRedrawProperty(S.getDetails(),v,S.getInstance()[0],C);if(S.isStockChart()){I=!0;var f=s.clone(S.getOptions(),!0);(d=s.clone(S.getDetails(),!0)).co=f}I=!!(S.getType().toUpperCase()===A.WORDCLOUD.toUpperCase())||I;var T=s.isRecommendationCallNeeded(C);if(C>0&&h.publish(p.UI,u.SidePanel.CHARTS.CUSTOM.EVENT.SYNC_PROPERTY_TO_TOOLBAR,{PROPERTIES:{value:d.value,subAction:C}}),S.isCellExceeded()&&h.publish(p.Listener,u.UserAction.CHARTS.NOTIFICATION.UPDATE,{RID:t,SHEETID:i,VERSION:o,STATUS:"SHOW"}),!S.isCellExceeded()&&h.publish(p.Listener,u.UserAction.CHARTS.NOTIFICATION.REMOVE,{RID:t,SHEETID:i,VERSION:o}),h.publish(p.UI,u.SidePanel.CHARTS.METACONVERSION,{CHART_ID:g}),h.publish(p.UI,u.SidePanel.CHARTS.HIDEPROPERTY,{CHART_ID:g,SUBACTION:C}),c==y){if(void 0===I)return S.isClientActionDone||(this.doQuickEditClientAction(t,i,o,[g],C,d.value),this.doQuickStyleClientAction(g,S,C,!0),this.doQuickTitleEditAction([g],S.getOptions(),C),g===e.Utility.getActiveChart(!0)&&e.Utility.updatePartOfPanel(C,g)),void(S.isClientActionDone=!1);!I&&this.updateChartClient(t,i,o,g,d),I&&this.refreshChart(t,i,g,d,o,!0,T),g===e.Utility.getActiveChart(!0)&&e.Utility.updatePartOfPanel(C,g),h.publish(p.UI,u.SidePanel.CHARTS.ACCORDION.SERIES.UPDATE)}else this.markChartAsDirty(t,i,g,o)}}},v.prototype.updateSidePanel=function(t,e){try{h.publish(p.UI,u.SidePanel.CHARTS.METACONVERSION,{CHART_ID:t}),e&&h.publish(p.UI,u.SidePanel.CHARTS.CALL_RECOMMENDATION,{CHART_ID:t}),e&&h.publish(p.UI,u.SidePanel.CHARTS.CALL_TABLE_DEFINITION,{CHART_ID:t}),h.publish(p.UI,u.SidePanel.CHARTS.REFRESH_SIDE_PANEL,{CHART_ID:t})}catch(t){}},v.prototype.addChartToImageLibrary=function(t,i,n,o){e.Server.Action.addChartToImageLibrary(t,n,i,o,function(t){var e=new ZSClass.TBNotification(a["chart.errorInfoWhileAddingInLibrary"]||"Unable to add chart into image library. please try again!",{type:"error"});"success"==t&&(e=new ZSClass.TBNotification(a["chart.infoWhileAddingInLibrary"]||"New chart image added into image library.",{type:"info"})),e.show()})},v.prototype.saveChartAsImage=function(t,i){var a=n.view.getActiveGridID(),r=n.view.getResourceID(a),c=n.view.getVersionID(a),s=n.view.getSheetID(a),l=new e.Utility.ChartAgent;if(!t&&(t=e.Utility.getActiveChart()),"object"==typeof t)for(var d in t){var p=t[d],u=A((h=l.getChartMeta(p)).getTitle(),"CHART");this.downloadAs(r,s,c,{chartId:p,extn:o.ChartImageExtn.PNG,fileName:u,height:h.getHeight(),width:h.getWidth()},i)}else{var h;p=t,u=A((h=l.getChartMeta(p)).getTitle(),"CHART");this.downloadAs(r,s,c,{chartId:p,extn:o.ChartImageExtn.PNG,fileName:u,height:h.getHeight(),width:h.getWidth()},i)}function A(t,e){return 0==t.length?unescape(e):unescape(t)}},v.prototype.downloadAs=function(t,i,n,o,a){var r=e.Wrapper.DOMUtils,s=(new e.Utility.ChartAgent).getChartSvgByID(o.chartId);var l=r.createElement("canvas");l.getContext("2d");l.height=o.height,l.width=o.width,canvg(l,s,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){!function(){var t=l.toDataURL("image/"+o.extn);if(a)a(t);else{var e=r.createElement("a");e.href=t,e.download=o.fileName+"."+o.extn;var i=c.body;i.appendChild(e),e.click(),i.removeChild(e)}}()}})},v.prototype.doChartCustomization=function(t,i){var o,a,r=n.view.getActiveGridID(),c=n.view.getResourceID(r),s=n.view.getVersionID(r),l=n.view.getSheetID(r),d=new e.Utility.ChartAgent;switch(t){case"series":e.Server.Action.doQuickStyleAction(c,l,s,i.cID,112,[{pIndex:i.pIndex,cValue:i.color,sIndex:i.sIndex,isSeriesLevel:i.isSeries}]);break;case"haxis":o=d.getChartMeta(i.ID),a=o.updateXLabelStyle(i.style),e.Server.Action.doQuickStyleAction(c,l,s,o.getID(),127,[{style:a}]);break;case"vaxis":!function(){var t=d.getChartMeta(i.ID),n=t.updateYLabelStyle(i.style,i.yIndex);e.Server.Action.doQuickStyleAction(c,l,s,t.getID(),126,[{style:n,index:i.yIndex}])}();break;case"tredlineStyle":e.Server.Action.doQuickStyleAction(c,l,s,i.cID,121,[{sIndex:i.sIndex,dashStyle:i.dashStyle}])}},v.prototype.doClone=function(t){var i=n.view.getActiveGridID(),o=n.view.getResourceID(i),a=n.view.getVersionID(i),r=n.view.getSheetID(i),c=new e.Utility.ChartAgent;if(t){(d=c.getChartMeta(t)).setForClone(!0);var s=c.getRequestObject(d,"new");d.setForClone(!1)}else for(var l in t=e.Utility.getActiveChart()){var d,A=t[l];(d=c.getChartMeta(A)).setForClone(!0);s=c.getRequestObject(d,"new");d.setForClone(!1)}h.publish(p.Listener,u.SheetAction.CHARTS.BLUR,{RID:o,SHEETID:r,VERSION:a,CHARTID:t}),e.Server.Action.updateChartOnGrid(o,r,a,s)},v.prototype.updateChartClient=function(t,n,o,a,r){var c=new e.Utility.ChartAgent,s=c.getInstance(t,n,o,a).getInstance(),l=r.co,d=c.clone(r,!0);delete d.co;var p=new i.ChartModel(a,d,l.chart,l.colorOptions,l.xAxis,l.yAxis,l.series,l.title,l.subtitle,l.tooltip,l.plotOptions,l.legend,l.credits,d.ts,d.ds,l.isStockChart,l.lineStyles,l.caption,l.dataForAnimationChart);p.setSeparatorOptions(),p.init(!1,!0),e.Utility.updateChartClient.fn.call(this,s,p),e.Client.Action.OverrideHighchartEvents(a),a===e.Utility.getActiveChart(!0)&&this.updateSidePanel(a,!1)},v.prototype.createPreview=function(t,i){var n=new e.Utility.ChartAgent,o=i.co,a=n.clone(i,!0),r=(n.clone(a.co,!0),i.ts||""),c=i.ds||"";delete a.co;var s=new ChartManager.Model.Chart(t,a,o.chart,o.colorOptions,o.xAxis,o.yAxis,o.series,o.title,o.subtitle,o.tooltip,o.plotOptions,o.legend,o.credits,r,c);return s.setSeparatorOptions(),s.init(!1,!1),s.restoreDefaultSpacing(),s.showPreview()},v.prototype.resizeChart=function(t,i){var n=e.transient.hInsance;chart.chartDetails.ht=t,chart.chartDetails.wd=i,chart.chartObject.height=t,chart.chartObject.width=i,chart.setDivContainerSize(t,i),n.setZSCSize(i,t)},v.prototype.resetSize=function(t,i,n,o,a,r){(new e.Utility.ChartAgent).setInstanceSize(t,i,n,o,r,a),h.publish(p.UI,u.SidePanel.CHARTS.METACONVERSION,{CHART_ID:o})},v.prototype.updateScaleFactor=function(t,i,a,r,c){var s=n.view.getActiveGridID(),l=n.view.getResourceID(s),d=n.view.getVersionID(s),p=n.view.getSheetID(s);for(var u in Object.keys(t).forEach(function(n){var s=t[n];!function(t,e){var i=e.scaleFactor||1,n=e.index||0,a=e.unitFactor||" ",r=e.conversionType||o.ConversionType.UNITS;t.updateScaleFactor(i,a,n,r)}(e.Utility.getChartMeta(s,!0),{scaleFactor:i,unitFactor:a,index:r,conversionType:c})}),this.doQuickEditClientAction(l,p,d,t,149,{scaleFactor:i,unitFactor:a,index:r,conversionType:c}),t){var h=t[u];e.Server.Action.doQuickStyleAction(l,p,d,h,149,[{scaleFactor:i,index:r,unitFactor:a,conversionType:c}])}},v.prototype.updateBinningInterval=function(t,i){var o=n.view.getActiveGridID(),a=n.view.getResourceID(o),r=n.view.getVersionID(o),c=n.view.getSheetID(o);0!==t.length&&e.Server.Action.doQuickEditAction(a,c,r,t,151,i)},v.prototype.setNumberFormat=function(t,i){var o=n.view.getActiveGridID(),a=n.view.getResourceID(o),r=n.view.getVersionID(o),c=n.view.getSheetID(o);Object.keys(t).forEach(function(n){var o=t[n];!function(t,e){var i=e.nfCode,n=e.prefix||"",o=e.suffix||"",a=e.index||0;t.setNumberFormat(i,n,o,a)}(e.Utility.getChartMeta([o],!0),i)}),this.doQuickEditClientAction(a,c,r,t,150,i),g&&clearTimeout(g),g=setTimeout(function(){for(var n in t){var o=t[n];e.Server.Action.doQuickStyleAction(a,c,r,o,150,[i])}},500)},v.prototype.doQuickEditClientAction=function(t,n,o,a,r,c){if(0!=a.length){var l=new e.Utility.ChartAgent;for(var d in a){var p=a[d],u=l.getChartMeta(p);if(u){var h=u.getInstance(),A=l.clone(u.getOptions(),!0),g=l.clone(u.getDetails(),!0);if(A.isStockChart&&(101==r||102==r))return;101==r&&(g.legendPos=c),102==r&&(g.lf=c),193==r&&(g.dlt=c);A.title.text.length,A.subtitle.text.length;var y=new i.ChartModel(p,g,A.chart,A.colorOptions,A.xAxis,A.yAxis,A.series,A.title,A.subtitle,A.tooltip,A.plotOptions,A.legend,A.credits,g.ts,g.ds,A.isStockChart,A.lineStyles,A.caption,A.dataForAnimationChart);y.setSeparatorOptions(),y.init(!1,!0);var v=y.constructChartOptions();switch(r){case 101:case 161:case 167:case 162:h&&e.Utility.updateChart.fn.call(this,h,v);break;case 102:h&&e.Utility.updateDataLabels.fn.call(this,h,v);break;case 103:if(h){c=l.isArray(c)?1===c[0].gridLineWidth:c;var S=v.yAxis.length;e.Utility.updateMajorGrid.fn.call(this,h,c,S)}break;case 168:if(h){var C=c.caption;C.style=c.caption.style||{},C.style.display=c.raceChartOptions.enabled?"block":"none",e.Utility.updateChartCaption.fn.call(this,h,C)}break;case 104:if(h){c=l.isArray(c)?"auto"===c[0].minorTickInterval:c;S=v.yAxis.length;e.Utility.updateMinorGrid.fn.call(this,h,c,S)}break;case 155:h&&e.Utility.updateInverted.fn.call(this,h,c);break;case 105:h&&e.Utility.updateAnimation.fn.call(this,h,c);break;case 106:h&&e.Utility.updateTooltip.fn.call(this,h,c);break;case 156:h&&e.Utility.updateSpline.fn.call(this,h,c);break;case 147:c.series?v.plotOptions.series=c.series:(v.plotOptions.series.marker.enabled=c,v.plotOptions[v.chart.type].marker.enabled=c),h&&e.Utility.updateMarker.fn.call(this,h,v);break;case 149:case 193:case 150:v.yAxis=I(u,v.yAxis),h&&this.updateHighChartsInstance(v,h,u,s.YAXIS);break;case 159:e.Utility.updateSortingEnabledOp.fn.call(this,h,v.plotOptions.series,v.series);break;case 160:e.Utility.updateSortingOptions.fn.call(this,h,v.plotOptions.series,v.series)}u.setClientUpdated(!0)}}}},v.prototype.reLoadChartOnGrid=function(t,i,n){var o=(new e.Utility.ChartAgent).filterMeta(i,t,n,!0,!0);if(o){var a=o.CHARTS,r=o.afftectedCharts;new Promise(function(e,o){h.publish(p.Listener,u.UserAction.CHARTS.ZOOM,{RID:t,SHEETID:i,VERSION:n,CHARTS:a});var r=this;setTimeout(function(){e(r)},100)}.bind(this)).then(function(t){t.updateChartFromServer(i,r)})}},v.prototype.updateChartOnGrid=function(t,i,n,o){var a=[];for(var r in o){var c=o[r],s=c.subAction,l=c.value;switch(s){case 137:case 138:case 107:c.id==e.Utility.getActiveChart(!0)&&this.updateSidePanel(c.id);case 148:case 151:case 152:case 153:case 154:l.subAction=s,a.push(l);break;default:a.push(c)}}this.updateChart(t,i,n,a)},v.prototype.refreshChart=function(t,e,i,n,o,a,r){var c=[];c.push(n),h.publish(p.Listener,u.UserAction.CHARTS.UPDATE,{RID:t,SHEETID:e,VERSION:o,CHARTS:c,doNotSetFocus:a})},v.prototype.addChartToView=function(t,e,i,n,o){h.publish(p.Listener,u.UserAction.CHARTS.UPDATE,{RID:t,SHEETID:e,VERSION:i,CHARTS:n,doNotSetFocus:o})},v.prototype.markChartAsDirty=function(t,i,n,o){y.log("[CHART] >>>>>> Marking Chart as Dirty ",n);var a=(new e.Utility.ChartAgent).getChartMetaOfSheet(i,t,o,void 0,n);a&&a.markDirty(!0)},v.prototype.changeChartType=function(t,i,n,o,a){Object.keys(o).forEach(function(r){var c=[],s=o[r].getDetails();s.type!==a&&c.push(s.id),0!==c.length&&e.Server.Action.doQuickEditAction(t,i,n,c,107,a)})},v.prototype.updateLegend=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();e.legendPos!==a&&r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,101,a),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,101,a)},v.prototype.updateLegendStyle=function(t,i,n,o,a){var r=o.getDetails(),c={};c.style=a;var s=[];s.push(c),this.doQuickStyleClientAction(r.id,o,125),e.Server.Action.doQuickStyleAction(t,i,n,o.getChartID(),125,s)},v.prototype.updateXSlant=function(t,i,n,o,a){var r=o.getDetails(),c={};c.slant=a;var s=[];s.push(c),this.doQuickStyleClientAction(r.id,o,129),e.Server.Action.doQuickStyleAction(t,i,n,o.getChartID(),129,s)},v.prototype.updateChartTitle=function(t,i,n,o,a){o.getDetails();var r=[];r.push(a),e.Server.Action.doQuickStyleAction(t,i,n,o.getChartID(),122,r)},v.prototype.updateChartSubTitle=function(t,i,n,o,a){o.getDetails();var r=[];r.push(a),e.Server.Action.doQuickStyleAction(t,i,n,o.getChartID(),123,r)},v.prototype.updateXAxisTitle=function(t,i,n,o,a){o.getDetails();var r=[];r.push(a),e.Server.Action.doQuickStyleAction(t,i,n,o.getChartID(),115,r)},v.prototype.updateYAxisTitle=function(t,i,n,o,a){o.getDetails();var r=[];r.push(a),e.Server.Action.doQuickStyleAction(t,i,n,o.getChartID(),116,r)},v.prototype.updateStaggerLines=function(t,i,n,o,a){var r=o.getDetails(),c={};c.staggerLines=a;var s=[];s.push(c),this.doQuickStyleClientAction(r.id,o,139),e.Server.Action.doQuickStyleAction(t,i,n,o.getChartID(),139,s)},v.prototype.updateTrendlineType=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,137,a)},v.prototype.updateTrendlineDegree=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,138,a)},v.prototype.updateTrendlinePeriod=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,148,a)},v.prototype.updateTooltip=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,106,{enabled:a}),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,106,a)},v.prototype.updateLinemarker=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,147,a),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,147,a)},v.prototype.updateInverted=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,155,{inverted:a}),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,155,a)},v.prototype.updateSpline=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)});var c=a?"areaspline":"area";this.doQuickEditClientAction(t,i,n,r,156,{type:c}),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,156,c)},v.prototype.updateAnimation=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,105,a),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,105,a)},v.prototype.addPlotlines=function(t,i,n,o,a,r){var c=o.getDetails(),s=[];s.push(a),this.doQuickStyleClientAction(c.id,o,140),!r&&e.Server.Action.doQuickStyleAction(t,i,n,c.id,140,s)},v.prototype.addPlotLineName=function(t,i,n,o,a,r){var c=o.getDetails(),s=[];s.push(a),this.doQuickStyleClientAction(c.id,o,134),!r&&e.Server.Action.doQuickStyleAction(t,i,n,c.id,134,s)},v.prototype.removePlotline=function(t,i,n,o,a,r){var c=o.getDetails(),s=[];s.push(a),this.doQuickStyleClientAction(c.id,o,192),!r&&e.Server.Action.doQuickStyleAction(t,i,n,c.id,192,s)},v.prototype.updateMin=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,130),e.Server.Action.doQuickStyleAction(t,i,n,r.id,130,c)},v.prototype.updateAggregation=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),e.Server.Action.doQuickStyleAction(t,i,n,r.id,152,c)},v.prototype.updateFilter=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),e.Server.Action.doQuickStyleAction(t,i,n,r.id,153,c)},v.prototype.updateMultipleYAxis=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),e.Server.Action.doQuickStyleAction(t,i,n,r.id,154,c)},v.prototype.updateAutoExpand=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,145,a),r.length>0&&e.Server.Action.doQuickEditAction(t,i,n,r,145,a)},v.prototype.updateInterpolationOption=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),r.length>0&&e.Server.Action.doQuickEditAction(t,i,n,r,161,a)},v.prototype.updateSumOption=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),r.length>0&&e.Server.Action.doQuickEditAction(t,i,n,r,167,a)},v.prototype.updateMissingValOption=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),r.length>0&&e.Server.Action.doQuickEditAction(t,i,n,r,162,a)},v.prototype.updateMajor=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,103,a),r.length>0&&e.Server.Action.doQuickEditAction(t,i,n,r,103,a)},v.prototype.updateMinor=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,104,a),r.length>0&&e.Server.Action.doQuickEditAction(t,i,n,r,104,a)},v.prototype.updateReverse=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,141),e.Server.Action.doQuickStyleAction(t,i,n,r.id,141,c)},v.prototype.updateTitleStyle=function(t,i,n,o,a,r){var c=o.getDetails(),s=[];s.push(a),this.doQuickStyleClientAction(c.id,o,r),e.Server.Action.doQuickStyleAction(t,i,n,c.id,r,s)},v.prototype.updateTitleAlignment=function(t,i,n,o,a,r){var c=o.getDetails(),s=[],l={align:a};s.push(l),this.doQuickStyleClientAction(c.id,o,r),e.Server.Action.doQuickStyleAction(t,i,n,c.id,r,s)},v.prototype.updateOpposite=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,146),e.Server.Action.doQuickStyleAction(t,i,n,r.id,146,c)},v.prototype.updateLogarithmic=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,142),e.Server.Action.doQuickStyleAction(t,i,n,r.id,142,c)},v.prototype.updateBaseValue=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,143),e.Server.Action.doQuickStyleAction(t,i,n,r.id,143,c)},v.prototype.updateAnimationSpeed=function(t,i,n,o,a){var r=o.getDetails(),c={speed:a},s=[];s.push(c),this.doQuickStyleClientAction(r.id,o,157),e.Server.Action.doQuickStyleAction(t,i,n,r.id,157,s)},v.prototype.updateCaptionFontSize=function(t,i,n,o,a,r){var c=o.getDetails(),s={};s.fontSize=a,s.margin=r;var l=[];l.push(s),this.doQuickStyleClientAction(c.id,o,163),e.Server.Action.doQuickStyleAction(t,i,n,c.id,163,l)},v.prototype.updateCaptionFontWeight=function(t,i,n,o,a){var r=o.getDetails(),c={fontWeight:a},s=[];s.push(c),this.doQuickStyleClientAction(r.id,o,164),e.Server.Action.doQuickStyleAction(t,i,n,r.id,164,s)},v.prototype.enableCaption=function(t,i,n,o,a){var r=o.getDetails(),c={enabled:a},s=[];s.push(c),this.doQuickStyleClientAction(r.id,o,168),e.Server.Action.doQuickStyleAction(t,i,n,r.id,168,s)},v.prototype.updateCaptionFontStyle=function(t,i,n,o,a){var r=o.getDetails(),c={fontStyle:a},s=[];s.push(c),this.doQuickStyleClientAction(r.id,o,165),e.Server.Action.doQuickStyleAction(t,i,n,r.id,165,s)},v.prototype.updateCaptionFontColor=function(t,i,n,o,a){var r=o.getDetails(),c={color:a},s=[];s.push(c),this.doQuickStyleClientAction(r.id,o,166),e.Server.Action.doQuickStyleAction(t,i,n,r.id,166,s)},v.prototype.updateSorting=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,159,a),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,159,a)},v.prototype.setSortingType=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,160,{type:a}),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,160,a)},v.prototype.updateBarCount=function(t,i,n,o,a){var r=o.getDetails(),c={barCount:a},s=[];s.push(c),this.doQuickStyleClientAction(r.id,o,158),e.Server.Action.doQuickStyleAction(t,i,n,r.id,158,s)},v.prototype.updateLabels=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,144),e.Server.Action.doQuickStyleAction(t,i,n,r.id,144,c)},v.prototype.updateFontFamily=function(t,i,n,o,a){a&&o.updateFontFamily(a.style);var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,114),e.Server.Action.doQuickStyleAction(t,i,n,r.id,114,c)},v.prototype.updateCBC=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,108),e.Server.Action.doQuickStyleAction(t,i,n,r.id,108,c)},v.prototype.updateChartBorderColor=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push({color:a}),this.doQuickStyleClientAction(r.id,o,199),e.Server.Action.doQuickStyleAction(t,i,n,r.id,199,c)},v.prototype.updatePBC=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,109),e.Server.Action.doQuickStyleAction(t,i,n,r.id,109,c)},v.prototype.updateGC=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,124),e.Server.Action.doQuickStyleAction(t,i,n,r.id,124,c)},v.prototype.updateMax=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,131),e.Server.Action.doQuickStyleAction(t,i,n,r.id,131,c)},v.prototype.updateInterval=function(t,i,n,o,a){var r=o.getDetails(),c=[];c.push(a),this.doQuickStyleClientAction(r.id,o,132),e.Server.Action.doQuickStyleAction(t,i,n,r.id,132,c)},v.prototype.updateDataLabel=function(t,i,n,o,a){var r=[];Object.keys(o).forEach(function(t){var e=o[t].getDetails();e.type!==a&&r.push(e.id)}),this.doQuickEditClientAction(t,i,n,r,102,a),0!==r.length&&e.Server.Action.doQuickEditAction(t,i,n,r,102,a)},v.prototype.updateThemeOnGrid=function(t,i){var o=new e.Utility.ChartAgent,a=i.basecolor,c=i.name,s=i.reversed;"string"==typeof s&&(s="false"!=s),"string"==typeof a&&-1!==a.indexOf("[")&&JSON.parse(a),-1!==c.indexOf(r.COLORFUL)&&o.generateMonochromaticShades(c,!0);var l=e.Utility.getChartMeta([t],!0);l.updateColorScheme(i),this.doQuickStyleClientAction(t,l,133);var d=n.view.getActiveGridID(),p=n.view.getResourceID(d),u=n.view.getVersionID(d),h=n.view.getSheetID(d);if(!t&&(t=e.Utility.getActiveChart()),"object"==typeof t)for(var A in t){var g=t[A];e.Server.Action.doQuickStyleAction(p,h,u,g,133,[{basecolor:a,pallateName:c,isReversed:s}])}else e.Server.Action.doQuickStyleAction(p,h,u,t,133,[{basecolor:a,pallateName:c,isReversed:s}])},v.prototype.reveseColorScheme=function(t,i){var o=n.view.getActiveGridID(),a=n.view.getResourceID(o),r=n.view.getVersionID(o),c=n.view.getSheetID(o),s=n.data.getWorkBook(a,r).getSheetObj(c).Charts,l=new e.Utility.ChartAgent;t.forEach(function(t){var e=s.get(t),n=l.clone(e.getStyleOptions().colorTheme,!0),o={basecolor:n.basecolor,name:n.name,reversed:i};this.updateThemeOnGrid(t,o)}.bind(this)),l.reverseMonoColor(i,!0)},v.prototype.updateHighChartsInstance=function(t,i,n,o){if(i)switch(o){case s.CHART_CAPTION:e.Utility.updateChartCaption.fn.call(this,i,t.caption);case s.CHART:e.Utility.updateChartObject.fn.call(this,i,t.chart);break;case s.XAXIS:e.Utility.updateXAxis.fn.call(this,i,t.xAxis);break;case s.XAXIS_LABELS:e.Utility.updateXAxis.fn.call(this,i,{labels:t.xAxis.labels});break;case s.YAXIS:e.Utility.updateYAxis.fn.call(this,i,t.yAxis);break;case s.TITLE_STYLE:e.Utility.updateTitleStyle.fn.call(this,i,t.title.style);break;case s.CHART_TITLE:e.Utility.updateLegend.fn.call(this,i,t.legend),e.Utility.updateTitle.fn.call(this,i,t.title.text);break;case s.CHART_SUBTITLE:e.Utility.updateLegend.fn.call(this,i,t.legend),e.Utility.updateSubTitle.fn.call(this,i,t.subtitle.text);break;case s.XTITLE:e.Utility.updateXTitle.fn.call(this,i,t.xAxis.title.text);break;case s.YTITLE:e.Utility.updateYAxis.fn.call(this,i,t.yAxis);break;case s.CHART_TITLE_ALIGNMENT:e.Utility.updateLegend.fn.call(this,i,t.legend),e.Utility.updateTitleAlignment.fn.call(this,i,n.chartOptions.title.align);break;case s.CHART_SUBTITLE_ALIGNMENT:e.Utility.updateLegend.fn.call(this,i,t.legend),e.Utility.updateSubTitleAlignment.fn.call(this,i,n.chartOptions.subtitle.align);break;default:e.Utility.updateChart.fn.call(this,i,t)}},v.prototype.resetClientActionDone=function(t){new e.Utility.ChartAgent;var i=n.view.getActiveGridID(),o=n.view.getResourceID(i),a=n.view.getVersionID(i),r=n.view.getSheetID(i),c=n.data.getWorkBook(o,a).getSheetObj(r).Charts;for(var s in t){var l=t[s],d=c.get(l);d&&(d.getType().toUpperCase()!==A.WORDCLOUD.toUpperCase()&&(d.isClientActionDone=!0))}},v.prototype.doQuickTitleEditAction=function(t,o,a){var r=new e.Utility.ChartAgent,c=n.view.getActiveGridID(),s=n.view.getResourceID(c),l=n.view.getVersionID(c),d=n.view.getSheetID(c),p=n.data.getWorkBook(s,l).getSheetObj(d).Charts;for(var u in t){var h=t[u],g=p.get(h);if(g){if(g.getType().toUpperCase()===A.WORDCLOUD.toUpperCase())return;var y=g.getInstance(),v=(r=new e.Utility.ChartAgent).clone(g.getOptions(),!0),I=r.clone(g.getDetails(),!0),f=new i.ChartModel(h,I,v.chart,v.colorOptions,v.xAxis,v.yAxis,v.series,v.title,v.subtitle,v.tooltip,v.plotOptions,v.legend,v.credits,I.ts,I.ds,v.isStockChart,v.lineStyles,v.caption,v.dataForAnimationChart);f.setSeparatorOptions(),f.init(!1,!0);var T=(o=f.constructChartOptions()).title.text.length>0,D=o.subtitle.text.length>0,k=I.lf,E=null;switch(o.legend&&(E=r.clone(o.legend.itemStyle,!0)),o=C(o,k),"ANIMATION_CHART"!=f.chartDetails.type&&(o=S(o,g.getLegendPosition(),T,D,E)),o.chart.renderTo=r.getRenderTo(y),o.plotOptions.series.animation=!1,a){case 122:this.updateHighChartsInstance(o,y,g,"chartTitle");break;case 123:this.updateHighChartsInstance(o,y,g,"subTitle");break;case 115:this.updateHighChartsInstance(o,y,g,"xTitle");break;case 116:this.updateHighChartsInstance(o,y,g,"yTitle")}}}},v.prototype.doQuickStyleClientAction=function(t,o,a){var r=this;return new Promise(function(c,d){var p=[];for(var u in t&&p.push(t),!t&&(p=e.Utility.getActiveChart()),p){var h=p[u],A=o;if(A){var g=A.getInstance(),y=new e.Utility.ChartAgent,v=y.clone(A.getOptions(),!0),I=y.clone(A.getDetails(),!0);if(v.isStockChart){var f=I;f.co=v;var T=n.view.getActiveGridID(),D=n.view.getResourceID(T),k=n.view.getVersionID(T),E=n.view.getSheetID(T);return r.refreshChart(D,E,v.chart.renderTo,f,k,!0),void A.setClientUpdated(!0)}var O=new i.ChartModel(h,I,v.chart,v.colorOptions,v.xAxis,v.yAxis,v.series,v.title,v.subtitle,v.tooltip,v.plotOptions,v.legend,v.credits,I.ts,I.ds,v.isStockChart,v.lineStyles,v.caption,v.dataForAnimationChart);O.setSeparatorOptions(),O.init(!1,!0);var b=O.constructChartOptions(),R=b.title.text.length>0,L=b.subtitle.text.length>0,w=I.lf,U=null;switch(b.legend&&(U=y.clone(b.legend.itemStyle,!0)),b=C(b,w),"ANIMATION_CHART"!=O.chartDetails.type&&(b=S(b,A.getLegendPosition(),R,L,U)),b.chart.renderTo=y.getRenderTo(g),b.plotOptions.series.animation=!1,a){case l.SUB_TITLE_STYLE:case l.FONT_FAMILY:case l.LEGEND_STYLE:r.updateHighChartsInstance(b,g,A);break;case l.SLANT:case l.STAGGER_LINES:r.updateHighChartsInstance(b,g,A,s.XAXIS_LABELS);break;case l.PLOT_BACKGROUND_COLOR:case l.BACKGROUND_COLOR:case l.BORDER_COLOR:case l.ANIMATION_SPEED:r.updateHighChartsInstance(b,g,A,s.CHART);break;case l.YAXIS_TITLE_STYLE:r.updateHighChartsInstance(b,g,A,s.YAXIS);break;case l.TITLE_STYLE:r.updateHighChartsInstance(b,g,A,s.TITLE_STYLE);break;case l.XAXIS_LABEL_STYLE:case l.XAXIS_TITLE_STYLE:case l.XY_REVERSE:case l.BAR_COUNT:r.updateHighChartsInstance(b,g,A,s.XAXIS);break;case l.GRIDLINE_COLOR:case l.YAXIS_LABEL_STYLE:case l.YAXIS_MIN:case l.YAXIS_MAX:case l.YAXIS_INTERVAL:case l.PLOTLINE_TITLE:case l.PLOTLINE_TITLE_STYLE:case l.PLOTLINE_LABEL_STYLE:case l.ADD_OR_DELETE_PLOTLINE:case l.XY_LOGARITHMIC:case l.XY_BASEVALUE:case l.PLOTLINE_REMOVE:case l.DATALABEL_TOTALS_STYLE:r.updateHighChartsInstance(b,g,A,s.YAXIS);break;case l.XY_LABELS:e.Utility.changeLineColor(b),r.updateHighChartsInstance(b,g,A,s.YAXIS),r.updateHighChartsInstance(b,g,A,s.XAXIS),"ANIMATION_CHART"==A.chartMeta.type&&r.updateHighChartsInstance(b,g,A,s.CHART);break;case l.XY_OPPOSITE:r.updateHighChartsInstance(b,g,A,s.YAXIS),r.updateHighChartsInstance(b,g,A,s.XAXIS);break;case l.CHART_TITLE_ALIGNMENT:r.updateHighChartsInstance(b,g,A,s.CHART_TITLE_ALIGNMENT);break;case l.CHART_SUBTITLE_ALIGNMENT:r.updateHighChartsInstance(b,g,A,s.CHART_SUBTITLE_ALIGNMENT);break;case l.CHART_CAPTION_FONTSIZE:case l.CHART_CAPTION_FONTWEIGHT:case l.CHART_CAPTION_FONTSTYLE:case l.CHART_CAPTION_FONTCOLOR:case l.ENABLE_CAPTION:r.updateHighChartsInstance(b,g,A,s.CHART_CAPTION)}A.setClientUpdated(!0)}}setTimeout(function(){c()},100)})},v.prototype.updateLocale=function(t,o,a,r){for(var c=n.view.getActiveGridID(),s=n.view.getResourceID(c),l=(o=n.view.getVersionID(c),n.view.getSheetID(c)),d=n.data.getWorkBook(s,o).getSheetObj(l).Charts,p=new e.Utility.ChartAgent,u=d.length(),h=0;h<u;h++){var A=d.getKeys(),g=d.get(A[h]);if(g){g.setLocale(r,a);var y=g.getInstance(),v=p.clone(g.getOptions(),!0),S=p.clone(g.getDetails(),!0),C=new i.ChartModel(chartId,S,v.chart,v.colorOptions,v.xAxis,v.yAxis,v.series,v.title,v.subtitle,v.tooltip,v.plotOptions,v.legend,v.credits,S.ts,S.ds,v.isStockChart,v.lineStyles,v.caption,v.dataForAnimationChart);C.setSeparatorOptions(),C.init(!1,!0),e.Utility.redraw.fn.call(this,y)}}},v.prototype.updatePlotlineDashStyle=function(t,i,n,o,a){e.Server.Action.doQuickStyleAction(t,i,n,o.getID(),135,[{isYAxis:!0,dashStyle:a.dashStyle,index:a.yIndex,plIndex:a.pIndex}])},v.prototype.updatePlotlineStyle=function(t,i,n,o,a){e.Server.Action.doQuickStyleAction(t,i,n,o.getID(),136,[{isYAxis:!0,style:a.style,index:a.yIndex,plIndex:a.pIndex}])},v.prototype.updatePlotlineColor=function(t,i,n,o,a){e.Server.Action.doQuickStyleAction(t,i,n,o.getID(),135,[{isYAxis:!0,cbc:a.color,index:a.yIndex,plIndex:a.pIndex}])},v.prototype.updateGradient=function(t,i,n,o){var a=o.getGradient();e.Server.Action.doQuickStyleAction(t,i,n,o.getID(),190,[{enabled:a.enabled,sgType:a.sgType||"radial",sgReversed:a.sgReversed||!1,cgType:a.cgType||"radial",cgReversed:a.cgReversed||!1,iab:a.iab||!1,ias:a.ias||!1}])},v.prototype.updateDataLabelTotals=function(t,i,n,o){e.Utility.getChartMeta([o.cID],!0).setTotalDataLabel(o.enabled),this.doQuickEditClientAction(t,n,i,[o.cID],193,o.enabled),e.Server.Action.doQuickEditAction(t,n,i,[o.cID],193,o.enabled)},v.prototype.updateThresholdValue=function(t,i,n,o){e.Utility.getChartMeta([o.cID],!0).updateThresholdValue(o.enabled),this.doQuickEditClientAction(t,n,i,[o.cID],195,o.value),e.Server.Action.doQuickStyleAction(t,n,i,o.cID,195,[{thValue:o.value}])},v.prototype.updateThresholdColor=function(t,i,n,o){e.Utility.getChartMeta([o.cID],!0).setTotalDataLabel(o.enabled),this.doQuickEditClientAction(t,n,i,[o.cID],196,o.color),e.Server.Action.doQuickStyleAction(t,n,i,o.cID,196,[{thColor:o.color}])},v.prototype.updateDataLabelStyle=function(t,i,n,o){var a=o.getDataLabelStyle();e.Server.Action.doQuickStyleAction(t,i,n,o.getID(),191,[{style:a}])},v.prototype.updateDataLabelTotalStyle=function(t,i,n,o){var a=o.getDataLabelTotalStyle();this.doQuickStyleClientAction(o.getID,o,194),e.Server.Action.doQuickStyleAction(t,i,n,o.getID(),194,[{style:a}])},e.Manager.ZSCManager=v}(this);
!function(e){var t=e.ZSChart,i=t.Server.Action,o=e.sPlusPlus,n=e.ZSEvents,r=n.topic,s=n.Groups,c=n.Names;t.Constants;function p(){}p.prototype.place=function(e){var t=o.view.getActiveGridID(),i=o.view.getResourceID(t),r=o.view.getVersionID(t),p=o.view.getSheetID(t);n.topic.publish(s.Listener,c.SheetAction.CHARTS.PLACE,{RID:i,SHEETID:p,VERSION:r,ID:e})},p.prototype.ResetPosition=function(e,t,i,o){try{for(var n in o){var r=o[n].id;r&&this.place(r)}}catch(e){}},p.prototype.ResizePosition=function(e,i,o,n){var r=new t.Utility.ChartAgent;for(var s in n){var c=n[s],p=c.id,a=r.getInstance(e,i,o,p),I=(parseInt(c.sr||a.getStartRowIndex()),parseInt(c.sc||a.getStartColIndex()),c.wd||a.getWidth()),v=c.ht||a.getHeight();c.top||a.getTop(),c.left||a.getLeft();p&&this.place(p),p&&r.setInstanceSize(e,i,o,p,v,I)}},p.prototype.isImageAction=function(e){return-1!==e.indexOf("img")},p.prototype.focus=function(e){var t=o.view.getActiveGridID(),i=o.view.getResourceID(t),r=o.view.getVersionID(t),p=o.view.getSheetID(t);n.topic.publish(s.Listener,c.SheetAction.CHARTS.FOCUS,{RID:i,SHEETID:p,VERSION:r,CHARTID:e})},p.prototype.blur=function(e){var t=o.view.getActiveGridID(),i=o.view.getResourceID(t),r=o.view.getVersionID(t),p=o.view.getSheetID(t);n.topic.publish(s.Listener,c.SheetAction.CHARTS.BLUR,{RID:i,SHEETID:p,VERSION:r,CHARTID:e})},p.prototype.reposition=function(e,t,o,n,r,s,c,p,a,I){i.Reposition(e,t,o,n,r,s,c,p,a,I)},p.prototype.delete=function(e,o,n,p){if(t.Action.closeMenuTab(),"object"==typeof p)for(var a in p){var I=p[a];i.RemoveChart(e,o,n,I)}else i.RemoveChart(e,o,n,p);r.publish(s.UI,c.SidePanel.CHARTS.CLOSE)},p.prototype.resizeChart=function(e,t,o,n,r,s,c,p,a,I,v,u){i.Resize(e,t,o,n,r,s,c,p,a,I,v,u)},t.Manager.ZSCOleManager=p}(this);
!function(t){var e=t.ZSChart,n=t.sPlusPlus,a=e.Manager,o=t.ZSEvents,r=n.view.getActiveGridID(),i=n.view.getResourceID(r),p=n.view.getSheetID(r),u=n.view.getVersionID(r),l=(n.view.getSheetState(r,p),n.data.getWorkBook(i,u).getSheetObj(p)),C=o.Groups,d=o.Names,g=o.topic,c=e.Constants.ChartPublishConstant,s=new e.Controller.PlayBackController;function y(){}y.prototype.insertChart=function(t,e,n,o,r,i){(new a.ZSCManager).insertChart(t,e,n,o,void 0,void 0,r,i)},y.prototype.publishOleDelete=function(){var t=n.view.getActiveGridID(),e=n.view.getResourceID(t),a=n.view.getVersionID(t),o=n.view.getSheetID(t);this.publishOleDeleteAction(e,o,a)},y.prototype.updateDataRange=function(t,e,n,o){(new a.ZSCManager).updateDataRange(t,e,n,o)},y.prototype.deleteChart=function(t,e,n,o){(new a.ZSCOleManager).delete(t,e,n,o)},y.prototype.doEdit=function(){e.Manager.SidePanelManager;var t=e.Utility.getActiveChart()[0];g.publish(C.UI,d.SidePanel.CHARTS.OPEN,{CHART_ID:t})},y.prototype.doReplay=function(t){var n=[];n.push(0);var a=l.Row&&l.Row.FreezedCount,o=l.Column&&l.Column.FreezedCount;a?o?n.push(1,2,3):n.push(2):o&&n.push(3);var r=e.Utility.getActiveChart(),i=t||r[0],p=e.Utility.getChartMeta([i],!0);s.removePauseResume(i);var u=setTimeout(function(){s.fadeOutButton(i)},e.Constants.Time);if(p)for(var C=0;C<p.chartInstance.length;C++)if(C in n){var d=e.Utility.getPlaybackFunction(i,C);d&&clearTimeout(d),e.Utility.setPlaybackFunction(u,i,C),e.Utility.setAnimating(!0,i,C),e.Utility.refreshChart(p.chartInstance[C],p.chartOptions.dataForAnimationChart,0,!0,i,C)}},y.prototype.stopAllAnimatingCharts=function(t,n,a){for(var o=(new e.Utility.ChartAgent).getAllMetaOfSheet(t,n,a),r=0;r<o.length;r++){var i=o[r].chartMeta,p=i.type,u=i.id;-1!=p.indexOf("ANIMATION_CHART")&&(e.Utility.getAnimating(u,0)||e.Utility.getPaused(u,0))&&this.stopChartAnimation(u)}},y.prototype.stopChartAnimation=function(t){var n=[];n.push(0);var a=l.Row&&l.Row.FreezedCount,o=l.Column&&l.Column.FreezedCount;a?o?n.push(1,2,3):n.push(2):o&&n.push(3);var r=e.Utility.getActiveChart(),i=t||r[0],p=e.Utility.getChartMeta([i],!0);if(s.addPauseClass(i),s.displayButton(i),p)for(var u=0;u<p.chartInstance.length;u++)if(u in n){var C=e.Utility.getPlaybackFunction(i,u);C&&clearTimeout(C),e.Utility.stopAnimationFn(i,u),e.Utility.refreshChart(p.chartInstance[u],p.chartOptions.dataForAnimationChart,p.chartOptions.dataForAnimationChart.length-1,!1,void 0,u),e.Utility.setAnimating(!1,i,u),e.Utility.setPaused(!1,i,u)}},y.prototype.doPauseAction=function(t){var n=[];n.push(0);var a=l.Row&&l.Row.FreezedCount,o=l.Column&&l.Column.FreezedCount;a?o?n.push(1,2,3):n.push(2):o&&n.push(3);var r=e.Utility.getActiveChart(),i=t||r[0],p=e.Utility.getChartMeta([i],!0);s.addResumeClass(i);var u=setTimeout(function(){s.fadeOutButton(i)},1e3);if(p)for(var C=0;C<p.chartInstance.length;C++)if(e.Utility.getAnimating(i,C)&&C in n){var d=e.Utility.getPlaybackFunction(i,C);d&&clearTimeout(d),e.Utility.setPlaybackFunction(u,i,C),e.Utility.stopAnimationFn(i,C),e.Utility.refreshChart(p.chartInstance[C],p.chartOptions.dataForAnimationChart,e.Utility.getPauseIndex(i,C),!1,void 0,C),e.Utility.setAnimating(!1,i,C),e.Utility.setPaused(!0,i,C)}},y.prototype.doResumeAction=function(t){var n=[];n.push(0);var a=l.Row&&l.Row.FreezedCount,o=l.Column&&l.Column.FreezedCount;a?o?n.push(1,2,3):n.push(2):o&&n.push(3);var r=e.Utility.getActiveChart(),i=t||r[0],p=e.Utility.getChartMeta([i],!0);s.removePauseResume(i);var u=setTimeout(function(){s.fadeOutButton(i)},1e3);if(p)for(var C=0;C<p.chartInstance.length;C++)if(e.Utility.getPaused(i,C)&&C in n){var d=e.Utility.getPlaybackFunction(i,C);d&&clearTimeout(d),e.Utility.setPlaybackFunction(u,i,C),e.Utility.setAnimating(!0,i,C),e.Utility.refreshChart(p.chartInstance[C],p.chartOptions.dataForAnimationChart,e.Utility.getPauseIndex(i,C),!0,i,C),e.Utility.setPaused(!1,i,C)}},y.prototype.doChartTypeChange=function(){e.Manager.SidePanelManager;var t=e.Utility.getActiveChart()[0];ZSClass.UIPanelComponent;g.publish(C.UI,d.SidePanel.CHARTS.CHANGE_CHART_TYPE,{CHART_ID:t})},y.prototype.loadChart=function(t,e,n,o){(new a.ZSCManager).loadChart(t,e,n,o)},y.prototype.removeSelection=function(t){new a.ZSCOleManager;var e=n.view.getActiveGridID(),o=n.view.getResourceID(e),r=n.view.getVersionID(e),i=n.view.getSheetID(e),p=n.data.getWorkBook(o,r).getSheetObj(i).Ole.Chart.getActive();for(var u in p){p[u];g.publish(C.Listener,d.Layers.Ole.Blur,{RID:o,SHEETID:i,VERSION:r,ID:chartDetails.id})}},y.prototype.repositionChart=function(t,n,o,r,i,p,u,l,C,d){(new a.ZSCOleManager).reposition(t,n,o,r,i,p,u,l,C,d),e.Client.Action.removeBorderAnimation({ID:r})},y.prototype.focusChart=function(t,n,o,r){var i=new a.ZSCOleManager,p=new e.Utility.CommanAgent;i.focus(t,n,o,r),p.setActiveChartID(r)},y.prototype.blurChart=function(t,n,o,r){var i=new a.ZSCOleManager,p=new e.Utility.CommanAgent;i.blur(t,n,o,r),p.removeActiveChartID()},y.prototype.updateChart=function(t,e,n,o,r){(new a.ZSCManager).updateChart(t,e,n,o)},y.prototype.reRenderChart=function(t,e,n,o,r){(new a.ZSCManager).reRenderChart(t,e,n,o)},y.prototype.updateChartOnGrid=function(t,e,n,o,r){(new a.ZSCManager).updateChartOnGrid(t,e,n,o)},y.prototype.AddOle=function(t,e,n,o,r,i,p,u){(new a.ZSCOleManager).AddOle(t,e,n,o,r,i,p,u)},y.prototype.AddContent=function(t,e,n,o,r){(new a.ZSCOleManager).AddContent(t,e,n,o,r)},y.prototype.updateTheme=function(t){var n=new a.ZSCManager,o=new e.Utility.ChartAgent;n.updateThemeOnGrid(o.getActiveChartID(),t)},y.prototype.reveseColorScheme=function(t){var n=new a.ZSCManager,o=new e.Utility.ChartAgent;n.reveseColorScheme(o.getActiveChartID(),t)},y.prototype.publishChart=function(t,e,n,o,r){(new a.ZSCPublishManager).doPublishAction({status:c.SHOWURL},o,r)},y.prototype.revertPubishChart=function(){(new a.ZSCPublishManager).unPublishChart()},y.prototype.updateLegend=function(t,e,n,o,r){(new a.ZSCManager).updateLegend(t,e,n,o,r)},y.prototype.changeChartType=function(t,e,n,o,r){(new a.ZSCManager).changeChartType(t,e,n,o,r)},y.prototype.updateDataLabel=function(t,e,n,o,r){(new a.ZSCManager).updateDataLabel(t,e,n,o,r)},y.prototype.publishOleDeleteAction=function(t,e,n){g.publish(C.Listener,d.Layers.Ole.Delete,{RID:t,SHEETID:e,VERSION:n})},y.prototype.initColoSchemeEvents=function(){(new a.ZSCColorManager).initEvents()},y.prototype.doPublishAction=function(t,e,n){(new a.ZSCPublishManager).doPublishAction(t,e,n)},y.prototype.rePaintChartOnGrid=function(t,e,n){(new a.ZSCManager).rePaintChartOnGrid(t,e,n)},y.prototype.resetLoadedChartProperty=function(t,e,n){(new a.ZSCManager).resetLoadedChartProperty(t,e,n)},y.prototype.movePosition=function(t,e,n,o){(new a.ZSCOleManager).ResetPosition(t,e,n,o)},y.prototype.ResizePosition=function(t,e,n,o){(new a.ZSCOleManager).ResizePosition(t,e,n,o)},y.prototype.deleteOle=function(t,e,n,o){(new a.ZSCOleManager).deleteOle(t,e,n,o)},y.prototype.doCloneAction=function(t){(new a.ZSCManager).doClone(t)},y.prototype.saveChartAsImage=function(t,e){var n=new a.ZSCManager;g.publish(C.Listener,d.UserAction.COPY_CHART.ADD,{ID:t}),n.saveChartAsImage(t,e)},y.prototype.switchChart=function(t){(new a.ZSCManager).switchChart(t)},y.prototype.doStyleClip=function(t){(new a.ZSCCManager).performStyleAction(t)},y.prototype.resizeChart=function(t,e,n,o,r,i,p,u,l,C,d,g){(new a.ZSCOleManager).resizeChart(t,e,n,o,r,i,p,u,l,C,d,g)},y.prototype.resetSize=function(t,e,n,o,r,i){(new a.ZSCManager).resetSize(t,e,n,o,r,i)},y.prototype.updateLegendStyle=function(t,e,n,o,r){(new a.ZSCManager).updateLegendStyle(t,e,n,o,r)},y.prototype.updateTrendlineType=function(t,e,n,o,r){(new a.ZSCManager).updateTrendlineType(t,e,n,o,r)},y.prototype.updateSorting=function(t,e,n,o,r){(new a.ZSCManager).updateSorting(t,e,n,o,r)},y.prototype.setSortingType=function(t,e,n,o,r){(new a.ZSCManager).setSortingType(t,e,n,o,r)},y.prototype.updateTrendlineDegree=function(t,e,n,o,r){(new a.ZSCManager).updateTrendlineDegree(t,e,n,o,r)},y.prototype.updateTrendlinePeriod=function(t,e,n,o,r){(new a.ZSCManager).updateTrendlinePeriod(t,e,n,o,r)},y.prototype.updateTooltip=function(t,e,n,o,r){(new a.ZSCManager).updateTooltip(t,e,n,o,r)},y.prototype.updateSpline=function(t,e,n,o,r){(new a.ZSCManager).updateSpline(t,e,n,o,r)},y.prototype.updateAnimation=function(t,e,n,o,r){(new a.ZSCManager).updateAnimation(t,e,n,o,r)},y.prototype.updateInverted=function(t,e,n,o,r){(new a.ZSCManager).updateInverted(t,e,n,o,r)},y.prototype.updateXSlant=function(t,e,n,o,r){(new a.ZSCManager).updateXSlant(t,e,n,o,r)},y.prototype.updateStaggerLines=function(t,e,n,o,r){(new a.ZSCManager).updateStaggerLines(t,e,n,o,r)},y.prototype.addPlotLines=function(t,e,n,o,r,i){(new a.ZSCManager).addPlotlines(t,e,n,o,r,i)},y.prototype.addPlotLineName=function(t,e,n,o,r,i){(new a.ZSCManager).addPlotLineName(t,e,n,o,r,i)},y.prototype.removePlotline=function(t,e,n,o,r,i){(new a.ZSCManager).removePlotline(t,e,n,o,r,i)},y.prototype.updateMin=function(t,e,n,o,r){(new a.ZSCManager).updateMin(t,e,n,o,r)},y.prototype.updateAutoExpand=function(t,e,n,o,r){var i=new a.ZSCManager,p=o[0].chartMeta;"ANIMATION_CHART"===p.type&&this.stopChartAnimation(p.chartId),i.updateAutoExpand(t,e,n,o,r)},y.prototype.updateInterpolationOption=function(t,e,n,o,r){var i=new a.ZSCManager;this.stopChartAnimation(),i.updateInterpolationOption(t,e,n,o,r)},y.prototype.updateSumOption=function(t,e,n,o,r){var i=new a.ZSCManager;this.stopChartAnimation(),i.updateSumOption(t,e,n,o,r)},y.prototype.updateMissingValOption=function(t,e,n,o,r){var i=new a.ZSCManager;this.stopChartAnimation(),i.updateMissingValOption(t,e,n,o,r)},y.prototype.updateMax=function(t,e,n,o,r){(new a.ZSCManager).updateMax(t,e,n,o,r)},y.prototype.updateInterval=function(t,e,n,o,r){(new a.ZSCManager).updateInterval(t,e,n,o,r)},y.prototype.updateCBC=function(t,e,n,o,r){(new a.ZSCManager).updateCBC(t,e,n,o,r)},y.prototype.updateChartBorderColor=function(t,e,n,o,r){(new a.ZSCManager).updateChartBorderColor(t,e,n,o,r)},y.prototype.updatePBC=function(t,e,n,o,r){(new a.ZSCManager).updatePBC(t,e,n,o,r)},y.prototype.updateGC=function(t,e,n,o,r){(new a.ZSCManager).updateGC(t,e,n,o,r)},y.prototype.updateMajor=function(t,e,n,o,r){(new a.ZSCManager).updateMajor(t,e,n,o,r)},y.prototype.updateMinor=function(t,e,n,o,r){(new a.ZSCManager).updateMinor(t,e,n,o,r)},y.prototype.updateChartTitle=function(t,e,n,o,r){(new a.ZSCManager).updateChartTitle(t,e,n,o,r)},y.prototype.updateChartSubTitle=function(t,e,n,o,r){(new a.ZSCManager).updateChartSubTitle(t,e,n,o,r)},y.prototype.updateXAxisTitle=function(t,e,n,o,r){(new a.ZSCManager).updateXAxisTitle(t,e,n,o,r)},y.prototype.updateYAxisTitle=function(t,e,n,o,r){(new a.ZSCManager).updateYAxisTitle(t,e,n,o,r)},y.prototype.updateReverse=function(t,e,n,o,r){(new a.ZSCManager).updateReverse(t,e,n,o,r)},y.prototype.updateOpposite=function(t,e,n,o,r){(new a.ZSCManager).updateOpposite(t,e,n,o,r)},y.prototype.updateLogarithmic=function(t,e,n,o,r){(new a.ZSCManager).updateLogarithmic(t,e,n,o,r)},y.prototype.updateBaseValue=function(t,e,n,o,r){(new a.ZSCManager).updateBaseValue(t,e,n,o,r)},y.prototype.updateAnimationSpeed=function(t,e,n,o,r){(new a.ZSCManager).updateAnimationSpeed(t,e,n,o,r)},y.prototype.enableCaption=function(t,e,n,o,r){(new a.ZSCManager).enableCaption(t,e,n,o,r)},y.prototype.updateCaptionFontSize=function(t,e,n,o,r,i){(new a.ZSCManager).updateCaptionFontSize(t,e,n,o,r,i)},y.prototype.updateCaptionFontWeight=function(t,e,n,o,r){(new a.ZSCManager).updateCaptionFontWeight(t,e,n,o,r)},y.prototype.updateCaptionFontStyle=function(t,e,n,o,r){(new a.ZSCManager).updateCaptionFontStyle(t,e,n,o,r)},y.prototype.updateCaptionFontColor=function(t,e,n,o,r){(new a.ZSCManager).updateCaptionFontColor(t,e,n,o,r)},y.prototype.updateBarCount=function(t,e,n,o,r){(new a.ZSCManager).updateBarCount(t,e,n,o,r)},y.prototype.updateLabel=function(t,e,n,o,r){(new a.ZSCManager).updateLabels(t,e,n,o,r)},y.prototype.updateFontFamily=function(t,e,n,o,r){(new a.ZSCManager).updateFontFamily(t,e,n,o,r)},y.prototype.updateTitleStyle=function(t,e,n,o,r,i){(new a.ZSCManager).updateTitleStyle(t,e,n,o,r,i)},y.prototype.updateTitleAlignment=function(t,e,n,o,r,i){(new a.ZSCManager).updateTitleAlignment(t,e,n,o,r,i)},y.prototype.reLoadChartOnGrid=function(t,e,n){(new a.ZSCManager).reLoadChartOnGrid(t,e,n)},y.prototype.updateLineMarker=function(t,e,n,o,r){(new a.ZSCManager).updateLinemarker(t,e,n,o,r)},y.prototype.updateScaleFactor=function(t,e,n,o,r){(new a.ZSCManager).updateScaleFactor(t,e,n,o,r)},y.prototype.updateBinningInterval=function(t,e){(new a.ZSCManager).updateBinningInterval(t,e)},y.prototype.setNumberFormat=function(t,e){(new a.ZSCManager).setNumberFormat(t,e)},y.prototype.doChartCustomization=function(t,e){(new a.ZSCManager).doChartCustomization(t,e)},y.prototype.updateLocale=function(t,e,n,o){(new a.ZSCManager).updateLocale(t,e,n,o)},y.prototype.updateAggregation=function(t,e,n,o,r){(new a.ZSCManager).updateAggregation(t,e,n,o,r)},y.prototype.updateFilter=function(t,e,n,o,r){(new a.ZSCManager).updateFilter(t,e,n,o,r)},y.prototype.updateMultipleYAxis=function(t,e,n,o,r){(new a.ZSCManager).updateMultipleYAxis(t,e,n,o,r)},y.prototype.updateGradient=function(t,e,n,o){(new a.ZSCManager).updateGradient(t,e,n,o)},y.prototype.updatePlotlineStyle=function(t,e,n,o,r){(new a.ZSCManager).updatePlotlineStyle(t,e,n,o,r)},y.prototype.updatePlotlineColor=function(t,e,n,o,r){(new a.ZSCManager).updatePlotlineColor(t,e,n,o,r)},y.prototype.updatePlotlineDashStyle=function(t,e,n,o,r){(new a.ZSCManager).updatePlotlineDashStyle(t,e,n,o,r)},y.prototype.updateDataLabelStyle=function(t,e,n,o){(new a.ZSCManager).updateDataLabelStyle(t,e,n,o)},y.prototype.updateDataLabelTotalStyle=function(t,e,n,o){(new a.ZSCManager).updateDataLabelTotalStyle(t,e,n,o)},y.prototype.addChartToImageLibrary=function(t){var e=n.view.getActiveGridID(),o=n.view.getResourceID(e),r=n.view.getVersionID(e),i=n.view.getSheetID(e);(new a.ZSCManager).addChartToImageLibrary(o,r,i,t)},y.prototype.doServerCopy=function(t,e,n,o){(new a.ZSCManager).doServerCopy(t,e,n,o)},y.prototype.updateDataLabelTotals=function(t){var e=n.view.getActiveGridID(),o=n.view.getResourceID(e),r=n.view.getVersionID(e),i=n.view.getSheetID(e);(new a.ZSCManager).updateDataLabelTotals(o,r,i,t)},y.prototype.updateThresholdValue=function(t){var e=n.view.getActiveGridID(),o=n.view.getResourceID(e),r=n.view.getVersionID(e),i=n.view.getSheetID(e);(new a.ZSCManager).updateThresholdValue(o,r,i,t)},y.prototype.updateThresholdColor=function(t){var e=n.view.getActiveGridID(),o=n.view.getResourceID(e),r=n.view.getVersionID(e),i=n.view.getSheetID(e);(new a.ZSCManager).updateThresholdColor(o,r,i,t)},y.prototype.addChartToView=function(t,e,n,o,r){(new a.ZSCManager).addChartToView(t,e,n,o,r)},e.Controller.ZSCController=y}(this);
!function(t,e){var n=t.ZSEvents,i=n.Groups,o=n.Names,r=n.topic,a=(t.ZSConstants.wCC,t.sPlusPlus),s=t.ZSChart,c=s.Controller,l=s.Constants,E=t.ZSConstants.FeatureConstants,C=l.CAConstant,h=t.UIUtil.Component,u=ZSDevTools.Logger,d=s.Constants.MessageConstant,p=(s.Constants.ChartType,s.Constants.CustomEventName),v=s.Constants.CustomEventGroupName;function A(t){var e=document.createElement("textarea");return e.innerHTML=t,e.innerText}s.Utility.getSVGOptions=function(){var t=new s.Utility.ChartAgent,e=t.clone(this.getDetails(),!0),n=t.clone(this.getOptions(),!0),i=new s.Model.ChartModel(e.id,e,n.chart,n.colorOptions,n.xAxis,n.yAxis,n.series,n.title,n.subtitle,n.tooltip,n.plotOptions,n.legend,n.credits,e.ts,e.ds,n.isStockChart,n.lineStyles,n.caption,n.dataForAnimationChart);return i.setSeparatorOptions(),i.init(!1,!0),function(t){t.title.text=A(t.title.text),t.subtitle.text=A(t.subtitle.text),t.xAxis.title.text=A(t.xAxis.title.text),length=t.yAxis.length;for(var e=0;e<length;e++)t.yAxis[e].title.text=A(t.yAxis[e].title.text);return t}(i.constructChartOptions())},s.Utility.encodeYAxis=function(t){for(var e=t.length,n=0;n<e;n++){var i=t[n];i.title.text=s.Utility.getEncodeStringAfterDecode(i.title.text)}return t},s.Utility.getEncodeStringAfterDecode=function(t){return s.Utility.getEncodeString(s.Utility.getDecodeString(t))},s.Utility.getDecodeString=function(t){try{return decodeURI(unescape(t))}catch(e){try{return unescape(t)}catch(e){return t}}},s.Utility.getEncodeString=function(t){try{return escape(encodeURI(t))}catch(e){try{return escape(t)}catch(e){return t}}},s.Utility.getActiveChart=function(t){var e=a.view.getActiveGridID(),n=a.view.getGridComponent(e).Chart.State.getActive(),i=[];return Object.keys(n).forEach(function(t){n[t]&&i.push(t)}),t?i[0]:i},s.Utility.getSheetCharts=function(){var t=a.view.getActiveGridID(),e=a.view.getResourceID(t),n=a.view.getVersionID(t),i=a.view.getSheetID(t);return{GRIDID:t,RID:e,SHEETID:i,VERSION:n,CHARTS:(new s.Utility.ChartAgent).getAllMetaOfSheet(e,i,n)}},s.Client.Action.addChartToView=function(t,e,n,i,o){try{var r=new c.ZSCController,a=new s.Utility.ChartAgent;r.addChartToView(t,e,n,a.clone(i,!0),!0)}catch(t){u.log("[CHART] >>>>>> Exception caught on chart while adding to viewPort",t)}},s.Client.Action.onGridShift=function(){var t=s.Utility.getSheetCharts();t.CHARTS.forEach(function(e){s.Client.Action.ResetPosition(t.RID,t.SHEETID,t.VERSION,e.getDetails())})},s.Utility.getChartMeta=function(t,e){var n=new s.Utility.ChartAgent,i=[];for(var o in t){var r=t[o],a=n.getChartMeta(r);a&&i.push(a)}return e?i[0]:i},s.Utility.isAllowdToInsertChartInSheet=function(){var t=a.view.getActiveGridID(),e=a.view.getResourceID(t),n=a.view.getVersionID(t),i=a.view.getSheetID(t),o=a.data.getWorkBook(e,n);return o.isEditable()?o.ProtectedSheets.isSheetLocked(i)?d.ERROR.SHEET_LOCKED:d.ALLOWED:d.ERROR.READONLY},s.Action.resetSize=function(t,e,n,i,o,r,a,c,l,E,C,h){try{s.Client.Action.removeBorderAnimation({ID:i}),s.Client.Action.destroyContextualToolbar(),s.Client.Action.resetSize(t,e,n,i,C,h),s.Server.Action.resizeChart(t,e,n,i,o,r,a,c,l,E,C,h)}catch(t){u.log("[CHART] >>>>>> Exception caught while resetting chart size",t)}},s.Action.openMenuTab=function(){s.Client.Action.reArrangeMenuItems(s.Utility.getActiveChart())},s.Action.closeMenuTab=function(){a.view.getViewMenu()},s.Client.Action.setChartState=function(t){var e=a.view.getActiveGridID(),n=a.view.getSheetID(e),i=a.view.getSheetState(e,n),o=new ZSClass.StateChart;i.setChartState(t,o),i.setChartRendered(t,!0)},s.Client.Action.getChartState=function(t){var e=a.view.getActiveGridID(),n=a.view.getSheetID(e);return a.view.getSheetState(e,n).isChartRendered(t)},s.Client.Action.setLocaleOptions=function(t,n){t&&n&&e.setOptions({lang:{decimalPoint:t,thousandsSep:n}})},s.Client.Action.insertChart=function(t,e,n,i,o,r){try{var a=new c.ZSCController;new s.Utility.ChartAgent;a.insertChart(t,e,n,i,o,r)}catch(t){u.log("[CHART] >>>>>> Exception caught while insert chart ",t)}},s.Client.Action.updateLocale=function(t,e,n,i){try{(new c.ZSCController).updateLocale(t,e,n,i)}catch(t){u.log("[CHART] >>>>>> Exception caught while updating Locale for Chart ",t)}},s.Client.Action.deleteChart=function(t,e,n,a){try{var s=[];for(var c in a)s.push(a[c].id);r.publish(i.Listener,o.SheetAction.CHARTS.DELETE_LAYER,{RID:t,SHEETID:e,VERSION:n,ACTIVE_CHART_ID:s}),r.publish(i.UI,o.SidePanel.CHARTS.CLOSE)}catch(t){u.log("[CHART] >>>>>> Exception caught while deleting chart ",t)}},s.Client.Action.OverrideHighchartEvents=function(t){var e=s.Wrapper.DOMUtils,n=(new s.Utility.ChartAgent).getChartMeta(t);if(n){var a=n.getInstance();if(a)for(var c in a){var l=a[c];if(!l.container)return;try{E(l.container)}catch(t){u.log("[Chart] Exception while adding Navigator Events")}try{C(l.container)}catch(t){u.log("[Chart] Exception while adding Navigator Scroll Bar Events")}try{h(l.container)}catch(t){u.log("[Chart] Exception while adding Navigator Scroll Thumb Events")}try{d(l.container)}catch(t){u.log("[CHART] Exception while attaching range label binder")}try{A(l.container)}catch(t){u.log("[Chart] Exception while adding Custom Events to title")}try{S(l.container)}catch(t){u.log("[Chart] Exception while adding Custom Events to subtitle")}try{T(l.container)}catch(t){u.log("[Chart] Exception while adding Custom Events to plot")}try{g(l.container)}catch(t){u.log("[Chart] Exception while adding Custom Events to canvas")}try{y(l.container)}catch(t){u.log("[Chart] Exception while adding Custom Events to xLabels")}try{R(l.container)}catch(t){u.log("[Chart] Exception while adding Custom Events to yLabels")}try{O(l.container)}catch(t){u.log("[Chart] Exception while adding Custom Events to to xAxis")}try{f(l.container)}catch(t){u.log("[Chart] Exception while adding Custom Events to yAxis")}try{I(l.container)}catch(t){u.log("[Chart] Exception while adding Custom Events to yAxis")}}}function E(t){var n=t.querySelector(s.Client.Action.getClassMapping(p.CHART_NAVIGATOR));if(n)for(var i=n.children,o=i.length,r=0;r<o;r++){a(i[r])}function a(t){t.classList.contains("highcharts-navigator-handle")?(e.addEventByNode(t,e.Events.MOUSEDOWM,function(t){this.style.cursor="col-resize",t.stopPropagation(),t.preventDefault()},!0),e.addEventByNode(t,e.Events.MOUSEOVER,function(t){this.style.cursor="col-resize"},!0)):(e.addEventByNode(t,e.Events.MOUSEDOWM,function(t){this.style.cursor="move",t.stopPropagation(),t.preventDefault()},!0),e.addEventByNode(t,e.Events.MOUSEOVER,function(t){this.style.cursor="move"},!0)),e.addEventByNode(t,e.Events.MOUSELEAVE,function(t){this.style.cursor="inherit"},!0)}}function C(t){var n=t.querySelectorAll(s.Client.Action.getClassMapping(p.CHART_SCROLLBAR));n&&(e.addEventByNode(n,e.Events.MOUSEDOWM,function(t){this.style.cursor="pointer",t.stopPropagation(),t.preventDefault()},!0),e.addEventByNode(n,e.Events.MOUSEOVER,function(t){this.style.cursor="pointer"},!0),e.addEventByNode(n,e.Events.MOUSELEAVE,function(t){this.style.cursor="inherit"},!0))}function h(t){var n=t.querySelectorAll(s.Client.Action.getClassMapping(p.CHART_SCROLLBAR_THUMB));n&&(e.addEventByNode(n,e.Events.MOUSEDOWM,function(t){this.style.cursor="move",t.stopPropagation(),t.preventDefault()},!0),e.addEventByNode(n,e.Events.MOUSEOVER,function(t){this.style.cursor="move"},!0),e.addEventByNode(n,e.Events.MOUSELEAVE,function(t){this.style.cursor="inherit"},!0))}function d(t){var n=t.querySelectorAll(s.Client.Action.getClassMapping(p.CHART_TIME_RANGE_INPUT));if(n)for(var a=n.length||0,c=0;c<a;c++){l(n[c])}function l(t){var n=t.children;e.addEventByNode(n,e.Events.CLICK,function(t){this.style.cursor="text",r.publish(i.UI,o.SidePanel.CHARTS.SETFOCUS)},!0),e.addEventByNode(n,e.Events.KEYDOWN,function(t){this.style.cursor="text",r.publish(i.UI,o.SidePanel.CHARTS.SETFOCUS)},!0),e.addEventByNode(n,e.Events.BLUR,function(t){this.style.cursor="inherit",r.publish(i.Listener,Names.KeyBoard.ChangeContext,{CONTEXT:"Grid"})},!0)}}function A(a){var c=a.querySelector(s.Client.Action.getClassMapping(p.CHART_TITLE));c&&(e.addEventByNode(c,e.Events.CLICK,function(e){s.Client.Action.applyCustomEvents(n,v.TITLES,{subAction:1,suffix:""},e),r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_TITLE})},!0),e.addEventByNode(c,e.Events.MOUSEOVER,function(){this.style.cursor="pointer",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_TITLE,HOVER:!0})},!0),e.addEventByNode(c,e.Events.MOUSELEAVE,function(){this.style.cursor="auto",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0))}function S(a){var c=a.querySelector(s.Client.Action.getClassMapping(p.CHART_SUBTITLE));c&&(e.addEventByNode(c,e.Events.CLICK,function(e){s.Client.Action.applyCustomEvents(n,v.TITLES,{subAction:2,suffix:""},e),r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_SUBTITLE})},!0),e.addEventByNode(c,e.Events.MOUSEOVER,function(){this.style.cursor="pointer",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_SUBTITLE,HOVER:!0})},!0),e.addEventByNode(c,e.Events.MOUSELEAVE,function(){this.style.cursor="auto",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0))}function T(t){var n=t.querySelector(s.Client.Action.getClassMapping(p.CHART_PLOT));n&&(e.addEventByNode(n,e.Events.MOUSEOVER,function(){this.style.cursor="pointer !important"},!0),e.addEventByNode(n,e.Events.MOUSEDOWM,function(){this.style.cursor="inherit"},!0),e.addEventByNode(n,e.Events.MOUSELEAVE,function(){this.style.cursor="inherit"},!0))}function g(a){var c=a.querySelector(s.Client.Action.getClassMapping(p.CHART_BACKGROUND));c&&(e.addEventByNode(c,e.Events.MOUSEDOWM,function(){this.style.cursor="inherit"},!0),e.addEventByNode(c,e.Events.CLICK,function(e){s.Client.Action.applyCustomEvents(n,v.STYLES,void 0,e),r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_BACKGROUND})},!0),e.addEventByNode(c,e.Events.MOUSEOVER,function(e){this.style.cursor="pointer !important",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_BACKGROUND,HOVER:!0})},!0),e.addEventByNode(c,e.Events.MOUSELEAVE,function(e){r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t}),this.style.cursor="inherit"},!0))}function y(a){var c=a.querySelector(s.Client.Action.getClassMapping(p.CHART_XAXIS_LABELS));c&&(e.addEventByNode(c,e.Events.CLICK,function(e){s.Client.Action.applyCustomEvents(n,v.HAXIS,void 0,e),r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_XAXIS_LABELS})},!0),e.addEventByNode(c.children,e.Events.MOUSEOVER,function(){this.style.cursor="pointer",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_XAXIS_LABELS,HOVER:!0})},!0),e.addEventByNode(c.children,e.Events.MOUSELEAVE,function(){this.style.cursor="auto",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0))}function R(a){var c=a.querySelectorAll(s.Client.Action.getClassMapping(p.CHART_YAXIS_LABELS));if(c)for(var l=c.length,E=0;E<l;E++)C(c[E],E);function C(a,c){e.addEventByNode(a,e.Events.CLICK,function(e){s.Client.Action.applyCustomEvents(n,v.VAXIS,{index:c},e),r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_YAXIS_LABELS,INDEX:c})},!0),e.addEventByNode(a.children,e.Events.MOUSEOVER,function(){this.style.cursor="pointer",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_YAXIS_LABELS,INDEX:c,HOVER:!0})},!0),e.addEventByNode(a.children,e.Events.MOUSELEAVE,function(){this.style.cursor="auto",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0)}}function O(a){var c=a.querySelector("div"+s.Client.Action.getClassMapping(p.CHART_XAXIS_TITLE));c&&(e.addEventByNode(c.children,e.Events.CLICK,function(e){s.Client.Action.applyCustomEvents(n,v.TITLES,{subAction:3,suffix:""},e),r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_XAXIS_TITLE})},!0),e.addEventByNode(c.children,e.Events.MOUSEOVER,function(){this.style.cursor="pointer",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_XAXIS_TITLE,HOVER:!0})},!0),e.addEventByNode(c.children,e.Events.MOUSELEAVE,function(){this.style.cursor="pointer",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0))}function f(a){var c=a.querySelectorAll("div"+s.Client.Action.getClassMapping(p.CHART_YAXIS_TITLE));if(c)for(var l=c.length,E=0;E<l;E++)C(c[E],E);function C(a,c){e.addEventByNode(a.children,e.Events.CLICK,function(e){s.Client.Action.applyCustomEvents(n,v.TITLES,{subAction:0==c?4:5,suffix:0==c?"":c},e),r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_YAXIS_TITLE,INDEX:c})},!0),e.addEventByNode(a.children,e.Events.MOUSEOVER,function(){this.style.cursor="pointer",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_YAXIS_TITLE,INDEX:c,HOVER:!0})},!0),e.addEventByNode(a.children,e.Events.MOUSELEAVE,function(){this.style.cursor="pointer",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0)}}function I(n){var a=n.querySelector(s.Client.Action.getClassMapping(p.CHART_LEGEND));a&&(e.addEventByNode(a,e.Events.MOUSEOVER,function(){this.style.cursor="pointer",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:t,evType:p.CHART_LEGEND,HOVER:!0})},!0),e.addEventByNode(a,e.Events.MOUSELEAVE,function(){this.style.cursor="pointer",r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,{ID:t})},!0))}},s.Client.Action.addSynchronization=function(t,e){var n=e.co;function a(t,e,n,a){var c=(new s.Utility.ChartAgent).getChartMeta(n);if(s.Utility.isContextMenuAlive())return s.Client.Action.applyCustomEvents(c,v.LEGEND,void 0,a.browserEvent),r.publish(i.UI,o.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,{ID:n,evType:p.LEGEND}),!1;var l=c.getInstance(),E=new s.Utility.CommanAgent;for(var C in l){var h=l[C];if(E.isFallUnderCompositionType(c.getType())){var u=h.series[t].data[e];u.setVisible(!u.visible,!1)}else{var d=h.series[t];d.setVisible(!d.visible,!1)}}for(var C in l){(h=l[C]).redraw()}return!1}function c(e,n){!function(t){t.chart.events||(t.chart.events={}),t.chart.events.render=function(){this.hasData()?this.hideNoData():this.showNoData()}}(e),e.plotOptions[n]||(e.plotOptions[n]={}),e.plotOptions[n].point||(e.plotOptions[n].point={}),e.plotOptions[n].point.events||(e.plotOptions[n].point.events={}),e.plotOptions[n].point.events.mouseOver=function(e){!function(t,e){try{t=t.target;var n=(new s.Utility.ChartAgent).getChartMeta(e).getInstance(),i=t.index,o=t.series.index;for(var r in t.series.chart,n){var a=n[r];try{var c=a.series[o].points[i];c&&(c.setState("hover",!0),a.tooltip.shared?a.tooltip.refresh([c]):a.tooltip.refresh(c))}catch(t){}}}catch(t){}}(e,t)},e.plotOptions[n].point.events.mouseOut=function(e){!function(t,e){try{t=t.target;var n=(new s.Utility.ChartAgent).getChartMeta(e).getInstance(),i=t.index,o=t.series.index;for(var r in t.series.chart,n){var a=n[r];try{var c=a.series[o].points[i];c&&(c.setState(""),a.hideToolip())}catch(t){}}}catch(t){}}(e,t)},e.plotOptions.series||(e.plotOptions.series={}),e.plotOptions.series.point||(e.plotOptions.series.point={}),e.plotOptions.series.events||(e.plotOptions.series.events={}),e.plotOptions.series.cursor="pointer",e.plotOptions.series.point.events||(e.plotOptions.series.point.events={}),e.plotOptions.series.point.events.legendItemClick=function(e){return a(this.series.index,this.index,t,e)},e.plotOptions.series.point.events.click=function(e){!function(t,e,n,i){var o=(new s.Utility.ChartAgent).getChartMeta(i),r=o.getInstance();for(var a in r){var c=r[a];try{var l=c.series[e].data[n];l&&l.slice&&l.slice()}catch(t){}}var E=s.Manager.SidePanelManager;E&&E.isPanelOpen()&&(o.addSelectionState(e),s.Client.Action.applyCustomEvents(o,v.SERIES,{sIndex:e,pIndex:n},t))}(e,this.series?this.series.index:0,this.index,t)},e.plotOptions.series.events.legendItemClick=function(e){var n=this.index;return a(n,n,t,e)}}if(e.type==l.ChartType.COMBOCHART){var E=n.series;for(var C in E){var h=E[C];h&&c(n,h.type)}}else c(n,n.chart.type);return e},s.Client.Action.reArrangeMenuItems=function(t){try{r.publish(i.Listener,o.UserAction.CHARTS.RESET_MENU,{ACTIVE_CHART_ID:t})}catch(t){u.log("[CHART] >>>>>> Exception caught while reArrangeMenuItems ",t)}},s.Client.Action.loadChart=function(t,e,n,i){try{var o=new c.ZSCController,r=new s.Utility.ChartAgent;o.loadChart(t,e,n,r.clone(i,!0))}catch(t){u.log("[CHART] >>>>>> Exception caught while loading chart ",t)}},s.Client.Action.focusChart=function(t,e,n,i){try{(new c.ZSCController).focusChart(t,e,n,i)}catch(t){u.log("[CHART] >>>>>> Exception caught while chart focus ",t)}},s.Client.Action.blurChart=function(t,e,n,i){try{(new c.ZSCController).blurChart(t,e,n,i)}catch(t){u.log("[CHART] >>>>>> Exception caught while chart blur ",t)}},s.Client.Action.updateChart=function(t,e,n,i,o){try{var r=new c.ZSCController,a=new s.Utility.ChartAgent;r.updateChart(t,e,i,a.clone(n,!0));for(var l=n?n.length:0,E=0;E<l;E++){var C=n[E].id;s.Client.Action.OverrideHighchartEvents(C),s.Client.Action.reApplyCustomHoverSvg()}}catch(t){u.log("[CHART] >>>>>> Exception caught while updating chart ",t)}},s.Client.Action.updateChartOnGrid=function(t,e,n,i,o){try{var r=new c.ZSCController,a=new s.Utility.ChartAgent;r.updateChartOnGrid(t,e,n,a.clone(i,!0))}catch(t){u.log("[CHART] >>>>>> Exception caught while updating chart on grid ",t)}},s.Client.Action.publishChart=function(t,e,n,i,o){try{(new c.ZSCController).publishChart(t,e,n,i,o)}catch(t){u.log("[CHART] >>>>>> Exception caught on chart Publish ",t)}},s.Client.Action.rePaint=function(t,e,n,i){try{var o=new c.ZSCController;!i&&o.rePaintChartOnGrid(t,e,n),i&&o.reLoadChartOnGrid(t,e,n)}catch(t){u.log("[CHART] >>>>>> Exception caught on chart rePaint ",t)}},s.Client.Action.resetVisited=function(t,e,n){try{var i=new c.ZSCController;i.resetLoadedChartProperty(t,e,n),i.stopAllAnimatingCharts(t,e,n)}catch(t){u.log("[CHART] >>>>>> Exception caught on chart resetVisited ",t)}},s.Client.Action.beforeSheetSwitchAction=function(t,e,n){try{r.publish(i.Listener,o.SheetAction.CHARTS.RESETVISIT,{RID:t,SHEETID:e,VERSION:n}),s.Action.closeMenuTab()}catch(t){}},s.Client.Action.afterSheetSwitchAction=function(t,e,n){try{r.publish(i.Listener,o.SheetAction.CHARTS.REPAINT,{RID:t,SHEETID:e,VERSION:n})}catch(t){}},s.Client.Action.reRenderChart=function(t,e,n,i,o){try{var r=new c.ZSCController,a=new s.Utility.ChartAgent;r.reRenderChart(t,e,i,a.clone(n,!0))}catch(t){u.log("[CHART] >>>>>> Exception caught on chart  RE - RenderChart",t)}},s.Client.Action.ResetPosition=function(t,e,n,i){try{var o=new c.ZSCController,r=new s.Utility.ChartAgent;o.movePosition(t,e,n,r.clone(i,!0))}catch(t){u.log("[CHART] >>>>>> Exception caught on reset position ",t)}},s.Client.Action.deleteOle=function(t,e,n,i,o){try{var r=new c.ZSCController,a=new s.Utility.ChartAgent;r.deleteOle(t,e,n,a.clone(i,!0))}catch(t){u.log("[CHART] >>>>>> Exception caught on delete chart layer ",t)}},s.Client.Action.updateDataRange=function(t,e,n,i){try{(new c.ZSCController).updateDataRange(t,e,n,i)}catch(t){u.log("[CHART] >>>>>> Exception caught on data range update ",t)}},s.Client.Action.resizePosition=function(t,e,n,i){try{var o=new c.ZSCController,r=new s.Utility.ChartAgent;o.ResizePosition(t,e,n,r.clone(i,!0))}catch(t){u.log("[CHART] >>>>>> Exception caught on reset position ",t)}},s.Client.Action.resetSize=function(t,e,n,i,o,r){try{(new c.ZSCController).resetSize(t,e,n,i,o,r)}catch(t){u.log("[CHART] >>>>>> Exception caught on resizeChart ",t)}},s.Client.Action.updateBoundary=function(t,e,n){try{for(var a=(new s.Utility.ChartAgent).getAllChartID(t,e,n),c=a.length,l=0;l<c;l++){var E=a[l];r.publish(i.Listener,o.SheetAction.CHARTS.PLACE,{RID:t,SHEETID:e,VERSION:n,ID:E})}}catch(t){}},!s.transient&&(s.transient={}),!s.transient.Toolbar&&(s.transient.Toolbar={}),s.transient[C.DEFER_CHART_INIT]=function(){var t=a.view.getActiveGridID(),e=a.view.getResourceID(t),n=a.view.getVersionID(t),s=a.view.getSheetID(t);r.publish(i.Listener,o.SheetAction.CHARTS.REPAINT,{RID:e,SHEETID:s,VERSION:n})},s.transient.Toolbar[E.CHART_COLOR_SCHEME]=function(){!function(){var e=s.Wrapper.DOMUtils;if(!e.getElementById("DI_CHART_COLOR_SCHEME")){var n=t.UserAction.getTemplate(["chartColorSchemeTemplate"]),i=e.createElement("div");i.id="DI_CHART_COLOR_SCHEME",i.style.display="none",i.classList.add("zSChrtClrPlt"),i.appendChild(n.chartColorSchemeTemplate),e.appendChild(document.body,i),h.initComponent("#DI_CHART_COLOR_SCHEME")}}()}}(this,Highcharts);
!function(e){var r=e.ZSEvents,t=(r.Groups,r.Names,r.topic,e.sPlusPlus,e.ZSChart),n=t.Controller;t.Constants,e.ZSConstants.FeatureConstants;t.Server.Action.repositionChart=function(e,r,t,o,C,s,i,l,a,S){(new n.ZSCController).repositionChart(e,r,t,o,C,s,i,l,a,S)},t.Server.Action.resizeChart=function(e,r,t,o,C,s,i,l,a,S,c,u){(new n.ZSCController).resizeChart(e,r,t,o,C,s,i,l,a,S,c,u)},t.Server.Action.deleteChart=function(e,r,t,o){(new n.ZSCController).deleteChart(e,r,t,o)},t.Server.Action.doServerCopy=function(e,r,t,o){(new n.ZSCController).doServerCopy(e,r,t,o)}}(this);
!function(e){var t=e.ZSEvents,i=t.Groups,n=t.Names,r=e.ZSChart,E=t.topic,S=r.Constants,A=e.ZSConstants.FeatureConstants,R=S.CAConstant;E.register(i.Listener,n.GridAction.WheelXYPaneContainerScroll,r.Client.Action.destroyContextualToolbar),E.register(i.UI,n.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,r.Client.Action.removeRect,"ID"),E.register(i.UI,n.SidePanel.CHARTS.CUSTOM.REMOVE_HOVER,r.Client.Action.removeHoverRect,"ID"),E.register(i.UI,n.SidePanel.CHARTS.CUSTOM.HOVER_EVENT,r.Client.Action.applyCustomHoverSvg,"ID","evType","INDEX","HOVER"),E.register(i.UI,n.SidePanel.CHARTS.CUSTOM.INIT_PROPERTY,r.Client.Action.initCutomEventProperty,"CONFIG"),E.register(i.UI,n.SidePanel.CHARTS.CUSTOM.EVENTS,r.Client.Action.applyContextualToolbar,"PROPERTIES"),E.register(i.UI,n.Layout.TEMPLATE_LOADED,r.transient.Toolbar[A.CHART_COLOR_SCHEME]),E.register(i.Listener,n.SheetAction.CHARTS.PUBLISH,r.Client.Action.publishChart,"RID","SHEETID","VERSION","CHARTS","AOWNER"),E.register(i.Listener,n.SheetAction.CHARTS.EDIT,r.Client.Action.updateChartOnGrid,"RID","SHEETID","VERSION","CHARTS","AOWNER"),E.register(i.Listener,n.SheetAction.CHARTS.MODIFY,r.Client.Action.reRenderChart,"RID","SHEETID","CHARTS","VERSION","AOWNER"),E.register(i.Listener,n.SheetAction.CHARTS.DELETE,r.Client.Action.deleteChart,"RID","SHEETID","VERSION","CHARTS","AOWNER"),E.register(i.Listener,n.SheetAction.CHARTS.UPDATE,r.Client.Action.updateChart,"RID","SHEETID","CHARTS","VERSION","AOWNER"),E.register(i.Listener,n.SheetAction.CHARTS.RESIZE,r.Client.Action.resizePosition,"RID","SHEETID","VERSION","CHARTS"),E.register(i.Listener,n.SheetAction.CHARTS.MOVE,r.Client.Action.ResetPosition,"RID","SHEETID","VERSION","CHARTS"),E.register(i.UserAction,n.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,r.Client.Action.beforeSheetSwitchAction,"RID","SHEETID","VERSION"),E.register(i.Listener,n.SheetAction.CHARTS.RESETVISIT,r.Client.Action.resetVisited,"RID","SHEETID","VERSION"),E.register(i.Listener,n.SheetAction.CHARTS.REPAINT,r.Client.Action.rePaint,"RID","SHEETID","VERSION","ZOOM"),E.register(i.Listener,n.SheetAction.HIDEROWS.ADD,r.Client.Action.updateBoundary,"RID","SHEETID","VERSION"),E.register(i.Listener,n.SheetAction.HIDEROWS.REMOVE,r.Client.Action.updateBoundary,"RID","SHEETID","VERSION"),E.register(i.Listener,n.SheetAction.HIDECOLS.ADD,r.Client.Action.updateBoundary,"RID","SHEETID","VERSION"),E.register(i.Listener,n.SheetAction.HIDECOLS.REMOVE,r.Client.Action.updateBoundary,"RID","SHEETID","VERSION"),E.register(i.Listener,n.SheetAction.CHARTS.UPDATE_LOCALE,r.Client.Action.updateLocale,"RID","VERSION","THOUSAND_SEPERATOR","DECIMAL_SEPERATOR"),E.register(i.Listener,n.SheetAction.HIDEROWS.ADD,r.Client.Action.onGridShift),E.register(i.Listener,n.SheetAction.HIDEROWS.REMOVE,r.Client.Action.onGridShift),E.register(i.Listener,n.SheetAction.HIDECOLS.REMOVE,r.Client.Action.onGridShift),E.register(i.Listener,n.SheetAction.HIDECOLS.ADD,r.Client.Action.onGridShift),E.register(i.Listener,n.SheetAction.CHARTS.ADD,r.Client.Action.addChartToView,"RID","SHEETID","VERSION","CHARTS","AOWNER"),r.transient[R.DEFER_CHART_INIT]()}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSClass,a=null,r=(e.JSUtill,e.UserAction,e.ZSConstants.I18N),o=e.UIUtil.Component,n=e.ZSChart,s=(n.Constants.ServiceProvider,n.Constants.ChartType),l=n.Constants.ColorSchemeType,p=n.Constants.ChartRangePickerType,d=e.ZSDevTools.Logger,c=e.ZSEvents,g=(c.Groups,c.Names,c.topic,e.ZSEC,new n.Controller.ZSCController);function h(){}function u(e,t){for(var i=e.getInstance(),a=i.length,r=[],o=0;o<a;o++){var n=i[o];(n=n.refresh(t)).setPositiveExtreme(!1),r.push(n)}e.setInstance(r)}h.prototype.init=function(){this.previewOn=!0,this.state="ADD",this.prevChartType="COL",this.dialogMeta={},this.currentChartType="COL",this.UNPROCESSEDTASK={},this.chartId="preview",this.responseObj=null,this.id=["preview"],this.taskType="recommendation",this.tabName="General",this.activeId="preview",this.activeRecommendationID=null,this.allowPostProcess=!0,this.sidePanelState=!1},h.prototype.isCellExceeded=function(e){var t=this.dialogMeta[e];return!!t&&t.isCellExceeded()},h.prototype.getDialogMeta=function(e){return this.dialogMeta[e]},h.prototype.setSidePanelState=function(e){this.sidePanelState=e},h.prototype.getSidePanelState=function(){return this.sidePanelState},h.prototype.getPreviousChartType=function(){return this.prevChartType},h.prototype.updateDataLabelTotals=function(e){var t=this.dialogMeta[e.cID];t&&t.updateDataLabelTotals(e.enabled)},h.prototype.updateThresholdValue=function(e){var t=this.dialogMeta[e.cID];t&&t.updateThresholdValue(e.value)},h.prototype.updateThresholdColor=function(e){var t=this.dialogMeta[e.cID];t&&t.updateThresholdColor(e.color)},h.prototype.setPreviousChartType=function(e){this.prevChartType="BUBBLE"===e?"BUBBLECHART":e},h.prototype.setSelectedChartType=function(e){this.prevChartType=this.currentChartType=e},h.prototype.stopPostProcess=function(){this.allowPostProcess=!1},h.prototype.enablePostProcess=function(){this.allowPostProcess=!0},h.prototype.isPostProcessAllowed=function(){return this.allowPostProcess},h.prototype.changeType=function(e,t){var i=this.dialogMeta[t||this.chartId];this.prevChartType=e,i&&i.setType(e)},h.prototype.updateRequiredProperty=function(e,t){(this.dialogMeta[t]||this.dialogMeta.preview).dLables=e.dLables},h.prototype.isPreviewOn=function(){return this.previewOn},h.prototype.setPreviewStatus=function(e){this.previewOn=e},h.prototype.setResposne=function(e){this.responseObj=e},h.prototype.clearResposne=function(){this.responseObj=null},h.prototype.processPreviewResponse=function(e){n.Wrapper.DOMUtils.addStyle("preview",{display:"table-cell"}),this.setResposne(e),this.doPreprocess(!0),this.doPostProcess(!0),this.clearDom(!1),this.clearResposne()},h.prototype.populateFilterColumnsIfNeeded=function(e,t,i){var a=this.dialogMeta[e];if(a){if(n.Aggregation.checkIfOperationIsValueManipulative(t)!==n.Aggregation.checkIfOperationIsValueManipulative(i)){a.setAggregationOperation(i);var r=new n.Utility.AgentDom;return r.rePopulateFilterColumns(a),setTimeout(function(){r.setFilterColumnBasedOnInput(a)},200),!0}return!1}},h.prototype.populateNumericColumnsIfNeeded=function(e,t,i){var a=this.dialogMeta[e];if(a){if(n.Aggregation.checkIfOperationIsValueManipulative(t)!==n.Aggregation.checkIfOperationIsValueManipulative(i)){a.setAggregationOperation(i);var r=new n.Utility.AgentDom;return r.rePopulateNumericColumns(a),setTimeout(function(){r.setFilterColumnBasedOnInput(a)},200),!0}return!1}},h.prototype.processRecommendationResponse=function(e){for(var t=e,i=0;i<t.length;i++){var a,r=t[i];if(r.co)i&&(a=this.chartId+i),i&&this.id.push(a),r.co.chart.renderTo=a}this.addUnProcessTask(this.taskType,this.doRecommendationTask.bind(this),t,{startIndex:1,isShift:!0}),setTimeout(function(){this.checkToPerformUnProcessedTask()}.bind(this),10)},h.prototype.processResponse=function(e){this.setResposne(e),this.clearDom(),this.doPreprocess(),this.doPostProcess(),this.clearResposne()},h.prototype.setActiveId=function(e){this.activeId=e},h.prototype.getActiveId=function(e){return this.activeId},h.prototype.resetIDs=function(){this.id=["preview"]},h.prototype.doPreprocess=function(e){this.enablePostProcess(),this.resetIDs(),(new n.Utility.AgentDom).hideRecommendationDOM();for(var t=this.responseObj,i=0;i<t.length;i++){var a,r=t[i];i&&(a=this.chartId+i),!i&&(a=this.chartId),i&&this.addUnProcessTask(this.taskType,this.doRecommendationTask.bind(this),t,{startIndex:i,isShift:!0}),i&&this.id.push(a),r.co&&r.co.chart&&(r.co.chart.renderTo=a)}var o=(new n.Utility.ChartAgent).isArray(t);!o&&!e&&this.alertInvalidRecommendation();var s=o?t[0]:t;try{!o&&(s.co.chart.renderTo=this.chartId),e&&!o&&(s.isMutedUpdate=e),this.setActiveId(this.chartId),!e&&this.grabProperty(s,this.sidePanelState),e&&this.updateRequriedProperty(s),e&&this.updateGroupingStates(s),this.setSelectedChartType(s.type),this.sidePanelState||this.updateDialog()}catch(e){d.log("[CHART] Chart DialogMeta Throwing exception while redering chart in dialog",e),this.alertForInvalidCase(s),this.stopPostProcess(!0)}},h.prototype.generateAlertMessage=function(e){var t,i=-1!==e.type.indexOf(s.BUBBLE.toUpperCase())?2:4,a=r.Bubble,o="";switch(e.type){case"CANDLESTICK":a=r.CandleStick;break;case"OHLC":a=r.OHLC;break;case"TIMELINE":a=r["Chart.Time.Line"];break;case"TIMEAREA":a=r["Chart.Time.Area"];break;case"WATERFALL":a=r["Chart.Type.Waterfall"];break;case"COMBOCHART":a=r["Chart.Type.Combo"]}return e.isPivotChart?(o=JSUtil.fn.replaceParams(r["PivotChart.Not.Allowed"],new Array(a)),t=r["Alert.Title.InvalidChartType"]):(o=JSUtil.fn.replaceParams(r["Chart.Preview.Not.Allowed"],new Array(a,i)),t=r["Alert.Title.InvalidSourceRange"]),{msg:o,titleKey:t}},h.prototype.alertForInvalidCase=function(e){var t,a=e.reason,o="",s=a.ice,l=a.iad;if(s&&(o=JSUtil.fn.replaceParams(r["Chart.Cells.Count.Exceeded"],new Array("3000"))),s&&(t=r["Alert.Title.LimitExceeded"]),!s&&!l){var p=this.generateAlertMessage(a);o=p.msg,t=p.titleKey}var d=n.Wrapper.DOMUtils;i.ZSAlert(o,{title:t}),d.hideById("chartRecommend"),d.hideById("chartRecommendTitle")},h.prototype.updateRequriedProperty=function(e){if(e){var t=this.dialogMeta[this.activeId];t&&t.setExtractOptions(e),t&&t.extractYAxisProperty(),t&&t.extractXAxisProperty(),t&&t.constructStyleProperty()}},h.prototype.doPostProcess=function(e){var t,i=this.getResponse();a=new n.Utility.ChartAgent;var r=n.Wrapper.DOMUtils;if(t=a.isArray(i)?i[0]:i,this.isPostProcessAllowed()&&!this.getSidePanelState())r.getElementByClassName("chrtPreview").setAttribute("id","preview"),this.renderChart(t),this.doNoDataFoundAction(t),this.updateCurrentTabName();else if(this.isPostProcessAllowed()&&this.getSidePanelState()){this.insertChart(t);new n.Utility.AgentDom,r=n.Wrapper.DOMUtils;n.Manager.SidePanelManager.setUnProcessed(this.UNPROCESSEDTASK)}},h.prototype.updateDialog=function(){new n.Utility.ChartAgent;var e=this.getActiveId(),t=this.dialogMeta[e];(new n.Utility.AgentDom).updateDialog(t),this.hideUnwantedProperty(e)},h.prototype.updateRequiredDialogProperty=function(e,t){(new n.Utility.AgentDom).generatePlotline(e.yAxis,t||0)},h.prototype.hideUnwantedProperty=function(e,t){var i=this.dialogMeta[e];(new n.Utility.AgentDom).hidePropertyBasedOnMeta(i,!this.sidePanelState,t)},h.prototype.PROCESSTASK=function(e){var t,i=this.UNPROCESSEDTASK[e];if(i)for(var a in i){var r=(t=i[a]).parameters,o=t.optional;try{t.fn(r,o)}catch(e){d.log("[CHART] Chart DialogMeta PROCESSTASK Throwing exception while redering chart in dialog",e)}}delete this.UNPROCESSEDTASK[e]},h.prototype.trimChartData=function(e){var t=Math.min(10,e.co.series.length);e.co.series=e.co.series.splice(0,t);for(var i=0;i<t;i++){var a=Math.min(50,e.co.series[i].data.length);e.co.series[i].data=e.co.series[i].data.splice(0,a)}return e},h.prototype.renderRecommendation=function(e,t){var i=e.shift();i&&i.co&&((new n.Utility.AgentDom).showRecommendationDOM(),i=this.trimChartData(i),this.recommendChart(i,t,this).then(function(){this.renderRecommendation(e,++t)}.bind(this)));this.setRecommedationSelection()},h.prototype.renderChart=function(e){this.loadPreview(e)},h.prototype.recommendChart=function(e,t,i){return new Promise(function(a,r){var o,s,l,p,d=n.Wrapper.DOMUtils,c=e,g=i.getSidePanelState()?"recWrapper1":"recWrapper",h=d.getElementById("chrtTypeWrapper");p={class:g,"border-color":"rgb(25, 175, 92)",width:"50px",height:"50px"};var u=h.querySelector("#recommendChartPreview");d.addChild("chartWrapperDiv",u,p);s=i.id[t]?i.id[t]:i.id[0]+t,l=c.type,p={class:"recChartDiv",id:s,style:"height : inherit;width:inherit;","data-id":s},o=d.addChildByIndex("chartDiv",g,p,t-1),p={class:"recChartName",id:"tooltip"+t,"data-id":s};var v=d.addChildByIndex("chartNameDiv",g,p,t-1);v.addEventListener("click",function(e){e.stopPropagation(),i.getSidePanelState()?(i.unSelectRecommendation(),i.selectRecommendedChart(s),i.updateChart(s)):i.renderToPreview(s)},!1),o.addEventListener("click",function(e){e.stopPropagation(),i.getSidePanelState()?(i.unSelectRecommendation(),i.selectRecommendedChart(s),i.updateChart(s)):i.renderToPreview(s)},!1),v.innerText=i.getChartNameByChartCode(l),i.grabProperty(e),e.isMutedUpdate=!0,e=i.removeUnwantedProperties(e),i.renderChart(e),setTimeout(function(){a()},10)})},h.prototype.alertInvalidRecommendation=function(){var e=n.Wrapper.DOMUtils;e.showById("chartRecAlert1"),e.hideById("generalChartType")},h.prototype.doRecommendationTask=function(e,t){this.clearRecommendationDom(),this.resetIDs();n.Wrapper.DOMUtils;var i=[];e.length&&(i=e),!e.length&&i.push(e);var a=new n.Utility.AgentDom;a.hideRecommendationDOM();var r=1|t.startIndex,o=!1|t.isShift;try{o&&i.shift(),this.renderRecommendation(i,r)}catch(e){a.hideRecommendationDOM(),d.log("[CHART] Chart DialogMeta doRecommendationTask Throwing exception while redering chart in dialog",e),this.alertInvalidRecommendation()}},h.prototype.addUnProcessTask=function(e,t,i,a){if(!this.UNPROCESSEDTASK[e]){this.UNPROCESSEDTASK[e]=[];var r={};r.fn=t,r.parameters=i,r.optional=a,this.UNPROCESSEDTASK[e].push(r)}},h.prototype.processUnProcessTask=function(e){e&&-1!==e.indexOf("recommendation")&&(this.PROCESSTASK(e),this.clearResposne())},h.prototype.clearRecommendationDom=function(){var e=n.Wrapper.DOMUtils,t=e.getElementById("chartRecommend");e.hideById("chartRecAlert1"),e.showById("generalChartType"),t&&(t.innerHTML=""),e.addChild("wrapper","chartRecommend",{id:"recommendChartPreview"})},h.prototype.getTabName=function(){return this.tabName},h.prototype.setUnProcessed=function(e){this.UNPROCESSEDTASK=e},h.prototype.checkToPerformUnProcessedTask=function(){-1!==this.getTabName().indexOf("General")&&this.processUnProcessTask(this.taskType)},h.prototype.updateCurrentTabName=function(){var e=n.Wrapper.DOMUtils.getActiveElement("chrtTabList","active").textContent;this.tabName=e},h.prototype.getResponse=function(){return this.responseObj},h.prototype.updateGroupingStates=function(e){var t=this.dialogMeta[this.chartId];t&&t.updateGroupingStates(e)},h.prototype.grabProperty=function(e,t){var i=new n.Model.DialogMeta,a=t?this.getActiveId():e.co.chart.renderTo;i.constructPropertyFromObject(e),this.addMetaObject(a,i)},h.prototype.grabPropertyForChartID=function(e,t){var i=new n.Model.DialogMeta;i.constructPropertyFromObject(e),this.addMetaObject(t,i)},h.prototype.addMetaObject=function(e,t){this.dialogMeta[e]=t},h.prototype.getMetaObject=function(e){return d.log("Requesting meta for chart Id >>>>> ",e),this.dialogMeta[e]},h.prototype.getState=function(){return this.state},h.prototype.setState=function(e){this.state=e},h.prototype.getDialogTitle=function(){return-1!==this.getState().indexOf("ADD")?r.AddChart:r.EditChart},h.prototype.clearCatch=function(){this.init(),this.clearDom(!0)},h.prototype.clearDom=function(e){var t=n.Wrapper.DOMUtils,i=t.getElementById("preview"),a=t.getElementById("chartRecommend");e&&i&&(i.innerHTML=""),e&&a&&(a.innerHTML="")},h.prototype.loadPreview=function(t){var i=e.ZSChart,r=(a=new i.Utility.ChartAgent).isArray(t),o=null;r&&t.forEach(function(e,i){o=t.co.chart.renderTo||this.chartId,this.createPreview(this.chartId+e,t)}),!r&&(o=t.co.chart.renderTo||this.chartId)&&this.createPreview(o,t)},h.prototype.createPreview=function(e,t){var i;!(t.isMutedUpdate||!1)&&this.grabProperty(t),i=n.Action.createPreview(e,t),this.dialogMeta[e].setInstance(i)},h.prototype.doNoDataFoundAction=function(e){var t=n.Wrapper.DOMUtils,i=t.getElementById("preview"),a=new n.Utility.CommanAgent;try{var r=i.getElementsByClassName("chrtNoDta")[0];i.removeChild(r)}catch(e){}try{var o=!a.isAllowToDraw(e);o&&o.Exception.throw}catch(e){var s=(r=t.getElementByClassName("chrtNoDta")).cloneNode(!0);s.style.zIndex=1e4,s.style.display="block",t.appendChild(i,s)}},h.prototype.updateTitleByRange=function(e,i){var a=new n.Utility.ChartAgent;(new n.Utility.CommanAgent).getRangePicker(p.SP_TITLE_TEXT);function r(t,i){switch(e){case p.CHART_TITLE:i.updateTitle("preview",t);break;case p.CHART_SUBTITLE:i.updateSubTitle("preview",t);break;case p.CHART_X_AXIES:i.updateXTitle("preview",t,0);break;case p.CHART_Y_AXIES:i.updateYTitle("preview",t);break;case p.SP_TITLE_TEXT:default:new n.Utility.ChartAgent;var a=n.Manager.SidePanelManager,r=o.zcombo("#chartTitleCombo","getValue");if("CHART_TITLE"===r)i.updateTitle(a.getActiveChartID(),t);else if("CHART_SUBTITLE"===r)i.updateSubTitle(a.getActiveChartID(),t);else if("CHART_X_AXIES"===r)i.updateXTitle(a.getActiveChartID(),t,0);else if("LA"===r||-1!==r.indexOf("RA")){var s="LA"===r?0:r.substring(r.length-1,r.length);i.updateYTitle(a.getActiveChartID(),t,s)}}}function s(t,i){var a=n.Manager.SidePanelManager,r=i.dialogMeta[i.chartId]||i.dialogMeta[a.getActiveChartID()];if(r)switch(e){case p.CHART_TITLE:r.setTitle(t);break;case p.CHART_SUBTITLE:r.setSubTitle(t);break;case p.CHART_X_AXIES:r.updateXTitle(t,0);break;case p.CHART_Y_AXIES:r.updateYTitleRange(t,i.getActiveYAxisIndex("preview"));break;case p.SP_TITLE_TEXT:default:new n.Utility.ChartAgent;var s=a.getActiveChartID(),l=o.zcombo("#chartTitleCombo","getValue");"CHART_TITLE"===l?r.setTitle(t):"CHART_SUBTITLE"===l?r.setSubTitle(t):"CHART_X_AXIES"===l?r.updateXTitle(t,0):"LA"===l&&r.updateYTitle(t,0),i.setInTitleJson(s,l,t)}}a.getCellValue(i,function(e){var a=t.view.getActiveGridID(),o=t.view.getResourceID(a),n=t.view.getVersionID(a),l=JSUtil.Range.parseRange(o,n,i),p=l.range.startRow,d=l.range.startCol;r(e[p][d].DisplayValue,this),s(i,this)}.bind(this),function(){r(i,this),s(i,this)}.bind(this))},h.prototype.removeUnwantedProperties=function(e){var t=e.co;if(e.legendPos=0,e.lf="N",t.title.text="",t.tooltip.enabled=!1,t.plotOptions.series.animation=!1,t.legend.enabled=!1,t.plotOptions.series.showInLegend=!1,t.plotOptions.series.dataLabels&&(t.plotOptions.series.dataLabels.enabled=!1),t.xAxis&&(t.xAxis.lineWidth=1,t.xAxis.tickLength=0,t.xAxis.labels.enabled=!1,t.chart.zoomType="none"),t.yAxis)for(var i=0;i<t.yAxis.length;i++)t.yAxis[i].labels&&(t.yAxis[i].labels.enabled=!1),t.yAxis[i].gridLineWidth&&(t.yAxis[i].gridLineWidth=0);return t.plotOptions.series.allowPointSelect=!1,e},h.prototype.refreshByMeta=function(e){var t=new n.Utility.ChartAgent,i=new n.Utility.CommanAgent,a=t.clone(e.getDetails(),!0),r=t.clone(e.getOptions(),!0),o=r.title.text.length>0,s=r.subtitle.text.length>0,l={legend:i.getLegendUpdate(a.legendPos,o,s)};return t.merge({},r,l,!0),a.co=r,new Promise(function(e,t){this.grabProperty(a,!0),this.refreshOptions(a),setTimeout(function(){e(this)}.bind(this),100)}.bind(this)).then(function(e){e.processPreviewResponse(a)})},h.prototype.refreshByMetaForSidePanel=function(e,t){var i=new n.Utility.ChartAgent,a=new n.Utility.CommanAgent,r=i.clone(e.getDetails(),!0),o=i.clone(e.getOptions(),!0),s=o.title.text.length>0,l=o.subtitle.text.length>0,p={legend:a.getLegendUpdate(r.legendPos,s,l)};i.merge({},o,p,!0),r.co=o,this.grabPropertyForChartID(r,t)},h.prototype.refreshOptions=function(e){var t;return e.wd=e.co.chart.width=450,e.ht=e.co.chart.height=390,e.co.chart.renderTo=this.chartId,e.isMutedUpdate=!0,t=e.type,(new n.Utility.CommanAgent).isFallUnderCompositionType(t)?e.co.series=function(e){for(var t in e){var i=e[t],a=i.data;for(var r in a){var o=a[r];o.visible=!0}}return e}(e.co.series):e.co.series=function(e){for(var t in e){var i=e[t];i.visible=!0}return e}(e.co.series),e.co.plotOptions[e.co.chart.type].showInLegend=e.co.legend.enabled,e.co=this.setDefaultLegendItemStylesOrElse(e.co),e},h.prototype.setDefaultLegendItemStylesOrElse=function(e){var t=new n.Utility.CommanAgent,i=e.legend;return i=t.setDefaultLegendItemStylesOrElse(i),e},h.prototype.renderToPreview=function(e){var t=this.dialogMeta[e];this.changeType(t.getType()),this.updateRequiredProperty(t),this.createRequest("CHART_PREVIEW")},h.prototype.updateChart=function(e){var i=n.Utility.getActiveChart()[0],a=this.dialogMeta[e];this.changeType(a.getType()),this.updateRequiredProperty(a,i);var r=new n.Utility.ChartAgent,o=new n.Utility.CommanAgent,s=this.dialogMeta[i]||this.dialogMeta.preview,l=s.getRange(),p=new n.Model.DialogMeta;s.merge(p,s,a,!1);var d=p.getRange();p.setChartID(i),this.mergeDialogMetaWithChartMeta(e,p);var c=this.getRequestObject(p,"edit"),g=t.view.getActiveGridID(),h=t.view.getResourceID(g),u=t.view.getVersionID(g),v=t.view.getSheetID(g);n.Server.Action.updateChartOnGrid(h,v,u,c);var y=r.isUniqueValue(l,d),C=n.Manager.SidePanelManager;y&&(C.TABEL_DEFINATION=!0),n.Aggregation.resetAggregationDom(p.getSeriesIn()),o.resetSidePanel();var A=n.DecTable.getRangeDecTableMap(l);!C.TABEL_DEFINATION&&n.DecTable.populateFilterColumns(p,A)},h.prototype.setRecommedationSelection=function(){var e=n.Wrapper.DOMUtils,t=n.Manager.SidePanelManager.getActiveChartID()[0],i=this.dialogMeta[t];if(i){Object.keys(this.dialogMeta).forEach(function(t){e.getElementById(t)&&(e.getElementById(t).parentElement.style.borderColor="#d4d4d4")});var a=i.getType(),r=i.getRange();Object.keys(this.dialogMeta).forEach(function(t){if("preview"!==t&&-1!==t.indexOf("preview")){var i=this.dialogMeta[t],o=i.getType(),n=i.getRange(),s=a==o&&n==r,l=e.getElementById(t);s&&l&&(l.parentElement.style.borderColor="#01975B"),s&&i.setRecommendationSelection(!0),!s&&l&&(l.parentElement.style.borderColor="#d4d4d4"),s&&i.setRecommendationSelection(!1)}}.bind(this))}},h.prototype.unSelectRecommendation=function(){var e=n.Wrapper.DOMUtils;Object.keys(this.dialogMeta).forEach(function(t){t.startsWith("preview")&&e.getElementById(t)&&(e.getElementById(t).parentElement.style.borderColor="#d4d4d4")})},h.prototype.checkIfArraysAreNotSame=function(e,t){if(e.length!==t.length)return!1;for(var i in e)if(e[i]!==t[i])return!1;return!0},h.prototype.selectRecommendedChart=function(e){var t=n.Wrapper.DOMUtils,i=this.dialogMeta[e];if(i){var a=i.getType(),r=i.getRange(),o=i.getAggregationColHeaders(),s=this;Object.keys(this.dialogMeta).forEach(function(e){if("preview"!=e){var i=this.dialogMeta[e],n=i.getType(),l=i.getRange(),p=i.getAggregationColHeaders(),d=a==n&&l==r&&s.checkIfArraysAreNotSame(o,p),c=t.getElementById(e);d&&c&&(c.parentElement.style.borderColor="#01975B"),d&&i.setRecommendationSelection(!0),!d&&c&&(c.parentElement.style.borderColor="#d4d4d4"),d&&i.setRecommendationSelection(!1)}}.bind(this))}},h.prototype.getChartNameByChartCode=function(e){var t;switch(e){case"COL":t=r["Chart.Type.Column"];break;case"BAR":t=r.Bar;break;case"STACKEDCOL":t=r.StackedColumn;break;case"STACKEDBAR":t=r.StackedBar;break;case"XYSTACKEDAREA":t=r.StackedArea;break;case"XYLINE":t=r.Line;break;case"SCATTER":t=r.Scatter;break;case"BUBBLE":t=r.Bubble;break;case"PIE":t=r.Pie;break;case"COMBOCHART":t=r["Chart.Type.Combo"];break;default:t=e}return t},h.prototype.updateTooltip=function(e,t){var i=this.dialogMeta[e];i.setTooltip(t);var a=i.getInstance();a&&a.updateTooltip(t)},h.prototype.updateInverted=function(e,t){var i=this.dialogMeta[e];i.setInverted(t);var a=i.getInstance();a&&a.updateInverted(t)},h.prototype.updateSpline=function(e,t){var i=this.dialogMeta[e];i.setSpline(t);var a=i.getInstance();a&&a.updateSpline(t.type)},h.prototype.updateZoom=function(e,t){var i=this.dialogMeta[e];i.setZoom(t);var a=i.getInstance();a&&a.updateZoom(t)},h.prototype.updateAnimation=function(e,t){var i=this.dialogMeta[e];i.setAnimation(t);var a=i.getInstance();a&&a.updateAnimation(t)},h.prototype.updateAutoExpand=function(e,t){this.dialogMeta[e].setExpand(t)},h.prototype.updateHiddenCell=function(e,t){this.dialogMeta[e].setHiddenCells(t),this.createRequest("CHART_PREVIEW")},h.prototype.updateChartGradientStatus=function(e,t){this.dialogMeta[e].setChartGradientStatus(t)},h.prototype.updateSeriesGradientStatus=function(e,t){this.dialogMeta[e].setSeriesGradientStatus(t)},h.prototype.updateGradientType=function(e,t){var i=this.dialogMeta[e];i.updateGradientType(t),(new n.Utility.AgentDom).updateGradientStatus(i)},h.prototype.updateGradientReverse=function(e,t){var i=this.dialogMeta[e];i.updateGradientReverse(t),(new n.Utility.AgentDom).updateGradientStatus(i)},h.prototype.updateGradientScope=function(e,t){var i=this.dialogMeta[e];i.updateGradientScope(t),(new n.Utility.AgentDom).updateGradientStatus(i)},h.prototype.updateHiddenCellForSP=function(e,i){var a=this.dialogMeta[e];if(a){var r=a.chartTitle;"ANIMATION_CHART"===a.type&&g.stopChartAnimation(e),a.setHiddenCells(i);var o=this.getRequestObject(a,"edit");r&&"WORDCLOUD"===a.type&&(o.parameters.title=r);var s=t.view.getActiveGridID(),l=t.view.getResourceID(s),p=t.view.getVersionID(s),d=t.view.getSheetID(s);n.Server.Action.updateChartOnGrid(l,d,p,o),n.Action.doRecommendation(a,!0)}},h.prototype.createRequest=function(e){var t=new n.Utility.ChartAgent;-1!==e.indexOf("CHART_PREVIEW")&&this.createPreviewRequest(t.getActiveChartIDForSP()),-1!==e.indexOf("CHART_NEW")&&this.createNewRequest(),-1!==e.indexOf("CHART_EDIT")&&this.createEditRequest()},h.prototype.updateSeriesIn=function(e,t,i){var a=t?"ROWS":i?"COLS":null;if(a){var r=this.dialogMeta[e];r.setSeriesIn(a),this.createRequest("CHART_PREVIEW"),n.Action.doRecommendation(r,!1)}},h.prototype.updateSeriesInForSP=function(e,i,a){var r=i?"ROWS":a?"COLS":null;if(r){var o=this.dialogMeta[e],s=o.chartTitle;"ANIMATION_CHART"===o.type&&g.stopChartAnimation(e),o.setSeriesIn(r),this.resetAggregation(e,!1),n.Aggregation.resetAggregation(r),this.resetFilter(e,!1),(new n.Utility.AgentDom).resetFilterIfNeeded(),n.Aggregation.enableLabelCheckBox(r),this.mergeDialogMetaWithChartMeta(e,o);var l=this.getRequestObject(o,"edit");s&&"WORDCLOUD"===o.type&&(l.parameters.title=s);var p=t.view.getActiveGridID(),d=t.view.getResourceID(p),c=t.view.getVersionID(p),h=t.view.getSheetID(p);n.Server.Action.updateChartOnGrid(d,h,c,l)}},h.prototype.updateDataRange=function(e,t){var i=this.dialogMeta[e];if(i){var a=i.setRange(t);a&&this.createRequest("CHART_PREVIEW"),a&&n.Action.doRecommendation(i,!1)}},h.prototype.updateFirstRowAsLabel=function(e,t){var i=this.dialogMeta[e];i.setFirstRowAsLabel(t),this.createRequest("CHART_PREVIEW"),n.Action.doRecommendation(i,!1)},h.prototype.updateFirstColumnAsLabel=function(e,t){var i=this.dialogMeta[e];i.setFirstColumnAsLabel(t),this.createRequest("CHART_PREVIEW"),n.Action.doRecommendation(i,!1)},h.prototype.updateFirstColumnAsLabelForSP=function(e,i){var a=this.dialogMeta[e],r=a.chartTitle;"ANIMATION_CHART"===a.type&&g.stopChartAnimation(e),a.setFirstColumnAsLabel(i);var o=this.getRequestObject(a,"edit");r&&"WORDCLOUD"===a.type&&(o.parameters.title=r);var s=t.view.getActiveGridID(),l=t.view.getResourceID(s),p=t.view.getVersionID(s),d=t.view.getSheetID(s);n.Server.Action.updateChartOnGrid(l,d,p,o)},h.prototype.updateFirstRowAsLabelForSP=function(e,i){var a=this.dialogMeta[e],r=a.chartTitle;"ANIMATION_CHART"===a.type&&g.stopChartAnimation(e),a.setFirstRowAsLabel(i);var o=this.getRequestObject(a,"edit");r&&"WORDCLOUD"===a.type&&(o.parameters.title=r);var s=t.view.getActiveGridID(),l=t.view.getResourceID(s),p=t.view.getVersionID(s),d=t.view.getSheetID(s);n.Server.Action.updateChartOnGrid(l,d,p,o)},h.prototype.updateTitle=function(e,t){if(e)for(var i=e.length,a=0;a<i;a++){var r=e[a],o=this.dialogMeta[r];if(!o)return;if(o.isChartTitleValueChanged(!0),o.setTitle(t),o.updateOptionByTitle(t),(new n.Utility.ChartAgent).getChartMapFromSheet()[3].get(r).updateTitleByLabel("CHART_TITLE",t),o.isTitleValueChanged()){var s=new n.Manager.ZSCManager;s.doQuickTitleEditAction(e,null,122),s.resetClientActionDone(e)}}},h.prototype.updateFontFamily=function(e,t){var i=this.dialogMeta[e];i&&i.updateFontFamily(t.style)},h.prototype.updateTitleStyle=function(e,t,i){var a=this.dialogMeta[e];a&&a.updateTitleStyle(t,i)},h.prototype.updateChartColor=function(e,t){var i=this.dialogMeta[e];i&&i.updateChartColor(t)},h.prototype.updateChartBorderColor=function(e,t){var i=this.dialogMeta[e];i&&i.updateChartColor(t)},h.prototype.updateTitleForSp=function(e,t){var i=n.Wrapper.DOMUtils,a=this.dialogMeta[e];if(a){-1!=t.indexOf("CHART_X_AXIES")||-1!=t.indexOf("LA")||-1!=t.indexOf("RA")||-1!=t.indexOf("CHART_SUBTITLE")?i.hideById("titleAlign"):i.showById("titleAlign");var r=a.getTitleJsonForSP(t),o=a.getTitleStyleJsonForSP(t);i.getElementById("titleTextBox").value=r||"";var s=new n.Utility.AgentDom;o&&s.updateTitleStyle(o)}},h.prototype.setInTitleJson=function(e,t,i){n.Wrapper.DOMUtils;var a=this.dialogMeta[e];a&&a.addTitleJsonForSP(t,i)},h.prototype.updateSubTitle=function(e,t){if(e)for(var i=e.length,a=0;a<i;a++){var r=e[a],o=this.dialogMeta[r];if(!o)return;if(o.isSubTitleValueChanged(!0),o.setSubTitle(t),o.updateOptionBySubtitle(t),(new n.Utility.ChartAgent).getChartMapFromSheet()[3].get(r).updateTitleByLabel("CHART_SUBTITLE",t),o.isTitleValueChanged()){var s=new n.Manager.ZSCManager;s.doQuickTitleEditAction(e,null,123),s.resetClientActionDone(e)}}},h.prototype.updateXTitle=function(e,t,i){if(e)for(var a=e.length,r=0;r<a;r++){var o=e[r],s=this.dialogMeta[o];if(!s)return;s.isXTitleValueChanged(!0),s.updateXTitle(t,i||0),(new n.Utility.ChartAgent).getChartMapFromSheet()[3].get(o).updateTitleByLabel("XAXIS_TITLE",t);var l=s.getUpdateOptions();if(l.xAxis.title.text=t,s.isTitleValueChanged()){var p=new n.Manager.ZSCManager;p.doQuickTitleEditAction(e,l,115),p.resetClientActionDone(e)}}},h.prototype.updateYTitle=function(e,t,i){if(e)for(var a=e.length,r=0;r<a;r++){var o=e[r],s=this.dialogMeta[o];if(!s)return;s.isYTitleValueChanged(!0),s.updateYTitle(t,i);var l=s.getUpdateOptions();if(l.yAxis[i].title.text=t,(new n.Utility.ChartAgent).getChartMapFromSheet()[3].get(o).updateTitleByLabel("YAXIS_TITLE",t,i),s.isTitleValueChanged()){var p=new n.Manager.ZSCManager;p.doQuickTitleEditAction(e,l,116),p.resetClientActionDone(e)}}},h.prototype.updateLegend=function(e,t){var i=this.dialogMeta[e];i.updateLegend(t);var a=i.getLegendUpdate(),r=i.getInstance();r&&r.updateChart(a)},h.prototype.updateXAxiesLabelStyle=function(e,t){this.dialogMeta[e].updateXLabelStyle(t)},h.prototype.updateYAxiesLabelStyle=function(e,t,i){this.dialogMeta[e].updateYLabelStyle(t,i)},h.prototype.updateXLabel=function(e,t){var i=this.dialogMeta[e];i.updateXLabel(t);var a=i.getXLabelUpdate(),r=i.getInstance();r&&r.updateXAxis(a)},h.prototype.updateXSlant=function(e,t){var i=this.dialogMeta[e];i.updateXSlant(t);var a=i.getXSlantUpdate(),r=i.getInstance();r&&r.updateXAxis(a)},h.prototype.updateXStagger=function(e,t){var i=this.dialogMeta[e];i.updateXStagger(t);var a=i.getXStaggerUpdate(),r=i.getInstance();r&&r.updateXAxis(a)},h.prototype.updateTrendtype=function(e,t){var i=this.dialogMeta[e];if(i.updateTrendtype(t))this.createPreviewRequest("preview");else{var a=i.getTrendUpdate(),r=i.getInstance();r&&this.hideUnwantedProperty(this.activeId),r&&(r=r.refresh(a)),r&&r.setPositiveExtreme(!1),i.setInstance(r)}},h.prototype.setTrendline=function(e,t){var i=this.dialogMeta[e];i.setTrendline(t),t?i.updateTrendtype({value:"Linear"}):i.updateTrendtype({value:"None"}),o.zcombo("#trendlineType","setValue","linear")},h.prototype.updateTrendDegree=function(e,t){var i=this.dialogMeta[e];i.updateTrendDegree(t),i.getTrendUpdate();i.getInstance()&&this.hideUnwantedProperty(this.activeId)},h.prototype.updateCombinedWay=function(e,t){var i=this.dialogMeta[e];i.setCombinedWay(t.value),this.createPreviewRequest("preview"),n.Action.doRecommendation(i,!1)},h.prototype.updateCombinedRange=function(e,i){var a=this.dialogMeta[e];if(a){a.setCombinedWay(i),this.resetAggregation(e,!1),this.resetFilter(e,!1),this.mergeDialogMetaWithChartMeta(e,a);var r=a.getSeriesIn();n.Aggregation.resetAggregation(r),(new n.Utility.AgentDom).resetFilterIfNeeded();var o=this.getRequestObject(a,"edit"),s=t.view.getActiveGridID(),l=t.view.getResourceID(s),p=t.view.getVersionID(s),d=t.view.getSheetID(s);n.Server.Action.updateChartOnGrid(l,d,p,o)}},h.prototype.updateDataRangeForSP=function(e,i,a){i=i.replace(/(.+)(;)$/,"$1");var r=this.dialogMeta[e]||a;if(r){var o=r.chartTitle;if("ANIMATION_CHART"===r.type&&g.stopChartAnimation(e),r.setRange(i)){var s=n.DecTable.validateAggregationHeaders(r);"COLS"===r.getSeriesIn()&&r.updateAggregation("colheaders",s.join(";")),"ROWS"===r.getSeriesIn()&&r.updateAggregation("rowheaders",s.join(";")),r=this.mergeDialogMetaWithChartMeta(e,r);var l=this.getRequestObject(r,"edit");o&&"WORDCLOUD"===r.type&&(l.parameters.title=o);var p=t.view.getActiveGridID(),d=t.view.getResourceID(p),c=t.view.getVersionID(p),h=t.view.getSheetID(p);n.Server.Action.updateChartOnGrid(d,h,c,l)}}},h.prototype.mergeDialogMetaWithChartMeta=function(e,t){var i=(new n.Utility.ChartAgent).getActiveChartMeta()[0];return i?(t.top=i.getTop(),t.left=i.getLeft(),t.sRow=i.getStartRowIndex(),t.sCol=i.getStartColIndex(),t.sColDiff=i.getStartColDiff(),t.sRowDiff=i.getStartRowDiff(),t.width=i.getWidth(),t.height=i.getHeight(),t):t},h.prototype.updateDataLabels=function(e,t){var i=this.dialogMeta[e];i.updateDataLabels(t);var a=i.getDataLabelsUpdate(),r=i.getInstance();r&&r.updateDataLabels(a)},h.prototype.updateYLabel=function(e,t,i){var a=this.dialogMeta[e];a.updateYLabel(t,i);var r=a.getYAxis(),o=a.getInstance();o&&o.updateYAxis(r)},h.prototype.updateYReverse=function(e,t,i){var a=this.dialogMeta[e];a.updateYReverse(t,i);var r=a.getYAxis(),o=a.getInstance();o&&o.updateYAxis(r)},h.prototype.updateYLogarithmic=function(e,t,i){var a=this.dialogMeta[e];a.updateYLogarithmic(t,i);var r=a.getYAxis(),o=a.getInstance();o&&o.updateYAxis(r)},h.prototype.updateYBaseValue=function(e,t,i){var a=this.dialogMeta[e];a.updateYBaseValue(t,i);var r=a.getYAxis(),o=a.getInstance();o&&o.updateYAxis(r)},h.prototype.updateXReverse=function(e,t,i){var a=this.dialogMeta[e];a.updateXReverse(t,i);var r=a.getXAxis(),o=a.getInstance();o&&o.updateXAxis(r)},h.prototype.updateYOpposite=function(e,t,i){var a=this.dialogMeta[e];a.updateYOpposite(t,i);var r=a.getYAxis(),o=a.getInstance();o&&o.updateYAxis(r)},h.prototype.updateXReverse=function(e,t,i){var a=this.dialogMeta[e];a.updateXReverse(t,i);var r=a.getXAxis(),o=a.getInstance();o&&o.updateXAxis(r)},h.prototype.updateMultiYAxies=function(e,t){var i=this.dialogMeta[e];i.setYAxisState(t),i.updateNoOfYAxies(),this.createPreviewRequest(e)},h.prototype.updateMultiYAxiesForSP=function(e,i){var a=this.dialogMeta[e];a.setYAxisState(i),a.updateNoOfYAxies();var r=t.view.getActiveGridID(),s=t.view.getResourceID(r),l=t.view.getVersionID(r),p=t.view.getSheetID(r),d={isSingleYAxis:i},c=n.Utility.getChartMeta([e],!0);(new n.Controller.ZSCController).updateMultipleYAxis(s,p,l,c,d);var g=new n.Utility.AgentDom;if(g.hidePropertyBasedOnMeta(a,!1),!i){o.zcombo("#yaxisMulti","setValue","LA"),o.zcombo("#chartTitleCombo","setValue","CHART_TITLE"),n.Utility.changeTitleCombo();var h=a.getYAxis()[0];g.updateYAxiesRelativeByAxiesObjectSP(h,0)}},h.prototype.updateTitleIndex=function(e,t){var i=this.dialogMeta[e];if(i){var a=0;-1!==t.indexOf("RA")&&(a=t.substring(t.length-1,t.length)),i.setActiveTitleIndex(a)}},h.prototype.getActiveTitleIndex=function(e){return this.dialogMeta[e].getActiveTitleIndex()},h.prototype.getActiveYAxisIndex=function(e){return this.dialogMeta[e].getActiveYIndex()},h.prototype.getYAxiesByIndex=function(e,t){return this.dialogMeta[e].getYAxis()[t]},h.prototype.updateScaleFactor=function(e,t,i){var a=n.Constants.ConversionType,r=this.dialogMeta[e];r.updateScaleFactor(t,i),r.updateConversionType(a.SCALES,i),(new n.Controller.ZSCController).updateScaleFactor([e],t,r.getUnitFactor(i),i,r.getConversionType(i))},h.prototype.updateUnitFactor=function(e,t,i){var a=n.Constants.ConversionType,r=this.dialogMeta[e];r.updateUnitFactor(t,i),r.updateConversionType(a.UNITS,i),(new n.Controller.ZSCController).updateScaleFactor([e],r.getScaleFactor(i),t,i,r.getConversionType(i))},h.prototype.updateBinningInterval=function(e,t){var i=this.dialogMeta[e],a={};a.interval=t,i.updateBinning(a),(new n.Controller.ZSCController).updateBinningInterval([e],t)},h.prototype.setNumberFormat=function(e,t){this.dialogMeta[e].updateNumberFormat(t),(new n.Controller.ZSCController).setNumberFormat([e],{nfCode:t.nfCode,prefix:t.prefix,suffix:t.suffix,index:t.yIndex})},h.prototype.updateMultiYAxiesDom=function(e,t){var i=this.dialogMeta[e];(new n.Utility.AgentDom).updateYAxiesRelative(i,t)},h.prototype.removeYPlotline=function(e,t,i){var a=this.dialogMeta[e],r=a.removeYPlotline(t,i),o=a.getInstance();o&&o.removeYPlotLine(r,t)},h.prototype.removeAllPlotLine=function(e,t){this.dialogMeta[e].removeAllPlotLine(t)},h.prototype.getTitleStyle=function(e,t,i){if(t)for(var a=0;a<t.length;a++){var r=t[a],o=this.dialogMeta[r];if("CHART_TITLE"===e)return o?o.getChartTitleStyle():{};if("CHART_SUBTITLE"===e)return o?o.getChartSubTitleStyle():{};if("CHART_X_AXIES"===e)return o?o.getChartXAxisTitleStyle():{};if("LA"===e||-1!==e.indexOf("RA")){var n=void 0===i?o.getActiveTitleIndex():i;return o?o.getChartYAxisTitleStyle(n):{}}}},h.prototype.getSubAction=function(e){return"CHART_TITLE"===e?119:"CHART_SUBTITLE"===e?120:"CHART_X_AXIES"===e?117:"LA"===e||-1!==e.indexOf("RA")?118:void 0},h.prototype.getSubActionForTitleAlignment=function(e){return"CHART_TITLE"===e?197:"CHART_SUBTITLE"===e?198:void 0},h.prototype.addPlotLine=function(e){var t=this.dialogMeta[e],i=n.Wrapper.DOMUtils,a=(t.getYAxis(),t.getActiveYIndex(),i.getElementById("plotLineWrapper")),r=a?a.children.length:1,o=new n.Utility.AgentDom;o.createPlotLineDom(r);var s=a?a.children.length:1;(r>=3||s>=3)&&o.hideAddButton()},h.prototype.updateYPlotline=function(e,t,i,a){var r=this.dialogMeta[e];r.updateYPlotline(t,i,a);var o=r.getYPlotlineUpdate(i,a),n=r.getInstance();n&&n.updateYPlotLine(o,i,a)},h.prototype.updateYPlotlineName=function(e,t,i,a){var r=this.dialogMeta[e];r.updateYPlotlineName(t,i,a);var o=r.getYPlotlineUpdate(i,a),n=r.getInstance();n&&n.updateYPlotLine(o,i,a)},h.prototype.updateYMin=function(e,t,i){var a=this.dialogMeta[e];a.updateYMin(t,i),t=""==t?null:t;var r=a.getInstance();r&&r.updateMin(t,i)},h.prototype.updateYMax=function(e,t,i){var a=this.dialogMeta[e];a.updateYMax(t,i),t=""==t?null:t;var r=a.getInstance();r&&r.updateMax(t,i)},h.prototype.updateYMajorGrid=function(e,t,i){var a=this.dialogMeta[e];a.updateYMajor(t,i);var r=a.getInstance();t&&r&&r.addYMajorGrid(i),!t&&r&&r.removeYMajorGrid(i)},h.prototype.updateYMinorGrid=function(e,t,i){var a=this.dialogMeta[e];a.updateYMinor(t,i);var r=a.getInstance();t&&r&&r.addYMinorGrid(i),!t&&r&&r.removeYMinorGrid(i)},h.prototype.updateYInterval=function(e,t,i){var a=this.dialogMeta[e];a.updateYInterval(t,i),t=""==t?null:t;var r=a.getInstance();r&&r.updateInterval(t,i)},h.prototype.updateThreshold=function(e,t){var i=this.dialogMeta[e];i.updateThreshold(t),t=""==t?null:+parseFloat(t);var a=i.getInstance(),r=i.getThresholdUpdate();a&&(a=a.refresh(r)),a&&a.setPositiveExtreme(!1),i.setInstance(a)},h.prototype.updateTheme=function(e,t,i){if(e)for(var a=0;a<e.length;a++){var r=e[a],o=new n.Utility.ChartAgent,s=t.basecolor,p=t.name,d=t.reversed;"string"==typeof s&&-1!==s.indexOf("[")&&JSON.parse(s),-1!==p.indexOf(l.COLORFUL)&&o.generateMonochromaticShades(p,-1!==r.indexOf("preview"));var c=this.dialogMeta[r];c.updateTheme(s,p,d);var g=c.getThemeUpdate(s,p,d);c.getInstance();this.updateColorSchemeDom(c.getStyleObject()),i&&u.call(this,c,g)}},h.prototype.createPreviewRequest=function(e){if(this.isPreviewOn()){var i=this.dialogMeta[e],a=this.getRequestObject(i,"preview"),r=t.view.getActiveGridID(),o=t.view.getResourceID(r),s=t.view.getVersionID(r),l=t.view.getSheetID(r);n.Server.Action.updatePreview(o,l,s,a,this.processPreviewResponse.bind(this))}},h.prototype.createNewRequest=function(e){var i=this.dialogMeta[e||this.activeId],a=this.getRequestObject(i,"new"),r=t.view.getActiveGridID(),o=t.view.getResourceID(r),s=t.view.getVersionID(r),l=t.view.getSheetID(r);n.Server.Action.updateChartOnGrid(o,l,s,a)},h.prototype.createEditRequest=function(e){var i=this.dialogMeta[e||this.activeId],a=this.getRequestObject(i,"edit"),r=t.view.getActiveGridID(),o=t.view.getResourceID(r),s=t.view.getVersionID(r),l=t.view.getSheetID(r);n.Server.Action.updateChartOnGrid(o,l,s,a)},h.prototype.getRequestObject=function(e,t){return(new n.Utility.ChartAgent).getRequestObject(e,t)},h.prototype.getActiveMeta=function(){return this.dialogMeta[this.activeId]},h.prototype.updateColorSchemeDom=function(e){(new n.Utility.AgentDom).resetColorDOMProperty(e,!0)},h.prototype.reveseColorScheme=function(e,t){var i=this.dialogMeta[e].getStyleObject().colorObject.colorTheme;i.reversed=t,this.updateTheme(e,i),(new n.Utility.ChartAgent).reverseMonoColor(t,!0)},h.prototype.updateFilterMeta=function(e,t,i){var a=this.dialogMeta[e];a&&(a.setFilterLimit(i),a.setFilterType(t))},h.prototype.updateFilter=function(e,i,a,r){var o=this.dialogMeta[e];if(o&&(o.updateFilter(i,a),r)){var s=t.view.getActiveGridID(),l=t.view.getResourceID(s),p=t.view.getVersionID(s),d=t.view.getSheetID(s),c={filter:o.getFilter()},g=n.Utility.getChartMeta([e],!0);(new n.Controller.ZSCController).updateFilter(l,d,p,g,c)}},h.prototype.getIsYAxisForReverse=function(e,t){var i=this.dialogMeta[e];return i?(-1!==i.getType().indexOf("BAR")&&(t=!t),t):t},h.prototype.resetFilter=function(e,i){var a=this.dialogMeta[e];if(a&&(a.resetFilter(),i)){var r=t.view.getActiveGridID(),o=t.view.getResourceID(r),s=t.view.getVersionID(r),l=t.view.getSheetID(r),p={filter:a.getFilter()},d=n.Utility.getChartMeta([e],!0);(new n.Controller.ZSCController).updateFilter(o,l,s,d,p)}},h.prototype.resetAggregation=function(e,i){var a=this.dialogMeta[e];if(a&&a.getAggregationEnabled()){var r=a.getAggregationOperation(),o={type:"NONE",colheaders:void 0,numericColumns:void 0,rowheaders:void 0,enabled:!1,dateOperations:void 0};if(Object.keys(o).forEach(function(e,t){a.updateAggregation(e,o[e])}),i){var s=t.view.getActiveGridID(),l=t.view.getResourceID(s),p=t.view.getVersionID(s),d=t.view.getSheetID(s),c={aggregation:a.getAggregation()},g=new n.Controller.ZSCController,h=n.Utility.getChartMeta([e],!0);g.updateAggregation(l,d,p,h,c),this.populateFilterColumnsIfNeeded(e,r,"NONE")}}},h.prototype.updateAggregation=function(e,i,a){var r=this.dialogMeta[e],o=n.Manager.SidePanelManager;if(r){var s=!1;if(o.setCurrentActionOwner(),Object.keys(i).forEach(function(e,t){"type"===e,r.updateAggregation(e,i[e]),s=s||("colheaders"===e||"dateOperations"===e)}),s&&r.udpateAggregationHeaderMap(i),(new n.Utility.AgentDom).populateAggregationColumns(r),a){var l=t.view.getActiveGridID(),p=t.view.getResourceID(l),d=t.view.getVersionID(l),c=t.view.getSheetID(l),g={aggregation:r.getAggregation()},h=new n.Controller.ZSCController,u=n.Utility.getChartMeta([e],!0);h.updateAggregation(p,c,d,u,g)}}},h.prototype.updateSeriesCustomization=function(e){var t=this.dialogMeta[e.cID];t&&t.updateSeriesCustomization(e)},h.prototype.updateTrendlineStyle=function(e){var t=this.dialogMeta[e.cID];t&&t.updateTrendlineStyle(e)},h.prototype.updateTitleText=function(e){var t=new n.Utility.ChartAgent,i=o.zcombo("#chartTitleCombo","getValue"),a=(n.Manager.SidePanelManager,n.Utility.getActiveChart());a&&a.forEach(function(a){var r=this.dialogMeta[a];if(r&&r.isTitleValueChanged()){switch(i){case"CHART_TITLE":t.updateChartTitle(e);break;case"CHART_SUBTITLE":t.updateChartSubTitle(e);break;case"CHART_X_AXIES":t.updateXAxisTitle(e);break;default:var o="LA"===i?0:i.substring(i.length-1,i.length);t.updateYAxisTitle(e,o)}this.setInTitleJson(a,i,e)}r&&r.setTitleValueChanged(!1)}.bind(this))},h.prototype.isFilterRequestNeeded=function(e,t){var i=!0,a=this.dialogMeta[e];if("type"===t){var r="noFilter"!==o.zcombo("#filterColumns","getValue")?a.getFilterColumn():"noFilter",n=a.getFilterLimit()||-1==a.getFilterLimit()?o.zspinner("#filterSpinner","getValue"):a.getFilterLimit();i=r&&"noFilter"!==r&&0!==n}else if("limit"===t){r="noFilter"!==o.zcombo("#filterColumns","getValue")?a.getFilterColumn():"noFilter";var s="NONE"==a.getFilterType()?o.zcombo("#filterType","getValue"):a.getFilterType();i=r&&s&&"noFilter"!==r&&"NONE"!==s}else{n=a.getFilterLimit()||a.getFilterLimit()<=0?o.zspinner("#filterSpinner","getValue"):a.getFilterLimit(),s="NONE"==a.getFilterType()?o.zcombo("#filterType","getValue"):a.getFilterType();i=n&&s&&n>0&&"NONE"!==s}return i},h.prototype.updateClientTitleText=function(e,t){var i=o.zcombo("#chartTitleCombo","getValue");if("CHART_TITLE"===i)this.updateTitle(e,t);else if("CHART_SUBTITLE"===i)this.updateSubTitle(e,t);else if("CHART_X_AXIES"===i)this.updateXTitle(e,t,0);else if("LA"===i||-1!==i.indexOf("RA")){var a="LA"===i?0:i.substring(i.length-1,i.length);this.updateYTitle(e,t,a)}},h.prototype.updateTextInInstance=function(e,t){var i=e.getUpdateOptions(),a=new n.Utility.ChartAgent;i=a.addChartBoundary(i,e.getDetails()),i=a.applySeriesColorToPlotLines(i),(i=cia.applySeriesColorToAxis(i)).plotOptions.series.animation=!1;for(var r=0;r<t.length;r++){var o=t[r];o&&o.renderTo&&(o=o.refresh(i),t[r]=o)}e.setInstance(t)},n.Model.Dialog=h}(this);
!function(e){e.sPlusPlus;var t=e.ZSClass,a=(e.UserAction,e.ZSChart);!a.Aggregation&&(a.Aggregation={});a.Constants.ChartType,a.Constants.ServiceType,e.JSUtil,a.Constants.ChartRangePickerType;var r=e.UIUtil.Component,o=e.ZSEvents,n=(o.Groups,o.Names,o.topic,e.ZSConstants.I18N);a.Aggregation.getLastIndex=function(){var e=a.Wrapper.DOMUtils.getElementsByClassName("depthHeadersCombo"),t=e[e.length-2].id,r=t.substring(t.length-1,t.length);return parseInt(r)+1},a.Aggregation.constructNewcombo=function(t){var o=a.Wrapper.DOMUtils,n=[t],g=e.UserAction.getTemplate(["aggregationholderTemplate"]).aggregationholderTemplate.cloneNode(!0),i=g.children[0].children[2],l=g.children[0].children[1],s=o.getElementById("aggregationTemplate");o.appendChild(s,g);var d=l.children[0];d.id="chartAggCombo"+t;var c=l.children[1].children[0];c.id="chartAggDate"+t;var u=l.children[1];o.addClass(u,"dateFilters"+t),i.attributes.index.nodeValue=t,r.initComponent(d),r.initComponent(c),r.zcombo("#chartAggDate"+t,"setValue","NONE"),a.Aggregation.bindEvents(n)},a.Aggregation.bindEvents=function(e){a.Manager.SidePanelManager.bindAggregationEvents(e)},a.Aggregation.getOptionsAndLoadInCombo=function(e,t){var r=a.Aggregation.getNewComboList("ADD",null,t),o=a.Wrapper.DOMUtils.getElementById("chartAggCombo"+e);a.Aggregation.loadComboListInCombo(o,r,e)},a.Aggregation.selectedElementClicked=function(e){a.Wrapper.DOMUtils.addAttributes("chartAggCombo0",{childClicked:!0})},a.Aggregation.aggregationComboChanged=function(e,t,r,o){a.Aggregation.disableLabelCheckBox(t,r,o)},a.Aggregation.loadComboListInCombo=function(e,t,o){var n=a.Wrapper.DOMUtils,g="";if(t.length>0)for(var i=0;i<t.length;i++){var l=t[i].headerRange,s=t[i].type,d=t[i].label,c=d.replace(/ /g,""),u=t[i].displayValue,h=t[i].rangeIdx;"DATE"!==s&&"DATETIME"!==s&&(g=n.createElement("option",{header:d,type:s,id:"combo"+o+"_"+c,value:l,range:h})),("DATE"===s||"DATETIME"===s)&&(g=n.createElement("option",{header:d,type:s,id:"combo"+o+"_"+c,value:l,range:h,class:"aggDateElement"})),n.appendChild(e,g),n.getElementById("combo"+o+"_"+c).innerText=u}r.zcombo(e,"refresh")},a.Aggregation.getTotalHeaders=function(){return a.Utility.getTotalHeaders()},a.Aggregation.comboList=function(e,t){for(var r=a.Model.ChartDecTable.getDepthIndices()||[],o=[],n=0;n<r.length;n++)for(var g=0;g<r[n].length&&g<20;g++){var i=r[n][g].headerRange;if(-1==e.indexOf(i)){var l={};l.rangeIdx=n,l.headerValue=i,l.type=r[n][g].type,l.label=r[n][g].headerLabel,l.displayValue=r[n][g].headerValue,l.headerRange=r[n][g].headerRange,o.push(l)}}return o},a.Aggregation.getNewComboList=function(e,t,r){a.Wrapper.DOMUtils.getElementsByClassName("depthHeadersCombo");return this.comboList([],r)},a.Aggregation.getNewCombo=function(e,t){var r=a.Wrapper.DOMUtils,o=this.getNewComboList("ADD",null,label),n=r.createElement("select",{style:"'width:94px'",id:"combo"+idx}),g=r.findNodeByClassName(elem,"depthHeaders");r.appendChild(g,n);var i=r.findNodeByElementType(g,"SELECT")[0];this.loadComboListInCombo(i,o,idx,!0,!0)},a.Aggregation.createNewCombo=function(e,t){var r=a.Wrapper.DOMUtils,o=r.createElement("div",{class:"aggHldr"}),n=r.getElementById("aggregationTemplate");r.appendChild(o,r.createElement("div",{class:"aggMove"})),r.appendChild(o,r.createElement("div",{class:"depthHeaders"})),r.appendChild(o,r.createElement("span",{class:"aggclose"}));var g=this;r.addEventByNode(r.getElementByClassName("aggclose"),"click",function(e){g.deleteDepthHeader(e.target)}),r.appendChild(n,o);var i=r.getElementsByClassName("aggHldr").size-1;this.getNewCombo(i,idx);return[].push(i),getComboElem(0)},a.Aggregation.getHeaderLabelFromHeaderRange=function(e){for(var t=a.Model.ChartDecTable.getDepthIndices(),r=0;r<t.length;r++)for(var o=0;o<t[r].length;o++){var n=t[r][o];if(-1!==(e=e.replace(/\'/g,"")).indexOf(n.headerRange))return n.headerLabel.replace(/ /g,"")}return null},a.Aggregation.renderDateOperationTemplate=function(e){e.stopPropagation()},a.Aggregation.appendChooseOption=function(e){var t=a.Wrapper.DOMUtils,r=t.createElement("option",{id:"choose",value:"choose"});r.innerText=n["Chart.Aggregation.Select"],t.appendChild(t.getElementById(e),r)},a.Aggregation.loadGroupByClauses=function(e,t,o){var n=a.Wrapper.DOMUtils;n.getElementById(o)&&(n.getElementById(o).innerHTML="");var g="NONE",i="";a.Aggregation.appendChooseOption(o);for(var l=-1!==o.indexOf("Num")?"numcombo":"grpcombo",s=0;s<e.length;s++)for(var d=e[s],c=0;c<d.length;c++){var u=d[c];g=l+""+t+"_"+u.headerLabel.replace(/ /g,"");var h=u.headerValue||u.headerLabel;(i=n.createElement("option",{id:g,value:u.headerRange,header:u.headerLabel,type:u.type,displayValue:h})).innerText=u.headerValue||u.headerLabel,n.appendChild(n.getElementById(o),i)}r.zcombo("#"+o,"refresh"),r.zcombo("#"+o,"setValue","Choose")},a.Aggregation.loadNumericColumns=function(e,t,o){var n=a.Wrapper.DOMUtils;n.getElementById(o)&&(n.getElementById(o).innerHTML="");for(var g="NONE",i="",l=0;l<e.length;l++)for(var s=e[l],d=0;d<s.length;d++){var c=s[d];if("NUMBER"===c.type||"DECIMAL"===c.type||"CURRENCY"===c.type||"PERCENTAGE"===c.type||"EMPTY"===c.type){g="numcombo"+t+"_"+c.headerLabel.replace(/ /g,"");var u=c.headerValue||c.headerLabel;(i=n.createElement("option",{id:g,value:c.headerRange,header:c.headerLabel,type:c.type,displayValue:u})).innerText=c.headerValue||c.headerLabel,n.appendChild(n.getElementById(o),i)}}r.zcombo("#"+o,"refresh"),r.zcombo("#"+o,"setValue","Choose")},a.Aggregation.populateNumberColumns=function(e,t,a){var r=e.getAggregationOperation();this.checkIfOperationIsCountRelated(r)?this.loadGroupByClauses(t,a,"chartNumColsCombo0"):this.loadNumericColumns(t,a,"chartNumColsCombo0")},a.Aggregation.disableLabelCheckBox=function(e,t,r){var o=a.Wrapper.DOMUtils,n="COLS"===e?"firstColumn":"firstRow";o.getElementById(n).disabled="disabled"},a.Aggregation.enableLabelCheckBox=function(e){var t=a.Wrapper.DOMUtils;t.getElementById("firstColumn").disabled="",t.getElementById("firstRow").disabled=""},a.Aggregation.getDateOperations=function(e,t,a){var r=e||["NONE","NONE","NONE"];return void 0!==t&&(r[t]="NONE"!==a?"DATE-"+a:a),r},a.Aggregation.spliceDateOperations=function(e,t){var a=e||["NONE","NONE","NONE"];return void 0!==t&&a.splice(t,1),a.push("NONE"),a},a.Aggregation.resetAggregation=function(e){var t=a.Wrapper.DOMUtils;r.zcombo("#chartAxisCombo0","setValue","choose"),r.zcombo("#chartLegendCombo0","setValue","choose"),r.select2("#chartNumColsCombo0",void 0,"reset");var o=t.getElementById("aggDateMenu");r.zmenu(o,"hide"),r.zcombo("#aggreoperation","setValue","NONE"),a.Aggregation.enableLabelCheckBox(e),t.hideById("chartAxisDatePicker"),t.hideById("chartLegendDatePicker")},a.Aggregation.resetAggregationDom=function(e){var t=a.Wrapper.DOMUtils;r.select2("#chartAggCombo0",void 0,"reset"),r.select2("#chartNumColsCombo0",void 0,"reset");var o=t.getElementById("aggDateMenu");r.zmenu(o,"hide"),r.zcombo("#aggreoperation","setValue","NONE"),a.Aggregation.enableLabelCheckBox(e)},a.Aggregation.getTypeFromValue=function(e){for(var t=a.Model.ChartDecTable.getDecTable()||[],r=0;r<t.length;r++)for(var o=Object.keys(t[r])||[],n=0;n<o.length;n++){var g=o[n=parseInt(n)],i=t[r][g];if(i.headerRange===e)return i.type}return e},a.Aggregation.getDisplayLabelFromDateOperation=function(e){var t={YEAR:"Year",QUARTER:"Quarter",MONTH:"Month",DAY:"Day",DAY_OF_WEEK:"Day of Week",QUARTER_BY_YEAR:"Quarter by Year",MONTH_BY_YEAR:"Month by Year"};return t[e]},a.Aggregation.setSelectedState=function(e){var t=a.Wrapper.DOMUtils;null!=t.getElementById(e)&&t.addClass(t.getElementById(e),"selectedState")},a.Aggregation.resetSelectedState=function(){var e=a.Wrapper.DOMUtils;if(null!=e.getElementById("aggDateUl"))for(var t=e.getElementById("aggDateUl").children,r=0;r<t.length;r++)e.removeClass(t[r],"selectedState")},a.Aggregation.checkIfOperationIsValueManipulative=function(e){return-1!==["SUM","AVERAGE","MIN","MAX","MEDIAN","NONE"].indexOf(e)},a.Aggregation.checkIfOperationIsCountRelated=function(e){return-1!==["COUNT","COUNT_DISTINCT"].indexOf(e)},a.Aggregation.renderGroupByClause=function(e){var t=a.Wrapper.DOMUtils,r=e.element,o=t.getAttribute(r,"type"),n=t.getAttribute(r,"id");if("NONE"===n)return"";var g=t.getAttribute(r,"value"),i=t.getAttribute(r,"header"),l=t.getAttribute(r,"displayValue"),s="DATE"===o||"DATETIME"===o?t.createElement("span",{id:n+"_date",value:g,header:i}):t.createElement("span",{id:n,value:g,header:i});if(s.innerText=l,t.addStyle(s,{display:"block"}),"DATE"===o||"DATETIME"===o){var d=a.Utility.getDateOperationByIndex(g);a.Utility.getDateElementDOM(s,d),t.addAttributes(s,{"data-menu-id":"aggDateMenu"}),t.addEventByNode(s,"click",a.Aggregation.selectedElementClicked)}return s},a.Aggregation.renderNumericColumn=function(e){var o=a.Wrapper.DOMUtils,g=e.element,i=(o.getAttribute(g,"type"),o.getAttribute(g,"id")),l=o.getAttribute(g,"value"),s=!1,d=a.Manager.SidePanelManager.getActiveMeta(),c=0;if(null!=d.getAggregationNumericColumns()&&(c=d.getAggregationNumericColumns().length),1==c&&(s=d.getAggregationNumericColumns()[0].replace(/'/g,"").split(":")[0]===l),"choose"!==r.zcombo("#chartLegendCombo0","getValue")&&1==c&&!s)return t.ZSAlert(n["Chart.Aggregation.SingleNumColumn"]),null;if("NONE"===i)return"";var u=o.getAttribute(g,"header"),h=o.getAttribute(g,"displayValue"),m=o.createElement("span",{id:i,value:l,header:u});return m.innerText=h,o.addStyle(m,{display:"block"}),m},a.Aggregation.callAggregationComboChangeEvents=function(e){var t=this[e.target.getAttribute("callback")](e,!0);a.Action.DoAggregation(t)},a.Aggregation.callAggregationRemoveEvents=function(e){var t=this[e.target.getAttribute("callback")](e,!1);a.Action.DoAggregation(t)},a.Aggregation.aggregationNumberColsChange=function(e,t){var o=e.params.data.id;if("choose"!==o){a.Aggregation;var n=a.Manager.SidePanelManager.getActiveMeta(),g=n.getAggregationNumericColumns(),i=n.getAggColHeaders(),l="choose"!==r.zcombo("#chartLegendCombo0","getValue"),s=n.getAggregationDateOperations();if(!(l&&g.length>0&&-1===g.indexOf(o))){if(0==g.length)g.push(o);else{var d=0;for(d=0;d<g.length;d++){var c=!1;if(-1!==g[d].replace(/\'/g,"").indexOf(o)){c=!0;break}}c?g.splice(d,1):g.push(o)}var u=g.join(";");return{colheaders:i.join(";"),dateOperations:s,type:r.zcombo("#aggreoperation","getValue"),enabled:!0,numericColumns:u}}r.select2("#chartNumColsCombo0",void 0,"setValue",g)}},a.Aggregation.resetNumericColumns=function(){r.select2("#chartNumColsCombo0",void 0,"reset")},a.Aggregation.shuffleHeadersForAggregation=function(e){for(var t=a.Wrapper.DOMUtils,r=e.querySelectorAll(".select2-selection__choice"),o=[],n=0;n<r.length;n++)o.push(t.getAttribute(r[n].children[1],"value"));var g=a.Utility.getDateOperationsByHeaders(o),i=null!=o&&""!==o,l={};l.colheaders=o.join(";"),l.dateOperations=g.join(","),l.enabled=i,a.Action.DoAggregation(l,!0)},a.Aggregation.bindSortableEventsForAggregation=function(e,t){var o=e.querySelector(".select2-selection__rendered"),n=a.Wrapper.DOMUtils;n.addAttributes(o,{comboType:t}),r.sortable(o,{axis:"x",update:function(t,r){var o=n.getAttribute(t.target,"comboType");"headers"===o&&a.Aggregation.shuffleHeadersForAggregation(e),"numbers"===o&&a.Aggregation.shuffleNumbersForAggregation(e)}})},a.Aggregation.shuffleNumbersForAggregation=function(e){for(var t=a.Wrapper.DOMUtils,r=e.querySelectorAll(".select2-selection__choice"),o=[],n=0;n<r.length;n++)o.push(t.getAttribute(r[n].children[1],"value"));var g={};g.numericColumns=o.join(";"),a.Action.DoAggregation(g,!0)},a.Aggregation.aggregationGroupByClauseChange=function(e,o,g){var i=e.value,l=a.Wrapper.DOMUtils,s=r.zcombo("#chartAxisCombo0","getValue"),d=r.zcombo("#chartLegendCombo0","getValue");if("choose"!==s&&"choose"!==d&&s===d)return t.ZSAlert(n["Chart.Aggregation.AxisAndLegend"]),"Axis"===o&&r.zcombo("#chartAxisCombo0","setValue",e.previousValue),void("Legend"===o&&r.zcombo("#chartLegendCombo0","setValue",e.previousValue));var c=a.Manager.SidePanelManager.getActiveMeta(),u=c.getSeriesIn(),h=c.getFirstRowAsLabel(),m=c.getFirstColAsLabel();this.aggregationComboChanged(i,u,m,h);var p=[],A=c.getAggregationDateOperations(),b=a.Aggregation.getAggregationNumbersAsString(),C=!1;""!==s&&"choose"!==s&&p.push(s),""===s||"choose"===s&&(C=!0),""!==d&&"choose"!==d&&p.push(d),""!==d&&"choose"!==d&&l.addClass(l.getElementByClassName("select2-selection__rendered"),"hideSecondLi"),""===d||"choose"===d&&l.removeClass(l.getElementByClassName("select2-selection__rendered"),"hideSecondLi"),"Axis"===o&&""===s&&(A=this.getDateOperations(A,0,"NONE")),"Legend"===o&&""===d&&(A=this.getDateOperations(A,1,"NONE"));var v=p.join(";"),E=r.zcombo("#aggreoperation","getValue"),f=null!=v&&""!==v||null!=b&&""!==b&&"NONE"!==E;return null!=v&&""!=v||null!=b&&""!=b||(this.enableLabelCheckBox(u),this.resetNumericColumns()),{colheaders:v,dateOperations:A,type:E,enabled:f,numericColumns:b,noAxis:C}},a.Aggregation.displayHideDatePicker=function(e,t,r){var o=a.Wrapper.DOMUtils,n=o.getAttribute(t,"type");return"DATE"===n&&o.showById(e),"DATE"!==n&&o.hideById(e),n},a.Aggregation.getAggregationHeadersAsString=function(){var e=r.zcombo("#chartAxisCombo0","getValue")||"",t=r.zcombo("#chartLegendCombo0","getValue")||"",a=[];return""!==e&&"choose"!==e&&a.push(e),""!==t&&"choose"!==t&&a.push(t),a.join(";")},a.Aggregation.getAggregationNumbersAsString=function(){var e=[];return(e=r.select2("#chartNumColsCombo0",void 0,"getValue")?r.select2("#chartNumColsCombo0",void 0,"getValue"):[])?e.join(";"):""},a.Aggregation.setHeadersInAggregationDom=function(e,t,o){var n="choose",g="choose",i=a.Wrapper.DOMUtils,l=!t&&e&&e.length>0?0:void 0,s=e&&e.length>1?1:t&&e&&e.length>0?0:void 0;e&&e.length>2&&e.splice(2),o.setAggregationGroupByColumns(e.join(";")),void 0!==l&&(g=e[l]),void 0!==s&&(n=e[s]),r.zcombo("#chartAxisCombo0","setValue",g),r.zcombo("#chartLegendCombo0","setValue",n),"choose"!==n&&i.addClass(i.getElementByClassName("select2-selection__rendered"),"hideSecondLi"),""===n||"choose"===n&&i.removeClass(i.getElementByClassName("select2-selection__rendered"),"hideSecondLi")},a.Aggregation.bindMenuOpeningEvent=function(){r.bind("#aggDateMenu","zmenubeforeshow",function(e,t){var o="",n=t.forElement[0].id;-1!==n.indexOf("Axis")&&(o=r.zcombo("#chartAxisCombo0","getValue")),-1!==n.indexOf("Legend")&&(o=r.zcombo("#chartLegendCombo0","getValue")),a.Aggregation.resetSelectedState();var g=a.Utility.getDateOperationByIndex(o);g&&"NONE"!==g&&a.Aggregation.setSelectedState(g)})},a.Aggregation.hideShowDateOperations=function(e){var t=a.Wrapper.DOMUtils,o=a.DecTable.getDecTableInstance(e),n=r.zcombo("#chartAxisCombo0","getValue"),g=a.DecTable.getTypeFromDecTable(o,n);"DATE"===g&&t.showById("chartAxisDatePicker"),"DATE"!==g&&t.hideById("chartAxisDatePicker"),n=r.zcombo("#chartLegendCombo0","getValue"),"DATE"===(g=a.DecTable.getTypeFromDecTable(o,n))&&t.showById("chartLegendDatePicker"),"DATE"!==g&&t.hideById("chartLegendDatePicker")},a.Aggregation.setNumbersInAggregationDom=function(e,t){r.select2("#chartNumColsCombo0",void 0,"setValue",e)}}(this);
!function(e){var t=e.sPlusPlus,a=(e.ZSClass,e.JSUtill,e.UserAction,e.ZSConstants.I18N),n=e.UIUtil.Component,r=e.ZSEvents,l=r.Groups,o=r.Names,g=r.topic,i=e.ZSChart;!i.DecTable&&(i.DecTable={});i.Constants.ServiceProvider,i.Constants.ChartType,i.Constants.ColorSchemeType,i.Constants.ChartRangePickerType,e.ZSDevTools.Logger;var s={};function c(){this.initDecTable()}c.prototype.initDecTable=function(){this.decTableResponse=null,this.splitRanges=null,this.decTable=null,this.depthArray=null,this.rangeStr=null},c.prototype.setSeriesIn=function(e){this.seriesIn=e},c.prototype.getSeriesIn=function(){return this.seriesIn},c.prototype.setDepthIndices=function(e){this.depthArray=e},c.prototype.getDepthIndices=function(){return this.depthArray},c.prototype.setSplitRanges=function(e){this.splitRanges=e},c.prototype.getSplitRanges=function(){return this.splitRanges},c.prototype.setDecTable=function(e){this.decTable=e},c.prototype.getDecTable=function(){return this.decTable},c.prototype.setDecTableResponse=function(e){this.decTableResponse=e},c.prototype.getDecTableResponse=function(){return this.decTableResponse},c.prototype.setRangeString=function(e){this.rangeStr=e},c.prototype.getRangeString=function(){return this.rangeStr},i.DecTable.processSplitRange=function(e){for(var t=[],a=e.getDecTableResponse(),n=0;n<a.length;n++)for(var r=null!=a[n]?Object.keys(a[n]):[],l=a[n],o=0;o<r.length;o++)if("splitRanges"===r[o])for(var g=l[r[o]].rangeData.headers,i=g?Object.keys(g):[],s=0;s<i.length;s++)t.push(g[i[s]]);e.setSplitRanges(t)},i.DecTable.initializeRangeMap=function(e){if(e=e.replace(/'/g,""),s[e])return s[e];var t=new i.Model.ChartDecTable;return s[e]=t,t.setRangeString(e),t},i.DecTable.getDecTableInstance=function(e){return e&&(e=e.replace(/'/g,""),s&&s[e])?s[e]:null},i.DecTable.initializeDecTableInstance=function(e,t,a,n){n.setSeriesIn(t?"COLS":"ROWS"),n.setDecTableResponse(e),n.setRangeString(a)},i.DecTable.processDecTableResponse=function(e,t,a,n){i.Manager.SidePanelManager.TABEL_DEFINATION=!1,i.DecTable.initializeDecTableInstance(n,e,t,a),i.DecTable.processSplitRange(a),i.DecTable.processDecTable(a);var r=i.DecTable.getDataRanges(t);i.DecTable.processDepthIndices(a,r),g.publish(l.UI,o.SidePanel.CHARTS.FILTERCOLUMNS,{depthArray:a.getDepthIndices()})},i.DecTable.getDataRanges=function(e){for(var t=[],a=(i.Manager.SidePanelManager,new i.Utility.ChartAgent,e.split(";")),n=0;n<a.length;n++){var r=i.DecTable.getRangeObject(a[n]);t.push(r)}return t},i.DecTable.processDecTable=function(e){var t=[],n=e.getDecTableResponse();if(null!=n)for(var r=0;r<n.length;r++){var l=n[r]?Object.keys(n[r]):[],o=n[r],g=i.DecTable.getRangeObject(o.rangeStr);t[r]={};for(var s=0;s<l.length;s++)if("splitRanges"!==l[s]&&"rangeStr"!==l[s]){var c={};c.headerValue=o[l[s]].colHead||o[l[s]].rowHead,c.headerLabel="COLS"==e.getSeriesIn()?a["Sheet.Column"]+" "+i.DecTable.getColheaderLabel(parseInt(l[s])+1):a["Sheet.Row"]+" "+i.DecTable.getRowheaderLabel(parseInt(l[s])),c.headerRange="COLS"==e.getSeriesIn()?i.DecTable.getHeaderLabelRange(g.sheetName,parseInt(l[s]),g.range.startRow):i.DecTable.getHeaderLabelRange(g.sheetName,parseInt(l[s]),g.sC),c.type=o[l[s]].type,t[r][l[s]]=c}}e.setDecTable(t)},i.DecTable.getTotalHeaders=function(e){for(var t=0,a=e.decTable||[],n=0;n<a.length;n++)t+=Object.keys(a[n]).length;return 0==t?3:t},i.DecTable.processDepthIndices=function(e,t){var n=i.Manager.SidePanelManager,r=(i.Wrapper.DOMUtils,[]),l=n.getActiveMeta();if(l){var o=e.getSeriesIn();if("COLS"==o)for(var g=0;g<t.length;g++){for(var s=[],c=(u=(b=t[g]).range).startCol;c<=u.endCol;){var p=i.DecTable.getMergeSpanInfo(u.startRow,c,o);d=null!=(d=i.DecTable.getHeaderValueFromDecTable(e,g,c))?d:{},p>0&&(d=i.DecTable.getSplitRangeObject(c,e)),(D={}).headerLabel=a["Sheet.Column"]+" "+i.DecTable.getColheaderLabel(c+1),i.DecTable.checkIfHeaderAlreadyExists(r,D.headerLabel)||(D.headerValue=d.headerValue,D.type=d.type,D.headerRange=i.DecTable.getHeaderLabelRange(b.sheetName,c,u.startRow),s.push(D)),c+=p+1}r.push(s)}else for(g=0;g<t.length;g++){s=[];var b,u,h=(u=(b=t[g]).range).endRow-u.startRow;for(c=u.startRow;c<=u.endRow&&h<20;){var d,D;p=i.DecTable.getMergeSpanInfo(c,u.startCol,o);d=null!=(d=i.DecTable.getHeaderValueFromDecTable(e,g,c))?d:{},p>0&&(d=i.DecTable.getSplitRangeObject(c,e)),(D={}).headerLabel=a["Sheet.Row"]+" "+i.DecTable.getRowheaderLabel(c),i.DecTable.checkIfHeaderAlreadyExists(r,D.headerLabel)||(D.headerValue=d.headerValue,D.type=d.type,D.headerRange=i.DecTable.getHeaderLabelRange(b.sheetName,u.startCol,c),s.push(D)),c+=p+1}r.push(s)}e.setDepthIndices(r),i.Aggregation.loadGroupByClauses(r,0,"chartAxisCombo0"),i.Aggregation.loadGroupByClauses(r,0,"chartLegendCombo0"),i.Aggregation.populateNumberColumns(l,r,0),i.DecTable.populateFilterColumns(l,e),(new i.Utility.AgentDom).updateAggFilterProperties(l)}},i.DecTable.populateFilterColumns=function(e,t){var a=i.Wrapper.DOMUtils,r="",l=a.getElementById("filterColumns");l.innerHTML="",r=a.createElement("option",{id:"noFilter",value:"noFilter"}),a.appendChild(l,r),a.getElementById("noFilter").innerText="Select";var o=t.getDepthIndices();if(e.getAggregationEnabled()&&"COUNT"===e.getAggregationOperation())r=a.createElement("option",{id:"count",value:"NONE"}),a.appendChild(l,r),a.getElementById("count").innerText="Count";else for(var g=0;g<o.length;g++)for(var s=o[g],c=0;c<s.length;c++){var p=s[c];if("NUMBER"===p.type||"DECIMAL"===p.type||"CURRENCY"===p.type||"PERCENTAGE"===p.type||"EMPTY"===p.type){var b=p.headerValue||p.headerLabel,u=p.headerLabel.replace(" ","");r=a.createElement("option",{id:u,value:p.headerRange,header:p.headerLabel,displayValue:b}),a.appendChild(l,r),a.getElementById(u).innerText=b}}n.zcombo("#filterColumns","refresh")},i.DecTable.getLastFilterElement=function(e){var t=e.getDepthIndices(),a=t[t.length-1];return a[a.length-1].headerRange},i.DecTable.getMergeSpanInfo=function(e,a,n){var r=t.view.getActiveGridID(),l=t.view.getResourceID(r),o=t.view.getVersionID(r),g=t.view.getSheetID(r),i=t.data.getWorkBook(l,o).getSheetObj(g).Merge.getInfo(e,a);return i?"COLS"==n?i.endCol-i.startCol:i.endRow-i.startRow:0},i.DecTable.getHeaderValueFromDecTable=function(e,t,a){var n=e&&e.getDecTable();if(n&&n.length>t)for(var r=Object.keys(n[t]),l=0;l<r.length;l++)if(r[l]==a)return n[t][r[l]];return null},i.DecTable.getTypeFromDecTable=function(e,t){var a=e&&e.getDepthIndices();if(a&&a.length>0)for(var n=0;n<a.length;n++)for(var r=a[n],l=0;l<r.length;l++){var o=r[l];if(o.headerRange===t)return o.type}},i.DecTable.checkIfHeaderAlreadyExists=function(e,t){if(e&&e.length>0)for(var a=0;a<e.length;a++){if(e[a].headerLabel===t)return!0}return!1},i.DecTable.getColheaderLabel=function(e){return JSUtil.Object.getCharForNum(e)},i.DecTable.getRowheaderLabel=function(e){if(!isNaN(e))return e+1},i.DecTable.getHeaderLabelRange=function(e,t,a){return e+"."+i.DecTable.getColheaderLabel(t+1)+i.DecTable.getRowheaderLabel(a)},i.DecTable.getRangeObject=function(e){var a=t.view.getActiveGridID(),n=t.view.getResourceID(a),r=t.view.getVersionID(a);t.view.getSheetID(a);return JSUtil.Range.parseRange(n,r,e)},i.DecTable.constructRangeString=function(e){if("NONE"===e)return e;var a=t.view.getActiveGridID(),n=t.view.getResourceID(a),r=t.view.getVersionID(a),l=(t.view.getSheetID(a),JSUtil.Range.parseRange(n,r,e));return l?i.DecTable.getHeaderLabelRange(l.sheetName,l.range.startCol,l.range.startRow):null},i.DecTable.getHeaderIndexes=function(e,t){for(var a=[],n=0;n<e.length;n++){var r=i.DecTable.getRangeObject(e[n]);"COLS"===t&&a.push(r.range.startCol),"ROWS"===t&&a.push(r.range.startRow)}return a},i.DecTable.validateAggregationHeaders=function(e){var t=[],a=e.getRange().split(";"),n=e.getAggregationColHeaders(),r=e.getSeriesIn(),l=i.DecTable.getHeaderIndexes(n,e.getSeriesIn());if("COLS"===r)for(var o=0;o<a.length;o++)for(var g=a[o],s=(u=i.DecTable.getRangeObject(g)).range.startCol,c=u.range.endCol,p=s;p<=c;p++)for(var b=0;b<l.length;b++){l[b]===p&&t.push(n[b])}else for(o=0;o<a.length;o++){var u;for(g=a[o],s=(u=i.DecTable.getRangeObject(g)).range.startRow,c=u.range.endRow,p=s;p<=c;p++)for(b=0;b<l.length;b++){l[b]===p&&t.push(n[b])}}return t},i.DecTable.getSplitRangeObject=function(e,t){for(var a={},n=t.getSplitRanges(),r=t.getSeriesIn(),l=0;l<n.length;l++)"COLS"==r?n[l].colIndex==e&&(a.headerValue=n[l].name,a.type="text"):n[l].rowIndex==e&&(a.headerValue=n[l].name,a.type="text");return a},i.Utility.getComboId=function(e,t,a){for(var n=-1!==a.indexOf("Agg")?"grp":"num",r=t.getDepthIndices(),l=0;l<r.length;l++)for(var o=r[l],g=Object.keys(o),i=0;i<g.length;i++){var s=g[i];if(null!=o[s]&&-1!==o[s].headerRange.indexOf(e))return n+"combo0_"+o[s].headerLabel.replace(/\s/g,"")}},i.Model.ChartDecTable=c,i.DecTable.getRangeDecTableMap=function(e){return e&&(e=e.replace(/'/g,"")),e&&s[e]?s[e]:null},i.DecTable.clearRangeDecTableMap=function(){s={}},i.DecTable.removeRangeEntry=function(e){e&&(e=e.replace(/'/g,"")),e&&s[e]&&delete s[e]}}(this);
!function(t){var e=t.sPlusPlus,i=(t.ZSClass,t.UIUtil.Component),o=t.ZSChart;o.Constants.ChartRangePickerType;function n(){this.isDrag=!1,this.isRecommend=!1,this.type="",this.chartId="",this.dlt=!1,this.sRow=0,this.sCol=0,this.sColDiff=0,this.sRowDiff=0,this.floating=!1,this.top=null,this.left=null,this.trendline=!1,this.isPivotChart=!1,this.pivotId=null,this.trendlineType="None",this.trendlineDegree=2,this.lPostion=3,this.dLables,this.threshold=null,this.slant="Auto",this.staggerLines=1,this.yAxis=[],this.styleObject=[],this.xAxis=[],this.chartTitle="",this.subTitle="",this.zoom=!0,this.tooltip=!0,this.animation=!0,this.autoExpand=!0,this.isIncludeHidden=!0,this.combinedRange="HORIZONTAL",this.frl=!1,this.fcl=!1,this.dataRange=null,this.currency="",this.options=null,this.width,this.height,this.seriesIn="COLS",this.majorGridLine=!1,this.minorGridLine=!1,this.HCInstance=null,this.isSingleYaxis=!1,this.isCellExceed=!1,this.isMarker=!1,this.lineStyle=[],this.comboTypes=["COL"],this.noOfYAxies=1,this.isGrouping=!1,this.activeYAxisIndex=0,this.ts=",",this.ds=".",this.titleJsonForSP={},this.styleJsonForSP={},this.filter={},this.aggregation={},this.rc={},this.titleValueChanged=!1,this.chartTitleAlignmentChanged=!1,this.associatedSheetId=null,this.xReverse=!1,this.activeTitleIndex=0,this.aggregationHeaderOperationMap=[],this.binning={},this.lineStyles=[],this.gradient={enabled:!1,iab:!1,ias:!1,cgType:"radial",sgType:"radial",cgReversed:!1,sgReversed:!1}}n.prototype.isCellExceeded=function(){return this.isCellExceed},n.prototype.updateThresholdValue=function(t){this.threshold=t},n.prototype.updateThresholdColor=function(t){this.getStyleObject().colorObject.thresholdColor=t},n.prototype.setActiveTitleIndex=function(t){this.activeTitleIndex=t},n.prototype.updateDataLabelTotals=function(t){this.dlt=t},n.prototype.getAggregationHeaderMap=function(){return this.aggregationHeaderOperationMap},n.prototype.getActiveTitleIndex=function(){return this.activeTitleIndex},n.prototype.getXReverse=function(){return this.xReverse},n.prototype.getAssociatedSheetId=function(){return this.associatedSheetId},n.prototype.addTitleJsonForSP=function(t,e){this.titleJsonForSP[t]=o.Utility.getDecodeString(e)},n.prototype.addTitleStyleJsonForSP=function(t,e){this.styleJsonForSP[t]=e},n.prototype.getFontFamily=function(){var t="Lato";return this.options.chart&&this.options.chart.style&&(t=this.options.chart.style.fontFamily),""!==t?t:"Lato"},n.prototype.getTitleJsonForSP=function(t){return this.titleJsonForSP[t]},n.prototype.getTitleAlignment=function(t){return this.options.title&&this.options.title.align||"center"},n.prototype.getSubTitleAlignment=function(t){return this.options.subtitle&&this.options.subtitle.align||"center"},n.prototype.getTitleStyleJsonForSP=function(t){return this.styleJsonForSP[t]},n.prototype.resetTitleJsonForSP=function(t){this.titleJsonForSP={},this.styleJsonForSP={}},n.prototype.getStyleObject=function(t){return this.styleObject[t||0]},n.prototype.getThousandSeprator=function(){return this.ts},n.prototype.getDecimalSeprator=function(){return this.ds},n.prototype.getGradient=function(){return this.gradient},n.prototype.setExtractOptions=function(e,i){var o=this.cloneOf(e.co||i),n=o.colorOptions.colorTheme,s=n.basecolor,r=n.name,a=n.isReversed;o=(new t.ZSChart.Utility.ChartAgent).getColorSchemenColors(o,s,r,a),this.setOptions(o)},n.prototype.setOptions=function(t){this.options=t},n.prototype.getComboChartTypes=function(){return this.options.comboChartTypes},n.prototype.getChartTitleStyle=function(){return this.options.title.style},n.prototype.getLegendStyle=function(){return this.options.legend.itemStyle},n.prototype.getChartSubTitleStyle=function(){return this.options.subtitle.style},n.prototype.getChartXAxisTitleStyle=function(){return(this.options.xAxis.length?this.options.xAxis[0]:this.options.xAxis).title.style},n.prototype.getChartYAxisTitleStyle=function(t){return this.options.yAxis[t].title.style},n.prototype.getOptions=function(){return this.options},n.prototype.setInstance=function(t){this.HCInstance=t},n.prototype.getInstance=function(){return this.HCInstance},n.prototype.setTooltip=function(t){this.tooltip=t},n.prototype.setInverted=function(t){this.options.chart.inverted=t},n.prototype.setSpline=function(t){var e=t?"area":"areaspline",i=t?"areaspline":"area";this.options.chart.type=e;var o=this.options.plotOptions[i];this.options.plotOptions[e]=o},n.prototype.setZoom=function(t){this.zoom=t},n.prototype.setExpand=function(t){this.autoExpand=t},n.prototype.setGradinetStatus=function(t){this.gradient.enabled=t},n.prototype.setChartGradientStatus=function(t){this.gradient.iab=t,this.setGradinetStatus(this.gradient.iab||this.gradient.ias),this.updateChartGradientType(t)},n.prototype.setSeriesGradientStatus=function(t){this.gradient.ias=t,this.setGradinetStatus(this.gradient.iab||this.gradient.ias),this.updateSeriesGradientType(t)},n.prototype.updateChartGradientType=function(t){this.gradient.cgType="radial",this.gradient.cgReversed=!0},n.prototype.updateSeriesGradientType=function(t){this.gradient.sgType="linear",this.gradient.sgReversed=!0},n.prototype.getLogarithmic=function(t){return"logarithmic"===this.yAxis[t].type},n.prototype.setAnimation=function(t){this.animation=t},n.prototype.updateInterpolationOption=function(t){this.options.rc.interpolate=t},n.prototype.updateSumOption=function(t){this.options.rc.cumulate=t},n.prototype.updateMissingValOption=function(t){this.options.rc.mvo=t},n.prototype.setHiddenCells=function(t){this.isIncludeHidden=t},n.prototype.setTitle=function(t){var e=this.chartTitle;return this.chartTitle=t,""===e&&2==this.lPostion},n.prototype.setTitleAlignment=function(t){this.options.title.align=t},n.prototype.isChartTitleAlignChanged=function(t){this.chartTitleAlignmentChanged=t},n.prototype.isChartTitleValueChanged=function(t){this.titleValueChanged=t},n.prototype.isSubTitleValueChanged=function(t){this.titleValueChanged=t},n.prototype.isXTitleValueChanged=function(t){this.titleValueChanged=t},n.prototype.isYTitleValueChanged=function(t){this.titleValueChanged=t},n.prototype.isTitleValueChanged=function(){return this.titleValueChanged},n.prototype.isChartTitleAlignmentChanged=function(){return this.chartTitleAlignmentChanged},n.prototype.setTitleValueChanged=function(t){this.titleValueChanged=t},n.prototype.setSubTitle=function(t){var e=this.subTitle;return this.subTitle=t,""===e&&2==this.lPostion},n.prototype.updateXTitle=function(t,e){this.xAxis[e].title.text=t},n.prototype.updateYTitle=function(t,e){this.yAxis[e].title.text=t},n.prototype.updateLegend=function(t){var e=t.value,i=this.getLegendPosition(e);this.lPostion=i},n.prototype.updateOptionByTitle=function(t){this.getOptions().title.text=t},n.prototype.updateTitleAlignmentOption=function(t){this.getOptions().title.align=t},n.prototype.updateOptionBySubtitle=function(t){this.getOptions().subtitle.text=t},n.prototype.updateDataLabels=function(t){this.dLables="object"==typeof t?t.value:t},n.prototype.getTitle=function(t){return"WORDCLOUD"!=this.type||"WORDCLOUD"==this.type&&this.isCloned()?t?o.Utility.getEncodeStringAfterDecode(this.chartTitle):this.chartTitle:""},n.prototype.getSubTitle=function(t){return t?o.Utility.getEncodeStringAfterDecode(this.subTitle):this.subTitle},n.prototype.setType=function(t){"COMBOCHART"!=t&&this.setYAxisState(!1),-1!=t.indexOf("ANIMATION_CHART")&&(this.styleObject||(this.styleObject=[]),this.styleObject[0]||(this.styleObject[0]={}),this.styleObject[0].xAxis||(this.styleObject[0].xAxis={}),this.styleObject[0].xAxis.labelStyle||this.styleObject[0].xAxis.labelStyle,this.styleObject[0].xAxis.labelStyle.fontSize="14px",this.styleObject||(this.styleObject=[]),this.styleObject[0]||(this.styleObject[0]={}),this.styleObject[0].yAxis||(this.styleObject[0].yAxis=[]),this.styleObject[0].yAxis[0]||(this.styleObject[0].yAxis[0]={}),this.styleObject[0].yAxis[0].labelStyle||this.styleObject[0].yAxis[0].labelStyle,this.styleObject[0].yAxis[0].labelStyle.fontSize="14px"),this.type=t},n.prototype.getSeriesLength=function(){try{return this.getOptions().series.length}catch(t){return 0}},n.prototype.getType=function(){return"BUBBLE"==this.type?"BUBBLECHART":this.type},n.prototype.getActiveChartThemeName=function(){return this.getOptions().colorOptions.colorTheme.name},n.prototype.getDefaultStartRow=function(){var t=e.view.getActiveGridID(),i=e.view.getResourceID(t),o=e.view.getVersionID(t),n=e.view.getSheetID(t);return e.data.getWorkBook(i,o).getSheetObj(n).Row.auxiliaryAxis.findAbs(this.getTop())},n.prototype.getStartRowIndex=function(){var t=o.Utility.getChartMeta(o.Utility.getActiveChart(),!0);return t?t.getStartRowIndex():0==this.sRow?this.getDefaultStartRow():this.sRow},n.prototype.setStartRowIndex=function(t){this.sRow=t},n.prototype.getDefaultStartCol=function(){var t=e.view.getActiveGridID(),i=e.view.getResourceID(t),o=e.view.getVersionID(t),n=e.view.getSheetID(t);return e.data.getWorkBook(i,o).getSheetObj(n).Column.auxiliaryAxis.findAbs(this.getLeft())},n.prototype.setStartColIndex=function(t){this.sCol=t},n.prototype.getStartColIndex=function(){var t=o.Utility.getChartMeta(o.Utility.getActiveChart(),!0);return t?t.getStartColIndex():0==this.sCol?this.getDefaultStartCol():this.sCol},n.prototype.getStartRowDiff=function(){return this.sRowDiff},n.prototype.getStartColDiff=function(){return this.sColDiff},n.prototype.getFirstRowAsLabel=function(){return this.frl},n.prototype.getFirstColAsLabel=function(){return this.fcl},n.prototype.getCenterPoint=function(){var t=e.view.getActiveGridID();e.view.getResourceID(t),e.view.getVersionID(t),e.view.getSheetID(t);return e.view.getGridComponent(t).getCenterPoint()},n.prototype.getDefaultLeft=function(){var t=e.view.getActiveGridID(),i=e.view.getSheetID(t),o=e.view.getSheetState(t,i).getZoom(),n=this.getCenterPoint(),s=parseInt(n.x)-parseInt(this.getWidth()/2);return Math.round(s/o)},n.prototype.getLeft=function(t){var e=o.Utility.getChartMeta(o.Utility.getActiveChart(),!0);return e?e.getLeft():t&&this.left?this.left:this.isDrag?this.left:this.getDefaultLeft()},n.prototype.setLeft=function(t){this.left=t},n.prototype.setTop=function(t){this.top=t},n.prototype.setDragMode=function(t){this.isDrag=t},n.prototype.resetRowColIndex=function(){this.sCol=this.sRow=0},n.prototype.getDefaultTop=function(){var t=e.view.getActiveGridID(),i=e.view.getSheetID(t),o=e.view.getSheetState(t,i),n=(o.getScrollTops(),o.getZoom()),s=this.getCenterPoint(),r=parseInt(s.y)-parseInt(this.getHeight()/2);return Math.round(r/n)},n.prototype.getTop=function(t){var e=o.Utility.getChartMeta(o.Utility.getActiveChart(),!0);return e?e.getTop():t&&this.top?this.top:this.isDrag?this.top:this.getDefaultTop()},n.prototype.getActiveSheet=function(){var t=e.view.getActiveGridID();return e.view.getSheetID(t)},n.prototype.getRange=function(){return this.dataRange},n.prototype.getSplitDataRanges=function(){var t=null;if(this.aggregation){var e=this.getAggregation();e.enabled&&(t="",t+=e.colheaders+";",t+=e.numericColumns)}return t||this.dataRange},n.prototype.setRange=function(t){return o.DecTable.removeRangeEntry(this.dataRange),this.dataRange!=t&&(this.dataRange=t)},n.prototype.getSeriesIn=function(){return this.seriesIn},n.prototype.getHeight=function(){return void 0==this.height&&(this.height="ANIMATION_CHART"==this.type?456:380),this.height},n.prototype.getWidth=function(){return void 0==this.width&&(this.width="ANIMATION_CHART"==this.type?738:615),this.width},n.prototype.getCustomStyle=function(t){return this.styleObject[t||0]},n.prototype.getZoomType=function(){return""},n.prototype.getToolTip=function(){return this.tooltip},n.prototype.getInverted=function(){return!!this.options.chart.inverted&&this.options.chart.inverted},n.prototype.getSpline=function(){return"areaspline"==this.options.chart.type},n.prototype.getXTitle=function(t){return this.xAxis[0].title?t?o.Utility.getEncodeStringAfterDecode(this.xAxis[0].title.text):this.xAxis[0].title.text:""},n.prototype.getYTitle=function(t){return this.yAxis[t||0].title.text},n.prototype.getAnimation=function(){return this.animation},n.prototype.getAutoExpandState=function(){return this.autoExpand},n.prototype.getInterpolation=function(){return this.options.rc.interpolate||!1},n.prototype.getSumOption=function(){return this.options.rc.cumulate||!1},n.prototype.getMissingValOption=function(){return this.options.rc.mvo||0},n.prototype.getTrendline=function(){return this.trendline},n.prototype.getFloating=function(){return this.floating},n.prototype.getMajorGridWidth=function(t){return this.majorGridLine?1:0},n.prototype.getMinorTickInterval=function(t){return this.minorGridLine?"auto":""},n.prototype.getXLabel=function(t){return this.xAxis[t||0].labels.enabled},n.prototype.getYLabel=function(t){return this.xAxis[t||0].labels.enabled},n.prototype.setYAxisState=function(t){this.isSingleYaxis=t},n.prototype.getYAxisState=function(){return!!(new o.Utility.ChartAgent).isMutipleAxiesChart(this.type)&&this.isSingleYaxis},n.prototype.getHiddenCellState=function(){return this.isIncludeHidden},n.prototype.getXSlant=function(t){return"Auto"==this.slant?null:this.slant},n.prototype.getLabelFormat=function(t){if(!this.dLables||""==this.dLables.trim()){var e=-1!=this.type.indexOf("PIE")||-1!=this.type.indexOf("DOUGHNUT"),i=-1!=this.type.indexOf("FUNNEL");return"ANIMATION_CHART"==this.type?"V":e||i?"L_P":"N"}return this.dLables},n.prototype.setCombinedWay=function(t){this.combinedRange=t},n.prototype.getCombinedWay=function(){return this.combinedRange},n.prototype.getMarkerState=function(){return this.isMarker},n.prototype.setMarkerState=function(t){this.isMarker=t},n.prototype.getLPos=function(){return this.lPostion},n.prototype.getTrendlineTypes=function(){return this.trendlineType},n.prototype.isTrendline=function(){return this.getTrendline()&&"none"!=this.getTrendlineTypes()},n.prototype.getDegreeOrElse=function(){return this.trendlineDegree},n.prototype.getThreshold=function(){return this.threshold},n.prototype.getPivotState=function(){return this.isPivotChart},n.prototype.isCloned=function(){return!1},n.prototype.getComboTypes=function(){return this.comboTypes},n.prototype.setComboTypes=function(t){this.comboTypes=t},n.prototype.updateNoOfYAxies=function(){var t=this.options.series,e=t?t.length:1;this.setNoOfYAxies(this.isSingleYaxis?e:1)},n.prototype.getTitleObject=function(){return this.options.title},n.prototype.getSubTitleObject=function(){return this.options.subtitle},n.prototype.constructTitleJsonForSP=function(){var t=this.getOptions().cellRef,e=t.titleRange?"="+t.titleRange:this.getTitle(),i=t.subtitleRange?"="+t.subtitleRange:this.getSubTitle(),o=t.xtitleRange?"="+t.xtitleRange:this.getXTitle();this.addTitleJsonForSP("CHART_TITLE",e),this.addTitleJsonForSP("CHART_SUBTITLE",i),this.addTitleJsonForSP("CHART_X_AXIES",o);for(var n=0;n<this.getYAxis().length;n++){var s=0==n?"LA":"RA"+parseInt(n);this.addTitleJsonForSP(s,t["ytitleRange"+n]?"="+t["ytitleRange"+n]:this.getYAxis()[n].title.text)}},n.prototype.constructStyleJsonForSP=function(){var t=this.getTitleObject().style,e=this.getSubTitleObject().style,i=this.options.xAxis.title&&this.options.xAxis.title.style;this.addTitleStyleJsonForSP("CHART_TITLE",t),this.addTitleStyleJsonForSP("CHART_SUBTITLE",e),this.addTitleStyleJsonForSP("CHART_X_AXIES",i);for(var o=0;o<this.getYAxis().length;o++){var n=0==o?"LA":"RA"+parseInt(o);this.addTitleStyleJsonForSP(n,this.getYAxis()[o].title.style)}},n.prototype.setNoOfYAxies=function(t){this.noOfYAxies=t},n.prototype.getNoOfAxies=function(){return this.getYAxisState()?this.noOfYAxies:1},n.prototype.getYAxis=function(t){for(var e=0;e<this.yAxis.length;e++)if(this.yAxis[e].minorGridLineColor){var i=this.yAxis[e].minorGridLineColor.match(/^(rgba\([0-9\ ]+,[0-9\ ]+,[0-9\ ]+,(0\.\d+|0|1))/);null!=i&&i[0]===this.yAxis[e].minorGridLineColor&&(this.yAxis[e].minorGridLineColor=this.yAxis[e].minorGridLineColor+")")}var n=o.Utility.removeCursorPointer(this.yAxis);return t&&(n=o.Utility.encodeYAxis(n)),n},n.prototype.getXAxis=function(t){return this.xAxis[t||0]},n.prototype.getActiveYIndex=function(){return this.activeYAxisIndex},n.prototype.setActiveYIndex=function(t){this.activeYAxisIndex=t},n.prototype.getLineStyles=function(){return this.lineStyle},n.prototype.getPivotId=function(){return this.pivotId},n.prototype.getStaggerState=function(){return this.staggerLines},n.prototype.updateTrendtype=function(t){this.trendlineType=t.value;t.prevVal;return this.trendlineDegree=2,!1},n.prototype.setTrendline=function(t){this.trendline=t},n.prototype.updateTrendDegree=function(t){this.trendlineDegree=t.value},n.prototype.updateFontFamily=function(t){this.options.chart.style=t},n.prototype.updateTitleStyle=function(t,e,i){var n="";new o.Utility.ChartAgent;return"119"==t?(n=this.options.title.style.color,this.options.title.style=e):"120"==t?(n=this.options.subtitle.style.color,this.options.subtitle.style=e):"117"==t?(n=this.xAxis[0].title.style.color,this.xAxis[0].title.style=e):"118"==t&&(n=this.yAxis[this.getActiveTitleIndex()].title.style.color,this.yAxis[this.getActiveTitleIndex()].title.style=e),this.addTitleStyleJsonForSP(i,e),n},n.prototype.updateTitleAlignment=function(t,e){"119"==t&&(this.options.title.align=e),"120"==t&&(this.options.subtitle.align=e)},n.prototype.addNewPlotline=function(t){var e=new o.Utility.ChartAgent;this.options=e.addNewPlotline(this.options,t);var i=this.getActiveYAxisPltlines(t);(new o.Utility.AgentDom).refreshPlotlineDom(i)},n.prototype.removePlotlineByIndex=function(t){var e=new o.Utility.ChartAgent;this.options=e.removePlotlineByIndex(this.options,t);var i=this.getActiveYAxisPltlines(t);(new o.Utility.AgentDom).refreshPlotlineDom(i)},n.prototype.getActiveYAxisPltlines=function(t){var e=this.options.yAxis[t.index];return e.plotLines?e.plotLines:null},n.prototype.updatePlotLineName=function(t){var e=new o.Utility.ChartAgent;this.options=e.updatePlotLineName(this.options,t)},n.prototype.updateChartColor=function(t){this.options.chart.backgroundColor=t},n.prototype.updateChartBorderColor=function(t){this.options.chart.borderColor=t},n.prototype.updateXLabel=function(t,e,i){this.xAxis[e||0].labels.enabled=t,void 0!=i&&(this.options.chart.marginLeft=i.maxWidth)},n.prototype.updateXLabelStyle=function(t,e){this.xAxis[e||0].labels.style||(this.xAxis[e||0].labels.style={}),this.xAxis[e||0].labels.style[t.key]=t.value},n.prototype.updateYLabelStyle=function(t,e){this.yAxis[e||0].labels.style||(this.yAxis[e||0].labels.style={}),this.yAxis[e||0].labels.style[t.key]=t.value},n.prototype.updateXSlant=function(t){this.slant="Auto"===t.value?null:parseInt(t.value)},n.prototype.updateXStagger=function(t){this.staggerLines="auto"==t.value?1:parseInt(t.value)},n.prototype.updateYLabel=function(t,e){this.yAxis[e||0].labels.enabled=t},n.prototype.updateYReverse=function(t,e){this.yAxis[e||0].reversed=t},n.prototype.updateYLogarithmic=function(t,e){this.yAxis[e||0].type=t?"logarithmic":"linear"},n.prototype.updateYBaseValue=function(t,e){this.yAxis[e||0].baseValue=t},n.prototype.animationSpeed=function(t){this.options.chart.animation||(this.options.chart.animation={}),this.options.chart.animation.duration=t,this.options.rc.duration=t},n.prototype.getAnimationDuration=function(){return this.options.chart.animation?this.options.chart.animation.duration:200},n.prototype.updateCaptionFontWeight=function(t){this.options.caption&&this.options.caption.style&&(this.options.caption.style.fontWeight=t)},n.prototype.enableCaption=function(t){this.options.caption&&this.options.caption.style&&(this.options.caption.style.display=t?"block":"none")},n.prototype.updateCaptionFontSize=function(t,e){this.options.caption&&this.options.caption.style&&(this.options.caption.style.fontSize=t,this.options.caption.margin=e)},n.prototype.updateCaptionFontStyle=function(t){this.options.caption&&this.options.caption.style&&(this.options.caption.style.fontStyle=t)},n.prototype.updateCaptionFontColor=function(t){this.options.caption&&this.options.caption.style&&(this.options.caption.style.color=t)},n.prototype.updateBarCount=function(t){this.options.xAxis.max=t,this.options.rc.count=t},n.prototype.getBarCount=function(){return this.options.xAxis.max||0},n.prototype.updateSorting=function(t){this.options.plotOptions.series||(this.options.plotOptions.series={}),this.options.plotOptions.series.dataSorting||(this.options.plotOptions.series.dataSorting={}),this.options.plotOptions.series.dataSorting.enabled=t},n.prototype.getSortingOrder=function(){return this.options.plotOptions.series.dataSorting?this.options.plotOptions.series.dataSorting.order:"descending"},n.prototype.setSortingType=function(t){this.options.plotOptions.series||(this.options.plotOptions.series={}),this.options.plotOptions.series.dataSorting||(this.options.plotOptions.series.dataSorting={}),this.options.plotOptions.series.dataSorting.order=t,this.options.plotOptions.series.dataSorting.enabled=!0,this.options.rc.order=t},n.prototype.updateXReverse=function(t,e){this.xAxis[e||0].reversed=t,this.xReverse=t},n.prototype.updateYOpposite=function(t,e){this.yAxis[e||0].opposite=t},n.prototype.updateXReverse=function(t,e){this.xAxis[e||0].reversed=t},n.prototype.updateYPlotlineName=function(t,e,i){!this.yAxis[e||0].plotLines&&(this.yAxis[e||0].plotLines=[]),!this.yAxis[e||0].plotLines[i||0]&&(this.yAxis[e||0].plotLines[i||0]={}),this.yAxis[e||0].plotLines[i||0].labels={text:t},this.yAxis[e||0].plotLines[i||0].id="plot-line"+e+"_"+i},n.prototype.updateYPlotline=function(t,e,i){!this.yAxis[e||0].plotLines&&(this.yAxis[e||0].plotLines=[]);var o=this.options.series,n=null,s=null;try{n=this.yAxis[e||0].plotLines[i||0].color,s=this.yAxis[e||0].plotLines[i||0].dashStyle}catch(t){}n=n||(o[e]?o[e].color:"#FF0000")||"#FF0000",s=s||"shortDash",!this.yAxis[e||0].plotLines[i||0]&&(this.yAxis[e||0].plotLines[i||0]={}),this.yAxis[e||0].plotLines[i||0].value=""==t?null:t,this.yAxis[e||0].plotLines[i||0].id="plot-line"+e+"_"+i,this.yAxis[e||0].plotLines[i||0].width=2,this.yAxis[e||0].plotLines[i||0].color=n,this.yAxis[e||0].plotLines[i||0].dashStyle=s},n.prototype.updateYMin=function(t,e){this.yAxis[e||0].min=""==t?null:parseInt(t)},n.prototype.updateYMax=function(t,e){this.yAxis[e||0].max=""==t?null:parseInt(t)},n.prototype.updateYInterval=function(t,e){this.yAxis[e||0].interval=""==t?null:parseInt(t)},n.prototype.updateYMajor=function(t,e){this.majorGridLine=t,this.getYAxis()[e||0].gridLineWidth=t?1:0},n.prototype.updateYMinor=function(t,e){this.minorGridLine=t,this.getYAxis()[e||0].minorTickInterval=t?"auto":null},n.prototype.setSeriesIn=function(t){this.seriesIn=t},n.prototype.setFirstRowAsLabel=function(t){this.frl=t},n.prototype.setFirstColumnAsLabel=function(t){this.fcl=t},n.prototype.updateThreshold=function(t){this.threshold=""==t?null:+parseFloat(t)},n.prototype.getChartID=function(){return-1==this.chartId.indexOf("preview")?this.chartId:""},n.prototype.setChartID=function(t){this.chartId=t},n.prototype.updateTheme=function(t,e,i,o){o=o||0;this.getStyleObject(o).colorObject.colorTheme={basecolor:t,name:e,isReversed:i}},n.prototype.updateFilter=function(t,e){this.filter[t]=e,"type"===t&&"NONE"===e&&(this.filter.limit=0,this.filter.limitBy="NONE",this.filter.limitByName="")},n.prototype.resetFilter=function(){this.filter&&(this.filter.limit=0,this.filter.type="NONE",this.filter.limitBy="NONE")},n.prototype.getFilter=function(){!this.filter.type&&(this.filter.type="NONE"),"NONE"!==this.filter.type&&(this.filter.enabled=!0),!this.filter.limit&&(this.filter.limit=0);var t=o.Wrapper.DOMUtils,e="";if("none"!==(null!=t.getElementById("filterColumnWrapper")?t.getElementById("filterColumnWrapper").style.display:"none")){var n=i.zcombo("#filterColumns","getValue");e=n.selector?"NONE":n}else e="NONE";return!this.filter.limitBy&&(this.filter.limitBy=e),this.filter},n.prototype.getFilterType=function(){return this.filter&&this.filter.type},n.prototype.setFilterType=function(t){this.filter.type=t},n.prototype.setFilterLimit=function(t){this.filter.limit=t},n.prototype.isFilterEnabled=function(){return this.filter&&"NONE"!==this.filter.type&&"noFilter"!==this.filter.limitBy},n.prototype.setFilterColumnOnEnabled=function(){if(this.filter&&this.isFilterEnabled()&&("NONE"===this.filter.limitBy||""===this.filter.limitBy))if(this.getAggregationEnabled()&&"COUNT"===this.getAggregationOperation())this.getAggregationEnabled()&&"COUNT"===this.getAggregationOperation()&&this.setFilterColumn("NONE");else{var t=o.DecTable.getRangeDecTableMap(this.getRange()),e=o.DecTable.getLastFilterElement(t);this.setFilterColumn(e)}},n.prototype.setFilterColumn=function(t){this.filter.limitBy=t},n.prototype.getFilterLimit=function(){return this.filter&&this.filter.limit},n.prototype.getFilterColumn=function(){return this.filter&&this.filter.limitBy},n.prototype.getAggregationColHeaders=function(){var t=this.aggregation.colheaders||this.aggregation.rowheaders;return t&&t.split(";")||[]},n.prototype.isAxisInAggregationAvailable=function(){return this.aggregation.noAxis},n.prototype.getAggregationNumericColumns=function(){var t=this.aggregation.numericColumns;return t&&t.split(";")||[]},n.prototype.setAggregationNumericColumns=function(t){this.aggregation&&(this.aggregation.numericColumns=t)},n.prototype.setAggregationGroupByColumns=function(t){this.aggregation&&"COLS"===this.seriesIn&&(this.aggregation.colheaders=t),this.aggregation&&"ROWS"===this.seriesIn&&(this.aggregation.rowheaders=t)},n.prototype.getAggNumCols=function(){return this.aggregation&&this.aggregation.enabled&&this.aggregation.numericColumns},n.prototype.getAggColHeaders=function(){var t=this.aggregation&&(this.aggregation.colheaders||this.aggregation.rowheaders);return t&&t.split(";")||[]},n.prototype.getAggregationHeader=function(t){var e=this.aggregation&&this.aggregation.enabled&&(this.aggregation.colheaders||this.aggregation.rowheaders),i=e&&e.split(";")||[],n=o.DecTable;return i[t]&&n.constructRangeString(i[t])||"Choose"},n.prototype.getNumberColumn=function(t){var e=this.aggregation&&this.aggregation.enabled&&this.aggregation.numericColumns,i=e&&e.split(";")||[],n=o.DecTable;return i[t]&&n.constructRangeString(i[t])||"Choose"},n.prototype.getDepthOperation=function(t){var e=this.aggregation&&this.aggregation.dateOperations,i=[],n=new o.Utility.ChartAgent;return e&&"NONE"!==e&&!n.isArray(e)&&(i=e.split(",")),i[t]&&"NONE"!==i[t]&&i[t].split("-")[1]||"NONE"},n.prototype.isDateOperationIndex=function(t){var e=this.aggregation&&this.aggregation.dateOperations,i=[],n=new o.Utility.ChartAgent;return e&&"NONE"!==e&&!n.isArray(e)&&(i=e.split(",")),i[t]&&"NONE"!==i[t]},n.prototype.getAggregationOperation=function(){return this.aggregation&&this.aggregation.type||"NONE"},n.prototype.getAggregationEnabled=function(){return this.aggregation&&this.aggregation.enabled},n.prototype.getAggregationDateOperations=function(){var t,e=new o.Utility.ChartAgent;return this.aggregation&&this.aggregation.dateOperations&&!e.isArray(this.aggregation.dateOperations)&&(t=this.aggregation.dateOperations.split(",")),t||["NONE","NONE","NONE"]},n.prototype.getAggregation=function(){var t=["NONE","NONE","NONE"],e=new o.Utility.ChartAgent,i=this.aggregation.dateOperations&&!e.isArray(this.aggregation.dateOperations)?this.aggregation.dateOperations.split(","):this.aggregation.dateOperations;for(var n in i)t[n]=i[n];return this.aggregation.dateOperations=t.join(","),this.aggregation},n.prototype.getRaceChartOptions=function(){this.rc},n.prototype.getBinning=function(){return this.binning},n.prototype.getUpdateOptions=function(){var t=this.cloneOf(this.getOptions(),!0);return t=this.updateOptionsByMeta(t)},n.prototype.setRecommendationSelection=function(t){this.isRecommend=t},n.prototype.isRecommendationSelection=function(){return this.isRecommend},n.prototype.getBinningInterval=function(){return this.binning?this.binning.interval:0},n.prototype.getComputedAggregationStatus=function(){var t=this.aggregation.colheaders&&this.aggregation.colheaders.length>0||this.aggregation.rowheaders&&this.aggregation.rowheaders.length>0;return t=t&&"NONE"!==this.aggregation.type},n.prototype.updateAggregation=function(t,e){"ROWS"===this.seriesIn&&"colheaders"===t&&(t="rowheaders"),this.aggregation&&(this.aggregation[t]=e)},n.prototype.setAggregationOperation=function(t){this.aggregation&&(this.aggregation.type=t)},n.prototype.udpateAggregationHeaderMap=function(t){var e=this.aggregationHeaderOperationMap.length;if(t.colheaders||t.dateOperations)for(var i=new o.Utility.ChartAgent,n=t.colheaders.split(","),s=i.isArray(t.dateOperations)?t.dateOperations:t.dateOperations.split(","),r=0;r<n.length;r++){for(var a=n[r],p=!1,l=0;l<e;l++){var h;if(p=(h=this.aggregationHeaderOperationMap[l]).headers===a)break}if(p)(h=this.aggregationHeaderOperationMap[l]).dateOperations=s[r],this.aggregationHeaderOperationMap[l]=h;else(h={}).headers=n[r],h.dateOperations=s[r],this.aggregationHeaderOperationMap.push(h)}},n.prototype.getAggregationHeaderMapDetails=function(t){for(var e=this.aggregationHeaderOperationMap,i=0;i<e.length;i++){var o=e[i];if(o.headers===t)return o.dateOperations}},n.prototype.getAggregationHeaderMapDetailsForAllHeaders=function(t){var e=[],i=this.aggregationHeaderOperationMap;if(!t)return e;for(var o=0;o<t.length;o++)for(var n=t[o],s=0;s<i.length;s++){var r=i[s];r.headers===n&&e.push(r.dateOperations)}return e},n.prototype.updateNumberFormat=function(t){var e=t.nfCode,i=o.Constants.NumberFormat;switch(e){case i.THOUSANDS:case i.BILLIONS:case i.MILLIONS:case i.NONE:case i.DEFAULT:this.setYAxiesNumberFormat(t.yIndex,t.prefix,t.suffix,t.nfCode);break;case i.CUSTOM:this.setYAxiesNumberFormat(t.yIndex,t.prefix||null,t.suffix||null,t.nfCode)}},n.prototype.setYAxiesNumberFormat=function(t,e,i,o){var n=this.yAxis;n[t].prefix=e,n[t].suffix=i,n[t].nfCode=o},o.Model.DialogMeta=n}(this);
!function(t){t.sPlusPlus,t.ZSClass;var e=t.UIUtil.Component,i=t.ZSChart.Constants.ChartType;function s(){}s.prototype=ZSChart.Model.DialogMeta.prototype,s.prototype.constructPropertyFromObject=function(t){this.ds=t.ds||this.ds,this.ts=t.ts||this.ts,this.isGrouping=t.grouping?t.grouping:this.isGrouping,this.dlt=t.dlt||this.dlt,this.type=t.type||this.type,this.chartId=t.co.chart.renderTo||this.chartId,this.isCellExceed=t.isCellExceed||this.isCellExceed,this.associatedSheetId=t.asn,this.sRow=t.sR||this.sRow,this.sCol=t.sC||this.sCol,this.sRowDiff=t.srd||this.sRowDiff,this.sColDiff=t.scd||this.sColDiff,this.top=t.top||this.top,this.left=t.left||this.left,this.trendline=t.tl||this.trendline,this.isPivotChart=t.isPivotChart||!1,this.pivotId=t.pivotId||null,this.trendlineType=t.tlType||this.trendlineType,this.combinedRange=t.cR||this.combinedRange,this.trendlineDegree=t.order||this.trendlineDegree,this.frl=t.frl||this.frl,this.fcl=t.fcl||this.fcl,this.dataRange=t.dataRange||this.dataRange,this.currency=t.currency||this.currency,this.secYAxisSymbol=t.secYAxisSymbol||this.secYAxisSymbol,this.width=t.wd||this.width,this.height=t.ht||this.height,this.rc=t.co.rc,this.seriesIn=t.seriesIn||this.seriesIn,this.chartTitle=function(t){if(t&&t.co)return t.co.cellRef&&t.co.cellRef.titleRange?t.co.cellRef.titleRange:t.co.title.text;return""}(t)||this.chartTitle,this.subTitle=function(t){if(t&&t.co)return t.co.cellRef&&t.co.cellRef.subtitleRange?t.co.cellRef.subtitleRange:t.co.subtitle.text;return""}(t)||this.subTitle,this.lPostion=t.legendPos>=0?t.legendPos:this.lPostion,this.dLables=t.lf&&""!=t.lf?t.lf:this.dLables,this.threshold=function(t){try{return t.co.plotOptions.series.threshold}catch(t){}return null}(t)||this.threshold,this.isSingleYaxis=void 0===t.isSingleYaxis?this.isSingleYaxis:t.isSingleYaxis,this.isIncludeHidden=void 0===t.ihc?this.isIncludeHidden:t.ihc,this.autoExpand=void 0===t.ae?this.autoExpand:t.ae,this.aggregation=t.co.aggregation,this.comboTypes=t.comboChartTypes||this.comboTypes,this.filter=t.co.filter||{},this.lineStyles=t.co.lineStyles||[],this.gradient=t.gradient||this.gradient,this.setExtractOptions(t),this.extractYAxisProperty(),this.extractYAxisCurrentState(),this.extractXAxisProperty(),this.constructStyleProperty(),this.extractYAxiesCount(),this.updateToggleProperty(),this.updateNoOfYAxies(),this.constructTitleJsonForSP(),this.constructStyleJsonForSP(),this.constructAggregationHeaderOperationMap(),this.updateGroupingStates(t),this.extractBinningProperties(t)},s.prototype.getDetails=function(){var t={};return t.ds=this.ds,t.ts=this.ts,t.grouping=this.isGrouping,t.type=this.type,t.sR=this.sRow,t.sC=this.sCol,t.srd=this.sRowDiff,t.scd=this.sColDiff,t.top=this.top,t.left=this.left,t.tl=this.trendline,t.isPivotChart=this.isPivotChart,t.pivotId=this.pivotId,t.tlType=this.trendlineType,t.cR=this.combinedRange,t.order=this.trendlineDegree,t.frl=this.frl,t.fcl=this.fcl,t.dataRange=this.dataRange,t.currency=this.currency,t.secYAxisSymbol=this.secYAxisSymbol,t.wd=this.width,t.ht=this.height,t.seriesIn=this.seriesIn,t.legendPos=this.lPostion,t.lf=this.dLables,t.th=this.threshold,t.isSingleYaxis=this.isSingleYaxis,t.ihc=this.isIncludeHidden,t.ae=this.autoExpand,t.aggregation=this.aggregation,t.filter=this.filter,t.yAxis=this.yAxis,t.lineStyles=this.lineStyles,t},s.prototype.constructPropertyFromDialog=function(){},s.prototype.updateGroupingStates=function(t){this.isGrouping=!!t.grouping&&t.grouping},s.prototype.getGroupingStatus=function(){return this.isGrouping},s.prototype.constructAggregationHeaderOperationMap=function(){var t=this.aggregation.colheaders||this.aggregation.rowheaders,e=this.aggregation.dateOperations;if(t)for(var i=-1!==t.indexOf(";")?t.split(";"):t.split(","),s=e.split(","),n=0;n<i.length;n++){var r={};r.headers=i[n].replace(/'/g,""),r.dateOperations=s[n],this.aggregationHeaderOperationMap.push(r)}},s.prototype.resetAggregationOperationIfNeeded=function(){!this.aggregation.enabled&&(this.aggregation.type="NONE")},s.prototype.extractYAxiesCount=function(){(this.isGropuing||this.isPivotChart)&&(this.noOfYAxies=this.options.series.length)},s.prototype.extractBinningProperties=function(t){this.binning=t.co.binning},s.prototype.updateToggleProperty=function(){var t=this.options;this.isMarker=t.plotOptions.series?void 0===t.plotOptions.series.marker.enabled?this.isMarker:t.plotOptions.series.marker.enabled:this.isMarker,this.animation=t.plotOptions.series?void 0===t.plotOptions.series.animation?this.animation:t.plotOptions.series.animation:this.animation,this.tooltip=void 0===t.tooltip.enabled?this.tooltip:t.tooltip.enabled,this.options.chart.inverted=void 0===t.chart.inverted?this.options.chart.inverted:t.chart.inverted,this.options.chart.type=void 0===t.chart.type?this.options.chart.type:t.chart.type,this.zoom="xy"===t.chart.zoomType},s.prototype.extractXAxisProperty=function(){var t=this.getOptions(),e=this.cloneOf(t.xAxis,!0),i={};(new ZSChart.Utility.ChartAgent).isArray(e)?this.xAxis=e:(this.merge(i,this.xAxis[0]||{},e),this.xAxis=[],this.xAxis.push(i)),this.slant=e&&e.labels?e.labels.rotation:this.slant,this.staggerLines=e&&e.labels?e.labels.staggerLines:this.staggerLines,this.xReverse=e?e.reversed:this.xReverse,t.cellRef&&e.title&&(e.title.text=t.cellRef.xtitleRange||(e.title?e.title.text:""))},s.prototype.extractYAxisProperty=function(){var t=this.getOptions(),e=this.cloneOf(t.yAxis,!0);if(e||e[0]){for(var i in this.majorGridLine=!!e[0].gridLineWidth,this.minorGridLine="auto"===e[0].minorTickInterval,e){var s=e[i];t.cellRef&&t.cellRef["ytitleRange"+i]&&(s.yAxistitle=t.cellRef["ytitleRange"+i]||s.yAxistitle)}this.yAxis=e}},s.prototype.extractYAxisCurrentState=function(){if(this.isSingleYaxis){var t=e.zcombo("#yaxisMulti","getValue"),i="LA"===(t="string"==typeof t?t:"LA")?0:t.substring(t.length-1,t.length),s=e.zcombo("#chartTitleCombo","getValue");-1!==(s="string"==typeof s?s:"LA").indexOf("RA")&&this.setActiveTitleIndex(s.substring(s.length-1,s.length)),this.setActiveYIndex(i)}else this.setActiveYIndex(0),this.setActiveTitleIndex(0)},s.prototype.updateYTitleRange=function(t,e){this.yAxis[e].yAxistitle=t},s.prototype.constructStyleProperty=function(){var t=this.getOptions(),e=(new ZSChart.Utility.ChartAgent).constructStyleProperty(t);this.styleObject.push(e)},s.prototype.getLegendPosition=function(e){return(new t.ZSChart.Utility.CommanAgent).getLegendPosition(e)},s.prototype.getLegendName=function(e){return(new t.ZSChart.Utility.CommanAgent).getLegendName(e)},s.prototype.cloneOf=function(t,e){return(new ZSChart.Utility.ChartAgent).clone(t,e)},s.prototype.merge=function(t,e,i,s){return(new ZSChart.Utility.ChartAgent).merge(t,e,i,s||!1),t},s.prototype.getDataLabelsUpdate=function(){var e=this.cloneOf(this.options,!0),i={lf:this.dLables,type:this.type,isSingleYaxis:this.isSingleYaxis,secYAxisSymbl:this.secYAxisSymbol,currency:this.currency},s=(new t.ZSChart.Utility.CommanAgent).getDataLabelsUpdate(e,i);return s=this.removeExtraProperty(s)},s.prototype.getLegendUpdate=function(){var e=this.cloneOf(this.options,!0),i=new t.ZSChart.Utility.CommanAgent,s={legend:i.getLegendUpdate(this.lPostion,this.chartTitle,this.subTitle)};return i.mergeRecursively(e,s),e.plotOptions[e.chart.type].showInLegend=e.legend.enabled,e},s.prototype.getTrendUpdate=function(){var t,e,i,s=this.getTrendlineTypes(),n=this.getDegreeOrElse(),r=this.cloneOf(this.options,!0),o=(r=this.updateOptionsByMeta(r)).colors,a=r.legend.enabled,h=r.series,l=h.length;if(t=e=parseInt(l/2),h[l-1].hasOwnProperty("isRegressionLine")){for(;t<e;t++)delete h[t];h.length=e}if(-1===s.indexOf("None"))for(var p=0;p<h.length;p++)void 0===(i=h[p].name)&&(i="Series "+(p+1)),h[p].regression=!0,h[p].regressionSettings={regression:!0,type:s.toLowerCase(),color:o[p],order:n,dashStyle:"ShortDot",name:i+" Trendline",period:n,showInLegend:a},h[p].rendered=!1;else for(p=0;p<h.length;p++)delete h[p].regression,delete h[p].regressionSettings;return r},s.prototype.getXLabelUpdate=function(t){this.getXLabel();var e=this.cloneOf(this.xAxis,!0);return e[t||0].tickLength=0,e[t||0].lineWidth=1,e[t||0]},s.prototype.getXSlantUpdate=function(t){var e=this.getXSlant(),i=this.cloneOf(this.xAxis,!0);return i[t||0].labels.rotation="auto"==e?null:parseInt(e),i[t||0]},s.prototype.getXStaggerUpdate=function(t){var e=this.getStaggerState(),i=this.cloneOf(this.xAxis,!0);return i[t||0].labels.staggerLines=1===e?null:e,i[t||0]},s.prototype.getYPlotlineUpdate=function(t,e){return this.getYAxis()[t||0].plotLines[e||0]},s.prototype.removeYPlotline=function(t,e){var i=this.getYAxis()[t||0].plotLines,s=i[e]?i[e].id:"";return i[e]&&delete i[e],s},s.prototype.removeAllPlotLine=function(t){this.getYAxis()[t].plotLines=[]},s.prototype.getThresholdUpdate=function(){var t=this.cloneOf(this.options,!0);return this.threshold?(t.plotOptions.series.threshold=this.threshold,t.plotOptions.series.negativeColor="#FF0000"):(delete t.plotOptions.series.threshold,delete t.plotOptions.series.negativeColor),t},s.prototype.getThemeUpdate=function(e,i,s){var n=this.getOptions();return n=this.updateOptionsByMeta(n),(n=(new t.ZSChart.Utility.ChartAgent).getColorSchemenColors(n,e,i,s)).colorOptions=this.getStyleObject().colorObject,n},s.prototype.updateOptionsByMeta=function(t){var e=new ZSChart.Utility.ChartAgent;return t.title.text=this.chartTitle,t.subtitle.text=this.subTitle,t=this.removeExtraProperty(t),e.merge({},t,this.getLegendUpdate(),!0),e.merge({},t,this.getDataLabelsUpdate(),!0),t.chart.renderTo=this.chartId,t},s.prototype.removeExtraProperty=function(t){return delete t.chart.spacingBottom,delete t.chart.spacingTop,delete t.chart.spacingLeft,delete t.chart.spacingRight,t},s.prototype.updateScaleFactor=function(t,e){this.yAxis[e].scaleFactor=t},s.prototype.updateConversionType=function(t,e){this.yAxis[e].conversionType=t},s.prototype.updateUnitFactor=function(t,e){this.yAxis[e].unitFactor=t},s.prototype.getScaleFactor=function(t){return this.yAxis[t||0].scaleFactor},s.prototype.getConversionType=function(t){return this.yAxis[t||0].conversionType},s.prototype.getUnitFactor=function(t){return this.yAxis[t||0].unitFactor},s.prototype.updateBinning=function(t){this.binning=t},s.prototype.reGeneratedYxiesLabels=function(){return(new ZSChart.Utility.ChartAgent).getFormatLabels(this.yAxis,this.currency,this.type)},s.prototype.updateSeriesCustomization=function(t){var e=new ZSChart.Utility.ChartAgent,i=this.getCustomStyle();e.updateSeriesColor(i,{cValue:t.color,mType:t.mCType,cType:t.cType,pIndex:t.pIndex,sIndex:t.sIndex,isSeries:t.isSeries})},s.prototype.updateTrendlineStyle=function(t){var e=t.sIndex,i=this.getOptions();i.series&&(i.series[e-i.series.length].regressionSettings.dashStyle=t.dashStyle);var s=this.lineStyles,n=function(){for(var e=s.length,i=0;i<e;i++)if(s[i].seriesIndex&&s[i].seriesIndex==t.sIndex)return i;return-1}();-1==n?this.lineStyles.push({seriesIndex:t.sIndex,lineStyleType:t.dashStyle}):this.lineStyles[n]={seriesIndex:t.sIndex,lineStyleType:t.dashStyle}},s.prototype.addDefaultIntelligence=function(){var t=this.type,e=this.getOptions().series.length,s=new ZSChart.Utility.CommanAgent;s.isFallUnderCompositionType(t)?this.lPostion=1:e>1&&(this.lPostion=1),s.isFallUnderCompositionType(t)&&t!=i.FUNNEL&&(this.dLables="P")},ZSChart.Utility.getSeriesLengthFromRange=function(t,e){var i=t.getRange();if(!i||""===i)return 0;var s=t.getFirstRowAsLabel(),n=t.getFirstColAsLabel(),r=t.getSeriesIn();i=i.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";");var o=ZSChart.DecTable.getDataRanges(i),a=0,h=0,l=0;if(e&&t.isFilterEnabled())return 0;if(e&&t.getAggregationEnabled()){var p=ZSChart.DecTable.getDecTableInstance(i);if(!p)return 0;for(var g=0,c=p.getDepthIndices(),d=0;d<c.length;d++)for(var y=c[d],u=0;u<y.length;u++){var f=y[u];"NUMBER"!==f.type&&"DECIMAL"!==f.type&&"CURRENCY"!==f.type&&"PERCENTAGE"!==f.type&&"EMPTY"!==f.type||g++}l=g+t.getAggColHeaders().length}else if("COLS"==r){for(d=0;d<o.length;d++){a+=(x=o[d]).range.endCol-x.range.startCol+1}l=n?a-1:a}else{for(d=0;d<o.length;d++){var x;h+=(x=o[d]).range.endRow-x.range.startRow+1}l=s?h-1:h}return l}}(this);
!function(t){t.sPlusPlus,t.ZSClass,t.JSUtill,t.UserAction,t.ZSConstants.I18N,t.UIUtil.Component;var e=t.ZSEvents,s=(e.Groups,e.Names,e.topic,t.ZSChart);s.Constants.ServiceProvider,s.Constants.ChartType,s.Constants.ColorSchemeType,s.Constants.ChartRangePickerType,t.ZSDevTools.Logger;function o(){s.Model.Dialog.call(this)}o.prototype=new s.Model.Dialog,o.prototype.processResponse=function(t){this.setSidePanelState(!0),this.setResposne(t),this.doPreprocess(),this.doPostProcess(),this.clearResposne()},o.prototype.getRangeAry=function(t,e,s){var o=[];return o=t.split(";"),"COLS"==e&&"VERTICAL"==s||"ROWS"==e&&"HORIZONTAL"==s?o[0]:t},o.prototype.insertChart=function(){this.createRequest("CHART_NEW")},o.prototype.checkIfFirstInstanceIsValid=function(t){return!t.reason},s.Model.SPMeta=o}(this);
!function(e){var t=e.ZSChart,i=(e.sPlusPlus,e.ZSEvents),a=i.topic,n=i.Groups,s=i.Names,o=e.document,l=null,r=null,d=!1,h=null,c=e.UIUtil.Component;function g(){this.addRangeClicked=!1,this.Id=-1,this.alive={}}function p(e){this.removeRangeDOM(e)}g.prototype={set range(e){this.populateRanges(e)},get range(){return this.getPopulatedRanges()}},g.prototype.showRangeDomForSP=function(){var e=t.Wrapper.DOMUtils;e.showById("rangeSelectorDiv"),e.showByClassName("spDisabled");var i=Object.keys(this.alive),a=this.alive[i[i.length-1]];a.focus(),a.setSelectionRange(a.value.length,a.value.length),this.addRangeClicked=!1},g.prototype.hideRangeDomForSP=function(){var e=t.Wrapper.DOMUtils;e.getElementById("rangeWrapper").innerHTML="",e.hideById("rangeSelectorDiv"),e.hideByClassName("spDisabled")},g.prototype.constructRangeDialog=function(){d=!0;var t={width:365,title:"Select Data Ranges",height:"auto",close:function(){this.closeZSCRDialog()}.bind(this)};return this.initCRDialog(),new e.ZSClass.Dialog(r,t)},g.prototype.incr=function(){this.Id++},g.prototype.addListner=function(){d=!1,(h=t.Wrapper.DOMUtils).addEvent("chMlAdd","click",function(){this.createRangeElement()}.bind(this)),h.addEvent("updateRange","click",this.updateRange.bind(this)),h.addEvent("cancelRange","click",this.cancelDialog.bind(this))},g.prototype.addListnerForSP=function(){d=!1,(h=t.Wrapper.DOMUtils).addEventByNode(h.getElementByClassName("chMlAdd"),"click",function(){this.createRangeElement();var e=Object.keys(this.alive),t=e[e.length-1];this.alive[t].focus()}.bind(this)),h.addEvent("updateRange","click",this.updateRangeForSP.bind(this)),h.addEvent("cancelRange","click",this.cancelDialogForSp.bind(this))},g.prototype.openZSCRDialog=function(){this.hideDialog(),l.open()},g.prototype.closeZSCRDialog=function(){h.getElementById("rangeWrapper").innerHTML=""},g.prototype.populateRanges=function(e){!l&&(l=this.constructRangeDialog()),this.getIsSidePanel()?d&&this.addListnerForSP():d&&this.addListner();var t=e?e.split(";"):[];t.forEach(function(e){""!=e&&this.createRangeElement(e)}.bind(this)),(this.addRangeClicked||0==t.length)&&this.createRangeElement();var i=h.getElementById("rangeWrapper"),a=this;c.sortable(i,{axis:"y",update:function(e,t){var i=t.item[0],n=t.item.index(),s=i.lastElementChild,o=s.dataset.index,l=a.alive[o];a.alive[o]=a.alive[n],a.alive[n]=l,s.setAttribute("data-index",n)}})},g.prototype.clearRangeCatch=function(){this.Id=-1,this.alive={},this.isRangeEditing()||(a.publish(n.UI,s.SidePanel.CHARTS.SETFOCUS),this.disableRangeEditor())},g.prototype.createRangeElement=function(t){var i=Object.keys(this.alive),a="";if(i.length>0&&(a=this.alive[i[i.length-1]]),!(i.length>0&&""==a.value)){this.incr();var n=e.UserAction.getTemplate(["CHART_MULTI_RANGE_TEMPLATE"]).CHART_MULTI_RANGE_TEMPLATE.cloneNode(!0);if(n.hasChildNodes())for(var s=n.children,o=0;o<s.length;o++){var l=s[o].children;if(l[1]){var r=l[1].querySelector("#chRangeSelector");this.alive[this.Id]=new ZSClass.Editors.RangeEditor(r),ZSClass.RangePicker.register(this.alive[this.Id],!0),this.alive[this.Id].customPreventDefault=this.customPreventDefault.bind(this,this.Id),t&&(this.alive[this.Id].value=t),this.alive[this.Id].addListeners({mousedown:function(e){e.stopPropagation()}}),l[1].setAttribute("data-idx",this.Id)}l[2].setAttribute("data-index",this.Id),l[2].addEventListener("click",p.bind(this))}h.getElementById("rangeWrapper").appendChild(n)}},g.prototype.updateRange=function(){l.close(),this.recallDialog()},g.prototype.updateRangeForSP=function(){this.hideRangeDomForSP(),this.disableRangeEditor(),this.updateDataRangeForSP()},g.prototype.cancelDialog=function(){l.close(),this.recallDialog()},g.prototype.cancelDialogForSp=function(){this.disableRangeEditor(),this.clearRangeCatch(),this.hideRangeDomForSP()},g.prototype.removeRangeDOM=function(e){var t=h.getElementById("rangeWrapper"),i=e.target.dataset;delete this.alive[i.index],t.removeChild(e.target.parentElement)},g.prototype.initCRDialog=function(){var t=e.UserAction.getTemplate(["CHART_RANGE_SELECTOR_TEMPLATE"]);(r=o.createElement("div")).id="DI_CHART_RANGE_DIALOG",r.appendChild(t.CHART_RANGE_SELECTOR_TEMPLATE)},g.prototype.getPopulatedRanges=function(){var e="";return Object.keys(this.alive).forEach(function(t){var i=this.alive[t];e+=""!=i.value?i.value.trim()+";":""}.bind(this)),e},g.prototype.customPreventDefault=function(e,t){if(13==(t.keyCode||t.which))return this.updateRangeForSP(),!0},t.Manager.ZSCRManger=g}(this);
!function(e){var t=e.ZSChart,a=e.ZSClass,n=e.ZSEvents,r=n.Groups,l=n.Names,o=n.topic,g=(t.Model,e.sPlusPlus),c=null,d=(e.ZSConstants.FeatureConstants,e.document),s=e.ZSConstants.I18N,h=(e.ZSConstants.wCC,e.UIUtil.Component),u=null,C=null,v=null,A=!0,p=null,S=t.Constants.ChartRangePickerType,I=(t.Constants.ChartClasses,a.Editors.Utility),E=t.Constants.ChartNames,f=t.Constants.ChartType,T=e.JSUtil,y=!1,m=t.Constants.defaultColor,M=!1,P=e.JSUtil.REGEXP,D=(P.rangeRegex,t.Constants.TitleConstants);function U(){t.Manager.ZSCRManger.call(this)}function b(e){t.Wrapper.DOMUtils.addEventByNode(e,"click",function(){B(this.previousElementSibling.id)})}function R(){try{var e=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),a=e.getOptions(),n=parseInt(h.zcombo("#chartSeries","getValue")),i=e.getOptions().series,r=t.Utility.isCompositionChart(t.Utility.getChartMetaByIndex(a,e.getType(),n)),l=e.getColors(),o=a.colorOptions.seriesColors,g=a.series,c=(i=(s=n,u={},o.forEach(function(e){e.sIndex==s&&(u=e)}),u),null);c=r?i.color||l[n%l.length]:i.color||l[(g[n]?n:n-g.length)%l.length];var d=(new t.Model.ChartModel).getTransparency(c);if(h.zslider("#seriesCaTransparency","setValue",d),h.zcolorselectbox("#chartcustomcolorDropDown11","setValue",c),g[n]||r)t.Wrapper.DOMUtils.hideById("trendLineLineStyle");else t.Wrapper.DOMUtils.addStyle("trendLineLineStyle",{display:""})}catch(e){}var s,u}function O(){t.Wrapper.DOMUtils.getElementById("scaleCustomValue").value=""}function L(){t.Wrapper.DOMUtils.addStyle("scaleCustomWrapper",{display:"none"})}function w(e,t){return t?{COL:"COL3D",BAR:"BAR3D",PIE:"PIE3D",DOUGHNUT:"DOUGHNUT3D",STACKEDCOL:"STACKEDCOL3D",STACKEDCOL_PERCENT:"STACKEDCOL3D_PERCENT",STACKEDBAR:"STACKEDBAR3D",STACKEDBAR_PERCENT:"STACKEDBAR3D_PERCENT"}[e]:{COL3D:"COL",BAR3D:"BAR",PIE3D:"PIE",DOUGHNUT3D:"DOUGHNUT",STACKEDCOL3D:"STACKEDCOL",STACKEDCOL3D_PERCENT:"STACKEDCOL_PERCENT",STACKEDBAR3D:"STACKEDBAR",STACKEDBAR3D_PERCENT:"STACKEDBAR_PERCENT"}[e]}function x(e){u.updateTitleText(e)}function N(){var e,a=this.id;if(u.getPreviousChartType()!=a){e=u.isPreviewOn();var n=new t.Utility.ChartAgent;u.dialogMeta[n.getActiveChartIDForSP()].setType(a),e&&u.createRequest("CHART_PREVIEW"),e&&u.setRecommedationSelection()}}function B(e){var n=t.Manager.SidePanelManager.getActiveMeta();if(n){var i=t.Wrapper.DOMUtils,r=new t.Utility.CommanAgent,l=e;if(n.setType(l),r.checkIfDataApplicableForChartType(n,!0)){var o=g.view.getActiveGridID(),c=g.view.getVersionID(o),d=g.view.getResourceID(o),h=g.data.getWorkBook(d,c),u=g.view.getSheetID(o),C=h.getSheetObj(u).Charts,v=t.Utility.getActiveChart(),A=new t.Utility.ChartAgent,p=new t.Controller.ZSCController,S=[];Object.keys(v).forEach(function(e){var t=v[e],a=C.get(t);if(a){var n=a.getDetails();n.type,a&&A.isUniqueValue(n.type,l)&&S.push(a)}});p=new t.Controller.ZSCController,UserAction.getTemplate(["COL_ICON","STACKEDCOL_ICON","STACKEDCOL_PERCENT_ICON","BAR_ICON","STACKEDBAR_ICON","STACKEDBAR_PERCENT_ICON","XYLINE_ICON","SPLINE_ICON","STEPCHART_ICON","PIE_ICON","DOUGHNUT_ICON","SEMIDOUGHNUT_ICON","XYAREA_ICON","XYSTACKEDAREA_ICON","SCATTER_ICON","XYLINE_SCATTER_ICON","BUBBLE_ICON","TIMELINE_ICON","TIMEAREA_ICON","CANDLESTICK_ICON","OHLCCHART_ICON","POLAR_ICON","SPIDERWEB_ICON","BULLETCOL_ICON","BULLETBAR_ICON","COMBOCHART_ICON","WATERFALL_ICON","FUNNEL_ICON","PARETO_ICON","HISTOGRAM_ICON","ANIMATION_CHART_ICON","WORDCLOUD_ICON"])[l+"_ICON"];var I="BUBBLE"===l?"BUBBLECHART":l;i.hideById("chartTypeMenuWrapper"),n.getType()==f.COMBOCHART&&i.addStyle("chartTypeMenuWrapper",{display:""}),p.changeChartType(d,u,c,S,I),i.getElementById("chartTypeSpan").innerText=E[l]}else a.ZSAlert(s["Chart.Not.Allowed"],{title:s["Alert.Title.InvalidSourceRange"]})}}function F(){(new t.Manager.ZSCColorManager).hideColorScheme(),J(this),$(this)}function _(){(new t.Manager.ZSCColorManager).hideColorScheme();var e=c.getIndex(this);-1!=e&&ee(e)}function k(e){var t=(e=e.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";")).split(";"),a=g.view.getActiveGridID(),n=g.view.getResourceID(a),i=g.view.getVersionID(a),r=!1;for(var l in t)try{if(""!==t[l]&&(t.length>1?(0==l&&(r=ge(n,i,t[l],!0)),l>0&&(r=ge(n,i,t[l],!1))):0==l&&(r=ge(n,i,t[l],!0)),!r))return r}catch(e){return!1}return r}function H(){var e=new t.Utility.CommanAgent,n=new t.Utility.ChartAgent,i=e.getRangeState(S.DATA_RANGE),r=e.getRangePicker(S.DATA_RANGE);if(i){var l=r.value;l=l.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";");var o=t.Manager.SidePanelManager;if(l=l.lastIndexOf(";")===l.length-1?l.slice(0,l.length-1):l,u.getSidePanelState()){var c=o.getActiveMeta(),d=c.getAssociatedSheetId();(function(e,t){return e===t})(d,c.getActiveSheet())?(u.updateDataRangeForSP(o.getActiveChartID(),l),o.disableRangeEditor()):function(e,a,n,i){var r=g.view.getActiveGridID(),l=g.view.getResourceID(r),o=g.view.getSheetID(r),c=g.view.getVersionID(r),d=e,s=t.Manager.SidePanelManager;UserAction.SwitchSheet(l,o,c,d,void 0,void 0,u.updateDataRangeForSP.bind(u),[a,n,i]),s.disableRangeEditor()}(d,o.getActiveChartID()[0],l,c)}else u.updateDataRange(n.getActiveChartIDForSP(),l)}else a.ZSAlert(s.InvalidRange,{title:s["Alert.Title.InvalidSourceRange"]})}function Y(e){(new t.Utility.CommanAgent).setRangeState(S.DATA_RANGE,e)}function V(e){var t,a=(e=e.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";")).trim().split(";");t=a.length>1,c.hideById("combinedRangesWrapper"),t&&c.addStyle("combinedRangesWrapper",{display:"table-row"})}function z(e){I.addValidator(e,function(){return k(e.value)},function(){V(e.value),Y(!0),e.Editor.style.border=""},function(){Y(!1),e.Editor.style.border="1px solid red"},100)}function G(e){if(e&&""!=e){var t=parseFloat(e);return!isNaN(t)}return""==e}function Z(e){if(e&&""!=e&&"."!=e){var t=parseFloat(e);return isNaN(t)?0:1}return""==e?2:"."==e?-1:0}function W(){var e=s.InvalidRange;a.ZSAlert(e,{title:s["Alert.Title.InvalidSourceRange"]})}function j(){var e;(e=new a.Editors.RangeEditor(c.getElementById("yAxisTitle"),!0,!0)).customPreventDefault=re.bind(e),a.RangePicker.register(e,!0,!0),p.addRangePicker(S.CHART_Y_AXIES,e),I.addValidator(e,function(){return k(e.value)},function(){u.updateTitleByRange(S.CHART_Y_AXIES,e.value)},function(){var a=new t.Utility.ChartAgent;u.updateYTitle(a.getActiveChartIDForSP(),e.value)}),c.addEvent("yAxisLabel","change",function(){var e=new t.Utility.ChartAgent;u.updateYLabel(e.getActiveChartIDForSP(),c.getElementById("yAxisLabel").checked)}),c.addEvent("PlotlineValue0","keyup",function(){var e=new t.Utility.ChartAgent;u.updateYPlotline(e.getActiveChartIDForSP(),c.getElementById("PlotlineValue0").value,u.getActiveYAxisIndex("preview"),0)}),c.addEvent("min","change",function(){var e=new t.Utility.ChartAgent;u.updateYMin(e.getActiveChartIDForSP(),c.getElementById("min").value,u.getActiveYAxisIndex("preview"))}),c.addEvent("max","change",function(){var e=new t.Utility.ChartAgent;u.updateYMax(e.getActiveChartIDForSP(),c.getElementById("max").value,u.getActiveYAxisIndex("preview"))}),c.addEvent("interval","change",function(){var e=new t.Utility.ChartAgent;u.updateYInterval(e.getActiveChartIDForSP(),c.getElementById("interval").value,u.getActiveYAxisIndex("preview"))}),c.addEvent("majorGridLines","change",function(){var e=new t.Utility.ChartAgent;u.updateYMajorGrid(e.getActiveChartIDForSP(),c.getElementById("majorGridLines").checked,u.getActiveYAxisIndex("preview"))}),c.addEvent("minorGridLines","change",function(){u.updateYMinorGrid(chartAgent.getActiveChartIDForSP(),c.getElementById("minorGridLines").checked,u.getActiveYAxisIndex("preview"))}),c.addEvent("multiyaxisYes","change",function(){var e=new t.Utility.ChartAgent;c.showById("addPlotLine"),u.updateMultiYAxies(e.getActiveChartIDForSP(),c.getElementById("multiyaxisYes").checked)}),h.bind("#yaxisMulti","change",function(e,a){var n=new t.Utility.ChartAgent;delete a.combo,u.updateMultiYAxiesDom(n.getActiveChartIDForSP(),a)}),c.addEvent("addPlotLine","click",function(){var e=new t.Utility.ChartAgent;u.addPlotLine(e.getActiveChartIDForSP())})}function X(){var e=t.Manager.SidePanelManager.getActiveChartID();u.updateTitleIndex(e,h.zcombo("#chartTitleCombo","getValue")),u.updateTitleForSp(e,h.zcombo("#chartTitleCombo","getValue")),t.Wrapper.DOMUtils.getElementById("titleTextBox").focus()}function q(e){return e.substring(e.indexOf("(")+1,e.indexOf(")")).split(",")}function K(){c.addEvent("chartThemePallate","click",function(e){(new t.Manager.ZSCColorManager).showColorScheme(this)})}function $(e,t){t=t||c.getIndex(e);for(var a=c.getElementsByClassName("chartTypeHolder"),n=a.length,i=0;i<n;i++)c.hide(a[i]);return c.show(a[t]),!0}function J(e,t){for(var a=c.getElementByClassName("chrtTypeTab").children,n=(t=t||c.getIndex(e),a.length),i=0;i<n;i++)i!=t?c.removeClass(a[i],"active"):c.addClass(a[i],"active");return!0}function Q(e){switch(e){case"chartOption":case"chartAxis":break;case"chartGeneral":u.checkToPerformUnProcessedTask();break;case"chartType":!function(e){var t=u.getActiveMeta(),a=e||t.getType();a=-1!==a.indexOf("BUBBLE")?"BUBBLE":a,c.getElementById(a).checked=!0;var n=c.getElementById(a);-1!==a.indexOf("3D")&&J(void 0,1)&&$(void 0,1),n&&(c.getElementByClassName("chartTypeHolder").scrollTop=n.parentElement.offsetTop-34)}()}}function ee(e){var t=function(e){var t=["chartGeneral","chartType","chartOption","chartAxis","Advanced"];for(i=0;i<t.length;i++)e!==i&&c.hideById(t[i]);var a=c.getElementByClassName("chrtTabList").children,n=a.length;for(i=0;i<n;i++)e!==i&&c.removeClass(a[i],"active");return t[e]}(e);c.showById(t),c.addClass(c.getElementByClassName("chrtTabList").children[e],"active"),u.updateCurrentTabName(),Q(t)}U.prototype=new t.Manager.ZSCRManger,U.prototype.setType=function(e){u||(u=new t.Model.Dialog).init(),u.setState(e)},U.prototype.getDialogUtil=function(){return u},U.prototype.setIsSidePanel=function(e){var a=new t.Utility.CommanAgent;u||(u=new t.Model.Dialog).init(),u.setSidePanelState(e),a.setDialogUtil(u)},U.prototype.getChartType=function(e){return u.dialogMeta[e].getType()},U.prototype.getActiveChartThemeName=function(e){return u.dialogMeta[e].getActiveChartThemeName()},U.prototype.replaceMeta=function(e,t){u.addMetaObject(e,t)},U.prototype.getMetaObject=function(e){return u.getMetaObject(e)},U.prototype.updateSidePanel=function(e){var a=u.dialogMeta[e];u.setState("edit"),(new t.Utility.AgentDom).updateSidePanel(a)},U.prototype.hideUnwantedProperty=function(e,t){u.hideUnwantedProperty(e,t)},U.prototype.checkForRecommendationsPopulated=function(e){u.setUnProcessed(e),u.checkToPerformUnProcessedTask()},U.prototype.getIsSidePanel=function(){return u.getSidePanelState()},U.prototype.Open=function(){var e=new t.Utility.CommanAgent;(new t.Utility.ChartAgent).isLockedSheet()?a.ZSAlert(s["ProtectRange.UI.SheetLocked"],{title:s["Alert.Title.SheetLocked"]}):(e.setDialogStatus(!0),!C&&(C=this.constructDialogObject()),e.setDialogUtil(u),C.open())},U.prototype.clearSidePanelCached=function(){this.removeActiveChartID(),u&&u.clearCatch()},U.prototype.constructDialogObject=function(){u||(u=new t.Model.Dialog).init(),A=!0;var a={width:1020,title:u.getDialogTitle(),close:function(){this.closeDailogHandler()}.bind(this),open:function(){this.openDialogHandler()}.bind(this)};return this.initDialog(),new e.ZSClass.Dialog(v,a)},U.prototype.getActiveRange=function(){var e=g.view.getActiveGridID(),t=(g.view.getResourceID(e),g.view.getVersionID(e),g.view.getSheetID(e));return g.view.getSheetState(e,t).getActiveRange()},U.prototype.doDialogSpecificAttachEvents=function(){for(var e=c.getElementByClassName("chrtTabList"),n=(r=e.children).length,i=0;i<n;i++)c.addEventByNode(r[i],"click",_);for(n=(r=(e=c.getElementByClassName("chrtTypeTab")).children).length,i=0;i<n;i++)c.addEventByNode(r[i],"click",F);var r;(r=c.getElementsByClassName("flt_right mt20")[0].children)[0]&&c.addEventByNode(r[0],"click",function(){var e;e=-1===u.getState().indexOf("Edit")?"CHART_NEW":"CHART_EDIT",(new t.Utility.CommanAgent).getRangeState(S.DATA_RANGE)?(u.createRequest(e),u&&u.clearCatch(),C.close()):a.ZSAlert(s.InvalidRange,{title:s["Alert.Title.InvalidSourceRange"]})}),r[1]&&c.addEventByNode(r[1],"click",function(){u&&u.clearCatch(),C.close()}),c.addEvent("previewAn","click",function(e){var t;t=!u.isPreviewOn(),u.setPreviewStatus(t),function(e){var t=C.getDialog();if(t.style.transition="300ms linear",e){if(window.innerWidth<=parseInt(t.offsetLeft)+parseInt(t.offsetWidth)+500){var a="-="+(parseInt(t.offsetLeft)+parseInt(t.offsetWidth)+520-window.innerWidth);t.style.left=a+"px"}t.style.width="1020px",setTimeout(function(){u.createRequest("CHART_PREVIEW"),u.setRecommedationSelection()},100)}else c.hideById("preview"),t.style.width="520px"}(t)})},U.prototype.attachEventsForSP=function(){c=t.Wrapper.DOMUtils,p=new t.Utility.CommanAgent;var e=new a.Editors.RangeEditor(c.getElementById("chrtEditor"));e.customPreventDefault=re.bind(e),a.RangePicker.register(e),p.addRangePicker(S.DATA_RANGE,e);for(var i=c.getElementByClassName("spChrtTypesList").querySelectorAll("label"),l=i.length,d=0;d<l;d++)b(i[d]);var C,v,A=c.getElementByClassName("pivotSpChrtTypesList").querySelectorAll("label"),I=A.length;for(d=0;d<I;d++)b(A[d]);C=c.getElementById("chartNumColsCombo0"),(v={width:"100%"}).placeholder=s["Chart.Aggregation.placeholder"],v.templateSelection=t.Aggregation.renderNumericColumn,h.select2(C,v,"init");var E=c.getElementById("addNewRanges"),f=c.getElementById("chrtEditor");c.addEventByNode(E,"click",this.showRangeDialog.bind(this,!0)),c.addEventByNode(f,"click",this.showRangeDialog.bind(this,!1)),z(e),function(){new t.Utility.ChartAgent;c.addEvent("rowChart","change",function(){var e=t.Manager.SidePanelManager;u.updateSeriesInForSP(e.getActiveChartID(),c.getElementById("rowChart").checked,c.getElementById("columnChart").checked)}),c.addEvent("columnChart","change",function(){var e=t.Manager.SidePanelManager;u.updateSeriesInForSP(e.getActiveChartID(),c.getElementById("rowChart").checked,c.getElementById("columnChart").checked)})}(),function(){new t.Utility.ChartAgent;c.addEvent("horizontally","change",function(){var e=t.Manager.SidePanelManager,a=e.getActiveChartID(),n=e.getActiveMeta(),i=new t.Utility.ChartAgent;if(n){var r=c.getElementById("horizontally").checked,l=(c.getElementById("vertically").checked,r?"HORIZONTAL":"VERTICAL");i.isUniqueValue(l,n.getCombinedWay())&&u.updateCombinedRange(a,l)}}),c.addEvent("vertically","change",function(){var e=t.Manager.SidePanelManager,a=e.getActiveChartID(),n=e.getActiveMeta(),i=new t.Utility.ChartAgent;if(n){var r=c.getElementById("horizontally").checked,l=(c.getElementById("vertically").checked,r?"HORIZONTAL":"VERTICAL");i.isUniqueValue(l,n.getCombinedWay())&&u.updateCombinedRange(a,l)}})}(),function(){new t.Utility.ChartAgent;c.addEvent("firstRow","change",function(){var e=t.Manager.SidePanelManager;u.updateFirstRowAsLabelForSP(e.getActiveChartID(),c.getElementById("firstRow").checked)}),c.addEvent("firstColumn","change",function(){var e=t.Manager.SidePanelManager;u.updateFirstColumnAsLabelForSP(e.getActiveChartID(),c.getElementById("firstColumn").checked)})}(),function(){var e=t.Wrapper.DOMUtils;h.bind("#dataLabels","zselectboxchange",function(e,a){if(a.fromUI){var n=a.value,i=new t.Utility.ChartAgent,r=i.getChartMapFromSheet();if(!(r.length<4)){var l=r[3],o=i.getSPActiveChartID(),g=new t.Controller.ZSCController,c=[];Object.keys(o).forEach(function(e){var t=o[e],a=l.get(t),r=a.getDetails();a&&i.isUniqueValue(n,r.lf)&&c.push(a)}),g.updateDataLabel(r[0],r[1],r[2],c,n)}}}),h.bind("#legendPos","zselectboxchange",function(e,a){if(a.fromUI){var n=a.value,i=new t.Utility.ChartAgent,r=i.getChartMapFromSheet();if(!(r.length<4)){var l=r[3],o=i.getSPActiveChartID(),g=new t.Controller.ZSCController,c=[];e.target.position,Object.keys(o).forEach(function(e){var a=o[e],i=l.get(a);i.getDetails(),0==(n=i.getLegendPositionByName(n))&&t.Client.Action.destroyContextualToolbar(),i&&c.push(i)}),g.updateLegend(r[0],r[1],r[2],c,n)}}}),h.bind("#legendFont","zselectboxchange",function(e,a){if(a.fromUI){var n=a.value,i=new t.Utility.ChartAgent,r=i.getChartMapFromSheet();if(!(r.length<4)){var l=r[3],o=i.getSPActiveChartID(),g=new t.Controller.ZSCController,c=[],d={};Object.keys(o).forEach(function(e){var t=o[e],a=l.get(t),r=a.getOptions();d=a.getUpdateLegendStyle({fontSize:n});var g=a&&i.isUniqueValue(n,r.legend.itemStyle.fontSize);g&&a.updateLegendStyle(d),g&&c.push(a)}),g.updateLegendStyle(r[0],r[1],r[2],c[0],d)}}}),h.bind("#chartBold","click",function(e,a){var n=t.Wrapper.DOMUtils,i=n.getElementById("chartBold"),r=n.toggleActive(i),l=""!==r,o=new t.Utility.ChartAgent,g=o.getChartMapFromSheet();if(!(g.length<4)){var c=g[3],d=o.getSPActiveChartID(),s=new t.Controller.ZSCController,h=[],u={};Object.keys(d).forEach(function(e){var t=d[e],a=c.get(t),n=(a.getOptions(),l?"bold":"normal");u=a.getUpdateLegendStyle({fontWeight:n}),a&&a.updateLegendStyle(u),a&&h.push(a)}),s.updateLegendStyle(g[0],g[1],g[2],h[0],u)}}),h.bind("#chartitalic","click",function(e,a){var n=t.Wrapper.DOMUtils,i=n.getElementById("chartitalic"),r=n.toggleActive(i),l=""!==r,o=new t.Utility.ChartAgent,g=o.getChartMapFromSheet();if(!(g.length<4)){var c=g[3],d=o.getSPActiveChartID(),s=new t.Controller.ZSCController,h=[],u={};Object.keys(d).forEach(function(e){var t=d[e],a=c.get(t),n=(a.getOptions(),l?"italic":"normal");u=a.getUpdateLegendStyle({fontStyle:n}),a&&a.updateLegendStyle(u),a&&h.push(a)}),s.updateLegendStyle(g[0],g[1],g[2],h[0],u)}}),h.bind("#chartFontColor2","zcolorselectchange",function(e,a){if(a.fromUI){t.Wrapper.DOMUtils;var n=a.color,i=new t.Utility.ChartAgent,r=i.getChartMapFromSheet();if(!(r.length<4)){var l=r[3],o=i.getSPActiveChartID(),g=new t.Controller.ZSCController,c=[],d={},s="";Object.keys(o).forEach(function(e){var t=o[e],a=l.get(t),i=a.getOptions();s=i.legend.itemStyle.color,d=a.getUpdateLegendStyle({color:n}),a&&a.updateLegendStyle(d),a&&c.push(a)});var h=i.isUniqueValue(s,n);h&&g.updateLegendStyle(r[0],r[1],r[2],c[0],d)}}}),e.addEvent("trendLineToggle",e.Events.CLICK,function(){var e=this.checked,a=e?"Linear":"None",n=new t.Utility.ChartAgent,i=n.getChartMapFromSheet();if(!(i.length<4)){var r=t.Manager.SidePanelManager,l=i[3],o=n.getSPActiveChartID(),g=new t.Controller.ZSCController,c=[],d=r.getActiveMeta();d.setTrendline(e),Object.keys(o).forEach(function(e){var t=o[e],i=l.get(t),r=i.getDetails(),g=i&&n.isUniqueValue(a.toLowerCase(),r.tlType);g&&i.updateTrendtype({value:a}),g&&c.push(i)}),g.updateTrendlineType(i[0],i[1],i[2],c,a.toLowerCase())}}),e.addEvent("sortingToggle",e.Events.CLICK,function(){var e=this.checked,a=new t.Utility.ChartAgent,n=a.getChartMapFromSheet();if(!(n.length<4)){var i=t.Manager.SidePanelManager,r=n[3],l=a.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],c=i.getActiveMeta();c.updateSorting(e),Object.keys(l).forEach(function(t){var a=l[t],n=r.get(a);n.updateSorting(e),g.push(n)}),o.updateSorting(n[0],n[1],n[2],g,e)}}),e.addEvent("interpolationToggle",e.Events.CLICK,function(){var e=this.checked,a=new t.Utility.ChartAgent,n=a.getChartMapFromSheet();if(!(n.length<4)){var i=t.Manager.SidePanelManager,r=n[3],l=a.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],c=i.getActiveMeta();c.updateInterpolationOption(e),Object.keys(l).forEach(function(t){var a=l[t],n=r.get(a);n.updateInterpolationOption(e),g.push(n)}),o.updateInterpolationOption(n[0],n[1],n[2],g,e)}}),e.addEvent("caption",e.Events.CLICK,function(){var e=this.checked,a=new t.Utility.ChartAgent,n=a.getChartMapFromSheet();if(!(n.length<4)){var i=t.Manager.SidePanelManager,r=n[3],l=a.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],c=i.getActiveMeta();c.enableCaption(e),Object.keys(l).forEach(function(t){var a=l[t],n=r.get(a);n.enableCaption(e),g.push(n)}),o.enableCaption(n[0],n[1],n[2],g[0],e)}}),e.addEvent("sumToggle",e.Events.CLICK,function(){var e=this.checked,a=new t.Utility.ChartAgent,n=a.getChartMapFromSheet();if(!(n.length<4)){var i=t.Manager.SidePanelManager,r=n[3],l=a.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],c=i.getActiveMeta();c.updateSumOption(e),Object.keys(l).forEach(function(t){var a=l[t],n=r.get(a);n.updateSumOption(e),g.push(n)}),o.updateSumOption(n[0],n[1],n[2],g,e)}}),h.bind("#captionFont","zselectboxchange",function(e,a){var n=new t.Utility.ChartAgent,i=a.value,r=i.lastIndexOf("px"),l=-Number.parseInt(i.substring(0,r)),o=n.getChartMapFromSheet();if(!(o.length<4)){var g=o[3],c=t.Manager.SidePanelManager,d=n.getSPActiveChartID(),s=new t.Controller.ZSCController,h=[];Object.keys(d).forEach(function(e){var t=d[e],a=g.get(t);a.getDetails();a&&a.updateCaptionFontSize(i,l),a&&h.push(a)});var u=c.getActiveMeta();u.updateCaptionFontSize(i,l),s.updateCaptionFontSize(o[0],o[1],o[2],h[0],i,l)}}),h.bind("#captionBold","click",function(e,a){var n=t.Wrapper.DOMUtils,i=n.getElementById("captionBold"),r=n.toggleActive(i),l=""!==r,o=l?"bold":"normal",g=new t.Utility.ChartAgent,c=g.getChartMapFromSheet();if(!(c.length<4)){var d=c[3],s=t.Manager.SidePanelManager,h=g.getSPActiveChartID(),u=new t.Controller.ZSCController,C=[];Object.keys(h).forEach(function(e){var t=h[e],a=d.get(t);a.getOptions();a&&a.updateCaptionFontWeight(o),a&&C.push(a)});var v=s.getActiveMeta();v.updateCaptionFontWeight(o),u.updateCaptionFontWeight(c[0],c[1],c[2],C[0],o)}}),h.bind("#captionItalic","click",function(e,a){var n=t.Wrapper.DOMUtils,i=n.getElementById("captionItalic"),r=n.toggleActive(i),l=""!==r,o=l?"italic":"normal",g=new t.Utility.ChartAgent,c=g.getChartMapFromSheet();if(!(c.length<4)){var d=c[3],s=t.Manager.SidePanelManager,h=g.getSPActiveChartID(),u=new t.Controller.ZSCController,C=[];Object.keys(h).forEach(function(e){var t=h[e],a=d.get(t);a.getOptions();a&&a.updateCaptionFontStyle(o),a&&C.push(a)});var v=s.getActiveMeta();v.updateCaptionFontStyle(o),u.updateCaptionFontStyle(c[0],c[1],c[2],C[0],o)}}),h.bind("#captionFontColor","zcolorselectchange",function(e,a){if(a.fromUI){var n,i=a.color,r=q(i);n=-1!=i.indexOf("#")?i:T.fn.rgbToHex(r);var l=new t.Utility.ChartAgent,o=t.Manager.SidePanelManager,g=l.getChartMapFromSheet();if(!(g.length<4)){var c=g[3],d=l.getSPActiveChartID(),s=new t.Controller.ZSCController,h=[],u=o.getActiveMeta();Object.keys(d).forEach(function(e){var t=d[e],a=c.get(t);if(a){a.getDetails();a&&a.updateCaptionFontColor(n),a&&h.push(a)}}),u.updateCaptionFontColor(n),s.updateCaptionFontColor(g[0],g[1],g[2],h[0],n)}}}),h.bind("#missingValues","zselectboxchange",function(e,a){if(a.fromUI){var n=new t.Utility.ChartAgent,i=a.value;switch(i){case"TreatZero":i=0;break;case"Interpolate":i=1;break;case"LastValid":i=2}var r=n.getChartMapFromSheet();if(!(r.length<4)){var l=t.Manager.SidePanelManager,o=r[3],g=n.getSPActiveChartID(),c=new t.Controller.ZSCController,d=[],s=l.getActiveMeta();s.updateMissingValOption(i),Object.keys(g).forEach(function(e){var t=g[e],a=o.get(t);a.getDetails();a.updateMissingValOption(i),d.push(a)}),c.updateMissingValOption(r[0],r[1],r[2],d,i)}}}),h.bind("#sortingOrder","zselectboxchange",function(e,a){if(a.fromUI){var n=a.value,i="TOP"==n?"descending":"ascending",r=new t.Utility.ChartAgent,l=r.getChartMapFromSheet();if(!(l.length<4)){var o=t.Manager.SidePanelManager,g=l[3],c=r.getSPActiveChartID(),d=new t.Controller.ZSCController,s=[],h=o.getActiveMeta();h.setSortingType(i),Object.keys(c).forEach(function(e){var t=c[e],a=g.get(t);a.setSortingType(i),s.push(a)}),d.setSortingType(l[0],l[1],l[2],s,i)}}}),h.bind("#trendlineType","zselectboxchange",function(e,a){if(a.fromUI){var n=new t.Utility.ChartAgent,i=a.value,r=n.getChartMapFromSheet();if(!(r.length<4)){var l=t.Manager.SidePanelManager,o=r[3],g=n.getSPActiveChartID(),c=new t.Controller.ZSCController,d=[],s=l.getActiveMeta();s.updateTrendtype(a),Object.keys(g).forEach(function(e){var t=g[e],r=o.get(t),l=r.getDetails(),c=r&&n.isUniqueValue(i.toLowerCase(),l.tlType);c&&r.updateTrendtype(a),c&&d.push(r)}),c.updateTrendlineType(r[0],r[1],r[2],d,i.toLowerCase())}}}),h.bind("#tlPeriod","znumberfieldchange",function(e,t){he(t)}),h.bind("#tlPeriod","znumberfieldspin",function(e,t){he(t)}),h.bind("#chartfontfamilys","zselectboxchange",function(e,a){if(a.fromUI){var n=new t.Utility.ChartAgent,i=a.value,r=n.getChartMapFromSheet(),l=t.Manager.SidePanelManager;if(!(r.length<4)){var o=r[3],g=n.getSPActiveChartID(),c=new t.Controller.ZSCController,d=[],s={style:{}};Object.keys(g).forEach(function(e){var t=g[e],a=o.get(t);a.getDetails();s.style.fontFamily=i,a&&a.updateFontFamily(s.style),a&&d.push(a)});var h=l.getActiveMeta();h.updateFontFamily(s.style),c.updateFontFamily(r[0],r[1],r[2],d[0],s)}}}),h.bind("#trendlineDegree","zselectboxchange",function(e,a){if(a.fromUI){var n=new t.Utility.ChartAgent,i=a.value,r=n.getChartMapFromSheet(),l=t.Manager.SidePanelManager;if(!(r.length<4)){var o=r[3],g=n.getSPActiveChartID(),c=new t.Controller.ZSCController,d=[];Object.keys(g).forEach(function(e){var t=g[e],r=o.get(t),l=r.getDetails(),c=r&&n.isUniqueValue(i,l.order);c&&r.updateTrendDegree(a),c&&d.push(r)});var s=l.getActiveMeta();s.updateTrendDegree(a),c.updateTrendlineDegree(r[0],r[1],r[2],d,parseInt(i))}}}),h.bind("#chartTitleCombo","zselectboxchange",function(e,t){t.fromUI&&X()}),h.bind("#chartFont","zselectboxchange",function(e,a){if(a.fromUI){var n=new t.Utility.ChartAgent,i=h.zcombo("#chartTitleCombo","getValue"),r=n.getSPActiveChartID(),l=u.getSubAction(i,r),o=u.getTitleStyle(i,r),g=n.getChartMapFromSheet(),c=t.Manager.SidePanelManager;if(!(g.length<4)){var d=g[3],s=new t.Controller.ZSCController,C=d.get(r),v={};o.fontSize=a.value,v.style=o,l==D.CHART_Y_AXIS_TITLE_STYLE&&(v.index=u.getActiveTitleIndex(r));var A=c.getActiveMeta();A.updateTitleStyle(l,o),C.updateTitleStyle(n.fetchTitleLabelBasedOnSubAction(l),o,v.index),s.updateTitleStyle(g[0],g[1],g[2],C,v,l)}}}),h.bind("#TITLE_ALIGNMENT_POPUP","zmenubeforeshow",function(e,a){var n=new t.Utility.ChartAgent,i=h.zcombo("#chartTitleCombo","getValue"),r=n.getSPActiveChartID(),l=(u.getSubAction(i,r),n.getChartMapFromSheet());t.Manager.SidePanelManager;if(!(l.length<4)){var o=l[3],g=(new t.Controller.ZSCController,o.get(r)),c="center";switch(i){case"CHART_TITLE":c=g.chartOptions.title.align;break;case"CHART_SUBTITLE":c=g.chartOptions.subtitle.align}var d="TITLE_CENTER_ALIGNMENT";switch(c){case"left":d="TITLE_LEFT_ALIGNMENT";break;case"center":d="TITLE_CENTER_ALIGNMENT";break;case"right":d="TITLE_RIGHT_ALIGNMENT"}var s=document.getElementById("TITLE_ALIGNMENT_POPUP").querySelectorAll("li");s.forEach(function(e){e.id&&h.zmenu("#TITLE_ALIGNMENT_POPUP","setMenuItemsAttribute",["#"+e.id],"checked",!1)}),h.zmenu("#TITLE_ALIGNMENT_POPUP","setMenuItemsAttribute",["#"+d],"checked",!0)}}),h.bind("#TITLE_ALIGNMENT_POPUP","zmenuitemclick",function(e,a){var n=a.data.direction,i=new t.Utility.ChartAgent,r=h.zcombo("#chartTitleCombo","getValue"),l=i.getSPActiveChartID(),o=(u.getSubAction(r,l),i.getChartMapFromSheet()),g=t.Manager.SidePanelManager;if(!(o.length<4)){var c=o[3],d=new t.Controller.ZSCController,s=c.get(l),C=n,v=g.getActiveMeta();v.updateTitleAlignment(119,C),v.updateTitleAlignment(120,C),s.updateTitleAlignment(i.fetchTitleLabelBasedOnSubAction(119),C),s.updateTitleAlignment(i.fetchTitleLabelBasedOnSubAction(120),C),d.updateTitleAlignment(o[0],o[1],o[2],s,C,u.getSubActionForTitleAlignment("CHART_TITLE")),d.updateTitleAlignment(o[0],o[1],o[2],s,C,u.getSubActionForTitleAlignment("CHART_SUBTITLE"))}}),e.addEventByNode(e.getElementById("chartTitlebold"),"click",function(e,a){var n=h.zcombo("#chartTitleCombo","getValue"),i=new t.Utility.ChartAgent,r=i.getSPActiveChartID(),l=t.Wrapper.DOMUtils,o=l.toggleActive(l.getElementById("chartTitlebold")),g=""!==o,c=u.getSubAction(n,r),d=u.getTitleStyle(n,r),s=i.getChartMapFromSheet(),C=t.Manager.SidePanelManager;if(!(s.length<4)){var v=s[3],A=new t.Controller.ZSCController,p=v.get(r),S={};d.fontWeight=g?"bold":"normal",S.style=d,c==D.CHART_Y_AXIS_TITLE_STYLE&&(S.index=u.getActiveTitleIndex(r));var I=C.getActiveMeta();I.updateTitleStyle(c,d,n),p.updateTitleStyle(i.fetchTitleLabelBasedOnSubAction(c),d,S.index),A.updateTitleStyle(s[0],s[1],s[2],p,S,c)}}),h.bind("#chartTitleitalic","click",function(e,a){var n=h.zcombo("#chartTitleCombo","getValue"),i=new t.Utility.ChartAgent,r=i.getSPActiveChartID(),l=t.Wrapper.DOMUtils,o=l.toggleActive(l.getElementById("chartTitleitalic")),g=""!==o,c=t.Manager.SidePanelManager,d=u.getSubAction(n,r),s=u.getTitleStyle(n,r),C=i.getChartMapFromSheet();if(!(C.length<4)){var v=C[3],A=v.get(r),p=new t.Controller.ZSCController,S={};s.fontStyle=g?"italic":"normal",S.style=s,d==D.CHART_Y_AXIS_TITLE_STYLE&&(S.index=u.getActiveTitleIndex(r));var I=c.getActiveMeta();I.updateTitleStyle(d,s,n),A.updateTitleStyle(i.fetchTitleLabelBasedOnSubAction(d),s,S.index),p.updateTitleStyle(C[0],C[1],C[2],A,S,d)}}),h.bind("#chartTitleFontColor","zcolorselectchange",function(e,a){if(a.fromUI){var n=h.zcombo("#chartTitleCombo","getValue"),i=t.Manager.SidePanelManager,r=new t.Utility.ChartAgent,l=r.getSPActiveChartID(),o=u.getTitleStyle(n,l),g=u.getSubAction(n,l),c=r.getChartMapFromSheet();if(!(c.length<4)){var d=c[3],s=d.get(i.getActiveChartID()),C=new t.Controller.ZSCController,v={},A=r.getRGBAColor(o.color);o.color=a.color,v.style=o,g==D.CHART_Y_AXIS_TITLE_STYLE&&(v.index=u.getActiveTitleIndex(l));var p=r.isUniqueValue(a.color.replace(/\s/g,""),A.replace(/\s/g,"")),S=i.getActiveMeta();p&&S.updateTitleStyle(g,o,n),p&&s.updateTitleStyle(r.fetchTitleLabelBasedOnSubAction(g),o,v.index),p&&C.updateTitleStyle(c[0],c[1],c[2],s,v,g)}}})}(),function(){new t.Utility.ChartAgent;c.addEvent("tooltipToggle","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("tooltipToggle").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=(new t.Utility.ChartAgent,new t.Controller.ZSCController),g=[];Object.keys(l).forEach(function(e){var t=l[e],a=i.get(t);a.getDetails();a&&g.push(a)});r.getActiveChartID();var d=r.getActiveMeta();d.setTooltip(a),o.updateTooltip(n[0],n[1],n[2],g,a)}}),c.addEvent("chartGradientReverse","change",function(){u.updateChartGradientStatus(t.Utility.getActiveChart(!0),this.checked),u.updateSeriesGradientStatus(t.Utility.getActiveChart(!0),this.checked);var e=g.view.getActiveGridID(),a=g.view.getVersionID(e),n=g.view.getResourceID(e),i=(g.data.getWorkBook(n,a),g.view.getSheetID(e)),r=new t.Utility.ChartAgent,l=r.getChartMeta(t.Utility.getActiveChart(!0));l.setGradient(u.getDialogMeta(t.Utility.getActiveChart(!0)).getGradient());var o=new t.Controller.ZSCController;o.updateGradient(n,i,a,l)}),c.addEvent("seriesGradientReverse","change",function(){u.updateSeriesGradientStatus(t.Utility.getActiveChart(!0),this.checked);var e=g.view.getActiveGridID(),a=g.view.getVersionID(e),n=g.view.getResourceID(e),i=(g.data.getWorkBook(n,a),g.view.getSheetID(e)),r=new t.Utility.ChartAgent,l=r.getChartMeta(t.Utility.getActiveChart(!0));l.setGradient(u.getDialogMeta(t.Utility.getActiveChart(!0)).getGradient());var o=new t.Controller.ZSCController;o.updateGradient(n,i,a,l)}),c.addEvent("invertedToggle","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("invertedToggle").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=(new t.Utility.ChartAgent,new t.Controller.ZSCController),g=[];Object.keys(l).forEach(function(e){var t=l[e],a=i.get(t);a.getDetails();a&&g.push(a)});r.getActiveChartID();var d=r.getActiveMeta();d.setInverted(a);var o=new t.Controller.ZSCController;o.updateInverted(n[0],n[1],n[2],g,a)}}),c.addEvent("splineToggle","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("splineToggle").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=(new t.Utility.ChartAgent,new t.Controller.ZSCController),g=[];Object.keys(l).forEach(function(e){var t=l[e],a=i.get(t);a.getDetails();a&&g.push(a)});r.getActiveChartID();var d=r.getActiveMeta();d.setSpline(a);var o=new t.Controller.ZSCController;o.updateSpline(n[0],n[1],n[2],g,a)}}),c.addEvent("animationToggle","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("animationToggle").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[];Object.keys(l).forEach(function(e){var t=l[e],a=i.get(t);a.getDetails();a&&g.push(a)});var d=r.getActiveMeta();d.setAnimation(a),o.updateAnimation(n[0],n[1],n[2],g,a)}}),c.addEvent("autoExpandToggle","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("autoExpandToggle").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[];Object.keys(l).forEach(function(e){var t=l[e],a=i.get(t);a.getDetails();a&&g.push(a)});r.getActiveChartID();var d=r.getActiveMeta();d.setExpand(a),o.updateAutoExpand(n[0],n[1],n[2],g,a)}}),c.addEvent("hddCellToggle","change",function(){new t.Utility.ChartAgent;var e=t.Manager.SidePanelManager,a=[e.getActiveChartID()];u.updateHiddenCellForSP(a[0],c.getElementById("hddCellToggle").checked)}),c.addEvent("markerToggle","change",function(){var e=this.checked,a=new t.Utility.ChartAgent,n=a.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=a.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[];Object.keys(l).forEach(function(t){var a=l[t],n=i.get(a);n.setMarkerState(e),n&&g.push(n)});var c=r.getActiveMeta();c.setMarkerState(e),o.updateLineMarker(n[0],n[1],n[2],g,e)}})}(),function(){var e=t.Manager.SidePanelManager,a=c.getElementById("titleTextBox"),n=null;function i(e){return 0==e.indexOf("=")&&k(e.substring(1))}c.addEventByNode(a,c.Events.INPUT,function(){var a=this.value;clearTimeout(n),i(a)?u.updateTitleByRange(null,unescape(a.substring(1))):function(e,t){p.getRangePicker(S.SP_TITLE_TEXT);u.updateClientTitleText(e,t)}(e.getActiveChartID(),t.Utility.getDecodeString(a)),n=setTimeout(function(){clearTimeout(n),x(i(a)?a.substring(1):t.Utility.getEncodeString(t.Utility.getDecodeString(a)))},1e3)}),c.addEventByNode(a,c.Events.BLUR,function(){var e=this.value;x(i(e)?e.substring(1):t.Utility.getEncodeString(t.Utility.getDecodeString(e))),clearTimeout(n)})}(),c.addEvent("xAxisLabel","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("xAxisLabel").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i,r=n[3],l=t.Manager.SidePanelManager,o=e.getSPActiveChartID(),g=new t.Controller.ZSCController,d=[],s={};Object.keys(o).forEach(function(e){var n=o[e],l=r.get(n),g=l.getDetails();if("ANIMATION_CHART"==g.type){var c=l.chartOptions.dataForAnimationChart[0].data,h=l.chartOptions.yAxis[0].labels.style.fontSize;(i={}).type="ANIMATION_CHART";var u=a?t.Utility.findMargin(h,c):30;i.maxWidth=u}s.isYAxis=!1,s.labels=a,l&&l.updateXLabel(a,i),l&&d.push(l)});var h=l.getActiveMeta();h.updateXLabel(a,void 0,i),g.updateLabel(n[0],n[1],n[2],d[0],s)}}),h.bind("#slant","zselectboxchange",function(e,a){if(a.fromUI){var n=new t.Utility.ChartAgent,i="Auto"==a.value?null:parseInt(a.value),r=n.getChartMapFromSheet();if(!(r.length<4)){var l=r[3],o=t.Manager.SidePanelManager,g=n.getSPActiveChartID(),c=new t.Controller.ZSCController,d=[],s=null;Object.keys(g).forEach(function(e){var t=g[e],r=((s=l.get(t)).getOptions(),s&&n.isUniqueValue(i,s.getXSlant()));r&&s.updateXSlant(a),r&&d.push(s)});var h=o.getActiveMeta();h.updateXSlant(a),d[0]&&s&&c.updateXSlant(r[0],r[1],r[2],d[0],i)}}}),h.bind("#staggerLines","zselectboxchange",function(e,a){if(a.fromUI){var n=new t.Utility.ChartAgent,i="auto"==a.value?null:a.value,r=n.getChartMapFromSheet();if(!(r.length<4)){var l=r[3],o=t.Manager.SidePanelManager,g=n.getSPActiveChartID(),c=new t.Controller.ZSCController,d=[];Object.keys(g).forEach(function(e){var t=g[e],r=l.get(t),o=(r.getOptions(),r&&n.isUniqueValue(i,r.getStaggerState()));o&&r.updateXStagger(a),o&&d.push(r)});var s=o.getActiveMeta();s.updateXStagger(a),d[0]&&c.updateStaggerLines(r[0],r[1],r[2],d[0],i)}}}),c.addEvent("yAxisLabel","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("yAxisLabel").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],d={},s=0;Object.keys(l).forEach(function(e){var t=l[e];s=u.getActiveYAxisIndex(t);var n=i.get(t);n.getDetails(),d.isYAxis=!0,d.index=s,d.labels=a,n&&n.updateYLabel(a,s),n&&g.push(n)});var h=r.getActiveMeta();h.updateYLabel(a,s),o.updateLabel(n[0],n[1],n[2],g[0],d)}}),c.addEvent("min","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("min").value,n=G(a);if(!n)return c.getElementById("min").value="",void W();var i=e.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=t.Manager.SidePanelManager,o=e.getSPActiveChartID(),g=new t.Controller.ZSCController,d=[],s={},h=0;Object.keys(o).forEach(function(e){var t=o[e];h=u.getActiveYAxisIndex(t);var n=r.get(t);n.getDetails(),s.isYAxis=!0,s.index=h,s.min=""===a?void 0:+parseFloat(a),n&&n.updateYMin(a,h),n&&d.push(n)});var C=l.getActiveMeta();C.updateYMin(a,h),g.updateMin(i[0],i[1],i[2],d[0],s)}},1e3),c.addEvent("max","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("max").value,n=G(a);if(!n)return c.getElementById("max").value="",void W();var i=e.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=t.Manager.SidePanelManager,o=e.getSPActiveChartID(),g=new t.Controller.ZSCController,d=[],s={},h=0;Object.keys(o).forEach(function(e){var t=o[e];h=u.getActiveYAxisIndex(t);var n=r.get(t);n.getDetails(),s.isYAxis=!0,s.index=h,s.max=""===a?void 0:+parseFloat(a),n&&n.updateYMax(a,h),n&&d.push(n)});var C=l.getActiveMeta();C.updateYMax(a,h),g.updateMax(i[0],i[1],i[2],d[0],s)}},1e3),c.addEvent("interval","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("interval").value,n=G(a);if(!n)return c.getElementById("interval").value="",void W();var i=e.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=t.Manager.SidePanelManager,o=e.getSPActiveChartID(),g=new t.Controller.ZSCController,d=[],s={},h=0;Object.keys(o).forEach(function(e){var t=o[e];h=u.getActiveYAxisIndex(t);var n=r.get(t);n.getDetails(),s.isYAxis=!0,s.index=h,s.interval=""===a?void 0:+parseFloat(a),n&&n.updateYInterval(a,h),n&&d.push(n)});var C=l.getActiveMeta();C.updateYInterval(a,h),g.updateInterval(i[0],i[1],i[2],d[0],s)}},1e3),c.addEvent("majorGridLines","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("majorGridLines").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],d=0;Object.keys(l).forEach(function(e){var t=l[e];d=u.getActiveYAxisIndex(t);var n=i.get(t);n.getDetails(),n&&n.updateYMajor(a,d),n&&g.push(n)});var s=r.getActiveMeta();s.updateYMajor(a,d),o.updateMajor(n[0],n[1],n[2],g,a)}}),c.addEvent("minorGridLines","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("minorGridLines").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],d=0;Object.keys(l).forEach(function(e){var t=l[e];d=u.getActiveYAxisIndex(t);var n=i.get(t);n.getDetails(),n&&n.updateYMinor(a,d),n&&g.push(n)});var s=r.getActiveMeta();s.updateYMinor(a,d),o.updateMinor(n[0],n[1],n[2],g,a)}}),c.addEvent("yReverseToggle","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("yReverseToggle").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],d={},s=0;Object.keys(l).forEach(function(e){var t=l[e];s=u.getActiveYAxisIndex(t),d.index=s,d.reversed=a,d.isYAxis=!0;var n=i.get(t);n.getDetails(),n&&n.updateYReverse(a,s),n&&g.push(n)});var h=r.getActiveMeta();h.updateYReverse(a,s),o.updateReverse(n[0],n[1],n[2],g[0],d)}}),c.addEvent("yOppositeToggle","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("yOppositeToggle").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],d={},s=0;Object.keys(l).forEach(function(e){var t=l[e];s=u.getActiveYAxisIndex(t),d.index=s,d.opposite=a,d.isYAxis=!0;var n=i.get(t);n.getDetails(),n&&n.updateYOpposite(a,s),n&&g.push(n)});var h=r.getActiveMeta();h.updateYOpposite(a,s),o.updateOpposite(n[0],n[1],n[2],g[0],d)}}),c.addEvent("xReverseToggle","change",function(){var e=new t.Utility.ChartAgent,a=c.getElementById("xReverseToggle").checked,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],d={},s=0;Object.keys(l).forEach(function(e){var t=l[e];s=u.getActiveYAxisIndex(t),d.index=s,d.reversed=a,d.isYAxis=!1;var n=i.get(t);n.getDetails(),n&&n.updateXReverse(a),n&&g.push(n)});var h=r.getActiveMeta();h.updateXReverse(a,0),o.updateReverse(n[0],n[1],n[2],g[0],d)}}),c.addEvent("LogarthimicToggle","change",function(){var e=t.Wrapper.DOMUtils;e.getElementById("LogarthimicToggle").checked?e.addStyle("baseValueWrapper",{display:""}):e.hideById("baseValueWrapper");var a=new t.Utility.ChartAgent,n=e.getElementById("LogarthimicToggle").checked,i=a.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=t.Manager.SidePanelManager,o=a.getSPActiveChartID(),g=new t.Controller.ZSCController,c=[],d={},s=0;Object.keys(o).forEach(function(e){var t=o[e];s=u.getActiveYAxisIndex(t),d.index=s,d.logarithmic=n,d.isYAxis=!0;var a=r.get(t);a.getDetails(),a&&a.updateYLogarithmic(n,s),a&&c.push(a)});var h=l.getActiveMeta();h.updateYLogarithmic(n,s),g.updateLogarithmic(i[0],i[1],i[2],c[0],d)}}),h.bind("#baseValue","znumberfieldchange",function(){ce()}),h.bind("#baseValue","znumberfieldspin",function(){ce()}),h.bind("#animationSpeed","znumberfieldchange",function(){de()}),h.bind("#animationSpeed","znumberfieldspin",function(){de()}),h.bind("#barCount","znumberfieldchange",function(){se()}),h.bind("#barCount","znumberfieldspin",function(){se()}),c.addEvent("multiyaxisYes","change",function(){var e=t.Manager.SidePanelManager;c.showById("addPlotLine"),u.updateMultiYAxiesForSP(e.getActiveChartID()[0],c.getElementById("multiyaxisYes").checked);var a=c.getElementById("yAxisWrapper");this.checked?c.addClass(a,"wrapMultiAxies"):c.removeClass(a,"wrapMultiAxies")}),h.bind("#yaxisMulti","zselectboxchange",function(e,a){if(a.fromUI){new t.Utility.ChartAgent;var n=t.Manager.SidePanelManager;u.updateMultiYAxiesDom(n.getActiveChartID()[0],a)}}),c.addEvent("addPlotLine","click",function(){new t.Utility.ChartAgent;var e=t.Manager.SidePanelManager;u.addPlotLine(e.getActiveChartID()[0])}),K(),h.bind("#chartcustomcolorDropDown1","zcolorselectchange",function(e,a){if(a.fromUI){var n=a.color,i=new t.Utility.ChartAgent,r=t.Manager.SidePanelManager,l=i.getChartMapFromSheet();if(!(l.length<4)){var o=l[3],g=i.getSPActiveChartID(),c=new t.Controller.ZSCController,d=[],s={},h=r.getActiveMeta(),u=h.getOptions().chart.backgroundColor||m,C=(new t.Model.ChartModel).getTransparencyQuotient(u),v=(new t.Model.ChartModel).getRGBA(u);C<1&&(n=(new t.Model.ChartModel).getRGBA(n,C)),Object.keys(g).forEach(function(e){var t=g[e],a=o.get(t);a&&(a.getDetails(),a&&a.updateChartColor(n),a&&d.push(a),s.cbc=n,s.pbc=n)});var A=i.isUniqueValue(n.replace(/ /g,""),v.replace(/ /g,""));A&&h.updateChartColor(n),A&&c.updateCBC(l[0],l[1],l[2],d[0],s)}}}),h.bind("#borderColorDropDown","zcolorselectchange",function(e,a){if(a.fromUI){var n,i=a.color;if("transparent"!=i){var r=q(i);n=-1!=i.indexOf("#")?i:T.fn.rgbToHex(r)}else n=i;var l=new t.Utility.ChartAgent,o=t.Manager.SidePanelManager,g=l.getChartMapFromSheet();if(!(g.length<4)){var c=g[3],d=l.getSPActiveChartID(),s=new t.Controller.ZSCController,h=[],u=o.getActiveMeta();Object.keys(d).forEach(function(e){var t=d[e],a=c.get(t);a&&(a.getDetails(),a&&a.updateChartBorderColor(n),a&&h.push(a))}),u.updateChartBorderColor(n),s.updateChartBorderColor(g[0],g[1],g[2],h[0],n)}}}),h.bind("#caTransparency","zsliderchange",function(e,a){var n=a.value,i=parseFloat(parseFloat((100-n)/100).toFixed(2)),r=t.Manager.SidePanelManager,l=new t.Utility.ChartAgent,o=l.getChartMapFromSheet();if(!(o.length<4)){var g=o[3],c=l.getSPActiveChartID(),d=g.get(c[0]),s=d.getOptions().chart.backgroundColor||m,h=(new t.Model.ChartModel).getRGBA(s,i),u=new t.Controller.ZSCController,C=[],v={};Object.keys(c).forEach(function(e){var t=c[e],a=g.get(t);a&&(a.getDetails(),a&&a.updateChartColor(h),a&&C.push(a),v.cbc=h,v.pbc=h)});var A=r.getActiveMeta(),p=l.isUniqueValue(h.replace(/ /g,""),s.replace(/ /g,""));p&&A.updateChartColor(h),p&&u.updateCBC(o[0],o[1],o[2],C[0],v)}}),h.bind("#chartcustomcolorDropDown3","zcolorselectchange",function(e,a){if(a.fromUI){var n=a.color,i=new t.Utility.ChartAgent,r=i.getChartMapFromSheet();if(!(r.length<4)){var l=r[3],o=i.getSPActiveChartID(),g=new t.Controller.ZSCController,i=new t.Utility.ChartAgent,c=[],d={};Object.keys(o).forEach(function(e){var t=o[e],a=l.get(t);a.getDetails(),d.glColor=n,d.index=0,a&&a.updateGCColor(n),a&&c.push(a)});var s=t.Manager.SidePanelManager,h=s.getActiveMeta(),u=h.getOptions().yAxis[0].gridLineColor||m,C=(new t.Model.ChartModel).getRGBA(u),v=i.isUniqueValue(n.replace(/ /g,""),C.replace(/ /g,""));v&&g.updateGC(r[0],r[1],r[2],c[0],d)}}}),function(){var e=t.Manager.SidePanelManager;c=t.Wrapper.DOMUtils,h.bind("#filterSpinner","znumberfieldchange",function(){var t=u.isFilterRequestNeeded(e.getActiveChartID(),"limit");u.updateFilter(e.getActiveChartID(),"limit",c.getElementById("filterSpinner").value,t)}),h.bind("#filterSpinner","znumberfieldspin",function(){var t=u.isFilterRequestNeeded(e.getActiveChartID(),"limit");u.updateFilter(e.getActiveChartID(),"limit",c.getElementById("filterSpinner").value,t)}),h.bind("#filterType","zselectboxchange",function(a,n){if(n.fromUI){var i=n.value,r=u.isFilterRequestNeeded(e.getActiveChartID(),"type"),l=new t.Utility.AgentDom;u.updateFilter(e.getActiveChartID(),"type",i,r),"NONE"===i&&l.resetFilterIfNeeded()}}),h.bind("#filterColumns","zselectboxchange",function(a,n){if(n.fromUI){var i=n.value,r=new t.Utility.AgentDom;if("noFilter"===i)u.resetFilter(e.getActiveChartID(),!0),r.resetFilterIfNeeded();else{var l=u.isFilterRequestNeeded(e.getActiveChartID(),"limitBy");u.updateFilterMeta(e.getActiveChartID(),h.zcombo("#filterType","getValue"),h.zspinner("#filterSpinner","getValue")),u.updateFilter(e.getActiveChartID(),"limitBy",i,l)}}});var a=c.getElementById("chartFilterReset");c.addEventByNode(a,"click",function(a,n){var i=new t.Utility.AgentDom;i.resetFilterIfNeeded(),u.resetFilter(e.getActiveChartID(),!0)})}(),function(){var e=t.Wrapper.DOMUtils,a=t.Constants.UnitFormat;h.bind("#scaleType","zselectboxchange",function(e,n){if(n.fromUI){var i=n.selectedValue;switch(i){case"custom":t.Wrapper.DOMUtils.addStyle("scaleCustomWrapper",{display:"table-row"});break;case a.THOUSANDS:case a.MILLIONS:case a.BILLIONS:case a.DEFAULT:case a.NONE:!function(){O(),L();var e=t.Manager.SidePanelManager.getActiveChartID();u.updateUnitFactor(e,i,u.getActiveYAxisIndex(e)||0)}();break;default:!function(){O(),L();var e=+parseFloat(n.selectedValue),a=t.Manager.SidePanelManager.getActiveChartID();u.updateScaleFactor(a,e,u.getActiveYAxisIndex(a)||0)}()}}}),e.addEventByNode(e.getElementById("scaleCustomValue"),e.Events.INPUT,function(a){var n=Z(this.value);if(0==n)return e.getElementById("scaleCustomValue").value="",void W();if(!(n<0)){var i=+parseFloat(this.value),r=t.Manager.SidePanelManager,l=r.getActiveChartID();u.updateScaleFactor(l,i||1,u.getActiveYAxisIndex(l)||0)}})}();var y,M,P;this.bindAggregationEvents([0]),function(){c.addEventByNode(c.getElementByClassName("aggAddMore"),"click",function(e,a){var n=t.Aggregation,i=t.Aggregation.getLastIndex();t.Manager.SidePanelManager;n.constructNewcombo(i),n.getOptionsAndLoadInCombo(i,!0)}),c.addEventByNode(c.getElementById("resetAggregation"),"click",function(e,a){var n=t.Aggregation,i=t.Manager.SidePanelManager,r=i.getActiveMeta();i.getActiveChartID();u.resetAggregation(i.getActiveChartID(),!0),n.resetAggregation(r.getSeriesIn())}),h.bind("#chartAxisCombo0","zselectboxchange",function(e,n){if(n.fromUI){var i="choose"!=n.value,r=h.zcombo("#chartLegendCombo0","getValue"),l="choose"!=r,o=t.Aggregation.getAggregationNumbersAsString().split(";").length>1;if(i&&l&&o)return a.ZSAlert(s["Chart.Aggregation.SingleNumColumn"]),h.zcombo("#chartAxisCombo0","setValue",n.previousValue),null;if(r==n.value&&i)return a.ZSAlert(s["Chart.Aggregation.AxisAndLegend"]),h.zcombo("#chartAxisCombo0","setValue",n.previousValue),null;var g=t.Aggregation.displayHideDatePicker("chartAxisDatePicker",n.optionData.element,n.value),c=t.Aggregation.aggregationGroupByClauseChange(n,"Axis",g),d=t.Manager.SidePanelManager,C=d.getActiveChartID();c&&u.updateAggregation(C,c,!0)}}),h.bind("#chartLegendCombo0","zselectboxchange",function(e,n){if(n.fromUI){var i="choose"!=n.value,r=h.zcombo("#chartAxisCombo0","getValue"),l="choose"!=r,o=t.Aggregation.getAggregationNumbersAsString().split(";").length>1;if(i&&l&&o)return a.ZSAlert(s["Chart.Aggregation.SingleNumColumn"]),h.zcombo("#chartLegendCombo0","setValue",n.previousValue),null;if(r==n.value&&i)return a.ZSAlert(s["Chart.Aggregation.AxisAndLegend"]),h.zcombo("#chartLegendCombo0","setValue",n.previousValue),null;var g=t.Aggregation.displayHideDatePicker("chartLegendDatePicker",n.optionData.element,n.value),c=t.Aggregation.aggregationGroupByClauseChange(n,"Legend",g),d=t.Manager.SidePanelManager,C=d.getActiveChartID();c&&u.updateAggregation(C,c,!0)}}),t.Aggregation.bindMenuOpeningEvent(),c.addEventByNode(c.getElementByClassName("chartAxisDatePicker"),"click",function(e){t.Aggregation.selectedElementClicked(e)}),c.addEventByNode(c.getElementByClassName("chartLegendDatePicker"),"click",function(e){t.Aggregation.selectedElementClicked(e)}),h.bind("#aggreoperation","zselectboxchange",function(e,a){if(e.fromUI){var n=t.Manager.SidePanelManager,i=n.getActiveMeta();if(i){var r=n.getActiveChartID();if("NONE"!=a.value){var l=t.Aggregation.getAggregationNumbersAsString(),o=t.Aggregation.getAggregationHeadersAsString(),g=i.getAggregationHeaderMapDetailsForAllHeaders(o.split(";")),d=i.getAggregationOperation(),s=(u.populateNumericColumnsIfNeeded(r,d,a.value),(null!=o&&""!==o||null!=l&&""!=l)&&"NONE"!==a.value),h={type:a.value,colheaders:o,dateOperations:g,enabled:s,numericColumns:l},C=u.populateFilterColumnsIfNeeded(r,d,a.value);C&&u.updateFilter(r,"limitBy","NONE",!1);u.updateAggregation(r,h,!0)}else c.getElementById("resetAggregation").click()}}});var e=c.getElementById("aggregationNumColsTemplate");t.Aggregation.bindSortableEventsForAggregation(e,"numbers")}(),c.addEvent("c3DToggle",c.Events.CLICK,function(){var e=c.getElementById("c3DToggle").checked,a=t.Manager.SidePanelManager,n=a.getActiveChartID(),i=u.dialogMeta[n],r=i.getType();B(r=w(r,e))}),y=t.Constants.NumberFormat,M=c.getElementById("suffixNumberFormat"),P=c.getElementById("prefixNumberFormat"),h.bind("#numberFormatType","zselectboxchange",function(e,a){if(a.fromUI){var n=t.Wrapper.DOMUtils;n.hideById("zsCustomNubFormatWrapper");var i=a.selectedValue,r=t.Manager.SidePanelManager,l=r.getActiveChartID()[0];switch(i==y.CUSTOM&&(n.addStyle("zsCustomNubFormatWrapper",{display:"table-row"}),P.value=u.getYAxiesByIndex(l,u.getActiveYAxisIndex(l)||0).prefix||"",M.value=u.getYAxiesByIndex(l,u.getActiveYAxisIndex(l)||0).suffix||""),i){case y.DEFAULT:u.setNumberFormat(l,{nfCode:y.DEFAULT,prefix:"",suffix:"",yIndex:u.getActiveYAxisIndex(l)||0});break;case y.THOUSANDS:u.setNumberFormat(l,{nfCode:y.THOUSANDS,prefix:"",suffix:"",yIndex:u.getActiveYAxisIndex(l)||0});break;case y.MILLIONS:u.setNumberFormat(l,{nfCode:y.MILLIONS,prefix:"",suffix:"",yIndex:u.getActiveYAxisIndex(l)||0});break;case y.BILLIONS:u.setNumberFormat(l,{nfCode:y.BILLIONS,prefix:"",suffix:"",yIndex:u.getActiveYAxisIndex(l)||0});break;case y.NONE:u.setNumberFormat(l,{nfCode:y.NONE,prefix:"",suffix:"",yIndex:u.getActiveYAxisIndex(l)||0})}}}),c.addEventByNode(P,c.Events.INPUT,function(){var e=t.Manager.SidePanelManager,a=e.getActiveChartID();u.setNumberFormat(a,{nfCode:y.CUSTOM,prefix:this.value,suffix:M.value,yIndex:u.getActiveYAxisIndex(a)||0})}),c.addEventByNode(M,c.Events.INPUT,function(){var e=t.Manager.SidePanelManager,a=e.getActiveChartID();u.setNumberFormat(a,{nfCode:y.CUSTOM,prefix:P.value,suffix:this.value,yIndex:u.getActiveYAxisIndex(a)||0})}),function(){var e=t.Wrapper.DOMUtils;e.addEventByNode(e.getElementById("binningInterval"),"change",function(a){var n=function(e){if(void 0!==e&&""!=e){var t=parseInt(e);return!isNaN(t)}if(""==e)return!0;return!1}(a.target.value);if(!n)return e.getElementById("binningInterval").value="",void W();var i=""==a.target.value?0:a.target.value,r=t.Manager.SidePanelManager,l=r.getActiveChartID();u.updateBinningInterval(l,i)})}(),h.bind("#seriesCaTransparency","zsliderchange",function(e,a){var i=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),l=a.value,g=parseFloat(parseFloat((100-l)/100).toFixed(2)),c=parseInt(h.zcombo("#chartSeries","getValue")),d=i.getType(),s=i.getOptions().series,u=!s[c],C=t.Utility.isCompositionChart(t.Utility.getChartMetaByIndex(i.getOptions(),i.getType(),c)),v=t.Utility.getSeriesColor(i.getOptions(),C?0:c,C?c:null,i.getInstance()[0],!C,u),A=new t.Model.ChartModel,p=A.getTransparency(v);v=A.getRGBA(v,g),p!=l&&v&&o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES,{PROPERTIES:{isSeries:!0,color:v,sIndex:c,pIndex:0,cType:d,cID:i.getID(),mCType:d}})}),h.bind("#chartcustomcolorDropDown11","zcolorselectchange",function(e,a){if(a.fromUI){var i=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),l=i.getType(),g=parseInt(h.zcombo("#chartSeries","getValue")),c=a.color,d=i.getOptions().series,s=!d[g],u=t.Utility.isCompositionChart(t.Utility.getChartMetaByIndex(i.getOptions(),i.getType(),g)),C=i.getID(),v=i.getCType(),A=h.zslider("#seriesCaTransparency","getValue");A=parseFloat(parseFloat((100-A)/100).toFixed(2));var p=(new t.Model.ChartModel).getRGBA(c,A),S=t.Utility.getSeriesColor(i.getOptions(),u?0:g,u?g:null,i.getInstance()[0],!u,s);if(S=(new t.Model.ChartModel).getRGBA(S,A)){var I=new t.Utility.ChartAgent,E=I.isUniqueValue(S.replace(/ /g,""),p.replace(/ /g,""));E&&o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES,{PROPERTIES:{isSeries:!0,color:p,sIndex:g,pIndex:0,cType:v,cID:C,mCType:l}})}}}),h.bind("#chartType","zmenuitemclick",function(e,a){var i=a.data,l=i.id,g=l.indexOf("_CHART");l=l.substring(0,g);for(var c=parseInt(h.zcombo("#chartSeries","getValue")),d=u.getDialogMeta(t.Utility.getActiveChart(!0)),s=d.getComboTypes(),C=0;C<c;C++)!s[C]&&(s[C]="XYLINE");s[c]=l,d.setComboTypes(s),o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES_TYPE,{PROPERTIES:{value:s.join(","),ID:d.getChartID(),META:d}})}),h.bind("#chartSeries","zselectboxchange",function(e,t){t.fromUI&&R.call(this)}),h.bind("#trendLineStyleType","zmenubeforeshow",function(e,a){new t.Utility.ChartAgent;var n=parseInt(h.zcombo("#chartSeries","getValue")),i=document.getElementById("chartSeries").options[n].text,r=u.getDialogMeta(t.Utility.getActiveChart(!0)),l=r.getOptions().series,o=document.getElementById("trendLineStyleType").querySelectorAll("li");o.forEach(function(e){e.style.background="#fff"});for(var g=0;g<l.length;g++){var c=l[g].regressionSettings;if(c.name==i){var d=c.dashStyle;document.getElementById("trendLineStyleType").querySelector("#"+d).style.background="#eee",void 0!=r.lineStyles[g]&&(document.getElementById("trendLineStyleType").querySelector("#"+d).style.background="#fff",document.getElementById("trendLineStyleType").querySelector("#"+r.lineStyles[g].lineStyleType).style.background="#eee");break}}}),h.bind("#trendLineStyleType","zmenuitemclick",function(e,a){var i=a.data,l=i.id,g=parseInt(h.zcombo("#chartSeries","getValue")),c=u.getDialogMeta(t.Utility.getActiveChart(!0));c.getOptions().series,o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES_LINE_STYLE,{PROPERTIES:{dashStyle:l,cID:c.getChartID(),sIndex:g}})}),h.bind("#trendLineStyleType","zmenubeforeshow",function(e,a){var n=new t.Utility.ChartAgent,i=n.getSPActiveChartID(),r=n.getChartMapFromSheet();if(t.Manager.SidePanelManager,!(r.length<4)){for(var l=r[3],o=l.get(i),g=parseInt(h.zcombo("#chartSeries","getValue")),c=Math.ceil(g/2-1),d=o.chartOptions.series[c].regressionSettings.dashStyle,s=o.chartOptions.lineStyles,u=0;u<s.length;u++){var C=s[u];C.seriesIndex==g&&(d=C.lineStyleType)}var v=document.getElementById("trendLineStyleType"),A=document.getElementById("trendLineStyleType").querySelectorAll("li");A.forEach(function(e){var t=v.querySelector("#"+e.id);t.style.backgroundColor=""});var p=v.querySelector("#"+d);p.style.backgroundColor="#eee"}}),h.bind("#xAxisLabelFont","zselectboxchange",function(e,a){if(a.fromUI){var i=a.value,l=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_SIZE,{PROPERTIES:{fontSize:i,cID:l,props:null}})}}),h.bind("#chartXAxisBold","click",function(e,a){var i=c.toggleActive(this),l=""===i,g=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_WEIGHT,{PROPERTIES:{bold:l,cID:g,props:null}})}),h.bind("#chartAxisItalic","click",function(e,a){var i=c.toggleActive(this),l=""===i,g=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_STYLE,{PROPERTIES:{italic:l,cID:g,props:null}})}),h.bind("#chartAxisFontColor","zcolorselectchange",function(e,a){if(a.fromUI){var i=a.color,l=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),g=l.getID(),c=new t.Utility.ChartAgent,d=l.getXAxis(),s=d.labels||{},h=s.style||{},u=h.color||(new t.Model.ChartModel).getRGBA("#4d4d4d",1),C=c.isUniqueValue(u.replace(/ /g,""),i.replace(/ /g,""));C&&o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_COLOR,{PROPERTIES:{color:i,cID:g,props:null}})}}),function(){var e=t.Wrapper.DOMUtils;e.addEvent("plotlineToggle","change",function(){var e=!this.checked,a=t.Utility.getActiveChart(!0),n=u.getActiveYAxisIndex(a);e&&u.removeAllPlotLine(a,n);var i=t.Utility.getChartMeta([a],!0);e&&i.removeAllPlotLine(n);var r=g.view.getActiveGridID(),l=g.view.getResourceID(r),o=g.view.getVersionID(r),c=g.view.getSheetID(r),d=new t.Controller.ZSCController;e&&d.removePlotline(l,c,o,i,{isYAxis:!0,plIndex:-1,index:n});var s=new t.Utility.AgentDom;e&&s.updateYAxisRelatedDom(u.getDialogMeta(a))}),h.bind("#chartYAxisFontSize","zselectboxchange",function(e,a){if(a.fromUI){var i=a.value,l=t.Utility.getActiveChart(!0),g=u.getActiveYAxisIndex(l);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_SIZE,{PROPERTIES:{fontSize:i,cID:l,props:{index:g}}})}}),h.bind("#chartYAxisBold","click",function(a,i){var l=e.toggleActive(this),g=""===l,c=t.Utility.getActiveChart(!0),d=u.getActiveYAxisIndex(c);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_WEIGHT,{PROPERTIES:{bold:g,cID:c,props:{index:d}}})}),h.bind("#chartYAxisItalic","click",function(a,i){var l=e.toggleActive(this),g=""===l,c=t.Utility.getActiveChart(!0),d=u.getActiveYAxisIndex(c);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_STYLE,{PROPERTIES:{italic:g,cID:c,props:{index:d}}})}),h.bind("#chartYAxisFontColor","zcolorselectchange",function(e,a){if(a.fromUI){var i=a.color,l=t.Utility.getActiveChart(!0),g=u.getActiveYAxisIndex(l),c=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),d=new t.Utility.ChartAgent,s=c.getXAxis(),h=s.labels||{},C=h.style||{},v=C.color||(new t.Model.ChartModel).getRGBA("#4d4d4d",1),A=d.isUniqueValue(v.replace(/ /g,""),i.replace(/ /g,""));A&&o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_COLOR,{PROPERTIES:{color:i,cID:l,props:{index:g}}})}})}(),function(){var e=t.Wrapper.DOMUtils;h.bind("#chartPlotNameFont","zselectboxchange",function(e,a){if(a.fromUI){var i=a.value,l=h.zcombo("#plotlineValues","getValue"),g=t.Utility.getActiveChart(!0),c=new t.Utility.CommanAgent,d=parseInt(c.pickIntegerFromString(l))-1;if(!(d<0)){var s=u.getActiveYAxisIndex(g),C=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),v=C.getYAxis()[s],A=v.plotLines[d],p=A.label.style;p.fontSize=i,o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.STYLES,{PROPERTIES:{style:p,yIndex:s,pIndex:d,ID:C.getID()}})}}}),h.bind("#chartPlotLineColor","zcolorchooserchange",function(e,a){try{var i=a.color,l=h.zcombo("#plotlineValues","getValue"),g=t.Utility.getActiveChart(!0),c=new t.Utility.CommanAgent,d=parseInt(c.pickIntegerFromString(l))-1,s=u.getActiveYAxisIndex(g);if(d<0)return;var C=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),v=C.getYAxis()[s],A=v.plotLines[d],p=A.color,S=new t.Model.ChartModel;i=S.getRGBA(i),p=S.getRGBA(p);var I=new t.Utility.ChartAgent,E=I.isUniqueValue(p.replace(/ /g,""),i.replace(/ /g,""));E&&o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.COLOR,{PROPERTIES:{color:i,yIndex:s,pIndex:d,ID:C.getID()}})}catch(e){}}),h.bind("#chartPlotNameFontColor","zcolorselectchange",function(e,a){if(a.fromUI){var i=a.color,l=h.zcombo("#plotlineValues","getValue"),g=t.Utility.getActiveChart(!0),c=new t.Utility.CommanAgent,d=parseInt(c.pickIntegerFromString(l))-1,s=u.getActiveYAxisIndex(g);if(!(d<0)){var C=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),v=C.getYAxis()[s],A=v.plotLines[d],p=A.label.style,S=p.color||"#2d2d2d",I=new t.Model.ChartModel;i=I.getRGBA(i),S=I.getRGBA(S);var E=new t.Utility.ChartAgent,f=E.isUniqueValue(S.replace(/ /g,""),i.replace(/ /g,""));f&&(p.color=i),f&&o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.STYLES,{PROPERTIES:{style:p,yIndex:s,pIndex:d,ID:C.getID()}})}}}),e.addEvent("chartPlotNamebold",e.Events.CLICK,function(){var a=e.toggleActive(e.getElementById("chartPlotNamebold")),i=""!==a,l=h.zcombo("#plotlineValues","getValue"),g=t.Utility.getActiveChart(!0),c=new t.Utility.CommanAgent,d=parseInt(c.pickIntegerFromString(l))-1,s=u.getActiveYAxisIndex(g);if(!(d<0)){var C=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),v=C.getYAxis()[s],A=v.plotLines[d],p=A.label.style;p.fontWeight=i?"bold":"normal",o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.STYLES,{PROPERTIES:{style:p,yIndex:s,pIndex:d,ID:C.getID()}})}}),e.addEvent("chartPlotNameitalic",e.Events.CLICK,function(){var a=e.toggleActive(e.getElementById("chartPlotNameitalic")),i=""!==a,l=h.zcombo("#plotlineValues","getValue"),g=t.Utility.getActiveChart(!0),c=new t.Utility.CommanAgent,d=parseInt(c.pickIntegerFromString(l))-1,s=u.getActiveYAxisIndex(g);if(!(d<0)){var C=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),v=C.getYAxis()[s],A=v.plotLines[d],p=A.label.style;p.fontStyle=i?"italic":"normal",o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.STYLES,{PROPERTIES:{style:p,yIndex:s,pIndex:d,ID:C.getID()}})}}),h.bind("#plotLineType","zmenuitemclick",function(e,a){var i=a.data,l=i.id,g=h.zcombo("#plotlineValues","getValue"),c=t.Utility.getActiveChart(!0),d=new t.Utility.CommanAgent,s=parseInt(d.pickIntegerFromString(g))-1,C=u.getActiveYAxisIndex(c);if(!(s<0)){var v=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.DASHSTYLE,{PROPERTIES:{dashStyle:l,yIndex:C,pIndex:s,ID:v.getID()}})}})}(),function(){var e=t.Wrapper.DOMUtils;e.addEvent("totalDataLabls",e.Events.CLICK,function(){var e=this.checked,a=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.TOTALS,{PROPERTIES:{enabled:e,cID:a}})}),h.bind("#dataLabelsFontSize","zselectboxchange",function(e,a){if(a.fromUI){var i=a.value,l=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_SIZE,{PROPERTIES:{fontSize:i,cID:l}})}}),h.bind("#dataLabelsBold","click",function(a,i){var l=e.toggleActive(this),g=""===l,c=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_WEIGHT,{PROPERTIES:{bold:g,cID:c}})}),h.bind("#dataLabelsItalic","click",function(a,i){var l=e.toggleActive(this),g=""===l,c=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_STYLE,{PROPERTIES:{italic:g,cID:c}})}),h.bind("#dataLabelsFontColor","zcolorselectchange",function(e,a){if(a.fromUI){var i=a.color,l=t.Utility.getActiveChart(!0),g=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),c=new t.Utility.ChartAgent,d=g.getDataLabelStyle()||{},s=(new t.Model.ChartModel).getRGBA(d.color||"#2d2d2d");i=(new t.Model.ChartModel).getRGBA(i);var h=c.isUniqueValue(s.replace(/ /g,""),i.replace(/ /g,""));h&&o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_COLOR,{PROPERTIES:{color:i,cID:l}})}})}(),function(){var e=t.Wrapper.DOMUtils;h.bind("#dltFontSize","zselectboxchange",function(e,a){if(a.fromUI){var i=a.value,l=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.TOTAL.FONT_SIZE,{PROPERTIES:{fontSize:i,cID:l}})}}),h.bind("#dltBold","click",function(a,i){var l=e.toggleActive(this),g=""===l,c=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.TOTAL.FONT_WEIGHT,{PROPERTIES:{bold:g,cID:c}})}),h.bind("#dltItalic","click",function(a,i){var l=e.toggleActive(this),g=""===l,c=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.TOTAL.FONT_STYLE,{PROPERTIES:{italic:g,cID:c}})}),h.bind("#dltColor","zcolorselectchange",function(e,a){if(a.fromUI){var i=a.color,l=t.Utility.getActiveChart(!0),g=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),c=new t.Utility.ChartAgent,d=g.getDataLabelTotalStyle()||{},s=(new t.Model.ChartModel).getRGBA(d.color||"#2d2d2d");i=(new t.Model.ChartModel).getRGBA(i);var h=c.isUniqueValue(s.replace(/ /g,""),i.replace(/ /g,""));h&&o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.TOTAL.FONT_COLOR,{PROPERTIES:{color:i,cID:l}})}})}(),function(){var e=t.Wrapper.DOMUtils;e.addEvent("thresholdToggle",e.Events.CLICK,function(){var t=this.checked,a=new Event("change"),n=e.getElementById("thresholdValue"),i=n.value,r=i.length>0;n.value="",!t&&r&&n.dispatchEvent(a)}),e.addEvent("thresholdValue",e.Events.CHANGE,function(){var e=this.value,a=Z(e);if(0!=a){if(!(a<0)){var i=t.Utility.getActiveChart(!0);o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.THRESHOLD.VALUE,{PROPERTIES:{value:e,cID:i}})}}else W()}),h.bind("#thrsholdColor","zcolorselectchange",function(e,a){if(a.fromUI){var i=a.color,l=t.Utility.getActiveChart(!0),g=t.Utility.getChartMeta(t.Utility.getActiveChart(),!0),c=new t.Utility.ChartAgent,d=g.getThresholdColor()||"#FF0000";d=(new t.Model.ChartModel).getRGBA(d),i=(new t.Model.ChartModel).getRGBA(i);var s=c.isUniqueValue(d.replace(/ /g,""),i.replace(/ /g,""));s&&o.publish(r.UI,n.Names.SidePanel.CHARTS.CUSTOM.UPDATE.THRESHOLD.COLOR,{PROPERTIES:{color:i,cID:l}})}})}()},U.prototype.bindAggregationEvents=function(e){var a=t.Wrapper.DOMUtils,n=a.getElementById("aggDateMenu");h.bind(n,"zmenuitemclick",function(e,a){t.Aggregation;var n=a.forElement[0],i=a.data.value;t.Aggregation.resetSelectedState(),i&&"NONE"!==i&&t.Aggregation.setSelectedState(i),"chartAxisDatePicker"===n.id&&le(0,i),"chartLegendDatePicker"===n.id&&le(1,i)});var i=a.getElementsByClassName("aggclose");a.addEventByNode(i[e[0]],"click",oe)},U.prototype.attachEvents=function(){A=!1,c=t.Wrapper.DOMUtils,p=new t.Utility.CommanAgent;var e=new a.Editors.RangeEditor(c.getElementById("chrtEditor"));a.RangePicker.register(e),p.addRangePicker(S.DATA_RANGE,e),this.doDialogSpecificAttachEvents();for(var n,i,r,l=c.getElementStack("input","chrtTypeLbl"),o=l.length,g=0;g<o;g++){i=(n=l[g]).length;for(var d=0;d<i;d++)r=n[d],c.addEventByNode(r,"click",N)}var s,C,v,E,f=c.getElementById("addNewRanges");c.addEventByNode(f,"click",this.openRangeDialog.bind(this)),z(e),s=new t.Utility.ChartAgent,c.addEvent("rowChart","change",function(){t.Manager.SidePanelManager,u.updateSeriesIn(s.getActiveChartIDForSP(),c.getElementById("rowChart").checked,c.getElementById("columnChart").checked)}),c.addEvent("columnChart","change",function(){t.Manager.SidePanelManager,u.updateSeriesIn(s.getActiveChartIDForSP(),c.getElementById("rowChart").checked,c.getElementById("columnChart").checked)}),function(){var e=new t.Utility.ChartAgent;c.addEvent("firstRow","change",function(){t.Manager.SidePanelManager;u.updateFirstRowAsLabel(e.getActiveChartIDForSP(),c.getElementById("firstRow").checked)}),c.addEvent("firstColumn","change",function(){t.Manager.SidePanelManager;u.updateFirstColumnAsLabel(e.getActiveChartIDForSP(),c.getElementById("firstColumn").checked)})}(),h.bind("#legendPos","change",function(e,a){delete a.combo;var n=new t.Utility.ChartAgent;u.updateLegend(n.getActiveChartIDForSP(),a)}),h.bind("#dataLabels","change",function(e,a){delete a.combo;var n=new t.Utility.ChartAgent;u.updateDataLabels(n.getActiveChartIDForSP(),a)}),h.bind("#trendlineType","change",function(e,a){delete a.combo;var n=new t.Utility.ChartAgent;u.updateTrendtype(n.getActiveChartIDForSP(),a)}),h.bind("#trendlinePeriod","spinnerchange",function(e,a){delete a.combo;var n=new t.Utility.ChartAgent;u.updateTrendDegree(n.getActiveChartIDForSP(),a)}),h.bind("#trendlineDegree","change",function(e,a){delete a.combo;var n=new t.Utility.ChartAgent;u.updateTrendDegree(n.getActiveChartIDForSP(),a)}),h.bind("#combinedRanges","change",function(e,a){delete a.combo;var n=new t.Utility.ChartAgent;u.updateCombinedWay(n.getActiveChartIDForSP(),a)}),h.bind("#chartTitle","change",function(e,a){delete a.combo;var n=new t.Utility.ChartAgent;u.updateTitleForSp(n.getActiveChartIDForSP(),a)}),function(){var e=new t.Utility.ChartAgent;c.addEvent("tooltipToggle","change",function(){u.updateTooltip(e.getActiveChartIDForSP(),c.getElementById("tooltipToggle").checked)}),c.addEvent("invertedToggle","change",function(){u.updateInverted(e.getActiveChartIDForSP(),c.getElementById("invertedToggle").checked)}),c.addEvent("splineToggle","change",function(){u.updateSpline(e.getActiveChartIDForSP(),c.getElementById("splineToggle").checked)}),c.addEvent("zoomToggle","change",function(){u.updateZoom(e.getActiveChartIDForSP(),c.getElementById("zoomToggle").checked)}),c.addEvent("animationToggle","change",function(){u.updateAnimation(e.getActiveChartIDForSP(),c.getElementById("animationToggle").checked)}),c.addEvent("autoExpandToggle","change",function(){u.updateAutoExpand(e.getActiveChartIDForSP(),c.getElementById("autoExpandToggle").checked)}),c.addEvent("hddCellToggle","change",function(){var e=new t.Utility.ChartAgent;u.updateHiddenCell(e.getActiveChartIDForSP(),c.getElementById("hddCellToggle").checked)})}(),(C=new a.Editors.RangeEditor(c.getElementById("ChartTitle"),!0,!0)).customPreventDefault=re.bind(C),a.RangePicker.register(C,!0,!0),p.addRangePicker(S.CHART_TITLE,C),(v=new a.Editors.RangeEditor(c.getElementById("ChartSubTitle"),!0,!0)).customPreventDefault=re.bind(v),a.RangePicker.register(v,!0,!0),p.addRangePicker(S.CHART_SUBTITLE,v),I.addValidator(C,function(){return k(C.value)},function(){u.updateTitleByRange(S.CHART_TITLE,C.value)},function(){var e=new t.Utility.ChartAgent;u.updateTitle(e.getActiveChartIDForSP(),C.value)}),I.addValidator(v,function(){return k(v.value)},function(){u.updateTitleByRange(S.CHART_SUBTITLE,v.value)},function(){var e=new t.Utility.ChartAgent;u.updateSubTitle(e.getActiveChartIDForSP(),v.value)}),c.addEvent("ChartThreshold","keyup",function(){var e=new t.Utility.ChartAgent;u.updateThreshold(e.getActiveChartIDForSP(),c.getElementById("ChartThreshold").value)}),(E=new a.Editors.RangeEditor(c.getElementById("xAxisTitle"),!0,!0)).customPreventDefault=re.bind(E),a.RangePicker.register(E,!0,!0),p.addRangePicker(S.CHART_X_AXIES,E),I.addValidator(E,function(){return k(E.value)},function(){u.updateTitleByRange(S.CHART_X_AXIES,E.value)},function(){var e=new t.Utility.ChartAgent;u.updateXTitle(e.getActiveChartIDForSP(),E.value,0)}),c.addEvent("xAxisLabel","change",function(){var e=new t.Utility.ChartAgent;u.updateXLabel(e.getActiveChartIDForSP(),c.getElementById("xAxisLabel").checked)}),h.bind("#slant","change",function(e,a){delete a.combo;var n=new t.Utility.ChartAgent;u.updateXSlant(n.getActiveChartIDForSP(),a)}),h.bind("#staggerLines","change",function(e,a){delete a.combo;var n=new t.Utility.ChartAgent;u.updateXStagger(n.getActiveChartIDForSP(),a)}),j(),K()},U.prototype.setActiveChartId=function(e){this.activeChartId||(this.activeChartId=[]),-1==this.activeChartId.indexOf(e)&&this.activeChartId.push(e)},U.prototype.getActiveChartID=function(){return this.activeChartId},U.prototype.removeActiveChartID=function(){this.activeChartId=null},U.prototype.getActiveMeta=function(){var e=t.Manager.SidePanelManager.getActiveChartID();return u.dialogMeta[e]},t.Manager.getActiveChartMeta={fn:function(){var e=t.Manager.SidePanelManager.getActiveChartID();return u.dialogMeta[e]}},U.prototype.openRangeDialog=function(){var e=(new t.Utility.CommanAgent).getRangePicker(S.DATA_RANGE);this.range=e.value,this.setActiveChartId(t.Utility.getActiveChart()[0]),this.openZSCRDialog()},U.prototype.showRangeDialog=function(e){var a=(new t.Utility.CommanAgent).getRangePicker(S.DATA_RANGE);this.addRangeClicked=e,this.range=a.value,t.Manager.SidePanelManager.enableRangeEditor(),this.showRangeDomForSP(e)},U.prototype.hideDialog=function(){C&&C.hide()},U.prototype.recallDialog=function(){C&&C.show();var e=(new t.Utility.CommanAgent).getRangePicker(S.DATA_RANGE);e.value=this.range,e.valueChanged(),this.clearRangeCatch(),H()},U.prototype.hideRangeDialogForSP=function(){t.Manager.SidePanelManager.disableRangeEditor(),this.cancelDialogForSp()},U.prototype.updateDataRangeForSP=function(){t.Manager.SidePanelManager;var e=(new t.Utility.CommanAgent).getRangePicker(S.DATA_RANGE);e.value=this.range.replace(/(.+)(;)$/,"$1"),e.valueChanged(),this.clearRangeCatch(),setTimeout(function(){H()},200)},U.prototype.setFocus=function(e){t.Wrapper.DOMUtils.getElementById(e).click()},U.prototype.initDialog=function(){var t=e.UserAction.getTemplate(["CHART_WRAPPER_TEMPLATE","CHART_PREVIEW_TEMPLATE","CHART_OK_CANCEL_TEMPLATE","CHART_YAXIES_TEMPLATE","CHART_AXIES_TEMPLATE","CHART_OPTION_TEMPLATE","CHART_TYPE_TEMPLATE","CHART_GENRAL_TEMPLATE","CHART_RECOMMENDATION_TEMPLATE","CHART_LABEL_TEMPLATE","CHART_SERIES_IN_TEMPLATE","CHART_DATA_RANGE_COMBINED_RANGE_TEMPLATE","CHART_TAB_LIST_TEMPLATE","CHART_XAXIES_TEMPLATE","CHART_LEFT_PANEL_TEMPLATE","CHART_BOX_TEMPLATE","CHART_PREVIEW_OPEN_CLOSE_TEMPLATE","CHART_ADVANCE_TEMPLATE","AGGREGATED_CHART_TEMPLATE","FILTER_CHART_TEMPLATE"]);(v=d.createElement("div")).id="DI_CHART",v.appendChild(t.CHART_PREVIEW_OPEN_CLOSE_TEMPLATE),v.appendChild(t.CHART_WRAPPER_TEMPLATE);var a=v.querySelector("#wrapper");a.appendChild(t.CHART_TAB_LIST_TEMPLATE),a.appendChild(t.CHART_LEFT_PANEL_TEMPLATE),a.appendChild(t.CHART_PREVIEW_TEMPLATE);var n=a.querySelector("#chartleftPanel");n.appendChild(t.CHART_GENRAL_TEMPLATE),n.appendChild(t.CHART_OPTION_TEMPLATE),n.appendChild(t.CHART_TYPE_TEMPLATE),n.appendChild(t.CHART_AXIES_TEMPLATE),n.appendChild(t.CHART_ADVANCE_TEMPLATE),n.appendChild(t.CHART_OK_CANCEL_TEMPLATE);var i=n.querySelector("#chartGeneral");i.appendChild(t.CHART_BOX_TEMPLATE),i.appendChild(t.CHART_RECOMMENDATION_TEMPLATE);var r=i.querySelector("#chartBox");r.appendChild(t.CHART_DATA_RANGE_COMBINED_RANGE_TEMPLATE),r.appendChild(t.CHART_SERIES_IN_TEMPLATE),r.appendChild(t.CHART_LABEL_TEMPLATE);var l=n.querySelector("#chartAxis");l.appendChild(t.CHART_XAXIES_TEMPLATE),l.appendChild(t.CHART_YAXIES_TEMPLATE);var o=n.querySelector("#Advanced");o.appendChild(t.AGGREGATED_CHART_TEMPLATE),o.appendChild(t.FILTER_CHART_TEMPLATE)},U.prototype.constructDialogMetaObject=function(e,t){u.refreshByMetaForSidePanel(e,t)},U.prototype.openDialogHandler=function(){A&&this.attachEvents();var e=new t.Utility.CommanAgent;if(-1!==u.getState().indexOf("ADD")){ee(0);var a=g.view.getActiveGridID(),n=g.view.getResourceID(a),i=g.view.getVersionID(a),r=g.view.getSheetID(a);g.view.getSheetState(a,r);e.getRangePicker(S.DATA_RANGE).Editor.focus(),t.Server.Action.fetchChart(n,r,i,"CHART_DETAILS",u.processResponse.bind(u))}else{ee(2);var l=t.Utility.getActiveChart(),o=t.Utility.getChartMeta(l,!0);u.refreshByMeta(o),t.Action.doRecommendation(o,!1),e.getRangePicker(S.CHART_TITLE).Editor.focus()}},U.prototype.closeDailogHandler=function(){var e=new t.Utility.CommanAgent;e.setDialogStatus(!1),e.removeDailogUtil(),(new t.Manager.ZSCColorManager).hideColorScheme(),u&&u.clearCatch();c.addStyle("preview",{display:"table-cell"})};function te(e,a){e.target.value;var n=new t.Utility.ChartAgent,i=n.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=n.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],c={},d=t.Manager.SidePanelManager;Object.keys(l).forEach(function(t){var a=l[t],n=u.getActiveYAxisIndex(a),i=r.get(a);i.getDetails();c.isYAxis=!0,c.index=n,c.plIndex=e.target.dataset.index,c.plValue=e.target.value,i&&i.addNewPlotline(c),i&&g.push(i)}),d.getActiveMeta().addNewPlotline(c),o.addPlotLines(i[0],i[1],i[2],g[0],c,a)}}function ae(e,a){e.target.value;var n=new t.Utility.ChartAgent,i=n.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=n.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],c={},d=t.Manager.SidePanelManager;Object.keys(l).forEach(function(t){var a=l[t],n=u.getActiveYAxisIndex(a),i=r.get(a);i.getDetails();c.isYAxis=!0,c.index=n,c.plIndex=e.target.dataset.index,c.title=e.target.value,i&&i.updatePlotLineName(c),i&&g.push(i)}),d.getActiveMeta().updatePlotLineName(c),o.addPlotLineName(i[0],i[1],i[2],g[0],c,a)}}function ne(e,a){var n=new t.Utility.ChartAgent,i=n.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=n.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],c={},d=t.Manager.SidePanelManager;Object.keys(l).forEach(function(t){var a=l[t],n=u.getActiveYAxisIndex(a),i=r.get(a);i.getDetails();c.isYAxis=!0,c.index=n;e.target.previousElementSibling.id;var o=e.target.dataset.index;c.plIndex=o,c.plValue=void 0,i&&i.removePlotlineByIndex(c),i&&g.push(i)}),d.getActiveMeta().removePlotlineByIndex(c),o.removePlotline(i[0],i[1],i[2],g[0],c,a)}}function ie(e){var t,a=e.keyCode||e.which;switch(a){case 65:if(!e.metaKey)return;case 37:case 38:case 39:case 40:setTimeout(function(){this.selectionChanged()}.bind(this),0)}13===a&&(e.preventDefault(),"titleTextBox"===e.target.id?(t=p.getRangePicker(S.SP_TITLE_TEXT),y?u.updateTitleByRange(S.SP_TITLE_TEXT,t.value):u.updateTitleText(encodeURIComponent(t.value.replace(/\u00a0/g," ")))):H())}function re(e){return ie.call(this,e),!0}function le(e,a){var n=t.Aggregation,i=t.Manager.SidePanelManager,r=i.getActiveChartID(),l=i.getActiveMeta().getAggregationDateOperations();l=n.getDateOperations(l,e,a);var o=t.Aggregation.getAggregationHeadersAsString(),g=t.Aggregation.getAggregationNumbersAsString(),c=h.zcombo("#aggreoperation","getValue"),d={dateOperations:l,colheaders:o,type:c,enabled:null!=o&&""!==o&&null!=g&&""!=g&&"NONE"!==c,numericColumns:g},s="NONE"!==c;u.updateAggregation(r,d,s)}function oe(e,a){var n=t.Manager.SidePanelManager.getActiveChartID(),i=t.Aggregation,r=e.target,l=t.Wrapper.DOMUtils.getAttribute(r,"index"),o=i.deleteDepth(l),g=i.getDateOperations(),c=o.join(";"),d={colheaders:c,dateOperations:g,enabled:null!=c&&""!==c};u.updateAggregation(n,d,!0)}function ge(e,t,a,n){var i,r=g.data.getWorkBook(e,t),l=a.match(P.rangeRegex);return(!n||void 0!==l&&void 0!==l[1])&&(n&&void 0!==l&&l[1]?(i=l[1].replace(/'/g,""),!!r.SheetList.isNameExists(i)&&(!!r.SheetList.getIdByName(i)||void 0)):null!==l&&void 0!==l)}function ce(){var e=new t.Utility.ChartAgent,a=h.zspinner("#baseValue","getValue"),n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],c={},d=0;Object.keys(l).forEach(function(e){var t=l[e];d=u.getActiveYAxisIndex(t),c.index=d,c.baseValue=a,c.isYAxis=!0;var n=i.get(t);n.getDetails();n&&n.updateYBaseValue(a,d),n&&g.push(n)}),r.getActiveMeta().updateYBaseValue(a,d),o.updateBaseValue(n[0],n[1],n[2],g[0],c)}}function de(){var e=new t.Utility.ChartAgent,a=1e3*h.zspinner("#animationSpeed","getValue"),n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[];Object.keys(l).forEach(function(e){var t=l[e],n=i.get(t);n.getDetails();n&&n.animationSpeed(a),n&&g.push(n)}),r.getActiveMeta().animationSpeed(a),o.updateAnimationSpeed(n[0],n[1],n[2],g[0],a)}}function se(){var e=new t.Utility.ChartAgent,a=h.zspinner("#barCount","getValue")-1,n=e.getChartMapFromSheet();if(!(n.length<4)){var i=n[3],r=t.Manager.SidePanelManager,l=e.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[];Object.keys(l).forEach(function(e){var t=l[e],n=i.get(t);n.getDetails();n&&n.updateBarCount(a),n&&g.push(n)}),r.getActiveMeta().updateBarCount(a),o.updateBarCount(n[0],n[1],n[2],g[0],a)}}function he(e){var a=new t.Utility.ChartAgent,n=e.value,i=a.getChartMapFromSheet();if(!(i.length<4)){var r=i[3],l=a.getSPActiveChartID(),o=new t.Controller.ZSCController,g=[],c=t.Manager.SidePanelManager;Object.keys(l).forEach(function(t){var i=l[t],o=r.get(i),c=o.getDegreeOrElse(),d=o&&a.isUniqueValue(n,c);d&&o.updateTrendDegree(e),d&&g.push(o)}),c.getActiveMeta().updateTrendDegree(e),o.updateTrendlinePeriod(i[0],i[1],i[2],g,n)}}t.Action.addNewPlotLine=function(){var e=t.Manager.SidePanelManager;u.addPlotLine(e.getActiveChartID())},t.Action.updatePlotline=function(e){var t=e.target,a=t.dataset;M=!1;var n=Z(t.value);0!=n?n<0||(2!=n?u.getSidePanelState()?13===(e.keyCode||e.which)?te(e,!1):(clearTimeout(),te(e,!0),setTimeout(function(){!M&&te(e,!1),M=!0},1e3)):u.updateYPlotline("preview",t.value,u.getActiveYAxisIndex("preview"),a.index):ne(e)):W()},t.Action.updatePlotlineName=function(e){var a=e.target,n=a.dataset;M=!1;var i=t.Utility.getActiveChart(!0);u.getActiveYAxisIndex(i),u.getSidePanelState()?13===(e.keyCode||e.which)?ae(e,!1):(clearTimeout(),ae(e,!0),setTimeout(function(){!M&&ae(e,!1),M=!0},1e3)):u.updateYPlotlineName("preview",a.value,u.getActiveYAxisIndex("preview"),n.index)},t.Action.removePlotLine=function(e){var t=e.target,a=t.parentElement.parentElement,n=t.dataset.index;c.showById("addPlotLine"),c.getElementById("plotLineWrapper").removeChild(a),u.getSidePanelState()?setTimeout(function(){ne(e,!1)},1e3):u.removeYPlotline("preview",u.getActiveYAxisIndex("preview"),n)},t.Utility.getDialog=function(){return C.getDialog()},t.Action.doRecommendation=function(e,a){var n=e.getActiveSheet(),i=e.getRange();if(null!=i&&""!==i){var r=e.getSeriesIn(),l=e.getCombinedWay(),o=e.getFirstRowAsLabel(),c=e.getFirstColAsLabel(),d=e.getHiddenCellState(),s=g.view.getActiveGridID(),h=g.view.getResourceID(s),C=g.view.getVersionID(s),v=g.view.getSheetID(s),A={};A.parameters={seriesIn:r,dataRange:i,currentSheet:n,appedingWay:l,fcl:c,frl:o,isIncludeHiddenCells:d,isAndroidClient:!1},A.url="useraction",A.action="GET_CHART_RECOMMENDATION",t.Server.Action.updatePreview(h,v,C,A,u.processRecommendationResponse.bind(u))}},t.Manager.DialogManager=U,t.Action.DoAggregation=function(e,a){if(e){var n=t.Manager.SidePanelManager.getActiveChartID();a=void 0!==a?a:!("NONE"===e.type||!e.numericColumns||""===e.numericColumns),u.updateAggregation(n,e,a)}},t.Utility.changeTitleCombo=X,t.Utility.onChangeSelect2=function(e,a){var n=a.id;if(e&&null!=e){for(var i=e.split(";"),r=0;r<i.length;r++){var l=i[r],o=t.Manager.SidePanelManager.getActiveMeta().getRange(),g=t.DecTable.getRangeDecTableMap(o),c=t.Utility.getComboId(l,g,n);h.select2("#"+n,null,"detach",c)}h.select2("#"+n,null,"triggerChange")}},t.Utility.get3DMapping=w,t.Utility.getDateOperationByIndex=function(e){var a=function(e){var a=t.Manager.SidePanelManager.getActiveMeta().getAggregationColHeaders(),n=!1;for(var i in a)if(n=-1!==a[i].replace(/'/g,"").indexOf(e))break;return n?i:-1}(e);return t.Manager.SidePanelManager.getActiveMeta().getDepthOperation(a)},t.Utility.getDateElementDOM=function(e,a){var n=t.Wrapper.DOMUtils,i=t.Aggregation;i.resetSelectedState(),a&&"NONE"!==a&&i.setSelectedState(a);var r=n.createElement("span",{class:"dateFields"});null!==e&&n.appendChild(e,r)},t.Utility.getDateOperationsByHeaders=function(e){for(var a=t.Manager.SidePanelManager.getActiveMeta().getAggregationHeaderMap(),n=[],i=0;i<e.length;i++)for(var r=e[i],l=0;l<a.length;l++){var o=a[l];-1!==o.headers.indexOf(r)&&n.push(o.dateOperations)}return n},o.register(r.Listener,l.DocAction.DOCUMENT.CLOSE,function(){o.publish(r.UI,l.SidePanel.CHARTS.BLUR)}),o.register(r.UI,l.SidePanel.CHARTS.ACCORDION.SERIES.UPDATE,R),o.register(r.UI,l.SidePanel.CHARTS.BLUR,function(){var e=c.getElementById("titleTextBox"),t=new Event("blur");e.dispatchEvent(t)})}(this);
!function(e){var t,a,n=e.sPlusPlus,i=e.ZSEvents,l=i.topic,r=i.Groups,C=i.Names,s=e.UserAction,E=e.ZSClass,T=e.ZSChart,A=n.view.measures,d=E.KeyMapping,I=E.SidePanel,o=E.SidePanelClassList,c=o&&[o.right,o.left,o.bottom],S=o&&o.right,N=e.ZSConstants.JSKeyCode,R=n.data.AppRegistry.JSPath,_=e.ZSConstants.I18N,O=e.document,P=e.UIUtil.Component,p=null,m=!1,g=e.ZSConstants.FeatureConstants,h=n.view.Toolbar.Feature[g.UNDO],u=n.view.Toolbar.Feature[g.REDO],y={SERIES:{aTC:{name:"custom",cls:"customTab"},aAN:"series"},TITLES:{aTC:{name:"custom",cls:"customTab"},aAN:"titles"},LEGEND:{aTC:{name:"custom",cls:"customTab"},aAN:"legend"},HAXIS:{aTC:{name:"custom",cls:"customTab"},aAN:"haxis"},VAXIS:{aTC:{name:"custom",cls:"customTab"},aAN:"vaxis"},STYLES:{aTC:{name:"custom",cls:"customTab"},aAN:"styles"},CHART_DEFAULT:{aTC:{name:"general",cls:"generalTab"}},PIVOT_DEFAULT:{aTC:{name:"builder",cls:"builderTab"}}};var v=new function(){d.call(this)},L=n.view.Events.Key;function D(e){var t=s.getTemplate(["chartIcon"]);this.icon.appendChild(t.chartIcon),this.icon.title=_["MenuItem.InsertTab.Chart"]}function B(e){var t=null;p.getElementByClassName("spChartTabWrap")&&(t=p.getActiveElement("spChartTabWrap","active"));var a=!1;null!=t&&(a=e?p.hasClass(t,"generalTab"):p.hasClass(t,"builderTab")),null==t&&(a=!0),e?(p.getElementById("spChartHeader").style.display="none",p.getElementById("spPChartHeader").style.display="block",p.getElementByClassName("builderTab").style="",a&&p.addClass(p.getElementByClassName("builderTab"),"active"),p.removeClass(p.getElementByClassName("generalTab"),"active"),a&&p.removeClass(p.getElementByClassName("customTab"),"active"),p.hide(p.getElementByClassName("generalTab")),a&&(p.getElementById("spPivotChartGeneral").style.display=""),a&&(p.getElementById("spChartCustom").style.display="none"),p.getElementById("spChartGeneral").style.display="none"):(p.getElementById("spChartHeader").style.display="block",p.getElementById("spPChartHeader").style.display="none",p.getElementByClassName("builderTab").style.display="none",p.getElementById("spPivotChartGeneral").style.display="none",p.addStyle(p.getElementByClassName("generalTab"),{display:""}),(a||p.hasClass(t,"generalTab"))&&p.show(p.getElementById("spChartGeneral"))),function(){var e={NOT_SUPPORTED_TYPE:[{MenuItem:"stckWebTlt",Parent:"chrtTypeWrapper",Scope:1},{MenuItem:"PARETO",Parent:"chrtTypeWrapper",Scope:2},{MenuItem:"HISTOGRAM",Parent:"chrtTypeWrapper",Scope:2},{MenuItem:"WORDCLOUD",Parent:"chrtTypeWrapper",Scope:2},{MenuItem:"TIMEAREA",Parent:"chrtTypeWrapper",Scope:2},{MenuItem:"XYSTACKEDAREA_PERCENT",Parent:"chrtTypeWrapper",Scope:2},{MenuItem:"scatterBubleTlt",Parent:"chrtTypeWrapper",Scope:1},{MenuItem:"TIMELINE",Parent:"chrtTypeWrapper",Scope:2}],MENU_SWAPPING:[{MenuItem:"SP_CHART_TYPES_WRAPPER",Pivot_Parent:"spChartInnerDiv",Chart_Parent:"spGeneralInnerDiv",index:0}]},t=T.Wrapper.DOMUtils,a=(T.Manager.SidePanelManager,T.Utility.getChartMeta(T.Utility.getActiveChart(),!0));e.NOT_SUPPORTED_TYPE.forEach(function(e){var n=t.getElementById(e.Parent),i=n.querySelector("#"+e.MenuItem);null!=i&&(a.isPivotChart?t.hide(i):1==e.Scope&&t.addStyle(i,{display:""}),a.isPivotChart?t.hide(i.nextElementSibling):t.addStyle(i.nextElementSibling,{display:""}))}),e.MENU_SWAPPING.forEach(function(e){var n=t.getElementById(e.MenuItem);if(null!=n){var i=t.getElementById(e.Pivot_Parent),l=t.getElementById(e.Chart_Parent);a.isPivotChart?t.addChildAtIndex(n,i,null,e.index):t.addChildAtIndex(n,l,null,e.index)}})}()}function M(e,t){p=T.Wrapper.DOMUtils;var a=t||e.target.className;p.hideById("pivotChartTypeWrapper"),-1!==a.indexOf("builderTab")?(p.addClass(p.getElementByClassName("builderTab"),"active"),p.removeClass(p.getElementByClassName("generalTab"),"active"),p.removeClass(p.getElementByClassName("customTab"),"active"),p.getElementById("spPivotChartGeneral").style="",p.getElementById("spChartCustom").style.display="none",p.getElementById("spChartGeneral").style.display="none"):-1!==a.indexOf("customTab")?(p.addClass(p.getElementByClassName("customTab"),"active"),p.removeClass(p.getElementByClassName("generalTab"),"active"),p.removeClass(p.getElementByClassName("builderTab"),"active"),p.getElementById("spChartCustom").style="",p.getElementById("spChartGeneral").style.display="none",p.getElementById("spPivotChartGeneral").style.display="none"):(p.addClass(p.getElementByClassName("generalTab"),"active"),p.removeClass(p.getElementByClassName("customTab"),"active"),p.removeClass(p.getElementByClassName("builderTab"),"active"),p.getElementById("spChartGeneral").style="",p.getElementById("spChartCustom").style.display="none",p.getElementById("spPivotChartGeneral").style.display="none")}function H(e,a,n){if(U(e)){var i=T.Manager.SidePanelManager;i.TABEL_DEFINATION=n,i.setActiveChartId(e),t&&t.alive&&G(e),t&&t.open(),t&&t.show()}}function U(e){var t=n.view.getActiveGridID(),a=n.view.getResourceID(t),i=n.view.getVersionID(t),l=n.data.getWorkBook(a,i),r=n.view.getSheetID(t);(new T.Utility.ChartAgent).getChartMetaOfSheet(r,a,i,t,e);return l.isEditable()&&!l.ProtectedSheets.isSheetLocked(r)}function b(){var e=T.Manager.SidePanelManager;return null!=e.getActiveChartID()?e.getActiveChartID()[0]:T.Utility.getActiveChart()[0]}function G(e){var t=T.Manager.SidePanelManager;void 0!=e&&e==b()&&t.panel.open||(!e&&(e=b()),e&&(t.setPanelStatus({open:!0,close:!1}),function(e){var t=n.view.getActiveGridID(),a=n.view.getVersionID(t),i=n.view.getResourceID(t),s=n.view.getSheetID(t);l.publish(r.Listener,C.SheetAction.CHARTS.UPDATE_PANEL_STATUS,{RID:i,SHEETID:s,VERSION:a,CHART_ID:e,STATUS:!0})}(e),(t=T.Manager.SidePanelManager).RECOMMENDATION=!t.RECOMMENDATION,t.TABEL_DEFINATION=!0,t.initPanelManager(),setTimeout(function(){l.publish(r.UI,C.SidePanel.CHARTS.METACONVERSION,{CHART_ID:e});var t=T.Manager.SidePanelManager;t.getActiveMeta()&&t.getActiveMeta().isPivotChart?(B(!0),a.construct(t.getActiveMeta().pivotId)):B(!1),t.RECOMMENDATION&&l.publish(r.UI,C.SidePanel.CHARTS.CALL_RECOMMENDATION,{CHART_ID:e}),t.TABEL_DEFINATION&&l.publish(r.UI,C.SidePanel.CHARTS.CALL_TABLE_DEFINITION,{CHART_ID:e}),l.publish(r.UI,C.SidePanel.CHARTS.REFRESH_SIDE_PANEL,{CHART_ID:e}),l.publish(r.UI,C.SidePanel.CHARTS.ACCORDION.SERIES.UPDATE),l.publish(r.UI,C.SidePanel.CHARTS.CLOSE_ALL_ACCORDIONS)},100)))}function f(){var e,a=T.Manager.SidePanelManager,n=a.getActiveChartID();t&&!a.rangeEditor.isEditing&&(t.close(),n&&0!=n.length||t.hide()),T.Client.Action.destroyContextualToolbar(),n&&T.Client.Action.removeBorderAnimation({ID:n[0]}),n&&T.Client.Action.resetChartSelection({ID:n[0]}),(e=T.Wrapper.DOMUtils).addClass(e.getElementByClassName("generalTab"),"active"),e.removeClass(e.getElementByClassName("builderTab"),"active"),e.removeClass(e.getElementByClassName("customTab"),"active")}function W(){var e,t=T.Manager.SidePanelManager;l.publish(r.UI,C.SidePanel.CHARTS.BLUR),P.select2("#chartAggCombo0",void 0,"destroy"),(e=T.Wrapper.DOMUtils).getElementById("rangeWrapper")&&(e.getElementById("rangeWrapper").innerHTML=""),e.hideById("rangeSelectorDiv"),e.hideByClassName("spDisabled"),t.setPanelStatus({open:!1,close:!0}),t.clearCache()}function Y(){0==A.Right.sidePanel&&0==A.Right.customSidePanelWidth?(A.Right.sidePanel=this.minWidth,A.Right.customSidePanelWidth=this.minWidth):A.Right.sidePanel=A.Right.customSidePanelWidth>=this.minWidth?A.Right.customSidePanelWidth:this.minWidth,this.holder.setWidth(A.Right.sidePanel),G(),K()}function K(){n.view.Events.Key.focusContext(v)}function w(){A.Right.sidePanel=0,this.holder.setWidth(0),document.activeElement.blur(),L.focusContext(L.Entry.CellEditor.Context),W()}function F(e){var t=T.Wrapper.DOMUtils,a=s.getTemplate(["COL_ICON","XYLINE_SCATTER_SHAPES_ICON","GROUPEDCOL_ICON","GROUPEDBAR_ICON","STACKEDCOL_ICON","STACKEDCOL_PERCENT_ICON","BAR_ICON","STACKEDBAR_ICON","STACKEDBAR_PERCENT_ICON","XYLINE_ICON","SPLINE_ICON","STEPCHART_ICON","PIE_ICON","SEMIPIE_ICON","DOUGHNUT_ICON","SEMIDOUGHNUT_ICON","XYAREA_ICON","XYSTACKEDAREA_ICON","XYSTACKEDAREA_PERCENT_ICON","SCATTER_ICON","XYLINE_SCATTER_ICON","BUBBLE_ICON","TIMELINE_ICON","TIMEAREA_ICON","CANDLESTICK_ICON","OHLCCHART_ICON","POLAR_ICON","SPIDERWEB_ICON","BULLETCOL_ICON","BULLETBAR_ICON","COMBOCHART_ICON","WATERFALL_ICON","FUNNEL_ICON","PARETO_ICON","HISTOGRAM_ICON","ANIMATION_CHART_ICON","WORDCLOUD_ICON"]),n=e||t.getElementById("chrtTypeWrapper");if(["COL","XYLINE_SCATTER_SHAPES","STACKEDCOL","GROUPEDCOL","GROUPEDBAR","STACKEDCOL_PERCENT","BAR","STACKEDBAR","STACKEDBAR_PERCENT","XYLINE","SPLINE","STEPCHART","PIE","SEMIPIE","DOUGHNUT","SEMIDOUGHNUT","XYAREA","XYSTACKEDAREA","XYSTACKEDAREA_PERCENT","SCATTER","XYLINE_SCATTER","BUBBLE","TIMELINE","TIMEAREA","CANDLESTICK","OHLCCHART","POLAR","SPIDERWEB","BULLETCOL","BULLETBAR","COMBOCHART","WATERFALL","FUNNEL","PARETO","HISTOGRAM","ANIMATION_CHART","WORDCLOUD"].forEach(function(e){var i=n.querySelector("#"+e).nextElementSibling;t.appendChild(i,a[e+"_ICON"])}),!e){a=s.getTemplate(["COL_ICON","BAR_ICON","XYLINE_ICON","PIE_ICON","STACKEDCOL_ICON","STACKEDBAR_ICON","SPLINE_ICON","SEMIPIE_ICON","STACKEDCOL_PERCENT_ICON","STACKEDBAR_PERCENT_ICON","STEPCHART_ICON","DOUGHNUT_ICON","GROUPEDCOL_ICON","GROUPEDBAR_ICON","TIMELINE_ICON","SEMIDOUGHNUT_ICON","XYAREA_ICON","XYSTACKEDAREA_ICON","XYSTACKEDAREA_PERCENT_ICON","TIMEAREA_ICON","COMBOCHART_ICON","BULLETCOL_ICON","BULLETBAR_ICON","PARETO_ICON","HISTOGRAM_ICON","WATERFALL_ICON","FUNNEL_ICON","WORDCLOUD_ICON"]);var i=t.getElementById("pivotChartTypeWrapper");["COL","BAR","XYLINE","PIE","STACKEDCOL","STACKEDBAR","SPLINE","SEMIPIE","STACKEDCOL_PERCENT","STACKEDBAR_PERCENT","STEPCHART","DOUGHNUT","GROUPEDCOL","GROUPEDBAR","TIMELINE","SEMIDOUGHNUT","XYAREA","XYSTACKEDAREA","XYSTACKEDAREA_PERCENT","TIMEAREA","COMBOCHART","BULLETCOL","BULLETBAR","PARETO","HISTOGRAM","WATERFALL","FUNNEL","WORDCLOUD"].forEach(function(e){i.querySelector("#"+e).nextElementSibling.appendChild(a[e+"_ICON"])})}}function X(){var e=s.getTemplate(["SP_CHART","SP_CHART_DATA_RANGE_OTHERS","DATARANGE_SELECTOR","SP_CHART_DATA_RANGE","SP_CHART_CHART_TYPES","SP_CHART_COLOR_SCHEME","SP_CHART_DATA_OPTIONS","SP_CHART_LEGEND_OPTIONS","SP_CHART_STYLES","SP_CHART_TITLES","SP_CHART_XAXIS","SP_CHART_YAXIS","SP_CHART_SERIES","SP_CHART_AGGREGATION","SP_CHART_FILTER","SP_CHART_COMBINED_RANGE","DATE_MENU_TEMPLATE","SP_CHART_PIVOT_TYPES"]),t=O.createElement("div");t.id="SPCHART",t.className="wid wid100 hgt100",t.appendChild(e.SP_CHART),this.panel.appendChild(t),this.panel.querySelector("#SPCHART");var C=t.querySelector("#spGeneralInnerDiv");C.appendChild(e.SP_CHART_CHART_TYPES),C.appendChild(e.SP_CHART_DATA_RANGE),C.appendChild(e.SP_CHART_COMBINED_RANGE),C.appendChild(e.DATARANGE_SELECTOR),C.appendChild(e.SP_CHART_DATA_OPTIONS),C.appendChild(e.SP_CHART_DATA_RANGE_OTHERS),C.appendChild(e.SP_CHART_AGGREGATION),C.appendChild(e.DATE_MENU_TEMPLATE),C.appendChild(e.SP_CHART_FILTER),(C=t.querySelector("#spChartInnerDiv")).appendChild(e.SP_CHART_PIVOT_TYPES),C.appendChild(e.SP_CHART_TITLES),C.appendChild(e.SP_CHART_LEGEND_OPTIONS),C.appendChild(e.SP_CHART_SERIES),C.appendChild(e.SP_CHART_XAXIS),C.appendChild(e.SP_CHART_YAXIS),C.appendChild(e.SP_CHART_STYLES),F();var A,d,I,o=t.querySelector("#titleAlign");A=o,I=[{id:(d=["TITLE_LEFT_ALIGNMENT","TITLE_CENTER_ALIGNMENT","TITLE_RIGHT_ALIGNMENT"])[0],data:'{"SVGIconId":"#alignmentIco svgWidHgt","label":"'+_["MenuItem.HomeTab.Align.Left"]+'", "direction":"left", "align":"halign", "itemType":"radio"}'},{id:d[1],data:'{"SVGIconId":"#centerAlignIco svgWidHgt","label":"'+_["MenuItem.HomeTab.Align.Center"]+'", "direction":"center", "align":"halign", "itemType":"radio"}'},{id:d[2],data:'{"SVGIconId":"#rightAlignIco svgWidHgt","label":"'+_["MenuItem.HomeTab.Align.Right"]+'", "direction":"right", "align":"halign", "itemType":"radio"}'}],n.view.Menu.create(I,{id:"TITLE_ALIGNMENT_POPUP","data-type":"list","data-content-type":"icon-text"},A),A.setAttribute("data-ctype","zsbutton"),A.setAttribute("data-menu-id","TITLE_ALIGNMENT_POPUP");var c=s.getTemplate(["SP_PIVOT","SPP_ERRORBLOCK","SPP_ERRORMSG_DIV","SPP_BUILDER"]);(C=t.querySelector("#spPivotChartInnerDiv")).appendChild(c.SP_PIVOT),(C=t.querySelector("#err")).appendChild(c.SPP_ERRORBLOCK),(C=t.querySelector("#errMaxField")).appendChild(c.SPP_ERRORMSG_DIV),(C=t.querySelector("#pivotGenTab")).appendChild(c.SPP_BUILDER),(a=new E.Pivot.BuilderModel(this.panel)).init(),t.addEventListener("mousedown",K),P.initComponent(t),function(){(p=T.Wrapper.DOMUtils).addEventByNode(p.getElementByClassName("builderTab"),"click",M),p.addEventByNode(p.getElementByClassName("generalTab"),"click",M),p.addEventByNode(p.getElementByClassName("customTab"),"click",M),p.addEventByNode(p.getElementById("closeChart"),"click",f);for(var e=p.getElementsByName("chartCustomAccordion"),t=0;t<e.length;t++)p.addEventByNode(e[t],"click",k);e=p.getElementsByName("chartGeneralAccordion");for(var t=0;t<e.length;t++)p.addEventByNode(e[t],"click",k);p.addEventByNode(p.getElementById("chartAggregation"),"click",x)}(),(new T.Manager.ZSCColorManager).initEvents(),l.publish(r.UI,i.Names.SidePanel.CHARTS.BINDEVENTS)}function k(e){for(var t=T.Wrapper.DOMUtils.getElementsByName("chartCustomAccordion"),a=0;a<t.length;a++)this!=t[a]&&(t[a].checked=!1),this!=t[a]&&t[a].classList.remove("selected");this.checked=!this.classList.contains("selected"),this.checked?this.classList.add("selected"):this.classList.remove("selected")}function x(){var e=T.Wrapper.DOMUtils;setTimeout(function(){e.getElementById("aggregationDiv").scrollIntoView({behavior:"smooth"})},200)}function V(e){var t=T.Manager.SidePanelManager;return y[e]?y[e].aTC:U(t.getActiveChartID())?y.CHART_DEFAULT.aTC:y.PIVOT_DEFAULT.aTC}function q(e){var t=T.Wrapper.DOMUtils;return y[e]&&y[e].aAN?t.getElements(y[e].aAN)[0]:null}function Z(){return T.Wrapper.DOMUtils.getElementById("CHART_RIGHT_PANEL_CONATAINER").querySelector(".spChrtTab").querySelector(".active")}function J(e){var t=T.Wrapper.DOMUtils,a=Z();if(!t.hasClass(a,e.cls))switch(t.removeClass(a,"active"),t.addClass(t.getElementByClassName(e.cls),"active"),e.name){case"custom":t.getElementById("spChartCustom").style="",t.getElementById("spPivotChartGeneral").style.display="none",t.getElementById("spChartGeneral").style.display="none";break;case"general":t.getElementById("spChartGeneral").style="",t.getElementById("spPivotChartGeneral").style.display="none",t.getElementById("spChartCustom").style.display="none";break;default:t.getElementById("spChartGeneral").style.display="",t.getElementById("spPivotChartGeneral").style="",t.getElementById("spChartCustom").style.display="none"}}function j(e,t){var a=e.querySelector("input"),n=new Event("click");a&&(t^a.classList.contains("selected")&&a.dispatchEvent(n))}L.Entry.RightPane.Node.addChildNode(v),l.register(r.UI,C.SidePanel.CHARTS.TOGGLE,function(){t&&t.toggle(),m=!m}),l.register(r.UI,C.SidePanel.CHARTS.OPEN,H,"CHART_ID","RECOMMENDATION","TABEL_DEFINATION"),l.register(r.UI,C.SidePanel.CHARTS.CHANGE_CHART_TYPE,function(e,a,n){t.alive?l.publish(r.UI,i.Names.SidePanel.CHARTS.TOGGLE_TO_NEEDED_TAB,{ev:void 0,TAB_NAME:"generalTab"}):H(e,0,n),setTimeout(function(){l.publish(r.UI,i.Names.SidePanel.CHARTS.TOGGLE_CHART_TYPES,{e:void 0,ACTION:"OPEN"})},110)},"CHART_ID","RECOMMENDATION","TABEL_DEFINATION"),l.register(r.UI,C.SidePanel.CHARTS.TOGGLE_TO_NEEDED_TAB,M,"ev","TAB_NAME"),l.register(r.UI,C.SidePanel.CHARTS.OPEN_ICON,function(e){!function(){try{if(T.Utility.getChartMeta(T.Utility.getActiveChart(),!0).getPivotState()){var e=s.getTemplate(["pivotChartIcon"]);t.icon.innerHTML="",t.icon.appendChild(e.pivotChartIcon),t.icon.title=_["Pivot.Toolbar.PivotChart"]}else e=s.getTemplate(["chartIcon"]),t.icon.innerHTML="",t.icon.appendChild(e.chartIcon),t.icon.title=_["MenuItem.InsertTab.Chart"]}catch(e){}}(),t&&t.show()}),l.register(r.UI,C.SidePanel.CHARTS.SETFOCUS,K),l.register(r.UI,C.SidePanel.CHARTS.CLOSE,f),l.register(r.UI,C.SidePanel.CHARTS.CLOSE_ICON,function(){t&&t.hide()}),l.register(r.UI,C.SidePanel.CHARTS.CLOSE_ALL_ACCORDIONS,function(){for(var e=p.getElementsByName("chartGeneralAccordion"),t=0;t<e.length;t++)e[t].checked=!1,e[t].classList.remove("selected");for(e=p.getElementsByName("chartCustomAccordion"),t=1;t<e.length;t++)e[t].checked=!1,e[t].classList.remove("selected")}),l.register(r.UI,C.Layout.TEMPLATE_LOADED,function(){e.isCraftGrid||setTimeout(function(){var e;(t=I.add({panelName:"CHART",onCreate:D,callBack:X,allowed:c,direction:S,isContextualPanel:!0,minWidth:320,maxWidth:500})).onOpen=Y,t.onClose=w,t.hide(),(e=v.keyDown)[N.ESC]=function(){var e=T.Manager.SidePanelManager;return e.hideRangeDialogForSP(),!1},e[N.SUPER+"+"+N.Z]=function(e){return h.execute(e),!1},e[N.SUPER+"+"+N.Y]=function(e){return u.execute(e),!1}},1e3)}),l.register(r.Listener,C.UserAction.CHARTS.RESET_MENU,function(e){e.length>1&&f()},"ACTIVE_CHART_ID"),l.register(r.UI,C.SidePanel.CHARTS.ACCORDION.OPEN,function(e){var t=V(e),a=q(e);J(t),a&&j(a,!0)},"NAME"),l.register(r.UI,C.SidePanel.CHARTS.ACCORDION.CLOSE,function(e){var t=V(e),a=q(e);J(t),a&&j(a,!1)},"NAME"),l.register(r.UI,C.SidePanel.CHARTS.LINKED_ICON,F,"PARENT"),l.register(r.Listener,C.UserAction.PIVOT.CHANGE_CREATEPIVOT_BUTTON,function(e,t){a&&a.changeCreatePivotBt(e,t)},"setToGenerate","isDisable"),l.register(r.UserAction,C.UserAction.PIVOT.HANDLE_ERROR,function(e){a&&a.handleError(e)},"ERRORMSG"),l.register(r.UI,C.Layout.DEFER_JS_LOADED,function(){var e=[R+"../../js/select2.min.js"],t=[R+"../../styles/grey/select2.min.css"];s.loadDependency(e),s.loadCSS(t)})}(this);
!function(e){var t=e.sPlusPlus,r=e.ZSEvents,i=r.topic,n=r.Groups,o=r.Names,a=e.ZSConstants.FeatureConstants,s=t.view.Toolbar.Feature[a.CHART],c=e.ZSConstants.I18N,l=e.ZSChart,h=(a=e.ZSConstants.FeatureConstants,e.ZSDevTools.Logger),p=null,d=!1,g=null,u=null,v="#13ad6b";function C(){l.Model.Dialog.call(this),this.init()}function R(){var e=t.view.getActiveGridID(),r=(t.view.getResourceID(e),t.view.getVersionID(e),t.view.getSheetID(e));return t.view.getSheetState(e,r).getRanges()}function A(e){for(var t=[],r=e?e.length:0,i=0;i<r;i++)t.push(e[i].getLabel());return t.join(";")}function f(e){for(var t=e.split(";"),r="",i=0;i<t.length;i++){var n=t[i].split(".");r=0==r.length?r:r+";",r+=n[1]||n[0]}return r}function P(e){var r=e.dataRange;u=f(r.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";")),function(){if(!p)return}.call(this);var i=t.view.getActiveGridID();E(t.view.getResourceID(i),t.view.getVersionID(i),u,v)}function I(e){try{var t=e.length,r=e[0];return 1==t&&r.startRow==r.endRow&&r.startCol==r.endCol}catch(e){return!1}}function E(e,t,r,i){ZSZIA.Client.Range.Highlight.REMOVE.fn.call(this);var n=1;r.trim().split(";").forEach(function(r){var o=JSUtil.Range.parseRange(e,t,r);o&&ZSZIA.Client.Range.Highlight.ADD.fn.call(this,n,o.range,i),n++})}C.prototype=new l.Model.Dialog,C.prototype.getSourceRange=function(){return u||(u=A(R())),u},C.prototype.processResponse=function(e){this.setResposne(e);try{this.preProcess(),this.postProcess()}catch(e){this.doFallbackCase()}},C.prototype.processMuteResponse=function(e){this.setResposne(e);try{this.preProcess(),this.postMuteProcess()}catch(e){this.doFallbackCase()}},C.prototype.doFallbackCase=function(){try{var e=null;if((e=(new l.Utility.ChartAgent).isArray(this.responseObj)?this.responseObj.shift():this.responseObj)&&e.reason)return throws.err;this.grabProperty(e),this.alertInvalidRecommendation()}catch(t){this.alertForInvalidCase(e)}},C.prototype.alertForInvalidCase=function(e){try{var t,r=e.reason,a="",s=r.ice,l=r.iad;s&&(a=JSUtil.fn.replaceParams(c["Chart.Cells.Count.Exceeded"],new Array("5000"))),s&&(t=c["Alert.Title.LimitExceeded"]),s||l||(msgObj=this.generateAlertMessage(r),a=msgObj.msg,t=msgObj.titleKey),ZSClass.ZSAlert(a,{title:t})}catch(e){}i.publish(n.UI,o.Toolbar.CHART.POPUP.CLOSE)},C.prototype.getAlertForRecommendationMsg=function(e){try{(new l.Utility.ChartAgent).isArray(this.responseObj)&&(e=this.responseObj.shift());var t=e.reason,r="",i=t.ice,n=t.iad;return i&&(r=JSUtil.fn.replaceParams(c["Chart.Cells.Count.Exceeded"],new Array("5000"))),!i&&!n&&(r=this.generateAlertMessage(t).msg),r}catch(e){return c["Chart.RecommendationAlertText"]}},C.prototype.getChartNameByChartCode=function(e){return f(e.dataRange)},C.prototype.preProcess=function(){var e=this.responseObj;if(!e.length)return throws.err;for(var t=0;t<e.length;t++){var r,i=e[t];t&&(r=this.chartId+t),!t&&(r=this.chartId),t&&this.id.push(r),i.co&&i.co.chart&&(i.co.chart.renderTo=r)}},C.prototype.doRecommendationTask=function(e,t){var r=[];e.length&&(r=e),!e.length&&r.push(e);var i=1|t.startIndex,n=!1|t.isShift;try{n&&r.shift(),this.renderRecommendation(r,i)}catch(e){h.log("[CHART] Chart Recommendation Task Throwing exception while redering chart in popover"),this.alertInvalidRecommendation()}},C.prototype.alertInvalidRecommendation=function(){var e=l.Wrapper.DOMUtils,t=s.getRecommendationHolder(),r=t.querySelector("#RECOMMENDALERT"),a=t.querySelector("#recommendChartPreview"),c=s.getFooterBar();r.setAttribute("noChart","true"),e.hide(a),e.show(r);var p=this.getAlertForRecommendationMsg(this.responseObj);c.innerText=p,i.publish(n.UI,o.Toolbar.CHART.POPUP.SELECT,{ID:"COLMENU"}),h.log("[Chart] >>>>>>>>>> Chart Alert Messgae >>>>>>>>>>")},C.prototype.setRecommendationSelection=function(){var e=this,t=s.getRecommendationHolder(),r=l.Wrapper.DOMUtils;this.dialogMeta&&Object.keys(this.dialogMeta).forEach(function(i){var n=f(e.dialogMeta[i].dataRange),o=t.querySelector("#"+i).nextElementSibling;!function(e){return this.getSourceRange()==e}.call(e,n)?r.show(o):r.hide(o)})},C.prototype.renderRecommendation=function(e,t){var r=e.shift();r&&r.co&&(r=this.trimChartData(r),this.recommendChart(r,t,this).then(function(){this.renderRecommendation(e,++t)}.bind(this)))},C.prototype.recommendChart=function(e,r,i){return new Promise(function(n,o){var a,c,h,p=l.Wrapper.DOMUtils,d=e;h={class:"recWrapper1","border-color":"rgb(25, 175, 92)",width:"50px",height:"50px"};var g=s.getRecommendationHolder().querySelector("#recommendChartPreview"),u=p.createElement("chartWrapperDiv",h);c=i.id[r],d.type,g.appendChild(u),h={class:"recChartDiv",id:c,style:"height : inherit;width:inherit;","data-id":c},a=p.addChildByIndex("chartDiv",u,h,r-1);var C=function(e){try{return e.co.title.text}catch(e){}return null}(e);a.setAttribute("title",C);var R=t.view.getActiveGridID(),A=t.view.getResourceID(R),f=t.view.getVersionID(R);t.view.getSheetID(R);p.addEventByNode(a,p.Events.MOUSEOVER,function(){var t=e.dataRange;E(A,f,t),u.style.border="1px solid #13AD6B"}),p.addEventByNode(a,p.Events.MOUSELEAVE,function(){u.style.border="1px solid #e9e9e9",E(A,f,i.getSourceRange(),v)}),h={class:"recChartName",id:"tooltip"+r,"data-id":c};var P=p.addChildByIndex("chartNameDiv",u,h,r-1);p.addEventByNode(P,p.Events.MOUSEOVER,function(){var t=e.dataRange;E(A,f,t),u.style.border="1px solid #13AD6B"}),p.addEventByNode(P,p.Events.MOUSELEAVE,function(){u.style.border="1px solid #e9e9e9",E(A,f,i.getSourceRange(),v)}),P.addEventListener("click",function(e){i.setActiveID(c),i.insertChart(c),e.stopPropagation()},!1),a.addEventListener("click",function(e){i.setActiveID(c),i.insertChart(c),e.stopPropagation()},!1),P.innerText=i.getChartNameByChartCode(e),i.grabProperty(e),i.addDefaultIntelligence(c),e=i.removeUnwantedProperties(e),i.createPreview(c,e,{forChartRecommendation:!0}),setTimeout(function(){n()},10)})},C.prototype.addDefaultIntelligence=function(e){this.dialogMeta[e||this.getActiveID].addDefaultIntelligence()},C.prototype.insertChart=function(e){var r=this.dialogMeta[e||this.getActiveID()];r?(new l.Utility.CommanAgent).checkIfDataApplicableForChartType(r,!0)?(function(){var e=this.getRequestObject(r,"new"),i=t.view.getActiveGridID(),n=t.view.getResourceID(i),o=t.view.getVersionID(i),a=t.view.getSheetID(i);l.Server.Action.updateChartOnGrid(n,a,o,e)}.call(this),i.publish(n.UI,o.Toolbar.CHART.POPUP.CLOSE),ZSZIA.Client.Range.Highlight.REMOVE.fn.call(this)):ZSClass.ZSAlert(c["Chart.Not.Allowed"]):h.log("[CHART] >>>>>>>> Active Meta Unavailable ",e||this.getActiveID())},C.prototype.insertChartByDataRange=function(e){var r=this.dialogMeta[e||this.getActiveID()];if(r)if((new l.Utility.CommanAgent).checkIfDataApplicableForChartType(r,!0)){var a=t.view.getActiveGridID(),s=t.view.getResourceID(a),d=t.view.getVersionID(a),g=t.view.getSheetID(a),v=[];u.trim().split(";").forEach(function(e){v.push(JSUtil.Range.parseRange(s,d,e).range)}),l.Server.Action.insertChartForRange(s,g,d,[v],"CHART_DETAILS",function(e,t){!function(e,t){try{if(i.publish(n.UI,o.Toolbar.CHART.POPUP.PROCESSRESPONSE,{RESPONSE:e,MUTE_ACTION:!0}),!p)return;p.setType(t),p.insertChart()}catch(e){}i.publish(n.UI,o.Toolbar.CHART.POPUP.CLEAR)}(e,t)},r.getType()),i.publish(n.UI,o.Toolbar.CHART.POPUP.CLOSE)}else ZSClass.ZSAlert(c["Chart.Not.Allowed"]);else h.log("[CHART] >>>>>>>> Active Meta Unavailable ",e||this.getActiveID())},C.prototype.grabProperty=function(e){var t=new l.Model.DialogMeta,r=e.co.chart.renderTo;t.constructPropertyFromObject(e),this.addMetaObject(r,t)},C.prototype.postProcess=function(){var e=s.getRecommendationHolder().querySelector("#recommendChartPreview");l.Wrapper.DOMUtils.show(e),this.doRecommendationTask(this.responseObj,{startIndex:1,isShift:!0}),this.setActiveID("preview1"),this.clearResposne()},C.prototype.postMuteProcess=function(){var e=this.responseObj.shift();this.setActiveID(this.chartId),p.grabProperty(e),this.clearResposne()},C.prototype.setType=function(e){this.dialogMeta[this.getActiveID()].setType(e)},C.prototype.getActiveID=function(){return this.activeId},C.prototype.setActiveID=function(e){this.activeId=e},C.prototype.createPreview=function(e,t,r){var i=l.Action.createPreview(e,t,r);this.dialogMeta[e].setInstance(i)},i.register(n.UI,o.Toolbar.CHART.POPUP.CLEAR,function(){p=null,d=!1,u=null,g=null,ZSZIA.Client.Range.Highlight.REMOVE.fn.call(this)}),i.register(n.UI,o.Toolbar.CHART.POPUP.OPEN,function(){i.publish(n.UI,o.Toolbar.CHART.POPUP.CLEAR),i.publish(n.UI,o.Toolbar.CHART.POPUP.LOADER.SHOW),d=!0;var e=t.view.getActiveGridID(),r=t.view.getResourceID(e),a=t.view.getVersionID(e),s=t.view.getSheetID(e);(function(){var e=R(),t=new l.Utility.ChartAgent;I(e)&&t.detectTable(e[0],P.bind(this),function(){}),!I(e)&&P({dataRange:A(e)})}).call(this),l.Server.Action.fetchChart(r,s,a,"CHART_DETAILS",!1,function(e){i.publish(n.UI,o.Toolbar.CHART.POPUP.PROCESSRESPONSE,{RESPONSE:e})},t.view.Toolbar.showChartPopup)}),i.register(n.UI,o.Toolbar.CHART.POPUP.PROCESSRESPONSE,function(e,t){d&&(i.publish(n.UI,o.Toolbar.CHART.POPUP.LOADER.HIDE),(p=new C).processResponse(e)),t&&(p=new C).processMuteResponse(e)},"RESPONSE","MUTE_ACTION"),i.register(n.UI,o.Toolbar.CHART.POPUP.EDIT,function(e){p&&(p.setType(e),p.insertChartByDataRange())},"TYPE"),i.register(n.UI,o.Toolbar.CHART.POPUP.SETDATASOURCE,function(e){if(p){g||(g=e.innerHTML);var t=l.Wrapper.DOMUtils,r=t.createElement("span"),i=t.createElement("span");r.innerText=ZSConstants.I18N.DataRange,i.innerText=": "+p.getSourceRange(),r.classList.add("fntBld"),e.innerHTML="",t.appendChild(e,r),t.appendChild(e,i)}},"HOLDER"),i.register(n.UI,o.Toolbar.CHART.POPUP.SETRECOMMENDATIONSOURCE,function(e,t){(g||t)&&(e.innerHTML=t||g)},"HOLDER","VALUE")}(this);
!function(e){var t,i,n,s,o,a,r,c,l,u,h,p=e.sPlusPlus,g=e.UserAction,v=e.ZSClass,d=e.ZSConstants.JSKeyCode,f=v.Editors,E=v.RangePicker,P=JSUtil.REGEXP,m=P.matchRegex,R=P.rangeRegex,D=e.ZSEvents,C=D.topic,y=D.Groups,S=D.Names,k=72,w=382,L=document.createElement("div");function O(e,t,i){var n=0,s=p.view.getActiveGridID(),o=p.view.getResourceID(s),a=p.view.getVersionID(s),r=e.match(m),c=0;for(var l in t>i&&(t+=i,t-=i=t-i),r){var u=r[l];if(R.test(u))if(JSUtil.Range.parseRange(o,a,u)){if(c<=t&&i<=c+u.length){C.publish(y.Listener,S.RangePicker.Modify,{index:n});break}n++}c+=u.length}}function T(e){if(13===(e.keyCode||e.which))return e.preventDefault(),e.stopPropagation(),U(e),!0}function x(t,i,n,s,o,p,d){(function(e){var t=g.getTemplate(["RangePickerOut"]).RangePickerOut,i=document.createElement("div");i.className="ui-dialog rPDialog",i.appendChild(t);var n=i.querySelector(".rPhead"),s=i.querySelector(".rPin"),o=i.querySelector(".rPpopin"),a=new f.RangeEditor(s);a.customPreventDefault=T,v.RangePicker.register(a),e.appendChild(i),this.Dom=i,this.input=a,this.popin=o,this.title=n}).call(this,t),this.alive=!0,this.close(),this.width=s,this.height=o,this.onOpen=p,this.onClose=d,this.place(i,n);var E=this;this.Dom.addEventListener("mousedown",function(t){t.target===this&&function(t,i){a=i,r=t,c=t.left,l=t.top,h=e.innerHeight-t.height,u=e.innerWidth-t.width,i.preventDefault(),e.addEventListener("mousemove",q),e.addEventListener("mouseup",J)}(E,t),M()}),this.popin.addEventListener("click",function(){E.close()})}function A(){var e=s.value,t=s.selectionStart,n=s.selectionEnd;o.hide(),this.input.RangePickerOptions=s.RangePickerOptions,this.input.focus(),this.input.value=e,this.input.valueChanged(),this.input.setSelectionRange(t,n),this.input.selectionChanged();var a=s.RangePickerOptions.title;this.setTitle(a),i=!0,O(e,t,n),M()}function N(){var e=this.input.value,t=this.input.selectionStart,a=this.input.selectionEnd;o.show(),s.focus(),s.value=e,s.valueChanged(),s.setSelectionRange(t,a),s.selectionChanged(),n=!1,i=!1,O(e,t,a)}L.className="rPcon",document.body.appendChild(L),x.prototype={place:function(e,t){this.left=e,this.top=t,this.Dom.style.left=e+"px",this.Dom.style.top=t+"px"},setTitle:function(e){this.title.innerText=e},open:function(){this.alive||(this.Dom.style.display="",this.onOpen&&this.onOpen.call(this),this.alive=!0)},close:function(){this.alive&&(this.Dom.style.display="none",this.onClose&&this.onClose.call(this),this.alive=!1)}};var G=e.sPlusPlus.view.Events.Key.Entry.RangePickerDialog.Context,I=G.keyDown;function U(e,i,n,s){return e.preventDefault(),t.close(),!1}function M(){e.sPlusPlus.view.Events.Key.focusContext(G)}function b(e,t,i){return t=Math.max(e,t),t=Math.min(t,i)}function q(e){var t=e.pageX-a.pageX,i=e.pageY-a.pageY,n=c+t,s=i+l;n=b(0,n,u),s=b(0,s,h),r.place(n,s)}function J(t){e.removeEventListener("mousemove",q),e.removeEventListener("mouseup",J)}function K(){i&&!n&&t.close()}I[d.ENTER]=U,I[d.ESC]=U,I[d.PURE_PRINTABLE_CHAR]=function(){return!1},E.Dialog={register:function(e,i,a,r){a&&a.addEventListener("mousedown",function(a){a.preventDefault(),a.stopPropagation(),s=e,o=i,n=!0,t.open()}),e.addListeners({focus:function(t){o=i,s=e}}),e.RangePickerOptions.title=r}},C.register(y.UI,S.Layout.TEMPLATE_LOADED,function(){t=new x(L,(e.innerWidth-w)/2,100,w,k,A,N)}),C.register(y.Gesture.Selector.RangePicker,S.GESTURE.ACTION.MOVE,function(){E.isActiveOn(s)&&!n&&t.open()}),C.register(y.Gesture.Selector.RangePicker,S.GESTURE.ACTION.END,K),C.register(y.Listener,S.RangePicker.Disable,K)}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Events.Key.Entry.ShortCut.Context.keyDown,o=t.ZSConstants.JSKeyCode,u=e.view.Toolbar.Feature[s.CUT];n[o.SUPER+"+"+o.X]=u.execute}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Events.Key.Entry.ReadOnlyShortCut.Context.keyDown,o=t.ZSConstants.JSKeyCode,a=e.view.Toolbar.Feature[n.COPY];s[o.SUPER+"+"+o.C]=a.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Events.Key.Entry.ShortCut.Context.keyDown,o=t.ZSConstants.JSKeyCode,u=e.view.Toolbar.Feature[s.PASTE];n[o.SUPER+"+"+o.V]=u.executeShortCut,n[o.SUPER+"+"+o.SHIFT+"+"+o.V]=u.executeShortCut}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Events.Key.Entry.ShortCut.Context.keyDown,o=t.ZSConstants.JSKeyCode,u=e.view.Toolbar.Feature[s.UNDO];n[o.SUPER+"+"+o.Z]=u.execute}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSConstants.FeatureConstants,n=t.view.Events.Key.Entry.ShortCut.Context.keyDown,o=e.ZSConstants.JSKeyCode,u=t.view.Toolbar.Feature[s.REDO];n[o.SUPER+"+"+o.Y]=u.execute,n[o.SUPER+"+"+o.SHIFT+"+"+o.Z]=u.execute,n[o.ALT+"+"+o.ENTER]=u.executeRepeat}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.BOLD],o=e.view.Events.Key.Entry.ShortCut.Context.keyDown,u=t.ZSConstants.JSKeyCode;o[u.SUPER+"+"+u.B]=n.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.ITALIC],o=e.view.Events.Key.Entry.ShortCut.Context.keyDown,u=t.ZSConstants.JSKeyCode;o[u.SUPER+"+"+u.I]=n.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.UNDERLINE],o=e.view.Events.Key.Entry.ShortCut.Context.keyDown,u=t.ZSConstants.JSKeyCode;o[u.SUPER+"+"+u.U]=n.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.STRIKETHROUGH],o=e.view.Events.Key.Entry.ShortCut.Context.keyDown,u=t.ZSConstants.JSKeyCode;o[u.SUPER+"+"+u.SHIFT+"+"+u.X]=n.execute}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,r=e.view.Toolbar.Feature[n.DATE],s=e.view.Events.Key.Entry.ShortCut.Context.keyDown,S=t.ZSConstants.JSKeyCode;s[S.SUPER+"+"+S.SEMICOLON]=r.currentDate,s[S.SUPER+"+"+S.SHIFT+"+"+S.SEMICOLON]=r.currentTime,s[S.SUPER+"+"+S.ALT+"+"+S.SEMICOLON]=r.currentDateAndTime}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.CURRENCY],o=(e.view.Events.Key.Entry.ShortCut.Context.keyDown,t.ZSConstants.JSKeyCode);t.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown[o.CTRL+"+"+o.SHIFT+"+"+o.FOUR]=n.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.PERCENTAGE],o=t.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown,u=t.ZSConstants.JSKeyCode;o[u.CTRL+"+"+u.SHIFT+"+"+u.FIVE]=n.execute}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.FILTER],o=e.view.Events.Key.Entry.ShortCut.Context.keyDown,r=t.ZSConstants.JSKeyCode;o[r.SUPER+"+"+r.SHIFT+"+"+r.L]=n.execute,o[r.SUPER+"+"+r.ALT+"+"+r.L]=n.reApply}(this);
!function(e){var t=e.sPlusPlus,s=(t.view.Events.Key,e.ZSClass,e.ZSConstants),n=s.FeatureConstants,u=s.JSKeyCode,o=t.view.Toolbar.Feature[n.PICKFROMLIST];e.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown[u.ALT+"+"+u.DOWN]=o.execute}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants,s=n.FeatureConstants,o=e.view.Events.Key.Entry.ShortCut.Context,a=n.JSKeyCode,i=o.keyDown,u=e.view.Toolbar.Feature[s.AUTOCOMPLETE];i[a.CTRL+"+"+a.SHIFT+"+"+a.Q]=function(){u.isEnabled=!u.isEnabled}}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.HIDE_ROWS],o=e.view.Events.Key.Entry.ShortCut.Context.keyDown,u=t.ZSConstants.JSKeyCode;o[u.SUPER+"+"+u.SHIFT+"+"+u.NINE]=function(t){t.preventDefault(),s.show()},o[u.SUPER+"+"+u.ALT+"+"+u.NINE]=function(t){t.preventDefault(),s.hide()}}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.HIDE_COLUMNS],o=e.view.Events.Key.Entry.ShortCut.Context.keyDown,u=t.ZSConstants.JSKeyCode;o[u.SUPER+"+"+u.SHIFT+"+"+u.ZERO]=function(t){t.preventDefault(),s.show()},o[u.SUPER+"+"+u.ALT+"+"+u.ZERO]=function(t){t.preventDefault(),s.hide()}}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants;e.view.Events.Key.Entry.ShortCut.Context.keyDown,t.ZSConstants.JSKeyCode,e.view.Toolbar.Feature[s.THOUSAND_SEPARATOR]}(this);
!function(t){var s=t.sPlusPlus,e=t.ZSConstants.FeatureConstants;s.view.Toolbar.Feature[e.FORMATCELLS],t.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown,t.ZSConstants.JSKeyCode}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Events.Key.Entry.ShortCut.Context.keyDown,o=t.ZSConstants.JSKeyCode,a=e.view.Toolbar.Feature[n.DEFINE_NAME];s[o.SUPER+"+"+o.F3]=a.openDialog}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,o=e.view.Toolbar.Feature[n.GOTO],s=e.view.Events.Key.Entry.ReadOnlyShortCut.Context.keyDown,a=t.ZSConstants.JSKeyCode;s[a.SUPER+"+"+a.G]=o.openDialog,s[a.SUPER+"+"+a.SHIFT+"+"+a.G]=o.openDialog}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,o=e.view.Toolbar.Feature[n.OPEN],s=e.view.Events.Key.Entry.ReadOnlyShortCut.Context.keyDown,a=t.ZSConstants.JSKeyCode;s[a.SUPER+"+"+a.O]=o.openDialog,s[a.CTRL+"+"+a.O]=o.openDialog}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Toolbar.Feature[s.PRINT],a=e.view.Events.Key.Entry.ReadOnlyShortCut.Context.keyDown,o=t.ZSConstants.JSKeyCode;-1==ZSConstants.Meta.DisableFeaturesList.indexOf(s.PRINT)&&(a[o.SUPER+"+"+o.P]=n.openDialog)}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.SAVEAS],o=e.view.Events.Key.Entry.ShortCut.Context.keyDown,S=t.ZSConstants.JSKeyCode;o[S.SUPER+"+"+S.SHIFT+"+"+S.S]=s.openDialog}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.FeatureConstants,n=e.view.Events.Key.Entry.ShortCut.Context.keyDown,o=t.ZSConstants.JSKeyCode,u=e.view.Toolbar.Feature[s.AUTOSUM];n[o.ALT+"+"+o.EQUAL]=u.executeSum}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Events.Key.Entry.ShortCut.Context.keyDown,o=t.ZSConstants.JSKeyCode,a=e.view.Toolbar.Feature[n.MANAGE_MACRO];s[o.ALT+"+"+o.F8]=a.openDialog}(this);
!function(t){var s=t.sPlusPlus,e=t.ZSConstants.FeatureConstants,n=s.view.Events.Key.Entry.ReadOnlyShortCut.Context.keyDown,o=t.ZSConstants.JSKeyCode,a=(s.view.Toolbar.Feature[e.VBA_EDITOR],o=t.ZSConstants.JSKeyCode,t.ZSEvents),r=a.topic,i=a.Groups,u=a.Names;n[o.ALT+"+"+o.F11]=function(){r.publish(i.UserAction,u.UserAction.MACRO.OPEN_MACRO_EDITOR,{modName:"Macros"})}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants.FeatureConstants,s=t.view.Toolbar.Feature[n.ZOOM],r=t.view.Events.Key.Entry.ReadOnlyShortCut.Context.keyDown,S=e.ZSConstants.JSKeyCode;r[S.SUPER+"+"+S.ADD]=s.Increment,r[S.SUPER+"+"+S.EQUAL]=s.Increment,r[S.SUPER+"+"+S.SUBTRACT]=s.Decrement,r[S.SUPER+"+"+S.MINUS]=s.Decrement,r[S.SUPER+"+"+S.ZERO]=s.setDefault}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSConstants.FeatureConstants,s=t.view.Toolbar.Feature[o.CLEAR_ALL],E=(t.view.Toolbar.Feature[o.CLEAR_ALL+"_Contents"],t.view.Toolbar.Feature[o.CLEAR_ALL+"_Formats"]),n=t.view.Events.Key.Entry.ShortCut.Context.keyDown,C=e.ZSConstants.JSKeyCode;n[C.SUPER+"+"+C.BACKSPACE]=s.execute,n[C.SUPER+"+"+C.DELETE]=s.execute,n[C.SHIFT+"+"+C.BACKSPACE]=E.execute,n[C.SHIFT+"+"+C.DELETE]=E.execute}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.FORMAT_PAINTER];e.view.Events.Key.Entry.ShortCut.Context.keyDown[t.ZSConstants.JSKeyCode.ESC]=s.negateFormatPainter}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.NEW_FILE],o=e.view.Events.Key.Entry.ShortCut.Context.keyDown,a=t.ZSConstants.JSKeyCode;o[a.SUPER+"+"+a.N]=s.createNewDocument,o[a.CTRL+"+"+a.N]=s.createNewDocument}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.COMMENTS],o=e.view.Events.Key.Entry.ShortCut.Context.keyDown,C=t.ZSConstants.JSKeyCode;o[C.SUPER+"+"+C.ALT+"+"+C.M]=s.openAndAddComment}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,o=e.view.Toolbar.Feature[n.FIND],s=e.view.Events.Key.Entry.ReadOnlyShortCut.Context.keyDown,u=t.ZSConstants.JSKeyCode;s[u.SUPER+"+"+u.SHIFT+"+"+u.H]=function(t){t.preventDefault(),o.openDialog()},s[u.SUPER+"+"+u.F]=function(t){t.preventDefault(),o.quickFind(!0)}}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=t.ZSConstants.JSKeyCode,o=e.view.Toolbar.Feature[n.HYPERLINK];e.view.Events.Key.Entry.ShortCut.Context.keyDown[s.SUPER+"+"+s.K]=o.openDialog}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,s=e.view.Toolbar.Feature[n.RECALCULATE];e.view.Events.Key.Entry.ShortCut.Context.keyDown[t.ZSConstants.JSKeyCode.F9]=function(t,e,n,o){t.repeat||s.execute(t,e,n,o)}}(this);
!function(e){var t=e.sPlusPlus,s=e.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown,n=e.ZSConstants.JSKeyCode,o=e.ZSConstants.FeatureConstants,u=t.view.Toolbar.Feature[o.NOTE];s[n.SHIFT+"+"+n.F2]=function(e,t,s,n){u.isSingleRange()&&!u.isLockedRange()&&u.execute(e,t,s,n)}}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants,o=(e.view.Toolbar.Feature[n.PRINT],e.view.Events.Key.Entry.ReadOnlyShortCut.Context.keyDown),s=t.ZSConstants.JSKeyCode,r=t.UIUtil.Component;o[s.SUPER+"+"+s.SLASH]=function(){r.zpopover(".sTKeyBrd","open")}}(this);
!function(t){var e=t.sPlusPlus,s=t.sPlusPlus.view.Events.Key.Entry.ShortCut.Context.keyDown,n=t.ZSConstants.JSKeyCode,o=t.ZSConstants.FeatureConstants,u=e.view.Toolbar.Feature[o.INSERT_SHEET];s[n.SHIFT+"+"+n.F11]=function(t,e,s,n){u.execute(t,e,s,n)}}(this);
!function(e){var t,a=e.sPlusPlus,i=e.ZSClass,n=a.view.measures,r=(i.SidePanelUtility,e.UIUtil.Component),o=e.ZSConstants.FeatureConstants,s=e.ZSEvents,c=s.topic,u=s.Groups,l=s.Names,d=document.getElementById("popupmenu"),m=a.view.Toolbar.Feature[o.NOTE_SHOW_HIDE],h=a.view.Toolbar.Feature[o.USER_PRESENCE],b=a.view.Toolbar.Feature[o.HIGHLIGHT_LOCKS],p=a.view.Toolbar.Feature[o.HIGHLIGHT_DATA_VALIDATION],v=a.view.Toolbar.Feature[o.COMMENTS],w=e.ZSConstants.I18N;e.ZSConstants.wCC;function T(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),i=a.view.getSheetID(e),n=a.view.getVersionID(e);UserAction.UpdateScreenViewPort(t,i,n),UserAction.DummyScroll(t,i,n)}c.register(u.UI,l.Layout.TEMPLATE_LOADED,function(){(t=document.createElement("ul")).id="sidePanelViewSetting",t.setAttribute("data-ctype","zmenu"),t.setAttribute("data-content-type","icon-text"),function(e){var t,a;t=e,(a=document.createElement("li")).setAttribute("data-value","showText"),a.setAttribute("data-item-type","checkbox"),a.innerText=w["Viewsettings.sidebar"],t.appendChild(a),function(e){var t=document.createElement("li");t.setAttribute("data-value","showFormulaBar"),t.setAttribute("data-item-type","checkbox"),t.setAttribute("data-checked",!0),t.innerText=w["Viewsettings.formulabar"],e.appendChild(t)}(e),function(e){var t=document.createElement("li");t.setAttribute("data-value","showSheetTabs"),t.setAttribute("data-item-type","checkbox"),t.setAttribute("data-checked",!0),t.innerText=w["Viewsettings.sheettab"],e.appendChild(t)}(e),m&&m.createShowAllMenu(e),h&&h.createMenuElement(e),b&&function(e){var t=document.createElement("li");t.setAttribute("data-value","LockPattern"),t.setAttribute("data",'{"action":"LockPattern", "itemType": "checkbox", "label":"'+w["MenuItem.DataTab.Lock.Pattern"]+'"}'),t.setAttribute("data-checked",!0),e.appendChild(t)}(e),function(e){var t=document.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}(e),b&&b.createMenuElement(e),p&&p.createMenuElement(e),v&&v.createHighlightMenuElement(e)}(t),d.appendChild(t),r.bind(t,"zmenubeforeshow",function(){c.publish(u.UI,l.Toolbar.INIT_MENU,{DOM:t})}),r.bind(t,"zmenuitemclick",function(e,t){switch(t.data.value){case"showText":!function(e){var t=document.querySelector(".sPHldr");e.menuitem.prop("checked")?(n.Right.sidePanelBar=60,t.classList.add("spView")):(n.Right.sidePanelBar=50,t.classList.remove("spView")),T()}(t);break;case"showFormulaBar":!function(e){var t=document.querySelector("#formulaBar");e.menuitem.prop("checked")?(n.Top.formulaBar=24,t.style.display=""):(n.Top.formulaBar=0,t.style.display="none"),T()}(t);break;case"showHeader":break;case"showSheetTabs":!function(e){var t=document.querySelector(".sheetTabHldrCtn");e.menuitem.prop("checked")?(n.Bottom.sheetTabsBar=30,t.style.display=""):(n.Bottom.sheetTabsBar=0,t.style.display="none"),T()}(t);break;case"showUserPresence":!function(e){var t=!!e.menuitem.prop("checked");h.execute(t)}(t);break;case"highlightAllComments":v.triggerHighlightAllComments(t);break;case"highlightLocks":b&&b.execute(t);break;case"highlightInvalidData":p.execute(t);break;case"LockPattern":b&&b.togglePattern(t)}})})}(this);
!function(e){var t,n,i,l,a=e.sPlusPlus,s=(t=e.ZSEvents).topic,r=t.Groups,o=t.Names,c=e.ZSConstants,d=c.FeatureConstants,u=e.UserAction,p=e.ZSClass,h=a.view.measures,E=p.KeyMapping,S=(p=e.ZSClass).SidePanel,g=p.SidePanelClassList,y=[g.right,g.left,g.bottom],C=g.right,v=(e.ZSConstants.JSKeyCode,p.Editors,c.I18N),R=(s=(t=e.ZSEvents).topic,t.Groups),f=(o=t.Names,a.view.Toolbar.Feature[d.DATA_CLEANING]),A=!1,D=!1,P=!1,m=!1,I=!1;var N=new function(){E.call(this)},L=a.view.Events.Key;function T(){a.view.Events.Key.focusContext(N)}function _(){var e=u.getTemplate(["dcIcon"]);this.icon.appendChild(e.dcIcon);var t=v["MenuItem.DataTab.DC"]||"Data Cleaning";this.icon.setAttribute("title",t)}function b(){n&&(V(),n&&n.toggle(),n.alive||(U(),H(),n.hide(),W(""),P=!1,global.SA.Controller.SheetAppUIController.close()))}function G(){q("block"),f.highlightCurrentColumn(),0==h.Right.sidePanel&&0==h.Right.customSidePanelWidth?(h.Right.sidePanel=this.minWidth,h.Right.customSidePanelWidth=this.minWidth):h.Right.sidePanel=h.Right.customSidePanelWidth>=this.minWidth?h.Right.customSidePanelWidth:this.minWidth,this.holder.setWidth(h.Right.sidePanel),T(),D=!0,P=!0}function q(e){m&&(n.panel.querySelector("#sPDcNtf").style.display=e);I&&(i.style.display=e)}function k(){var e=a.view.getActiveGridID(),t=a.view.getVersionID(e),i=a.view.getResourceID(e),l=a.view.getSheetID(e);s.publish(R.Listener,o.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:i,SHEETID:l,VERSION:t,RANGEIDS:[200]}),q("none"),h.Right.sidePanel=0,n.holder.setWidth(0),L.focusContext(L.Entry.CellEditor.Context),D=!1}function w(){(i=document.createElement("span")).classList.add("ZsLoader"),i.style.display="none",this.panel.appendChild(i);var e=u.getTemplate(["DC_SP_HDR"]);this.panel.appendChild(e.DC_SP_HDR);var t=u.getTemplate(["DC_RANGE_TEMPLATE"]);this.panel.appendChild(t.DC_RANGE_TEMPLATE),this.panel.classList.add("sPDatCln"),function(){var e=n.panel,t=e.querySelector("#dcBtns").children,i=t[1].children;t[0].addEventListener("click",M),i[0].addEventListener("click",Z),i[1].addEventListener("click",V);var a=e.querySelector("#dcCellRef");e.querySelector(".zsRangePicker").classList.add("zRDisable"),l=new p.Editors.RangeEditor(a),p.RangePicker.register(l,!0),e.querySelector("#dcPanelClose").addEventListener("click",f.togglePanel)}()}function H(){m=!1;var e=n.panel.querySelector("#sPDcNtf");e&&(e.style.display="none")}function W(e){l&&(l.value=e)}function O(){i&&D&&(I=!0,i.style.display="block")}function U(){i&&(I=!1,i.style.display="none")}function M(){var e=n.panel;e.querySelector("#dcSrc").classList.add("editRange"),e.querySelector(".zsRangePicker").classList.remove("zRDisable"),e.querySelector("#dcCellRef").focus(),this.style.display="none",e.querySelector("#dcSaveCnl").style.display=""}function V(){var e=n.panel;e.querySelector("#dcSrc").classList.remove("editRange"),e.querySelector("#dcSaveCnl").style.display="none",e.querySelector("#dcEdit").style.display="",e.querySelector(".zsRangePicker").classList.add("zRDisable")}function Z(){var e=n.panel;e.querySelector("#dcSrc").classList.remove("editRange"),e.querySelector(".zsRangePicker").classList.add("zRDisable"),this.parentNode.style.display="none",e.querySelector("#dcEdit").style.display="",s.publish(r.UI,o.SidePanel.DATACLEANING.UPDATE_RANGE,{RANGE:l.value}),3!=global.SA.Controller.SheetAppUIController.getOperationMenuValue()&&4!=global.SA.Controller.SheetAppUIController.getOperationMenuValue()&&f.cleanseData(f.ACTION_FIX_MISSPELLING,null,!0,l.value)}function z(){return D}L.Entry.RightPane.Node.addChildNode(N),f.initPanel=function(){A||((n=S.add({panelName:"DATA_CLEANING",onCreate:_,callBack:w,allowed:y,direction:C,isContextualPanel:!0,scrollCellToView:!0,minWidth:350,maxWidth:500})).onOpen=G,n.onClose=k,n.hide(),n.panel.addEventListener("click",T),A=!0)},f.openPanel=function(){n&&(n.show(),n.open(),P=!0)},f.togglePanel=b,f.setRange=W,f.getRange=function(){if(l)return l.value},f.getPanel=function(){return n.panel},f.isOpen=z,f.showLoader=O,f.hideLoader=U,f.showNotification=function(){m=!0;var e=n.panel.querySelector("#sPDcNtf");e&&(e.style.display="block")},f.hideNotification=H,f.constructBanner=function(e){var t=document.createElement("DIV");t.id="sPDcNtf",t.classList.add("spDatantfy"),t.style.display="none";var i=document.createElement("p");i.classList.add("fnt13"),i.innerHTML=v["SidePanel.DataCleaning.Datachanged"];var l=document.createElement("DIV");l.className+="wid wid100 mt20";var a=document.createElement("a");a.addEventListener("click",H),a.style.color="#2da1ef",a.className+="fnt13 flt_left dsp_Blk mt5 curPtr",a.innerHTML=v["SidePanel.DataCleaning.Ignore"];var s=document.createElement("button");return s.addEventListener("click",function(){H(),e()}),s.className+="Zsbtn ZsbtnInfo flt_right",s.innerHTML=v["SidePanel.DataCleaning.Regenerate"],l.appendChild(a),l.appendChild(s),t.appendChild(i),t.appendChild(l),n.panel.appendChild(t),t},s.register(r.UI,o.SidePanel.DATACLEANING.SHOW_LOADER,O),s.register(r.UI,o.SidePanel.DATACLEANING.HIDE_LOADER,U),s.register(r.UI,o.SidePanel.DATACLEANING.UPDATE_RANGE,f.setRange,"RANGE"),s.register(R.UserAction,o.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,function(){var e=document.querySelector("#mvRng"),t=document.querySelector("#cpRng");e&&"block"==e.style.display||t&&"block"==t.style.display||(z()&&b(),P&&(n.hide(),W("")))},"RID","SHEETID","VERSION","TARGET_SHEET")}(this);
!function(e){var t,n,i,o,s=e.sPlusPlus,r=e.ZSEvents,a=r.topic,c=r.Groups,l=r.Names,u=e.UserAction,d=e.ZSClass,v=e.UIUtil.Component,g=s.view.measures,E=e.ZSConstants.JSKeyCode,p=e.ZSConstants.I18N,f=(d=e.ZSClass).KeyMapping,h=e.ZSConstants.FeatureConstants,S=s.view.Toolbar.Feature[h.DELUGE];var C=new function(){f.call(this)};s.view.Events.Key.Entry.RightPane.Node.addChildNode(C);var y,m,D,I,N,A,R,T,L,w,P,F,O,U,x=(d=e.ZSClass).SidePanel,G=d.SidePanelClassList,M=[G.right,G.left,G.bottom],b=G.right,Z="SP_FUNCTION_final";function q(e){var t=u.getTemplate(["functionIcon"]);this.icon.appendChild(t.functionIcon),this.icon.setAttribute("data-shortcutkey","Shift+F3"),this.icon.title=p["Formulas.Function"]}function H(){m&&m.toggle()}function _(){m&&m.open()}function V(){0==g.Right.sidePanel&&0==g.Right.customSidePanelWidth?(g.Right.sidePanel=this.minWidth,g.Right.customSidePanelWidth=this.minWidth):g.Right.sidePanel=g.Right.customSidePanelWidth>=this.minWidth?g.Right.customSidePanelWidth:this.minWidth,this.holder.setWidth(g.Right.sidePanel),o||(k(),n&&n.focus()),a.register(c.Listener,l.DocAction.DELUGE_FUNCTIONS.INSERT,se,"RID","VERSION","DELUGE"),a.register(c.Listener,l.DocAction.DELUGE_FUNCTIONS.REMOVE,re,"RID","VERSION","DELUGE")}function k(){s.view.Events.Key.focusContext(C)}function W(){var e;g.Right.sidePanel=0,this.holder.setWidth(0),F.editor.value="",(e=s.view.Events.Key).focusContext(e.Entry.CellEditor.Context),a.unregister(c.Listener,l.DocAction.DELUGE_FUNCTIONS.INSERT,se),a.unregister(c.Listener,l.DocAction.DELUGE_FUNCTIONS.REMOVE,re)}function K(){var e=F.editor.value;O.classList.remove("noHelp"),F.suggest(e.toUpperCase()),P.reset(),P.select(),""==F.container.innerHTML&&(O.classList.add("noHelp"),F.container.appendChild(ae("No matches found",!1)))}function Y(){if(!y){var r=u.getTemplate([Z]);y=r[Z]}this.panel.appendChild(y),this.panel.addEventListener("mousedown",k),D=this.panel.querySelector("#fnName");var g=this.panel.querySelector("#helpContainer");I=g.querySelector("#fnDesc"),N=g.querySelector("#syntaxDesc"),A=g.querySelector("#argDesc"),R=g.querySelector("#desc"),T=g.querySelector("#addInfo"),w=this.panel.querySelector("#readMore"),L=g.querySelector("#funDesc"),this.panel.querySelector(".spClsIcon").addEventListener("click",function(){this.close()}.bind(this)),function(r){var u=r.querySelector(".fnSrch>input");(n=new d.Editors.TextAreaEditor(u)).addListeners({input:B,keydown:J});var v=r.querySelector(".fnRs");t=r.querySelector("select#category"),r.querySelector(".fnHlp"),r.querySelector("button#insert").addEventListener("click",function(){i.onInsert(i)}),v.addEventListener("keydown",J);function g(t){!function(){var t;if(e.text=t=F.list,t)for(var n in t)if(n!=p["Deluge.Title"]){var i=F.getCategory(n);F.flush(i)}}();var n=e.ZSConstants.Function,i=n.commonlyused,o=F.getCategory(p["FunctionCategory.CommonlyUsed"]),s=n.functions;for(var r in s){var a=s[r],c=a[$.CATEGORY],l=F.getCategory(c),u=document.createElement("div"),v=a[0],g=new d.AutoSuggest.Entry(u,r,z,X);oe(u,g,a[0],c),l.addEntry(v,g),-1!=i.indexOf(r)&&o.addEntry(v,g)}}P=new d.AutoSuggest.selector(v,{active:28,inActive:28,container:200}),F=new d.AutoSuggest.Search(v,n,t,P),g(ZSConstants.Functions),a.register(c.Listener,l.DocAction.FUNCTIONS.FETCH,g,"JSON");var E=s.view.getActiveGridID(),f=s.view.getResourceID(E),h=s.data.DocRegistry[f].delugeFunctions&&s.data.DocRegistry[f].delugeFunctions.getMap(),S=p["Deluge.Title"],C=F.getCategory(S);for(var y in h){var m=document.createElement("div"),D=new d.AutoSuggest.Entry(m,y,j,Q);oe(m,D,y,S),C.addEntry(y,D)}var I=F.list;F.select.addEventListener("change",function(e){F.suggest("",I[this.value])});var N={input:K,focus:K};F.editor.addListeners(N),a.register(c.Listener,l.DocAction.DELUGE_FUNCTIONS.INSERT,se,"RID","VERSION","DELUGE"),a.register(c.Listener,l.DocAction.DELUGE_FUNCTIONS.REMOVE,re,"RID","VERSION","DELUGE"),t.value=p["FunctionCategory.All"],F.suggest("",p["FunctionCategory.All"]),i=P.active,P.reset(),P.select(),o||(n.focus(),k());o=!1}(O=this.panel.querySelector("#functionData")),v.initComponent("#functionData"),v.bind(t,"zselectboxchange",function(e,n){O.classList.remove("noHelp");var i=t.value;if(F.suggest("",i),P.reset(),P.select(),this.value==p["Deluge.Title"]&&""==F.container.innerHTML){O.classList.add("noHelp");var o=s.data.UserInfo.Permission;0==o.isCoOwner&&1==o.isSharable?F.container.appendChild(ae(p["Deluge.Owner.EmptyState"],!0)):F.container.appendChild(ae(p["Deluge.Collabarator.EmptyState"],!1))}})}function B(){v.zcombo("#"+t.id,"setValue","All")}function J(e){switch(JSUtil.Key.getKeyCombination(e)){case E.ENTER:P.insert(),e.stopPropagation(),e.preventDefault();break;case E.UP:P.decrement(),P.select(),e.stopPropagation(),e.preventDefault();break;case E.DOWN:P.increment(),P.select(),e.stopPropagation(),e.preventDefault()}}function X(e){e=e||this;var t=s.view.getActiveGridID(),n=s.view.getResourceID(t),i=s.view.getSheetID(t),o=s.view.getVersionID(t),r=ZSConstants.Function.functions[e.text];a.publish(c.Listener,"InsertFunction",{RID:n,SHEETID:i,VERSION:o,FUNCTION:r[$.NAME]})}function z(){i&&i.dom.classList.remove("active"),this.dom.classList.add("active"),i=this,ne(this.text),w.style.display=""}function j(){i&&i.dom.classList.remove("active"),this.dom.classList.add("active"),i=this;var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),n=s.data.DocRegistry[t].delugeFunctions.get(this.text),o=this.text;D.textContent=o,I.textContent=n.description||"MY TEST DESCRIPTION";var r=n.returntype,a=n.arguments,c="",l=(document.createDocumentFragment(),0);if(null!=a){var u=a.length;for(l=0;l<u;l++){var d=a[l];c+=d.type+" "+d.name,l!=u-1&&(c+=",")}}N.textContent=r+" "+o+"("+c+")",R.style.display="none",L.style.display="none",w.style.display="none"}function Q(){var e=s.view.getActiveGridID(),t=s.view.getResourceID(e),n=s.view.getSheetID(e),i=s.view.getVersionID(e);a.publish(c.Listener,"InsertFunction",{RID:t,SHEETID:n,VERSION:i,FUNCTION:"_"+this.text})}a.register(c.UI,l.SidePanel.Function.toggle,H),a.register(c.UI,l.SidePanel.Function.open,_),a.register(c.UI,l.SidePanel.Function.open,_);var $={NAME:0,CATEGORY:1,DESCRIPTION:2,SHORT_DESCRIPTION:3,MAX_ARGS:4,NECESSARY:5,OPTIONAL:6,EXTRA_PARAMS:7},ee={NAMES:0,DESCRIPTIONS:1,DATATYPES:2};function te(e,t){var n=function(){if(!U){var e=u.getTemplate(["ARG_DESC"]);U=e.ARG_DESC}return U.cloneNode(!0)}().querySelector("p");return n.querySelector("#key").textContent=e+":",n.querySelector("#value").textContent=t,n}function ne(e){var t=ZSConstants.Function.functions[e.trim()],n=t[$.NAME];D.textContent=n,I.textContent=t[$.DESCRIPTION];var i=t[$.MAX_ARGS],o=t[$.NECESSARY],s="",r=document.createDocumentFragment(),a=0;if(T.style.display="none",o&&o.length){var c=o[ee.NAMES],l=o[ee.DESCRIPTIONS],u=te(g=c[0],E=l[0]);r.appendChild(u),s=c[0];for(var d=1,v=c.length;d<v;d++){var g=c[d],E=l[d];s+=", "+g;u=te(g,E);r.appendChild(u)}a=c.length,R.style.display="",L.style.display=""}else R.style.display="none",L.style.display="none";w.href="/sheet/functions#"+e;var p=t[$.OPTIONAL];if(p&&p.length){c=p[ee.NAMES],l=p[ee.DESCRIPTIONS];var f=!1,h="";(a+=c.length)!==i&&(f=!0,h="1");var S=0;if(!o.length){u=te(g=c[0],E=l[0]);r.appendChild(u),s=c[0],S=1,h="1"}for(d=S,v=c.length;d<v;d++){g=c[d];g+=h;E=l[d];s+=", ["+g+"]";u=te(g,E);r.appendChild(u)}if(f){for(d=0,v=c.length;d<v;d++){g=c[d];s+=", ["+(g+="2")+"]"}s+="..."}}var C=t[$.EXTRA_PARAMS];if(C&&C.length){T.innerHTML="";for(d=0;d<C.length;d++){var y=document.createElement("div");y.classList.add("supFunc");var m=C[d],P=document.createElement("div");P.innerHTML=m[0],P.classList.add("fntBld","mt10"),T.appendChild(P);for(var F=m[1],O=m[2],U=0;U<F.length;U++){var x=te(g=F[U],E=O[U]);y.appendChild(x)}T.appendChild(y)}T.style.display=""}N.textContent=n+"("+s+")",A.innerHTML="",A.appendChild(r)}var ie=e.sPlusPlus.view.Events.Key.Entry.ReadOnlyShortCut.Context.keyDown;function oe(t,n,i,o){t.innerText=i;var s=e.document.createElement("span");s.className="plus",t.setAttribute("category",o),s.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault(),n.insert(this)}),t.addEventListener("mousedown",function(e){e.stopPropagation(),e.preventDefault(),n.select(this)}),t.appendChild(s)}function se(e,t,n){var i=p["Deluge.Title"],o=F.getCategory(i),s=n[0],r=document.createElement("div"),a=new d.AutoSuggest.Entry(r,s,j,Q);oe(r,a,s,i),o.addEntry(s,a)}function re(e,i,o){for(var s=p["Deluge.Title"],r=F.getCategory(s),a=0;a<o.length;a++)r.deleteEntry(o[a],value);n.value="",F.suggest("","FunctionCategory.All"),v.zcombo(t,"setValue",p["FunctionCategory.All"]),P.reset(),P.select()}function ae(e,t){var n=document.createElement("div");n.classList.add("emptyState","wid100","fnt12");var i=document.createElement("div");if(t){var o=document.createElement("span");o.classList.add("createDeluge","ZsLink","fnt14"),o.innerText="Create",o.addEventListener("click",function(){S.createInsertDialog(!1)}),i.appendChild(o)}var s=document.createElement("span");return s.classList.add("fnt14"),s.innerText=e,i.appendChild(s),n.appendChild(i),n}C.keyDown[E.SHIFT+"+"+E.F3]=H,ie[E.SHIFT+"+"+E.F3]=H,a.register(c.UI,l.Layout.TEMPLATE_LOADED,function(){(m=x.add({panelName:"FUNCTION",onCreate:q,callBack:Y,allowed:M,direction:b,scrollCellToView:!0,minWidth:320,maxWidth:500})).onOpen=V,m.onClose=W}),e.UserAction.functionSelection=function(e){o=!0,_(),F.suggest(e),P.reset(),P.select(),o=!1}}(this),function(e){var t=e.sPlusPlus,n=e.document,i=e.ZSEvents,o=i.topic,s=i.Groups,r=(i.Names,n.createElement("div")),a=n.createElement("div"),c=n.createElement("input"),l=n.createElement("div"),u=n.createElement("select");r.className="spotlight",a.className="spotLightMask",l.className="results",c.placeholder="Search...",r.appendChild(c),r.appendChild(l),r.style.display="none",a.style.display="none";function d(){var e=t.view.Events.Key;e.focusContext(e.Entry.SpotLight.Context)}function v(e){if(""==this.value)p.flush();else{var t=this.value;f.suggest(t.toUpperCase())}}a.addEventListener("mousedown",function(e){y()},!0);var g={focus:function(e){v.call(this,e),d()},input:function(e){v.call(this,e)}},E=new ZSClass.Editors.TextAreaEditor(c),p=new ZSClass.AutoSuggest.selector(l,{active:32,inActive:32,container:300}),f=new ZSClass.AutoSuggest.Search(l,E,u,p);E.addListeners(g),function(e){function i(e,t,n){e.innerHTML="Insert Function <b>"+n+"</b>",e.addEventListener("mousedown",function(e){t.select(this)})}function r(e){e.preventDefault(),e.stopPropagation(),y();var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),r=t.view.getSheetID(n),a=t.view.getVersionID(n);o.publish(s.Listener,"InsertFunction",{RID:i,SHEETID:r,VERSION:a,FUNCTION:this.text})}function a(e){}ZSConstants.Function&&function(e){var t=e.functions,o=f.getCategory("Functions");for(var s in t){var c=n.createElement("div"),l=new ZSClass.AutoSuggest.Entry(c,s,r,a);i(c,l,s),o.addEntry(s,l)}}(ZSConstants.Function)}(),function(e){function t(e,t,n){e.innerText=n,e.addEventListener("mousedown",function(e){t.select(this)})}var i=ZSConstants.FeatureConstants,o=f.getCategory("Features");for(var s in i)!function(e){var s=e,a=n.createElement("div"),c=new ZSClass.AutoSuggest.Entry(a,s,function(t){y(),t.preventDefault(),t.stopPropagation(),sPlusPlus.view.Toolbar.Feature[i[e]].execute(t)},r);t(a,c,s),o.addEntry(s,c)}(s);function r(e){}}(),function(){var e="PRECEDANCE",i=n.createElement("div"),o=f.getCategory("Features"),s=new ZSClass.AutoSuggest.Entry(i,e,function(e){y(),e.preventDefault(),e.stopPropagation();var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),o=t.view.getSheetID(n),s=t.view.getVersionID(n),r=t.view.getSheetState(n,o).getActiveCellRange();UserAction.PlacePrecedance(i,o,s,r.startRow,r.startCol)},function(e){});!function(e,t,n){e.innerText=n,e.addEventListener("mousedown",function(e){t.select(this)})}(i,s,e),o.addEntry(e,s)}();var h=e.sPlusPlus.view.Events.Key,S=h.Entry.SpotLight.Context.keyDown,C=e.ZSConstants.JSKeyCode;function y(){var e;r.style.display="none",a.style.display="none",(e=t.view.Events.Key).focusContext(e.Entry.CellEditor.Context)}S[C.PURE_PRINTABLE_CHAR]=function(e){return n.activeElement!==f.editor.Editor&&f.editor.Editor.focus(),!1},S[C.ENTER]=function(e){return p.select(e),!1},S[C.UP]=function(){return p.decrement(),!1},S[C.DOWN]=function(){return p.increment(),!1},S[C.ESC]=function(){y()},n.body.appendChild(r),n.body.appendChild(a);S=h.Entry.Base.Context.keyDown}(this);
!function(e){var t,i,n,s,r=e.sPlusPlus,o=e.ZSEvents,a=o.topic,d=o.Groups,l=o.Names,c=e.ZSConstants.FeatureConstants,v=r.view.Toolbar.Feature[c.VIEW_VERSION],h=e.UIUtil.Component,u=e.ZSConstants.wCC,I=e.ZSConstants.I18N,g=document.getElementById("popupmenu"),S=r.view.measures,E=e.ZSClass,m=E.UIVersionLog,p=E.UICurrentVersionLog,V="SP_VERSION",T=!1,N=E.SidePanel,w=E.SidePanelClassList,D=[w.right,w.left,w.bottom],H=w.right;var C=e.document.createElement("span");C.className="ZsLoader ZsLoaderSmall";var L,f,A=e.document.createElement("span");function U(){if(!t){var e=UserAction.getTemplate([V]);t=e[V]}this.panel.appendChild(t),n=this.panel.querySelector("#titleVersion");var s="SP_VERSION_SETTINGS";this.panel.querySelector("#settings").setAttribute("data-menu-id",u.SUBMENUITEM+s+u.IDENTITY);var o={id:u.SUBMENUITEM+s+u.IDENTITY,"data-ctype":"zmenu","data-content-type":"icon-text"},a=[{data:'{"label": "'+I["AT.ShowAllVersions"]+'", "type":0 }',"data-item-type":"checkbox",checked:!0},{data:'{"label": "'+I["AT.ShowNamedVersions"]+'", "type":1}',"data-item-type":"checkbox"}],d=this;T||(r.view.Menu.create(a,o,g).then(function(){var e=document.querySelector("#"+u.SUBMENUITEM+s+u.IDENTITY),t=e.children[0].children[0];h.bind(e,"zmenuitemclick",function(e,i){h.zmenu("#"+u.SUBMENUITEM+s+u.IDENTITY,"setMenuItemsAttribute",[t],"checked",!1),t=i.menuitem,h.zmenu("#"+u.SUBMENUITEM+s+u.IDENTITY,"setMenuItemsAttribute",[t],"checked",!0);var n=1==~~i.menuitem.data().ZCOpts.type,o=r.view.getActiveGridID(),a=r.view.getResourceID(o),l=r.view.getVersionID(o);UserAction.getVersionDetails(a,l,n,_.bind(d))})}),T=!0),this.panel.querySelector("#hgtChanges").addEventListener("click",O);var l=this.panel.querySelector("#version");l.innerHTML="",l.appendChild(C),(i=this.panel.querySelector("#versionClose")).addEventListener("click",function(){var e=r.view.getActiveGridID();r.view.getVersionState(e).isCloseButton();b()})}function P(e){var t=UserAction.getTemplate(["versionIcon"]);this.icon.appendChild(t.versionIcon),this.icon.title=I.VersionHistory}function R(){0==S.Right.sidePanel&&0==S.Right.customSidePanelWidth?(S.Right.sidePanel=this.minWidth,S.Right.customSidePanelWidth=this.minWidth):S.Right.sidePanel=S.Right.customSidePanelWidth>=this.minWidth?S.Right.customSidePanelWidth:this.minWidth,this.holder.setWidth(S.Right.sidePanel)}function y(){S.Right.sidePanel=0,this.holder.setWidth(0)}function O(){var e=r.view.getActiveGridID(),t=r.view.getVersionState(e);if(t.getActiveVersionLog().getVersionNumber()!==r.data.Defaults.version){var i=t.getHighlightVersionChanges();i=!i,t.setHighlightVersionChanges(i),i?a.publish(d.UI,l.SidePanel.VersionHistory.HIGHLIGHT_CHANGES):a.publish(d.UI,l.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES)}}function G(e,t,i){var n=r.view.getActiveGridID();r.view.getVersionState(n);a.publish(d.UI,l.SidePanel.VersionHistory.HIGHLIGHT_CHANGES)}function M(e,t,i){a.register(d.Listener,l.DocAction.WORKSHEETS.SWITCHSHEET,G,"NEWSHEETID","RID","VERSION"),s.show(),s.open();var n=s.panel.querySelector("#version");n&&(n.innerHTML="",n.appendChild(C));var o=r.view.getActiveGridID(),c=(e=r.view.getResourceID(o),r.view.getVersionID(o));UserAction.getVersionDetails(e,c,!1,function(e){_.call(s,e,L,f)}),L=t,f=i}function b(){a.unregister(d.Listener,l.DocAction.WORKSHEETS.SWITCHSHEET,G),s.close();var e=r.view.getActiveGridID();r.view.getVersionID(e)===r.data.Defaults.version&&s.hide()}function W(){s.hideOthers(),s.show()}function _(e,t,n){var s=e.length,o=this.panel.querySelector("#version");o.innerHTML="",s||(A.textContent="There were no Version History for this SpreadSheet",o.appendChild(A));var a=r.view.getActiveGridID(),d=r.view.getVersionState(a);d.clearVersionLogMap();var l,c,v,h=0;e[0]&&(e[0].ver||(h=1),(I=(l=o,c=E.CurrentVersionLogBinds,(v=new p).setVersionNumber(sPlusPlus.data.Defaults.version),v.append(l),v.addEventListener(c),v)).addEventListener(E.ChangeLogBinds),r.view.getVersionID(a)!=r.data.Defaults.version&&I.dom.click(),d.addVersionLog(I),d.setActiveVersionLog(I),function(){var e=r.view.getActiveGridID();r.view.getVersionState(e).isCloseButton()?i.classList.remove("vHBack"):i.classList.add("vHBack")}());for(var u=h;u<s;u++){var I;(I=B(o,e[u],E.VersionLogBinds)).addEventListener(E.ChangeLogBinds),d.addVersionLog(I)}n&&function(e,t,i){var n,s=i.getVersionLogMap();if(e){if(n=s[e]){var r=new Event("click");r.data={version:e,range:t},n.dom.dispatchEvent(r),n.dom.scrollIntoView()}}else{for(var o in s){n=s[o];break}n&&(n.dom.click(),n.dom.scrollIntoView())}}(t,n,d)}function B(e,t,i){var n=new m;return n.setTime(t.ts),t.ver&&n.setVersionNumber(t.ver),t.r_v_no?n.addRevertVersion(t.r_v_no,t.vl):t.vl&&n.setDescription(t.vl),n.setUserNameAndColor(t.al),n.append(e),n.addEventListener(i),n}A.classList.add("ZsNoMsg"),v.openPanel=M,a.register(d.UI,l.SidePanel.VersionHistory.OPEN,M,"RID","VERSION","RANGE"),a.register(d.UI,l.SidePanel.VersionHistory.CLOSE,b),a.register(d.UI,l.Layout.TEMPLATE_LOADED,function(){(s=N.add({panelName:"VERSION",onCreate:P,callBack:U,allowed:D,direction:H,isContextualPanel:!0,minWidth:330,maxWidth:500})).onOpen=R,s.onClose=y,s.hide()}),a.register(d.UI,l.SidePanel.VersionHistory.UPDATE_TITLE,function(e){n.textContent=e?" #"+parseFloat(e):""},"VERSION_NUMBER"),a.register(d.UI,l.SidePanel.VersionHistory.HIDE_ICON,function(){s.showOthers(),s.hide()}),a.register(d.UI,l.Toolbar.VERSION_HISTORY.SHOW,W),a.register(d.Listener,l.UserAction.VERSION_HISTORY.UPDATE_BUTTON_STATE,function(){var e=r.view.getActiveGridID(),t=r.view.getResourceID(e),i=r.view.getVersionID(e);r.data.getWorkBook(t,i).isEditable()?s.showOthers():W()})}(this);
!function(t){function e(){this.head}e.prototype={add:function(t){var e=new function(t){this.data=t,this.next=null}(t);if(this.isEmpty())this.head=e;else{for(var i=this.head;i.next;)i=i.next;i.next=e}},remove:function(t){if(!this.isEmpty())for(var e=this.head,i=null;e;){if(e.data===t)return this.removeNode(i,e),e;i=e,e=e.next}},removeNode:function(t,e){null==t?this.head=this.head.next:t.next=e.next},isEmpty:function(){return!this.head}},t.ZSClass.SingleLinkedList=e}(this);
!function(t){var e=t.ZSClass.SingleLinkedList;function n(){this.length=0}n.prototype=Object.assign({},e.prototype),n.prototype.insert=function(t){this.add(t),this.length++},n.prototype.delete=function(t){var e=this.remove(t);return this.length--,e},n.prototype.getSize=function(){return this.length},n.prototype.findAndInsertAtEnd=function(t){for(var e=this.head,n=null;e;){if(e.data===t)return this.removeNode(n,e),this.add(t),!0;n=e,e=e.next}return!1},n.prototype.deleteFirst=function(){return this.delete(this.head.data)},t.ZSClass.LinkedListExtended=n}(this);
!function(t){var i=t.ZSClass.LinkedListExtended;function e(t){this.frameSize=t,this.list=new i}e.prototype={add:function(t){var i;if(!this.list.findAndInsertAtEnd(t))return this.list.getSize()>=this.frameSize&&(i=this.list.deleteFirst()),this.list.insert(t),i},removeFirst:function(){this.list.getSize()>0&&this.list.deleteFirst()},removeAll:function(){for(var t=this.list.getSize(),i=0;i<t;i++)this.removeFirst()},getListAsArray:function(){for(var t=this.list.getSize(),i=[],e=this.list.head,s=0;s<t;s++)i.push(e.data),e=e.next;return i}},t.ZSClass.PageReplacement=e}(this);
!function(e){var i=e.sPlusPlus,t=e.ZSEvents,s=t.topic,r=t.Groups,n=t.Names,a=i.data.Defaults.MAX_COL;s.register(r.UI,n.SidePanel.VersionHistory.UNHIGHLIGHT_CHANGES,function(){var e=i.view.getActiveGridID(),t=i.view.getResourceID(e),a=i.view.getSheetID(e),g=i.view.getVersionID(e);s.publish(r.Listener,n.Layers.HighlightVersion.RemoveAll,{RID:t,SHEETID:a,VERSION:g})}),s.register(r.UI,n.SidePanel.VersionHistory.HIGHLIGHT_CHANGES,function(){var e=i.view.getActiveGridID(),t=i.view.getVersionState(e);if(t.getHighlightVersionChanges()){var g=i.view.getResourceID(e),o=i.view.getSheetID(e),I=i.view.getVersionID(e),v=t.getVersionActionList()[o];for(var l in v)if(t.isEditAction(v[l].a)){var h=v[l].lp.length;E=v[l].lp[h-1];var D=JSUtil.Range.parseRange(g,I,E),E=D.range,H=D.sheetID,S=JSUtil.Math.hash(E.startRow,E.startCol,a);s.publish(r.Listener,n.Layers.HighlightVersion.Place,{RID:g,SHEETID:H,VERSION:I,RANGEID:S,RANGE:E,COLORCODE:v[l].cc,USER_NAME:v[l].un})}}})}(this);
!function(e){var t,n,i,a=e.sPlusPlus,o=e.ZSEvents,l=o.topic,s=o.Groups,r=o.Names,c=e.UserAction,d=e.ZSClass,u=a.view.measures,m=d.KeyMapping,S=(d=e.ZSClass).SidePanel,E=d.SidePanelClassList,C=[E.right,E.left,E.bottom],v=E.right,p=e.document,I=e.UIUtil.Component,y=e.ZSConstants.ActionConstants,M=e.ZSConstants.CommandConstants,h=e.ZSConstants,N=h.FeatureConstants,f=h.I18N,T=h.wCC,g=(a.data.AppRegistry.CSSPath,ZSConstants.JSKeyCode),D=!1,P=!1,b=!1,A=!1,U=!1,O=!1,w=!1,L={all:"all",resolved:"resolved",active:"active"},_="SP_COMMENTS",R=p.querySelector("#popupmenu"),k=a.view.Toolbar.Feature[N.COMMENTS];function q(){m.call(this)}k.NotificationCnt=0,k.initialLoad=!1;var B=new q,F=a.view.Events.Key;F.Entry.RightPane.Node.addChildNode(B);new q;function W(e){e.preventDefault();for(var t=k.dltDivStack,n=t.pop();n&&!n.del.parentElement;)n=t.pop();n&&(n.del.remove(),n.cmt&&(n.cmt.style.overflow=""))}function H(e){var t=c.getTemplate(["commentIcon"]);this.icon.appendChild(t.commentIcon),this.icon.id="SP_COMMENTS_ICON",this.icon.title=f["Discussion.PanelHeader"],ne(k.NotificationCnt)}function z(){i&&i.toggle()}function G(){0==u.Right.sidePanel&&0==u.Right.customSidePanelWidth?(u.Right.sidePanel=this.minWidth,u.Right.customSidePanelWidth=this.minWidth):u.Right.sidePanel=u.Right.customSidePanelWidth>=this.minWidth?u.Right.customSidePanelWidth:this.minWidth,this.holder.setWidth(u.Right.sidePanel),x(),l.publish(s.UI,r.SidePanel.Comments.PANELSTATUS,{isShown:!0}),function(){if(t)return;(t=p.createElement("ul")).id="smileySuggestions",t.className="smileySuggestions";var n=e.ZSConstants.Smiley;for(var i in n)if(!t.querySelector("#"+n[i])){var a=JSUtil.LinkMaker.convert(i).msg,o=p.createElement("li");o.innerHTML=a,o.id=n[i],o.setAttribute("data-value",i),o.addEventListener("click",ie),t.appendChild(o)}p.getElementById("popupmenu").appendChild(t)}(),k.initialLoad&&(k.NotificationCnt>0?$():te())}function x(){a.view.Events.Key.focusContext(B)}function V(){u.Right.sidePanel=0,this.holder.setWidth(0),F.focusContext(F.Entry.CellEditor.Context),U=!1,l.publish(s.UI,r.SidePanel.Comments.PANELSTATUS,{isShown:!1}),k.getDisplayComment()}function Y(){if(!n){var t=c.getTemplate([_]);n=t[_]}var i;this.panel.appendChild(n),this.panel.addEventListener("mousedown",x),this.panel.querySelector("#AddBtn").addEventListener("click",function(){l.publish(s.Listener,r.UserAction.REVIEW_COMMENTS.TRIGGER_ADD)}),this.panel.querySelector("#NtfnBtn").addEventListener("click",function(){$()}),this.panel.querySelector("#sPCmtGoBck1").addEventListener("click",function(){te()}),this.panel.querySelector("#sPCmtGoBck2").addEventListener("click",function(){te()}),this.panel.querySelector(".spClsIcon").addEventListener("click",z),function(e){var t={id:T.SUBMENUITEM+N.COMMENTS+T.IDENTITY+"_activeCmtMenu",ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},n=[{data:'{"label":"'+f["Discussion.Resolve"]+'", "action": '+y.DISCUSSION_RESOLVE+"}"},{mtype:"separator"},{data:'{"label":"'+f["Discussion.Edit"]+'", "action": '+y.DISCUSSION_UPDATE_RANGE_CONTENT+"}"},{data:'{"label":"'+f["MenuItem.FileTab.Print"]+'", "action": '+J+"}"},{data:'{"label":"'+f["Discussion.Delete"]+'", "action": '+y.DISCUSSION_DELETE+"}"}];if(!P){a.view.Menu.create(n,t,R).then(function(){I.bind("#"+T.SUBMENUITEM+N.COMMENTS+T.IDENTITY+"_activeCmtMenu","zmenuitemclick",function(e,t){t.data;Q(e,t),e.stopPropagation()})});p.getElementById(t.id);P=!0}}(),function(e){var t={id:T.SUBMENUITEM+N.COMMENTS+T.IDENTITY+"_resolvedCmtMenu",ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},n=[{data:'{"label":"'+f["Discussion.reopen"]+'", "action": '+y.DISCUSSION_REOPEN+"}"},{mtype:"separator"},{data:'{"label":"'+f["MenuItem.FileTab.Print"]+'", "action": '+J+"}"},{data:'{"label":"'+f["Discussion.Delete"]+'", "action": '+y.DISCUSSION_DELETE+"}"}];if(!D){a.view.Menu.create(n,t,R).then(function(){I.bind("#"+T.SUBMENUITEM+N.COMMENTS+T.IDENTITY+"_resolvedCmtMenu","zmenuitemclick",function(e,t){t.data;Q(e,t)})});p.getElementById(t.id);D=!0}}(),function(e){var t={id:T.SUBMENUITEM+N.COMMENTS+T.IDENTITY+"_collabActiveCmtMenu",ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},n=[{data:'{"label":"'+f["MenuItem.FileTab.Print"]+'", "action": '+J+"}"}];if(!O){a.view.Menu.create(n,t,R).then(function(){I.bind("#"+T.SUBMENUITEM+N.COMMENTS+T.IDENTITY+"_collabActiveCmtMenu","zmenuitemclick",function(e,t){t.data;Q(e,t),e.stopPropagation()})});p.getElementById(t.id);O=!0}}(),function(e){var t={id:T.SUBMENUITEM+N.COMMENTS+T.IDENTITY+"_collabResolvedCmtMenu",ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},n=[{data:'{"label":"'+f["MenuItem.FileTab.Print"]+'", "action": '+J+"}"}];if(!b){a.view.Menu.create(n,t,R).then(function(){I.bind("#"+T.SUBMENUITEM+N.COMMENTS+T.IDENTITY+"_collabResolvedCmtMenu","zmenuitemclick",function(e,t){t.data;Q(e,t)})});p.getElementById(t.id);b=!0}}(),function(e){var t={id:T.SUBMENUITEM+N.COMMENTS+T.IDENTITY+"_docOwnerActiveCmtMenu",ctype:"zmenu",data:'{"componentOptions":{"type":"text_only"}}',relativeto:"parent"},n=[{data:'{"label":"'+f["Discussion.Resolve"]+'", "action": '+y.DISCUSSION_RESOLVE+"}"},{mtype:"separator"},{data:'{"label":"'+f["MenuItem.FileTab.Print"]+'", "action": '+J+"}"},{data:'{"label":"'+f["Discussion.Delete"]+'", "action": '+y.DISCUSSION_DELETE+"}"}];if(!A){a.view.Menu.create(n,t,R).then(function(){I.bind("#"+T.SUBMENUITEM+N.COMMENTS+T.IDENTITY+"_docOwnerActiveCmtMenu","zmenuitemclick",function(e,t){t.data;Q(e,t),e.stopPropagation()})});p.getElementById(t.id);A=!0}}(),k.createFilterMenuLayout(R),k.initSheetFilter(R),function(t){var n={id:"commentPanelMenu",ctype:"zmenu",relativeto:"parent","data-type":"list","data-content-type":"text"},i=[{id:T.MI+"HighlightComments"+T.MENU,data:'{"label":"'+f["Discussion.HighlightComments"]+'", "action": '+j+', "itemType": "checkbox"}'},{id:T.MI+"printAll"+T.MENU,data:'{"label":"'+f["MenuItem.FileTab.Print"]+'", "action": '+X+"}"},{id:T.MI+"deleteAll"+T.MENU,data:'{"label":"'+f["Discussion.Delete"]+'", "action": '+y.DISCUSSION_DELETE_ALL+"}"},{"data-item-type":"separator"},{data:'{"label":"'+f["Discussion.notification"]+'", "action": '+K+"}"},{data:'{"label":"'+f["Notification.EmailSettings"]+'", "action": '+y.NOTIFICATION_SETTINGS+"}"}];if(!w){a.view.Menu.create(i,n,R).then(function(){I.bind("#commentPanelMenu","zmenuitemclick",function(t,n){n.data;!function(t,n){switch(n.data.action){case X:i=p.getElementById("sPCmtHolder"),k.print(i);break;case y.NOTIFICATION_SETTINGS:k.openNotificationSetingsDialog();break;case y.DISCUSSION_DELETE_ALL:!function(){if(null!=p.getElementById("dltDiv"))return;var t=p.getElementById("comments");t.scrollTop=0;var n=c.getTemplate(["SP_DELETE"]).SP_DELETE;t.appendChild(n),t.querySelector("#dltMsg").innerHTML=function(){var e,t="all"==k.currentSheetFilter?f["Discussion.HDAllSheet"]:k.currentSheetFilter;switch(k.currentFilter){case L.active:e=JSUtil.fn.replaceParams(f["Discussion.UnresolvedCommentDeleteConfirmation"],new Array(t+""));break;case L.resolved:e=JSUtil.fn.replaceParams(f["Discussion.ResolvedCommentDeleteConfirmation"],new Array(t+""));break;case L.all:e=JSUtil.fn.replaceParams(f["Discussion.AllCommentDeleteConfirmation"],new Array(t+""))}return e}();var i=t.querySelector("#dltDiv"),o=t.querySelector("#cnlBtn"),l=t.querySelector("#dltBtn"),s=p.getElementById("comments");s.style.overflow="hidden",l.addEventListener("click",function(){i.remove();var t=a.view.getActiveGridID(),n=a.view.getResourceID(t),o=a.view.getSheetID(t),l=a.view.getVersionID(t),r=a.data.getWorkBook(n,l),c=(r.getSheetObj(o),sPlusPlus.data.UserInfo.loginName,a.view.getSelectedSheets(t)),d=a.view.getSheetID(t),u=a.view.getSheetState(t,d),m=u.getActiveRange(),S="active"==k.currentFilter?0:"resolved"==k.currentFilter?1:2;e.UserAction.deleteAllReviewComment(n,l,c,m,S),s.style.overflow=""}),o.addEventListener("click",function(){i.remove(),s.style.overflow=""})}();break;case K:$();break;case j:k.triggerHighlightAllComments()}var i}(0,n)})});p.getElementById(n.id);w=!0,I.bind(p.getElementById("commentPanelMenu"),"zmenubeforeshow",function(){k.updatePanelOption()})}}(),(i=p.createElement("ul")).id="sPLikeList",i.className="sPLikeList",p.getElementById("popupmenu").appendChild(i),this.panel.querySelector("#cmtStatusFilter").setAttribute("data-menu-id","reviewCommentFilterMenu"),k.updateFilterDOM(k.currentFilter),this.panel.querySelector("#cmtSheetFilter").setAttribute("data-menu-id","sheetFilterMenu"),k.resetSheetFilterCount(),k.updateSheetFilterDOM(k.currentSheetFilter),k.NotificationCnt>0?(ee(),Z(L.all),$()):Z("active"),k.initialLoad=!0}function Z(e,t){k.init(),l.publish(s.Listener,r.UserAction.REVIEW_COMMENTS.FETCH,{status:e,sheets:t,disId:void 0,newComment:!1,action:M.DISCUSSION,SR:0,SC:0,ER:a.data.Defaults.MAX_ROW-1,EC:a.data.Defaults.MAX_COL-1})}var J=0,X=1,K=2,j=3;function Q(e,t){var n=t.forElement[0].dataset.uid,i=t.data.action;l.publish(s.Listener,r.UserAction.REVIEW_COMMENTS.EXECUTE_ACTION,{uid:n,action:i})}function $(){ne(0);var e=p.getElementById("comments");e.classList.add("sPFlip"),e.querySelector("#sPNoNtfy")&&(e.querySelector("#sPNoNtfy").style.display="block"),p.querySelector("#sPCmtNotfy").style.display="block",p.querySelector("#sPCmtFltr").style.display="none",0==k.displayCnt&&p.querySelector("#sPNoCmt")&&(p.querySelector("#sPNoCmt").style.display="none");var t=a.view.getActiveGridID(),n=a.view.getResourceID(t),i=a.view.getVersionID(t),o=(a.data.getWorkBook(n,i),a.view.getSelectedSheets(t)),l=a.view.getSheetID(t),s=a.view.getSheetState(t,l).getActiveRange();c.updateDocClosedTime(n,i,o,s)}function ee(){var e,t=p.querySelector("#comments");t&&(e=t.querySelector("#sPNoNtfy")),e&&e.remove()}function te(){var e=p.querySelector("#comments");e.classList.remove("sPFlip"),p.querySelector("#sPCmtNotfy").style.display="none",e.querySelector("#sPNoNtfy")&&(e.querySelector("#sPNoNtfy").style.display="none"),p.querySelector("#sPCmtFltr").style.display="",0==k.displayCnt&&p.querySelector("#sPNoCmt")&&(p.querySelector("#sPNoCmt").style.display="block"),ne(0),k.markCommentAsRead()}function ne(e){if(i){0!=e&&ee();var t=i.icon,n=U?p.querySelector("#NtfnBtn"):t;0==e?(t.classList.remove("shNtfyCount"),t.setAttribute("data-count",e),n.classList.remove("shNtfyCount"),n.setAttribute("data-count",e)):(n.classList.add("shNtfyCount"),n.setAttribute("data-count",e)),k.NotificationCnt=e}}function ie(){var e,t,n,i,a,o=this.dataset.value,l=k.divToAddSmiley.querySelector("#editableContent");l.parentElement.classList.remove("sPPlaceHolder"),l.innerHTML+=" "+o,t=(e=l).lastChild,n=t.textContent.length,i=window.getSelection(),(a=p.createRange()).setStart(t,n),a.setEnd(t,n),a.collapse(!0),i.removeAllRanges(),i.addRange(a),e.focus();var s=k.divToAddSmiley.querySelector("#submitBtn");!s&&(s=k.divToAddSmiley.querySelector("#replyBtn")),s.disabled=!1;var r=k.divToAddSmiley.querySelector(".sPCmtSmiley");I.zpopover(r,"close")}k.updateNotificationCount=ne,k.showNotificationPanel=$,k.updatePanelOption=function(){p.querySelector("#"+T.MI+"deleteAll"+T.MENU)&&(0==k.displayCnt?(I.disable("#"+T.MI+"deleteAll"+T.MENU),I.disable("#"+T.MI+"printAll"+T.MENU)):(I.enable("#"+T.MI+"deleteAll"+T.MENU),I.enable("#"+T.MI+"printAll"+T.MENU)),a.data.UserInfo.Permission.isSharable||p.querySelector("#commentPanelMenu").querySelector("#"+T.MI+"deleteAll"+T.MENU).remove());var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),n=a.view.getVersionID(e),i=a.data.getWorkBook(t,n);I.zmenu("#commentPanelMenu","setMenuItemsAttribute",["#"+T.MI+"HighlightComments"+T.MENU],"checked",i.highlightComments)},k.loadComments=Z,k.goToComment=te,k.ClearPanel=function(){var e=k.Comment.Thread;for(var t in e)e[t].highlight(!1);p.querySelector("#sPCmtHolder").innerHTML="",k.hideHighlightComment()},k.markCommentAsRead=function(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),n=a.view.getVersionID(e);c.markCommentAsRead(t,n,k.currentFilter,!0)},-1==ZSConstants.Meta.HideFeaturesList.indexOf(N.COMMENTS)&&(l.register(s.UI,r.SidePanel.Comments.TOGGLE,z),l.register(s.UI,r.SidePanel.Comments.OPEN,function(){i&&i.open()}),l.register(s.UI,r.Layout.TEMPLATE_LOADED_DEFER,function(){(i=S.add({panelName:"COMMENTS",onCreate:H,callBack:Y,allowed:C,direction:v,scrollCellToView:!0,minWidth:320,maxWidth:500})).onOpen=G,i.onClose=V,B.keyDown[g.ESC]=W}),l.register(s.UI,r.SidePanel.Comments.FOCUS,x),l.register(s.Listener,r.UserAction.REVIEW_COMMENTS.GET_SUCCESS,function(){l.publish(s.Listener,r.UserAction.REVIEW_COMMENTS.FETCH,{status:L.all,sheets:void 0,disId:void 0,newComment:!1,action:"INIT_NOTIFICATION",sr:0,sc:0,er:a.data.Defaults.MAX_ROW-1,ec:a.data.Defaults.MAX_COL-1})}))}(this);
!function(e){var t,r,i,o=e.sPlusPlus,n=e.ZSEvents,a=e.JSUtil,l=n.topic,s=n.Groups,c=n.Names,u=(o.data.Defaults.MAX_COL,e.JSUtil.Math,e.UserAction),p=e.UIUtil.Component,v=(e.ZSConstants.wCC,e.ZSConstants),g=v.FeatureConstants,d=(v.JSKeyCode,(i=e.ZSClass).Editors,i.RangePicker),S=e.ZSConstants.I18N,h=(document.getElementById("popupmenu"),o.view.measures),k=o.view.Toolbar.Feature[g.SPARKLINE],P="#REF!",w={},C=!1,R=!1,I={activeRange:{},activeCell:{}},y="sparklineSidePanel",m=i.SidePanel,f=i.SidePanelClassList,D=[f.right],A=f.right,E=(i=e.ZSClass).KeyMapping;var q=new function(){E.call(this)};function L(){o.view.Events.Key.focusContext(q)}function x(){var e=o.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}function b(){if(!t){var e=u.getTemplate([y]);t=e[y]}this.panel.appendChild(t),function(){for(var e=[W.showHidden,W.highPoint,W.firstPoint,W.negativePoint,W.lowPoint,W.lastPoint,W.allPoints,W.showAxis,W.reverse],t=[W.lineType,W.colType,W.winlossType,W.gap,W.zero,W.lines,W.skip,W.autoMin,W.sameMin,W.custMin,W.autoMax,W.sameMax,W.custMax],i=r.panel.querySelectorAll(".cP"),o=0;o<i.length;o++){var n=i[o];re("#"+n.id)}for(var o=0;o<t.length;o++)r.panel.querySelector(t[o]).addEventListener("click",ie);for(var o=0;o<e.length;o++)r.panel.querySelector(e[o]).addEventListener("click",ie);r.panel.querySelector(W.group).addEventListener("click",function(){ce(!1,!1)}),r.panel.querySelector(W.wholeGroup).addEventListener("click",function(){ce(!0,!1)}),r.panel.querySelector(W.orientation).addEventListener("click",le),r.panel.querySelector(W.close).addEventListener("click",function(){r.close()}),r.panel.querySelector(W.remove).addEventListener("click",J),r.panel.querySelector(W.removeGroup).addEventListener("click",Y),r.panel.querySelector(W.editButton).addEventListener("click",Q),r.panel.querySelector(W.editCloseButton).addEventListener("click",$),r.panel.querySelector(W.editSubmit).addEventListener("click",X),r.panel.querySelector(W.editClose).addEventListener("click",$),r.panel.querySelector(W.editGroupCheckbox).addEventListener("click",te),r.panel.querySelector(W.editSingleCheckbox).addEventListener("click",ee),r.panel.querySelector(W.minValue).addEventListener("focus",H),r.panel.querySelector(W.maxValue).addEventListener("focus",F),r.panel.querySelector(W.minValue).addEventListener("blur",j),r.panel.querySelector(W.maxValue).addEventListener("blur",j),r.panel.querySelector(W.verticalAxisMenu).addEventListener("click",_),r.panel.querySelector(W.horizontalAxisMenu).addEventListener("click",Z)}()}function M(e){var t=u.getTemplate(["sparkLineIcon"]);this.icon.appendChild(t.sparkLineIcon),this.icon.title=S["SidePanel.Sparklines.Sparkline"]}function V(){(r=m.add({panelName:"SPARKLINE",onCreate:M,callBack:b,allowed:D,direction:A,isContextualPanel:!0,scrollCellToView:!0,minWidth:320,maxWidth:500})).onOpen=O,r.onClose=T,r.hide()}function O(){var e=o.view.getActiveGridID(),t=o.view.getVersionID(e),i=o.view.getResourceID(e),n=o.view.getSheetID(e),a=o.view.getSheetState(e,n).getActiveCellRange();o.data.getWorkBook(i,t).getSheetObj(n).sparklines.getInfo(a.startRow,a.startCol)&&G(),0==h.Right.sidePanel&&0==h.Right.customSidePanelWidth?(h.Right.sidePanel=this.minWidth,h.Right.customSidePanelWidth=this.minWidth):h.Right.sidePanel=h.Right.customSidePanelWidth>=this.minWidth?h.Right.customSidePanelWidth:this.minWidth,this.holder.setWidth(h.Right.sidePanel),setTimeout(function(){UIUtil.Component.initComponent("#sprklne"),ae(),ne(),C&&Q(),B(i,n,t,a.startRow,a.startCol)},0),r.show()}function T(){document.activeElement.blur(),$(),h.Right.sidePanel=0,this.holder.setWidth(0)}function N(e){r||V(),e&&r.open(),r.show(),r.alive&&(document.activeElement.blur(),r.open(),G(),U(),ae(),ne(),C&&Q())}function G(){var e=o.view.getActiveGridID(),t=(o.view.getResourceID(e),o.view.getSheetID(e)),r=(o.view.getVersionID(e),o.view.getSelectedSheets(e),o.view.getSheetState(e,t)),i=r.getActiveRange(),n=r.getActiveCellRange();I.activeRange=i,I.activeCell=n}function U(){return I.activeCell}function B(e,t,i,n,a){var l=o.view.getActiveGridID(),s=(e=o.view.getResourceID(l),t=o.view.getSheetID(l),i=o.view.getVersionID(l),o.data.getWorkBook(e,i).getSheetObj(t).sparklines.getInfo(n,a));r&&r.alive&&(s?r.panel.querySelector(W.groupArea).classList.remove("sPDisable"):r.panel.querySelector(W.groupArea).classList.add("sPDisable"))}o.view.Events.Key.Entry.RightPane.Node.addChildNode(q),e.document.createElement("span").classList.add("ZsLoader"),e.document.createElement("span").classList.add("ZsNoMsg");var W={lineType:"#lineTyp",colType:"#colTyp",winlossType:"#winlosTyp",highPoint:"#hP",firstPoint:"#pvtFP",negativePoint:"#pvtNP",lowPoint:"#pvtLP",lastPoint:"#pvtLstP",allPoints:"#AllP",showHidden:"#pvtShR",showAxis:"#pvtSA",reverse:"#pvtPD",gap:"#pvtGap",zero:"#pvtZero",lines:"#pvtLines",skip:"#pvtSkip",autoMin:"#autoSpMin",sameMin:"#sameSpMin",custMin:"#custSpMin",autoMax:"#autoSpMax",sameMax:"#sameSpMax",custMax:"#custSpMax",group:"#grp",ungroup:"#ugrp",groupDropDown:"#spkGroupte",wholeGroup:"#wgrp",highPointColor:"#hPC",firstPointColor:"#pvtFPC",negativePointColor:"#pvtNPC",lowPointColor:"#pvtLPC",lastPointColor:"#pvtLstPC",markerColor:"#AllPC",sparklineColor:"#inputSpk1",minValue:"#custMin",maxValue:"#custMax",orientation:"#orientation",sourceRange:"#sRange",back:".back",remove:"#rmv",removeGroup:"#rmvgrp",editArea:"#spkEditArea",editButton:"#edit",editCloseButton:"#editClose",sourceRangePicker:"#sPicker",destRangePicker:"#dPicker",editSubmit:"#CreateButton",editClose:"#CancelButton",editGroupCheckbox:"#spkGrp",editSingleCheckbox:"#spkSel",close:"#sPClose",panelArea:"#sPArea",groupArea:"#spkGrpArea",verticalAxisMenu:"#vtAx",horizontalAxisMenu:"#hzAx"},z={},K={"#hPC":W.highPoint,"#pvtLPC":W.lowPoint,"#pvtFPC":W.firstPoint,"#pvtLstPC":W.lastPoint,"#pvtNPC":W.negativePoint,"#AllPC":W.allPoints,"#inputSpk1":void 0};function _(){var e=r.panel.querySelector("#vrtAxis");r.panel.querySelector("#hrzAxis").classList.remove("tgl"),e.classList.contains("tgl")?(r.panel.querySelector(W.verticalAxisMenu).checked=!1,e.classList.remove("tgl")):e.classList.add("tgl")}function Z(){var e=r.panel.querySelector("#hrzAxis");r.panel.querySelector("#vrtAxis").classList.remove("tgl"),e.classList.contains("tgl")?(r.panel.querySelector(W.horizontalAxisMenu).checked=!1,e.classList.remove("tgl")):e.classList.add("tgl")}function j(){x(),ie()}function H(){r.panel.querySelector(W.custMin).checked=!0,L()}function F(){r.panel.querySelector(W.custMax).checked=!0,L()}function J(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),r=o.view.getSheetID(e),i=(o.view.getVersionID(e),o.view.getSelectedSheets(e)),n=o.view.getSheetState(e,r).getRanges();u.removeSparklines(t,e,i,r,n,"SPARKLINE_REMOVE"),l.publish(s.UI,c.SidePanel.Sparklines.CLOSE),document.activeElement.blur()}function Y(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),r=o.view.getSheetID(e),i=o.view.getVersionID(e),n=o.view.getSelectedSheets(e),a=o.view.getSheetState(e,r).getRanges(),p=o.data.getWorkBook(t,i).getSheetObj(r),v={};for(var g in a)for(var d=a[g],S=d.startRow;S<=d.endRow;S++)for(var h=d.startCol;h<=d.endCol;h++){var k=p.sparklines.getInfo(S,h).properties;if(k)var P=k.id;v[P]=k.outputRange}var w=[];for(var C in v){var R=v[C];for(g=0;g<R.length;g++)w.push(R[g])}u.removeSparklines(t,e,n,r,se(w),"SPARKLINE_GROUP_REMOVE"),l.publish(s.UI,c.SidePanel.Sparklines.CLOSE),document.activeElement.blur()}function X(){var e=o.view.getActiveGridID(),t=o.view.getSheetID(e),i=(o.view.getSheetState(e,t),U());r.panel.querySelector(W.editGroupCheckbox).checked?function(e){var t=o.view.getActiveGridID(),r=o.view.getResourceID(t),i=o.view.getSheetID(t),n=o.view.getVersionID(t),l=o.data.getWorkBook(r,n).getSheetObj(i),s=(o.view.getSheetState(t,i),l.sparklines.getInfo(e.startRow,e.startCol).properties),c=s.id,u=s.sparklineProperties,p=(s.outputRange,w[W.sourceRangePicker].value),v=w[W.destRangePicker].value,g=u.sparklineType;a.SparklinePool.create(p,v,g,c,"EDIT_SPARKLINE_GROUP_DATA")}(i):function(e){var t=o.view.getActiveGridID(),r=o.view.getResourceID(t),i=o.view.getSheetID(t),n=o.view.getSelectedSheets(t),a=o.view.getVersionID(t),l=w[W.sourceRangePicker].value,s=JSUtil.Range.parseRange(r,a,l),c=[];if(function(e){if(void 0==e)return pe(1),!1;if(e.range.startRow!=e.range.endRow&&e.range.startCol!=e.range.endCol)return pe(2),!1;return!0}(s)){c.push([s.sheetID]);var p=U();u.editSparkline(r,t,i,n,c,[s.range],[p])}}(),$()}function Q(){C=!0;var e=r.panel.querySelector(W.editArea);r.panel.querySelector(W.editSingleCheckbox).checked=!0,r.panel.querySelector(W.panelArea).classList.add("sPDisable"),ue(),L(),e.classList.add("shEdArea")}function $(){C=!1;var e=r.panel.querySelector(W.editArea);r.panel.querySelector(W.panelArea).classList.remove("sPDisable"),e.classList.remove("shEdArea"),x()}function ee(){ue()}function te(){!function(){for(var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),n=o.view.getSheetID(e),l=o.view.getVersionID(e),s=o.data.getWorkBook(t,l),c=s.getSheetObj(n),u=(o.view.getSheetState(e,n),U()),p=c.sparklines.getInfo(u.startRow,u.startCol).properties,v=p.inputRange,g=p.outputRange,d=p.orientationArray,S="",h="",k=0;k<v.length;k++){var C=g[k],R=d[k],I=c.sparklines.getInfo(C[0],C[1]).properties,y=a.SparklinePool.getDataRange(t,l,I,C[0],C[1]);if(void 0!=y){var m;if(C[0]==C[2]){var f=0,D=0;"HORIZONTAL"==R?f=C[3]-C[1]:D=C[3]-C[1],m=new i.Range(y.range.startRow,y.range.startCol,y.range.endRow+f,y.range.endCol+D)}else{var f=0,D=0;"HORIZONTAL"==R?f=C[2]-C[0]:D=C[2]-C[0],m=new i.Range(y.range.startRow,y.range.startCol,y.range.endRow+f,y.range.endCol+D)}var A=s.SheetList.getById(y.sheetID).Name,E=(A=/[-\s]/.test(A)?"'"+A+"'":A)+"."+m.getLabel()+";";S+=E}else S+=P}S=S.substring(0,S.length-1);for(var k=0;k<g.length;k++){var C=g[k],q=new i.Range(C[0],C[1],C[2],C[3]),A=s.SheetList.getById(C[4]).Name,E=(A=/[-\s]/.test(A)?"'"+A+"'":A)+"."+q.getLabel()+";";h+=E}h=h.substring(0,h.length-1),ve([W.sourceRangePicker,W.destRangePicker],r.panel,void 0,!1),w[W.sourceRangePicker].value=S,w[W.destRangePicker].value=h,w[W.destRangePicker].Editor.classList.remove("sPDisable")}()}function re(e){var t=r.panel.querySelector(e);UIUtil.Component.initComponent(e),p.bind(t,"zcolorselectpickerclose",function(t,i){oe(),z[e]=i.currentValue?i.currentValue:i.options.value,K[e]&&(r.panel.querySelector(K[e]).checked=!0),ie()})}function ie(){var e,t,i,n,a,l=o.view.getActiveGridID(),s=o.view.getResourceID(l),c=o.view.getSheetID(l),p=o.view.getVersionID(l),v=o.view.getSelectedSheets(l),g=(o.view.getSheetState(l,c).getActiveRange(),U()),d=o.data.getWorkBook(s,p).getSheetObj(c).sparklines.getInfo(g.startRow,g.startCol),S=d.properties.sparklineProperties,h=d.properties.outputRange;if(S=JSON.parse(JSON.stringify(S)),r.panel.querySelector(W.lineType).checked?S.sparklineType="line":r.panel.querySelector(W.colType).checked?S.sparklineType="column":r.panel.querySelector(W.winlossType).checked&&(S.sparklineType="winloss"),e=r.panel.querySelector(W.gap).checked?"gap":r.panel.querySelector(W.zero).checked?"zero":r.panel.querySelector(W.lines).checked?"connect":"skip",r.panel.querySelector(W.autoMin).checked)t="automatic";else if(r.panel.querySelector(W.sameMin).checked)t="same";else if(t="custom",n=parseInt(r.panel.querySelector(W.minValue).value),isNaN(n))return;if(r.panel.querySelector(W.autoMax).checked)i="automatic";else if(r.panel.querySelector(W.sameMax).checked)i="same";else if(i="custom",a=parseInt(r.panel.querySelector(W.maxValue).value),isNaN(a))return;S.highPoint=r.panel.querySelector(W.highPoint).checked,S.firstPoint=r.panel.querySelector(W.firstPoint).checked,S.lowPoint=r.panel.querySelector(W.lowPoint).checked,S.lastPoint=r.panel.querySelector(W.lastPoint).checked,S.negativePoints=r.panel.querySelector(W.negativePoint).checked,S.marker=r.panel.querySelector(W.allPoints).checked,S.sparklineColor=z[W.sparklineColor],S.markerColor=z[W.markerColor],S.firstPointColor=z[W.firstPointColor],S.highPointColor=z[W.highPointColor],S.lastPointColor=z[W.lastPointColor],S.lowPointColor=z[W.lowPointColor],S.negativePointColor=z[W.negativePointColor],S.hidden=r.panel.querySelector(W.showHidden).checked,S.emptyCell=e,S.showAxis=r.panel.querySelector(W.showAxis).checked,S.reverse=r.panel.querySelector(W.reverse).checked,S.verticalAxisMinimum=t,S.verticalAxisMaximum=i,S.minValue=n,S.maxValue=a,u.modifySparklineProperties(s,l,c,v,S,se(h),"SPARKLINE_PROPERTIES")}function oe(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),r=o.view.getSheetID(e),i=o.view.getVersionID(e),n=o.data.getWorkBook(t,i).getSheetObj(r),a=U(),l=n.sparklines.getInfo(a.startRow,a.startCol).properties.sparklineProperties;z[W.highPointColor]=l.highPointColor,z[W.lowPointColor]=l.lowPointColor,z[W.firstPointColor]=l.firstPointColor,z[W.lastPointColor]=l.lastPointColor,z[W.negativePointColor]=l.negativePointColor,z[W.markerColor]=l.markerColor,z[W.sparklineColor]=l.sparklineColor}function ne(){var e,t=o.view.getActiveGridID(),i=o.view.getResourceID(t),n=o.view.getSheetID(t),l=o.view.getVersionID(t),s=o.data.getWorkBook(i,l),c=o.data.getWorkBook(i,l).getSheetObj(n),u=U(),p=c.sparklines.getInfo(u.startRow,u.startCol).properties,v=a.SparklinePool.getDataRange(i,l,p,u.startRow,u.startCol);if(void 0!=v){var g=s.SheetList.getById(v.sheetID).Name;e=(g=/[-\s]/.test(g)?"'"+g+"'":g)+"."+v.range.getLabel()}else e=P;r.panel.querySelector(W.sourceRange).innerText=S["SidePanel.Sparklines.Source"]+": "+e}function ae(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),i=o.view.getSheetID(e),n=o.view.getVersionID(e),a=o.data.getWorkBook(t,n).getSheetObj(i),l=U(),s=a.sparklines.getInfo(l.startRow,l.startCol).properties;if(void 0!=s){var c=s.sparklineProperties,u=s.orientationChangeable;if("line"==c.sparklineType?r.panel.querySelector(W.lineType).checked=!0:"column"==c.sparklineType?r.panel.querySelector(W.colType).checked=!0:r.panel.querySelector(W.winlossType).checked=!0,"gap"==c.emptyCell?r.panel.querySelector(W.gap).checked=!0:"zero"==c.emptyCell?r.panel.querySelector(W.zero).checked=!0:"lines"==c.emptyCell?r.panel.querySelector(W.lines).checked=!0:"skip"==c.emptyCell&&(r.panel.querySelector(W.skip).checked=!0),oe(),function(e){var t=e.highPointColor,r=e.lowPointColor,i=e.firstPointColor,o=e.lastPointColor,n=e.negativePointColor,a=e.markerColor,l=e.sparklineColor;p.zcolorselectbox(W.highPointColor,"setValue",t),p.zcolorselectbox(W.lowPointColor,"setValue",r),p.zcolorselectbox(W.firstPointColor,"setValue",i),p.zcolorselectbox(W.lastPointColor,"setValue",o),p.zcolorselectbox(W.negativePointColor,"setValue",n),p.zcolorselectbox(W.markerColor,"setValue",a),p.zcolorselectbox(W.sparklineColor,"setValue",l)}(c),r.panel.querySelector(W.highPoint).checked=c.highPoint,r.panel.querySelector(W.lowPoint).checked=c.lowPoint,r.panel.querySelector(W.firstPoint).checked=c.firstPoint,r.panel.querySelector(W.lastPoint).checked=c.lastPoint,r.panel.querySelector(W.negativePoint).checked=c.negativePoints,r.panel.querySelector(W.allPoints).checked=c.marker,r.panel.querySelector(W.showAxis).checked=c.showAxis,r.panel.querySelector(W.reverse).checked=c.reverse,u)r.panel.querySelector(W.orientation).classList.remove("sPDisable");else r.panel.querySelector(W.orientation).classList.add("sPDisable");r.panel.querySelector(W.minValue).value="",r.panel.querySelector(W.maxValue).value="","automatic"==c.verticalAxisMinimum?r.panel.querySelector(W.autoMin).checked=!0:"same"==c.verticalAxisMinimum?r.panel.querySelector(W.sameMin).checked=!0:(r.panel.querySelector(W.custMin).checked=!0,r.panel.querySelector(W.minValue).value=c.minValue),"automatic"==c.verticalAxisMaximum?r.panel.querySelector(W.autoMax).checked=!0:"same"==c.verticalAxisMaximum?r.panel.querySelector(W.sameMax).checked=!0:(r.panel.querySelector(W.custMax).checked=!0,r.panel.querySelector(W.maxValue).value=c.maxValue)}}function le(){var e=o.view.getActiveGridID(),t=o.view.getResourceID(e),r=o.view.getSheetID(e),i=o.view.getVersionID(e),n=o.view.getSelectedSheets(e),a=(o.view.getSheetState(e,r),U()),l={r:a.startRow,c:a.startCol,s:r},s=o.data.getWorkBook(t,i).getSheetObj(r).sparklines.getInfo(a.startRow,a.startCol).properties,c=s.id,p=s.outputRange;s.orientationChangeable&&u.changeSparklineOrientation(t,e,r,n,c,se(p),l)}function se(e){for(var t=[],r=[],o=0;o<e.length;o++){var n=e[o],l=new i.Range(n[0],n[1],n[2],n[3]);a.SparklinePool.mergeRanges(l,r)}for(var s=0;s<r.length;s++){l=r[s];t.push(l)}return t}function ce(e,t){var r=o.view.getActiveGridID(),i=o.view.getResourceID(r),n=o.view.getSheetID(r),a=o.view.getVersionID(r),l=o.view.getSelectedSheets(r),s=o.view.getSheetState(r,n).getRanges(),c=U(),p={r:c.startRow,c:c.startCol,s:n},v=o.data.getWorkBook(i,a).getSheetObj(n);if(t)u.ungroupSparklines(i,r,l,n,s,"SPARKLINE_UNGROUP");else if(e){var g={};for(var d in s)for(var S=s[d],h=S.startRow;h<=S.endRow;h++)for(var k=S.startCol;k<=S.endCol;k++){var P=v.sparklines.getInfo(h,k);if(P)var w=v.sparklines.getInfo(h,k).properties.id;g[w]=P.properties.outputRange}var C=[];for(var R in g){var I=g[R];for(d=0;d<I.length;d++)C.push(I[d])}u.groupSparklines(i,r,n,l,se(C),p,!0,"SPARKLINE_GROUP")}else u.groupSparklines(i,r,n,l,s,p,!1,"SPARKLINE_GROUP");document.activeElement.blur()}function ue(){var e,t=o.view.getActiveGridID(),i=o.view.getResourceID(t),n=o.view.getSheetID(t),l=o.view.getVersionID(t),s=o.data.getWorkBook(i,l),c=s.getSheetObj(n),u=U(),p=c.sparklines.getInfo(u.startRow,u.startCol).properties,v=a.SparklinePool.getDataRange(i,l,p,u.startRow,u.startCol);if(void 0==v)e=P;else{var g=v.sheetName;e=(g=/[-\s]/.test(g)?"'"+g+"'":g)+"."+v.range.getLabel()}g=s.SheetList.getById(n).Name;var d=(g=/[-\s]/.test(g)?"'"+g+"'":g)+"."+u.getLabel();ve([W.sourceRangePicker,W.destRangePicker],r.panel,void 0,!0),w[W.sourceRangePicker].value=e,w[W.destRangePicker].value=d,w[W.destRangePicker].Editor.classList.add("sPDisable")}function pe(e){var t={buttons:[{text:S.OK,primary:!0}],title:S["Alert.Title.InvalidSourceRange"]};switch(e){case 1:i.ZSAlert(S["SidePanel.Sparklines.Alert.SourceInvalidTryAgain"],t);break;case 2:i.ZSAlert(S["SidePanel.Sparklines.Alert.MultiRowSource"],t)}}function ve(e,t,r,n){var a=o.view.getActiveGridID();o.view.getResourceID(a),o.view.getSheetID(a),o.view.getVersionID(a);e.forEach(function(e,r){var o=t.querySelector(e),a=new i.Editors.RangeEditor(o);d.register(a,n),w[e]=a})}k.openSidePanel=function(){r||V(),r.open()},l.register(s.UI,c.SidePanel.Sparklines.OPEN,N,"ISRIGHTCLICK"),l.register(s.UI,c.SidePanel.Sparklines.CLOSE,function(){r&&r.hide()}),l.register(s.UI,c.SidePanel.Sparklines.SELECT,function(e,t,r,n){var a,p=o.view.getActiveGridID(),v=o.view.getSheetState(p,t);R=!0,l.publish(s.Selector.BoundUpdate.Range,c.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:r,RANGEID:v.getActiveID()});for(var g=0;g<n.length;g++){var d=n[g];l.publish(s.Selector.BoundUpdate.Range,c.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:r,RANGE:d,TYPE:void 0}),0==g&&(a=new i.Range(d.startRow,d.startCol,d.startRow,d.startCol),l.publish(s.Selector.BoundUpdate.Cell,c.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:r,ActiveCellRange:a,ROW:a.startRow,COL:a.startCol,TYPE:void 0}))}u.ScrollCellIntoView(e,t,r,a.startRow,a.startCol)},"RID","SHEETID","VERSION","RANGES"),l.register(s.UI,c.SidePanel.Sparklines.CREATE,function(){R&&(N(!0),R=!1)}),l.register(s.Listener,c.SheetAction.ACTIVE_CELL.INFO,B,"RID","SHEETID","VERSION","ROW","COLUMN")}(this);
!function(e){var t,i=e.sPlusPlus,n=ZSClass.KeyMapping,s=i.view.measures,o=e.ZSConstants,a=o.CommandConstants,r=e.ZSEvents,l=r.topic,c=r.Groups,d=r.Names,h=ZSClass.Editors,u=o.FeatureConstants,p=o.wCC,y=ZSClass.SidePanel,C=ZSClass.SidePanelClassList,v=[C.right],S=C.right,P=e.ZSConstants.JSKeyCode,E=e.ZSConstants.I18N,f=e.UIUtil.Component,g=i.view.Toolbar.Feature[u.NOTIFY_COLLABORATOR],R=i.view.Toolbar.Feature[u.COLLAB_CHAT],L=i.view.Toolbar.Feature[u.COLLABORATORS],m=i.view.Toolbar.Feature[u.USER_PRESENCE],D=!0,I=!1,w=!1,O=!1;var A=new function(){n.call(this)},T=i.view.Events.Key;function q(){t.icon.classList.remove("sPCmtNtfyPnt"),0==s.Right.sidePanel&&0==s.Right.customSidePanelWidth?(s.Right.sidePanel=this.minWidth,s.Right.customSidePanelWidth=this.minWidth):s.Right.sidePanel=s.Right.customSidePanelWidth>=this.minWidth?s.Right.customSidePanelWidth:this.minWidth,this.holder.setWidth(s.Right.sidePanel),k();var e=i.view.getActiveGridID(),n=i.view.getResourceID(e);i.data.DocRegistry[n].RemoteViewInfo&&i.data.DocRegistry[n].RemoteViewInfo.REMOTE_ENC_DOC_ID;if(D){e=i.view.getActiveGridID(),n=i.view.getResourceID(e);i.data.DocRegistry[n].RemoteViewInfo&&i.data.DocRegistry[n].RemoteViewInfo.REMOTE_ENC_DOC_ID||R.load(50),D=!1}R.isPanelOpen=!0,R.panel&&(R.panel.querySelector(".colbChatPanel").scrollTop=R.panel.querySelector(".colbChatPanel").scrollHeight,JSUtil.RCMentionDataShim.connectProcessMention(R.panel.querySelector("#chat")))}function N(){s.Right.sidePanel=0,this.holder.setWidth(0),T.focusContext(T.Entry.CellEditor.Context),R.isPanelOpen=!1}function _(e){var t=UserAction.getTemplate(["collaboratorIcon"]);this.icon.appendChild(t.collaboratorIcon),this.icon.title=E.Chat}function b(){var e=UserAction.getTemplate(["CHAT_PANEL_TEMPLATE"]).CHAT_PANEL_TEMPLATE;this.panel.appendChild(e),this.panel.addEventListener("mousedown",k),this.panel.id=p.SP+"CollabChat"+p.HOLDER;var n=this.panel;if(R.panel=n,function(e){var t=i.view.getActiveGridID(),n=i.view.getResourceID(t),s=i.view.getVersionID(t),o=i.data.getWorkBook(n,s);f.bind(document.getElementById("chatPanelMenu"),"zmenubeforeshow",function(){document.querySelector("#highlightPresence").checked=o.showUserPresence}),e.querySelector("#spNotifyColb").addEventListener("click",function(){g.execute()}),e.querySelector("#highlightPresence").addEventListener("click",function(){var e;e=this.checked,m.execute(e)})}(this.panel),L){var s=L.getPanelDom();n.querySelector("#collabChatContainer").appendChild(s),n.querySelector("#sPuserOpt").addEventListener("click",function(){n.querySelector("#spChat").style.display="none",n.querySelector("#spUsers").style.display="block",n.querySelector("#sPchatOpt").classList.remove("active"),n.querySelector("#sPuserOpt").classList.add("active")}.bind(this))}else n.querySelector("#sPuserOpt").style.display="none";this.panel.querySelector(".spClsIcon").addEventListener("click",function(){this.close()}.bind(this)),n.querySelector("#sPchatOpt").addEventListener("click",function(){n.querySelector("#spUsers").style.display="none",n.querySelector("#spChat").style.display="block",n.querySelector("#sPuserOpt").classList.remove("active"),n.querySelector("#sPchatOpt").classList.add("active")}.bind(this));var o=n.querySelector("#spUsersLoader").cloneNode(!0);n.querySelector(".colbChatPanel").appendChild(o);var a=i.view.getActiveGridID(),r=i.view.getResourceID(a),l=i.data.DocRegistry[r].RemoteViewInfo&&i.data.DocRegistry[r].RemoteViewInfo.REMOTE_ENC_DOC_ID;if(o.id="initChatLoader",l)o&&o.remove(),document.querySelector("#ZspNoChat").style.display="";else{o.style.display="";var c=n.querySelector(".colbChatPanel");c.addEventListener("scroll",function(){0===c.scrollTop&&function(e){var i=t.panel.querySelector("#colbChatLoader");if(void 0==i)return void(t.panel.querySelector("#chatInfo").style.display="none");t.panel.querySelector("#chatInfo").style.display="block",i.style.display="",R.load(50)}(this.panel)})}new h.TextAreaEditor(this.panel.querySelector("#chat")).addListeners(M);var d=this.panel.querySelector("#chat"),u=this.panel.querySelector("#ctPHldr");d.addEventListener("input",function(){d.textContent&&u.classList.remove("sPPlaceHolder")}),L&&L.load(),w&&n.querySelector("#sPuserOpt").click(),O=!0}T.Entry.RightPane.Node.addChildNode(A);var M={keypress:function(e){if(e.which==P.ENTER&&!e.shiftKey&&(e.preventDefault(),0!==(i=this.innerHTML).length&&i.trim())){var t=JSUtil.RCMentionDataShim.getRichTextContent(this);R.add(t),this.innerHTML="",this.parentElement.classList.add("sPPlaceHolder")}var i;this.textContent&&this.parentElement.classList.remove("sPPlaceHolder");return e.stopPropagation(),!1}};function k(){i.view.Events.Key.focusContext(A)}function H(e){if(I=e,-1==o.Meta.HideFeaturesList.indexOf(u.COLLAB_CHAT)){var n=i.view.getActiveGridID(),s=i.view.getResourceID(n),a=i.data.DocRegistry[s].RemoteViewInfo&&i.data.DocRegistry[s].RemoteViewInfo.REMOTE_ENC_DOC_ID;if(t&&(e||a))t.show(),t.icon.classList.remove("sPAddNew")}}L.toggleUserPresenceLoader=function(e){t.panel.querySelector("#spUsersLoader").style.display=e?"block":"none"},R.addPanelNotification=function(){t.icon.classList.add("sPCmtNtfyPnt")},l.register(c.UI,d.SidePanel.Chat.open,function(e){w=e,t&&t.open(),O&&w&&R.panel.querySelector("#sPuserOpt").click()},"COLLAB_PANEL"),l.register(c.UI,d.Layout.TEMPLATE_LOADED,function(){(t=y.add({panelName:"CHAT",onCreate:_,callBack:b,allowed:v,direction:S,minWidth:320,maxWidth:500})).onOpen=q,t.onClose=N,t.hide(),H(I)}),l.register(c.Listener,d.WMSAction.ON_SHARE,H,"ISSHARED"),l.register(c.Listener,d.ShareMeta.UPDATE,function(e,t){t&&H(t[a.SHARE_INFO].isShared)},"RID","META")}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSConstants.FeatureConstants;e.view.Toolbar.Feature[n.COLLABORATORS].getPanelDom=function(){return UserAction.getTemplate(["COLLAB_PANEL_TEMPLATE"]).COLLAB_PANEL_TEMPLATE}}(this);
!function(e){var t,i,n,s,o,a,l,r,d,c,P,v=e.sPlusPlus,S=(t=e.ZSEvents).topic,h=t.Groups,u=t.Names,I=e.UserAction,g=e.ZSClass,E=v.view.measures,p=g.KeyMapping,C=(g=e.ZSClass).Pivot,O=g.SidePanel,D=e.ZSConstants.CommandConstants,R=g.SidePanelClassList,T=[R.right,R.left,R.bottom],f=R.right,_=e.document,A=e.ZSConstants.PivotConstant,L=(e.UIUtil.Component,v.data.Defaults.MAX_COL,v.data.Defaults.MAX_ROW,e.ZSConstants),w=(L.FeatureConstants,L.I18N),m=(L.wCC,S=(t=e.ZSEvents).topic,t.Groups);u=t.Names;var V=new function(){p.call(this)},y=v.view.Events.Key;function N(e){var t=I.getTemplate(["pivotIcon"]);this.icon.appendChild(t.pivotIcon),this.icon.title=w["Menuitem.InsertTab.Pivot"]}function U(){C.SP&&0!==Object.keys(C.SP).length&&"false"!=C.SP.isEditMode||i&&i.hide()}function G(){if(0==E.Right.sidePanel&&0==E.Right.customSidePanelWidth?(E.Right.sidePanel=i.minWidth,E.Right.customSidePanelWidth=i.minWidth):E.Right.sidePanel=E.Right.customSidePanelWidth>=i.minWidth?E.Right.customSidePanelWidth:i.minWidth,v.view.Events.Key.focusContext(V),C.PanelID!=C.ID&&(!C.SP||"false"==C.SP.isEditMode)){if(d&&d._reset(),B("#pB_allFields"),B("#pf ul,#rf ul,#cf ul,#df ul"),n&&(n.querySelector("#pvtSearchField").value=""),d&&d.setValue(),r&&r.changeLoaderDisp(!0),c&&c.setValue(),P&&P.setValue(),a&&"temp"==C.ID&&q("pivotGen"),"temp"!=C.ID){var e=v.view.getActiveGridID(),t=v.view.getResourceID(e),s=v.view.getVersionID(e),o=g.Pivot.ID,l=v.data.getWorkBook(t,s).PivotCollection.get(o),S=(l.srcKey,l[D.SOURCE]);v.data.getWorkBook(t,s).getSheetObj(S[0]);l[A.ROW_FIELDS].length<1&&l[A.COLUMN_FIELDS].length<1&&l[A.DATA_FIELDS].length<1?l.fieldsExist=!1:l.fieldsExist=!0;var h=[];h.push(S[0]);var u=new g.ParamGenerator(h,t,s).getSheets(),p=new g.Range(S[1],S[2],S[3],S[4]);I.getPivotFields(t,u[0],s,p,C.ID)}else n?x():setTimeout(function(){x()},1e3);C.PanelID=C.ID}i&&i.holder&&i.holder.setWidth(E.Right.sidePanel)}function W(){i&&i.close()}function b(){if(C.PanelID){r.closeErrBanner(),r.changeCreatePivotBt(!0,!0),C.PanelID=void 0,E.Right.sidePanel=0,this.holder.setWidth(0),y.focusContext(y.Entry.CellEditor.Context);var e=v.view.getActiveGridID(),t=v.view.getResourceID(e),i=v.view.getVersionID(e),n=v.data.getWorkBook(t,i),s=v.view.getSheetID(e),o=(e=v.view.getActiveGridID(),n.getSheetObj(s)),a=v.view.getSheetState(e,s).getActiveCellRange();o.Pivot.isXists(a.startRow,a.startCol)||U()}}function B(e){n&&n.querySelectorAll(e).forEach(function(e){if(e.hasChildNodes())for(;e.firstChild;)e.removeChild(e.firstChild)})}function M(){var e=I.getTemplate(["SPP_HEADER","SP_PIVOT","SPP_ERRORBLOCK","SPP_ERRORMSG_DIV","SPP_TAB","SPP_CHANGESOURCE","SPP_BUILDER","SPP_AUTOOPTION","SPP_TOTALOPTION","SPP_COLOR","SPP_MENUOPTION"]),t=_.createElement("div");t.id="SPPIVOT",t.className="wid wid100 hgt100",t.appendChild(e.SP_PIVOT),this.panel.appendChild(t);var i=t.querySelector("#spp_header");i.appendChild(e.SPP_HEADER),(i=t.querySelector("#err")).appendChild(e.SPP_ERRORBLOCK),(i=t.querySelector("#errMaxField")).appendChild(e.SPP_ERRORMSG_DIV),(i=t.querySelector("#pivotTab")).appendChild(e.SPP_TAB),i.appendChild(e.SPP_CHANGESOURCE),(i=t.querySelector("#pivotGenTab")).appendChild(e.SPP_BUILDER),i=t.querySelector("#pivotMoreArea"),g.Pivot.enablePivotAutoAction&&i.appendChild(e.SPP_AUTOOPTION),i.appendChild(e.SPP_TOTALOPTION),i.appendChild(e.SPP_COLOR),i.appendChild(e.SPP_MENUOPTION),n=this.panel,s=n.querySelector("#pivotGen"),o=n.querySelector("#pivotMore"),s.addEventListener("click",k),o.addEventListener("click",k),l=n.querySelector("#pivotMoreTab"),a=n.querySelector("#pivotGenTab"),n.querySelector("#sPClose").addEventListener("click",W),(r=new C.BuilderModel(n)).init(),(d=new C.ChangeSource(n)).bindEvent(),new C.Refresh(n).bindEvent(),new C.Delete(n).bindEvent(),new C.Move(n).bindEvent(),(c=new C.Style(n)).init(),(P=new C.TotalController(n)).bindEvent(),new C.Chart(n).bindEvent(),C.SP={},r.changeLoaderDisp(!0),d.setValue(),c&&c.setValue(),P.setValue()}function k(e){q(e.target.id)}function q(e){"pivotGen"===e?(a.style.display="",l.style.display="none",s.classList.add("active"),o.classList.remove("active")):"temp"!=C.ID&&(a.style.display="none",l.style.display="",s.classList.remove("active"),o.classList.add("active"))}function x(){var e=v.view.getActiveGridID(),t=v.view.getResourceID(e),i=v.view.getVersionID(e),n=v.data.getWorkBook(t,i).PivotCollection.get(g.Pivot.ID);"temp"!=C.ID&&n.fieldsExist?o.classList.remove("zsDisable"):o.classList.add("zsDisable"),r.changeLoaderDisp(!1),r.construct()}y.Entry.RightPane.Node.addChildNode(V),S.register(h.UI,u.SidePanel.PIVOT.TOGGLE,function(){var e=v.view.getActiveGridID(),t=v.view.getResourceID(e),n=v.view.getVersionID(e),s=v.data.getWorkBook(t,n),o=v.view.getSheetID(e),a=(e=v.view.getActiveGridID(),s.getSheetObj(o)),l=v.view.getSheetState(e,o).getActiveCellRange();a.Pivot.isXists(l.startRow,l.startCol)?i&&i.toggle():U()}),S.register(h.UI,u.SidePanel.PIVOT.SHOW_ICON,function(){i.alive?G():i&&i.show()}),S.register(h.UI,u.SidePanel.PIVOT.HIDE_ICON,U),S.register(h.UI,u.SidePanel.PIVOT.OPEN,function(){i&&i.open()}),S.register(h.UI,u.SidePanel.PIVOT.CLOSE,W),S.register(h.UI,u.Layout.TEMPLATE_LOADED,function(){(i=O.add({panelName:"PIVOT",onCreate:N,callBack:M,allowed:T,direction:f,isContextualPanel:!0,scrollCellToView:!0,minWidth:320,maxWidth:500})).onOpen=G,i.onClose=b,i.hide()}),S.register(m.Listener,u.UserAction.PIVOT.GET_FIELDS,x),S.register(m.UserAction,u.UserAction.PIVOT.HANDLE_ERROR,function(e){r&&r.handleError(e)},"ERRORMSG"),S.register(m.Listener,u.UserAction.PIVOT.CREATE_INNEWSHEET,function(e){r.createPivotinNewSheet(e)},"NEWSHEETID"),S.register(m.Listener,u.UserAction.PIVOT.CANCEL_BUILDER,function(){r.cancel()}),S.register(m.Listener,u.UserAction.PIVOT.CHANGE_CREATEPIVOT_BUTTON,function(e,t,i){r&&"temp"!=C.ID&&i&&o.classList.remove("zsDisable"),r&&r.changeCreatePivotBt(e,t)},"setToGenerate","isDisable","fieldsExist"),S.register(m.Listener,u.UserAction.PIVOT.SET_GROUP_VALUE,function(e,t,i,n){r&&r.setGroupValue(e,t,i,n)},"colIndex","min","max","size")}(this);
!function(e){var t,i,n=e.sPlusPlus,s=e.ZSEvents,o=s.topic,a=s.Groups,c=s.Names,r=e.UserAction,d=((t=e.ZSClass).KeyMapping,(t=e.ZSClass).SidePanel),l=t.SidePanelClassList,E=[l.right,l.left,l.bottom],u=l.right,C=e.document,f=e.ZSConstants.I18N,g=n.view.Events.Key,h=e.ZSDevTools.Logger,p=n.view.Toolbar.Feature.FEEDBACK;function A(e){var t=r.getTemplate(["feedbackIcon"]);this.icon.appendChild(t.feedbackIcon),this.icon.id="SP_FEEDBACK_ICON",this.icon.title=f.Feedback,this.icon.classList.add("sPFdBckBtm"),i=this.icon;var n=C.querySelector(".sPRt");this.icon.addEventListener("click",function(){n.classList.add("close"),p.showFeedBackDialog()}),g.focusContext(g.Entry.CellEditor.Context)}function L(){if(n.data.AppRegistry.allowSPFeedbackIcon){if(i)return;h.debug("Feedback icon: Initiate feedback icon creation in side panel");d.add({panelName:"FEEDBACK",onCreate:A,allowed:E,direction:u})}}o.register(a.UI,c.Layout.TEMPLATE_LOADED,L),o.register(a.Listener,c.GridAction.WAKEUPCALL,L),o.register(a.UI,c.SidePanel.FEEDBACKICON.REMOVE,function(){i.remove()})}(this);
!function(t){var e,s=t.sPlusPlus,n=t.ZSEvents,r=n.topic,u=n.Groups,o=n.Names,a=t.ZSConstants,i=a.FeatureConstants,I=t.document,E=t.ZSConstants.I18N,c=s.view.Toolbar.Feature[i.CUT],N=((e=I.createElement("li")).setAttribute("data",'{"skipshortcutregister": false, "shortcutkey":"ctrl+x", "label":"'+E["MenuItem.HomeTab.Cut"]+'"}'),e);function T(t,e){if("VERSION"!=e){var s=N.cloneNode(!0);s.addEventListener("click",function(){c.execute()}),t[a.ContextConstant.CUT]=s}}r.register(u.UI,o.Menu.INIT_GRID_CONTEXT,T,"MENU_BAG","VIEW"),r.register(u.UI,o.Menu.INIT_ROW_HEAD_CONTEXT,T,"MENU_BAG","VIEW"),r.register(u.UI,o.Menu.INIT_COL_HEAD_CONTEXT,T,"MENU_BAG","VIEW")}(this);
!function(e){var t,s=e.sPlusPlus,n=e.ZSEvents,r=n.topic,i=n.Groups,u=n.Names,o=e.ZSConstants,a=o.FeatureConstants,C=e.document,c=e.ZSConstants.I18N,I=s.view.Toolbar.Feature[a.COPY],N=((t=C.createElement("li")).setAttribute("data",'{"skipshortcutregister": true, "shortcutkey":"ctrl+c", "label":"'+c["MenuItem.HomeTab.Copy"]+'"}'),t);function T(e){if(-1==ZSConstants.Meta.HideFeaturesList.indexOf(a.COPY)){var t=N.cloneNode(!0);t.addEventListener("click",function(e){I.execute(e)}),e[o.ContextConstant.COPY]=t}}r.register(i.UI,u.Menu.INIT_GRID_CONTEXT,T,"MENU_BAG"),r.register(i.UI,u.Menu.INIT_ROW_HEAD_CONTEXT,T,"MENU_BAG"),r.register(i.UI,u.Menu.INIT_COL_HEAD_CONTEXT,T,"MENU_BAG"),r.register(i.UI,u.Menu.INIT_LOCK_CONTEXT,T,"MENU_BAG")}(this);
!function(t){var e,n,s=t.sPlusPlus,i=t.ZSEvents,u=i.topic,E=i.Groups,I=i.Names,a=t.ZSConstants.FeatureConstants,T=t.ZSConstants.wCC,o=t.document,r=t.ZSConstants.I18N,C=s.view.Toolbar.Feature[a.PASTE],N=s.data.UserInfo,S=t.UIUtil.Component,_=((n=o.createElement("li")).setAttribute("data",'{"label":"'+r["MenuItem.HomeTab.Paste"]+'"}'),n.setAttribute("data-menu-id",T.SUBMENUITEM+a.PASTE+T.IDENTITY),n.setAttribute("data-item-type","splitmenu"),n.id="PASTE_CM_"+e,n);function m(t,n){if("VERSION"!=n){var s=_.cloneNode(!0);s.addEventListener("click",function(){C.execute()}),t[ZSConstants.ContextConstant.PASTE]=s,e++}}u.register(E.UI,I.Menu.INIT_GRID_CONTEXT,m,"MENU_BAG","VIEW"),u.register(E.UI,I.Menu.INIT_ROW_HEAD_CONTEXT,m,"MENU_BAG","VIEW"),u.register(E.UI,I.Menu.INIT_COL_HEAD_CONTEXT,m,"MENU_BAG","VIEW"),u.register(E.UI,I.Menu.CONTEXT_BEFORE_SHOW,function(t,e,n,s){N.activeInfo.getCopyState()?S.zmenu(s,"setMenuItemsAttribute",["#PASTE_CM"],"itemType","splitmenu"):S.zmenu(s,"setMenuItemsAttribute",["#PASTE_CM"],"itemType","default")},"RID","SHEETID","VERSION","UI")}(this);
!function(t){var e=t.sPlusPlus,n=t.document,i=t.ZSEvents,s=i.topic,E=i.Groups,I=i.Names,u=t.ZSConstants,a=u.I18N,r=u.FeatureConstants,T=u.wCC,o=e.view.Toolbar.Feature[r.FILTER];-1!=u.Meta.HideFeaturesList.indexOf(r.USER_LEVEL_FILTER)&&s.register(E.UI,I.Menu.INIT_GRID_CONTEXT,function(t,e){if("VERSION"!=e){var i=n.createElement("li");i.setAttribute("data-menu-id",T.SUBMENUITEM+r.FILTER+T.IDENTITY),i.setAttribute("id",T.MI+r.FILTER+T.IDENTITY),i.innerText=a["MenuItem.HomeTab.Filter"],i.addEventListener("click",function(t){o.execute(t)}),t[u.ContextConstant.FILTER]=i}},"MENU_BAG","VIEW")}(this);
!function(t){var e=t.sPlusPlus,n=t.document,i=t.ZSEvents,s=i.topic,E=i.Groups,I=i.Names,u=t.ZSConstants,r=u.I18N,T=u.FeatureConstants,a=u.wCC,o=e.view.Toolbar.Feature[T.FILTER];-1==u.Meta.HideFeaturesList.indexOf(T.USER_LEVEL_FILTER)&&s.register(E.UI,I.Menu.INIT_GRID_CONTEXT,function(t,e){if("VERSION"!=e){var i=n.createElement("li");i.setAttribute("data-menu-id",a.SUBMENUITEM+T.FILTER+"_CM"+a.IDENTITY),i.setAttribute("id",a.MI+T.FILTER+a.IDENTITY),i.innerText=r["Filter.ContextMenu.Title"],i.addEventListener("click",function(t){o.execute(t)}),t[u.ContextConstant.FILTER]=i}},"MENU_BAG","VIEW")}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants,n=t.ZSConstants.wCC,i=s.FeatureConstants,r=s.I18N,o=t.ZSEvents,a=o.topic,I=o.Groups,u=o.Names,c=e.view.Toolbar.Feature[i.PICKFROMLIST],l=function(){var t=document.createElement("li");return t.setAttribute("data",'{ "skipshortcutregister": true, "shortcutkey":"Alt+Down", "label":"'+r.PickFromList+'..."}'),t.setAttribute("id",n.MI+i.PICKFROMLIST+n.MENU),t};a.register(I.UI,u.Menu.INIT_GRID_CONTEXT,function(t,e){if("VERSION"!=e){var n=l();n.addEventListener("click",c.execute),t[s.ContextConstant.PICKLIST]=n}},"MENU_BAG","VIEW"),a.register(I.UI,u.Menu.CONTEXT_BEFORE_SHOW,function(t){if("MI_GRID_CONTEXT"==t.id){var s=e.view.getActiveGridID(),r=e.view.getSheetID(s),o=e.view.getSheetState(s,r).getRanges()[0],a=t.querySelector("#"+n.MI+i.PICKFROMLIST+n.MENU);o.startRow!=o.endRow||o.startCol!=o.endCol?a&&(a.style.display="none"):a&&(a.style.display="")}},"UI")}(this);
!function(t){var e,n,o,i=t.sPlusPlus,s=t.ZSEvents,a=s.topic,r=s.Groups,l=s.Names,I=i.data.Defaults.MAX_ROW,u=t.ZSConstants,E=u.FeatureConstants,d=t.ZSConstants.wCC,R=u.I18N,c=i.view.Toolbar.Feature[E.HIDE_ROWS],O=t.UIUtil.Component,S=((o=document.createElement("li")).setAttribute("data",'{"label":"'+R["Hide.Rows"]+'","shortcutkey":"Ctrl+Alt+9"}'),o.setAttribute("id",d.MI+E.HIDE_ROWS+"_HIDE"+d.IDENTITY),o),w=function(){var t=document.createElement("li");return t.setAttribute("data",'{"label":"'+R["Show.Rows"]+'","shortcutkey":"Ctrl+Shift+9"}'),t.setAttribute("id",d.MI+E.HIDE_ROWS+"_SHOW"+d.IDENTITY),t}();a.register(r.UI,l.Menu.INIT_ROW_HEAD_CONTEXT,function(t,o){"VERSION"!=o&&((e=S.cloneNode(!0)).addEventListener("click",function(){c.hide()}),t[u.ContextConstant.HIDE_ROWS]=e,(n=w.cloneNode(!0)).addEventListener("click",function(){c.show()}),t[u.ContextConstant.UNHIDE_ROWS]=n)},"MENU_BAG","VIEW"),a.register(r.UI,l.Menu.CONTEXT_BEFORE_SHOW,function(t,o,s,a){if("MI_ROWHEAD_CONTEXT"===a.id){var r=i.data.getWorkBook(t,s).getSheetObj(o),l=i.view.getActiveGridID(),u=i.view.getSheetState(l,o).getActiveRange(),c=u.endRow,S=u.startRow,w=!1,_=r.Row.Visibility.getOnCount(u.startRow,u.endRow),C=r.Row.Filter.getOnCount(u.startRow,u.endRow);_&&_!=C&&(w=!0),0==S&&c>=I-1?e&&(e.style.display="none"):e&&(e.style.display=""),w?n&&(n.style.display="flex"):n&&(n.style.display="none");var D=c-S>0?R["Hide.Rows"]:R["Hide.Row"];O.zmenu(a,"setMenuItemsAttribute",["#"+d.MI+E.HIDE_ROWS+"_HIDE"+d.IDENTITY],"label",D)}},"RID","SHEETID","VERSION","UI")}(this);
!function(t){var e,n,i,s=t.sPlusPlus,o=t.ZSEvents,l=o.topic,a=o.Groups,d=o.Names,C=s.data.Defaults.MAX_COL,I=t.ZSConstants,r=I.I18N,u=I.FeatureConstants,E=t.ZSConstants.wCC,c=t.UIUtil.Component,N=s.view.Toolbar.Feature[u.HIDE_COLUMNS],S=((i=document.createElement("li")).setAttribute("data",'{"label":"'+r["Hide.Cols"]+'","shortcutkey":"Ctrl+Alt+0"}'),i.setAttribute("id",E.MI+u.HIDE_COLUMNS+"_HIDE"+E.IDENTITY),i),H=function(){var t=document.createElement("li");return t.setAttribute("data",'{"label":"'+r["Show.Cols"]+'","shortcutkey":"Ctrl+Shift+0"}'),t.setAttribute("id",E.MI+u.HIDE_COLUMNS+"_SHOW"+E.IDENTITY),t}();l.register(a.UI,d.Menu.INIT_COL_HEAD_CONTEXT,function(t,i){"VERSION"!=i&&((e=S.cloneNode(!0)).addEventListener("click",function(){N.hide()}),t[I.ContextConstant.HIDE_COLS]=e,(n=H.cloneNode(!0)).addEventListener("click",function(){N.show()}),t[I.ContextConstant.UNHIDE_COLS]=n)},"MENU_BAG","VIEW"),l.register(a.UI,d.Menu.CONTEXT_BEFORE_SHOW,function(t,i,o,l){if("MI_COLHEAD_CONTEXT"===l.id){var a=s.data.getWorkBook(t,o).getSheetObj(i),d=s.view.getActiveGridID(),I=s.view.getSheetState(d,i).getActiveRange(),N=I.endCol,S=I.startCol,H=a.Column.hidden.isHidden(S);H||(H=a.Column.hidden.nextHidden(S)<=N),0==S&&N>=C-1?e&&(e.style.display="none"):e&&(e.style.display=""),H?n&&(n.style.display="flex"):n&&(n.style.display="none");var O=N-S>0?r["Hide.Cols"]:r["Hide.Col"];c.zmenu(l,"setMenuItemsAttribute",["#"+E.MI+u.HIDE_COLUMNS+"_HIDE"+E.IDENTITY],"label",O)}},"RID","SHEETID","VERSION","UI")}(this);
!function(e){var t,a,l,i=e.sPlusPlus,n=e.ZSConstants,s=n.I18N,E=n.FeatureConstants,r=e.ZSEvents,I=r.topic,c=r.Groups,d=r.Names,o=e.document,u=i.view.Toolbar.Feature[E.IMAGE];o.getElementById("popupmenu");function A(e,n,s,E){if("MI_IMAGE_CONTEXT"===E){var r=i.view.getActiveGridID();e=i.view.getResourceID(r);i.data.getWorkBook(e,s).getSheetObj(n).Ole.Image.getActive().length>1?(a.style.display="none",l.style.display="none",t.style.display="none"):(a.style.display="",l.style.display="",t.style.display="")}}I.register(c.UI,d.Menu.INIT_IMAGE_CONTEXT,function(e,t){if("VERSION"!=t){var a=n.ContextConstant;e[a.RESIZE_IMAGE]=((v=o.createElement("li")).setAttribute("data",'{"label":"'+s.ResizeToOriginalSize+'"}'),v.addEventListener("click",u.resize),v),e[a.SAVE_IMAGE]=((r=o.createElement("li")).setAttribute("data",'{"label":"'+s["Image.SaveImageAs"]+'"}'),r.addEventListener("click",u.saveAS),r),e[a.CLONE_IMAGE]=((E=o.createElement("li")).setAttribute("data",'{"label":"'+s.Clone+'"}'),E.addEventListener("click",u.clone),E),e[a.REPLACE_IMAGE]=((i=o.createElement("li")).setAttribute("data",'{"label":"'+s.ReplaceImage+'"}'),i.addEventListener("click",u.replace),i),e[a.DELETE_IMAGE]=((l=o.createElement("li")).setAttribute("data",'{"label":"'+s.Delete+'"}'),l.addEventListener("click",u.remove),l),I.register(c.UI,d.Menu.CONTEXT_BEFORE_SHOW,A,"RID","SHEETID","VERSION","UI")}var l,i,E,r,v},"MENU_BAG","VIEW")}(this);
!function(t){var e,i=t.sPlusPlus,n=t.ZSConstants,E=t.ZSEvents,o=E.topic,s=E.Groups,I=E.Names,r=n.ContextConstant,M=ZSClass.ContextMenu,u=[],A=[[r.RESIZE_IMAGE],[r.SAVE_IMAGE],[r.CLONE_IMAGE,r.REPLACE_IMAGE,r.DELETE_IMAGE]],C=[[r.SAVE_IMAGE]];function _(){o.publish(s.UI,I.Menu.INIT_IMAGE_CONTEXT,{MENU_BAG:u}),this.init()}_.prototype={init:function(t){var e="VERSION"==t?C:A;this.imageContext=M.create("MI_IMAGE_CONTEXT",u,e)},open:function(t){var e=i.view.getActiveGridID(),n=i.view.getResourceID(e),E=i.view.getVersionID(e),o=i.view.getSheetID(e);i.data.getWorkBook(n,E).ProtectedSheets.isSheetLocked(o)||M.open(t,this.imageContext)}},e=new _,M.register("MI_IMAGE_CONTEXT",e),o.register(s.Listener,I.ContextMenu.INIT,function(t){e.init(t)},"VIEW")}(this);
!function(e){var t,n,E,a,u=e.sPlusPlus,i=e.ZSEvents,o=i.topic,r=i.Groups,c=i.Names,s=e.ZSConstants,l=s.FeatureConstants,d=e.document,C=s.wCC,I=s.I18N,N=(e.JSUtil,e.UIUtil.Component,4),m=5,T=6,U=7,b=u.view.Toolbar.Feature[l.FREEZE];o.register(r.UI,c.Menu.INIT_GRID_CONTEXT,function(e){var t=d.createElement("li");t.setAttribute("data",'{"label":"'+I["MenuItem.DataTab.FreezePanes"]+'"}'),t.setAttribute("data-menu-id",C.SUBMENUITEM+l.FREEZE+C.IDENTITY),t.id=C.MI+l.FREEZE+C.MENU,e[s.ContextConstant.FREEZE]=t},"MENU_BAG","VIEW"),o.register(r.UI,c.Menu.INIT_ROW_HEAD_CONTEXT,function(e){(t=document.createElement("li")).setAttribute("data",'{"label":"freeze upto 2nd Row"}'),t.addEventListener("click",function(){b.execute(N)}),e[s.ContextConstant.FREEZE]=t,(E=document.createElement("li")).setAttribute("data",'{"label":"unFreeze Row"}'),E.addEventListener("click",function(){b.execute(T)}),e[s.ContextConstant.UNFREEZE]=E},"MENU_BAG","VIEW"),o.register(r.UI,c.Menu.INIT_COL_HEAD_CONTEXT,function(e){(n=document.createElement("li")).setAttribute("data",'{"label":"freeze upto B Column"}'),n.addEventListener("click",function(){b.execute(m)}),e[s.ContextConstant.FREEZE]=n,(a=document.createElement("li")).setAttribute("data",'{"label":"unFreeze Col"}'),a.addEventListener("click",function(){b.execute(U)}),e[s.ContextConstant.UNFREEZE]=a},"MENU_BAG","VIEW")}(this);
!function(t){var e=t.sPlusPlus,n=t.document,s=t.ZSEvents,a=s.topic,o=s.Groups,r=s.Names,E=t.ZSConstants.I18N,i=t.ZSConstants,I=e.view.Toolbar.Feature[i.FeatureConstants.FORMATCELLS];function u(t,e){if("VERSION"!=e){var s=n.createElement("li");s.setAttribute("data",'{"label":"'+E.FormatCells+'..."}'),s.addEventListener("click",function(t){I.openDialog(t)}),t[ZSConstants.ContextConstant.FORMATCELL]=s}}a.register(o.UI,r.Menu.INIT_GRID_CONTEXT,u,"MENU_BAG","VIEW"),a.register(o.UI,r.Menu.INIT_ROW_HEAD_CONTEXT,u,"MENU_BAG","VIEW"),a.register(o.UI,r.Menu.INIT_COL_HEAD_CONTEXT,u,"MENU_BAG","VIEW")}(this);
!function(e){var t,n=e.sPlusPlus,s=e.document,r=e.ZSEvents,o=r.topic,a=r.Groups,u=r.Names,N=e.ZSConstants.I18N,i=e.ZSConstants,E=n.view.Toolbar.Feature[i.FeatureConstants.DEFINE_NAME],I=((t=s.createElement("li")).setAttribute("data",'{ "skipshortcutregister": true, "label":"'+N["MenuItem.InsertTab.DefineName"]+'...", "shortcutkey":"Ctrl+F3"}'),t);function _(e){var t=I.cloneNode(!0);t.onclick=E.openDialog,e[i.ContextConstant.DEFINE_NAME]=t}o.register(a.UI,u.Menu.INIT_GRID_CONTEXT,_,"MENU_BAG"),o.register(a.UI,u.Menu.INIT_ROW_HEAD_CONTEXT,_,"MENU_BAG"),o.register(a.UI,u.Menu.INIT_COL_HEAD_CONTEXT,_,"MENU_BAG")}(this);
!function(e){var t,n=e.sPlusPlus,o=e.document,a=e.ZSEvents,r=a.topic,s=a.Groups,i=a.Names,c=e.ZSConstants.I18N,E=e.ZSConstants,u=E.FeatureConstants,I=n.view.Toolbar.Feature[u.LOCK],C=n.view.Toolbar.Feature[u.LOCK_SHEET],M=e.ZSConstants.wCC,l=e.UIUtil.Component,N=(e.ZSConstants.ActionConstants,(t=o.createElement("li")).id=M.MI+u.LOCK_CELLS+M.MENU+"_"+void 0,t.className="lockMenu_cm",t.setAttribute("data",'{"skipshortcutregister": false, "label":"'+c["ProtectRange.UI.Menu.ProtectRange"]+'..."}'),t),_=function(){var e=o.createElement("li");return e.id=M.MI+u.UNLOCK_RANGE+M.MENU+"_"+void 0,e.setAttribute("data",'{"skipshortcutregister": false, "label":"'+c["ProtectRange.UI.Menu.LockUnlockRange"]+'..."}'),e}(),g=function(){var e=o.createElement("li");return e.id=M.MI+u.LOCK_SHEET+M.MENU,e.setAttribute("data",'{"skipshortcutregister": false, "label":"'+c["Menu.ProtectRange.ProtectSheet"]+'"}'),e}();function T(e,t){var n=N.cloneNode(!0);n.addEventListener("click",function(){I.openDialog(!1)}),e[E.ContextConstant.LOCK_RANGE]=n}function U(){var e=n.view.getActiveGridID(),t=n.view.getResourceID(e),o=n.view.getSheetID(e),a=n.view.getVersionID(e),r=n.data.getWorkBook(t,a),s=(n.data.DocRegistry[t][a],r=n.data.getWorkBook(t,a),n.view.getSheetState(e,o).getActiveRange());return r.getSheetObj(o).ProtectedRanges.isIntersecting(s)}-1==ZSConstants.Meta.HideFeaturesList.indexOf(u.LOCK_CELLS)&&(r.register(s.UI,i.Menu.INIT_GRID_CONTEXT,T,"MENU_BAG","VIEW"),r.register(s.UI,i.Menu.INIT_ROW_HEAD_CONTEXT,T,"MENU_BAG","VIEW"),r.register(s.UI,i.Menu.INIT_COL_HEAD_CONTEXT,T,"MENU_BAG","VIEW"),r.register(s.UI,i.Menu.CONTEXT_BEFORE_SHOW,function(e,t,o,a){var r=e.id,s=n.data.getWorkBook(t,a);switch(r){case"MI_SHEET_CONTEXT":var i=void 0!=s.ProtectedSheets[o]?c["Menu.ProtectRange.ManageSheet"]:c["Menu.ProtectRange.ProtectSheet"];l.zmenu("#"+r,"setMenuItemsAttribute",["#"+M.MI+u.LOCK_SHEET+M.MENU],"label",i);break;case"MI_GRID_CONTEXT":i=U()?c["ProtectRange.UI.Menu.LockUnlockRange"]:c["ProtectRange.UI.Menu.ProtectRange"],l.zmenu(e,"setMenuItemsAttribute",["#"+M.MI+u.LOCK_CELLS+M.MENU],"label",i+"..."),e.querySelector("#"+M.MI+u.UNLOCK_RANGE+M.MENU)&&(e.querySelector("#"+M.MI+u.UNLOCK_RANGE+M.MENU).style.display=s.ProtectedSheets.isSheetLocked(o)?"none":"block");case"MI_ROWHEAD_CONTEXT":case"MI_COLHEAD_CONTEXT":i=U()?c["ProtectRange.UI.Menu.LockUnlockRange"]:c["ProtectRange.UI.Menu.ProtectRange"],l.zmenu(e,"setMenuItemsAttribute",["#"+M.MI+u.LOCK_CELLS+M.MENU],"label",i+"...")}},"UI","RID","SHEETID","VERSION"),r.register(s.UI,i.Menu.INIT_SHEET_CONTEXT,function(e,t){var n=g.cloneNode(!0);n.addEventListener("click",function(){C.openDialog(!0)}),e[E.ContextConstant.SHEET_LOCKSHEET]=n},"MENU_BAG","VIEW"),r.register(s.UI,i.Menu.INIT_LOCK_CONTEXT,function(e,t){var n=_.cloneNode(!0);n.addEventListener("click",function(){I.openDialog(!1)}),e[E.ContextConstant.UNLOCK_RANGE]=n},"MENU_BAG"))}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=n.topic,I=n.Groups,E=n.Names,u=(e.document,e.ZSConstants),r=u.FeatureConstants,N=(u.wCC,u.I18N,u.ContextConstant),_=t.view.Toolbar.Feature[r.PUBLISH_RANGE];function o(e,t){e[N.PUBLISH_RANGE]=_.createRangePublishMenuElement()}s.register(I.UI,E.Menu.INIT_GRID_CONTEXT,o,"MENU_BAG","VIEW"),s.register(I.UI,E.Menu.INIT_ROW_HEAD_CONTEXT,o,"MENU_BAG","VIEW"),s.register(I.UI,E.Menu.INIT_COL_HEAD_CONTEXT,o,"MENU_BAG","VIEW")}(this);
!function(t){var e,n=t.sPlusPlus,s=t.ZSEvents,i=s.topic,o=s.Groups,E=s.Names,a=t.ZSConstants,r=t.ZSConstants.FeatureConstants,u=a.wCC,I=a.I18N,c=a.ContextConstant;function N(t,s,i){n.data.getWorkBook(t,i).FormSheets[s]?e&&(e.style.display=""):e&&(e.style.display="none")}i.register(o.UI,E.Menu.INIT_SHEET_CONTEXT,function(t,n){if("VERSION"!=n){var s=document.createElement("li");s.innerText=I["FormTab.ManageForm"],s.setAttribute("data-menu-id",u.SUBMENUITEM+r.MANAGE_FORM+u.IDENTITY),s.addEventListener("click",function(){CopySheet.execute()}),s.setAttribute("ctype","splitmenu"),t[c.MANAGE_FORM]=s,e=s,i.register(o.UI,E.Menu.CONTEXT_BEFORE_SHOW,N,"RID","SHEETID","VERSION")}},"MENU_BAG","VIEW")}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=n.topic,i=n.Groups,r=n.Names,o=e.ZSConstants,a=e.ZSConstants.FeatureConstants,u=(o.wCC,o.I18N),c=o.ContextConstant,I=t.view.Toolbar.Feature[a.VBA_EDITOR];s.register(i.UI,r.Menu.INIT_SHEET_CONTEXT,function(e,n){if("VERSION"!=n){var s=document.createElement("li");s.innerText=u["Macro.Player.ViewCode"],s.addEventListener("click",function(){var e=t.view.getActiveGridID(),n=(t.view.getResourceID(e),t.view.getSheetID(e)),s="Sheet"+(parseInt(n.substr(0,n.length-1))+1);I.openDialog(s)}),e[c.VBA_EDITOR]=s}},"MENU_BAG","VIEW")}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSEvents,s=n.topic,E=n.Groups,I=n.Names,r=t.ZSConstants,C=r.FeatureConstants,a=t.ZSConstants.wCC,i=t.document,u=t.ZSConstants.I18N;e.view.Toolbar.Feature[C.CLEAR_ALL];function N(t,e){if("VERSION"!=e){var n=i.createElement("li");n.setAttribute("data-menu-id",a.SUBMENUITEM+C.CLEAR_ALL+a.IDENTITY),n.setAttribute("id",a.MI+C.CLEAR_ALL+a.MENU),n.innerText=u["MenuItem.HomeTab.Clear"],t[r.ContextConstant.CLEAR]=n}}s.register(E.UI,I.Menu.INIT_GRID_CONTEXT,N,"MENU_BAG","VIEW"),s.register(E.UI,I.Menu.INIT_ROW_HEAD_CONTEXT,N,"MENU_BAG","VIEW"),s.register(E.UI,I.Menu.INIT_COL_HEAD_CONTEXT,N,"MENU_BAG","VIEW")}(this);
!function(t){var e=t.sPlusPlus,I=t.ZSEvents,n=I.topic,s=I.Groups,E=I.Names,T=t.ZSConstants,r=T.FeatureConstants,N=t.ZSConstants.wCC,i=t.document,u=t.ZSConstants.I18N;e.view.Toolbar.Feature[r.INSERT];function a(t,e){if("VERSION"!=e){var I=i.createElement("li");I.setAttribute("data-menu-id",N.SUBMENUITEM+r.INSERT+N.IDENTITY),I.setAttribute("id",N.MI+r.INSERT+N.IDENTITY),I.innerText=u["MenuItem.InsertTab.Insert"],t[T.ContextConstant.INSERT]=I}}n.register(s.UI,E.Menu.INIT_GRID_CONTEXT,a,"MENU_BAG","VIEW"),n.register(s.UI,E.Menu.INIT_ROW_HEAD_CONTEXT,a,"MENU_BAG","VIEW"),n.register(s.UI,E.Menu.INIT_COL_HEAD_CONTEXT,a,"MENU_BAG","VIEW")}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSEvents,s=n.topic,E=n.Groups,i=n.Names,a=t.ZSConstants,o=a.FeatureConstants,T=t.ZSConstants.wCC,r=t.document,u=t.ZSConstants.I18N;e.view.Toolbar.Feature[o.DELETE];s.register(E.UI,i.Menu.INIT_GRID_CONTEXT,function(t,e){if("VERSION"!=e){var n=r.createElement("li");n.setAttribute("data-menu-id",T.SUBMENUITEM+o.DELETE+T.IDENTITY),n.setAttribute("id",T.MI+o.DELETE+T.IDENTITY),n.innerText=u["Actions.Delete"],t[a.ContextConstant.DELETE]=n}},"MENU_BAG","VIEW")}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSEvents,s=o.topic,n=o.Groups,i=o.Names,a=e.ZSConstants,r=a.FeatureConstants,E=e.ZSConstants.wCC,l=e.document,I=e.ZSConstants.I18N,R=e.UIUtil.Component,T=t.data.Defaults;s.register(n.UI,i.Menu.INIT_ROW_HEAD_CONTEXT,function(e,o){if("VERSION"!=o){var s=t.view.Toolbar.Feature[r.ROW_OPTIONS],n=l.createElement("li");n.setAttribute("data",'{ "label":"'+I.DeleteRow+'"}'),n.setAttribute("id",E.MI+r.DELETE_ROW+E.IDENTITY),n.onclick=s.deleteRow,e[a.ContextConstant.DELETE_ROW]=n}},"MENU_BAG","VIEW"),s.register(n.UI,i.Menu.CONTEXT_BEFORE_SHOW,function(e){var o=t.view.getActiveGridID(),s=t.view.getSheetID(o),n=t.view.getSheetState(o,s).getRanges(),i=t.view.getResourceID(o),a=t.view.getVersionID(o),l=t.data.getWorkBook(i,a),u=l.getSheetObj(s),D=l.ProtectedSheets.isSheetLocked(s);if("MI_ROWHEAD_CONTEXT"==e.id&&!D){for(var O=0,w=0;w<n.length;w++)O+=n[w].endRow-n[w].startRow+1,O-=u.Row.Visibility.getOnCount(n[w].startRow,n[w].endRow);if(O>=T.MAX_ROW)e.querySelector("#"+E.MI+r.DELETE_ROW+E.IDENTITY).style.display="none";else{var c=O>1?JSUtil.fn.replaceParams(I["HomeTab.Row.DeleteNoofRows"],new Array(O+"")):I.DeleteRow;R.zmenu(e,"setMenuItemsAttribute",["#"+E.MI+r.DELETE_ROW+E.IDENTITY],"label",c),e.querySelector("#"+E.MI+r.DELETE_ROW+E.IDENTITY).style.display="flex"}}},"UI")}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,o=n.topic,s=n.Groups,l=n.Names,a=e.ZSConstants,i=a.FeatureConstants,r=e.ZSConstants.wCC,C=e.document,E=e.ZSConstants.I18N,I=e.UIUtil.Component,u=t.data.Defaults;o.register(s.UI,l.Menu.INIT_COL_HEAD_CONTEXT,function(e,n){if("VERSION"!=n){var o=t.view.Toolbar.Feature[i.COL_OPTIONS],s=C.createElement("li");s.setAttribute("id",r.MI+i.DELETE_COLUMN+r.IDENTITY),s.setAttribute("data",'{ "label":"'+E.DeleteColumn+'"}'),s.onclick=o.deleteCol,e[a.ContextConstant.DELETE_COL]=s}},"MENU_BAG","VIEW"),o.register(s.UI,l.Menu.CONTEXT_BEFORE_SHOW,function(e){var n=t.view.getActiveGridID(),o=t.view.getSheetID(n),s=t.view.getSheetState(n,o).getRanges(),l=t.view.getResourceID(n),a=t.view.getVersionID(n),C=t.data.getWorkBook(l,a),T=C.ProtectedSheets.isSheetLocked(o),D=C.getSheetObj(o);if("MI_COLHEAD_CONTEXT"==e.id&&!T){if(!C.isEditable())return;for(var O=0,N=0;N<s.length;N++)O+=O=s[N].endCol-s[N].startCol+1,O-=D.Column.hidden.getOnCount(s[N].startCol,s[N].endCol);if(O>=u.MAX_COL)e.querySelector("#"+r.MI+i.DELETE_COLUMN+r.IDENTITY).style.display="none";else{var d=O>1?JSUtil.fn.replaceParams(E["HomeTab.Column.DeleteNoofCols"],new Array(O+"")):E.DeleteColumn;I.zmenu(e,"setMenuItemsAttribute",["#"+r.MI+i.DELETE_COLUMN+r.IDENTITY],"label",d),e.querySelector("#"+r.MI+i.DELETE_COLUMN+r.IDENTITY).style.display="flex"}}},"UI")}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSEvents,s=n.topic,I=n.Groups,T=n.Names,o=t.ZSConstants,a=o.FeatureConstants,i=t.ZSConstants.wCC,O=t.document,r=t.ZSConstants.I18N;e.view.Toolbar.Feature[a.ROW_OPTIONS];s.register(I.UI,T.Menu.INIT_ROW_HEAD_CONTEXT,function(t){var e=O.createElement("li");e.setAttribute("data-menu-id",i.SUBMENUITEM+a.ROW_HEIGHT_OPTIONS+i.IDENTITY),e.setAttribute("id",i.MI+a.ROW_HEIGHT_OPTIONS+i.IDENTITY),e.innerText=r["HomeTab.Row.RowHeight"],t[o.ContextConstant.ROW_HEIGHT_OPTIONS]=e},"MENU_BAG","VIEW")}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSEvents,s=n.topic,I=n.Groups,T=n.Names,o=t.ZSConstants,C=o.FeatureConstants,N=t.ZSConstants.wCC,a=t.document,i=t.ZSConstants.I18N;e.view.Toolbar.Feature[C.COL_OPTIONS];s.register(I.UI,T.Menu.INIT_COL_HEAD_CONTEXT,function(t,e){if("VERSION"!=e){var n=a.createElement("li");n.setAttribute("data-menu-id",N.SUBMENUITEM+C.COLUMN_WIDTH_OPTIONS+N.IDENTITY),n.setAttribute("id",N.MI+C.COLUMN_WIDTH_OPTIONS+N.IDENTITY),n.innerText=i["HomeTab.Column.ColumnWidth"],t[o.ContextConstant.COLUMN_WIDTH_OPTIONS]=n}},"MENU_BAG","VIEW")}(this);
!function(t){var e=t.sPlusPlus,n=t.document,s=t.ZSEvents,r=s.topic,a=s.Groups,i=s.Names,o=t.ZSConstants.I18N,u=t.ZSConstants,E=u.FeatureConstants,I=e.view.Toolbar.Feature[E.COMMENTS];function C(t,e){if("VERSION"!=e){var s=n.createElement("li");s.setAttribute("data",'{"shortcutkey":"ctrl+alt+M", "splitbutton":true,"label":"'+o["MenuItem.InsertTab.Comments.AddComment"]+'"}'),s.addEventListener("click",function(){I.openAndAddComment()}),t[u.ContextConstant.ADD_COMMENT]=s}}-1==ZSConstants.Meta.HideFeaturesList.indexOf(E.COMMENTS)&&(r.register(a.UI,i.Menu.INIT_GRID_CONTEXT,C,"MENU_BAG","VIEW"),r.register(a.UI,i.Menu.INIT_ROW_HEAD_CONTEXT,C,"MENU_BAG","VIEW"),r.register(a.UI,i.Menu.INIT_COL_HEAD_CONTEXT,C,"MENU_BAG","VIEW"),r.register(a.UI,i.Menu.INIT_LOCK_CONTEXT,C,"MENU_BAG"))}(this);
!function(t){var e,s=t.sPlusPlus,n=t.document,a=t.ZSConstants.wCC,i=t.ZSEvents,r=i.topic,o=i.Groups,l=i.Names,I=t.ZSConstants.I18N,u=t.ZSConstants,E=ZSConstants.ContextConstant,C=s.view.Toolbar.Feature[u.FeatureConstants.HYPERLINK],N=((e=n.createElement("li")).setAttribute("data",'{"skipshortcutregister": false, "shortcutkey":"Ctrl+k","label":"'+I["MenuItem.InsertTab.Hyperlink"]+'...","appData" : { "type": "change"} }'),e);r.register(o.UI,l.Menu.INIT_GRID_CONTEXT,function(t,e){if("VERSION"!=e){var s=N;s.id=a.MI+E.ADD_HYPERLINK+a.MENU,s.addEventListener("click",C.openDialog),t[E.ADD_HYPERLINK]=s}},"MENU_BAG","VIEW"),r.register(o.UI,l.Menu.CONTEXT_BEFORE_SHOW,function(t){if("MI_GRID_CONTEXT"==t.id){var e=C.isSingleCell(),s=t.querySelector("#"+a.MI+E.ADD_HYPERLINK+a.MENU);e?s&&(s.style.display=""):s&&(s.style.display="none")}},"UI")}(this);
!function(e){var t=e.sPlusPlus,n=(e.JSUtil,e.ZSEvents),i=n.topic,s=n.Groups,I=n.Names,r=(document,e.ZSConstants),E=r.FeatureConstants,T=r.ContextConstant,a=r.I18N,u=r.wCC;function o(e,t){if("VERSION"!=t){var n=document.createElement("li");n.setAttribute("data-menu-id",u.SUBMENUITEM+E.SORT+u.IDENTITY),n.setAttribute("id",u.MI+T.SORT+u.MENU),n.innerText=a["MenuItem.DataTab.Sort"],e[T.SORT]=n}}i.register(s.UI,I.Menu.INIT_GRID_CONTEXT,o,"MENU_BAG","VIEW"),i.register(s.UI,I.Menu.INIT_ROW_HEAD_CONTEXT,o,"MENU_BAG","VIEW"),i.register(s.UI,I.Menu.INIT_COL_HEAD_CONTEXT,o,"MENU_BAG","VIEW"),i.register(s.UI,I.Menu.CONTEXT_BEFORE_SHOW,function(e){var n,i;if("MI_GRID_CONTEXT"==e.id){var s=(n=t.view.getActiveGridID(),i=t.view.getSheetID(n),t.view.getSheetState(n,i).getRanges()[0]),I=e.querySelector("#"+u.MI+T.SORT+u.MENU);s.startRow!=s.endRow||s.startCol!=s.endCol?I&&(I.style.display=""):I&&(I.style.display="none")}},"UI")}(this);
!function(t){var e=t.ZSEvents,n=t.sPlusPlus,i=e.topic,s=e.Groups,o=e.Names,r=t.ZSConstants.wCC,a=t.ZSConstants,I=t.ZSConstants.I18N;function u(){i.publish(s.UI,o.SidePanel.Sparklines.OPEN,{ISRIGHTCLICK:!0})}var l,C,S=(l=document.createElement("li"),C=r.MI+a.ContextConstant.SPARKLINE+r.MENU,l.setAttribute("data",'{ "skipshortcutregister": true, "label":"'+I["MenuTab.Tab.Sparkline"]+'"}'),l.setAttribute("id",C),l);i.register(s.UI,o.Menu.INIT_GRID_CONTEXT,function(t,e){if("VERSION"!=e){var n=S.cloneNode(!0);n.onclick=u,t[a.ContextConstant.SPARKLINE]=n}},"MENU_BAG","VIEW"),i.register(s.UI,o.Menu.CONTEXT_BEFORE_SHOW,function(t){if("MI_GRID_CONTEXT"==t.id){var e=n.view.getActiveGridID(),i=n.view.getResourceID(e),s=n.view.getVersionID(e),o=n.view.getSheetID(e),I=n.view.getSheetState(e,o).getActiveCellRange(),u=n.data.getWorkBook(i,s).getSheetObj(o).sparklines.getInfo(I.startRow,I.startCol),l=t.querySelector("#"+r.MI+a.ContextConstant.SPARKLINE+r.MENU);if(void 0==l)return;l.style.display=void 0==u?"none":""}},"UI")}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,n=i.topic,r=i.Groups,c=i.Names,s=e.ZSConstants,o=(s.wCC,s.I18N),I=s.ContextConstant,E=(e.UIUtil.Component,document.getElementById("popupmenu"),0),a={AddExistingMacro:E++,CreateMacro:E++,RecordMacro:E++};n.register(r.UI,c.Menu.INIT_BUTTON_CONTEXT,function(e){var i;e[I.BUTTON_ASSIGN_EXISTING_MACRO]=((i=document.createElement("li")).setAttribute("data",'{"label":"'+o["Button.AssignExistingMacro"]+'"}'),i.addEventListener("click",function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),o=t.view.getVersionID(i),I=t.view.getSheetID(i);n.publish(r.Listener,c.UserAction.BUTTONS.ASSIGNMACRO,{RID:s,SHEETID:I,VERSION:o,CONTEXT:a.AddExistingMacro})}),i),e[I.BUTTON_ASSIGN_NEW_MACRO]=function(){var e=document.createElement("li");return e.innerText=o["Button.AssignNewMacro"],e.addEventListener("click",function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),o=t.view.getVersionID(i),I=t.view.getSheetID(i);n.publish(r.Listener,c.UserAction.BUTTONS.ASSIGNMACRO,{RID:s,SHEETID:I,VERSION:o,CONTEXT:a.CreateMacro})}),e}(),e[I.BUTTON_EDIT_LABEL]=function(){var e=document.createElement("li");return e.setAttribute("data",'{"label":"'+o["Button.EditLabel"]+'"}'),e.addEventListener("click",function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),o=t.view.getVersionID(i),I=t.view.getSheetID(i);n.publish(r.Listener,c.UserAction.BUTTONS.EDIT,{RID:s,SHEETID:I,VERSION:o})}),e}(),e[I.BUTTON_CLONE]=function(){var e=document.createElement("li");return e.setAttribute("data",'{"label":"'+o.Clone+'"}'),e.addEventListener("click",function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),o=t.view.getVersionID(i),I=t.view.getSheetID(i);n.publish(r.Listener,c.UserAction.BUTTONS.CLONE,{RID:s,SHEETID:I,VERSION:o})}),e}(),e[I.BUTTON_DELETE]=function(){var e=document.createElement("li");return e.setAttribute("data",'{"label":"'+o.Delete+'"}'),e.addEventListener("click",function(e){var i=t.view.getActiveGridID(),s=t.view.getResourceID(i),o=t.view.getVersionID(i),I=t.view.getSheetID(i);n.publish(r.Listener,c.UserAction.BUTTONS.DELETE,{RID:s,SHEETID:I,VERSION:o})}),e}()},"MENU_BAG")}(this);
!function(t){var e,n=t.sPlusPlus,T=t.ZSConstants,i=t.ZSEvents,o=i.topic,s=i.Groups,N=i.Names,I=T.ContextConstant,_=ZSClass.ContextMenu,u=[],E=[[I.BUTTON_ASSIGN_EXISTING_MACRO,I.BUTTON_ASSIGN_NEW_MACRO,I.BUTTON_ASSIGN_EXISTING_DELUGE,I.BUTTON_EDIT_LABEL],[I.BUTTON_CLONE,I.BUTTON_DELETE]],r=[];function O(){o.publish(s.UI,N.Menu.INIT_BUTTON_CONTEXT,{MENU_BAG:u}),this.init()}O.prototype={init:function(t){var e="VERSION"==t?r:E;this.buttonCtxMenu=_.create("MI_BUTTON_CONTEXT",u,e)},open:function(t){var e=n.view.getActiveGridID(),T=n.view.getResourceID(e),i=n.view.getVersionID(e),o=n.view.getSheetID(e);n.data.getWorkBook(T,i).ProtectedSheets.isSheetLocked(o)||_.open(t,this.buttonCtxMenu)}},e=new O,_.register("MI_BUTTON_CONTEXT",e),o.register(s.Listener,N.ContextMenu.INIT,function(t){e.init(t)},"VIEW")}(this);
!function(t){var e,n=t.sPlusPlus,a=t.document,i=t.ZSEvents,s=i.topic,o=i.Groups,r=i.Names,l=t.ZSConstants.I18N,u=t.ZSConstants,c=n.view.Toolbar.Feature[u.FeatureConstants.NOTE],E=t.JSUtil,I=n.data.Defaults,N=((e=a.createElement("li")).setAttribute("data",'{"label":"'+l["Note.Add"]+'",  "shortcutkey": "Shift+F2" }'),e),S=function(){var t=a.createElement("li");return t.setAttribute("data",'{"label":"'+l["Note.Edit"]+'", "shortcutkey": "Shift+F2" }'),t.style.display="none",t}();s.register(o.UI,r.Menu.INIT_GRID_CONTEXT,function(t,e){"VERSION"!=e&&(N.onclick=function(t){c.execute(t)},t[u.ContextConstant.ADD_NOTE]=N,S.onclick=function(t){c.execute(t)},t[u.ContextConstant.EDIT_NOTE]=S)},"MENU_BAG","VIEW"),s.register(o.UI,r.Menu.CONTEXT_BEFORE_SHOW,function(t,e,a,i){if("MI_GRID_CONTEXT"==i.id){var s=c.isSingleRange(),o=!1;if(s){var r=n.view.getActiveGridID(),l=n.data.getWorkBook(t,a).getSheetObj(e),u=n.view.getSheetState(r,e).getActiveCellRange(),d=E.Math.hash(u.startRow,u.startCol,I.MAX_COL);o=!!l.Notes.get(d)}var C=s&&!o;N.style.display=C?"":"none",S.style.display=o?"":"none"}},"RID","SHEETID","VERSION","UI")}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSEvents,s=n.topic,a=n.Groups,E=n.Names,i=t.ZSConstants,o=i.FeatureConstants,r=t.document,u=t.ZSConstants.I18N,S=e.view.Toolbar.Feature[o.INSERT_SHEET];s.register(a.UI,E.Menu.INIT_SHEET_CONTEXT,function(t,e){if("VERSION"!=e){var n=r.createElement("li");n.setAttribute("data",'{"label":"'+u["SheetsTab.InsertSheet"]+'"}'),n.addEventListener("click",function(){S.execute()}),t[i.ContextConstant.SHEET_INSERT]=n}},"MENU_BAG","VIEW")}(this);
!function(e){var t,n=e.sPlusPlus,i=e.ZSEvents,s=i.topic,o=i.Groups,a=i.Names,E=(e.ZSConstants,e.document),r=e.ZSConstants.I18N,S=e.UIUtil.Component,c=ZSConstants.wCC,I=n.view.Toolbar.Feature.RENAME_SHEET;s.register(o.UI,a.Menu.INIT_SHEET_CONTEXT,function(e,i){"VERSION"!=i&&((t=E.createElement("li")).setAttribute("data",'{"label":"'+r.Rename+'"}'),t.id=c.MI+ZSConstants.ContextConstant.SHEET_RENAME+c.MENU,t.addEventListener("click",function(){var e,t,i;e=n.view.getActiveGridID(),t=n.view.getSheetID(e),i=n.view.getSheetTabHolder()[e].getSheetTabList()[t],I.execute.call(i)}),e[ZSConstants.ContextConstant.SHEET_RENAME]=t)},"MENU_BAG","VIEW"),s.register(o.UI,a.Menu.CONTEXT_SHOW,function(){var e=n.view.getActiveGridID(),i=n.view.getResourceID(e),s=n.view.getSheetID(e),o=n.view.getVersionID(e);n.data.getWorkBook(i,o).ProtectedSheets.isSheetLocked(s)?S.disable(t):S.enable(t)},"UI")}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSEvents,s=n.topic,E=n.Groups,a=n.Names,i=t.ZSConstants,u=t.document,o=t.ZSConstants.I18N,c=e.view.Toolbar.Feature.DUPLICATE_SHEET;s.register(E.UI,a.Menu.INIT_SHEET_CONTEXT,function(t,e){if("VERSION"!=e){var n=u.createElement("li");n.setAttribute("data",'{"label":"'+o.Duplicate+'"}'),n.addEventListener("click",function(){c.execute()}),t[i.ContextConstant.SHEET_DUPLICATE]=n}},"MENU_BAG","VIEW")}(this);
!function(t){var e,n=t.sPlusPlus,E=t.ZSEvents,s=E.topic,o=E.Groups,i=E.Names,a=(t.ZSConstants,t.document),S=t.ZSConstants.I18N,T=ZSConstants.wCC,r=t.UIUtil.Component,C=n.view.Toolbar.Feature.DELETE_SHEET;s.register(o.UI,i.Menu.INIT_SHEET_CONTEXT,function(t,n){"VERSION"!=n&&((e=a.createElement("li")).id=T.MI+ZSConstants.ContextConstant.SHEET_DELETE+T.MENU,e.setAttribute("data",'{"label":"'+S["Actions.Delete"]+'"}'),e.addEventListener("click",function(){C.execute()}),t[ZSConstants.ContextConstant.SHEET_DELETE]=e)},"MENU_BAG","VIEW"),s.register(o.UI,i.Menu.CONTEXT_SHOW,function(t,E,s,o){if("MI_SHEET_CONTEXT"===o.id){var i=n.data.getWorkBook(t,s);1==i.SheetList.getSheets().length||i.ProtectedSheets.isSheetLocked(E)?r.disable(e):r.enable(e)}},"RID","SHEETID","VERSION","UI")}(this);
!function(e){var t,n=e.sPlusPlus,i=e.document,a=e.ZSEvents,s=e.UIUtil,o=a.topic,r=a.Groups,c=a.Names,E=e.ZSConstants,I=E.wCC,u=E.I18N,l=E.ContextConstant,d=i.getElementById("popupmenu"),p=e.UIUtil.Component,T=n.view.Toolbar.Feature.COPY_SHEET,v=E.FeatureConstants,C=n.view.Toolbar.Feature.COPY_TO_NEW_SPREADSHEET;o.register(r.UI,c.Menu.INIT_SHEET_CONTEXT,function(e,a){var o,r;if(-1==ZSConstants.Meta.HideFeaturesList.indexOf(v.COPY)){var c=i.createElement("li");c.innerText=u.Copy,c.setAttribute("data-menu-id",I.SUBMENUITEM+"copysheet"+I.IDENTITY),c.addEventListener("click",function(){T.execute()}),e[l.SHEET_COPY]=c,(o=i.createElement("ul")).id=I.SUBMENUITEM+"copysheet"+I.IDENTITY,o.setAttribute("data-ctype","zmenu"),o.className="zscopysheet-menu",r=o,(t=i.createElement("li")).setAttribute("data",'{"label":"'+u.Copy+'"}'),t.id=I.SUBMENUITEM+l.SHEET_COPY+I.IDENTITY,t.addEventListener("click",function(){var e=n.view.getActiveGridID(),t=n.view.getResourceID(e),i=n.view.getSheetID(e),a=n.view.getVersionID(e);T.copySheetAction(t,i,a)}),r.appendChild(t),C&&C.createElement(o),d.appendChild(o),p.bind("#"+I.SUBMENUITEM+"copysheet"+I.IDENTITY,"zmenubeforeshow",function(e,a){var o,r,c,E,l,d;o=n.view.getActiveGridID(),r=n.view.getResourceID(o),c=n.view.getSheetID(o),E=n.view.getVersionID(o),l=n.data.getWorkBook(r,E).getSheetObj(c).Prop.Name,d=u.Copy+" '"+l+"'",p.zmenu("#"+I.SUBMENUITEM+"copysheet"+I.IDENTITY,"setMenuItemsAttribute",["#"+t.id],"label",d);var T=i.createElement("span"),v=i.createElement("div");if(T.classList.add("flt_right","curPtr","shLineIcon"),s.fn.addIcon(T,"infoLineIcon"),v.className="shMenuInfo",!i.querySelector("span.shLineIcon")){var C=u["CopySheet.helpInfo"];T.setAttribute("title",C),T.setAttribute("data-title-max-display-time","10000"),v.innerText=u["CopySheet.Tip"],t.appendChild(T),t.appendChild(v)}})}},"MENU_BAG","VIEW")}(this);
!function(e){var t=e.sPlusPlus,n=e.document,i=e.ZSEvents,o=i.topic,r=i.Groups,E=i.Names,a=e.ZSConstants,s=a.wCC,c=a.I18N,p=a.ContextConstant,u=(n.getElementById("popupmenu"),e.UIUtil.Component),S=t.view.Toolbar.Feature.COPY_TO_NEW_SPREADSHEET;S.createElement=function(e){!function(e){var t=n.createElement("li");t.setAttribute("data-item-type","separator"),e.appendChild(t)}(e);var i=n.createElement("li");i.setAttribute("data",'{"label":"'+c["CopySheet.CreateNewSpreadsheet"]+'"}'),i.id=s.SUBMENUITEM+p.COPYAS_NEW_SHEET+s.MENU,i.addEventListener("click",function(){var e=t.view.getActiveGridID(),n=t.view.getResourceID(e),i=t.view.getSheetID(e),o=t.view.getVersionID(e);S.copySheetAction(n,i,o)}),e.appendChild(i)},o.register(r.UI,E.Menu.INIT_SHEET_CONTEXT,function(e,t){u.bind("#"+s.SUBMENUITEM+"copysheet"+s.IDENTITY,"zmenubeforeshow",function(e,t){if(!n.querySelector("#copytoNewSheet")){var i=n.querySelector("#"+s.SUBMENUITEM+p.COPYAS_NEW_SHEET+s.MENU),o=n.createElement("div");o.id="copytoNewSheet",o.className="shMenuInfo",o.innerText=c["CopySheet.NewSpreadsheet.Tip"],i.appendChild(o)}})},"MENU_BAG","VIEW")}(this);
!function(t){var e,n=t.sPlusPlus,E=t.document,s=t.ZSEvents,o=s.topic,i=s.Groups,a=s.Names,S=t.UIUtil.Component,T=t.ZSConstants,I=T.I18N,l=T.wCC,r=n.view.Toolbar.Feature.MOVE_SHEET;function u(t,E,s,o){"MI_SHEET_CONTEXT"===o.id&&(1==n.data.getWorkBook(t,s).SheetList.getSheets().length?S.disable(e):S.enable(e))}o.register(i.UI,a.Menu.INIT_SHEET_CONTEXT,function(t,n){"VERSION"!=n&&((e=E.createElement("li")).setAttribute("data",'{"label":"'+I.MoveThisSheet+'"}'),e.id=l.MI+ZSConstants.ContextConstant.SHEET_MOVE+l.MENU,e.addEventListener("click",function(){r.openDialog()}),t[ZSConstants.ContextConstant.SHEET_MOVE]=e,o.register(i.UI,a.Menu.CONTEXT_SHOW,u,"RID","SHEETID","VERSION","UI"))},"MENU_BAG","VIEW")}(this);
!function(t){var e,n=t.sPlusPlus,s=t.document,E=t.ZSEvents,o=E.topic,a=E.Groups,i=E.Names,I=t.UIUtil.Component,S=t.ZSConstants,u=S.FeatureConstants,r=S.I18N,C=S.wCC,T=n.view.Toolbar.Feature[u.HIDE_SHEET];function l(t,s,E,o){"MI_SHEET_CONTEXT"===o.id&&(1==n.data.getWorkBook(t,E).SheetList.getSheets().length?I.disable(e):I.enable(e))}o.register(a.UI,i.Menu.INIT_SHEET_CONTEXT,function(t,n){"VERSION"!=n&&((e=s.createElement("li")).setAttribute("data",'{"label":"'+r["Sheet.Hide"]+'"}'),e.id=C.MI+ZSConstants.ContextConstant.SHEET_HIDE+C.MENU,e.addEventListener("click",function(){T.execute()}),t[ZSConstants.ContextConstant.SHEET_HIDE]=e,o.register(a.UI,i.Menu.CONTEXT_SHOW,l,"RID","SHEETID","VERSION","UI"))},"MENU_BAG","VIEW")}(this);
!function(t){var e,n=t.sPlusPlus,E=t.document,s=t.ZSEvents,o=s.topic,i=s.Groups,I=s.Names,a=t.UIUtil.Component,S=t.ZSConstants,u=S.FeatureConstants,N=S.I18N,T=S.wCC;n.view.Toolbar.Feature[u.UNHIDE_SHEET];function C(t,e,E){if("MI_SHEET_CONTEXT"===E.id){var s=!(n.data.getWorkBook(t,e).SheetList.getHiddenSheets().length>=1);a.zmenu("#"+E.id,"setMenuItemsAttribute",["#"+T.MI+ZSConstants.ContextConstant.SHEET_UNHIDE+T.MENU],"hidden",s)}}o.register(i.UI,I.Menu.INIT_SHEET_CONTEXT,function(t,n){"VERSION"!=n&&((e=E.createElement("li")).setAttribute("data",'{"label":"'+N["Sheet.Unhide"]+'"}'),e.setAttribute("data-menu-id",T.SUBMENUITEM+u.UNHIDE_SHEET+T.IDENTITY),e.id=T.MI+ZSConstants.ContextConstant.SHEET_UNHIDE+T.MENU,t[ZSConstants.ContextConstant.SHEET_UNHIDE]=e,o.register(i.UI,I.Menu.CONTEXT_BEFORE_SHOW,C,"RID","VERSION","UI"))},"MENU_BAG","VIEW")}(this);
!function(e){var t,n,i,E,s,S=e.sPlusPlus,T=e.UIUtil,o=e.ZSEvents,r=o.topic,u=o.Groups,a=o.Names,C=e.ZSConstants,l=C.ContextConstant,I=C.wCC,_=C.I18N,N=e.document,c=S.view.Toolbar.Feature.PASTE_SHEET,d=!1,A=((s=N.createElement("li")).setAttribute("data",'{"label":"'+_["CopySheet.Paste"]+'"}'),s);c.getCopiedSheetName=function(){return{sheetName:i,src_rid:E}},r.register(u.UI,a.Menu.CONTEXT_BEFORE_SHOW,function(e){if(d){var t=_["CopySheet.Paste"]+" '"+i+"'";e.id==I.MI+"SHEET_CONTEXT"&&(T.Component.zmenu("#"+I.MI+"SHEET_CONTEXT","setMenuItemsAttribute",["#PasteSheet_Context"],"label",t),T.Component.zmenu("#"+I.MI+"SHEET_CONTEXT","setMenuItemsAttribute",["#PasteSheet_Context"],"disabled",!1))}},"UI"),r.register(u.UI,a.Menu.INIT_SHEET_CONTEXT,function(e,n){"VERSION"!=n&&((t=A.cloneNode(!0)).setAttribute("disabled",!0),t.id="PasteSheet_Context",t.addEventListener("click",function(){c.execute()}),e[l.SHEET_PASTE]=t)},"MENU_BAG","VIEW"),r.register(u.UI,a.Menu.INIT_SHEETBAR_CONTEXT,function(e,t){(n=A.cloneNode(!0)).id="SheetBar_pasteSheet_Context",n.addEventListener("click",function(){c.execute()}),e[l.SHEET_PASTE]=n},"MENU_BAG","VIEW"),r.register(u.UI,a.Menu.CONTEXT_SHOW,function(e){if(e.id==I.MI+"SHEETBAR_CONTEXT")if(d){e.style.visibility="visible",n.style.display="";var t=_["CopySheet.Paste"]+" '"+i+"'";T.Component.zmenu("#"+I.MI+"SHEETBAR_CONTEXT","setMenuItemsAttribute",["#SheetBar_pasteSheet_Context"],"label",t)}else e.style.visibility="hidden",n.style.display="none"},"UI"),r.register(u.Listener,a.ServerClip.SHEET.ADD,function(e,t,n,s,S,T,o){d=!0,i=S,E=o},"RID","SHEETID","VERSION","SRC_SHEETID","SRC_SHEETNAME","LANG","SRC_RID")}(this);
!function(e){var t,o,r=e.sPlusPlus,i=e.ZSEvents,n=i.topic,c=i.Groups,a=i.Names,l=e.ZSConstants,s=e.document,v=e.ZSConstants.I18N,u=l.wCC,d=e.UIUtil.Component,E=(r.view.Toolbar.Feature.SHEET_TAB_COLOR,r.view.Events.Key);n.register(c.UI,a.Menu.INIT_SHEET_CONTEXT,function(e,i){var n;"VERSION"!=i&&((t=s.createElement("li")).setAttribute("data-label",v["Sheet.TabColor"]),t.id=u.MI+l.ContextConstant.SHEET_TABCOLOR+u.MENU,t.addEventListener("click",function(){var e=s.querySelector(".tab.activeTab");o.zcolorpicker("open",{forElement:e,position:"top"})}),e[l.ContextConstant.SHEET_TABCOLOR]=t,(n=s.createElement("div")).id="tabColorPicker",n.setAttribute("data-default-color-button",!1),s.body.appendChild(n),(o=d.zcolorpicker(n,{valueColorModel:"hex",defaultPaletteType:"custom",customPalette:r.view.ZSheetPalette,advancedPickerOptions:{opacity:!1}})).on("zcolorpickerpick",function(e,t){var o=r.view.getActiveGridID(),i=r.view.getResourceID(o),n=r.view.getVersionID(o),c=r.view.getSelectedSheets(o),a="transparent"!=t.color?t.color:"";UserAction.TabColorSheet(i,c,n,a)}).on("zcolorpickerbeforeopen",function(){var e=r.view.getActiveGridID(),t=r.view.getResourceID(e),i=r.view.getSheetID(e),n=r.view.getVersionID(e),c=r.data.getWorkBook(t,n),a=c.getSheetObj(i),l=a.Prop.Style;o.zcolorpicker("setValue",l);var s=E.Entry.Menu.Context;E.focusContext(s)}).on("zcolorpickerbeforeclose",function(){E.focusContext(E.Entry.CellEditor.Context)}))},"MENU_BAG","VIEW"),n.register(c.UI,a.Menu.CONTEXT_BEFORE_SHOW,function(){var e=r.view.getActiveGridID(),o=r.view.getResourceID(e),i=r.view.getSheetID(e),n=r.view.getVersionID(e);r.data.getWorkBook(o,n).ProtectedSheets.isSheetLocked(i)?d.disable(t):d.enable(t)},"UI")}(this);
!function(t){t.sPlusPlus;var n,e=t.ZSConstants,s=t.ZSEvents,i=s.topic,o=s.Groups,E=s.Names,u=e.ContextConstant,T=ZSClass.ContextMenu,C=[],S=[[u.SHEET_PASTE]];function _(){i.publish(o.UI,E.Menu.INIT_SHEETBAR_CONTEXT,{MENU_BAG:C}),this.init()}_.prototype={init:function(){this.sheetCtxMenu=T.create("MI_SHEETBAR_CONTEXT",C,S)},open:function(t){T.open(t,this.sheetCtxMenu)}},n=new _,T.register("MI_SHEETBAR_CONTEXT",n)}(this);
!function(E){E.sPlusPlus;var t,n=E.ZSConstants,T=E.ZSEvents,e=T.topic,s=T.Groups,i=T.Names,S=n.ContextConstant,_=ZSClass.ContextMenu,H=[],o=[[S.SHEET_INSERT,S.SHEET_DUPLICATE,S.SHEET_DELETE,S.SHEET_RENAME],[S.SHEET_COPY,S.SHEET_PASTE,S.SHEET_MOVE,S.SHEET_TABCOLOR,S.VBA_EDITOR],[S.SHEET_HIDE,S.SHEET_UNHIDE,S.MANAGE_FORM,S.SHEET_LOCKSHEET]],u=[];function C(){e.publish(s.UI,i.Menu.INIT_SHEET_CONTEXT,{MENU_BAG:H}),this.init()}C.prototype={init:function(E){var t="VERSION"==E?u:o;this.sheetCtxMenu=_.create("MI_SHEET_CONTEXT",H,t)},open:function(E){_.open(E,this.sheetCtxMenu)}},t=new C,_.register("MI_SHEET_CONTEXT",t),e.register(s.Listener,i.ContextMenu.INIT,function(E){t.init(E)},"VIEW")}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants,i=n.I18N,r=n.FeatureConstants,s=e.ZSEvents,a=s.topic,l=s.Groups,u=s.Names,I=e.document,o=e.ZSConstants.wCC,E=e.UIUtil.Component,d=ZSClass.Pivot,M=t.view.Toolbar.Feature[r.COMMENTS],c=e.ZSConstants.PivotConstant;function O(){a.publish(l.UI,u.SidePanel.PIVOT.OPEN)}function P(){t.view.Toolbar.Feature[r.CHART].execute(this,!0)}function T(){(new d.Refresh).selected()}function U(){d.pivotDeleteConfirmation()}function b(){sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_MOVE].openDialog(this)}function m(e){sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_GROUP].openDialog()}function v(e){sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_GROUP].unGroupSubmit()}function N(){M.openAndAddComment()}function R(e,n,i,r){if("MI_PIVOT_CONTEXT"===r.id){var s=t.view.getActiveGridID();e=t.view.getResourceID(s),t.data.getWorkBook(e,i).getSheetObj(n)}}a.register(l.UI,u.Menu.INIT_PIVOT_CONTEXT,function(e,t){if("VERSION"!=t){var s=n.ContextConstant;e[s.PIVOT_BUILDER]=((T=I.createElement("li")).setAttribute("data",'{"label":"'+i["Pivot.UI.Builder"]+'"}'),T.addEventListener("click",O),T),e[s.PIVOT_CHART]=function(){var e=I.createElement("li");return e.id=o.MI+r.CHART+o.MENU,e.setAttribute("data",'{"label":"'+i["Pivot.Toolbar.PivotChart"]+'"}'),e}(),e[s.PIVOT_MOVE]=((P=I.createElement("li")).setAttribute("data",'{"label":"'+i["Pivot.UI.Move"]+'"}'),P.addEventListener("click",b.bind("move")),P),e[s.PIVOT_COPY]=function(){var e=I.createElement("li");return e.id=o.MI+r.PIVOT_MOVE+o.MENU,e.setAttribute("data",'{"label":"'+i.Copy+'"}'),e}(),e[s.PIVOT_REFRESH]=((c=I.createElement("li")).id=o.MI+r.PIVOT_REFRESH+o.MENU,c.setAttribute("data",'{"label":"'+i.Refresh+'"}'),c),e[s.PIVOT_DELETE]=((M=I.createElement("li")).setAttribute("data",'{"label":"'+i.Delete+'"}'),M.addEventListener("click",U),M),e[s.PIVOT_GROUP]=((d=I.createElement("li")).id=o.MI+r.PIVOT_GROUP+o.MENU,d.setAttribute("data",'{"label":"'+i["SidePanel.Sparklines.Group"]+'"}'),d),e[s.PIVOT_UNGROUP]=function(){var e=I.createElement("li");return e.id=o.MI+r.PIVOT_UNGROUP+o.MENU,e.setAttribute("data",'{"label":"'+i["Pivot.UI.UNGROUP"]+'"}'),e}(),e[s.ADD_COMMENT]=((E=I.createElement("li")).setAttribute("data",'{"label":"'+i["MenuItem.InsertTab.Comments.AddComment"]+'"}'),E.addEventListener("click",N),E),a.register(l.UI,u.Menu.CONTEXT_BEFORE_SHOW,R,"RID","SHEETID","VERSION","UI")}var E,d,M,c,P,T},"MENU_BAG","VIEW"),a.register(l.UI,u.Menu.CONTEXT_BEFORE_SHOW,function(e,n,i,s){var a=t.data.getWorkBook(e,i).PivotCollection.get(d.ID);if(a){var l=s.querySelector("#"+o.MI+r.PIVOT_REFRESH+o.MENU),u=s.querySelector("#"+o.MI+r.CHART+o.MENU),I=s.querySelector("#"+o.MI+r.PIVOT_MOVE+o.MENU);a[c.ROW_FIELDS].length<1&&a[c.COLUMN_FIELDS].length<1&&a[c.DATA_FIELDS].length<1&&a[c.PAGE_FIELDS].length<1?(l.removeEventListener("click",T),u.removeEventListener("click",P),I.removeEventListener("click",b.bind("copy")),E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.PIVOT_REFRESH+o.MENU],"disabled",!0),E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.CHART+o.MENU],"disabled",!0),E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.PIVOT_MOVE+o.MENU],"disabled",!0)):(l.addEventListener("click",T),u.addEventListener("click",P),I.addEventListener("click",b.bind("copy")),E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.PIVOT_REFRESH+o.MENU],"disabled",!1),E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.CHART+o.MENU],"disabled",!1),E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.PIVOT_MOVE+o.MENU],"disabled",!1))}var M=s.querySelector("#"+o.MI+r.PIVOT_GROUP+o.MENU),O=s.querySelector("#"+o.MI+r.PIVOT_UNGROUP+o.MENU);if(M&&O){M.removeEventListener("click",m),O&&O.removeEventListener("click",v);var U=d.Group.Action.getNumFieldInfoDetails();U?(M.addEventListener("click",m),E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.PIVOT_GROUP+o.MENU],"disabled",!1),U.colInfo.pgrz?(O.addEventListener("click",v),E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.PIVOT_UNGROUP+o.MENU],"disabled",!1)):E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.PIVOT_UNGROUP+o.MENU],"disabled",!0)):(E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.PIVOT_GROUP+o.MENU],"disabled",!0),E.zmenu(s,"setMenuItemsAttribute",["#"+o.MI+r.PIVOT_UNGROUP+o.MENU],"disabled",!0))}},"RID","SHEETID","VERSION","UI")}(this);
!function(t){var e,n,i,a,l,r,o,s,C,d,c,u,h,E,A,I=t.sPlusPlus,T=t.ZSConstants,S=t.document,m=t.ZSConstants.I18N,v=t.ZSConstants.wCC,g=document.getElementById("popupmenu"),b=t.UIUtil.Component,R=t.ZSChart,U=t.ZSEvents,w=U.topic,M=U.Groups,p=U.Names,y=R.Constants.ChartPublishConstant,_=!1;function D(){(new R.Controller.ZSCController).doEdit()}function f(){(new R.Controller.ZSCController).doReplay()}function N(){(new R.Controller.ZSCController).stopChartAnimation()}function L(){(new R.Controller.ZSCController).doPauseAction()}function H(){(new R.Controller.ZSCController).doResumeAction()}function O(){(new R.Controller.ZSCController).doChartTypeChange()}function P(){(new R.Controller.ZSCController).saveChartAsImage()}function Z(){var t=I.view.getActiveGridID(),e=I.view.getResourceID(t),n=I.view.getVersionID(t),i=I.view.getSheetID(t),a=R.Utility.getActiveChart();w.publish(M.Listener,p.UserAction.CHARTS.DELETE,{RID:e,SHEETID:i,VERSION:n,ACTIVE_CHART_ID:a})}function k(){(new R.Controller.ZSCController).doCloneAction()}function B(){var t=document.createElement("ul");t.id=v.SUBMENUITEM+T.ContextConstant.MOVE_CHART+v.IDENTITY,t.setAttribute("data-ctype","zmenu"),b.bind(t,"zmenuitemclick",function(t,e){!function(t,e){var n=e.asn||e.id.split("_")[2];if(b.hideContextMenu(),(new R.Utility.ChartAgent).isLockedSheet(n+"#"))return void ZSClass.ZSAlert(m["ProtectRange.UI.SheetLocked"],{title:m["Alert.Title.LockedSheet"]});(new R.Controller.ZSCController).switchChart(n)}(0,e.data)}),g.appendChild(t)}function V(){var t={id:v.SUBMENUITEM+T.ContextConstant.STYLE_CHART+v.IDENTITY,"data-ctype":"zmenu",relativeto:"parent"},e=[{data:'{"label":"'+m.Copy+'", "action": "CS"}'},{data:'{"label":"'+m["CopySheet.Paste"]+'", "action": "PS"}',id:"chtpastestyle",class:"disabled"},{mtype:"separator"},{data:'{"label":"'+m["Chart.Reset.Styles"]+'", "action": "RS"}'}];I.view.Menu.create(e,t,g).then(function(){b.bind("#"+v.SUBMENUITEM+T.ContextConstant.STYLE_CHART+v.IDENTITY,"zmenuitemclick",function(t,e){var n,i=e.data;n=i,(new R.Controller.ZSCController).doStyleClip(n.action)}),b.bind("#"+v.SUBMENUITEM+T.ContextConstant.STYLE_CHART+v.IDENTITY,"zmenubeforeshow",function(t,e){var n=new R.Manager.ZSCCManager,i=n.hasStyleClip()?n.getClip():null,a=!!i&&i.isPasteEnable(),l=R.Wrapper.DOMUtils,r=l.getElementById("chtpastestyle");a?l.removeClass(r,"disabled"):l.addClass(r,"disabled")})})}function Y(t,u,S,m){var g,U;if("MI_CHART_CONTEXT"===m.id){var w,M,p,y=R.Wrapper.DOMUtils,D=I.view.getActiveGridID(),f=(t=I.view.getResourceID(D),I.data.getWorkBook(t,S).getSheetObj(u),I.view.getSheetID(D)),N=R.Utility.getActiveChart();R.Utility.getChartMeta(N,!0);if(setTimeout(function(){var t=R.Utility.getActiveChart(),o=R.Utility.getChartMeta(t,!0),s=!!o&&o.isPublishChart();!function(t){var e=R.Wrapper.DOMUtils;t>1&&(e.hide(l),e.hide(r),e.hide(C),e.hide(c),e.hide(c),e.hide(d))}(t.length),function(t,e){var n=R.Wrapper.DOMUtils;n.hide(h),n.hide(E),n.hide(A),1==e&&(t?(n.show(E),n.show(A)):n.show(h))}(s,t.length),function(){var t=new R.Manager.ZSCCManager,e=t.hasStyleClip()?t.getClip():null,n=!!e&&e.isPasteEnable(),i=R.Wrapper.DOMUtils,a=i.getElementById("chtpastestyle");n?i.removeClass(a,"disabled"):i.addClass(a,"disabled")}(),y.hide(e),y.hide(n),y.hide(i),y.hide(a),w="ANIMATION_CHART"==o.chartMeta.type,M=R.Utility.getAnimating(t[0],0)||R.Utility.getAnimating(t[0],1)||R.Utility.getAnimating(t[0],2)||R.Utility.getAnimating(t[0],3),p=R.Utility.getPaused(t[0],0)||R.Utility.getPaused(t[0],1)||R.Utility.getPaused(t[0],2)||R.Utility.getPaused(t[0],3),w&&(M?(y.show(n),y.show(i)):p?(y.show(a),y.show(n)):y.show(e))},10),y.show(l),y.show(r),y.show(o),y.show(C),y.show(s),y.show(d),y.show(c),y.hide(h),y.hide(E),y.hide(A),g=f,null==(U=(new R.Utility.CommanAgent).getMoveMenuRefreshSheetName())||U!=g)(new R.Utility.CommanAgent).setMoveMenuRefreshedSheetName(f),function(){var t=document.querySelector("#"+v.SUBMENUITEM+T.ContextConstant.MOVE_CHART+v.IDENTITY);t.innerHTML="";var e,n=I.view.getActiveGridID(),i=I.view.getResourceID(n),a=I.view.getVersionID(n),l=I.data.getWorkBook(i,a).SheetList.getSheets(),r=I.view.getSheetID(n),o=R.Wrapper.DOMUtils;if(o.show(d),1==l.length)return o.hide(d),void(_=!0);_=!1;for(var s=0;s<l.length;s++)if((e=l[s].Id)!==r){var C=document.createElement("li");C.innerText=l[s].Name,C.id=T.ContextConstant.MOVE_CHART+"_M_"+parseInt(e),C.setAttribute("asn",parseInt(e)),t.appendChild(C)}b.zmenu(t,"refresh")}();_&&y.hide(d)}}w.register(M.UI,p.Menu.INIT_CHART_CONTEXT,function(t,g){if("VERSION"!=g){var b=T.ContextConstant;t[b.PAUSE_ANIMATION]=((i=S.createElement("li")).setAttribute("data",'{"label":"'+m.ChartPause+'"}'),i.addEventListener("click",L),i),t[b.RESUME_ANIMATION]=((a=S.createElement("li")).setAttribute("data",'{"label":"'+m.ChartResume+'"}'),a.addEventListener("click",H),a),t[b.REPLAY_CHART]=((e=S.createElement("li")).setAttribute("data",'{"label":"'+m.ChartPlay+'"}'),e.addEventListener("click",f),e),t[b.STOP_ANIMATION]=((n=S.createElement("li")).setAttribute("data",'{"label":"'+m.ChartStop+'"}'),n.addEventListener("click",N),n),t[b.EDIT_CHART]=((l=S.createElement("li")).setAttribute("data",'{"label":"'+m.EditChart+'..."}'),l.addEventListener("click",D),l),t[b.STYLE_CHART]=((c=document.createElement("li")).setAttribute("data-label",m["Chart.Styles"]),c.setAttribute("data-menu-id",v.SUBMENUITEM+T.ContextConstant.STYLE_CHART+v.IDENTITY),c),t[b.MOVE_CHART]=((d=document.createElement("li")).id=v.SUBMENUITEM+T.ContextConstant.MOVE_CHART+v.IDENTITY+"_Chart",d.setAttribute("data-label",m["Chart.MoveChart"]),d.setAttribute("data-menu-id",v.SUBMENUITEM+T.ContextConstant.MOVE_CHART+v.IDENTITY),d),t[b.CHANGE_CHART]=((s=S.createElement("li")).setAttribute("data",'{"label":"'+m.ChangeChartType+'..."}'),s.addEventListener("click",O),s),t[b.CLONE_CHART]=((C=S.createElement("li")).setAttribute("data",'{"label":"'+m["Chart.Clone"]+'"}'),C.addEventListener("click",k),C),t[b.DELETE_CHART]=((o=S.createElement("li")).setAttribute("data",'{"label":"'+m.Delete+'"}'),o.addEventListener("click",Z),o),t[b.SAVE_CHART]=((r=S.createElement("li")).setAttribute("data",'{"label":"'+m["Image.SaveAsImage"]+'"}'),r.addEventListener("click",P),r),t[b.PUBLISH_CHART_URL]=((E=document.createElement("li")).setAttribute("data",'{"label":"'+m["Chart.ShowURL"]+'","status":"showUrl"}'),E.addEventListener("click",function(){(new R.Controller.ZSCController).doPublishAction({status:y.SHOWURL},void 0,!0)}),E),t[b.REVERT_PUBLISH]=((A=document.createElement("li")).setAttribute("data",'{"label":"'+m["Chart.UnPublish"]+'","status":"unpublish"}'),A.addEventListener("click",function(){(new R.Controller.ZSCController).doPublishAction({status:y.REVERT})}),A);var U=I.view.getActiveGridID(),_=I.view.getResourceID(U);I.data.DocRegistry[_].RemoteViewInfo&&I.data.DocRegistry[_].RemoteViewInfo.REMOTE_ENC_DOC_ID||(t[b.PUBLISH_CHART]=((h=document.createElement("li")).setAttribute("data",'{"label":"'+m["Chart.Publish"]+'","status":"publish"}'),h.addEventListener("click",function(){(new R.Controller.ZSCController).doPublishAction({status:y.PUBLISH})}),h),t[b.ADD_TO_IMAGE_LIBRARY]=((u=document.createElement("li")).setAttribute("data",'{"label":"'+(m["Chart.AddToImageLibrary"]||"Add to Image Library")+'","status":"add"}'),u.addEventListener("click",function(){(new R.Controller.ZSCController).addChartToImageLibrary(R.Utility.getActiveChart(!0))}),u)),V(),B(),w.register(M.UI,p.Menu.CONTEXT_BEFORE_SHOW,Y,"RID","SHEETID","VERSION","UI")}},"MENU_BAG","VIEW")}(this);
!function(t){var e,n=t.sPlusPlus,T=t.ZSConstants,i=t.ZSEvents,A=i.topic,C=i.Groups,s=i.Names,I=T.ContextConstant,_=ZSClass.ContextMenu,o=[],E=[[I.REPLAY_CHART,I.PAUSE_ANIMATION,I.RESUME_ANIMATION,I.STOP_ANIMATION,I.EDIT_CHART,I.CHANGE_CHART],[I.STYLE_CHART],[I.MOVE_CHART,I.CLONE_CHART,I.DELETE_CHART],[I.SAVE_CHART,I.ADD_TO_IMAGE_LIBRARY],[I.PUBLISH_CHART,I.PUBLISH_CHART_URL,I.REVERT_PUBLISH]],R=[];function r(){A.publish(C.UI,s.Menu.INIT_CHART_CONTEXT,{MENU_BAG:o}),this.init()}r.prototype={init:function(t){var e="VERSION"==t?R:E;this.chartCtxMenu=_.create("MI_CHART_CONTEXT",o,e)},open:function(t){var e=n.view.getActiveGridID(),T=n.view.getResourceID(e),i=n.view.getVersionID(e),A=n.view.getSheetID(e);n.data.getWorkBook(T,i).ProtectedSheets.isSheetLocked(A)||_.open(t,this.chartCtxMenu)}},e=new r,_.register("MI_CHART_CONTEXT",e),A.register(C.Listener,s.ContextMenu.INIT,function(t){e.init(t)},"VIEW")}(this);
!function(t){var e,i=t.sPlusPlus,I=t.ZSConstants,E=t.ZSEvents,n=E.topic,s=E.Groups,T=E.Names,C=I.ContextConstant,_=ZSClass.ContextMenu,o=[],O=[],N=[],r=[[C.CUT,C.COPY,C.PASTE,C.CLEAR],[C.INSERT,C.DELETE,C.FILTER],[C.ADD_NOTE,C.EDIT_NOTE,C.ADD_COMMENT],[C.ADD_HYPERLINK,C.SPARKLINE,C.DEFINE_NAME,C.PICKLIST],[C.LOCK_RANGE,C.UNLOCK_RANGE,C.PUBLISH_RANGE]],M=[[C.COPY]],R=[[C.PIVOT_BUILDER,C.PIVOT_MOVE,C.PIVOT_COPY,C.PIVOT_REFRESH,C.PIVOT_DELETE],[C.PIVOT_GROUP,C.PIVOT_UNGROUP],[C.PIVOT_CHART],[C.ADD_COMMENT]],P=[[C.ADD_COMMENT,C.COPY,C.UNLOCK_RANGE]];function u(){n.publish(s.UI,T.Menu.INIT_GRID_CONTEXT,{MENU_BAG:o}),n.publish(s.UI,T.Menu.INIT_PIVOT_CONTEXT,{MENU_BAG:O}),n.publish(s.UI,T.Menu.INIT_LOCK_CONTEXT,{MENU_BAG:N})}u.prototype={init:function(t){var e="VERSION"==t?M:r;this.gridCtxMenu=_.create("MI_GRID_CONTEXT",o,e),this.pivotCtxMenu=_.create("MI_GRID_CONTEXT",O,R),this.lockCtxMenu=_.create("MI_GRID_CONTEXT",N,P)},open:function(t){var e=i.view.getActiveGridID(),I=i.view.getResourceID(e),E=i.view.getVersionID(e),n=i.view.getSheetID(e),s=i.view.getSheetState(e,n).getActiveCellRange(),T=i.data.getWorkBook(I,E),C=T.getSheetObj(n),o=!!C.Pivot.isXists(s.startRow,s.startCol),O=!(!C.ProtectedRanges.isXists(s.startRow,s.startCol)&&!T.ProtectedSheets.isSheetLocked(n));o?_.open(t,this.pivotCtxMenu):O?_.open(t,this.lockCtxMenu):_.open(t,this.gridCtxMenu)}},(e=new u).init(),_.register("MI_GRID_CONTEXT",e),n.register(s.Listener,T.ContextMenu.INIT,function(t){e.init(t)},"VIEW")}(this);
!function(t){t.sPlusPlus;var n,E=t.ZSConstants,e=t.ZSEvents,i=e.topic,s=e.Groups,C=e.Names,O=E.ContextConstant,N=ZSClass.ContextMenu,_=[],o=[[O.CUT,O.COPY,O.PASTE,O.CLEAR],[O.INSERT,O.DELETE_ROW,O.ROW_HEIGHT_OPTIONS,O.HIDE_ROWS,O.UNHIDE_ROWS],[O.ADD_COMMENT],[O.DEFINE_NAME],[O.LOCK_RANGE,O.UNLOCK_RANGE,O.PUBLISH_RANGE]],I=[[O.COPY]];O.ADD_COMMENT,O.COPY;function T(){i.publish(s.UI,C.Menu.INIT_ROW_HEAD_CONTEXT,{MENU_BAG:_}),this.init()}T.prototype={init:function(t){var n="VERSION"==t?I:o;this.rowHeadCtxMenu=N.create("MI_ROWHEAD_CONTEXT",_,n)},open:function(t){N.open(t,this.rowHeadCtxMenu)}},(n=new T).init(),N.register("MI_ROWHEAD_CONTEXT",n),i.register(s.Listener,C.ContextMenu.INIT,function(t){n.init(t)},"VIEW")}(this);
!function(t){t.sPlusPlus;var n,C=t.ZSConstants,E=t.ZSEvents,e=E.topic,i=E.Groups,s=E.Names,N=C.ContextConstant,O=ZSClass.ContextMenu,_=[],o=[[N.CUT,N.COPY,N.PASTE,N.CLEAR],[N.INSERT,N.DELETE_COL,N.COLUMN_WIDTH_OPTIONS,N.HIDE_COLS,N.UNHIDE_COLS],[N.ADD_COMMENT],[N.DEFINE_NAME],[N.LOCK_RANGE,N.UNLOCK_RANGE,N.PUBLISH_RANGE]],I=[[N.COPY]];N.ADD_COMMENT,N.COPY;function T(){e.publish(i.UI,s.Menu.INIT_COL_HEAD_CONTEXT,{MENU_BAG:_}),this.init()}T.prototype={init:function(t){var n="VERSION"==t?I:o;this.colHeadCtxMenu=O.create("MI_COLHEAD_CONTEXT",_,n)},open:function(t){O.open(t,this.colHeadCtxMenu)}},(n=new T).init(),O.register("MI_COLHEAD_CONTEXT",n),e.register(i.Listener,s.ContextMenu.INIT,function(t){n.init(t)},"VIEW")}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=e.ZSDevTools.Logger,c=e.ZSClass.ActionObject,l=e.ZSConstants.ActionConstants,I=e.ZSConstants.URI,S=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.FONTFAMILY=function(e,n,d,R,A,E,v,g){if(R){var L=l.FONTFAMILY,u=(t.data.getWorkBook(e,d),t.view.getActiveGridID()),C=t.view.getSheetID(u),O=(t.view.getActiveState(u),new i.ParamGenerator(n,e,d,!0,!0)),T=O.getSheets(),f=O.getRanges(),D=O.getActiveCell(),N={RID:e,sheetList:T,rangeList:f,activeCell:D,action:L,VERSION:d,value:R},p=new c(L,N,R),F=f[JSUtil.fn.getIndexOf(C,T)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:C,VERSION:d});var U=new S;U.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:C,VERSION:d,ACTION:L,RANGELIST:F,VALUE:R})}),U.addEventListeners("onComplete",function(e){e.qaid,p.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(p)}),U.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),U.open(I.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(U,p),U.send(N)}else a.log("value is not defined",R,L)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=e.ZSDevTools.Logger,S=e.ZSClass.ActionObject,c=e.ZSConstants.ActionConstants,l=e.ZSConstants.URI,I=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.FONTSIZE=function(e,n,d,E,R,A,v,g){if(E){var u=c.FONTSIZE,C=(t.data.getWorkBook(e,d),t.view.getActiveGridID()),O=t.view.getSheetID(C),L=(t.view.getActiveState(C),new i.ParamGenerator(n,e,d,!0,!0)),T=L.getSheets(),f=L.getRanges(),D=L.getActiveCell(),N={RID:e,sheetList:T,rangeList:f,activeCell:D,action:u,VERSION:d,value:E},p=new S(u,N,E),U=f[JSUtil.fn.getIndexOf(O,T)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:O,VERSION:d});var Z=new I;Z.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:O,VERSION:d,ACTION:u,RANGELIST:U,VALUE:E})}),Z.addEventListeners("onComplete",function(e){e.qaid,p.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(p)}),Z.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),Z.open(l.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(Z,p),Z.send(N)}else a.log("value is not defined",E,u)}}(this);
!function(e){var n=e.sPlusPlus,t=e.ZSEvents,s=e.ZSClass,i=t.topic,a=t.Groups,r=t.Names,o=e.ZSConstants,c=(s=e.ZSClass,o.I18N,n.SML.Client.Utility.WorkerRequest),A=o.URI,l=(e.encodeURIComponent,s.ActionObject),E=o.ActionConstants,R=e.ZSConstants.FeatureConstants;n.view.Toolbar.Feature[R.DATA_CLEANING];e.UserAction.ReadTable=function(e,n,t,o,l){var R=new s.ParamGenerator(n,e,t,!0),L=R.getSheets(),u=o?R.getCustomRanges(o):R.getRanges(),C=R.getActiveCell(),T={rID:e,sheetList:L,rangeList:u,VERSION:t,action:E.READ_DATA_DUPLICATES,activeCell:C,type:l},d=new c;d.addEventListeners("onComplete",function(e){i.publish(a.Listener,r.UserAction.DATA_DUPLICATE.TABLE_DETAILS,{TABLE_DETAILS:e.tableRange})}),d.addEventListeners("onError",function(e){i.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(A.READ_DATA_DUPLICATES),d.send(T)},e.UserAction.ReadFrequencyTable=function(e,n,t,s,o,l,E){var R={rID:e,sheetList:t,rangeList:s,VERSION:n,activeCell:o,columnIndex:l,findDataRange:E||!1},L=new c;L.addEventListeners("onComplete",function(e){i.publish(a.Listener,r.UserAction.DATA_DUPLICATE.FREQUENCY_DETAILS,{FREQUENCY_DETAILS:e.duplicatesInfo})}),L.addEventListeners("onError",function(e){i.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),L.open(A.READ_FREQUENCYY_TABLE),L.send(R)},e.UserAction.getDuplicates=function(e,t,o,R,L,u,C,T,d,S,D,I,g,p,v,_,U){var O,f,m=new s.ParamGenerator(t,e,o,!0,!0),h=m.getSheets(),N=R?m.getCustomRanges(JSUtil.Range.parseRange(e,o,R).range):m.getRanges(),P=m.getActiveCell();"move"!=T&&"copy"!=T||_||(h=U.sheetList,N=U.rangeList,P=U.activeCell,O=U.srcSheetList,f=U.srcRangeList);var F={RID:e,sheetList:h,rangeList:N,VERSION:o,action:E.GET_DATA_DUPLICATES,activeCell:P,frl:L,columnAry:u,includeFirstOccurence:C,operationType:T,isCaseSensitive:d,isBlanks:S,actionType:v,value:D,includeHiddenCells:p,isNewSheet:_,srcSheetList:O,srcRangeList:f},b=new c,G=new l(E.GET_DATA_DUPLICATES,F);b.addEventListeners("onComplete",function(e){1!=_&&(G.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(G))}),b.addEventListeners("onError",function(e){i.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),b.open(A.GET_DATA_DUPLICATES),b.send(F)},e.UserAction.getDuplicatesInfo=function(e,n,t,o,R,L,u,C,T,d){var S=new s.ParamGenerator(n,e,t,!0,!0),D=S.getSheets(),I=o?S.getCustomRanges(JSUtil.Range.parseRange(e,t,o).range):S.getRanges(),g=S.getActiveCell(),p={RID:e,sheetList:D,rangeList:I,VERSION:t,action:E.DATA_DUPLICATES_INFO,activeCell:g,frl:R,columnAry:L,includeFirstOccurence:u,isCaseSensitive:C,includeHiddenCells:T,actionType:d},v=new c;new l(E.DATA_DUPLICATES_INFO,p),v.addEventListeners("onComplete",function(e){i.publish(a.Listener,r.UserAction.DATA_DUPLICATE.TABLE_INFO,{TABLE_INFO:e.duplicatesInfo})}),v.addEventListeners("onError",function(e){i.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(A.DATA_DUPLICATES_INFO),v.send(p)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),c=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI,S=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.WRAP=function(e,n,I,d,l,A,E,v){d=1==d?1:0;var g=c.WRAP,C=(t.data.getWorkBook(e,I),t.view.getActiveGridID()),u=t.view.getSheetID(C),L=(t.view.getActiveState(C),new i.ParamGenerator(n,e,I,!0,!0)),O=L.getSheets(),T=L.getRanges(),D=L.getActiveCell(),f={RID:e,sheetList:O,rangeList:T,activeCell:D,action:g,VERSION:I,value:d},p=new a(g,f,d),N=T[JSUtil.fn.getIndexOf(u,O)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:u,VERSION:I});var U=new S;U.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:u,VERSION:I,ACTION:g,RANGELIST:N,VALUE:d})}),U.addEventListeners("onComplete",function(e){e.qaid,p.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(p)}),U.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),U.open(R.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(U,p),U.send(f)}}(this);
!function(e){var n=e.ZSEvents,t=e.ZSClass,r=n.topic,s=n.Groups,a=n.Names,i=e.ZSConstants,o=i.I18N,E=e.sPlusPlus,R=(t=e.ZSClass,E.SML.Client.Utility.WorkerRequest),c=t.ActionObject,d=i.ActionConstants,S=i.URI;e.UserAction.MergeRange=function(e,n,i,l){l||(l=1);var C,M=new t.ParamGenerator(n,e,i,!0,!0),f=M.getSheets(),u=M.getRanges(),g=M.getActiveCell();switch(l){case 1:C=d.MERGE_RANGE;break;case 2:C=d.MERGE_AND_CENTER;break;case 3:C=d.MERGE_DOWN;break;case 4:C=d.MERGE_ACROSS;break;default:C=d.MERGE_RANGE}var L={RID:e,sheetList:f,rangeList:u,activeCell:g,type:l,VERSION:i,action:C},G=new c(d.MERGE_RANGE,L,l),v=new R;v.addEventListeners("onComplete",function(e){G.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(G)}),v.addEventListeners("askConfirm",function(e){var n=new t.ZSConfirm(o[e.mk]);n.onYES(function(){v.param.showAlert=!1,v.resend()});var i=n.execute();r.publish(s.Listener,a.DocAction.ConfirmMsg.SHOW,{MSG:n.getMsg(),KEY:i,CONFIRMOBJ:n})}),v.addEventListeners("onError",function(e){r.publish(s.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(S.MERGE_CELLS_ADD),E.data.UserInfo.registerForRepeat(v,G),v.send(L)},e.UserAction.SplitRange=function(e,n,i,l){var C=new t.ParamGenerator(n,e,i,!0,!0),M=C.getSheets(),f=C.getRanges(),u={RID:e,sheetList:M,activeCell:C.getActiveCell(),action:d.MERGE_SPLIT,VERSION:i,rangeList:f},g=new c(d.MERGE_SPLIT,u),L=new R;L.addEventListeners("onComplete",function(e){g.qaid=e.qaid,E.data.UserInfo.ActionRecorder.record(g),l()}),L.addEventListeners("askConfirm",function(e){var n=new t.ZSConfirm(o[e.mk]);n.onYES(function(){L.resend()});var i=n.execute();r.publish(s.Listener,a.DocAction.ConfirmMsg.SHOW,{MSG:n.getMsg(),KEY:i,CONFIRMOBJ:n})}),L.addEventListeners("onError",function(e){r.publish(s.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),L.open(S.MERGE_CELLS_REMOVE),E.data.UserInfo.registerForRepeat(L,g),L.send(u)}}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSEvents,a=o.topic,n=o.Groups,s=e.JSUtil,i=o.Names,S=(s=e.JSUtil,e.ZSDevTools.Logger),C=e.ZSConstants,r=t.SML.Client,R=(e.ZSClass,r.Utility.WorkerRequest),l=C.ActionConstants,E=C.CommandConstants,I=C.URI,O=t.data.UserInfo;function d(o,C,r,d,P,c,D){var _=t.data.getWorkBook(o,r).getSheetObj(C[0]).Prop.Name,u=new e.ZSClass.ParamGenerator(C,o,r,!0,!0),A=u.getSheets(),p=u.getRanges(),T=u.getActiveCell(),f=O.activeInfo.getCopyState(),g=f?l.SERVERCLIP_COPY_RANGE:l.SERVERCLIP_CUT_RANGE,L={RID:o,RS_ID:t.data.PageRegistry.RS_ID,sheetList:A,VERSION:r,action:g,rangeList:p,activeCell:T,isSolidCopy:P,isRequiredTabSeparatedValues:c,sheetName:_},U=s.fn.getIndexOf(T.s,A),v=p[U],N=new R;N.addEventListeners("onComplete",function(e){if(e.a&&e.a===l.SHOW_ERROR_MESSAGE)S.log("COPY Error case has to be handled");else if(e[E.COPY_TO_CLIP]){if((v.endRow-v.startRow+1)*(v.endCol-v.startCol+1)>t.data.Defaults.MAX_COPY_LIMIT){var s=v.getColSpan(),R=Math.floor(t.data.Defaults.MAX_COPY_LIMIT/s);v.endRow=v.startRow+R}a.publish(n.Listener,i.CellAction.ADDCOPYINFO,{RID:o,SHEETID:C[0],VERSION:r,ActiveCellRange:v,DATA:e[E.COPY_TO_CLIP][E.DATA],DATATYPE:e[E.COPY_TO_CLIP][E.TYPE]})}}),N.addEventListeners("onError",function(e){a.publish(n.Selector.BoundUpdate.Copy,i.Selection.BOUND_UPDATE.REMOVE,{RID:o,SHEETID:C[0],VERSION:r}),a.publish(n.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})});var h=f?I.COPY:I.CUT;N.open(h),N.send(L),a.publish(n.Selector.BoundUpdate.Copy,i.Selection.BOUND_UPDATE.ADD,{RID:o,SHEETID:T.s,VERSION:r,RANGES:v,SHEETS:A[U],IS_SERVER_CLIP:!1,IS_COPY:f})}e.UserAction.Copy=function(e,o,a,n,s,i){t.data.getWorkBook(e,a),O.activeInfo.setCopyState(1),d(e,o,a,0,s,i)},e.UserAction.Cut=function(e,o,a,n,s,i,S){t.data.getWorkBook(e,a),O.activeInfo.setCopyState(0),d(e,o,a,0,s,i)}}(this);
!function(a){var t=a.sPlusPlus,e=a.ZSEvents,s=a.ZSClass,n=e.topic,o=e.Groups,i=e.Names,c=(a.ZSDevTools.Logger,a.ZSClass.ActionObject),r=a.ZSConstants.ActionConstants,R=a.ZSConstants.URI,S=t.SML.Client.Utility.WorkerRequest;a.UserAction;a.UserAction.invokeRecastAction=function(a,e,d,E,v){var A=r.RECAST,I=(t.data.getWorkBook(a,d),t.view.getActiveGridID()),l=(t.view.getSheetID(I),t.view.getActiveState(I),new s.ParamGenerator(e,a,d,!0,!0)),C=l.getSheets(),f=l.getRanges(),u=l.getActiveCell();switch(t.data.RecastInfo.action){case r.SYSTEMCLIP_PASTE:t.data.RecastInfo.aparams.format=v.data.value;break;case r.SERVERCLIP_PASTE_RANGE:case r.COPY_PASTE:t.data.RecastInfo.aparams.pstype=v.data.value,t.data.RecastInfo.action=r.COPY_PASTE;break;case r.FILLSERIES:t.data.RecastInfo.aparams.fst=v.data.value}var p={RID:a,sheetList:C,rangeList:f,activeCell:u,action:A,VERSION:d,aaid:t.data.RecastInfo.actionId,aaction:t.data.RecastInfo.action,aparams:t.data.RecastInfo.aparams},g=(new c(r.RECAST,p),new S);g.addEventListeners("onComplete",function(a){a&&(t.data.isRecastAction=a.isRecastAction)}),g.addEventListeners("onError",function(a){n.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:a.mk})}),g.open(R.RECAST),g.send(p)}}(this);
!function(e){var t=e.sPlusPlus.SML.Client.Utility.WorkerRequest,n=e.ZSClass.ActionObject,s=e.ZSEvents,i=s.topic,o=s.Groups,r=s.Names,E=e.ZSConstants,S=E.URI,a=(E.I18N,E.ActionConstants);e.UserAction.DocumentSetting=function(s,E,c,u,R,T,C){var N={RID:s,sheetList:new e.ZSClass.ParamGenerator(E,s,c).getSheets(),countryName:u,timeZoneId:R,VERSION:c,setDefault:!1,sheetDirection:C,docView:T},O=(new n(a.DOCUMENT_SETTING,N),new t);O.addEventListeners("onComplete",function(e){}),O.addEventListeners("onError",function(e){i.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(S.DOCUMENT_SETTING),O.send(N)},e.UserAction.fetchDocumentSettings=function(s,E,c){new e.ZSClass.ParamGenerator(E,s,c).getSheets();var u={RID:s,VERSION:c},R=(new n(a.FETCH_DOCUMENTSETTINGS,u),new t);R.addEventListeners("onComplete",function(e){if(e){var t=e.documentSettings;i.publish(o.Listener,r.UserAction.FETCH_DOCUMENT_SETTINGS,{RESPONSE:t})}}),R.addEventListeners("onError",function(e){i.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),R.open(S.FETCH_DOCUMENTSETTINGS),R.send(u)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,i=s.Groups,o=s.Names,a=t.SML.Client.Utility.WorkerRequest,r=e.ZSClass.ActionObject,S=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI,E=(e.UserAction,ZSConstants.I18N);e.UserAction.SendAttachmentInMail=function(e,s,R,l,v,I,w){var A=t.view.getActiveGridID(),g=t.view.getResourceID(A),u=(t.view.getSheetID(A),t.view.getVersionID(A)),C=t.view.getSelectedSheets(A),d=S.SEND_SPREADSHEET_IN_MAIL,D=(t.data.getWorkBook(g,u),t.view.getActiveState(A),new ZSClass.ParamGenerator(C,g,u,!0,!0)),N={RID:g,sheetList:D.getSheets(),rangeList:D.getRanges(),activeCell:D.getActiveCell(),action:d,VERSION:u,emailids:e,format:l,message:R,sendCopy:v,subject:s,password:I,sheetName:w},h=(new r(S.SEND_SPREADSHEET_IN_MAIL,N),new a);h.addEventListeners("onComplete",function(e){if(e.ERROR){var t=e.ERROR.ErrorMSGKey;new ZSClass.TBNotification(E[t],{type:"error"}).show()}else new ZSClass.TBNotification(E["Mail.DocumentSent"],{type:"info"}).show()}),h.addEventListeners("onError",function(e){n.publish(i.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(c.SEND_SPREADSHEET_IN_MAIL),h.send(N)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,i=s.Groups,a=s.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSClass.ActionObject,c=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI,C=(e.UserAction,e.ZSConstants.FeatureConstants),R=t.view.Toolbar.Feature[C.SEND_AS_ATTACHMENT];e.UserAction.searchContact=function(e){var s=t.view.getActiveGridID(),C=t.view.getResourceID(s),R=(t.view.getSheetID(s),t.view.getVersionID(s)),v=t.view.getSelectedSheets(s),g=c.GET_USER_CONTACT,E=(t.data.getWorkBook(C,R),t.view.getActiveState(s),new ZSClass.ParamGenerator(v,C,R,!0,!0)),l={RID:C,sheetList:E.getSheets(),rangeList:E.getRanges(),activeCell:E.getActiveCell(),action:g,VERSION:R,apiMode:"SEARCH",startIndex:0,searchstring:e},A=(new o(c.GET_USER_CONTACT,l),new r);A.addEventListeners("onComplete",function(e){}),A.addEventListeners("onError",function(e){n.publish(i.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(S.GET_USER_CONTACT),A.send(l)},e.UserAction.fecthContact=function(){if(t.data.UserInfo.USER_CONTACT)R.openDialog();else{var s=t.view.getActiveGridID(),r=t.view.getResourceID(s),o=(t.view.getSheetID(s),t.view.getVersionID(s)),S=t.view.getSelectedSheets(s),C=(c.GET_USER_CONTACT,t.data.getWorkBook(r,o),t.view.getActiveState(s),new ZSClass.ParamGenerator(S,r,o,!0,!0)),v=e.JSON.stringify(C.getSheets()),g=e.JSON.stringify(C.getRanges()),E={params:["sheetList","activeCell","rangeList","iamApiMode","rid","ver","startIndex"],paramVal:[v,e.JSON.stringify(C.getActiveCell()),g,"GET",r,"",0],URL:"useraction",action:c.GET_USER_CONTACT},l=new ZSClass.AjaxRequest(r,o);l.init(E,{async:!1}),l.addEventListener("onComplete",function(e){var s=JSON.parse(e.response);s&&(t.data.isRecastAction=s.isRecastAction),t.data.UserInfo.USER_CONTACT=s.USER_CONTACT,R.openDialog()}),l.addEventListener("onError",function(e){var t=JSON.parse(e.response);n.publish(i.Listener,a.ERROR.SHOW,{ERRORMSG:t.mk})}),l.sendRequest()}}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=(s.topic,s.Groups,s.Names,e.ZSDevTools.Logger,e.ZSConstants),o=t.SML.Client,a=e.ZSClass,i=(o.Utility.WorkerRequest,n.ActionConstants),r=n.CommandConstants,C=(n.URI,t.data.UserInfo),l=e.ZSConstants.FeatureConstants,c=t.view.Toolbar.Feature[l.COPY];e.UserAction.CopyToClipAction=function(s,n,o,l,S,p,u){var g=t.data.getWorkBook(s,o).getSheetObj(n[0]).Prop.Name,d=new e.ZSClass.ParamGenerator(n,s,o),v=d.getSheets(),R=d.getRanges(),y=d.getActiveCell(),A=(C.activeInfo.getCopyState(),e.JSON.stringify(R)),f={params:["sheetList","activeCell","rangeList","isSolidCopy","isRequiredTabSeparatedValues","rid","ver","currSheetName"],paramVal:[e.JSON.stringify(v),e.JSON.stringify(y),A,S,p,s,"",g],URL:"useraction",action:i.SERVERCLIP_COPY_RANGE},m=new a.AjaxRequest(s,o);m.init(f,{async:!1}),m.addEventListener("onComplete",function(t){var s=JSON.parse(t.responseText)[r.COPY_TO_CLIP][r.DATA];p&&c.openDialog(s),s&&e.UserAction.CopyResponseHandling(s)}),m.addEventListener("onError",function(e){}),m.sendRequest(),e.UserAction.Copy(s,n,o,void 0,!0,!0)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,a=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,i=e.ZSConstants,R=e.JSUtil,S=i.I18N,l=(e.ZSDevTools.Logger,t.SML.Client.Utility.WorkerRequest),c=i.ActionConstants,d=(a=e.ZSClass).ActionObject,C=i.URI,E=t.data.Defaults,g=E.MAX_ROW,u=E.MAX_COL,v=a.SelectorHelper.Constants,I=t.data.UserInfo;e.ZSConstants.CommandConstants;function f(n,i,E,f,T){var p=t.data.getWorkBook(n,E),A=t.view.getActiveGridID(),P=t.view.getActiveState(A),_=P.getFormatPainterRange(),L=I.activeInfo.getCopyState(),h=P.getFormatPainterState(),m=h?_:I.activeInfo.getCopyDetails();if(0!=Object.keys(m).length){var D=m.Sheets,w=new a.ParamGenerator(D,n,E,!0,!0),N=w.getSheets(),U=w.getCustomRanges(m.Ranges,!0),M=new a.ParamGenerator(i,n,E,!0,!0),H=M.getSheets(),W=M.getRanges(),y=M.getActiveCell();if(!O(U,y)){var Y=W[R.fn.getIndexOf(y.s,H)];if(h||s.publish(o.Selector.BoundUpdate.Copy,r.Selection.BOUND_UPDATE.HIDE,{RID:n,SHEETID:y.s,VERSION:E,VisualCueStatus:v.CUESTATUS.HIDDEN}),m.Ranges.length>1&&W[0].length>1||0===L&&W[0].length>1||m.Ranges[0].startRow!==m.Ranges[0].endRow&&W[0].length>1||m.Ranges[0].startCol!==m.Ranges[0].endCol&&W[0].length>1){var G=S["action.not.support.multiselection"];new e.ZSClass.TBNotification(G,{type:"error"}).show()}else{var b=!(-1==m.Sheets.indexOf(y.s)),F=(b&&function(e,t){for(var n=t.Sheets,a=t.Ranges,s=0,o=0;o<n.length;o++){var r=a[o],i=n[o],R=e.getSheetObj(i);R&&R.DataFilters.isIntersecting(r)&&(s=R.Row.Filter.getOnCount(r.startRow,r.endRow))}}(p,m),W);h&&(f=void 0),h&&(T=void 0);var k=L?c.COPY_PASTE:h?c.PASTESPECIAL_FORMATS:c.CUT_PASTE,B=!h&&(!!I.activeInfo.isClipped()&&I.activeInfo.isClipped()),V=0==Y[0].startRow&&Y[0].endRow==g-1?1:0==Y[0].startCol&&Y[0].endCol==u-1?2:0,q={RID:n,RS_ID:t.data.PageRegistry.RS_ID,srcSheetList:N,sheetList:H,rangeList:F,activeCell:y,isSameSheet:b,srcRangeList:U,pasteType:f,isTranspose:T,VERSION:E,isServerClip:B,type:V,isFormatPainter:h,action:B?c.SERVERCLIP_PASTE_RANGE:k};if(t.data.UserInfo.activeInfo.getCopyDetails()&&t.data.UserInfo.activeInfo.getCopyDetails().Ranges){var Z=t.data.UserInfo.activeInfo.getCopyDetails().Ranges[0];if(Z){var x=Z.endRow-Z.startRow+1,X=(Z.endCol,Z.startCol,W[0][0]),K=new a.Range(X.startRow,X.startCol,x+X.endRow-1,x+X.endCol-1);if(b&&Z.intersects(K)&&T)return void s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:"CopyPaste.TransposeIntersect"})}}var j=new d(k,q),J=new l(!0);J.addEventListeners("onComplete",function(e){j.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(j)}),J.addEventListeners("askConfirm",function(e){var t=new a.ZSConfirm(S[e.mk]);t.onYES(function(){J.resend()});var n=t.execute();s.publish(o.Listener,r.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),J.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})});var z=L?"COPY_PASTE":h?"COPY_PASTE":"CUT_PASTE";J.open(C[z]),J.send(q),h&&m.isSingleTap&&s.publish(o.Selector.BoundUpdate.FormatPainter,r.Selection.BOUND_UPDATE.REMOVE,{RID:n,SHEETID:y.s,VERSION:E})}}}}function O(e,n){for(var a=0,i=0,R=0;R<e.length;R++)for(var S=e[R],l=0;l<S.length;l++)a+=S[l].endRow-S[l].startRow+1,i+=S[l].endCol-S[l].startCol+1;return n.r+a>t.data.Defaults.MAX_ROW?(s.publish(o.Listener,r.DocAction.BannerMsg.SHOW,{KEY:"Error.Row.Limit.Exceed.WithoutValue"}),!0):n.c+i>t.data.Defaults.MAX_COL&&(s.publish(o.Listener,r.DocAction.BannerMsg.SHOW,{KEY:"Error.Column.Limit.Exceed.WithoutValue"}),!0)}e.UserAction.PasteFromSheet=f,e.UserAction.PasteFromClipBoard=function(e,n,i,R,E){var g=new a.ParamGenerator(n,e,i,!0,!0),u=g.getSheets(),v=g.getRanges(),I=g.getActiveCell();if(E&&(v=g.getCustomRanges(E),I.r=E.startRow,I.c=E.startCol),!O(v,I)){var f={RID:e,RS_ID:t.data.PageRegistry.RS_ID,sheetList:u,activeCell:I,action:c.COPY_PASTE_CONTENT,VERSION:i,rangeList:v,val:R},T=new d(c.COPY_PASTE_CONTENT,f),p=new l(!0);p.addEventListeners("onComplete",function(e){T.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(T)}),p.addEventListeners("askConfirm",function(e){var t=new a.ZSConfirm(S[e.mk]);t.onYES(function(){p.resend()});var n=t.execute();s.publish(o.Listener,r.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),p.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(C.COPY_PASTE_CONTENT),p.send(f)}},e.UserAction.PasteSpecial=f,e.UserAction.PasteOutsideSource=function(n,i,R,S,E,g){var u=new a.ParamGenerator(i,n,R,!0,!0),v=u.getSheets(),I=u.getRanges(),f=u.getActiveCell();if(void 0!==g){var O=[];O.push(g),e.UserAction.uploadImage(n,f.s,R,O)}else{var T=!(void 0===E||!E),p=!0===T,A=(f=u.getActiveCell(),{RID:n,RS_ID:t.data.PageRegistry.RS_ID,sheetList:v,activeCell:f,VERSION:R,rangeList:I,cellContent:S,isHtmlData:T,isFormatApply:p,action:c.SYSTEMCLIP_PASTE,maxRow:t.data.Defaults.MAX_ROW,maxCol:t.data.Defaults.MAX_COL}),P=new d(c.SYSTEMCLIP_PASTE,A),_=new l(!0);_.addEventListeners("onComplete",function(e){P.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(P)}),_.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(C.SYSTEMCLIP_PASTE),_.send(A)}},e.UserAction.AddSheetAndPaste=function(e,n,s,o){var r={RID:e,sheetList:new a.ParamGenerator(n,e,s,!0,!0).getSheets(),RS_ID:t.data.PageRegistry.RS_ID,cellContent:o,VERSION:s,action:c.INSERT_SHEET_WITH_CLIP_CONTENT},i=new d(c.INSERT_SHEET_WITH_CLIP_CONTENT,r),R=new l(!0);R.addEventListeners("onComplete",function(e){i.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(i)}),R.addEventListeners("onError",function(e){}),R.open(C.INSERT_SHEET_WITH_CLIP_CONTENT),R.send(r)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=n.topic,a=n.Groups,o=n.Names,i=t.SML.Client,r=e.ZSDevTools.Logger,d=i.Utility.WorkerRequest,R=e.UserAction,S=e.ZSConstants.ActionConstants,E=e.ZSClass.ActionObject,O=e.ZSConstants.URI,c=e.ZSConstants.I18N;R.Undo=function(n,i,R){t.data.getWorkBook(n,R);var l=t.data.UserInfo.Transients.UndoRedo.getObj(n),I=new e.ZSClass.ParamGenerator(i,n,R),g=I.getSheets();if(l.isUndoPossible()){s.publish(a.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:t.view.getSheetID(t.view.getActiveGridID()),VERSION:R});var D={RID:n,sheetList:g,VERSION:R,TYPE:"UNDO"},U=new E(S.UNDO,D),N=new d;N.addEventListeners("onComplete",function(e){s.publish(a.Selector.ReDraw,o.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:n,VERSION:R,qaid:e.qaid}),U.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(U);var i=l.UndoTransientAO,r=t.data.UserInfo.Transients.UndoRedo.getObj(n).getNextNthData(1),d=I.getRanges();r.params.rangeList||(r.params.rangeList=d),i[e.qaid]=r}),N.addEventListeners("onError",function(e){s.publish(a.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(O.UNDO),N.send(D)}else r.log("NO MORE UNdo action's...!!!!"),e.ZSClass.ZSAlert(c["Skip.Action"])},R.Redo=function(n,i,r){t.data.getWorkBook(n,r);var c=t.data.UserInfo.Transients.UndoRedo.getObj(n),l=new e.ZSClass.ParamGenerator(i,n,r),I=l.getSheets();if(c.isRedoPossible()){var g={RID:n,sheetList:I,VERSION:r,TYPE:"REDO"},D=new E(S.REDO,g),U=new d;U.addEventListeners("onComplete",function(e){s.publish(a.Selector.ReDraw,o.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:n,VERSION:r,qaid:e.qaid}),D.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(D);var i=c.RedoTransientAO,d=t.data.UserInfo.Transients.UndoRedo.getObj(n).getPrevNthData(1),R=l.getRanges();d.params.rangeList||(d.params.rangeList=R),i[e.qaid]=d}),U.addEventListeners("onError",function(e){s.publish(a.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),U.open(O.REDO),U.send(g)}else R.RepeatAction&&R.RepeatAction(n,i,r)}}(this);
!function(t){var e=t.sPlusPlus,s=t.ZSConstants.ActionConstants,n=t.UserAction,o=(t.ZSDevTools.Logger,t.ZSClass),r=e.data.UserInfo;function a(t,e){this.request=t,this.actionObject=e}a.prototype={setRequest:function(t){this.request=t},setActionObject:function(t){this.actionObject=t},getRequest:function(){return this.request},getAction:function(){return this.actionObject.getAction()},getParams:function(){return this.actionObject.getParams()},getValue:function(){return this.actionObject.getValue()},isRepeatPossible:function(){return!(!this.request||!this.actionObject)}};var i=new a;function c(t){for(var s=e.data.Defaults,n=[],o=0;o<t.length;o++){var r=t[o],a=r.endRow-r.startRow+1;r.endRow==s.MAX_ROW-1&&0==r.startRow||(r.endRow=r.endRow+a,r.startRow=r.startRow+a),n.push(r)}return n}function u(t){for(var s=e.data.Defaults,n=[],o=0;o<t.length;o++){var r=t[o],a=r.endCol-r.startCol+1;r.endCol==s.MAX_COL-1&&0==r.startCol||(r.endCol=r.endCol+a,r.startCol=r.startCol+a),n.push(r)}return n}r.registerForRepeat=function(t,e){i.setRequest(t),i.setActionObject(e)},n.RepeatAction=function(t,n,r){if(i.isRepeatPossible()){e.view.getActiveGridID();var a=new o.ParamGenerator(n,t,r,!0,!0),l=a.getSheets(),f=a.getRanges(),h=a.getActiveCell(),g=i.getParams();if(g.hasOwnProperty("action"))switch(g.action){case s.INSERT_ROW:if(!g.isAbove)for(var R=0;R<f.length;R++)f[R]=c(f[R]);break;case s.INSERT_COL:if(!g.isBefore)for(R=0;R<f.length;R++)f[R]=u(f[R])}g.hasOwnProperty("sheetList")&&(g.sheetList=l),g.hasOwnProperty("rangeList")&&(g.rangeList=f),g.hasOwnProperty("activeCell")&&(g.activeCell=h),i.getRequest().send(g)}}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),c=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI,I=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.BOLD=function(e,n,R,d,l,E,A,v){d=1==d?1:0;var L=c.BOLD,g=(t.data.getWorkBook(e,R),t.view.getActiveGridID()),C=t.view.getSheetID(g),O=(t.view.getActiveState(g),new i.ParamGenerator(n,e,R,!0,!0)),u=O.getSheets(),D=O.getRanges(),T=O.getActiveCell(),f={RID:e,sheetList:u,rangeList:D,activeCell:T,action:L,VERSION:R,value:d},p=new a(L,f,d),N=D[JSUtil.fn.getIndexOf(C,u)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:C,VERSION:R});var U=new I;U.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:C,VERSION:R,ACTION:L,RANGELIST:N,VALUE:d})}),U.addEventListeners("onComplete",function(e){e.qaid,p.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(p)}),U.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),U.open(S.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(U,p),U.send(f)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),I=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI,S=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.ITALIC=function(e,n,R,d,l,A,E,C){d=1==d?1:0;var v=I.ITALIC,L=(t.data.getWorkBook(e,R),t.view.getActiveGridID()),g=t.view.getSheetID(L),u=(t.view.getActiveState(L),new i.ParamGenerator(n,e,R,!0,!0)),O=u.getSheets(),T=u.getRanges(),D=u.getActiveCell(),f={RID:e,sheetList:O,rangeList:T,activeCell:D,action:v,VERSION:R,value:d},p=new a(v,f,d),N=T[JSUtil.fn.getIndexOf(g,O)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:g,VERSION:R});var U=new S;U.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:g,VERSION:R,ACTION:v,RANGELIST:N,VALUE:d})}),U.addEventListeners("onComplete",function(e){e.qaid,p.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(p)}),U.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),U.open(c.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(U,p),U.send(f)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),c=e.ZSConstants.ActionConstants,E=e.ZSConstants.URI,I=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.UNDERLINE=function(e,n,R,S,d,l,A,v){S=1==S?1:0;var L=c.UNDERLINE,g=(t.data.getWorkBook(e,R),t.view.getActiveGridID()),C=t.view.getSheetID(g),u=(t.view.getActiveState(g),new i.ParamGenerator(n,e,R,!0,!0)),O=u.getSheets(),D=u.getRanges(),N=u.getActiveCell(),T={RID:e,sheetList:O,rangeList:D,activeCell:N,action:L,VERSION:R,value:S},U=new a(L,T,S),f=D[JSUtil.fn.getIndexOf(C,O)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:C,VERSION:R});var p=new I;p.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:C,VERSION:R,ACTION:L,RANGELIST:f,VALUE:S})}),p.addEventListeners("onComplete",function(e){e.qaid,U.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(U)}),p.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(E.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(p,U),p.send(T)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),R=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI,c=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.STRIKETHROUGH=function(e,n,I,E,d,l,A,v){E=1==E?1:0;var g=R.STRIKETHROUGH,C=(t.data.getWorkBook(e,I),t.view.getActiveGridID()),O=t.view.getSheetID(C),T=(t.view.getActiveState(C),new i.ParamGenerator(n,e,I,!0,!0)),u=T.getSheets(),L=T.getRanges(),D=T.getActiveCell(),U={RID:e,sheetList:u,rangeList:L,activeCell:D,action:g,VERSION:I,value:E},f=new a(g,U,E),G=L[JSUtil.fn.getIndexOf(O,u)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:O,VERSION:I});var p=new c;p.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:O,VERSION:I,ACTION:g,RANGELIST:G,VALUE:E})}),p.addEventListeners("onComplete",function(e){e.qaid,f.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(f)}),p.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(S.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(p,f),p.send(U)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=e.ZSDevTools.Logger,c=e.ZSClass.ActionObject,l=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI,S=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.COLOR=function(e,n,d,I,E,A,v,C){if(I){var O=l.COLOR,g=(t.data.getWorkBook(e,d),t.view.getActiveGridID()),L=t.view.getSheetID(g),u=(t.view.getActiveState(g),new i.ParamGenerator(n,e,d,!0,!0)),f=u.getSheets(),T=u.getRanges(),D=u.getActiveCell(),p={RID:e,sheetList:f,rangeList:T,activeCell:D,action:O,VERSION:d,value:I},N=new c(O,p,I),U=T[JSUtil.fn.getIndexOf(L,f)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:L,VERSION:d});var h=new S(!0);h.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:L,VERSION:d,ACTION:O,RANGELIST:U,VALUE:I})}),h.addEventListeners("onComplete",function(e){e.qaid,N.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(N)}),h.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(R.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(h,N),h.send(p)}else a.log("value is not defined",I,O)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=e.ZSDevTools.Logger,c=e.ZSClass.ActionObject,l=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI,S=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.TEXTCOLOR=function(e,n,d,E,I,A,v,C){if(E){var O=l.TEXTCOLOR,g=(t.data.getWorkBook(e,d),t.view.getActiveGridID()),L=t.view.getSheetID(g),u=(t.view.getActiveState(g),new i.ParamGenerator(n,e,d,!0,!0)),T=u.getSheets(),f=u.getRanges(),D=u.getActiveCell(),p={RID:e,sheetList:T,rangeList:f,activeCell:D,action:O,VERSION:d,value:E},N=new c(O,p,E),U=f[JSUtil.fn.getIndexOf(L,T)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:L,VERSION:d});var h=new S(!0);h.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:L,VERSION:d,ACTION:O,RANGELIST:U,VALUE:E})}),h.addEventListeners("onComplete",function(e){e.qaid,N.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(N)}),h.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(R.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(h,N),h.send(p)}else a.log("value is not defined",E,O)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),c=e.ZSConstants.ActionConstants,I=e.ZSConstants.URI,S=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.HALIGN=function(e,n,R,d,l,A,E,v){d||(d="center");var L=c.HALIGN,g=(t.data.getWorkBook(e,R),t.view.getActiveGridID()),C=t.view.getSheetID(g),u=(t.view.getActiveState(g),new i.ParamGenerator(n,e,R,!0,!0)),O=u.getSheets(),T=u.getRanges(),D=u.getActiveCell(),N={RID:e,sheetList:O,rangeList:T,activeCell:D,action:L,VERSION:R,value:d},f=new a(L,N,d),G=T[JSUtil.fn.getIndexOf(C,O)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:C,VERSION:R});var p=new S;p.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:C,VERSION:R,ACTION:L,RANGELIST:G,VALUE:d})}),p.addEventListeners("onComplete",function(e){e.qaid,f.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(f)}),p.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(I.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(p,f),p.send(N)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),c=e.ZSConstants.ActionConstants,I=e.ZSConstants.URI,S=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.VALIGN=function(e,n,R,d,l,A,E,v){d||(d="vcenter");var L=c.VALIGN,g=(t.data.getWorkBook(e,R),t.view.getActiveGridID()),C=t.view.getSheetID(g),u=(t.view.getActiveState(g),new i.ParamGenerator(n,e,R,!0,!0)),O=u.getSheets(),T=u.getRanges(),D=u.getActiveCell(),N={RID:e,sheetList:O,rangeList:T,activeCell:D,action:L,VERSION:R,value:d},f=new a(L,N,d),G=T[JSUtil.fn.getIndexOf(C,O)];s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:C,VERSION:R});var p=new S;p.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:C,VERSION:R,ACTION:L,RANGELIST:G,VALUE:d})}),p.addEventListeners("onComplete",function(e){e.qaid,f.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(f)}),p.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(I.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(p,f),p.send(N)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),S=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI,R=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.BORDER=function(e,n,d,l,E,I,A,v,g){l=l||17;var C=S.BORDERS,O=(t.data.getWorkBook(e,d),t.view.getActiveGridID()),u=t.view.getSheetID(O),L=(t.view.getActiveState(O),new i.ParamGenerator(n,e,d,!0,!0)),D=L.getSheets(),T=L.getRanges(),f=L.getActiveCell(),p={RID:e,sheetList:D,rangeList:T,activeCell:f,action:C,VERSION:d,value:l,borderStyle:E},N=new a(C,p,l),U=T[JSUtil.fn.getIndexOf(u,D)],h={action:C,borderStyle:E};s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:u,VERSION:d});var w=new R;w.addEventListeners("onAcknowledge",function(){s.publish(o.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:u,VERSION:d,ACTION:h,RANGELIST:U,VALUE:l})}),w.addEventListeners("onComplete",function(e){e.qaid,N.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(N)}),w.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),w.open(c.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(w,N),w.send(p)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,a=s.Groups,i=s.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSClass.ActionObject,l=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI;e.UserAction.FORMAT_DATE=function(s,R,C,E,L,O){var S=l.FORMAT_DATE,A=new e.ZSClass.ParamGenerator(R,s,C,!0),M=A.getSheets(),T=A.getRanges(),f=A.getActiveCell(),m={action:S,sheetList:M,rangeList:T,activeCell:f,RID:s,VERSION:C,formatType:E,formatString:L,formatCellsParam:O},u=new o(S,m),d=new r;d.addEventListeners("onComplete",function(e){if(S===l.FORMATCELLS_CLIENT){var s=e.format?e.format:{};n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT,{FORMAT:s}),e.format||JSUtil.Object.isEmpty(e)||n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else e.qaid,u.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(u)}),d.addEventListeners("onError",function(e){n.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(c.NUMBER_FORMAT_MODIFY),d.send(m)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,a=s.Groups,i=s.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSClass.ActionObject,l=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI;e.UserAction.FORMAT_CURRENCY=function(s,C,c,E,L,O){var S=l.FORMAT_CURRENCY,M=new e.ZSClass.ParamGenerator(C,s,c,!0),A=M.getSheets(),T=M.getRanges(),f=M.getActiveCell(),m={action:S,sheetList:A,rangeList:T,activeCell:f,RID:s,VERSION:c,formatType:E,formatString:L,formatCellsParam:O},u=new o(S,m),d=new r;d.addEventListeners("onComplete",function(e){if(S===l.FORMATCELLS_CLIENT){var s=e.format?e.format:{};n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT,{FORMAT:s}),e.format||JSUtil.Object.isEmpty(e)||n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else e.qaid,u.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(u)}),d.addEventListeners("onError",function(e){n.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(R.NUMBER_FORMAT_MODIFY),d.send(m)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,a=s.Groups,i=s.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSClass.ActionObject,l=e.ZSConstants.ActionConstants,C=e.ZSConstants.URI;e.UserAction.FORMAT_ACCOUNTING=function(s,c,R,O,L,S){var A=l.FORMAT_ACCOUNTING,E=new e.ZSClass.ParamGenerator(c,s,R,!0),M=E.getSheets(),T=E.getRanges(),f=E.getActiveCell(),m={action:A,sheetList:M,rangeList:T,activeCell:f,RID:s,VERSION:R,formatType:O,formatString:L,formatCellsParam:S},u=new o(A,m),d=new r;d.addEventListeners("onComplete",function(e){if(A===l.FORMATCELLS_CLIENT){var s=e.format?e.format:{};n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT,{FORMAT:s}),e.format||JSUtil.Object.isEmpty(e)||n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else e.qaid,u.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(u)}),d.addEventListeners("onError",function(e){n.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(C.NUMBER_FORMAT_MODIFY),d.send(m)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,a=s.Groups,i=s.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSClass.ActionObject,R=e.ZSConstants.ActionConstants,l=e.ZSConstants.URI;e.UserAction.FORMAT_PERCENT=function(s,C,c,E,L,O){var S;S="STANDARD"==E?R.FORMAT_CURRENCY:R.FORMAT_PERCENT;var T=new e.ZSClass.ParamGenerator(C,s,c),A=T.getSheets(),M=T.getRanges(),f=T.getActiveCell(),m={action:S,sheetList:A,rangeList:M,activeCell:f,RID:s,VERSION:c,formatType:E,formatString:L,formatCellsParam:O},u=new o(S,m),d=new r;d.addEventListeners("onComplete",function(e){if(S===R.FORMATCELLS_CLIENT){var s=e.format?e.format:{};n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT,{FORMAT:s}),e.format||JSUtil.Object.isEmpty(e)||n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else e.qaid,u.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(u)}),d.addEventListeners("onError",function(e){n.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(l.NUMBER_FORMAT_MODIFY),d.send(m)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,a=s.Groups,i=s.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSClass.ActionObject,l=e.ZSConstants.ActionConstants,C=e.ZSConstants.URI;e.UserAction.FORMAT_INCREMENT_DECIMAL=function(s,R,c,E,L,M){var O=l.FORMAT_INCREMENT_DECIMAL,S=new e.ZSClass.ParamGenerator(R,s,c,!0),A=S.getSheets(),T=S.getRanges(),f=S.getActiveCell(),m={action:O,sheetList:A,rangeList:T,activeCell:f,RID:s,VERSION:c,formatType:E,formatString:L,formatCellsParam:M},u=new o(O,m),I=new r;I.addEventListeners("onComplete",function(e){if(O===l.FORMATCELLS_CLIENT){var s=e.format?e.format:{};n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT,{FORMAT:s}),e.format||JSUtil.Object.isEmpty(e)||n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else e.qaid,u.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(u)}),I.addEventListeners("onError",function(e){n.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),I.open(C.NUMBER_FORMAT_MODIFY),I.send(m)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,a=s.Groups,i=s.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSClass.ActionObject,l=e.ZSConstants.ActionConstants,C=e.ZSConstants.URI;e.UserAction.FORMAT_DECREMENT_DECIMAL=function(s,E,R,c,L,M){var O=l.FORMAT_DECREMENT_DECIMAL,S=new e.ZSClass.ParamGenerator(E,s,R,!0),A=S.getSheets(),T=S.getRanges(),f=S.getActiveCell(),m={action:O,sheetList:A,rangeList:T,activeCell:f,RID:s,VERSION:R,formatType:c,formatString:L,formatCellsParam:M},u=new o(O,m),d=new r;d.addEventListeners("onComplete",function(e){if(O===l.FORMATCELLS_CLIENT){var s=e.format?e.format:{};n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT,{FORMAT:s}),e.format||JSUtil.Object.isEmpty(e)||n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else e.qaid,u.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(u)}),d.addEventListeners("onError",function(e){n.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(C.NUMBER_FORMAT_MODIFY),d.send(m)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,o=n.Groups,r=n.Names,a=t.SML.Client,R=e.ZSConstants,E=R.FeatureConstants,l=a.Utility.WorkerRequest,c=e.ZSClass.ActionObject,L=e.ZSConstants.ActionConstants,d=e.ZSConstants.URI;function S(e,t,n){var a=new i.ParamGenerator(t,e,n,!1),R=a.getSheets(),E=a.getRanges(),c=a.getActiveCell(),L={RID:e,sheetList:R,VERSION:n,activeCell:c,rangeList:E},S=new l;S.addEventListeners("onComplete",function(t){s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:a.getActiveSheet(),VERSION:n})}),S.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),S.open(d.FILTER_REMOVE,"sheetaction"),S.send(L)}function A(e,n,a,R,E,S,A,I,C,g,v,O){var u=new i.ParamGenerator(n,e,a,!1),h=u.getSheets(),f=u.getCustomRanges(R),T=u.getActiveCell(),p={RID:e,sheetList:h,index:E,VERSION:a,activeCell:T,rangeList:f};void 0!=O&&isNaN(O)&&(O=L.SPECIAL_CRITERIA),(v&&v.length>0||g&&g.length>0||O||A&&A.length>0||I&&I.length>0||C||S)&&(p.fc2=v,p.fv2=g,p.filtertype=O,p.fv1=A,p.fc1=I,p.fo=C,p.dt=S);var F=new c(L.APPLY_FILTER,p),D=new l;D.addEventListeners("onComplete",function(n){s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:u.getActiveSheet(),VERSION:a}),F.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(F)}),D.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(d.APPLYFILTER),D.send(p)}function I(e,n,a,R,E,L){t.data.getWorkBook(e,a);var S=new i.ParamGenerator(n,e,a,!1),A=S.getSheets(),I=S.getRanges(),C=S.getActiveCell(),g={RID:e,sheetList:A,rangeList:I,VERSION:a,activeCell:C,constant:R},v=new c(R,g),O=new l;O.addEventListeners("onComplete",function(n){s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:S.getActiveSheet(),VERSION:a}),v.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(v)}),O.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(d.FILTERBYVALUE),O.send(g)}-1!=R.Meta.HideFeaturesList.indexOf(E.USER_LEVEL_FILTER)&&(e.UserAction.RemoveFilter=S,e.UserAction.AddFilter=function(e,n,a){var R=new i.ParamGenerator(n,e,a),E=R.getSheets(),A=R.getRanges(),I=R.getActiveCell(),C={RID:e,sheetList:E,VERSION:a,activeCell:I,rangeList:A};if(t.data.getWorkBook(e,a).getSheetObj(R.getActiveSheet()).DataFilters.isRangesAvailable())S(e,n,a);else{var g=new c(L.CREATE_FILTER,C),v=new l;v.addEventListeners("onComplete",function(n){s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:R.getActiveSheet(),VERSION:a}),g.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(g)}),v.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(d.CREATE_FILTER),v.send(C)}},e.UserAction.ApplyFilter=A,e.UserAction.ReApplyFilter=function(e,n,a,R){var E=new i.ParamGenerator(n,e,a,!1),c=t.data.getWorkBook(e,a).getSheetObj(E.getActiveSheet()).DataFilters.getAllRanges();for(var L in c){var S=c[L];R=new i.Range(S.startRow,S.startCol,S.endRow,S.endCol)}var A=E.getSheets(),I=E.getCustomRanges(R),C=E.getActiveCell(),g={RID:e,sheetList:A,VERSION:a,activeCell:C,rangeList:I},v=new l;v.addEventListeners("onComplete",function(t){s.publish(o.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:E.getActiveSheet(),VERSION:a})}),v.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(d.FILTER_REAPPLY),v.send(g)},e.UserAction.ClearFilter=function(e,t,n,i,s){A(e,t,n,i,s,"","","","","","",L.APPLY_FILTER_ALL)},e.UserAction.FilterByCellValue=function(e,t,n,i,s){I(e,t,n,L.FILTER_BY_VALUE)},e.UserAction.FilterByCellColor=function(e,t,n,i,s){I(e,t,n,L.FILTER_BY_CELL_COLOR)},e.UserAction.FilterByTextColor=function(e,t,n,i,s){I(e,t,n,L.FILTER_BY_FONT_COLOR)},e.UserAction.GetFilterInfo=function(e,n,a,R,E,c,L,S){t.data.getWorkBook(e,a);var A=new i.ParamGenerator(n,e,a,!1,!1),I=A.getSheets(),C=A.getActiveSheet(),g={RID:e,filterCol:E,sheetList:I,filterRange:R,VERSION:a,index:c,isDataNeed:L=void 0==L||L},v=new l;v.addEventListeners("onComplete",function(t){var n={RID:e,SHEETID:C,VERSION:a,RANGE:R,INDEX:c,data:t};!L&&(n.clientData=S),s.publish(o.UserAction,r.SheetAction.DATAFILTER.FILTER_INFO,n)}),v.addEventListeners("onError",function(e){s.publish(o.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(d.GETFILTERINFO),v.send(g)})}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,o=e.ZSConstants,E=o.FeatureConstants,r=n.topic,s=n.Groups,R=n.Names,a=t.SML.Client.Utility.WorkerRequest,c=e.ZSClass.ActionObject,I=e.ZSConstants.ActionConstants,l=e.ZSConstants.URI,A=e.ZSConstants.I18N;function L(e,t,n){var o=new i.ParamGenerator(t,e,n,!1),E=o.getSheets(),c=o.getRanges(),I=o.getActiveCell(),A={RID:e,sheetList:E,VERSION:n,activeCell:I,rangeList:c},L=new a;L.addEventListeners("onComplete",function(t){r.publish(s.UserAction,R.SheetAction.DATAFILTER.ONDELETE_NAMED_FILTER,{RID:e,SHEETID:o.getActiveSheet(),VERSION:n}),r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:o.getActiveSheet(),VERSION:n})}),L.addEventListeners("onError",function(e){r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),L.open(l.FILTER_REMOVE,"sheetaction"),L.send(A)}function S(e,n,o,E,A,L,S,d,T,g,D,O){var _=new i.ParamGenerator(n,e,o,!1),u=_.getSheets(),v=_.getCustomRanges(E),h=_.getActiveCell(),C={RID:e,sheetList:u,index:A,VERSION:o,activeCell:h,rangeList:v};void 0!=O&&isNaN(O)&&(O=I.SPECIAL_CRITERIA),(D&&D.length>0||g&&g.length>0||O||S&&S.length>0||d&&d.length>0||T||L)&&(C.fc2=D,C.fv2=g,C.filtertype=O,C.fv1=S,C.fc1=d,C.fo=T,C.dt=L);var F=new c(I.APPLY_FILTER,C),p=new a;p.addEventListeners("onComplete",function(n){r.publish(s.UserAction,R.SheetAction.DATAFILTER.ONCLEAR_FILTER,{RID:e,SHEETID:_.getActiveSheet(),VERSION:o}),r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:_.getActiveSheet(),VERSION:o}),F.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(F)}),p.addEventListeners("onError",function(e){r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(l.APPLYFILTER),p.send(C)}function d(e,n,o,E,I,A){t.data.getWorkBook(e,o);var L=new i.ParamGenerator(n,e,o,!1),S=L.getSheets(),d=L.getRanges(),T=L.getActiveCell(),g={RID:e,sheetList:S,rangeList:d,VERSION:o,activeCell:T,constant:E},D=new c(E,g),O=new a;O.addEventListeners("onComplete",function(n){r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:L.getActiveSheet(),VERSION:o}),D.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(D)}),O.addEventListeners("onError",function(e){r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(l.FILTERBYVALUE),O.send(g)}function T(e,t,n){var o,E=document.createElement("span"),r=n?"success":"warning";switch(e){case I.SET_DEFAULT_FILTER:o=n?void 0!=t?A["Filter.Default.Set.SuccessMessage"]:A["Filter.Current.Default.Set.SuccessMessage"]:A["Filter.Default.Set.ErrorMessage"];break;case I.APPLY_DEFAULT_FILTER:o=n?A["Filter.Default.Apply.SuccessMessage"]:A["Filter.Default.Apply.ErrorMessage"];break;case I.MAP_FILTER_VIEW:o=n?A["Filter.Apply.SuccessMessage"]:A["Filter.Apply.ErrorMessage"];break;case I.SAVE_FILTER_VIEW:o=n?A["Filter.Create.SuccessMessage"]:A["Filter.Create.ErrorMessage"];break;case I.DELETE_FILTER_VIEW:o=n?A["Filter.Delete.SuccessMessage"]:A["Filter.Delete.ErrorMessage"],r=n?"info":r}var s=void 0!=t?JSUtil.fn.replaceParams(o,t):o;E.innerHTML=s,new i.TBNotification(E,{type:r,isHtml:!0}).show()}-1==o.Meta.HideFeaturesList.indexOf(E.USER_LEVEL_FILTER)&&(e.UserAction.RemoveFilter=L,e.UserAction.AddFilter=function(e,n,o){var E=new i.ParamGenerator(n,e,o),A=E.getSheets(),S=E.getRanges(),d=E.getActiveCell(),T={RID:e,sheetList:A,VERSION:o,activeCell:d,rangeList:S};if(t.data.getWorkBook(e,o).getSheetObj(E.getActiveSheet()).DataFilters.isRangesAvailable())L(e,n,o);else{var g=new c(I.CREATE_FILTER,T),D=new a;D.addEventListeners("onComplete",function(n){r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:E.getActiveSheet(),VERSION:o}),g.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(g)}),D.addEventListeners("onError",function(e){r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(l.CREATE_FILTER),D.send(T)}},e.UserAction.ApplyFilter=S,e.UserAction.ReApplyFilter=function(e,n,o,E){var c=new i.ParamGenerator(n,e,o,!1),I=t.data.getWorkBook(e,o).getSheetObj(c.getActiveSheet()).DataFilters.getAllRanges();for(var A in I){var L=I[A];E=new i.Range(L.startRow,L.startCol,L.endRow,L.endCol)}var S=c.getSheets(),d=c.getCustomRanges(E),T=c.getActiveCell(),g={RID:e,sheetList:S,VERSION:o,activeCell:T,rangeList:d},D=new a;D.addEventListeners("onComplete",function(t){r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:c.getActiveSheet(),VERSION:o})}),D.addEventListeners("onError",function(e){r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(l.FILTER_REAPPLY),D.send(g)},e.UserAction.ClearFilter=function(e,t,n,i,o){S(e,t,n,i,o,"","","","","","",I.APPLY_FILTER_ALL)},e.UserAction.FilterByCellValue=function(e,t,n,i,o){d(e,t,n,I.FILTER_BY_VALUE)},e.UserAction.FilterByCellColor=function(e,t,n,i,o){d(e,t,n,I.FILTER_BY_CELL_COLOR)},e.UserAction.FilterByTextColor=function(e,t,n,i,o){d(e,t,n,I.FILTER_BY_FONT_COLOR)},e.UserAction.GetFilterInfo=function(e,n,o,E,c,I,A,L){t.data.getWorkBook(e,o);var S=new i.ParamGenerator(n,e,o,!1,!1),d=S.getSheets(),T=S.getActiveSheet(),g={RID:e,filterCol:c,sheetList:d,filterRange:E,VERSION:o,index:I,isDataNeed:A=void 0==A||A},D=new a;D.addEventListeners("onComplete",function(t){var n={RID:e,SHEETID:T,VERSION:o,RANGE:E,INDEX:I,data:t};!A&&(n.clientData=L),r.publish(s.UserAction,R.SheetAction.DATAFILTER.FILTER_INFO,n)}),D.addEventListeners("onError",function(e){r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(l.GETFILTERINFO),D.send(g)},e.UserAction.SetAsDefaultFilter=function(e,n,o,E){t.data.getWorkBook(e,o);var A=I.SET_DEFAULT_FILTER,L=new i.ParamGenerator(n,e,o,!1),S=L.getSheets(),d=L.getRanges(),g=L.getActiveCell(),D={RID:e,sheetList:S,rangeList:d,VERSION:o,activeCell:g,filterName:E,constant:A},O=new c(A,D),_=new a;_.addEventListeners("onComplete",function(n){T(A,void 0,!0),r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:L.getActiveSheet(),VERSION:o}),O.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(O)}),_.addEventListeners("onError",function(e){T(A,void 0,!1),r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(l.SET_DEFAULT_FILTER),_.send(D)},e.UserAction.ApplyDefaultFilter=function(e,n,o,E,A){t.data.getWorkBook(e,o);var L=I.APPLY_DEFAULT_FILTER_VIEW,S=new i.ParamGenerator(n,e,o,!1),d=S.getSheets(),g=S.getRanges(),D=S.getActiveCell(),O={RID:e,sheetList:d,rangeList:g,VERSION:o,activeCell:D,constant:L},_=new c(L,O),u=new a;u.addEventListeners("onComplete",function(n){T(L,void 0,!0),r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:S.getActiveSheet(),VERSION:o}),_.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(_)}),u.addEventListeners("onError",function(e){T(L,void 0,!1),r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(l.APPLY_DEFAULT_FILTER_VIEW),u.send(O)},e.UserAction.RemoveDefaultFilter=function(e,n,o,E,A){t.data.getWorkBook(e,o);var L=new i.ParamGenerator(n,e,o,!1),S=L.getSheets(),d=L.getRanges(),T=L.getActiveCell(),g={RID:e,sheetList:S,rangeList:d,VERSION:o,activeCell:T,constant:I.REMOVE_DEFAULT_FILTER},D=new c(I.REMOVE_DEFAULT_FILTER,g),O=new a;O.addEventListeners("onComplete",function(n){r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:L.getActiveSheet(),VERSION:o}),D.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(D)}),O.addEventListeners("onError",function(e){r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(l.REMOVE_DEFAULT_FILTER),O.send(g)},e.UserAction.GetFilterViews=function(e,n,o,E,c){t.data.getWorkBook(e,o);var I=new i.ParamGenerator(n,e,o,!1,!1),A=I.getSheets(),L=(I.getActiveSheet(),{RID:e,sheetList:A,VERSION:o}),S=new a;S.addEventListeners("onComplete",E),S.addEventListeners("onError",function(e){r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),S.open(l.GET_FILTER_VIEWS),S.send(L)},e.UserAction.MapFilterView=function(e,n,o,E){t.data.getWorkBook(e,o);var A=I.MAP_FILTER_VIEW,L=new i.ParamGenerator(n,e,o,!1,!1),S=L.getSheets(),d=(L.getActiveSheet(),L.getActiveCell()),g={RID:e,sheetList:S,VERSION:o,constant:A,activeCell:d,filterName:E},D=new a,O=new c(A,g);D.addEventListeners("onComplete",function(n){T(A,[decodeURIComponent(E)],!0),r.publish(s.UserAction,R.SheetAction.DATAFILTER.ONAPPLY_NAMED_FILTER,{RID:e,SHEETID:L.getActiveSheet(),VERSION:o,APPLIED_FILTER_NAME:E}),r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:L.getActiveSheet(),VERSION:o}),t.data.UserInfo.ActionRecorder.record(O)}),D.addEventListeners("onError",function(t){T(A,[decodeURIComponent(E)],!1),r.publish(s.UserAction,R.SheetAction.DATAFILTER.ONAPPLY_NAMED_FILTER,{RID:e,SHEETID:sheetID,VERSION:o,APPLIED_FILTER_NAME:void 0}),r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:t.mk})}),D.open(l.MAP_FILTER_VIEW),D.send(g)},e.UserAction.SaveFilterView=function(e,n,o,E,A){t.data.getWorkBook(e,o);var L=I.SAVE_FILTER_VIEW,S=new i.ParamGenerator(n,e,o,!1,!1),d=S.getSheets(),g=(S.getActiveSheet(),{RID:e,sheetList:d,VERSION:o,constant:L,filterName:E}),D=new a,O=new c(L,g);D.addEventListeners("onComplete",function(n){T(L,[decodeURIComponent(E)],!0),"function"==typeof A&&A(),r.publish(s.UserAction,R.SheetAction.DATAFILTER.ONAPPLY_NAMED_FILTER,{RID:e,SHEETID:S.getActiveSheet(),VERSION:o,APPLIED_FILTER_NAME:E}),r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:S.getActiveSheet(),VERSION:o}),t.data.UserInfo.ActionRecorder.record(O)}),D.addEventListeners("onError",function(e){T(L,[decodeURIComponent(E)],!1),r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(l.SAVE_FILTER_VIEW),D.send(g)},e.UserAction.RenameFilterView=function(e,n,o,E,A,L){t.data.getWorkBook(e,o);var S=I.RENAME_FILTER_VIEW,d=new i.ParamGenerator(n,e,o,!1,!1),T=d.getSheets(),g=(d.getActiveSheet(),{RID:e,sheetList:T,VERSION:o,constant:S,oldName:E,newName:A,isDefault:L}),D=new a,O=new c(S,g);D.addEventListeners("onComplete",function(n){r.publish(s.UserAction,R.SheetAction.DATAFILTER.ONRENAME_NAMED_FILTER,{RID:e,SHEETID:d.getActiveSheet(),VERSION:o,OLD_FILTER_NAME:E,NEW_FILTER_NAME:A}),r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:d.getActiveSheet(),VERSION:o}),t.data.UserInfo.ActionRecorder.record(O)}),D.addEventListeners("onError",function(e){r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(l.RENAME_FILTER_VIEW),D.send(g)},e.UserAction.DeleteFilterView=function(e,n,o,E,A){t.data.getWorkBook(e,o);var L=I.DELETE_FILTER_VIEW,S=new i.ParamGenerator(n,e,o,!1,!1),d=S.getSheets(),g=(S.getActiveSheet(),{RID:e,sheetList:d,VERSION:o,constant:L,filterName:E,isDefault:A}),D=new a,O=new c(L,g);D.addEventListeners("onComplete",function(n){T(L,[decodeURIComponent(E)],!0),r.publish(s.UserAction,R.SheetAction.DATAFILTER.ONDELETE_NAMED_FILTER,{RID:e,SHEETID:S.getActiveSheet(),VERSION:o,FILTER_NAME:E}),r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:S.getActiveSheet(),VERSION:o}),t.data.UserInfo.ActionRecorder.record(O)}),D.addEventListeners("onError",function(e){T(L,[decodeURIComponent(E)],!1),r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(l.DELETE_FILTER_VIEW),D.send(g)},e.UserAction.UpdateFilterView=function(e,n,o,E){t.data.getWorkBook(e,o);var A=I.UPDATE_FILTER_VIEW,L=new i.ParamGenerator(n,e,o,!1,!1),S=L.getSheets(),d=(L.getActiveSheet(),{RID:e,sheetList:S,VERSION:o,constant:A,filterName:E}),T=new a,g=new c(A,d);T.addEventListeners("onComplete",function(n){r.publish(s.Listener,R.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:L.getActiveSheet(),VERSION:o}),t.data.UserInfo.ActionRecorder.record(g)}),T.addEventListeners("onError",function(e){r.publish(s.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),T.open(l.DELETE_FILTER_VIEW),T.send(d)})}(this);
!function(e){e.module;var t=e.sPlusPlus,n=t.SML.Client.Utility.WorkerRequest,s=e.ZSConstants.URI,a=e.ZSConstants.ActionConstants,r=t.view.Toolbar.Feature[e.ZSConstants.FeatureConstants.DATA_CLEANING],i=e.ZSClass.ActionObject,o=e.ZSEvents,R=o.topic,l=o.Groups,c=o.Names,E=r.JSONConstants;e.UserAction.clusterData=function(e,t,i,o,E,L,C,g,S,u,d){if(-1!=C){var A=new ZSClass.ParamGenerator(i,t,o,!1,!1),v=A.getSheets(),_=L?A.getCustomRanges(JSUtil.Range.parseRange(t,o,L).range):A.getRanges(),I=A.getActiveCell(),w={RID:t,sheetList:v,rangeList:_,VERSION:o,activeCell:I,constant:a.DATA_CLEANSING,column:null==C?I.c:C,dataRange:L};if(S?w.findTableRangeOnly=!0:w.findTableRange=g,g)r.tableInstance.reset(),w.sheetName=null==E?I.s:E;else{var m=JSUtil.Range.parseRange(t,o,L);L=m.range,w.startRow=L.startRow,w.endRow=L.endRow,w.sheetName=m.sheetID}var f=new n;f.addEventListeners("onComplete",function(t){u&&u(e,t,d)}),f.addEventListeners("onError",function(e){R.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(s.DC_CLUSTER),f.send(w)}},e.UserAction.replaceAll=function(o,E,L,C){var g=t.view.getActiveGridID(),S=t.view.getResourceID(g),u=t.view.getVersionID(g),d=t.view.getSelectedSheets(g),A=r.tableInstance,v=JSUtil.Range.parseRange(S,u,L),_=v.range;!function(r,o,E,L,C,g,S,u,d,A){if(-1!=S){var v=new e.ZSClass.ParamGenerator(o,r,E,!0,!0),_=v.getSheets(),I=v.getRanges(),w=v.getActiveCell(),I=v.getCustomRanges(d,!1),m={RID:r,sheetList:_,rangeList:I,activeCell:w,VERSION:E,isNext:!0,isCaseSensitive:!0,isExactMatch:!0,traverseMode:a.FIND_IN_SHEET,action:a.DATA_CLEANSING_REPLACE_ALL,startRow:C,endRow:g,column:S,replaceCellsArray:u},f=new i(a.DATA_CLEANSING_REPLACE_ALL,m),p=new n;p.addEventListeners("onComplete",function(e){f.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(f),A&&A("success")}),p.addEventListeners("onError",function(e){R.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(s.DC_CLUSTER_REPLACE_ALL),p.send(m)}}(S,d,u,v.sheetID,_.startRow,_.endRow,A.getCurrentCol(),o,function(e,t,n,s){var a=JSUtil.Range.parseRange(e,t,n).range;return new ZSClass.Range(a.startRow,s,a.endRow,s)}(S,u,L,C),E)},e.UserAction.getEmptyCellsCount=function(o,E,L,C,g){var S=new e.ZSClass.ParamGenerator(L,o,E,!1,!1),u={RID:o,VERSION:E,sheetList:S.getSheets(),rangeList:C?S.getCustomRanges(C):S.getRanges(),activeCell:S.getActiveCell(),action:a.COUNT_EMPTY_CELLS},d=new i(a.COUNT_EMPTY_CELLS,u),A=new n;A.addEventListeners("onComplete",function(e){d.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(d),r.EmptyRows=e.count,g(e.count.length)}),A.addEventListeners("onError",function(e){R.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(s.DC_EMPTY_CELLS_COUNT),A.send(u)},e.UserAction.fillEmptyCells=function(t,r,o,L,C,g,S){var u=new e.ZSClass.ParamGenerator(o,t,r,!1,!1),d=u.getSheets(),A=L?u.getCustomRanges(L):u.getRanges(),v=u.getActiveCell(),_={},I={};g&&(I[E.FILL_EMPTY_VALUE]=g),_[E.FILL_EMPTY_TYPE]=C,_[E.FILL_EMPTY_SUB_PARAMS]=I;var w={RID:t,sheetList:d,activeCell:v,rangeList:A,VERSION:r,action:a.FILL_EMPTY,ap:e.JSON.stringify(_)},m=(new i(a.FILL_EMPTY,w),new n);m.addEventListeners("onComplete",function(e){S()}),m.addEventListeners("onError",function(e){R.publish(l.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),m.open(s.DC_FILL_EMPTY_CELLS),m.send(w)}}(this);
!function(e){var t=e.ZSEvents,n=t.topic,s=t.Groups,i=t.Names,o=e.ZSConstants,r=e.sPlusPlus.SML.Client.Utility.WorkerRequest,a=(e.ZSClass.ActionObject,o.ActionConstants),c=o.URI;e.UserAction.PickFromList=function(t,o,R,l,S){var E=new e.ZSClass.ParamGenerator(o,t,R),u=E.getSheets(),C=E.getRanges(),L=E.getActiveCell(),v={RID:t,VERSION:R,sheetList:u,rangeList:C,activeCell:L,ISTYPEAHEAD:l,action:a.PICK_LIST},I=new r;I.addEventListeners("onComplete",function(e){L.s,S&&S(e.result)}),I.addEventListeners("onError",function(e){n.publish(s.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),I.open(c.PICK_LIST),I.send(v)},e.UserAction.getPickListRange=function(t,o,a,R){var l=new e.ZSClass.ParamGenerator(o,t,a).getActiveCell(),S={RID:t,VERSION:a,activeCell:l},E=new r;E.addEventListeners("onComplete",function(e){R(t,l.s,a,e)}),E.addEventListeners("onError",function(e){n.publish(s.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),E.open(c.PICK_LIST_RANGE),E.send(S)}}(this);
!function(e){var t=e.ZSConstants.ActionConstants,n=e.ZSClass.ActionObject,s=e.sPlusPlus,o=s.SML.Client.Utility.WorkerRequest,i=e.ZSConstants.URI,a=e.ZSEvents,r=a.topic,R=a.Names,c=a.Groups;e.UserAction.HideRow=function(a,l,E,S,d){var u=new e.ZSClass.ParamGenerator(l,a,E,!0,!0),O=u.getSheets(),C=d?u.getCustomRanges(d):u.getRanges(),I="HIDE"==S?i.HIDEROWS_ADD:i.HIDEROWS_REMOVE,D="HIDE"==S?t.HIDE_ROWS:t.UNHIDE_ROWS,H={RID:a,sheetList:O,rangeList:C,VERSION:E,activeCell:u.getActiveCell(),action:D,undoRedoOptions:{allowRowScroll:!0}},g=new n(D,H),v=new o;v.addEventListeners("onError",function(e){r.publish(c.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),v.addEventListeners("onComplete",function(e){g.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(g)}),v.open(I),v.send(H)}}(this);
!function(e){var t=e.ZSConstants.ActionConstants,n=e.ZSClass.ActionObject,s=e.sPlusPlus,o=s.SML.Client.Utility.WorkerRequest,i=e.ZSConstants.URI,a=ZSEvents.topic,r=ZSEvents.Names,l=ZSEvents.Groups;e.UserAction.HideCol=function(c,E,S,C,R){var d=new e.ZSClass.ParamGenerator(E,c,S,!0,!0),u=d.getSheets(),O=R?d.getCustomRanges(R):d.getRanges(),I="HIDE"==C?i.HIDECOLS_ADD:i.HIDECOLS_REMOVE,L="HIDE"==C?t.HIDE_COLUMNS:t.UNHIDE_COLUMNS,v={RID:c,sheetList:u,rangeList:O,VERSION:S,activeCell:d.getActiveCell(),action:L,undoRedoOptions:{allowColScroll:!0}},D=new n(L,v),H=new o;H.addEventListeners("onError",function(e){a.publish(l.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),H.addEventListeners("onComplete",function(e){D.qaid=e.qaid,s.data.UserInfo.ActionRecorder.record(D)}),H.open(I),H.send(v)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=n.topic,i=n.Groups,o=n.Names,r=t.SML.Client.Utility.WorkerRequest,a=e.ZSClass.ActionObject,c=e.ZSConstants,E=c.URI,I=c.ActionConstants;e.UserAction.ImageAction=function(n,c,R,S,d,l){var u=new e.ZSClass.ParamGenerator(c,n,R),A=u.getSheets(),v=u.getActiveCell(),O=I[d],C=E[d],p={actionCnst:O,sheetList:A,sheetName:S,activeCell:v,VERSION:R,imageJson:l,RID:n,undoRedoOptions:{STOPSELECTION:!0}},m=new a(O,p),D=new r;D.addEventListeners("onComplete",function(e){m.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(m)}),D.addEventListeners("onError",function(e){s.publish(i.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(C),D.send(p)},e.UserAction.uploadImage=function(e,n,a,c){var I=t.view.getActiveGridID(),R=(a=t.view.getVersionID(I),{RID:e,VERSION:a,files:c}),S=new r;S.addEventListeners("onComplete",function(t){s.publish(i.Listener,o.SheetAction.IMAGES.UPLOAD,{RID:e,SHEETID:n,VERSION:a,IMAGES:t.IMAGES})}),S.open(E.IMAGE_DRAG_DROP),S.send(R)}}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSEvents,s=n.topic,o=n.Groups,i=n.Names,r=t.ZSConstants.ActionConstants,a=t.ZSClass.ActionObject,R=t.ZSConstants.URI,c=e.SML.Client.Utility.WorkerRequest;t.UserAction.hideGridInViewport=function(n,d,I,S){var E={sheetList:new t.ZSClass.ParamGenerator(d,n,I,!0,!0).getSheets(),ISSHOWGRID:S,VERSION:I,RID:n,action:r.HIDE_GRID,undoRedoOptions:{STOPSELECTION:!0}},u=r.HIDE_GRID,O=new a(u,E),l=new c;l.addEventListeners("onComplete",function(t){O.qaid=t.qaid,e.data.UserInfo.ActionRecorder.record(O)}),l.addEventListeners("onError",function(t){s.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:t.mk})}),l.open(R.HIDE_GRID),l.send(E)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,o=e.ZSClass,s=n.topic,r=n.Groups,i=n.Names,a=e.ZSConstants.ActionConstants,R=e.ZSClass.ActionObject,E=e.ZSConstants.URI,c=t.SML.Client.Utility.WorkerRequest,l=t.data.Defaults;function u(e,n,u,d,C){var F=t.data.getWorkBook(e,u).getSheetObj(n[0]),S=new o.ParamGenerator(n,e,u),A=S.getSheets(),O=S.getActiveCell();(d>l.MAX_ROW_FREEZE||C>l.MAX_COL_FREEZE)&&(s.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:"FreezePanes.LastRowColNotAllowed"}),d=F.Row.FreezedCount,C=F.Column.FreezedCount);var L=0===d&&0===C?a.UNFREEZE_PANES:a.FREEZE_PANES,Z=new o.Range(d,C,d,C),p={RID:e,sheetList:A,rangeList:S.getCustomRanges(Z),activeCell:O,VERSION:u,action:L},w=new R(L,p),z=new c;z.addEventListeners("onComplete",function(e){w.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(w),s.publish(r.Listener,i.UserAction.UpdateFreezeOptions,{FreezedRow:d,FreezedCol:C})}),z.addEventListeners("onError",function(e){s.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),z.open(E.FREEZE_MODIFY),z.send(p)}e.UserAction.Freeze=u,e.UserAction.FreezeRow=function(e,t,n,o){u(e,t,n,o,0)},e.UserAction.FreezeCol=function(e,t,n,o){u(e,t,n,0,o)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=e.ZSClass,E=s.topic,S=s.Groups,R=s.Names,a=e.ZSConstants.ActionConstants,o=(e.ZSClass.ActionObject,e.ZSConstants.URI),r=t.SML.Client.Utility.WorkerRequest,C=e.JSUtil;e.UserAction.solver=function(e,t,s,L,N,i,T,l,A,c){var I=new n.ParamGenerator(s,e,t),_=C.Range.parseRange(e,t,L),O=C.Range.parseRange(e,t,N),g=_.sheetName,u=O.sheetName,V=O.range,H=_.range,p=(_=C.Cell.getReference(H.startRow,H.startCol),{RID:e,VERSION:t,SHEET_LIST:s=I.getSheets(),RANGE_LIST:I.getCustomRanges(V),activeCell:I.getActiveCell(),OBJECTIVE_CELL:_,OBJECTIVE_CELL_SHEETNAME:g,VARIANT_CELLS_SHEETNAME:u,NON_NEG_RESTRICTION:T,IS_VALUEBOX_SELECTED:l,SPECIFICVALUE:A,GOAL_TYPE:i,CONSTRAINTS_LHS:c.constrLHS,CONSTRAINTS_REL:c.constrREL,CONSTRAINTS_RHS:c.constrRHS}),v=(a.SOLVER,new r);v.addEventListeners("onComplete",function(e){E.publish(S.Listener,R.UserAction.SOLVER.RESP_HANDLE,{RESPONSE:e})}),v.open(o.SOLVER),v.send(p)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=e.ZSClass,l=n.topic,o=n.Groups,i=n.Names,a=e.ZSConstants.ActionConstants,r=e.ZSClass.ActionObject,c=e.ZSConstants.URI,S=t.SML.Client.Utility.WorkerRequest;e.UserAction.goalSeek=function(e,n,u,E,d,C,R,L){var I=new s.ParamGenerator(n,e,u),O=I.getSheets(),m=I.getActiveCell(),A={RID:e,sheetList:O,vCellSheetName:E,tCellSheetName:d,vCellLbl:C,tCellLbl:R,VERSION:u,activeCell:m,action:a.GOAL_SEEK,desiredValue:L},v=a.GOAL_SEEK,g=new r(v,A),h=new S;h.addEventListeners("onComplete",function(n){l.publish(o.Listener,i.UserAction.GOALSEEK_PROMPT,{response:n,RID:e,SHEETID:m.s,VERSION:u,columnIndex:n.columnIndex,rowIndex:n.rowIndex,message:n.message,TargetCellValue:n.TargetCellValue,solution:n.solution}),g.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(g)}),h.addEventListeners("onError",function(e){l.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(c.GOALSEEK),h.send(A)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSClass.ActionObject,o=t.SML.Client.Utility.WorkerRequest,s=e.ZSEvents,i=s.topic,r=s.Groups,R=s.Names,E=e.ZSConstants,a=E.URI,u=(E.I18N,E.ActionConstants),c=e.ZSDevTools.Logger;e.UserAction.fileImport=function(e,t,n,s,i,r,R,E,u,l,d){var O={VERSION:n,RID:e,isURLImport:i,files:s,action:r,delimiter:R,password:u,mimeType:l,isGadgetURL:d};i&&(O.xurl=encodeURIComponent(s));var T=new o;T.addEventListeners("onComplete",function(o){E(e,t,n,o,r)}),T.addEventListeners("onRequestTimeOut",function(e){c.log("WORKER REQUEST TIMEOUT")}),T.open(a.IMPORT_CREATE_NEW),T.send(O)},e.UserAction.import=function(e,s,E,l,d){var O=t.data.getWorkBook(e,E).getSheetObj(s[0]).Prop.Name,T=d.fname,m=u[l],I=a[l],L=new ZSClass.ParamGenerator(s,e,E),S=L.getSheets(),U=d.startCell?L.getCustomRanges(d.startCell):L.getRanges(),g={RID:e,srID:d.rid,sheetList:S,currentSheet:O,VERSION:E,sourceDocName:T,action:m,rangeList:U},p=(new n(m,g),new o);p.addEventListeners("onError",function(e){i.publish(r.Listener,R.ERROR.SHOW,{ERRORMSG:e.mk})}),p.addEventListeners("onRequestTimeOut",function(e){c.log("WORKER REQUEST TIMEOUT")}),p.open(I),p.send(g)},e.UserAction.getFileContentFromUrl=function(e,t,n,s){var i={RID:e,VERSION:t,url:n,action:u.GET_FILE_CONTENT_FROM_URL},r=new o;r.addEventListeners("onError",function(e){s&&s(e)}),r.addEventListeners("onComplete",function(e){s&&s(e)}),r.addEventListeners("onRequestTimeOut",function(e){c.log("WORKER REQUEST TIMEOUT")}),r.open(a.GET_FILE_CONTENT_FROM_URL),r.send(i)}}(this);
!function(e){var n=e.sPlusPlus.SML.Client,t=e.ZSConstants.URI,o=(e.ZSDevTools.Logger,n.Utility.WorkerRequest);e.UserAction.exportToCloudDrives=function(e,n,s,r,i,u){var E={RID:e,VERSION:n,SOURCE:s,FOLDERID:r,DOCNAME:i},D=new o;D.addEventListeners("onError",function(e){u&&u(e)}),D.addEventListeners("onComplete",function(e){u&&u(e)}),D.open(t.EXPORT_TO_CLOUD_DRIVES),D.send(E)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,a=s.Groups,i=s.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSClass.ActionObject,l=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI;e.UserAction.FORMAT_TEXT=function(s,c,C,T,E,L){var O;O="STANDARD"==T?l.FORMAT_CURRENCY:l.FORMAT_TEXT;var S=new e.ZSClass.ParamGenerator(c,s,C),A=S.getSheets(),M=S.getRanges(),f=S.getActiveCell(),m={action:O,sheetList:A,rangeList:M,activeCell:f,RID:s,VERSION:C,formatType:T,formatString:E,formatCellsParam:L},u=new o(O,m),d=new r;d.addEventListeners("onComplete",function(e){if(O===l.FORMATCELLS_CLIENT){var s=e.format?e.format:{};n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT,{FORMAT:s}),e.format||JSUtil.Object.isEmpty(e)||n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else e.qaid,u.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(u)}),d.addEventListeners("onError",function(e){n.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(R.NUMBER_FORMAT_MODIFY),d.send(m)}}(this);
!function(e){var t=e.sPlusPlus,s=e.ZSEvents,n=s.topic,a=s.Groups,i=s.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSClass.ActionObject,l=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI;e.UserAction.FORMAT_COMMA=function(s,C,R,M,O,L){var S=l.FORMAT_COMMA,A=new e.ZSClass.ParamGenerator(C,s,R,!0),E=A.getSheets(),T=A.getRanges(),f=A.getActiveCell(),m={action:S,sheetList:E,rangeList:T,activeCell:f,RID:s,VERSION:R,formatType:M,formatString:O,formatCellsParam:L},u=new o(S,m),d=new r;d.addEventListeners("onComplete",function(e){if(S===l.FORMATCELLS_CLIENT){var s=e.format?e.format:{};n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT,{FORMAT:s}),e.format||JSUtil.Object.isEmpty(e)||n.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT_CUSTOM,{FORMAT:e}),callBack&&callBack(e)}else e.qaid,u.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(u)}),d.addEventListeners("onError",function(e){n.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(c.NUMBER_FORMAT_MODIFY),d.send(m)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=n.topic,a=n.Groups,i=n.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSClass.ActionObject,L=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI;function C(n,C,l,E,c,S,T,u,A){switch(E){case"FORMATCELLS_GRID":E=L.FORMATCELLS_GRID;break;case"FORMATCELLS_CLIENT":E=L.FORMATCELLS_CLIENT;break;default:return void logger.log("undefined action : ",E)}var O=new e.ZSClass.ParamGenerator(C,n,l,!0,!0),M=O.getSheets(),d=O.getRanges(),f=O.getActiveCell(),I={action:E,sheetList:M,rangeList:d,activeCell:f,RID:n,VERSION:l,formatType:c,formatString:S,formatCellsParam:T},F=new o(E,I),_=new r;_.addEventListeners("onComplete",function(e){if(E===L.FORMATCELLS_CLIENT){var n=e.format?e.format:{};s.publish(a.Listener,i.CellMeta.FORMATCELLS_CLIENT,{FORMAT:n}),u&&u(e)}else{e.qaid;F.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(F)}A&&A()}),_.addEventListeners("onError",function(e){s.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(R.NUMBER_FORMAT_MODIFY),_.send(I)}e.UserAction.FORMATCELLS_GRID=function(e,t,n,s,a,i){C(e,t,n,"FORMATCELLS_GRID",s,a,i)},e.UserAction.FORMATCELLS_CLIENT=function(e,t,n,s,a,i){C(e,t,n,"FORMATCELLS_CLIENT",null,null,s,a,i)}}(this);
!function(e){var n=e.sPlusPlus,t=e.ZSEvents,s=t.topic,r=t.Groups,i=t.Names,o=e.ZSConstants,a=n.SML.Client,R=(a.Utility.WorkerRequest,o.URI),d=e.ZSClass.ActionObject,E=o.ActionConstants,l=a.Utility.WorkerRequest;e.ZSConstants.I18N,JSUtil.fn;e.UserAction.dataType=function(e,n,t,o,a,c){var O=new ZSClass.ParamGenerator(n,e,t,!0,!0),A=O.getSheets(),L=o?O.getCustomRanges(o):O.getRanges(),C=O.getActiveCell(),I=E.CONDITIONAL_FORMAT_READ_DATATYPE,S={RID:e,VERSION:t,rangeList:L,sheetList:A,activeCell:C,action:I},u=(new d(I,S),new l);u.addEventListeners("onComplete",function(n){s.publish(r.Listener,i.UserAction.CONDITIONAL_FORMAT.FIND_DATA_TYPE,{RID:e,SHEETID:C.s,VERSION:t,DATA_TYPE:n.DATATYPE,CR_TYPE:a,MANAGE_REQ:c})}),u.addEventListeners("onError",function(e){s.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(R.CONDITIONAL_FORMAT_READ_DATATYPE),u.send(S)},e.UserAction.CFValidation=function(n,t,o,a,c,O,A,L){var C=new ZSClass.ParamGenerator(t,n,a),I=C.getActiveCell(),S=(o=C.getCustomRanges(o,!0),C.getSheets()),u=E.VALIDATE_INPUT_CF,g={RID:n,sheetList:S,rangeList:o,activeCell:I,VERSION:a,valCFInpsJson:e.JSON.stringify(c),validateFor:O,action:u},v=(new d(u,g),new l);v.addEventListeners("onComplete",function(e){e.valinp.isError?L&&L(e,c):A&&A(c,e,n,t,a)}),v.addEventListeners("onError",function(e){s.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(R.VALIDATE_INPUT_CF),v.send(g)},e.UserAction.applyConditionalFormat=function(t,o,a,c,O,A,L){var C=new ZSClass.ParamGenerator(c,a,O,!0),I=t.datarange,S=C.getParmsFromDataString(I),u=C.getActiveCell(),g=S.ranges,v=S.sheets,T=E[A];t.asn||(e.ZSDevTools.Logger.log("Handle this ::: 'asn' should be set on CF inputJson"),t.asn=c[0]);var m={RID:a,sheetList:v,activeCell:u,rangeList:g,VERSION:O,conditionsparam:e.JSON.stringify(t),action:T},D=new d(T,m),N=new l;N.addEventListeners("onComplete",function(e){D.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(D),L&&L()}),N.addEventListeners("onError",function(e){s.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(R[A]),N.send(m)},e.UserAction.clearConditionalFormat=function(e,t,o,a){var c=new ZSClass.ParamGenerator(t,e,o,!0),O=c.getSheets(),A=c.getCustomRanges(a),L=c.getActiveCell(),C=E.CONDITIONAL_FORMAT_CLEAR_RULE,I={RID:e,sheetList:O,rangeList:A,activeCell:L,VERSION:o,endCol:a.endCol,action:C},S=new d(C,I),u=new l;u.addEventListeners("onComplete",function(e){S.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(S)}),u.addEventListeners("onError",function(e){s.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(R.CONDITIONAL_FORMAT_CLEAR_RULE),u.send(I)},e.UserAction.reordeRules=function(e,t,o,a,c,O,A){var L=new ZSClass.ParamGenerator(o,e,a),C=L.getActiveCell(),I=E.CONDITIONAL_STYLE_REORDER,S=L.getParmsFromDataString(A),u={RID:e,currentSheet:t,sheetList:S.sheets,rangeList:S.ranges,activeCell:C,VERSION:a,reoderObj:O,currSheetName:c,action:I},g=new d(I,u),v=new l;v.addEventListeners("onComplete",function(e){g.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(g)}),v.addEventListeners("onError",function(e){s.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(R.CONDITIONAL_STYLE_REORDER),v.send(u)},e.UserAction.readConditionalFormatRules=function(e,n,t,o,a,c){var O=new ZSClass.ParamGenerator(n,e,t,!0,!0),A=O.getSheets(),L=O.getActiveCell(),C=E[o],I={RID:e,activeCell:L,sheetList:A,version:t,action:C,rangeList:a&&-1==a.startRow?void 0:a?O.getCustomRanges(a):O.getRanges(),dateFormat:c},S=(new d(C,I),new l);S.addEventListeners("onComplete",function(e){s.publish(r.Listener,i.UserAction.CONDITIONAL_FORMAT.READ_RULES,{RESPONSE:e.CONDITIONALFORMAT})}),S.addEventListeners("onError",function(e){s.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),S.open(R[o]),S.send(I)},e.UserAction.deleteConditionalFormat=function(e,t,o,a,c,O){var A=n.view.getActiveGridID(),L=n.view.getVersionID(A),C=new ZSClass.ParamGenerator(t,e,L),I=(C.getActiveCell(),E.CONDITIONAL_FORMAT_DELETE),S=C.getParmsFromDataString(c),u={RID:e,conditionsparam:a,sheetList:S.sheets,rangeList:S.ranges,VERSION:L,action:I},g=new d(I,u),v=new l;v.addEventListeners("onComplete",function(e){O.classList.add("bOr","aDd"),setTimeout(function(){O.remove()},1e3),g.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(g)}),v.addEventListeners("onError",function(e){s.publish(r.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(R.CONDITIONAL_FORMAT_DELETE),v.send(u)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,a=(n.topic,n.Groups,n.Names,e.ZSClass),i=t.SML.Client.Utility.WorkerRequest,s=(a.ActionObject,e.ZSConstants.URI),o=e.ZSConstants.ActionConstants;e.UserAction.addNamedRange=function(e,t,n,E,r){var A=new a.ParamGenerator(t,e,n,!1),g={sheetList:A.getSheets(),RID:e,rangeList:A.getRanges(),activeCell:A.getActiveCell(),VERSION:n,RANGENAME:E,RANGE:encodeURIComponent(r),type:"add",action:o.NAMEDRANGE_ADD},c=new i;c.open(s.NAMED_RANGE_ADD),c.addEventListeners("onComplete",function(e){}),c.send(g)},e.UserAction.deleteNamedRange=function(e,t,n,E){var r=new a.ParamGenerator(t,e,n,!1),A=r.getSheets(),g=r.getRanges(),c={RID:e,RANGENAME:E,activeCell:r.getActiveCell(),VERSION:n,sheetList:A,rangeList:g,type:"delete",action:o.NAMEDRANGE_DELETE},N=new i;N.open(s.NAMED_RANGE_DELETE),N.addEventListeners("onComplete",function(e){}),N.send(c)},e.UserAction.modifyNamedRange=function(e,n,E,r,A){t.data.getWorkBook(e,E);var g=t.view.getActiveGridID(),c=(E=t.view.getVersionID(g),t.view.getSheetState(g,n[0]),new a.ParamGenerator(n,e,E,!1)),N={sheetList:c.getSheets(),rangeList:c.getRanges(),RID:e,activeCell:c.getActiveCell(),RANGENAME:r,RANGE:encodeURIComponent(A),VERSION:E,type:"modify",action:o.NAMEDRANGE_MODIFY},R=new i;R.open(s.NAMED_RANGE_MODIFY),R.addEventListeners("onComplete",function(e){}),R.send(N)},e.UserAction.getNamedRangeList=function(e,n,E){t.data.getWorkBook(e,E);var r=t.view.getActiveGridID(),A=(E=t.view.getVersionID(r),t.view.getSheetState(r,n[0]),new a.ParamGenerator(n,e,E,!1)),g={RID:e,VERSION:E,sheetList:A.getSheets(),rangeList:A.getRanges(),activeCell:A.getActiveCell(),type:"getNamedRanges",action:o.JSP_NAMEDRANGE},c=new i;c.open(s.GET_NAMED_RANGES),c.addEventListeners("onComplete",function(e){}),c.send(g)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,s=n.topic,a=n.Groups,r=n.Names,o=e.ZSConstants,A=(i=e.ZSClass,o.I18N),l=t.SML.Client.Utility.WorkerRequest,I=o.URI,d=(e.encodeURIComponent,i.ActionObject),L=o.ActionConstants;e.UserAction.ValidateInput=function(e,t,n,o,A,R,c){var E=new i.ParamGenerator(t,e,n),D=E.getSheets(),v=E.getCustomRanges(A,!0),u=E.getActiveCell(),g=JSON.stringify(o),S={RID:e,sheetList:D,VERSION:n,validateFor:"datavalidation",activeCell:u,valInpsJson:g,rangeList:v,action:L.VALIDATE_INPUT},O=(new d(L.VALIDATE_INPUT,S),new l);O.addEventListeners("onComplete",function(i){i.valinp.isError?c&&c(i,o):R&&R(e,t,n,o,A)}),O.addEventListeners("onError",function(e){s.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(I.VALIDATE_INPUT),O.send(S)},e.UserAction.CreateDataValidation=function(e,n,o,A,R,c){var E=new i.ParamGenerator(n,e,o,!0),D=E.getSheets(),v=E.getCustomRanges(R,!0),u=E.getActiveCell(),g={RID:e,dvJSON:A,VERSION:o,SHEETID:A.asn,action:L.DATA_VALIDATION_APPLY,sheetList:D,rangeList:v,activeCell:u},S=new d(L.DATA_VALIDATION_APPLY,g),O=new l;O.addEventListeners("onComplete",function(e){S.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(S),c&&s.publish(a.Listener,r.UserAction.DATA_VALIDATION.MANAGE_DIALOG,{REQ_NEED:!0})}),O.addEventListeners("onError",function(e){s.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(I.DATAVALIDATION_ADD),O.send(g)},e.UserAction.RemoveDataValidation=function(e,t,n,o,d,R){var c=new i.ParamGenerator(t,e,n,!0),E=c.getSheets(),D=o?c.getCustomRanges(o,!0):c.getRanges(),v=c.getActiveCell(),u={rID:e,sheetList:E,rangeList:D,VERSION:n,action:L.DATA_VALIDATION_CLEAR,activeCell:v},g=new l;g.addEventListeners("onComplete",function(e){if(d){var t=d.parentElement;d.remove(),0==t.childElementCount&&t.appendChild(R)}}),g.addEventListeners("askConfirm",function(e){var t=new i.ZSConfirm(A[e.mk]);t.onYES(function(){g.resend()});var n=t.execute();s.publish(a.Listener,r.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),g.addEventListeners("onError",function(e){s.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),g.open(I.DATA_VALIDATION_CLEAR),g.send(u)},e.UserAction.HighlightInvalidData=function(e,t,n){var o={RID:e,sheetList:new i.ParamGenerator(t,e,n).getSheets(),VERSION:n},A=new l;A.addEventListeners("onComplete",function(e){}),A.addEventListeners("onError",function(e){s.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(I.DATA_HIGHLIGHT_INVALID),A.send(o)},e.UserAction.ValidateDvRange=function(e,t,n,o,A,d){var R=new i.ParamGenerator(t,e,o),c={RID:e,VERSION:o,sheetList:R.getSheets(),rangeList:A?R.getCustomRanges(A,!0):R.getRanges(),activeCell:R.getActiveCell(),currSheetName:n,action:L.DATA_VALIDATION_READRANGE,dateFormat:d},E=new l;E.addEventListeners("onComplete",function(e){s.publish(a.Listener,r.UserAction.DATA_VALIDATION.VALIDATION,{DV_JSON:e.dataval})}),E.addEventListeners("onError",function(e){s.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),E.open(I.DATA_VALIDATION_READRANGE),E.send(c)},e.UserAction.ReadDataValidation=function(e,t,n,o,A,d,R){var c=new i.ParamGenerator(t,e,o),E={RID:e,sheetList:c.getSheets(),rangeList:d?c.getCustomRanges(d):c.getRanges(),activeCell:c.getActiveCell(),VERSION:o,action:L[A],dateFormat:R},D=new l;D.addEventListeners("onComplete",function(e){s.publish(a.Listener,r.UserAction.DATA_VALIDATION.MANAGE,{ALL_DV:e.dataval})}),D.addEventListeners("onError",function(e){s.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(I[A]),D.send(E)},e.UserAction.getListValues=function(e,n,o,A,d,L,R,c,E,D){t.data.getWorkBook(e,o);var v=t.view.getActiveGridID(),u=t.view.getSelectedSheets(v),g=new i.ParamGenerator(u,e,o),S=g.getSheets(),O=g.getRanges(),C=g.getActiveCell();c&&E&&(E=JSUtil.Range.parseRange(e,o,E));var N={RID:e,sheetID:n,VERSION:o,row:A,col:d,sheetList:S,rangeList:O,activeCell:C,totalParts:L,partNum:R,rangeObj:E},T=new l;T.addEventListeners("onComplete",function(e){var t=[];e.dataval.list.forEach(function(e){t.push(decodeURIComponent(e))}),e.dataval.list=t,s.publish(a.Listener,r.UserAction.DATA_VALIDATION.LIST_RESPONSE,{LIST_JSON:e})}),T.addEventListeners("onError",function(e){}),T.open(I.DATA_VALIDATION_READLIST),T.send(N)},e.UserAction.updateIsContentValid=function(e,n,o,A){t.data.getWorkBook(e,o);var d=t.view.getActiveGridID(),L=t.view.getSelectedSheets(d),R=new i.ParamGenerator(L,e,o).getSheets(),c={RID:e,sheetID:n,VERSION:o,sheetList:R,gridID:d,isEnabled:A},E=new l;E.addEventListeners("onComplete",function(t){A&&0!=t.invalidCells.length&&s.publish(a.Listener,r.UserAction.DATA_VALIDATION.HIGHLIGHT_INVALID_CELLS,{RID:e,SHEETID:n,VERSION:o,INVALID_CELLS:t.invalidCells})}),E.addEventListeners("onError",function(e){}),E.open(I.UPDATE_INVALID_CONTENT),E.send(c)}}(this);
!function(e){var n=e.sPlusPlus,t=e.ZSEvents,s=e.ZSClass,o=t.topic,E=t.Groups,r=t.Names,i=e.ZSConstants,a=(s=e.ZSClass,i.I18N,n.SML.Client.Utility.WorkerRequest),R=i.URI,A=e.encodeURIComponent,c=s.ActionObject,l=i.ActionConstants;e.UserAction.ApplyWebData=function(t,s,i,A,S,T,d,D,L,u,I){var p=new e.ZSClass.ParamGenerator(i,t,s,!0),v={RID:t,VERSION:s,sheetList:p.getSheets(),SHEETID:A,sheetName:S,mode:T,activeCell:p.getActiveCell(),url:(0,e.encodeURIComponent)(d),webDataSheet:D,webDataCell:L,webDataInterval:u,selectTbls:I},W=new c(l.WEB_DATA,v),b=new a;b.addEventListeners("onComplete",function(e){W.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(W)}),b.addEventListeners("onError",function(e){o.publish(E.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),b.open(R.WEB_DATA),b.send(v)},e.UserAction.ReadTables=function(n,t,s,i,A,S){S.classList.add("ZsRt");var T={RID:n,VERSION:s,SHEETID:t,mode:i,url:(0,e.encodeURIComponent)(A)},d=(new c(l.GET_HTML_WEBDATA,T),new a);d.addEventListeners("onComplete",function(e){o.publish(E.Listener,r.UserAction.WEB_DATA.READ_TABLES,{TABLES:e.webdataXML}),S.classList.remove("ZsRt")}),d.addEventListeners("onError",function(e){o.publish(E.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(R.GET_HTML_WEBDATA),d.send(T)},e.UserAction.getWebDataList=function(e,n,t,s){var i={RID:e,SHEETID:n,VERSION:t,versionNo:s},A=(new c(l.WEBDATA_LIST,i),new a);A.addEventListeners("onComplete",function(e){o.publish(E.Listener,r.UserAction.WEB_DATA.LIST,{LIST_ARRAY:e.WEBDATA_LIST})}),A.addEventListeners("onError",function(e){o.publish(E.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(R.WEBDATA_LIST),A.send(i)},e.UserAction.refreshWebData=function(e,n,t,i,S,T,d,D,L,u,I,p,v,W){var b={RID:e,SHEETLIST:new s.ParamGenerator(n,e,S,!0,!0).getSheets(),VERSION:S,SHEETID:t,SHEETNAME:i,WEBDATA_SHEET:d,MODE:T,CELL:u,ID:D,url:p?A(p):"",FEED:L,webDataInterval:v,selectTbls:W},m=(new c(l.UPDATE_WEB_DATA,b),new a);m.addEventListeners("onComplete",function(e){I&&I()}),m.addEventListeners("onError",function(e){o.publish(E.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),m.open(R.UPDATE_WEB_DATA),m.send(b)}}(this);
!function(e){var n=e.sPlusPlus,t=e.ZSEvents,s=e.ZSClass,r=t.topic,o=t.Groups,i=t.Names,a=n.SML.Client.Utility.WorkerRequest,R=e.ZSClass.ActionObject,E=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI;e.UserAction.LockRange=function(e,t,d,S,L,O,u,h,l,g){var C=new s.ParamGenerator(t,e,S,!0),A=C.getSheets(),v=C.getActiveCell(),f=d?C.getCustomRanges(d,!0):C.getRanges(),p={RID:e,sheetList:A,unAuthUsers:O.toString(",",!0),authGroups:u.toString(",",!0),authOrgs:h.toString(",",!0),VERSION:S,rangeList:f,activeCell:v,isSheet:l,isExtend:g,action:E.LOCK_RANGE};L.length>0&&(p.authUsers=L.toString(",",!0));var I=new R(E.LOCK_RANGE,p),U=new a;U.addEventListeners("onComplete",function(e){I.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(I)}),U.addEventListeners("onError",function(e){r.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),U.open(c.LOCK_RANGE_ADD),U.send(p)},e.UserAction.checkRangeLockInfo=function(e,n,t,d,S,L){var O=new s.ParamGenerator(n,e,t,!0),u=O.getSheets(),h=void 0==L?O.getRanges():O.getCustomRanges(L),l=O.getActiveCell(),g=E.PROTECT_RANGE_DIALOG,C={RID:e,sheetList:u,VERSION:t,activeCell:l,rangeList:h,isSheet:d,isExtend:S,action:g},A=(new R(g,C),new a);A.addEventListeners("onComplete",function(e){r.publish(o.Listener,i.UserAction.SHOW_LOCK_INFO,{lockInfo:e,isSheet:d})}),A.addEventListeners("onError",function(e){r.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(c.PROTECT_RANGE_DIALOG),A.send(C)},e.UserAction.RemoveLockRange=function(e,t,d,S){var L=new s.ParamGenerator(t,e,S,!0),O=L.getSheets(),u=L.getActiveCell(),h=d?L.getCustomRanges(d,!0):L.getRanges(),l=E.UNLOCK_RANGE,g={RID:e,sheetList:O,activeCell:u,VERSION:S,rangeList:h,action:l},C=new R(l,g),A=new a;A.addEventListeners("onComplete",function(e){C.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(C)}),A.addEventListeners("onError",function(e){r.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(c.UNLOCK_RANGE),A.send(g)},e.UserAction.LockSheet=function(e,t,d,S,L,O,u){var h=new s.ParamGenerator(t,e,d,!1).getSheets(),l=E.LOCK_SHEET,g={RID:e,sheetList:h,VERSION:d,unAuthUsers:L.toString(",",!0),authGroups:O.toString(",",!0),authOrgs:u.toString(",",!0),action:l};S.length>0&&(g.authUsers=S.toString(",",!0));var C=new R(l,g),A=new a;A.addEventListeners("onComplete",function(e){C.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(C)}),A.addEventListeners("onError",function(e){r.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(c.LOCK_SHEET),A.send(g)},e.UserAction.UnlockSheet=function(e,t,d){var S=new s.ParamGenerator(t,e,d,!1).getSheets(),L=E.UNLOCK_SHEET,O={RID:e,VERSION:d,sheetList:S,action:L},u=new R(L,O),h=new a;h.addEventListeners("onComplete",function(e){u.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(u)}),h.addEventListeners("onError",function(e){r.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(c.UNLOCK_SHEET),h.send(O)},e.UserAction.readProtectedRanges=function(e,n,t,d,S){var L=new s.ParamGenerator(S?n:[t],e,d,!0).getSheets(),O=S?"":t,u=E.READ_PROTECTED_RANGES,h={RID:e,sheetList:L,currentSheet:O,VERSION:d,validateSharedUsers:!0,action:u},l=(new R(u,h),new a);l.addEventListeners("onComplete",function(e){r.publish(o.Listener,i.UserAction.READ_LOCKS,{lockInfo:e.pr,isSheet:!1,isWholeDoc:S})}),l.addEventListeners("onError",function(e){r.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),l.open(c.READ_PROTECTED_RANGES),l.send(h)},e.UserAction.readProtectedSheets=function(e,n,t){var d=new s.ParamGenerator(n,e,t,!0).getSheets(),S=E.READ_PROTECTED_SHEETS,L={RID:e,sheetList:d,VERSION:t,action:S},O=(new R(S,L),new a);O.addEventListeners("onComplete",function(e){r.publish(o.Listener,i.UserAction.READ_LOCKS,{lockInfo:e.ps,isSheet:!0})}),O.addEventListeners("onError",function(e){r.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),O.open(c.READ_PROTECTED_SHEETS),O.send(L)},e.UserAction.manageLockRange=function(e,t,d,S,L){var O={RID:e,sheetList:new s.ParamGenerator(d,e,S,!0).getSheets(),prObj:t,VERSION:S,isSheet:L,action:E.LOCK_MULTIPLE},u=new R(E.LOCK_MULTIPLE,O),h=new a;h.addEventListeners("onComplete",function(e){u.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(u)}),h.addEventListeners("onError",function(e){r.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(c.LOCK_MULTIPLE),h.send(O)}}(this);
!function(e){var t=e.sPlusPlus,n=(e.UserAction,e.ZSConstants.URI),i=e.ZSEvents,s=(i.topic,i.Groups,i.Names,t.SML.Client.Utility.WorkerRequest);e.UserAction.PrintPreview=function(e,i,o,r,a,d,v,I,E,R){var c=t.view.getActiveGridID(),u=t.view.getSheetID(c),S=t.view.getSheetState(c,u).getActiveRange(),l={RID:e,SHEETID:i,VERSION:o,RANGE:S.startRow+":"+S.startCol+":"+S.endRow+":"+S.endCol,printType:I,addGridlines:r,addChart:a,addImage:d,addButton:v,isCanvas:E},w=new s;w.addEventListeners("onComplete",function(e){R&&R(e)}),w.open(n.PRINT_PREVIEW),w.send(l)},e.UserAction.GetListForPreview=function(e,t,i,o){var r={RID:e,SHEETID:t,VERSION:i},a=new s;a.addEventListeners("onComplete",function(e){o&&o(e)}),a.open(n.PRINT_META_LIST),a.send(r)}}(this);
!function(t){var n=t.sPlusPlus,s=n.SML.Client.Utility.WorkerRequest,e=t.ZSConstants.URI;n.data.UserInfo,ZSConstants.ActionConstants,t.ZSConstants.I18N;t.UserAction.GetDocumentProperties=function(t,n,o){var i={rID:t,version:n},r=new s;r.addEventListeners("onComplete",function(t){t.DOCUMENT_PROPERTIES&&o(t.DOCUMENT_PROPERTIES)}),r.open(e.DOCUMENT_PROPERTIES),r.send(i)}}(this);
!function(e){var n=e.sPlusPlus.SML.Client,t=e.ZSConstants.URI,s=(e.ZSDevTools.Logger,n.Utility.WorkerRequest);e.UserAction.checkinCheckoutSpreadsheet=function(e,n,o,i,r){var c={RID:e,VERSION:n,ACTION:o},u=new s;u.addEventListeners("onError",function(e){}),u.addEventListeners("onComplete",function(e){i&&i(e,r)}),u.open(t.CHECKIN_CHECKOUT_SPREADSHEET),u.send(c)}}(this);
!function(t){var e=t.sPlusPlus,s=e.SML.Client,n=t.ZSConstants.URI,o=t.ZSEvents,i=(o.topic,o.Groups,o.Names,s.Utility.WorkerRequest);UserAction.changeDocStatus=function(t,s,o,c){var a={RID:t,VERSION:s,ISNEWDOC:o},r=new i;r.addEventListeners("onComplete",function(){e.data.DocRegistry[t].isNewDoc=!1,c&&c()}),r.open(n.CHANGE_DOC_STATUS),r.send(a)}}(this);
!function(e){var n=e.sPlusPlus,o=e.ZSEvents,t=o.topic,i=o.Groups,s=o.Names,r=e.ZSConstants,R=n.SML.Client,c=(R.Utility.WorkerRequest,r.URI),a=e.ZSClass.ActionObject,E=r.ActionConstants,l=R.Utility.WorkerRequest;e.UserAction.doRedirect=function(n,o){var r={RID:n,VERSION:o},R=E.REDIRECT_ROPEN,d=(new a(R,r),new l);d.addEventListeners("onComplete",function(n){if(n.isRemoved){var o=(o=e.location.href.replace("/hopen/","/open/")).replace("/hopen.do","/ropen.do");window.location.href=o}}),d.addEventListeners("onError",function(e){t.publish(i.Listener,s.ERROR.SHOW,{ERRORMSG:e.mk})}),d.open(c.REDIRECT_ROPEN),d.send(r)}}(this);
!function(e){var t=e.sPlusPlus,s=e.UserAction,n=e.ZSEvents,r=n.topic,i=n.Groups,o=n.Names,a=e.ZSConstants.URI,u=t.SML.Client.Utility.WorkerRequest;s.getNewlyAddedUserDetails=function(e,s,n){var d={rID:e,VERSION:s,zuid:n},S=new u;S.addEventListeners("onComplete",function(s){t.data.getSharePublishMeta(e).getShareMeta().getSharedUserInfo().add(s.usr),r.publish(i.Listener,o.DocAction.COLLAB_LIST.ADDUSERINFO,{COLLABJSON:s.usr})}),S.addEventListeners("onError",function(e){}),S.open(a.GET_NEWLY_ADDED_USER),S.send(d)}}(this);
!function(e){var n=e.sPlusPlus,t=e.ZSEvents,a=e.ZSClass,o=(t.topic,t.Groups,t.Names,e.ZSConstants.ActionConstants,e.ZSClass.ActionObject,e.ZSConstants.URI),s=n.SML.Client.Utility.WorkerRequest,E=(e.JSUtil,e.UserAction);E.publishRange=function(e,t,E,r,R,i){var l=new a.ParamGenerator(t,e,E),S=(r=l.getParmsFromDataString(r).ranges,l.getActiveSheet()),N={RID:e,VERSION:E,SHEET_NAME:n.data.getWorkBook(e,E).getSheetObj(S).Prop.Name,RANGE_LIST:r,TYPE:R},c=new s;c.addEventListeners("onComplete",function(e){i.call(null,e)}),c.open(o.RANGE_PUBLISH),c.send(N)},E.updatePublishRange=function(e,n,t,a,E,r,R){var i={RID:e,VERSION:t,RANGE_ID:a,MODE:r,TYPE:E.replace("public","external")};R&&(i.SHEETNAME=R.sheetName,i.START_ROW=R.range.startRow,i.START_COL=R.range.startCol,i.END_ROW=R.range.endRow,i.END_COL=R.range.endCol);var l=new s;l.open(o.UPDATE_RANGE_PUBLISH),l.send(i)},E.getPublishRanges=function(e,t,E,r,R){var i=new a.ParamGenerator(t,e,E).getActiveSheet(),l={RID:e,VERSION:E,SHEET_NAME:n.data.getWorkBook(e,E).getSheetObj(i).Prop.Name,ORG_NAME:r},S=new s;S.addEventListeners("onComplete",function(e){R.call(null,e)}),S.open(o.GET_PUBLISHED_RANGES),S.send(l)},E.changePublishRangeType=function(e,n,t,a,E,r){var R={RID:e,VERSION:n,CURR_TYPE:t,PREV_TYPE:a,RANGE_ID:E},i=new s;i.addEventListeners("onComplete",function(){r&&r(t)}),i.open(o.CHANGE_RANGEPUBLISH_TYPE),i.send(R)}}(this);
!function(e){var t=e.sPlusPlus,n=t.SML.Client,s=e.ZSConstants.URI,o=(e.ZSDevTools.Logger,e.ZSEvents),a=e.ZSConstants,P=n.Utility.WorkerRequest,E=o.topic,i=o.Groups,S=o.Names,r=a.CommandConstants;UserAction.PublishSpreadsheet=function(e,n,o,a,u,l,L){var O=t.data.getWorkBook(e,n).Name,R={RID:e,VERSION:n,TYPE:o,docName:O,ALLOW_EXPORT:a,LOCK_FORMULA:u,SUB_ACTION:l},A=new P;A.addEventListeners("onComplete",function(){var n=t.data.getSharePublishMeta(e).getPublishMeta();if("Make Public"===l){var s={};s[r.PUBLISH_TYPE]=o,s[r.ALLOW_EXPORT]=a,s[r.SHOW_FORMULAS]=u,n.update(s)}else"Remove Public"===l&&n.update({});E.publish(i.Listener,S.DocAction.DOCUMENT.PUBLISHED,{RID:e,META:n}),L&&L()}),A.open(s.SPREADSHEET_PUBLISH),A.send(R)},UserAction.changePublishOptions=function(e,n,o,a,E,i){var S={RID:e,VERSION:n,TYPE:o,PROPERTY_NAME:a,PROPERTY_VALUE:E,SUB_ACTION:i},r=new P;r.addEventListeners("onComplete",function(){var n=t.data.getSharePublishMeta(e).getPublishMeta();"ALLOWEXPORT"==a?n.setAllowExport(E):"SHOWFORMULAS"==a&&n.setShowFormula(E)}),r.open(s.SPREADSHEET_PUBLISH_OPTION_CHANGE),r.send(S)},UserAction.changePublishType=function(e,n,o,a,E){var i={RID:e,VERSION:n,TYPE:o,prevType:a},S=new P;S.addEventListeners("onComplete",function(){var n=t.data.getSharePublishMeta(e).getPublishMeta(),s=n.isAllowExport(),a=n.isShowFormula(),P={};P[r.PUBLISH_TYPE]=o,P[r.ALLOW_EXPORT]=s,P[r.SHOW_FORMULAS]=a,n.update(P),E&&E(P[r.PUBLISH_TYPE])}),S.open(s.SPREADSHEET_PUBLISH_TYPE_CHANGE),S.send(i)}}(this);
!function(e){var n=e.sPlusPlus,t=e.ZSConstants,s=t.ActionConstants,o=e.ZSClass.ActionObject,i=e.ZSEvents,E=i.topic,r=i.Groups,S=i.Names,a=t.URI,R=n.SML.Client.Utility.WorkerRequest;e.UserAction.saveAs=function(e,t,i){n.data.getWorkBook(e,t);var c={RID:e,VERSION:t,newDocName:i},u=new o(s.SAVEAS_NEW_DOCUMENT,c),A=new R;A.addEventListeners("onComplete",function(e){E.publish(r.Listener,S.UserAction.SheetCopyResponse,{COPIEDSPREADSHEETNAME:i,RID:e.di,VERSION:t}),u.qaid=e.qaid}),A.addEventListeners("onError",function(e){E.publish(r.Listener,S.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(a.SAVEAS),A.send(c)}}(this);
!function(e){var n=e.sPlusPlus,s=e.ZSConstants,t=s.ActionConstants,i=e.ZSClass.ActionObject,o=e.ZSEvents,E=o.topic,a=o.Groups,r=o.Names,A=s.URI,R=n.SML.Client.Utility.WorkerRequest;e.UserAction.saveAsTemplate=function(e,n,s){var o={RID:e,newDocName:s,VERSION:n},S=new i(t.SAVEAS_NEW_TEMPLATE,o),c=new R;c.addEventListeners("onComplete",function(e){E.publish(a.Listener,r.UserAction.SaveAsTemplateResponse,{NEWDOCNAME:s,NEWDOCRID:e.di,VERSION:n}),S.qaid=e.qaid}),c.addEventListeners("onError",function(e){E.publish(a.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),c.open(A.SAVE_AS_TEMPLATE),c.send(o)}}(this);
!function(e){var t=e.sPlusPlus.SML.Client,s=e.ZSConstants.URI,r=e.ZSDevTools.Logger,n=t.Utility.WorkerRequest,o=e.ZSEvents,i=o.topic,R=o.Groups,a=o.Names;UserAction.createForm=function(e,t,o,E,l,u){var m={RID:e,sheetList:new ZSClass.ParamGenerator(t,e,o).getSheets(),VERSION:o,formName:E,formDesc:l,sheetName:u},S=new n;S.addEventListeners("onError",function(e){r.log("CreateForm error :",e)}),S.addEventListeners("onComplete",function(e){if(e.mt)i.publish(R.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk});else if(e.result){var t=e.result.form_rid;i.publish(R.Listener,a.UserAction.CREATE_FORM_RESPONSE,{FORM_RID:t,FORM_NAME:E})}}),S.open(s.FORM_CREATE),S.send(m)}}(this);
!function(e){var t=e.sPlusPlus,n=t.SML.Client,o=e.ZSConstants.URI,r=e.ZSDevTools.Logger,i=n.Utility.WorkerRequest;UserAction.deleteForm=function(e,n,s,u){var E=t.view.getActiveGridID(),d={RID:e,SHEETID:n,VERSION:t.view.getVersionID(E),formRid:u},l=new i;l.addEventListeners("onError",function(e){r.log("AutoSum error :",e)}),l.addEventListeners("onComplete",function(e){}),l.open(o.FORM_DELETE),l.send(d)}}(this);
!function(t){var n=t.sPlusPlus,s=n.SML.Client,e=t.ZSConstants.URI,o=t.ZSDevTools.Logger,i=s.Utility.WorkerRequest,r=ZSConstants.CommandConstants;UserAction.getActionList=function(t,s,a,l,E){var I={RID:t,VERSION:s,showAll:a,withMeta:l},c=new i;c.addEventListeners("onError",function(t){o.log("AuditTrail error :",t)}),c.addEventListeners("onComplete",function(t){n.view.actionListManager.setTimeZone(t.lists[r.TIME_ZONE]),E(t.lists[r.USER_INFO],t.lists[r.SHEET_LIST],t.lists[r.ACTION_LIST])}),c.open(e.GET_ACTION_LIST),c.send(I)},UserAction.clearActionList=function(t,n,s){var r={RID:t,SHEETID:n,VERSION:s},a=new i;a.addEventListeners("onError",function(t){o.log("ClearActionList error :")}),a.open(e.CLEAR_ACTION_LIST),a.send(r)}}(this);
!function(e){var t=e.sPlusPlus.SML.Client,n=e.ZSConstants.URI,r=e.ZSDevTools.Logger,o=t.Utility.WorkerRequest;UserAction.AuditFilterBySheet=function(e,t,i,s){var d={RID:e,VERSION:t,sheetName:i},a=new o;a.addEventListeners("onError",function(e){r.log("AuditTrailFilter error :",e)}),a.addEventListeners("onComplete",function(e){s(e.reverse())}),a.open(n.AUDIT_FILTER_BY_SHEET),a.send(d)},UserAction.AuditFilterByRange=function(e,t,i,s){var d={RID:e,VERSION:t,rangeText:i},a=new o;a.addEventListeners("onError",function(e){r.log("AuditTrailFilter error :",e)}),a.addEventListeners("onComplete",function(e){s(e.reverse())}),a.open(n.AUDIT_FILTER_BY_RANGE),a.send(d)},UserAction.AuditFilterByDate=function(e,t,i,s,d,a){var l={RID:e,VERSION:t,fromDate:s,toDate:d,dateType:i},u=new o;u.addEventListeners("onError",function(e){r.log("AuditTrailFilter error :",e)}),u.addEventListeners("onComplete",function(e){a(e.reverse())}),u.open(n.AUDIT_FILTER_BY_DATE),u.send(l)}}(this);
!function(e){var n=e.sPlusPlus,o=n.SML.Client,t=e.ZSConstants.URI,s=e.ZSDevTools.Logger,i=o.Utility.WorkerRequest;UserAction.renameVersion=function(e,o,r,a){var c=n.view.actionListManager.actionList,v=(Object.keys(c),{RID:e,VERSION:o,versionNo:o,versionName:r}),u=new i;u.addEventListeners("onError",function(e){s.log("Rename version error :",e)}),u.addEventListeners("onComplete",function(e){a()}),u.open(t.RENAME_VERSION),u.send(v)}}(this);
!function(e){var n=e.sPlusPlus.SML.Client,r=e.ZSConstants.URI,s=e.ZSDevTools.Logger,o=n.Utility.WorkerRequest,t=e.ZSEvents,i=t.topic,R=t.Groups,u=t.Names;UserAction.revertVersion=function(e,n,t){var v={RID:e,VERSION:n,versionNo:n},E=new o;E.addEventListeners("onError",function(e){t&&t.remove(),s.log("Rename version error :",e),i.publish(R.Listener,u.ERROR.SHOW,{ERRORMSG:e.mk})}),E.open(r.REVERT_VERSION),E.send(v)}}(this);
!function(e){var n=e.sPlusPlus.SML.Client,o=e.ZSConstants.URI,t=e.ZSDevTools.Logger,s=n.Utility.WorkerRequest;UserAction.deleteVersion=function(e,n,r){var i={RID:e,VERSION:n,versionNo:n},l=new s;l.addEventListeners("onError",function(e){t.log("Delete version error :",e)}),l.addEventListeners("onComplete",function(e){r()}),l.open(o.DELETE_VERSION),l.send(i)}}(this);
!function(e){var t=e.sPlusPlus,n=(e.UserAction,e.ZSConstants.URI),s=e.ZSEvents,o=(s.topic,s.Groups,s.Names,t.SML.Client.Utility.WorkerRequest),r=e.ZSConstants.ActionConstants;e.UserAction.downloadAs=function(t,n,s,o,a){var i=new ZSClass.AjaxRequest(t,n),u={params:["rid","currentSheet","version","ftype","responseType"],paramVal:[t,s,"",o,"base64String"],URL:"export",action:r.EXPORT_DOCUMENT},R=new e.ZSClass.RequestParameters(u),c={formObj:{},handleFiledownload:!0,method:"POST",URL:R.getURL(t),params:R.getParametersAsString(t,n),csrf:!0,respType:"text"};i.init(null,c),i.sendRequest()},e.UserAction.ExportDocument=function(e,t,s,r){var a={RID:e,SHEETID:t,VERSION:s},i=new o;i.addEventListeners("onComplete",function(e){r&&r(e)}),i.addEventListeners("onRequestTimeOut",function(e){Logger.log("WORKER REQUEST TIMEOUT")}),i.open(n.EXPORT_DOCUMENT),i.send(a)}}(this);
!function(e){var n=e.sPlusPlus,s=e.ZSConstants,t=e.ZSEvents,o=t.topic,i=t.Groups,r=t.Names,R=n.SML.Client.Utility.WorkerRequest,a=e.ZSClass.ActionObject,E=s.ActionConstants,c=s.URI,S=s.I18N;e.UserAction.CreateVersion=function(s,t,l){n.data.getWorkBook(s,t);var u=e.encodeURIComponent,C={RID:s,VERSION:t,label:u(l)},I=(new a(E.CREATE_VERSION,C),new R);I.addEventListeners("onComplete",function(e){new ZSClass.TBNotification(S["Version.infoMessage"],{type:"info"}).show(),o.publish(i.Listener,r.UserAction.CreateVersionResponse,{VERSION_NAME:l,RID:s,VERSION:t})}),I.addEventListeners("onError",function(e){o.publish(i.Listeners,r.ERROR.SHOW,{ERRORMSG:e.mk})}),I.open(c.CREATE_VERSION),I.send(C)}}(this);
!function(e){var a=e.sPlusPlus,r=e.ZSEvents,t=r.topic,n=r.Groups,s=r.Names,i=e.ZSClass,c=e.JSUtil,l=e.UserAction,o=c.REGEXP,u=o.matchRegex,v=o.rangeRegex;l.PlacePrecedance=function(r,l,o,R,g){var E=a.view.getActiveGridID();a.view.fetchCellData(r,l,o,R,g,["Formula"],E,function(e){var a=e[R][g].Formula;!function(e,a,r,l,o,R){var g=new i.Range(l,o,l,o);if(t.publish(n.Listener,s.Layers.Precedance.Remove,{RID:e,SHEETID:a,VERSION:r}),R){if(!R.startsWith("="))return;var E=R.match(u),f=0;for(var I in E){var h=E[I];if(v.test(h)){var D=c.Range.parseRange(e,r,h);D&&D.sheetID===a&&t.publish(n.Listener,s.Layers.Precedance.Place,{RID:e,SHEETID:a,VERSION:r,ID:f++,RANGE:D.range,CELL:g})}}}}(r,l,o,R,g,a)},function(a){e.ZSClass.Logger.log("Couldnt retrieve cell content",a)})}}(this);
!function(e){var t,s,n=e.sPlusPlus,a=e.ZSEvents,r=a.topic,i=a.Groups,o=a.Names,c=e.ZSConstants,u=!1,d=["PT","BR","CN","TW"];function p(e,a,p){if(!u||t!=a||s!=p&&-1!=d.indexOf(p)){var l=a+"_"+p,f=n.data.UserInfo.locale,h=a==f,N=n.data.AppRegistry.FUNCTION_URL;t=a,s=p;var C=N&&N.endsWith(".js");if(h&&C){var T=document.createElement("script");return T.type="text/javascript",T.src=N,document.body.appendChild(T),!1}var v=h?"GET":"POST",O=h?N:"/sheet/fetchfunction.do",U=new XMLHttpRequest;U.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(this.responseText);c.Function=e,u=!1,r.publish(i.Listener,o.DocAction.FUNCTIONS.FETCH,{JSON:e})}},U.open(v,O,!0),U.setRequestHeader("Content-type","application/x-www-form-urlencoded");var E="userlocale="+f+"&doclocale="+l;U.send(E),u=!0}}r.register(i.Listener,o.DocMeta.DOCUMENT_LOCALE,p,"RID","LANGUAGE","COUNTRY"),e.UserAction.fetchFunction=p}(this);
!function(e){var n=e.sPlusPlus.SML.Client,o=e.ZSConstants.URI,s=e.ZSDevTools.Logger,t=n.Utility.WorkerRequest;UserAction.publishForm=function(e,n,i,r,u,l,S){var c={RID:e,SHEETID:n,formRid:r,publishType:u,isPublish:l,VERSION:i},d=new t;d.addEventListeners("onError",function(e){s.log("AutoSum error :",e)}),d.addEventListeners("onComplete",function(e){S&&S(u)}),d.open(o.FORM_PUBLISH),d.send(c)}}(this);
!function(n){var e=n.sPlusPlus,t=e.SML.Client,i=n.ZSConstants.URI,s=n.ZSDevTools.Logger,o=t.Utility.WorkerRequest,r=ZSConstants.CommandConstants;UserAction.getVersionDetails=function(n,t,a,c){var d={RID:n,VERSION:t,isActionListRequired:e.view.actionListManager.isEmpty(),isNamedVersionOnly:a},E=new o;E.addEventListeners("onError",function(n){s.log("VersionHistory error :",n)}),E.addEventListeners("onComplete",function(n){n.lists&&(e.view.actionListManager.setTimeZone(n.lists[r.TIME_ZONE]),e.view.actionListManager.appendAction(n.lists[r.ACTION_LIST])),c(n.vi)}),E.open(i.GET_VERSION_DETAILS),E.send(d)},UserAction.getActionListBasedOnVersion=function(n,t,a,c,d){var E={RID:n,VERSION:t,versionNumber:a},L=new o;L.addEventListeners("onError",function(n){s.log("VersionHistory error :",n)}),L.addEventListeners("onComplete",function(n){n=n.lists[r.ACTION_LIST],d&&e.view.actionListManager.appendAction(n),c(n)}),L.open(i.GET_VERSION_ACTION_LIST),L.send(E)}}(this);
!function(e){var t=e.sPlusPlus,n=t.SML.Client.Utility.WorkerRequest,o=e.ZSConstants.URI,i=e.ZSDevTools.Logger,s=e.ZSEvents,a=s.topic,r=s.Groups,E=s.Names;var S=new(0,ZSClass.PageReplacement)(t.data.Defaults.MAX_WORKBOOK_LIMIT);e.UserAction.LoadVersion=function(e,s,v,I,l){var R=t.data.getWorkBook(e,v),A=!1;if(R){var C,c=R.getSheetObj(s);if(!c){var d=R.SheetList.getSheets()[0];s=d.getID(),c=R.getSheetObj(s)}if(c.Visited){A=!0;var T=t.view.getActiveGridID(),g=t.view.getSheetState(T,s),D=g.getActiveRow(),u=g.getActiveCol(),O=g.getActiveRange(),f=g.getScrollTops(),N=g.getScrollLefts(),h=f[0],L=N[0],V=c.Row.FreezedCount,m=c.Column.FreezedCount,p=0,_=0;(V>0||m>0)&&(p=f[1],_=f[1]),C={activeCell:[D,u],activeRange:[[O.startRow,O.startCol,O.endRow,O.endCol]],persisted_pos:[[h,L],[p,_]]}}}var w=new n,H={RID:e,SHEET_ID:s,VERSION:v,isAvailable:A,activeInfo:C};if(v!==t.data.Defaults.version){var M=S.add(v);if(M){var P=M.data,b=t.data.DocRegistry;b[e]&&b[e][P]&&delete b[e][P]}}var Z=t.view.getSheetID(t.view.getActiveGridID()),U=t.view.getVersionID(t.view.getActiveGridID());a.publish(r.UserAction,E.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,{RID:e,SHEETID:Z,VERSION:U,TARGET_SHEET:s}),w.addEventListeners("onError",function(e){i.log("LoadVersion error :",e)}),w.addEventListeners("onComplete",function(n){!function(e,t,n,o){if(o[ZSConstants.CommandConstants.DOCUMENT_META]){a.publish(r.Listener,E.ServerAction.PROCESSRESPONSE,{RESPONSE:o,VERSION:n});var i=o[ZSConstants.CommandConstants.DOCUMENT_META];for(var s in i){var S=i[s][ZSConstants.CommandConstants.ACTIVE_INFO];S&&(t=S[ZSConstants.CommandConstants.ACTIVESHEET_NAME],a.publish(r.Listener,E.SheetAction.CHARTS.REPAINT,{RID:e,SHEETID:t,VERSION:n}),a.publish(r.Listener,E.SheetAction.BUTTONS.REPAINT,{RID:e,SHEETID:t,VERSION:n}),a.publish(r.Listener,E.SheetAction.IMAGES.REPAINT,{RID:e,SHEETID:t,VERSION:n}))}}}(e,s,v,n),I&&function(e){for(var n=S.getListAsArray(),o=t.data.DocRegistry[e],i=n.length-1;i>=0;i--)delete o[n[i]];S.removeAll()}(e),l&&l(n)}),w.open(o.VERSION_FETCH_DATA),w.send(H)}}(this);
!function(e){var n=e.sPlusPlus.SML.Client,t=e.ZSConstants.URI,o=(e.ZSDevTools.Logger,n.Utility.WorkerRequest);e.UserAction.createMacro=function(e,n,s,r,i){var R={RID:e,VERSION:n,MACRONAME:s,MACRODESCRIPTION:r},c=new o;c.addEventListeners("onError",function(e){i&&i(e)}),c.addEventListeners("onComplete",function(e){i&&i(e)}),c.open(t.CREATE_MACRO),c.send(R)}}(this);
!function(e){var n=e.sPlusPlus.SML.Client,r=e.ZSConstants.URI,o=e.ZSDevTools.Logger,t=n.Utility.WorkerRequest,E=e.UserAction;E.recordMacro=function(e,n,E,s,c,i,R,a,C,d,u){var I=new ZSClass.ParamGenerator(i,e,E,!0,!0);R=I.getCustomRanges(R);var O={RID:e,VERSION:E,MACRONAME:s,MACRODESCRIPTION:c,SHEETLIST:I.getSheets(),ACTIVERANGE:R,ACTIVEROW:a,ACTIVECOL:C,ISRELATIVEREFERENCE:d},l=new t;l.addEventListeners("onError",function(e){o.log("Error while executing record macro: ",e)}),l.addEventListeners("onComplete",function(e){u&&u(e)}),l.open(r.RECORD_MACRO),l.send(O)},E.cancelRecordingMacro=function(e,n){var E={RID:e,VERSION:n},s=new t;s.addEventListeners("onError",function(e){o.log("Error while executing cancel recording macro: ",e)}),s.open(r.CANCEL_RECORDING_MACRO),s.send(E)},E.stopRecordingMacro=function(e,n,E,s){var c={RID:e,VERSION:n,RECORDOBJ:E},i=new t;i.addEventListeners("onError",function(e){o.log("Error while executing stop recording macro: ",e)}),i.addEventListeners("onComplete",function(e){s&&s(e)}),i.open(r.STOP_RECORDING_MACRO),i.send(c)}}(this);
!function(e){var n=e.sPlusPlus.SML.Client,t=e.ZSConstants.URI,r=e.ZSDevTools.Logger,E=n.Utility.WorkerRequest,o=e.UserAction,s=e.ZSConstants.CommandConstants;o.getMacroList=function(e,n,o,s){var a={RID:e,VERSION:n,SHEETLIST:new ZSClass.ParamGenerator(o,e,n,!0,!0).getSheets()},i=new E;i.addEventListeners("onError",function(e){r.log("Error while executing getMacroList : ",e)}),i.addEventListeners("onComplete",function(e){s(e,!1)}),i.open(t.GET_MACRO_LIST),i.send(a)},o.runMacro=function(e,n,o,a,i,S,T,M,C){var R=new ZSClass.ParamGenerator(S,e,o,!0,!0);M=R.getCustomRanges(M);var A=R.getSheets(),I={RID:e,SHEETID:n,VERSION:o,MODULENAME:a,MACRONAME:i,SHEETLIST:A,ACTIVERANGE:M,CURRSHEETNAME:T},L=new E;L.addEventListeners("onError",function(e){r.log("Error while runnning macro: ",e)}),L.addEventListeners("onComplete",function(t){var r=t[s.SYNC_RESPONSE];if(r&&r[s.DOCUMENT_META]){var E=r[s.DOCUMENT_META][e];if(E&&E[s.SHEET_META]){var a=E[s.SHEET_META][n];if(a&&a[s.RANGE_HIGHLIGHT])var i=a[s.RANGE_HIGHLIGHT][0][0],S=a[s.RANGE_HIGHLIGHT][0][1]}}C&&C(e,n,o,i,S)}),L.open(t.RUN_MACRO),L.send(I)},o.deleteMacro=function(e,n,o,s,a,i,S,T){var M={RID:e,SHEETID:n,VERSION:o,SHEETLIST:new ZSClass.ParamGenerator(s,e,o,!0,!0).getSheets(),MODULENAME:a,MACRONAME:i},C=new E;C.addEventListeners("onError",function(e){r.log("Error while deleting macro: ",e)}),C.addEventListeners("onComplete",function(e){S&&S(e,T)}),C.open(t.DELETE_MACRO),C.send(M)}}(this);
!function(e){var n=e.sPlusPlus.SML.Client,E=e.ZSConstants.URI,r=e.ZSDevTools.Logger,t=n.Utility.WorkerRequest,o=e.UserAction,a=e.ZSConstants.CommandConstants;o.saveMacro=function(e,n,o,a,s,i,N){var T={RID:e,SHEETID:a,VERSION:n,SHEETLIST:new ZSClass.ParamGenerator(o,e,n,!0,!0).getSheets(),MODULECONTENT:s},S=new t;S.addEventListeners("onError",function(e){r.log("Error while executing save macro: ",e)}),S.addEventListeners("onComplete",function(e){i&&i(e,N)}),S.open(E.SAVE_MACRO),S.send(T)},o.saveAndRunMacro=function(e,n,o,s,i,N,T,S,M,R,I){var C=new ZSClass.ParamGenerator(N,e,o,!0,!0),A=(T=C.getCustomRanges(T),C.getSheets()),L={RID:e,SHEETID:n,VERSION:o,MODULENAME:s,MODULECONTENT:i,SHEETLIST:A,ACTIVERANGE:T,LINENUMBER:S,CURRSHEETNAME:M},u=new t;u.addEventListeners("onError",function(e){r.log("Error while executing save and run macro: ",e)}),u.addEventListeners("onComplete",function(E){var r=E[a.SYNC_RESPONSE];if(r&&r[a.DOCUMENT_META]){var t=r[a.DOCUMENT_META][e];if(t&&t[a.SHEET_META]){var s=t[a.SHEET_META][n];if(s&&s[a.RANGE_HIGHLIGHT])var i=s[a.RANGE_HIGHLIGHT][0][0],N=s[a.RANGE_HIGHLIGHT][0][1]}}R&&R(e,n,o,E,i,N,I)}),u.open(E.SAVE_AND_RUN_MACRO),u.send(L)},o.getMacroEditorInfo=function(e,n,o,a,s,i,N){var T={RID:e,VERSION:n,SHEETLIST:new ZSClass.ParamGenerator(o,e,n,!0,!0).getSheets()};a&&s&&(T.MODULENAME=a,T.MACRONAME=s);var S=new t;S.addEventListeners("onError",function(e){r.log("Error while executing getMacroEditorInfo : ",e)}),S.addEventListeners("onComplete",function(e){i&&i(e[0],e[1],N)}),S.open(E.MACRO_EDITOR_INFO),S.send(T)},o.runMacroByLineNumber=function(e,n,o,s,i,N,T,S,M,R,I){var C=new ZSClass.ParamGenerator(T,e,o,!0,!0);M=C.getCustomRanges(M);var A=C.getSheets(),L={RID:e,SHEETID:n,VERSION:o,MODULENAME:s,MODULECONTENT:i,SHEETLIST:A,ACTIVERANGE:M,LINENUMBER:N,CURRSHEETNAME:S},u=new t;u.addEventListeners("onError",function(e){r.log("Error while executing run macro: ",e)}),u.addEventListeners("onComplete",function(E){var r=E[a.SYNC_RESPONSE];if(r&&r[a.DOCUMENT_META]){var t=r[a.DOCUMENT_META][e];if(t&&t[a.SHEET_META]){var s=t[a.SHEET_META][n];if(s&&s[a.RANGE_HIGHLIGHT])var i=s[a.RANGE_HIGHLIGHT][0][0],N=s[a.RANGE_HIGHLIGHT][0][1]}}R&&R(e,n,o,E,i,N,I)}),u.open(E.RUN_MACRO_BY_LINE_NUMBER),u.send(L)},o.pullMacroContent=function(e,n,o,a,s,i){var N={RID:e,SHEETID:n,VERSION:o,MODULENAMES:a,ACTIONOWNER:s},T=new t;T.addEventListeners("onError",function(e){r.log("Error while executing run macro: ",e)}),T.addEventListeners("onComplete",function(e){i&&i(e)}),T.open(E.PULL_MACRO_CONTENT),T.send(N)}}(this);
!function(e){var t=e.sPlusPlus,n=(t.SML.Client,e.ZSEvents),o=n.topic,s=n.Groups,i=n.Names,r=e.Math,S=t.SML.Client.Utility.WorkerRequest,O=(e.ZSConstants.ActionConstants,e.ZSClass.ActionObject,e.ZSConstants.URI);e.UserAction.Zoom=function(e,t,n,S,O,c,l,u,E,a,I){o.publish(s.Selector.BoundUpdate.CellEdit,i.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:n,isSubmittable:!0}),c=r.round(c/S*O),l=r.round(l/S*O),u=r.round(u/S*O),E=r.round(E/S*O),o.publish(s.Listener,i.SheetAction.ZOOM.OnBefore,{RID:e,SHEETID:t,VERSION:n}),o.publish(s.Listener,i.SheetAction.ZOOM.On,{RID:e,SHEETID:t,VERSION:n,ZOOM:O,sTop:l,sLeft:c,fsTop:E,fsLeft:u}),UserAction.UpdateScreenViewPort(e,t,n),UserAction.UpdateContentViewport(e,t,n),UserAction.ScrollTo(e,t,n,c,l,u,E),o.publish(s.Listener,i.SheetAction.ZOOM.OnEnd),o.publish(s.Listener,i.SheetAction.CHARTS.REPAINT,{RID:e,SHEETID:t,VERSION:n,ZOOM:!0})},e.UserAction.setZoom=function(t,n,o,s,i,r,c,l,u,E,a){var I={RID:t,sheetList:new e.ZSClass.ParamGenerator(o,t,s,!0,!0).getSheets(),VERSION:s,zoomValue:100*i},p=new S;p.addEventListeners("onComplete",function(e){}),p.open(O.ZOOM),p.send(I)}}(window);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,o=n.topic,r=n.Groups,s=n.Names,a=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),E=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI,I=t.SML.Client.Utility.WorkerRequest,S=e.UserAction;S.CLEARALL=function(e,n,S){var d=E.CLEARALL,c=(t.data.getWorkBook(e,S),t.view.getActiveGridID()),A=t.view.getSheetID(c),L=(t.view.getActiveState(c),new i.ParamGenerator(n,e,S,!0,!0)),l=L.getSheets(),g=L.getRanges(),C=L.getActiveCell(),v={RID:e,sheetList:l,rangeList:g,activeCell:C,action:d,VERSION:S},O=new a(d,v),T=g[JSUtil.fn.getIndexOf(A,l)];o.publish(r.Listener,s.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:S});var D=new I(!0);D.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,s.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:S,ACTION:d,RANGELIST:T})}),D.addEventListeners("onComplete",function(e){e.qaid,O.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(O)}),D.addEventListeners("onError",function(e){o.publish(r.Listener,s.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(R.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(D,O),D.send(v)},S.CLEARSTYLES=function(e,n,S){var d=E.CLEARSTYLES,c=(t.data.getWorkBook(e,S),t.view.getActiveGridID()),A=t.view.getSheetID(c),L=(t.view.getActiveState(c),new i.ParamGenerator(n,e,S,!0,!0)),l=L.getSheets(),g=L.getRanges(),C=L.getActiveCell(),v={RID:e,sheetList:l,rangeList:g,activeCell:C,action:d,VERSION:S},O=new a(d,v),T=g[JSUtil.fn.getIndexOf(A,l)];o.publish(r.Listener,s.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:S});var D=new I(!0);D.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,s.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:S,ACTION:d,RANGELIST:T})}),D.addEventListeners("onComplete",function(e){e.qaid,O.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(O)}),D.addEventListeners("onError",function(e){o.publish(r.Listener,s.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(R.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(D,O),D.send(v)},S.CLEARCONTENTS=function(e,n,S){var d=E.CLEARCONTENTS,c=(t.data.getWorkBook(e,S),t.view.getActiveGridID()),A=t.view.getSheetID(c),L=(t.view.getActiveState(c),new i.ParamGenerator(n,e,S,!0,!0)),l=L.getSheets(),g=L.getRanges(),C=L.getActiveCell();o.publish(r.Listener,s.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:S});var v={RID:e,sheetList:l,rangeList:g,activeCell:C,action:d,VERSION:S},O=new a(d,v),T=g[JSUtil.fn.getIndexOf(A,l)],D=new I(!0);D.addEventListeners("onAcknowledge",function(){o.publish(r.Listener,s.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:S,ACTION:d,RANGELIST:T})}),D.addEventListeners("onComplete",function(e){e.qaid,O.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(O)}),D.addEventListeners("onError",function(e){o.publish(r.Listener,s.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(R.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(D,O),D.send(v)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=n.topic,s=n.Groups,r=n.Names,o=e.ZSDevTools.Logger,a=t.SML.Client,R=t.data.Defaults,E=a.Utility.WorkerRequest,S=e.ZSClass.ActionObject,I=e.ZSConstants.ActionConstants,c=(ZSClass.SelectorHelper.Constants,e.ZSConstants.URI),l=ZSConstants.I18N;e.UserAction.ResizeRow=function(n,a,l,d,O,C,D,g){if(d<0)o.log('Dimension "'+d+'" Less than Zero, RESIZE NOT POSSIBLE');else{var v=t.view.getActiveGridID(),A=t.view.getSheetID(v),L=O+C-1,T=new e.ZSClass.ParamGenerator(a,n,l,g,!0),u=T.getSheets(),N=new ZSClass.Range(O,0,L,R.MAX_COL-1),_=g?T.getRanges():T.getCustomRanges(N),w=T.getActiveCell(),h={RID:n,sheetList:u,rangeList:_,activeCell:w,value:d,VERSION:l,ISOPTIMAL:D=D||!1,action:I.HEIGHT},f=new S(I.HEIGHT,h,d);i.publish(s.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:A,VERSION:l});var p=new E(!0);D||p.addEventListeners("onAcknowledge",function(){var e=JSUtil.fn.getIndexOf(A,u),t=_[e];i.publish(s.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:n,SHEETID:A,ACTION:"RESIZEROW",VERSION:l,RANGELIST:t,VALUE:d})}),p.addEventListeners("onComplete",function(e){var n=e.qaid;f.qaid=n,t.data.UserInfo.ActionRecorder.record(f)}),p.addEventListeners("onError",function(e){i.publish(s.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(c.ROW_HEADERS_RESIZE),t.data.UserInfo.registerForRepeat(p,f),p.send(h)}},e.UserAction.InsertRow=function(n,o,a,R,l){var d=new e.ZSClass.ParamGenerator(o,n,a,!0,!0),O=d.getSheets(),C=(R=d.getCustomRanges(R,!0),d.getActiveCell()),D={RID:n,sheetList:O,activeCell:C,action:I.INSERT_ROW,rangeList:R,VERSION:a,isAbove:l},g=t.view.getActiveGridID(),v=t.view.getSheetID(g),A=t.view.getSheetState(g,v).getRanges();A=d.getCustomRanges(A,!0);var L={RID:n,sheetList:O,activeCell:C,action:I.INSERT_ROW,rangeList:A,VERSION:a,isAbove:l};i.publish(s.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:v,VERSION:a});var T=new S(I.INSERT_ROW,L),u=new E(!0);u.addEventListeners("onComplete",function(e){i.publish(s.Selector.ReDraw,r.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:n,VERSION:a,qaid:e.qaid}),T.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(T)}),u.addEventListeners("onError",function(e){i.publish(s.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(c.ROW_HEADERS_INSERT),t.data.UserInfo.registerForRepeat(u,T),u.send(D)},e.UserAction.DeleteRow=function(n,o,a,R){var d=new e.ZSClass.ParamGenerator(o,n,a,!0,!0),O=d.getSheets(),C=(R=d.getCustomRanges(R,!0),d.getActiveCell()),D={RID:n,sheetList:O,action:I.DELETE_ROW,rangeList:R,activeCell:C,VERSION:a},g=t.view.getActiveGridID(),v=t.view.getSheetID(g);i.publish(s.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:v,VERSION:a});var A=new S(I.DELETE_ROW,D),L=new E(!0);L.addEventListeners("onComplete",function(e){i.publish(s.Selector.ReDraw,r.Selection.BOUND_UPDATE.SHIFT.ONDELETE,{RID:n,VERSION:a,qaid:e.qaid}),A.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(A)}),L.addEventListeners("askConfirm",function(e){var t=new ZSClass.ZSConfirm(JSUtil.fn.replaceParams(l[e.mk],new Array(e.mc+"")));t.onYES(function(){L.resend()});var n=t.execute();i.publish(s.Listener,r.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),L.addEventListeners("onError",function(e){i.publish(s.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),L.open(c.ROW_HEADERS_DELETE),t.data.UserInfo.registerForRepeat(L,A),L.send(D)},e.UserAction.InsertCutRow=function(n,o,a,R,l,d){var O=new e.ZSClass.ParamGenerator(o,n,a,!0,!0),C=O.getSheets();R=O.getCustomRanges(R,!0),d&&(d=O.getCustomRanges(d,!0));var D=O.getActiveCell(),g={RID:n,rangeList:R,isDragDrop:l,action:I.INSERT_CUT_ROW,activeCell:D,VERSION:a,sheetList:C,srcRangeList:d},v=new S(I.INSERT_CUT_ROW,g),A=new E(!0),L=t.view.getActiveGridID(),T=t.view.getSheetID(L);i.publish(s.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:T,VERSION:a}),A.addEventListeners("onComplete",function(e){i.publish(s.Selector.ReDraw,r.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:n,VERSION:a,qaid:e.qaid}),v.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(v)}),A.addEventListeners("onError",function(e){i.publish(s.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(c.ROW_HEADERS_INSERT_CUT),A.send(g)},e.UserAction.InsertCopyRow=function(n,o,a,R,l){var d=new e.ZSClass.ParamGenerator(o,n,a,!0,!0),O=d.getSheets(),C=(R=d.getCustomRanges(R,!0),d.getActiveCell()),D={RID:n,rangeList:R,sheetList:O,activeCell:C,action:I.INSERT_COPY_ROW,isSameSheet:l,VERSION:a},g=new S(I.INSERT_COPY_ROW,D),v=new E(!0),A=t.view.getActiveGridID(),L=t.view.getSheetID(A);i.publish(s.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:L,VERSION:a}),v.addEventListeners("onComplete",function(e){i.publish(s.Selector.ReDraw,r.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:n,VERSION:a,qaid:e.qaid}),g.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(g)}),v.addEventListeners("onError",function(e){i.publish(s.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(c.ROW_HEADERS_INSERT_COPY),v.send(D)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,r=n.topic,s=n.Groups,o=n.Names,a=t.data.Defaults,E=e.ZSDevTools.Logger,R=t.SML.Client.Utility.WorkerRequest,S=e.ZSClass.ActionObject,I=e.ZSConstants.ActionConstants,c=(i.SelectorHelper.Constants,e.ZSConstants.URI),l=ZSConstants.I18N;e.UserAction.DeleteCol=function(e,n,a,E){var d=t.view.getActiveGridID(),C=t.view.getSheetID(d);r.publish(s.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:C,VERSION:a});var D=new i.ParamGenerator(n,e,a,!0,!0),O=D.getSheets(),L=(E=D.getCustomRanges(E,!0),D.getActiveCell()),g={RID:e,sheetList:O,activeCell:L,action:I.DELETE_COL,rangeList:E,VERSION:a},v=new S(I.DELETE_COL,g),A=new R(!0);A.addEventListeners("onComplete",function(n){r.publish(s.Selector.ReDraw,o.Selection.BOUND_UPDATE.SHIFT.ONDELETE,{RID:e,qaid:n.qaid}),v.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(v)}),A.addEventListeners("askConfirm",function(e){var t=new i.ZSConfirm(JSUtil.fn.replaceParams(l[e.mk],new Array(e.mc+"")));t.onYES(function(){A.resend()});var n=t.execute();r.publish(s.Listener,o.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),A.addEventListeners("onError",function(e){r.publish(s.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(c.COLUMN_HEADERS_DELETE),t.data.UserInfo.registerForRepeat(A,v),A.send(g)},e.UserAction.ResizeCol=function(e,n,l,d,C,D,O,L,g){var v=t.view.getActiveGridID(),A=t.view.getSheetID(v);if(r.publish(s.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:l}),d<0)E.log('Dimension "'+d+'" Less than Zero, RESIZE NOT POSSIBLE');else{v=t.view.getActiveGridID(),A=t.view.getSheetID(v),O=O||!1;var T=C+D-1,u=new i.ParamGenerator(n,e,l,L,!0),N=u.getSheets(),_=new i.Range(0,C,a.MAX_ROW-1,T),U=L?u.getRanges():u.getCustomRanges(_),f=u.getActiveCell(),h={RID:e,value:d,sheetList:N,rangeList:U,activeCell:f,VERSION:l,action:I.WIDTH,ISOPTIMAL:O},p=new S(I.WIDTH,h,d);r.publish(s.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:A,VERSION:l});var w=new R(!0);O||w.addEventListeners("onAcknowledge",function(){var t=JSUtil.fn.getIndexOf(A,N),n=U[t];r.publish(s.Listener,o.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:A,VERSION:l,ACTION:"RESIZECOL",RANGELIST:n,VALUE:d})}),w.addEventListeners("onComplete",function(e){g&&g();var n=e.qaid;p.qaid=n,t.data.UserInfo.ActionRecorder.record(p)}),w.addEventListeners("onError",function(e){r.publish(s.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),w.open(c.COLUMN_HEADERS_RESIZE),t.data.UserInfo.registerForRepeat(w,p),w.send(h)}},e.UserAction.InsertCol=function(e,n,a,E,l){var d=t.view.getActiveGridID(),C=t.view.getSheetID(d);r.publish(s.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:C,VERSION:a});var D=new i.ParamGenerator(n,e,a,!0,!0),O=D.getSheets(),L=(E=D.getCustomRanges(E,!0),D.getActiveCell()),g={RID:e,rangeList:E,action:I.INSERT_COL,activeCell:L,VERSION:a,sheetList:O,isBefore:l},v=new S(I.INSERT_COL,g),A=new R(!0);A.addEventListeners("onComplete",function(n){r.publish(s.Selector.ReDraw,o.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:e,VERSION:a,qaid:n.qaid}),v.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(v)}),A.addEventListeners("onError",function(e){r.publish(s.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(c.COLUMN_HEADERS_INSERT),t.data.UserInfo.registerForRepeat(A,v),A.send(g)},e.UserAction.InsertCutCol=function(e,n,a,E,l,d){var C=t.view.getActiveGridID(),D=t.view.getSheetID(C);r.publish(s.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:D,VERSION:a});var O=new i.ParamGenerator(n,e,a,!0,!0),L=O.getSheets();E=O.getCustomRanges(E,!0),d&&(d=O.getCustomRanges(d,!0));var g=O.getActiveCell(),v={RID:e,rangeList:E,srcRangeList:d,action:I.INSERT_CUT_COLUMN,activeCell:g,sheetList:L,VERSION:a,isDragDrop:l},A=new S(I.INSERT_CUT_COLUMN,v),T=new R(!0);T.addEventListeners("onComplete",function(n){r.publish(s.Selector.ReDraw,o.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:e,qaid:n.qaid}),A.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(A)}),T.addEventListeners("onError",function(e){r.publish(s.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),T.open(c.COLUMN_HEADERS_INSERT_CUT),T.send(v)},e.UserAction.InsertCopyCol=function(e,n,a,E,l){var d=t.view.getActiveGridID(),C=t.view.getSheetID(d);r.publish(s.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:C,VERSION:a});var D=new i.ParamGenerator(n,e,a,!0,!0),O=D.getSheets(),L=(E=D.getCustomRanges(E,!0),D.getActiveCell()),g={RID:e,rangeList:E,activeCell:L,action:I.INSERT_COPY_COLUMN,sheetList:O,isSameSheet:l,VERSION:a},v=new S(I.INSERT_COPY_COLUMN,g),A=new R(!0);A.addEventListeners("onComplete",function(n){r.publish(s.Selector.ReDraw,o.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:e,qaid:n.qaid}),v.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(v)}),A.addEventListeners("onError",function(e){r.publish(s.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(c.COLUMN_HEADERS_INSERT_COPY),A.send(g)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,o=e.ZSClass,r=n.topic,i=n.Groups,s=n.Names,a=t.SML.Client.Utility.WorkerRequest,c=e.ZSClass.ActionObject,E=e.ZSConstants.ActionConstants,l=e.ZSConstants.URI,R=ZSConstants.I18N;function S(e,n,R,S){var L,d=new o.ParamGenerator(R,n,S,!0,!0),C=d.getSheets(),I=d.getRanges(),f=d.getActiveCell();"left"===e?L=E.INSERT_CELL_LEFT:"top"===e&&(L=E.INSERT_CELL_TOP);var u={RID:n,sheetList:C,activeCell:f,VERSION:S,rangeList:I,action:L},O=new c(L,u),g=new a;g.addEventListeners("onComplete",function(e){r.publish(i.Selector.ReDraw,s.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:n,VERSION:S,qaid:e.qaid}),O.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(O)}),g.addEventListeners("onError",function(e){r.publish(i.Listener,s.ERROR.SHOW,{ERRORMSG:e.mk})}),g.open(l.CELL_INSERT),t.data.UserInfo.registerForRepeat(g,O),g.send(u)}function L(e,n,S,L){var d,C=new o.ParamGenerator(S,n,L,!0,!0),I=C.getSheets(),f=C.getRanges(),u=C.getActiveCell();"right"===e?d=E.DELETE_CELL_RIGHT:"bottom"===e&&(d=E.DELETE_CELL_BOTTOM);var O={RID:n,sheetList:I,activeCell:u,rangeList:f,VERSION:L,action:d},g=new c(d,O),T=new a;T.addEventListeners("onComplete",function(e){r.publish(i.Selector.ReDraw,s.Selection.BOUND_UPDATE.SHIFT.ONINSERT,{RID:n,VERSION:L,qaid:e.qaid}),g.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(g)}),T.addEventListeners("askConfirm",function(e){var t=new o.ZSConfirm(JSUtil.fn.replaceParams(R[e.mk],new Array(e.mc+"")));t.onYES(function(){T.resend()});var n=t.execute();r.publish(i.Listener,s.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),T.addEventListeners("onError",function(e){r.publish(i.Listener,s.ERROR.SHOW,{ERRORMSG:e.mk})}),T.open(l.CELL_DELETE),t.data.UserInfo.registerForRepeat(T,g),T.send(O)}e.UserAction.InsertCellLeft=function(e,t,n){S("left",e,t,n)},e.UserAction.InsertCellTop=function(e,t,n){S("top",e,t,n)},e.UserAction.DeleteCellBottom=function(e,t,n){L("bottom",e,t,n)},e.UserAction.DeleteCellRight=function(e,t,n){L("right",e,t,n)}}(this);
!function(e){var t=e.sPlusPlus,n=e.UserAction,s=t.SML.Client,r=e.ZSConstants.URI,o=s.Utility.WorkerRequest;n.createNewSpreadsheet=function(e,t,n,s){var i={RID:e,sheetList:new ZSClass.ParamGenerator(t,e,n).getSheets(),VERSION:n,includeProductInfo:!0},a=new o;a.addEventListeners("onError",function(e){s(e)}),a.addEventListeners("onComplete",function(e){s(e)}),a.open(r.CREATE_NEW_SPREADSHEET),a.send(i)}}(this);
!function(e){var n=e.sPlusPlus,t=(e.ZSEvents,e.ZSClass,e.ZSConstants.ActionConstants,e.ZSClass.ActionObject,e.ZSConstants.URI),s=n.SML.Client.Utility.WorkerRequest;e.UserAction.renameTemplate=function(e,n,E){var o={RID:e,VERSION:n,NEW_DOC_NAME:E},i=new s;i.open(t.RENAME_TEMPLATE),i.send(o)},e.UserAction.deleteTemplate=function(e,n){var E={RID:e,VERSION:n},o=new s;o.open(t.DELETE_TEMPLATE),o.send(E)},e.UserAction.useTemplate=function(e,n,E,o){var i={RID:e,VERSION:n,NEW_DOC_NAME:E},a=new s;a.addEventListeners("onComplete",function(e){o(e)}),a.open(t.USE_TEMPLATE),a.send(i)},e.UserAction.getMyTemplates=function(e,n,E){var o={RID:e,VERSION:n,SORT_VAL:"modifydes",FILTER_VAL:"all"},i=new s;i.addEventListeners("onComplete",function(e){E(e)}),i.open(t.GET_TEMPLATES),i.send(o)}}(this);
!function(e){var n=e.sPlusPlus,t=e.UserAction,s=e.ZSConstants,o=s.ActionConstants,i=s.URI,a=n.SML.Client.Utility.WorkerRequest,r=e.ZSEvents,E=r.topic,C=r.Groups,I=r.Names;t.fetchReviewComments=function(e,n,t,s,o,r,m,d,S,L){var c={rID:e,version:n,sheetList:t,disId:s,range:o,filter:r},R=new a;R.addEventListeners("onComplete",function(e){E.publish(C.Listener,I.UserAction.REVIEW_COMMENTS.LOAD,{response:e.comments?e.comments:e,callback:m,newComment:d,action:S,COUNTOBJ:e.count,REOPENID:L}),e.count&&E.publish(C.UI,I.SidePanel.Comments.UPDATE_COUNT,{COUNTOBJ:e.count})}),R.open(i.FETCH_REVIEW_COMMENTS),R.send(c)},t.addReviewComment=function(e,n,t,s,r){var E=new ZSClass.ParamGenerator(t,e,n),C={rID:e,version:n,sheetList:E.getSheets(),rangeList:E.getCustomRanges(r),activeCell:E.getActiveCell(),action:o.DISCUSSION_ADD,content:s},I=new a;I.addEventListeners("onComplete",function(e){}),I.open(i.ADD_REVIEW_COMMENT),I.send(C)},t.deleteReviewComment=function(e,n,t,s,r){var E=new ZSClass.ParamGenerator(t,e,n),C={rID:e,version:n,sheetList:E.getSheets(),rangeList:E.getCustomRanges(r),action:o.DISCUSSION_DELETE,disId:s},I=new a;I.addEventListeners("onComplete",function(e){}),I.open(i.DELETE_REVIEW_COMMENT),I.send(C)},t.updateReviewComment=function(e,n,t,s,r,E){var C=new ZSClass.ParamGenerator(t,e,n),I={rID:e,version:n,sheetList:C.getSheets(),rangeList:C.getCustomRanges(E),action:o.DISCUSSION_UPDATE_RANGE_CONTENT,disId:s,content:r},m=new a;m.addEventListeners("onComplete",function(e){}),m.open(i.UPDATE_REVIEW_COMMENT),m.send(I)},t.addReviewCommentReply=function(e,n,t,s,r,E){var C=new ZSClass.ParamGenerator(t,e,n),I={rID:e,version:n,sheetList:C.getSheets(),rangeList:C.getCustomRanges(E),action:o.DISCUSSION_ADD_REPLY,disId:s,content:r},m=new a;m.addEventListeners("onComplete",function(e){}),m.open(i.ADD_REVIEW_COMMENT_REPLY),m.send(I)},t.deleteReviewCommentReply=function(e,n,t,s,r,E){var C=new ZSClass.ParamGenerator(t,e,n),I={rID:e,version:n,sheetList:C.getSheets(),rangeList:C.getCustomRanges(E),disId:s,cid:r,action:o.DISCUSSION_DELETE_REPLY},m=new a;m.addEventListeners("onComplete",function(e){}),m.open(i.DELETE_REVIEW_COMMENT_REPLY),m.send(I)},t.updateReviewCommentReply=function(e,n,t,s,r,E,C){var I=new ZSClass.ParamGenerator(t,e,n),m={rID:e,version:n,sheetList:I.getSheets(),rangeList:I.getCustomRanges(C),disId:s,cid:r,content:E,action:o.DISCUSSION_UPDATE_REPLY},d=new a;d.addEventListeners("onComplete",function(e){}),d.open(i.UPDATE_REVIEW_COMMENT_REPLY),d.send(m)},t.resolveReviewComment=function(e,n,t,s,r){var E=new ZSClass.ParamGenerator(t,e,n),C={rID:e,version:n,sheetList:E.getSheets(),rangeList:E.getCustomRanges(r),action:o.DISCUSSION_RESOLVE,disId:s},I=new a;I.open(i.RESOLVE_REVIEW_COMMENT),I.send(C)},t.reopenReviewComment=function(e,n,t,s,r){var E=new ZSClass.ParamGenerator(t,e,n),C={rID:e,version:n,sheetList:E.getSheets(),rangeList:E.getCustomRanges(r),action:o.DISCUSSION_REOPEN,disId:s},I=new a;I.addEventListeners("onComplete",function(e){}),I.open(i.REOPEN_REVIEW_COMMENT),I.send(C)},t.likeReviewComment=function(e,n,t,s,r){var E=new ZSClass.ParamGenerator(t,e,n),C={rID:e,version:n,sheetList:E.getSheets(),rangeList:E.getCustomRanges(r),action:o.DISCUSSION_LIKE,disId:s},I=new a;I.addEventListeners("onComplete",function(e){}),I.open(i.LIKE_REVIEW_COMMENT),I.send(C)},t.unlikeReviewComment=function(e,n,t,s,r){var E=new ZSClass.ParamGenerator(t,e,n),C={rID:e,version:n,sheetList:E.getSheets(),rangeList:E.getCustomRanges(r),action:o.DISCUSSION_UNLIKE,disId:s},I=new a;I.addEventListeners("onComplete",function(e){}),I.open(i.UNLIKE_REVIEW_COMMENT),I.send(C)},t.likeReviewCommentReply=function(e,n,t,s,r,E){var C=new ZSClass.ParamGenerator(t,e,n),I={rID:e,version:n,sheetList:C.getSheets(),rangeList:C.getCustomRanges(E),action:o.DISCUSSION_LIKE_REPLY,cid:r,disId:s},m=new a;m.addEventListeners("onComplete",function(e){}),m.open(i.LIKE_REVIEW_COMMENT_REPLY),m.send(I)},t.unlikeReviewCommentReply=function(e,n,t,s,r,E){var C=new ZSClass.ParamGenerator(t,e,n),I={rID:e,version:n,sheetList:C.getSheets(),rangeList:C.getCustomRanges(E),action:o.DISCUSSION_UNLIKE_REPLY,disId:s,cid:r},m=new a;m.addEventListeners("onComplete",function(e){}),m.open(i.UNLIKE_REVIEW_COMMENT_REPLY),m.send(I)},t.deleteAllReviewComment=function(e,n,t,s,r){var E=new ZSClass.ParamGenerator(t,e,n),C={rID:e,version:n,sheetList:E.getSheets(),rangeList:E.getCustomRanges(s),action:o.DISCUSSION_DELETE_ALL,state:r},I=new a;I.addEventListeners("onComplete",function(e){}),I.open(i.DELETE_ALL_REVIEW_COMMENT),I.send(C)},t.updateDocClosedTime=function(e,n,t,s){var r=new ZSClass.ParamGenerator(t,e,n),E={rID:e,version:n,sheetList:r.getSheets(),rangeList:r.getCustomRanges(s),action:o.DISCUSSION_UPDATE_DOC_CLOSEDTIME},C=new a;C.addEventListeners("onComplete",function(e){}),C.open(i.REVIEW_COMMENT_UPDATE_DOC_CLOSEDTIME),C.send(E)},t.emailNotificationType=function(e,n,t,s,r,m,d){var S=new ZSClass.ParamGenerator(t,e,n),L={rID:e,version:n,sheetList:S.getSheets(),rangeList:S.getCustomRanges(s),subaction:d,notifyType:m,action:o.NOTIFICATION_SETTINGS},c=new a;c.addEventListeners("onComplete",function(e){E.publish(C.Listener,I.UserAction.REVIEW_COMMENTS.UPDATE_NOTIFICATION_STATE,{state:e,callback:r})}),c.open(i.REVIEW_COMMENT_NOTIFICATION_SETTINGS),c.send(L)},t.markCommentAsRead=function(e,n,t,s){var o={rID:e,version:n,commentsToMark:t,isFilter:s},r=new a;r.open(i.MARK_COMMENT_READ),r.send(o)}}(this);
!function(e){var t=e.JSUtil.Math,i=e.ZSClass,s=e.ZSConstants,n=e.sPlusPlus,o=s.URI,l=e.ZSEvents,r=l.topic,a=l.Groups,c=l.Names,S=s.ActionConstants,h=i.Range,u=n.SML.Client.Utility.WorkerRequest,A=n.data.Defaults,d=A.MAX_COL,C=A.MAX_ROW,R=n.view.measures;function E(t,i,s,o,l){var r,a,c=n.view.getActiveGridID(),S=n.view.getGridComponent(c),h=(c=n.view.getActiveGridID(),n.view.getSheetState(c,i).getZoom());if(e.isCanvasGrid)r=S.getWidth()-R.Grid.RowHeader,a=S.getHeight()-R.Grid.ColHeader;else{var u=S.getRects();r=u.width,a=u.height}var A=n.data.getWorkBook(t,s).getSheetObj(i),d=A.Row.auxiliaryAxis,C=A.Column.auxiliaryAxis,E=(r-C.getPos(A.Column.FreezedCount)*h)/2,I=(a-d.getPos(A.Row.FreezedCount)*h)/2,g=C.getPos(l)*h,D=d.getPos(o)*h,U=Math.max(g-E,0),v=Math.max(D-I,0);UserAction.ScrollTo(t,i,s,U,v,0,0),N()}function I(e,t,s,n,o,l){var h=new i.Range(o.row,o.col,o.row,o.col),u=o.row,A=o.col,d=!1;t!=s&&(UserAction.SwitchSheet(e,t,n,s,h,!1,E,[e,s,n,u,A]),d=!0),d||(l!=S.FIND_IN_SHEET&&l!=S.FIND_IN_WORKBOOK||function(e,t,i,s){r.publish(a.Selector.BoundUpdate.Range,c.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,RANGE:s})}(e,s,n,h),E(e,s,n,u,A),function(e,t,i,s,n,o){r.publish(a.Selector.BoundUpdate.Cell,c.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:i,ActiveCellRange:s,ROW:n,COL:o})}(e,s,n,h,u,A))}function N(){for(var e=document.querySelectorAll(".fillSeriesCue"),t=document.querySelectorAll(".cellSelection"),i=t.length,s=0;s<i;s++){e[s].classList.add("dsp_none"),t[s].classList.add("cellFndHlt");var n=t[s].parentElement;n.removeChild(t[s]),n.appendChild(t[s])}}e.UserAction.Find=function(i,s,l,A,R,E,g,D,U,v,L,O){var p,w=n.data.getWorkBook(i,A),F=new e.ZSClass.ParamGenerator(l,i,A,!0,!0),m=F.getSheets(),T=F.getRanges(),f=F.getActiveCell(),P=f.s,_=f.r,b=f.c;U==S.FIND_IN_ROW?p=new h(_,0,_,d-1):U==S.FIND_IN_COL&&(p=new h(0,b,C-1,b)),p&&(T=F.getCustomRanges(p,!1)),v&&(_=v.row,b=v.col,P=w.SheetList.getIdByName(v.sheet));var G={RID:i,sheetList:m,rangeList:T,activeCell:f,VERSION:A,value:R,isNext:E,isCaseSensitive:g,isExactMatch:D,getNoOfMatch:O,traverseMode:U},M=new u;M.addEventListeners("onComplete",function(e){if(r.publish(a.Listener,c.CellAction.VALUE.FIND.STATUS,{STATUS:1,RESPONSE:e}),-1===e.row||-1===e.col)return r.publish(a.Listener,c.CellAction.VALUE.FIND.SHOWERRORMSG,{ERRORMSG:"CannotFindSearch#"+R}),L&&r.publish(a.Listener,c.CellAction.VALUE.FIND.FOCUSQUICKFIND),void(L&&r.publish(a.Listener,c.CellAction.VALUE.FIND.QUICKCOUNTUPDATE,{resp:e,isNext:E}));var n=w.SheetList.getIdByName(e.sheet);n&&(I(i,s,n,A,e,U),N(),n==P&&E&&t.hash(_,b,d)>=t.hash(e.row,e.col,d)&&r.publish(a.Listener,c.CellAction.VALUE.FIND.WRAP,{isEOS:1}),n==P&&!E&&t.hash(_,b,d)<=t.hash(e.row,e.col,d)&&r.publish(a.Listener,c.CellAction.VALUE.FIND.WRAP,{isEOS:0}),L&&r.publish(a.Listener,c.CellAction.VALUE.FIND.QUICKCOUNTUPDATE,{resp:e,isNext:E}))}),M.addEventListeners("onError",function(e){r.publish(a.Listener,c.CellAction.VALUE.FIND.STATUS,{STATUS:0}),r.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),M.open(o.FIND),M.send(G)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=n.topic,a=n.Groups,i=n.Names,r=t.SML.Client.Utility.WorkerRequest,o=e.ZSConstants.ActionConstants,l=e.ZSClass.ActionObject,c=e.ZSConstants.URI;e.UserAction.Replace=function(n,R,C,E,d,u,L,g,v,A){t.data.getWorkBook(n,E);var S,p,f=t.view.getActiveGridID(),m=new e.ZSClass.ParamGenerator(C,n,E,!0,!0),h=m.getSheets(),P=m.getRanges(),w=m.getActiveCell(),O=w.r,U=w.c;if(t.view.fetchCellData(n,w.s,E,O,U,["DisplayValue","ActualValue","Format","Formula","CellComment","Hyperlink","CellType"],f,function(e){S=e[O][U].Formula},function(t){e.ZSClass.Logger.log("Couldn't retrieve Content",t)}),S&&(p=g?S.search(d):S.search(new RegExp(d,"i"))),-1==p)UserAction.Find(n,R,C,E,d,L,g,v,A);else{var I={RID:n,sheetList:h,rangeList:P,activeCell:w,value:d,replaceString:u,isNext:L,isCaseSensitive:g,isExactMatch:v,VERSION:E,traverseMode:A,action:o.REPLACE},M=new l(o.REPLACE,I),Z=new r;Z.addEventListeners("onComplete",function(e){M.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(M),UserAction.Find(n,R,C,E,d,L,g,v,A)}),Z.addEventListeners("onError",function(e){s.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),Z.open(c.REPLACE),Z.send(I)}},e.UserAction.ReplaceAll=function(n,R,C,E,d,u,L,g,v,A){var S=new e.ZSClass.ParamGenerator(R,n,C,!0,!0),p={RID:n,sheetList:S.getSheets(),rangeList:A?S.getCustomRanges(JSUtil.Range.parseRange(n,C,A).range):S.getRanges(),activeCell:S.getActiveCell(),value:E,replaceString:d,isNext:u,isCaseSensitive:L,isExactMatch:g,VERSION:C,traverseMode:v,action:o.REPLACE_ALL},f=new l(o.REPLACE_ALL,p),m=new r;m.addEventListeners("onComplete",function(e){f.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(f)}),m.addEventListeners("onError",function(e){s.publish(a.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),m.open(c.REPLACE_ALL),m.send(p)}}(this);
!function(t){var n=t.sPlusPlus,s=n.SML.Client.Utility.WorkerRequest,e=t.ZSConstants.URI;n.data.UserInfo,ZSConstants.ActionConstants,t.ZSConstants.I18N;t.UserAction.MakeFavorate=function(t,n,o,a){var i={RID:t,VERSION:n,action:o?"unfavourite":"favourite"},r=new s;r.addEventListeners("onComplete",function(t){var n=t.isFavorite;a(n)}),r.open(e.DOCUMENT_FAVORATE),r.send(i)}}(this);
!function(n){var t=n.sPlusPlus,s=t.SML.Client.Utility.WorkerRequest,e=n.ZSConstants.URI;t.data.UserInfo,ZSConstants.ActionConstants,n.ZSConstants.I18N;n.UserAction.MarkAsComplete=function(n,t,o){var i={rID:n,version:t},r=new s;r.addEventListeners("onComplete",function(n){n.DRIVE_STATUS&&o()}),r.open(e.DRIVE_STATUS),r.send(i)}}(this);
!function(n){var t=n.sPlusPlus,e=n.ZSEvents,o=n.ZSClass,s=e.topic,i=e.Groups,r=e.Names,a=t.SML.Client.Utility.WorkerRequest,c=n.ZSConstants.URI,E=(t.data.UserInfo,ZSConstants.ActionConstants,n.ZSConstants.I18N);var u=!1;s.register(i.Listener,r.UserAction.REVERT_VERSION,function(){u=!0}),s.register(i.Listener,r.DocMeta.TRIGGER_DOCUMENT_EXIT,function(n,t){if(u)document.location.reload(!0);else{var e={countDown:15,buttons:[{text:E.OK,primary:!0,click:function(){document.location.reload(!0)}}],title:E[t]};o.ZSAlert(E[n],e)}},"EXCEPTIONKEY","TITLE"),n.UserAction.RenameDocument=function(n,t,e){var o={RID:n,newName:e},s=new a;s.addEventListeners("onComplete",function(n){}),s.open(c.DOCUMENT_RENAME),s.send(o)},n.UserAction.resendRequest=function(n,t){var e=new a,o={RID:n,VERSION:t};e.open(c.RESEND_PENDING_REQ),e.send(o)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=(e.ZSClass,n.topic),i=n.Groups,o=n.Names,r=e.ZSConstants,a=t.SML.Client.Utility.WorkerRequest,c=e.ZSClass.ActionObject,l=r.ActionConstants,R=r.URI;e.UserAction.HyperLink=function(n,r,E,S,d,u){var I=new e.ZSClass.ParamGenerator(r,n,E,!0),C=I.getSheets(),v=I.getRanges(),L=I.getActiveCell(),A=t.view.getActiveGridID(),g=t.view.getSheetID(A);s.publish(i.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:g,VERSION:E});var p=e.encodeURIComponent,O={RID:n,sheetList:C,VERSION:E,rangeList:v,activeCell:L,subMode:S,action:l.HYPERLINK};"add"==S&&(O.cellValue=p(d),O.url=p(u));var h=new c(l.HYPERLINK,O),D=new a;D.addEventListeners("onComplete",function(e){t.data.UserInfo.ActionRecorder.record(h)}),D.addEventListeners("onError",function(e){s.publish(i.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(R.HYPERLINK),D.send(O)}}(this);
!function(e){var t=e.ZSEvents,n=t.topic,s=t.Groups,o=t.Names,a=e.JSUtil,r=e.sPlusPlus,i=r.SML.Client.Utility.WorkerRequest,S=e.ZSConstants.ActionConstants,R=ZSClass.ActionObject,l=e.ZSConstants.URI,E=r.data.Defaults,C=E.MAX_ROW,c=E.MAX_COL,A=ZSConstants.I18N;function d(t,a,E,C,c,A,d,O,v){var g=new e.ZSClass.ParamGenerator(a,t,E,!1,!1),u=g.getSheets(),I=new ZSClass.Range(c.startRow,c.startCol,c.endRow,c.endCol),w=g.getCustomRanges(I),T=g.getActiveCell(),f=v||c.endCol-c.startCol+1,D={RID:t,sheetList:u,rangeList:w,activeCell:T,SORTANDINDEX:JSON.stringify(C),NOOFCOLS:f,ISSORTCOLS:A,VERSION:E,ISCASESENSITIVE:O,action:S.SORT};void 0!==d&&(D.ISCONTAINSHEADER=d);var L=new R(S.SORT,D),p=new i;p.addEventListeners("onComplete",function(e){r.data.UserInfo.ActionRecorder.record(L)}),p.addEventListeners("onError",function(e){n.publish(s.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(l.SORT_RANGE),p.send(D)}e.UserAction.Sort=function(t,E,O,v,g,u,I){var w,T=new e.ZSClass.ParamGenerator(E,t,O,!0,!0).getActiveSheet(),f=r.data.getWorkBook(t,O).getSheetObj(T),D=r.view.getActiveGridID(),L=r.view.getSheetState(D,E[0]),p=L.getActiveRange();if(L.isMultiRangeSelected())ZSClass.ZSAlert(A["action.not.support.multiselection"]);else{var h,N,Z,_=f.DataFilters;if(g){var G=_.getAllRanges();for(var U in G)var m=G[U],P=new ZSClass.Range(m.startRow,m.startCol,m.endRow,m.endCol);w=_.getSubsets(p).length>0?p:P}else w=p;if(!u){var b={},y=[];b.f=0,"ASC"==v[0]?b.s="TRUE":b.s="FALSE",y.push(b),h=!1,N=void 0,Z=!1}n.publish(s.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:t,SHEETID:T,VERSION:O}),0==w.startRow&&w.endRow==C-1||u?function(t,r,E,A,O,v,g,u,I,w){var T,f=new e.ZSClass.ParamGenerator(r,t,E),D=f.getSheets(),L=new ZSClass.Range(A.startRow,A.startCol,A.endRow,A.endCol),p=f.getCustomRanges(L),h=f.getActiveCell(),N={RID:t,sheetList:D,activeCell:h,VERSION:E,rangeList:p,action:S.SORT_DETAILS},Z=(new R(S.SORT_DETAILS,N),new i);Z.addEventListeners("onComplete",function(e){var i,S=e.response_array,R=S[0];R.hasOwnProperty("ch")&&(i=R.ch);var l=a.fn.getIndexOf(h.s,D),A=p[l][0];if(A.isCol()&&"true"==R.ES){var L=function(e,t,n){for(var s=0,o=e;o<=t;o++){if(o==n){var a=s;return a}s++}}(R.ESC,R.EEC,w);v&&(v[0].f=L),(T=new ZSClass.Range(A.startRow,R.ESC,A.endRow,R.EEC)).endRow==C-1&&T.endCol==c-1?T.type=3:T.endRow==C-1&&(T.type=2),n.publish(s.Selector.BoundUpdate.Range,o.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:f.getActiveSheet(),RANGE:T,TYPE:T.type,VERSION:E})}else T=A;O?n.publish(s.Listener,o.CellAction.VALUE.CUSTOM_SORT_EXPANDRANGE,{ACTIVERANGE:T,HEADER_DETAILS:i}):d(t,r,E,v,T,g,u,I)}),Z.addEventListeners("onError",function(e){n.publish(s.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),Z.open(l.SORT_DETAILS),Z.send(N)}(t,E,O,w,u,y,h,N,Z,I):d(t,E,O,y,w,h,void 0,Z)}},e.UserAction.executeSort=d}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.encodeURIComponent,s=n.topic,r=n.Groups,o=n.Names,a=t.SML.Client.Utility.WorkerRequest,l=e.ZSClass.ActionObject,c=e.ZSConstants.ActionConstants,S=e.ZSConstants.URI;ZSClass.Range;UserAction.splitOperation=function(e,t,n,i,l){var c={cellContent:e,delimiters:t,mergeDelimiter:n,textDelimiter:i},E=new a;E.addEventListeners("onComplete",function(e){e&&l&&l(e)}),E.addEventListeners("onError",function(e){s.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),E.open(S.TEXTTOCOLUMNS_DELIMITERS),E.send(c)},UserAction.ApplyTexttoColumn=function(n,E,R,C,d,u,L,m,v,O,g,I,A,T){var D=new e.ZSClass.ParamGenerator(E,n,R,!0),p=(E=D.getSheets(),D.getParmsFromDataString(C)),h=p.sheets,f=(A=p.ranges,D.getActiveCell()),w=void 0;if(T||(w=D.getCustomRanges(d)),w||T){var N={RID:n,srcSheetList:E,sheetList:h,rangeList:A,delimiters:i(u),enclosure:L,isMergeDelimitersChecked:m,srcRangeList:w,columnHeads:JSON.stringify(v),cellContent:i(O),countryName:g,startsFromRow:I,activeCell:f,VERSION:R},U=new l(c.TEXTTOCOLUMNS_APPLY,N),G=new a;G.addEventListeners("onComplete",function(e){var i=t.view.getActiveGridID(),a=t.view.getSheetID(i);t.data.UserInfo.ActionRecorder.record(U),s.publish(r.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:a,VERSION:R})}),G.addEventListeners("onError",function(e){s.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk});var i=t.view.getActiveGridID(),a=t.view.getSheetID(i);s.publish(r.Listener,o.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:a,VERSION:R})}),G.open(S.TEXTTOCOLUMNS_APPLY),G.send(N)}}}(this);
!function(e){var n=e.sPlusPlus,t=n.SML.Client,s=e.ZSConstants,r=s.ActionConstants,i=e.ZSEvents,o=i.topic,a=i.Groups,d=i.Names,R=e.ZSClass.ActionObject,c=t.Utility.WorkerRequest,l=e.UserAction,I=s.URI,S=n.view;function g(e,t,s,i,l,g){var E=S.getVersionID(t),u=r[g],p=new ZSClass.ParamGenerator(s,e,E),L={action:u,RID:e,gridID:t,sheetID:i,sheetList:p.getSheets(),VERSION:E,rangeList:p.getCustomRanges(l,!0),activeCell:p.getActiveCell()},C=new R(u,L),v=new c;v.addEventListeners("onComplete",function(e){C.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(C)}),v.addEventListeners("onError",function(e){o.publish(a.Listener,d.ERROR.SHOW,{ERRORMSG:e.mk})}),v.open(I[g]),v.send(L)}l.createSparklines=function(e,t,s,i,l,g,E,u,p,L,C){var v=S.getVersionID(t),m=r[L],D={action:m,RID:e,gridID:t,sheetID:E,VERSION:v,type:u,sparklineID:p,sheetList:s,rangeList:i,srcSheetList:l,srcRangeList:g,activeCell:C},O=new R(m,D),h=new c;h.addEventListeners("onComplete",function(e){O.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(O)}),h.addEventListeners("onError",function(e){o.publish(a.Listener,d.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(I[L]),h.send(D)},l.removeSparklines=g,l.modifySparklineProperties=function(e,t,s,i,l,g,E){var u=S.getVersionID(t),p=r[E],L=new ZSClass.ParamGenerator(i,e,u),C={action:p,RID:e,gridID:t,sheetID:s,sheetList:L.getSheets(),VERSION:u,rangeList:L.getCustomRanges(g,!0),properties:l,activeCell:L.getActiveCell()},v=new R(p,C),m=new c;m.addEventListeners("onComplete",function(e){v.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(v)}),m.addEventListeners("onError",function(e){o.publish(a.Listener,d.ERROR.SHOW,{ERRORMSG:e.mk})}),m.open(I[E]),m.send(C)},l.changeSparklineOrientation=function(e,t,s,i,l,g,E){var u=S.getVersionID(t),p="CHANGE_SPARKLINE_ORIENTATION",L=r[p],C=new ZSClass.ParamGenerator(i,e,u),v={action:L,RID:e,gridID:t,sheetID:s,sheetList:C.getSheets(),VERSION:u,rangeList:C.getCustomRanges(g,!0),sparklineID:l,activeCell:E},m=new R(L,v),D=new c;D.addEventListeners("onComplete",function(e){m.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(m)}),D.addEventListeners("onError",function(e){o.publish(a.Listener,d.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(I[p]),D.send(v)},l.editSparkline=function(e,t,s,i,l,g,E){var u=S.getVersionID(t),p="EDIT_SPARKLINE_DATA",L=r[p],C=new ZSClass.ParamGenerator(i,e,u),v=(new ZSClass.ParamGenerator(l,e,u),C.getCustomRanges(E,!0)),m=C.getCustomRanges(g,!0),D=C.getActiveCell(),O={action:L,RID:e,gridID:t,sheetID:s,sheetList:C.getSheets(),VERSION:u,srcRangeList:m,srcSheetList:l,rangeList:v,activeCell:D},h=new R(L,O),f=new c;f.addEventListeners("onComplete",function(e){h.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(h)}),f.addEventListeners("onError",function(e){o.publish(a.Listener,d.ERROR.SHOW,{ERRORMSG:e.mk})}),f.open(I[p]),f.send(O)},l.groupSparklines=function(e,t,s,i,l,g,E,u){var p=S.getVersionID(t),L=r[u],C=new ZSClass.ParamGenerator(i,e,p),v={action:L,RID:e,gridID:t,sheetID:s,sheetList:C.getSheets(),VERSION:p,rangeList:C.getCustomRanges(l,!0),activeCell:g,isCompleteGroup:E},m=new R(L,v),D=new c;D.addEventListeners("onComplete",function(e){m.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(m)}),D.addEventListeners("onError",function(e){o.publish(a.Listener,d.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(I[u]),D.send(v)},l.ungroupSparklines=g}(this);
!function(e){var t=e.sPlusPlus,n=t.SML.Client,i=e.ZSConstants,s=i.ActionConstants,r=e.ZSEvents,o=r.topic,a=r.Groups,c=r.Names,R=e.ZSClass.ActionObject,d=n.Utility.WorkerRequest,I=e.UserAction,v=i.URI;t.view;I.createPicklist=function(e,n,i,r,I,S){var g=t.view.getActiveGridID(),E=t.view.getResourceID(g),l=t.view.getSheetID(g),w=t.view.getVersionID(g),L=s.PICKLIST_CREATE,u=(n={action:L,RID:E,gridID:g,sheetID:l,sheetList:n.sheets,VERSION:w,rangeList:n.ranges,itemJson:e,defaultIndex:r,activeCell:i},new R(L,n)),D=new d;D.addEventListeners("onComplete",function(e){u.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(u),I()}),D.addEventListeners("onError",function(e){o.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk}),S()}),D.open(v.PICKLIST_CREATE),D.send(n)},I.applyPicklist=function(e){var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),r=t.view.getSheetID(n),I=t.view.getVersionID(n),S=t.view.getSelectedSheets(n),g=t.view.getSheetState(n,r).getRanges(),E=new ZSClass.ParamGenerator(S,i,I),l=E.getSheets(),w=E.getCustomRanges(g,!0),L=E.getActiveCell(),u=s.PICKLIST_APPLY,D={action:u,RID:i,gridID:n,sheetID:r,sheetList:l,VERSION:I,rangeList:w,picklistid:e,activeCell:L},C=new R(u,D),h=new d;h.addEventListeners("onComplete",function(e){C.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(C)}),h.addEventListeners("onError",function(e){o.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(v.PICKLIST_APPLY),h.send(D)},I.editPicklist=function(e,n,i,r,I,S,g,E){var l=t.view.getActiveGridID(),w=t.view.getResourceID(l),L=t.view.getSheetID(l),u=t.view.getVersionID(l),D=s.PICKLIST_EDIT,C=(i={action:D,RID:w,gridID:l,sheetID:L,sheetList:i.sheets,VERSION:u,rangeList:i.ranges,itemJson:n,defaultIndex:I,picklistID:e,deletedItems:S,activeCell:r},new R(D,i)),h=new d;h.addEventListeners("onComplete",function(e){C.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(C),g()}),h.addEventListeners("onError",function(e){o.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk}),E()}),h.open(v.PICKLIST_EDIT),h.send(i)},I.removePicklist=function(e,n){var i=t.view.getActiveGridID(),r=t.view.getResourceID(i),I=t.view.getVersionID(i),S=t.view.getSelectedSheets(i),g=new ZSClass.ParamGenerator(S,r,I),E=g.getActiveCell();if(void 0==n||0==n.length){var l={action:u=s[L="PICKLIST_EMPTY_REMOVE"],RID:r,VERSION:I,picklistid:e,sheetList:g.getSheets(),activeCell:E},w=new R(u,l);(D=new d).addEventListeners("onComplete",function(e){w.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(w)}),D.addEventListeners("onError",function(e){o.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(v[L]),D.send(l)}else{var L,u,D;l=g.getParmsFromDataString(n),l={action:u=s[L="PICKLIST_REMOVE"],RID:r,VERSION:I,rangeList:l.ranges,sheetList:l.sheets,picklistid:e,activeCell:E},w=new R(u,l),(D=new d).addEventListeners("onComplete",function(e){w.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(w)}),D.addEventListeners("onError",function(e){o.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(v[L]),D.send(l)}},I.getValuesFromServer=function(e){var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),r=t.view.getSheetID(n),I=t.view.getVersionID(n),S=t.view.getSelectedSheets(n),g=t.view.getSheetState(n,r).getRanges(),E=new ZSClass.ParamGenerator(S,i,I),l=E.getSheets(),w=E.getCustomRanges(g,!0),L=s.PICKLIST_READ,u={action:L,RID:i,VERSION:I,rangeList:w,sheetList:l},D=(new R(L,u),new d);D.addEventListeners("onComplete",function(t){e(t)}),D.addEventListeners("onError",function(e){o.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),D.open(v.PICKLIST_READ),D.send(u)},I.getPicklistsForManage=function(e){var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),r=(t.view.getSheetID(n),t.view.getVersionID(n)),R={action:s.PICKLIST_MANAGE,RID:i,VERSION:r},I=new d;I.addEventListeners("onComplete",function(t){e(t)}),I.addEventListeners("onError",function(e){o.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),I.open(v.PICKLIST_MANAGE),I.send(R)},I.checkPicklistIntersection=function(e){var n=t.view.getActiveGridID(),i=t.view.getResourceID(n),r=t.view.getSheetID(n),R=t.view.getVersionID(n),I=t.view.getSelectedSheets(n),S=t.view.getSheetState(n,r).getRanges(),g=new ZSClass.ParamGenerator(I,i,R),E=g.getSheets(),l=g.getCustomRanges(S,!0),w="PICKLIST_INTERSECTION",L={action:s[w],RID:i,VERSION:R,rangeList:l,sheetList:E},u=new d;u.addEventListeners("onComplete",function(t){e(t)}),u.addEventListeners("onError",function(e){o.publish(a.Listener,c.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(v[w]),u.send(L)}}(this);
!function(n){var e=n.sPlusPlus,t=e.SML.Client,o=n.ZSConstants,s=(o.ActionConstants,n.ZSEvents),i=(s.topic,s.Groups,s.Names,n.ZSClass.ActionObject,t.Utility.WorkerRequest),r=n.UserAction,d=o.URI;e.view;r.linkedSpreadSheets=function(n,e){var t={RID:n},o=new i;o.addEventListeners("onComplete",function(n){e(n)}),o.addEventListeners("onError",function(n){e(n)}),o.open(d.LINKED_WORKBOOKS),o.send(t)},r.linkSpreadSheet=function(n,e,t){var o={RID:n,SRID:e},s=new i;s.addEventListeners("onComplete",function(n){t(n)}),s.addEventListeners("onError",function(n){t(n)}),s.open(d.ADD_SUPPLIER),s.send(o)},r.RemoveSupplier=function(n,e,t){var o={RID:n,SRID:e},s=new i;s.addEventListeners("onComplete",function(n){t(n)}),s.addEventListeners("onError",function(n){t(n)}),s.open(d.REMOVE_SUPPLIER),s.send(o)},r.RemoveConsumer=function(n,e,t){var o={RID:n,SRID:e},s=new i;s.addEventListeners("onComplete",function(n){t(n)}),s.addEventListeners("onError",function(n){t(n)}),s.open(d.REMOVE_CONSUMER),s.send(o)}}(this);
!function(e){var n=e.sPlusPlus,t=e.UserAction,o=e.ZSDevTools.Logger,r=e.ZSConstants.URI,E=n.SML.Client.Utility.WorkerRequest;t.AddButton=function(e,n,t,s,T){var i=new ZSClass.ParamGenerator([n],e,t,!1,!1),S=i.getSheets(),a=i.getActiveCell(),d={RID:e,SHEETID:n,VERSION:t,BUTTON:s,SHEETLIST:S,ACTIVECELL:a},C=new E;C.addEventListeners("onError",function(e){o.log("Add Button error:",e)}),C.addEventListeners("onComplete",function(o){T&&T(e,n,t,o)}),C.open(r.BUTTON_ADD),C.send(d)},t.ResizeButton=function(e,n,t,s,T){var i=new ZSClass.ParamGenerator([n],e,t,!1,!1),S={RID:e,SHEETID:n,VERSION:t,BUTTON:T,ID:s,SHEETLIST:i.getSheets(),ACTIVECELL:i.getActiveCell()},a=new E;a.addEventListeners("onError",function(e){o.log("Add Button error:",e)}),a.addEventListeners("onComplete",function(e){}),a.open(r.BUTTON_RESIZE),a.send(S)},t.MoveButton=function(e,n,t,s,T){var i=new ZSClass.ParamGenerator([n],e,t,!1,!1),S={RID:e,SHEETID:n,VERSION:t,BUTTON:T,ID:s,SHEETLIST:i.getSheets(),ACTIVECELL:i.getActiveCell()},a=new E;a.addEventListeners("onError",function(e){o.log("Add Button error:",e)}),a.addEventListeners("onComplete",function(e){}),a.open(r.BUTTON_MOVE),a.send(S)},t.DeleteButton=function(e,n,t,s){var T=new ZSClass.ParamGenerator([n],e,t,!1,!1),i={RID:e,SHEETID:n,VERSION:t,ID:s,SHEETLIST:T.getSheets(),ACTIVECELL:T.getActiveCell()},S=new E;S.addEventListeners("onError",function(e){o.log("Add Button error:",e)}),S.addEventListeners("onComplete",function(e){}),S.open(r.BUTTON_DELETE),S.send(i)},t.SetCaptionButton=function(e,n,t,s,T){var i=new ZSClass.ParamGenerator([n],e,t,!1,!1),S={RID:e,SHEETID:n,VERSION:t,BUTTON:T,ID:s,SHEETLIST:i.getSheets(),ACTIVECELL:i.getActiveCell()},a=new E;a.addEventListeners("onError",function(e){o.log("Add Button error:",e)}),a.addEventListeners("onComplete",function(e){}),a.open(r.BUTTON_SETCAPTION),a.send(S)},t.SetMacroButton=function(e,n,t,s,T){var i=new ZSClass.ParamGenerator([n],e,t,!1,!1),S=i.getSheets(),a=i.getActiveCell(),d={RID:e,SHEETID:n,VERSION:t,ID:s,MACRO:T.getScript().toString(),SHEETLIST:S,ACTIVECELL:a},C=new E;C.addEventListeners("onError",function(e){o.log("Add Button error:",e)}),C.addEventListeners("onComplete",function(e){}),C.open(r.BUTTON_ASSIGNMACRO),C.send(d)},t.CloneButton=function(e,n,t,s,T){var i=new ZSClass.ParamGenerator([n],e,t,!1,!1),S=i.getSheets(),a=i.getActiveCell(),d=s.getScript();d&&(d=d.toString());var C={RID:e,SHEETID:n,VERSION:t,BUTTON:s,MACRO:d,SHEETLIST:S,ACTIVECELL:a},I=new E;I.addEventListeners("onError",function(e){o.log("Add Button error:",e)}),I.addEventListeners("onComplete",function(o){T&&T(e,n,t,o)}),I.open(r.BUTTON_CLONE),I.send(C)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants,i=n.URI,s=e.ZSEvents,o=s.topic,r=s.Groups,a=s.Names,E=t.SML.Client,R=(e.ZSClass,n.ActionConstants),c=e.ZSClass.ActionObject,l=E.Utility.WorkerRequest;e.UserAction,n.I18N;o.register(r.UI,a.Layout.DEFER_JS_LOADED,function(){var e=t.view.getActiveGridID(),n=t.view.getVersionID(e),s=t.view.getResourceID(e),E=t.data.DocRegistry[s].RemoteViewInfo,u=R.REQUEST_BANNER;if(E.REMOTE_ENC_DOC_ID)return!1;var S=localStorage?localStorage.getItem("AB"):null,D={bv:t.data.AppRegistry.buildVersion,bannerName:S,actionConstant:u,RID:s,VERSION:n},A=(new c(u,D),new l);A.addEventListeners("onComplete",function(e){o.publish(r.Listener,a.DocAction.BANNER.ADD,{RESPONSE:e})}),A.addEventListeners("onError",function(e){o.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(i.REQUEST_BANNER),A.send(D)})}(this);
!function(e){var n=e.sPlusPlus.SML.Client.Utility.WorkerRequest,t=e.ZSConstants.URI;e.UserAction.Announcement=function(e,i,s,o){var u={RID:e,VERSION:i,ACTION:s},N=new n;N.addEventListeners("onComplete",function(e){!e||e.isViewed&&!e.isNewTagViewed||o&&o(!0,e.isNewTagViewed)}),N.open(t.USER_ANNOUNCEMENT),N.send(u)}}(this);
!function(t){var e=t.sPlusPlus,n=t.ZSEvents,s=n.topic,o=n.Groups,i=n.Names,a=e.SML.Client.Utility.WorkerRequest,r=t.ZSConstants.ActionConstants,R=t.ZSClass.ActionObject,c=t.ZSConstants.URI;t.UserAction.Recalculate=function(e,n,C,E){var u={sheetList:new t.ZSClass.ParamGenerator(n,e,C,!1).getSheets(),VERSION:C,action:r.RECALCULATE,RID:e},L=(new R(r.RECALCULATE,u),new a);L.addEventListeners("onComplete",function(t){E&&E(t)}),L.addEventListeners("onError",function(t){s.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:t.mk})}),L.open(c.RECALCULATE),L.send(u)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=e.ZSClass,i=n.topic,o=n.Groups,E=n.Names,a=e.ZSConstants,r=(a.I18N,t.SML.Client.Utility.WorkerRequest),C=e.ZSClass.ActionObject,O=a.ActionConstants,I=a.URI;e.UserAction.CellComment=function(n,a,l,R,L,S){var c=e.encodeURIComponent,N=t.data.getWorkBook(n,l).getSheetObj(a[0]).Prop.Name;if(!S){var T=t.view.getActiveGridID(),M=t.view.getSheetState(T,a[0]);S=M.getActiveCellRange()}var A=new s.ParamGenerator(a,n,l),D=A.getSheets(),d=A.getCustomRanges(S),v=A.getActiveCell(),g=(T=t.view.getActiveGridID(),t.view.getSheetID(T));i.publish(o.Listener,E.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:g,VERSION:l});var u={RID:n,sheetList:D,sheetName:N,rangeList:d,activeCell:v,VERSION:l,subMode:R,comment:c(L),action:O.CELL_COMMENT},h=new C(O.CELL_COMMENT,u),m=new r;m.addEventListeners("onAcknowledge",function(e){switch(R){case"remove":i.publish(o.Listener,E.CellAction.COMMENT.DELETE,{RID:n,SHEETID:g,VERSION:l,ROW:S.startRow,COL:S.startCol}),i.publish(o.Listener,E.GridAction.CLIENTFIRSTACTIONS,{RID:n,SHEETID:g,VERSION:l,ACTION:O.CELL_COMMENT,RANGELIST:[S],VALUE:{MODE:R}});break;case"add":i.publish(o.Listener,E.CellAction.COMMENT.ADD,{RID:n,SHEETID:g,VERSION:l,ROW:S.startRow,COL:S.startCol,COMMENT:[L]}),i.publish(o.Listener,E.GridAction.CLIENTFIRSTACTIONS,{RID:n,SHEETID:g,VERSION:l,ACTION:O.CELL_COMMENT,RANGELIST:[S],VALUE:{MODE:R,COMMENT:[L]}})}}),m.addEventListeners("onComplete",function(e){t.data.UserInfo.ActionRecorder.record(h)}),m.addEventListeners("onError",function(e){i.publish(o.Listener,E.ERROR.SHOW,{ERRORMSG:e.mk})}),m.open(I.CELL_COMMENT),m.send(u)},e.UserAction.MoveCellComment=function(n,a,C,l,R,L,S){var c=new s.ParamGenerator([a],n,C),N=c.getSheets(),T=new s.Range(l,R,l,R),M=c.getCustomRanges(T),A=c.getActiveCell(),D=t.data.getWorkBook(n,C).getSheetObj(a).Prop.Name,d={RID:n,SHEETID:a,VERSION:C,ROW:l,COL:R,X:L,Y:S,WIDTH:180,HEIGHT:70,action:O.RESET_ANNOTE_POSITION,sheetList:N,sheetName:D,rangeList:M,activeCell:A},v=new r;v.addEventListeners("onComplete",function(s){var r=t.data.getWorkBook(n,C).getSheetObj(a),O=t.data.Defaults.MAX_COL,I=e.JSUtil.Math.hash(l,R,O),c=r.Notes.get(I);if(c){var N=[c.value,L,S];i.publish(o.Listener,E.CellAction.COMMENT.ADD,{RID:n,SHEETID:a,VERSION:C,ROW:l,COL:R,COMMENT:N})}}),v.open(I.MOVE_CELL_COMMENT),v.send(d)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=e.ZSClass,o=n.topic,s=n.Groups,r=n.Names,a=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),E=e.ZSConstants.ActionConstants,c=e.ZSConstants.URI,C=t.SML.Client.Utility.WorkerRequest;e.UserAction;function S(e,n,E,S,A,I,R,l,d){t.data.getWorkBook(e,E);var O=t.view.getActiveGridID(),D=t.view.getSheetID(O),u=t.view.getActiveState(O),g=new i.ParamGenerator(n,e,E,!0,!0),v=g.getSheets(),L=g.getRanges(),T=g.getActiveCell(),U=u.getFormatPainterState(),f={RID:e,sheetList:v,rangeList:L,activeCell:T,action:S,VERSION:E,value:A},p=new a(S,f,A),H=L[JSUtil.fn.getIndexOf(D,v)];o.publish(s.Listener,r.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:D,VERSION:E});var _=new C;_.addEventListeners("onAcknowledge",function(){o.publish(s.Listener,r.GridAction.CLIENTFIRSTACTIONS,{RID:e,SHEETID:D,VERSION:E,ACTION:S,RANGELIST:H,VALUE:A})}),_.addEventListeners("onComplete",function(n){n.qaid;U&&o.publish(s.Selector.BoundUpdate.Copy,r.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:D}),p.qaid=n.qaid,t.data.UserInfo.ActionRecorder.record(p)}),_.addEventListeners("onError",function(e){o.publish(s.Listener,r.ERROR.SHOW,{ERRORMSG:e.mk})}),_.open(c.FORMAT_MODIFY),t.data.UserInfo.registerForRepeat(_,p),_.send(f)}e.UserAction.CHECKBOX_EDIT=function(e,t,n,i,o,s,r,a){S(e,t,n,E.CHECKBOX_EDIT,i)},e.UserAction.CHECKBOX_ADD=function(e,t,n,i,o,s,r){S(e,t,n,E.CHECKBOX_ADD,i)},e.UserAction.CHECKBOX_CLEAR=function(e,t,n,i,o,s,r){S(e,t,n,E.CHECKBOX_CLEAR,i)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=(e.ZSClass,n.topic,n.Groups,n.Names,e.ZSDevTools.Logger,e.ZSClass.ActionObject,e.ZSConstants.ActionConstants,e.ZSConstants.URI),o=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.setUserSettings=function(e,n,i,S,r,a){t.data.getWorkBook(e,i);var c=t.view.getActiveGridID(),E={RID:e,SHEETID:t.view.getSheetID(c),VERSION:i,columnName:S,key:r,value:a},v=new o;v.open(s.SET_USERSETTING),v.send(E)},e.UserAction.getUserSettings=function(e,n,i,S,r){t.data.getWorkBook(e,i);var a=t.view.getActiveGridID(),c={RID:e,SHEETID:t.view.getSheetID(a),VERSION:i,columnName:S},E=new o;E.addEventListeners("onComplete",function(e){r(e)}),E.open(s.GET_USERSETTING),E.send(c)}}(this);
!function(e){var t=e.sPlusPlus,n=t.SML.Client,i=e.ZSConstants.URI,s=e.ZSConstants.ActionConstants,o=e.ZSDevTools.Logger,a=n.Utility.WorkerRequest,r=e.ZSEvents,g=r.topic,l=r.Groups,S=r.Names,R=ZSClass.Range;UserAction.aggregateFunctions=function(e,n,r,c,d,C){var A=new ZSClass.ParamGenerator(n,e,r,!0,!0),E=A.getSheets(),u=A.getRanges(),v=A.getActiveCell(),w=t.view.getActiveGridID(),I=t.view.getSheetState(w,v.s).getActiveRange(),U=I.isSingle(),L="COUNTA"===c||"COUNT"===c,O=U?s.ALT_EQUAL_RANGE:s.COMPUTE_SUM,N={rid:e,sheetList:E,VERSION:r,rangeList:u,isRangeSingle:U,range:I,activeCell:v,includeString:L,functionName:c,action:O},h=new a;h.addEventListeners("onError",function(e){o.log("AggregateFunctionAction error :",e)}),h.addEventListeners("onComplete",function(n){!function(e,n,i,s,o,a,r){var c,d,C,A=t.view.getActiveGridID(),E=t.view.getSheetState(A,n),u=t.data.getWorkBook(e,i).getSheetObj(n);o.startRow>=0&&o.startCol>=0&&((d=new R(o.startRow,o.startCol,o.endRow,o.endCol)).isColRange()?((C=u.Row.Visibility).isHidden(d.startRow)||C.nextHidden(d.startRow)<d.endRow)&&(c=r,s=a):((C=u.Column.hidden).isHidden(d.startCol)||C.nextHidden(d.startCol)<d.endCol)&&(c=r,s=a));g.publish(l.Listener,S.CellAction.VALUE.SET,{RID:e,SHEETID:n,VERSION:i,ROW:E.getActiveRow(),COL:E.getActiveCol(),VALUE:{DisplayValue:""},FOCUS:!0}),g.publish(l.Listener,"InsertFunction",{RID:e,SHEETID:n,VERSION:i,FUNCTION:s,ARGS:c}),d&&g.publish(l.Listener,S.RangePicker.Update,{RID:e,SHEETID:n,VERSION:i,RANGE:d})}(e,A.getActiveSheet(),r,c,n,d,C)}),h.open(i.AUTO_SUM),h.send(N)}}(this);
!function(e){var t,n=e.sPlusPlus,E=e.ZSConstants,o=e.ZSClass,r=e.ZSEvents,S=e.JSUtil,i=e.UserAction,s=n.SML.Client,a=n.data.UserInfo,R=s.Utility.WorkerRequest,d=r.topic,c=r.Groups,I=r.Names,O=o.ActionObject,T=E.ActionConstants,H=E.URI,h=o.SelectorHelper.Constants,u=E.I18N;i.InsertSheet=function(e,t,E,r,S,i,s){var a={RID:e,sheetList:new o.ParamGenerator(t,e,E,!0,!0).getSheets(),VERSION:E,INSERT:[[r,S]],isPivotSheet:i,USE_ACTIVE_SHEET_POS:s,action:T.SHEET_INSERT},h=new O(T.SHEET_INSERT,a),u=new R;u.addEventListeners("onComplete",function(e){h.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(h)}),u.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),u.open(H.WORKSHEETS_INSERT),u.send(a)},i.InsertPivotSheet=function(e,t,E,r,S,i,s){var a=new o.ParamGenerator(t,e,E,!0,!0).getSheets(),h={RID:e,sheetList:a,VERSION:E,INSERT:[[r,S]],isPivotSheet:i,USE_ACTIVE_SHEET_POS:s,action:T.SHEET_INSERT},u=new O(T.SHEET_INSERT,h),p=new R;p.addEventListeners("onComplete",function(t){d.publish(c.Listener,I.DocMeta.SHEET_ACTION_LISTENER,{RID:e,VERSION:E,qaid:t.qaid,isPivotSheet:i}),u.qaid=t.qaid,n.data.UserInfo.ActionRecorder.record(u)}),p.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(H.WORKSHEETS_INSERT),p.send(h)},i.RemoveSheet=function(e,t,E){var r={RID:e,VERSION:E,sheetList:new o.ParamGenerator(t,e,E,!0,!0).getSheets(),action:T.SHEET_REMOVE},S=new O(T.SHEET_REMOVE,r);!function(e,t,E){n.data.getWorkBook(e,E);var o=a.activeInfo.getVisualCueStatus(),r=n.view.getActiveGridID(),S=n.view.getSheetID(r),i=n.view.getActiveState(r).getFormulaState();t===S&&(d.publish(c.Selector.BoundUpdate.Cell,I.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:E}),o&&d.publish(c.Selector.BoundUpdate.Copy,I.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:E,VisualCueStatus:h.CUESTATUS.VISIBLE}),d.publish(c.Selector.BoundUpdate.Range,I.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:E}),d.publish(c.Selector.BoundUpdate.CellEdit,I.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:E}),d.publish(c.Selector.BoundUpdate.FillSeries,I.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:E}),d.publish(c.Listener,I.SheetAction.PROTECTED_RANGES.HIDE,{RID:e,SHEETID:t,VERSION:E}),i&&d.publish(c.Selector.BoundUpdate.Formula,I.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:E}))}(e,t[0],E);var i=new R;i.addEventListeners("onComplete",function(e){S.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(S)}),i.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),i.open(H.WORKSHEETS_DELETE),i.send(r)},i.MoveSheet=function(e,t,E,r){if(n.data.getWorkBook(e,E).SheetList.getPosById(t[0])!=r){var S={RID:e,VERSION:E,sheetList:new o.ParamGenerator(t,e,E,!0,!0).getSheets(),POSITION:r,action:T.SHEET_MOVE},i=new O(T.SHEET_MOVE,S),s=new R;s.addEventListeners("onComplete",function(e){i.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(i)}),s.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),s.open(H.WORKSHEETS_MOVE),s.send(S)}},i.RenameSheet=function(e,t,E,r){var S=n.data.getWorkBook(e,E),i={RID:e,VERSION:E,sheetList:new o.ParamGenerator(t,e,E).getSheets(),newSheetName:r,oldSheetName:S.SheetList.getById(t[0]).Name,action:T.SHEET_RENAME},s=new O(T.SHEET_RENAME,i),a=new R;a.addEventListeners("onComplete",function(e){s.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(s)}),a.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),a.open(H.WORKSHEETS_RENAME),a.send(i)},i.TabColorSheet=function(e,t,E,r){var S=n.data.getWorkBook(e,E),i={RID:e,sheetList:new o.ParamGenerator(t,e,E,!0,!0).getSheets(),currSheetName:S.getSheetObj(t[0]).Prop.Name,TABCOLOR:r,VERSION:E,action:T.SHEET_TABCOLOR},s=new O(T.SHEET_TABCOLOR,i),a=new R;a.addEventListeners("onComplete",function(e){s.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(s)}),a.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),a.open(H.WORKSHEETS_TABCOLOR),a.send(i)},i.CopySheet=function(e,t,E,r,S,i){n.data.getWorkBook(e,E);var s={RID:e,VERSION:E,sheetList:new o.ParamGenerator(t,e,E,!0,!0).getSheets(),sheetName:r,subMode:S,action:T.SHEET_COPY},a=new O(T.SHEET_COPY,s),h=new R;h.addEventListeners("onComplete",function(e){a.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(a)}),h.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(H.WORKSHEETS_COPYSHEET),h.send(s)},i.PasteSheet=function(e,t,E,r,S){n.data.getWorkBook(e,E);var i=n.view.getActiveGridID(),s={RID:e,sheetList:new o.ParamGenerator(t,e,E,!0,!0).getSheets(),CURRENTSHEETID:n.view.getSheetID(i),SHEETNAME:r,VERSION:E,action:T.SERVERCLIP_PASTE_SHEET,isCopyRefSheets:S},a=new O(T.SERVERCLIP_PASTE_SHEET,s),h=new R;h.addEventListeners("onComplete",function(e){a.qaid=e.qaid,n.data.UserInfo.ActionRecorder.record(a)}),h.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),h.open(H.WORKSHEETS_PASTESHEET),h.send(s)},i.serverClipCopySheet=function(e,E,r,i){n.data.getWorkBook(e,r);var s=new o.ParamGenerator(E,e,r,!0,!0).getSheets(),a={RID:e,sheetList:s,SHEETSTOCOPY:s[0],VERSION:r,SHEETNAME:i,action:T.SERVERCLIP_COPY_SHEET},h=S.fn.replaceParams(u["CopySheet.ProgressMessage"],[i]);(t=new o.TBNotification(h,{mode:"STD",type:"info"})).show(!0),new O(T.SERVERCLIP_COPY_SHEET,a);var p=new R;p.addEventListeners("onComplete",function(e){t.remove();var n=u["CopyClip.SheetCopy.SuccessMsg"];new o.TBNotification(n,{type:"info"}).show()}),p.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(H.WORKSHEETS_SERVERCOPYSHEET),p.send(a)},i.serverClipCopytoNewSheet=function(e,E,r,S,i){n.data.getWorkBook(e,r);var s=new o.ParamGenerator(E,e,r,!0,!0).getSheets(),a={RID:e,sheetList:s,SHEETNAME:S,VERSION:r,isCopyRefSheets:i,action:T.SHEET_COPY_CREATE_NEW_SPREADSHEET},h=u["CopySheet.Create.New.Spreadsheet.ProgressMessage"];(t=new o.TBNotification(h,{mode:"STD",type:"info"})).show(!0),new O(T.SHEET_COPY_CREATE_NEW_SPREADSHEET,a);var p=new R;p.addEventListeners("onComplete",function(n){n.newRID&&d.publish(c.Listener,I.DocAction.WORKSHEETS.SERVERCOPYSHEET,{RID:e,VERSION:r,SHEETID:E[0],NEWRID:n.newRID}),t.remove()}),p.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(H.WORKSHEETS_COPY_TO_NEW_SPREADSHEET),p.send(a)},i.DuplicateSheet=function(e,t,E,r,S,i){n.data.getWorkBook(e,E);var s={RID:e,sheetList:new o.ParamGenerator(t,e,E,!0,!0).getSheets(),VERSION:E,copyLocks:S,insertAfter:i,action:T.SHEET_DUPLICATE},a=(new O(T.SHEET_DUPLICATE,s),new R);a.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),a.open(H.DUPLICATE_SHEET),a.send(s)},i.HideSheet=function(e,t,n){var E={RID:e,SHEETLIST:new o.ParamGenerator(t,e,n,!0,!0).getSheets(),VERSION:n,isHidden:!0,action:T.SHEET_VISIBLE},r=new R;r.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),r.open(H.HIDE_SHEET),r.send(E)},i.unHideSheet=function(e,t,n,E){var r=new o.ParamGenerator(t,e,n,!0,!0).getSheets(),S={RID:e,SHEETLIST:r,VERSION:n,isHidden:!1,action:T.SHEET_VISIBLE},i=new R;i.addEventListeners("onComplete",function(o){E&&E(e,t[0],n)}),i.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),i.open(H.UNHIDE_SHEET),i.send(S)},i.CopyRefSheets=function(t,E,o,r,S){var i=n.data.getWorkBook(t,E).getSheetObj(o[0]).Prop.Name,s=(new e.ZSClass.ParamGenerator(o,t,E,!0,!0),n.view.getActiveGridID()),a=n.view.getSheetID(s),O=T.SERVERCLIP_GET_REFSHEETS,h={RID:t,VERSION:E,from:r,currentSheet:a,currentSheetName:i,action:O},u=new R;u.addEventListeners("onComplete",function(e){e.refsheetList&&S(t,o,E,e.refsheetList,r),e.a&&e.a===T.SHOW_ERROR_MESSAGE&&Logger.log("COPY Error case has to be handled")}),u.addEventListeners("onError",function(e){d.publish(c.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})});var p=H.SERVERCLIP_GET_REFSHEETS;u.open(p),u.send(h)}}(this);
!function(e){var t=e.sPlusPlus,i=e.ZSEvents,E=i.topic,S=i.Groups,I=i.Names,o=e.ZSConstants,n=o.I18N,s=t.SML.Client.Utility.WorkerRequest,D=o.URI,R=e.ZSClass.SelectorHelper.Constants,r=t.data.UserInfo;e.UserAction.SwitchSheet=function(i,l,T,a,O,c,A,u){var H=t.data.getWorkBook(i,T);if(void 0!=H.SheetList.getPosById(a,!0)){var h=H.getSheetObj(a),N=h.Visited,p={RID:i,toSheet:a,VERSION:T,visited:N};if(a!=l){h&&function(e,t,i,o){var s=ZSClass.RangePicker&&ZSClass.RangePicker.isSelection();E.publish(S.UserAction,I.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,{RID:e,SHEETID:t,VERSION:i,TARGET_SHEET:o}),!s&&E.publish(S.Selector.BoundUpdate.CellEdit,I.Selection.BOUND_UPDATE.REMOVE,{RID:e,SHEETID:t,VERSION:i,isSubmittable:!0}),E.publish(S.Listener,I.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:e,SHEETID:t,VERSION:i}),E.publish(S.UI,I.Layout.DATA_LOADER.SHOW,{MSG:n["LP.LODING"]})}(i,l,T,a);var C=new s;C.addEventListeners("onComplete",function(n){var s=n,D=t.data.getWorkBook(i,T);if(h=D.getSheetObj(a),function(e,i,o){var n=t.data.getWorkBook(e,o).getSheetObj(i),s=t.view.getActiveGridID(),D=t.view.getActiveState(s);if(n){r.activeInfo.getVisualCueStatus()?E.publish(S.Selector.BoundUpdate.Copy,I.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:i,VERSION:o,VisualCueStatus:R.CUESTATUS.VISIBLE}):D.getFormatPainterState()&&E.publish(S.Selector.BoundUpdate.FormatPainter,I.Selection.BOUND_UPDATE.REMOVEDOM,{RID:e,SHEETID:i,VERSION:o}),E.publish(S.Listener,I.SheetAction.PROTECTED_RANGES.HIDE,{RID:e,SHEETID:i,VERSION:o}),E.publish(S.Listener,I.DocAction.COLLAB_LIST.HIDE,{RID:e,SHEETID:i,VERSION:o}),E.publish(S.Listener,I.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:e,SHEETID:i,VERSION:o});var l=n.DataFilters.getAllRanges();for(var T in l){var a=l[T],O=new ZSClass.Range(a.startRow,a.startCol,a.endRow,a.endCol);E.publish(S.UserAction,I.SheetAction.DATAFILTER.HIDE,{RID:e,SHEETID:i,VERSION:o,FRANGE:O})}}}(i,l,T),N){var H=t.view.getActiveGridID(),p=t.view.getSheetState(H,a),C=p.getScrollTops(),L=p.getScrollLefts();e.UserAction.ScrollTo(i,a,T,L[0],C[0],L[1],C[1])}!function(e){var i=t.view.getActiveGridID(),n=t.view.getVersionID(i);e[o.CommandConstants.DOCUMENT_META]&&E.publish(S.Listener,I.ServerAction.PROCESSRESPONSE,{RESPONSE:e,VERSION:n});var s=t.view.getResourceID(i),D=t.view.getSheetID(i);E.publish(S.Listener,I.UserAction.PIVOT.FILTER_SHOW,{RID:s,SHEETID:D,VERSION:n})}(s),function(e,i,o,n){var s=t.data.getWorkBook(e,o),D=t.view.getActiveGridID(),R=t.view.getSheetState(D,i),l=t.view.getActiveState(D),T=R.getZoom(),a=s.getSheetObj(i),O=a.gridSpacing,c=a.gridDirection;if(n){var A=r.activeInfo.getVisualCueStatus();if(E.publish(S.Listener,I.SheetAction.SHEET_DIRECTION.MODIFY,{RID:e,SHEETID:i,VERSION:o,DIRECTION:c}),E.publish(S.Listener,I.SheetAction.GRID_SPACING.MODIFY,{RID:e,SHEETID:i,VERSION:o,GRID_SPACING:O,ISSHEETSWITCH:!0}),E.publish(S.Listener,I.SheetAction.ZOOM.On,{RID:e,SHEETID:i,VERSION:o,ZOOM:T}),A)E.publish(S.Selector.BoundUpdate.Copy,I.Selection.BOUND_UPDATE.SHOW,{RID:e,SHEETID:i,VERSION:o});else{var u=l.getFormatPainterState(),H=R.getActiveRange();u&&E.publish(S.Selector.BoundUpdate.FormatPainter,I.Selection.BOUND_UPDATE.ADDDOM,{RID:e,SHEETID:i,VERSION:o,RANGE:H,TYPE:0,IS_SERVER_CLIP:!1})}E.publish(S.UserAction,I.SheetAction.DATAFILTER.SHOW,{RID:e,SHEETID:i,VERSION:o}),E.publish(S.Listener,I.UserAction.PIVOT.FILTER_SHOW,{RID:e,SHEETID:i,VERSION:o})}E.publish(S.Listener,I.DocAction.COLLAB_LIST.SHOW,{RID:e,SHEETID:i,VERSION:o}),E.publish(S.Listener,I.SheetAction.BUTTONS.REPAINT,{RID:e,SHEETID:i,VERSION:o}),E.publish(S.Listener,I.SheetAction.IMAGES.REPAINT,{RID:e,SHEETID:i,VERSION:o}),E.publish(S.Listener,I.UserAction.PIVOT.PIVOTPLACEHOLDER_REPAINT,{RID:e,SHEETID:i,VERSION:o}),s.highlightComments&&E.publish(S.Listener,I.SheetAction.HIGHLIGHT_COMMENTS.REPAINT,{RID:e,SHEETID:i,VERSION:o})}(i,a,T,N),!O&&function(e,i,o){var n=t.view.getActiveGridID();t.view.getSheetState(n,i)&&(t.data.getWorkBook(e,o).getSheetObj(i),E.publish(S.Selector.BoundUpdate.Cell,I.Selection.BOUND_UPDATE.SHOW,{RID:e,SHEETID:i,VERSION:o}),E.publish(S.Selector.BoundUpdate.Range,I.Selection.BOUND_UPDATE.SHOW,{RID:e,SHEETID:i,VERSION:o}),E.publish(S.Listener,I.RangePicker.ReHighlight))}(i,a,T),O&&function(t,i,o,n){E.publish(S.Selector.BoundUpdate.Range,I.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:i,VERSION:o,RANGE:n,TYPE:n.TYPE}),E.publish(S.Selector.BoundUpdate.Cell,I.Selection.BOUND_UPDATE.ADD,{RID:t,SHEETID:i,VERSION:o,ActiveCellRange:n,ROW:n.startRow,COL:n.startCol,TYPE:n.TYPE}),e.UserAction.ScrollCellIntoView(t,i,o,n.startRow,n.startCol)}(i,a,T,O),E.publish(S.Listener,I.Browser.UISheetLoad),e.UserAction.UpdateContentViewport(i,a,T),E.publish(S.Listener,I.DocAction.WORKSHEETS.SWITCHSHEET,{NEWSHEETID:a,RID:i,VERSION:T,SHEETID:l}),E.publish(S.Listener,I.SheetAction.CHARTS.REPAINT,{RID:i,SHEETID:a,VERSION:T}),c&&E.publish(S.Listener,I.UserAction.PIVOT.SHEETINSERT_CALLBACK,{NEWSHEETID:a}),A&&A.apply(void 0,u)}),C.addEventListeners("onError",function(e){E.publish(S.Listener,I.ERROR.SHOW,{ERRORMSG:e.mk})}),C.open(D.ACTIVE_SHEET_SWITCH),C.send(p)}}}}(this);
!function(n){var e=n.sPlusPlus.SML.Client.Utility.WorkerRequest,t=ZSConstants.URI,o=n.ZSConstants.ActionConstants;n.UserAction.delugeGetAllAction=function(n,o,i,r){var s={RID:n,version:o,action:i},E=new e;E.addEventListeners("onComplete",function(n){r&&r(n,i)}),E.addEventListeners("onError",function(n){}),E.open(t.DELUGE_GETALL),E.send(s)},n.UserAction.delugeCreateAction=function(n,o,i,r,s,E){var c={RID:n,version:o,action:i,script:r,description:s},d=new e;d.addEventListeners("onComplete",function(n){E&&E(n,i)}),d.addEventListeners("onError",function(n){}),d.open(t.DELUGE_CREATE),d.send(c)},n.UserAction.delugeExecuteAction=function(n,o,i,r,s,E){var c={RID:n,version:o,action:i,funcId:r,parameter:s},d=new e;d.addEventListeners("onComplete",function(n){E&&E(r,n,i)}),d.addEventListeners("onError",function(n){}),d.open(t.DELUGE_EXECUTE),d.send(c)},n.UserAction.delugeUpdateAction=function(n,o,i,r,s,E){var c={RID:n,version:o,action:i,funcId:r,script:s},d=new e;d.addEventListeners("onComplete",function(n){E&&E(n,i)}),d.addEventListeners("onError",function(n){}),d.open(t.DELUGE_UPDATE),d.send(c)},n.UserAction.delugeGetDetailsAction=function(n,i,r,s){var E={RID:n,version:i,action:o.DRE_GETDETAIL,funcName:r},c=new e;c.addEventListeners("onComplete",function(n){s&&s(n)}),c.addEventListeners("onError",function(n){}),c.open(t.DELUGE_GETDETAIL),c.send(E)},n.UserAction.delugeDeleteAction=function(n,i,r,s,E){var c={RID:n,version:i,action:o.DRE_DELETE,funcName:r},d=new e;d.addEventListeners("onComplete",function(n){s&&s(n,E)}),d.addEventListeners("onError",function(n){}),d.open(t.DELUGE_DELETE),d.send(c)},n.UserAction.delugeCreateAndExecuteAction=function(n,o,i,r,s,E){var c={RID:n,version:o,action:i,script:r,parameter:s},d=new e;d.addEventListeners("onComplete",function(n){E&&E(n,i)}),d.addEventListeners("onError",function(n){}),d.open(t.DELUGE_CREATEANDEXECUTE),d.send(c)},n.UserAction.delugeUpdateAndExecuteAction=function(n,o,i,r,s,E,c){var d={RID:n,version:o,action:i,funcName:r,script:s,parameter:E},a=new e;a.addEventListeners("onComplete",function(n){c&&c(n)}),a.addEventListeners("onError",function(n){}),a.open(t.DELUGE_UPDATEANDEXECUTE),a.send(d)},n.UserAction.delugeGetFunctionName=function(n,o,i,r){var s={RID:n,version:o,action:i},E=new e;E.addEventListeners("onComplete",function(n){r&&r(n.delugeResponse,!0)}),E.addEventListeners("onError",function(n){}),E.open(t.DELUGE_GETNAME),E.send(s)}}(this);
!function(t){var e=t.sPlusPlus,s=(t.ZSClass.ActionObject,e.SML.Client.Utility.WorkerRequest),n=t.ZSEvents,a=n.topic,o=n.Groups,i=n.Names,r=t.ZSConstants,C=r.URI;r.I18N,r.ActionConstants;t.UserAction.chat=function(t,e,n,a){var o={sheetList:new ZSClass.ParamGenerator(e,t,n,!0).getSheets(),VERSION:n,RID:t,msg:a},i=new s;i.open(C.COLLAB_CHAT),i.send(o)},t.UserAction.getChat=function(t,e,n,r,c,u){var A={sheetList:new ZSClass.ParamGenerator(e,t,n,!0).getSheets(),VERSION:n,RID:t,chatCount:r,latestChatTime:c,lastChatCount:u},h=new s;h.addEventListeners("onComplete",function(t){a.publish(o.Listener,i.UserAction.COLLAB_CHAT.GETCHAT,{response:t})}),h.open(C.COLLAB_GETCHAT),h.send(A)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,i=n.topic,r=n.Groups,o=n.Names,a=e.ZSClass,s=t.SML.Client.Utility.WorkerRequest,d=a.ActionObject,R=e.ZSConstants.ActionConstants,O=e.ZSConstants.PivotConstant,c=e.ZSConstants.URI,I=e.ZSConstants.CommandConstants;e.UserAction.createPivot=function(n,E,v,T,P,A){P=P||!1,A=A||!1;var l=new a.ParamGenerator(E,n,v),L=l.getRanges(),S=l.getSheets(),p=l.getActiveCell();if(!P){var C=T[I.TARGET],_=[];_.push(C[0]);var u=new a.ParamGenerator(_,n,v),g=u.getSheets(),f=new a.Range(C[1],C[2],C[3],C[4]),h=u.getCustomRanges(f)}var V=T[I.SOURCE],N=[];N.push(V[0]);var w=new a.ParamGenerator(N,n,v),m=w.getSheets(),D=new a.Range(V[1],V[2],V[3],V[4]),G=w.getCustomRanges(D),U=t.view.getActiveGridID(),H=(n=t.view.getResourceID(U),v=t.view.getVersionID(U),e.ZSClass.Pivot.Util.getPrimitiveFnFromStr(T.fn));a.Pivot.currentPivotId,T[O.ROW_FIELDS].length<1&&T[O.COLUMN_FIELDS].length<1&&T[O.DATA_FIELDS].length<1?T.fieldsExist=!1:T.fieldsExist=!0;var F,q={RID:n,sheetList:S,rangeList:L,srcSheetList:m,srcRangeList:G,dstnSheetList:P?void 0:g,dstnRangeList:P?void 0:h,activeCell:p,VERSION:v,pf:T.pf,rf:T.rf,cf:T.cf,df:T.df,fn:H,pivotId:T.id,group:T.gr,num_group:T.num_gr,isNewSheet:P,overwriteData:A,pfd:T[O.PIVOT_FILTER_DETAILS],psd:T[O.PIVOT_SORT_DETAILS],theme:T.ptid,sto:T.sto?1:0,rgto:T.rgto?1:0,cgto:T.cgto?1:0,aRef:T.aRef?1:0,aExp:T.aExp?1:0,fieldsExist:T.fieldsExist,isFromZia:T.isFromZia};F=new d("temp"===q.pivotId?R.CREATE_PIVOT:R.EDIT_PIVOT,q);var M=new s;M.addEventListeners("onComplete",function(e){P&&i.publish(r.Listener,o.DocMeta.SHEET_ACTION_LISTENER,{RID:n,VERSION:v,qaid:e.qaid,isSwitchAction:!0});var a=e.qaid;F.qaid=a,t.data.UserInfo.ActionRecorder.record(F)}),"temp"===q.pivotId?(M.open(c.CREATE_PIVOT),a.Pivot.LastAction="CREATE_PIVOT"):(M.open(c.EDIT_PIVOT),a.Pivot.LastAction="EDIT_PIVOT"),M.send(q)},e.UserAction.changePivotSource=function(e,n,O,I,E,v){var T=new a.ParamGenerator(n,e,O),P={RID:e,sheetList:T.getSheets(),activeCell:T.getActiveCell(),VERSION:O,rangeList:T.getCustomRanges(E),overwriteData:v,pivotId:I,action:R.CHANGE_PIVOT_SOURCE},A=new d(R.CHANGE_PIVOT_SOURCE,P),l=new s;l.addEventListeners("onComplete",function(e){var n=e.qaid;A.qaid=n,t.data.UserInfo.ActionRecorder.record(A)}),l.addEventListeners("onError",function(e){i.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),a.Pivot.LastAction="CHANGE_PIVOT_SOURCE",l.open(c.CHANGE_PIVOT_SOURCE),l.send(P)},e.UserAction.deletePivot=function(e,n,O,I){var E=t.view.getActiveGridID(),v=(e=t.view.getResourceID(E),O=t.view.getVersionID(E),new a.ParamGenerator(n,e,O)),T={RID:e,sheetList:v.getSheets(),activeCell:v.getActiveCell(),VERSION:O,pivotId:I},P=new d(R.DELETE_PIVOT,T),A=new s;A.addEventListeners("onComplete",function(e){var n=e.qaid;P.qaid=n,t.data.UserInfo.ActionRecorder.record(P)}),A.addEventListeners("onError",function(e){i.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(c.DELETE_PIVOT),A.send(T)},e.UserAction.movePivot=function(e,n,O,I,E,v,T,P){var A=n[0],l=new a.ParamGenerator(n,e,O),L=l.getSheets(),S=l.getRanges(),p=l.getActiveCell();if(T)var C=new a.Range(0,0,0,0),_=l.getCustomRanges(C);else{var u=[];u.push(E.sheetID);var g=new a.ParamGenerator(u,e,O),f=g.getSheets();_=g.getCustomRanges(E.range)}var h={RID:e,sheetList:L,activeCell:p,VERSION:O,isNewSheet:T,rangeList:S,dstnSheetList:T?void 0:f,dstnRangeList:T?void 0:_,overwriteData:v,pivotId:I,actionType:P};if("copy"===P)var V=new d(R.COPY_PIVOT,h);else"move"===P&&(V=new d(R.MOVE_PIVOT,h));var N=new s;N.addEventListeners("onComplete",function(n){(T||A!=E.sheetID)&&i.publish(r.Listener,o.DocMeta.SHEET_ACTION_LISTENER,{RID:e,VERSION:O,qaid:n.qaid,isSwitchAction:!0});var a=n.qaid;V.qaid=a,t.data.UserInfo.ActionRecorder.record(V)}),N.addEventListeners("onError",function(e){sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_MOVE].handleError(e.mk)}),"copy"===P?N.open(c.COPY_PIVOT):"move"===P&&N.open(c.MOVE_PIVOT),N.send(h)},e.UserAction.refreshPivot=function(e,n,O,I,E){var v=new a.ParamGenerator(n,e,O),T={RID:e,sheetList:v.getSheets(),activeCell:v.getActiveCell(),VERSION:O,overwriteData:E,pivotId:I};if(I)var P=new d(R.REFRESH_PIVOT,T);else P=new d(R.REFRESH_ALL_PIVOT,T);var A=new s;A.addEventListeners("onComplete",function(e){var n=e.qaid;P.qaid=n,t.data.UserInfo.ActionRecorder.record(P)}),A.addEventListeners("onError",function(e){i.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk,ACTION:"REFRESH_PIVOT"})}),I?(A.open(c.REFRESH_PIVOT),a.Pivot.LastAction="REFRESH_PIVOT"):(A.open(c.REFRESH_ALL_PIVOT),a.Pivot.LastAction="REFRESH_ALL_PIVOT"),A.send(T)},e.UserAction.changePivotStyle=function(e,n,O,I,E,v,T){var P=new a.ParamGenerator(n,e,O),A={RID:e,sheetList:P.getSheets(),activeCell:P.getActiveCell(),VERSION:O,pivotId:I,themeId:v,colorId:E,accentId:T},l=new d(R.CHANGE_PIVOT_THEME,A),L=new s;L.addEventListeners("onComplete",function(e){var n=e.qaid;l.qaid=n,t.data.UserInfo.ActionRecorder.record(l)}),L.addEventListeners("onError",function(e){i.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),L.open(c.CHANGE_PIVOT_THEME),L.send(A)},e.UserAction.changeTotalOption=function(e,n,I,E,v,T){var P,A=new a.ParamGenerator(n,e,I),l={RID:e,sheetList:A.getSheets(),activeCell:A.getActiveCell(),VERSION:I,pivotId:E,value:T,groupId:v};switch(v){case O.SUBTOTALOPTION:P=new d(R.CHANGE_PIVOT_SUBTOTALOPTION,l);break;case O.ROWGRANDTOTALOPTION:P=new d(R.CHANGE_PIVOT_GRANDTOTALROWOPTION,l);break;case O.COLGRANDTOTALOPTION:P=new d(R.CHANGE_PIVOT_SUBTOTALOPTION,l)}var L=new s;switch(L.addEventListeners("onComplete",function(e){var n=e.qaid;P.qaid=n,t.data.UserInfo.ActionRecorder.record(P)}),L.addEventListeners("onError",function(e){i.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),v){case O.SUBTOTALOPTION:L.open(c.CHANGE_PIVOT_SUBTOTALOPTION);break;case O.ROWGRANDTOTALOPTION:case O.COLGRANDTOTALOPTION:L.open(c.CHANGE_PIVOT_GRANDTOTALROWOPTION)}L.send(l)},e.UserAction.changeAutoAction=function(e,n,I,E,v,T){var P,A=new a.ParamGenerator(n,e,I),l={RID:e,sheetList:A.getSheets(),activeCell:A.getActiveCell(),VERSION:I,pivotId:E,value:T,groupId:v};switch(v){case O.AUTOREFRESH:P=new d(R.PIVOT_AUTO_REFRESH,l);break;case O.AUTOEXPAND:P=new d(R.PIVOT_AUTO_EXPAND,l)}var L=new s;switch(L.addEventListeners("onComplete",function(e){var n=e.qaid;P.qaid=n,t.data.UserInfo.ActionRecorder.record(P)}),L.addEventListeners("onError",function(e){i.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),v){case O.AUTOREFRESH:L.open(c.PIVOT_AUTO_REFRESH);break;case O.AUTOEXPAND:L.open(c.PIVOT_AUTO_EXPAND)}L.send(l)},e.UserAction.applyPivotFilter=function(e,n,O,I,E,v,T,P,A,l,L,S,p){var C=new a.ParamGenerator(n,e,O),_={RID:e,sheetList:C.getSheets(),activeCell:C.getActiveCell(),VERSION:O,pivotID:I,fieldType:E,headerIndex:v,pivotFilterJsonParam:T,selectAll:P,filterType:A,operator:l,value:L,value2:S,dataFieldIndex:p},u=new d(R.APPLYFILTER_PIVOT,_),g=new s;g.addEventListeners("onComplete",function(e){var n=e.qaid;u.qaid=n,t.data.UserInfo.ActionRecorder.record(u)}),g.addEventListeners("onError",function(e){i.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk,ACTION:"APPLYFILTER_PIVOT"})}),g.open(c.APPLYFILTER_PIVOT),a.Pivot.LastAction="APPLYFILTER_PIVOT",g.send(_)},e.UserAction.applyPivotCustomFilter=function(e,n,O,I,E,v,T,P,A){var l=new a.ParamGenerator(n,e,O),L={RID:e,sheetList:l.getSheets(),activeCell:l.getActiveCell(),VERSION:O,pivotID:I,filterType:E,headerIndex:v,displayMemberMode:T,count:P,sortMode:A},S=new d(R.CHANGE_DISPLAYINFO_PIVOT,L),p=new s;p.addEventListeners("onComplete",function(e){var n=e.qaid;S.qaid=n,t.data.UserInfo.ActionRecorder.record(S)}),p.addEventListeners("onError",function(e){i.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk,ACTION:"CHANGE_DISPLAYINFO_PIVOT"})}),p.open(c.CHANGE_DISPLAYINFO_PIVOT),p.send(L)},e.UserAction.groupFields=function(e,n,O,I,E,v,T,P,A){var l=new a.ParamGenerator(n,e,O),L={RID:e,sheetList:l.getSheets(),activeCell:l.getActiveCell(),VERSION:O,rangeList:l.getRanges(),pivotId:I,groupMin:T,groupMax:P,rangeSize:A,fieldType:E,headerIndex:v,action:R.GROUPING_PIVOT_FIELDS},S=new d(R.GROUPING_PIVOT_FIELDS,L),p=new s;p.addEventListeners("onComplete",function(e){var n=e.qaid;S.qaid=n,t.data.UserInfo.ActionRecorder.record(S)}),p.addEventListeners("onError",function(e){i.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),a.Pivot.LastAction="GROUPING_PIVOT_FIELDS",p.open(c.GROUPING_PIVOT_FIELDS),p.send(L)},e.UserAction.sortPivot=function(e,n,O,I,E,v,T,P){var A=new a.ParamGenerator(n,e,O),l={RID:e,sheetList:A.getSheets(),activeCell:A.getActiveCell(),VERSION:O,pivotID:I,filterType:E,headerIndex:v,isAscending:T,sortMode:P},L=new d(R.SORT_PIVOT,l),S=new s;S.addEventListeners("onComplete",function(e){var n=e.qaid;L.qaid=n,t.data.UserInfo.ActionRecorder.record(L)}),S.addEventListeners("onError",function(e){i.publish(r.Listener,o.ERROR.SHOW,{ERRORMSG:e.mk})}),S.open(c.SORT_PIVOT),S.send(l)}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=n.topic,r=n.Groups,a=n.Names,i=e.ZSClass,o=t.SML.Client.Utility.WorkerRequest,E=i.ActionObject,l=e.ZSConstants.ActionConstants,R=e.ZSConstants.URI;e.UserAction.getPivotSRange=function(e,t,n){var c=new i.ParamGenerator(t,e,n,!0,!0),v={RID:e,sheetList:c.getSheets(),activeCell:c.getActiveCell(),VERSION:n,action:l.DETECT_PIVOT_RANGE},I=(new E(l.DETECT_PIVOT_RANGE,v),new o);I.addEventListeners("onComplete",function(e){s.publish(r.Listener,a.UserAction.PIVOT.DETECT_RANGE,{resp_Range:e})}),I.addEventListeners("onError",function(e){s.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),I.open(R.DETECT_PIVOT_RANGE),I.send(v)},e.UserAction.getPivotFields=function(e,t,n,s,r,a,c){var v,I=new i.ParamGenerator(t,e,n),u=I.getSheets(),C=I.getCustomRanges(s),T=I.getActiveCell();if(a){var g=[];g.push(a.sheetID);var A=new i.ParamGenerator(g,e,n),d=new i.Range(a.range.startRow,a.range.startCol,a.range.startRow+11,a.range.startCol+2);v=A.getCustomRanges(d)}var D={RID:e,sheetList:u,VERSION:n,rangeList:C,activeCell:T,targetRangeList:v,overwrite:c,action:l.READ_PIVOT_FIELDS},L=(new E(l.READ_PIVOT_FIELDS,D),new o);L.addEventListeners("onComplete",function(e){i.Pivot.Util.checkSourceChanges(e.data,r,c)}),L.addEventListeners("onError",function(e){sPlusPlus.view.Toolbar.Feature[ZSConstants.FeatureConstants.PIVOT_TABLE].handleError(e.mk)}),L.open(R.READ_PIVOT_FIELDS),L.send(D)},e.UserAction.getPivotFilterInfo=function(n,i,c,v,I,u){var C=t.view.getGridComponent(t.view.getActiveGridID());if(e.isCanvasGrid)var T=C.interacter.getCell(v,I).data.DisplayValue;else T=getCell(v,I).data.DisplayValue;var g={RID:n,SHEETID:i,VERSION:c,pivotID:u,cellValue:T},A=(new E(l.READ_PIVOT_FILTER_DATA,g),new o);A.addEventListeners("onComplete",function(e){s.publish(r.Listener,a.SheetAction.PIVOT.FILTER_INFO,{filterInfo:e})}),A.addEventListeners("onError",function(e){s.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),A.open(R.READ_PIVOT_FILTER_DATA),A.send(g)}}(this);
!function(e){var t=e.ZSEvents,n=t.Groups,r=e.sPlusPlus,a=t.Names,o=r.SML.Client,i=o.Utility.WorkerRequest,s=e.ZSClass.ActionObject,c=e.ZSConstants,v=o.Utility.WorkerRequest,C=c.URI,l=(e.encodeURIComponent,c.ActionConstants),S=(c.CommandConstants,e.ZSChart),d=e.ZSDevTools.Logger,R=e.UserAction;S.Server.Action.sendRequest=function(e,o,c,v,S,d,R){var A=l[S],h=C[S],g=new ZSClass.ParamGenerator([o],e,c,!1,!1),u=g.getSheets(),p=g.getActiveCell(),E={action:A,sheetList:u,rangeList:g.getRanges(),activeCell:p,sheetName:v,chartJson:d,RID:e,VERSION:c};R&&(E.url=R);var I=new s(A,E),L=new i;L.addEventListeners("onComplete",function(e){I.qaid=e.qaid,r.data.UserInfo.ActionRecorder.record(I)}),L.addEventListeners("onError",function(e){t.topic.publish(n.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),L.open(h),L.send(E)},S.Server.Action.RefreshChart=function(t,n,a){d.log("[CHART] >>>> Refreshing Affected Chart Meta",n);var o=r.view.getActiveGridID(),c=r.view.getResourceID(o),v=r.view.getVersionID(o),S=l.CHART_REFRESH,R=C.CHART_REFRESH,A=new ZSClass.ParamGenerator([t],c,v,!1,!1),h=A.getSheets(),g=A.getActiveCell(),u={actionCnst:S,sheetList:h,RID:c,VERSION:v,URL:"useraction",activeCell:g,chartList:e.JSON.stringify(n)},p=(new s(S,u),new i);p.addEventListeners("onComplete",function(e){a&&a({rID:c,version:v,sheetID:t,isActionOwner:!0,CHARTS:e[l.CHART].chartdetails})}),p.open(R),p.send(u)},S.Server.Action.pasteDesign=function(e,t,n,r){d.log("[Chart]>>>> Pasting Chart Clip >>>>>");var a=r.sID,o=r.cID,c=l.CHART_PASTE_STYLE,v=C.CHART_PASTE_STYLE,S=new ZSClass.ParamGenerator([t],e,n,!1,!1),R={action:c,sheetList:S.getSheets(),activeCell:S.getActiveCell(),RID:e,VERSION:n,sID:a,cID:o,URL:r.URL},A=(new s(c,R),new i);A.open(v),A.send(R)},S.Server.Action.Reposition=function(e,t,n,a,o,i,s,c,v,C){var l=r.data.getWorkBook(e,n).getSheetObj(t).Prop.Name,d=[],R={id:a,sc:c,sr:s,srd:v,scd:C,left:o,top:i,isReadChartOptions:!1};d.push(R),S.Server.Action.sendRequest(e,t,n,l,"CHART_MOVE",d)},S.Server.Action.Resize=function(e,t,n,a,o,i,s,c,v,C,l,d){var R=r.data.getWorkBook(e,n).getSheetObj(t).Prop.Name,A=[],h={id:a,sc:c,sr:s,srd:v,scd:C,left:o,top:i,ht:Math.abs(d),wd:Math.abs(l),isReadChartOptions:!1};A.push(h),S.Server.Action.sendRequest(e,t,n,R,"CHART_RESIZE",A)},S.Server.Action.RemoveChart=function(e,t,n,a){var o=r.data.getWorkBook(e,n).getSheetObj(t).Prop.Name,i=[{id:a}];S.Server.Action.sendRequest(e,t,n,o,"CHART_DELETE",i)},S.Server.Action.fetchChart=function(e,t,n,r,a,o,c){var v=l[r],S=C[r],d=new ZSClass.ParamGenerator([t],e,n,!0),R={action:v,sheetList:d.getSheets(),rangeList:d.getRanges(),activeCell:d.getActiveCell(),pivotId:a?ZSClass.Pivot.ID:null,RID:e,VERSION:n,isNotQueuedAction:c||!1},A=(new s(v,R),new i);A.addEventListeners("onComplete",function(e){var t=e.response_array;o(t.co)}),A.open(S),A.send(R)},S.Server.Action.updatePreview=function(e,t,n,r,a){var o=r.action,c=l[o],v=C[o],S=new ZSClass.ParamGenerator([t],e,n,!1,!1),d=S.getSheets(),R={action:c,activeCell:S.getActiveCell(),sheetList:d,RID:e,VERSION:n,actionProps:r.parameters,URL:r.url},A=(new s(c,R),new i);A.addEventListeners("onComplete",function(e){var t=e.chartOptions||e.response_array;a&&a(t.co)}),A.open(v),A.send(R)},S.Server.Action.updateChartOnGrid=function(e,t,n,a){var o=a.action,c=l[o],v=C[o],S=new ZSClass.ParamGenerator([t],e,n,!1,!1),d={action:c,sheetList:S.getSheets(),RID:e,activeCell:S.getActiveCell(),VERSION:n,actionProps:a.parameters,URL:a.url},R=new s(c,d),A=new i;A.addEventListeners("onComplete",function(e){R.qaid=e.qaid,r.data.UserInfo.ActionRecorder.record(R)}),A.open(v),A.send(d)},S.Server.Action.doQuickEditAction=function(e,t,n,a,o,i,s){var c=r.data.getWorkBook(e,n),v=r.view.getActiveGridID(),C=r.view.getSheetID(v),l=c.getSheetObj(C),d=[];for(var R in a){var A={};A.id=a[R],A.value=i,A.subAction=o,d.push(A)}S.Server.Action.sendRequest(e,t,n,l.Prop.Name,"CHART_QUICK_EDIT",d)},S.Server.Action.doQuickStyleAction=function(e,t,n,a,o,i){r.data.getWorkBook(e,n);var s=r.view.getActiveGridID(),c=r.view.getSheetID(s),v={};v.id=a,v.currentSheet=c,v.subAction=o,v.chartStyles=JSON.stringify(i);var C={};C.parameters=v,C.url="chartaction",C.action="CHART_QUICK_STYLE",S.Server.Action.updateChartOnGrid(e,t,n,C)},S.Server.Action.switchChart=function(e,t,n,a,o){d.log("[CHART] >>>> moveChart from one sheet to another sheet ",a);var c=a.ID,v=a.dSN,S=r.data.getWorkBook(e,n).getSheetObj(a.sSN);a.sSN=S.Prop.Name,c[0];var R="CHART_MOVE_TO_NEW_SHEET",A=l[R],h=C[R],g=new ZSClass.ParamGenerator([t],e,n,!1,!1),u={action:A,sheetList:g.getSheets(),activeCell:g.getActiveCell(),RID:e,VERSION:n,actionProps:a,URL:"chartaction"},p=new s(A,u),E=new i;E.addEventListeners("onComplete",function(a){p.qaid=a.qaid,r.data.UserInfo.ActionRecorder.record(p),o&&o(e,t,n,v)}),E.open(h),E.send(u)},S.Server.Action.copyClipToServer=function(e,t,n,r){d.log("[Chart]>>>> Updating Chart Server Clip ");var a=new ZSClass.ParamGenerator([t],e,n,!1,!1),o=a.getSheets(),c=a.getActiveCell(),v=r.sID,S=l.CHART_COPY_STYLE,R=C.CHART_COPY_STYLE,A={action:S,activeCell:c,sheetList:o,RID:e,VERSION:n,sID:v,URL:"useraction"},h=(new s(S,A),new i);h.open(R),h.send(A)},S.Server.Action.doPublicChart=function(e){var t=r.view.getActiveGridID(),n=r.view.getResourceID(t),a=r.view.getVersionID(t),o=r.data.getWorkBook(n,a),i=r.view.getSheetID(t),s=o.getSheetObj(i).Prop.Name,c=e.action,v=e.parameters;S.Server.Action.sendRequest(n,i,a,s,c,v)},S.Server.Action.fetchDecTable=function(e,t,n,r,a,o){var c=l.FETCH_DECLARATIVE_TABLE,v=C.FETCH_DECLARATIVE_TABLE,S=new ZSClass.ParamGenerator([t],e,n,!1,!1),d=S.getSheets(),R=S.getActiveCell(),A={actionCnst:c,sheetList:d,RID:e,VERSION:n,actionProps:r.parameters,URL:"previewaction",activeCell:R},h=(new s(c,A),new i);h.addEventListeners("onComplete",function(e){var t=e;(o=o||[]).push(t.decTable),a&&a.apply(this,o)}),h.open(v),h.send(A)},S.Server.doDetectTable=function(e,t,n,r,a,o){var c=l.DETECT_TABLE,v=C.DETECT_TABLE,S=new ZSClass.ParamGenerator([t],e,n,!1,!1),d=S.getSheets(),R=S.getActiveCell(),A=[],h=[];h.push(r),A.push(h);var g={actionCnst:c,sheetList:d,rangeList:A,RID:e,VERSION:n,URL:"useraction",activeCell:R},u=(new s(c,g),new i);u.addEventListeners("onComplete",function(e){a&&a(e)}),u.addEventListeners("onError",function(e){o&&o(e)}),u.open(v),u.send(g)},S.Server.Action.insertChartForRange=function(e,t,n,r,a,o,c){var v=l[a],S=C[a],d=new ZSClass.ParamGenerator([t],e,n,!0),R={action:v,sheetList:d.getSheets(),rangeList:r,activeCell:d.getActiveCell(),RID:e,VERSION:n,isNotQueuedAction:!1},A=(new s(v,R),new i);A.addEventListeners("onComplete",function(e){var t=e.response_array;o(t.co,c)}),A.open(S),A.send(R)},S.Server.Action.addChartToImageLibrary=function(e,t,n,r,a){var o="ADD_CHART_TO_IMAGE_LIBRARY",c=l[o],v=C[o],S=new ZSClass.ParamGenerator([t],e,n,!0),d={action:c,sheetList:S.getSheets(),rangeList:S.getRanges(),activeCell:S.getActiveCell(),RID:e,VERSION:n,chartID:r},R=(new s(c,d),new i);R.addEventListeners("onComplete",function(e){var t=e.status;a&&a(t)}),R.open(v),R.send(d)},S.Server.Action.doServerCopy=function(e,t,n,r){var a="SERVERCLIP_COPY_CHART",o=l[a],c=C[a],v=new ZSClass.ParamGenerator([t],e,n,!1,!1),S={action:o,sheetList:v.getSheets(),RID:e,VERSION:n,URL:"useraction",activeCell:v.getActiveCell(),encryptedID:r},d=(new s(o,S),new i);d.open(c),d.send(S)},R.updateChartOptions=function(e){var o=r.view.getActiveGridID(),i=r.view.getResourceID(o),c=r.view.getSheetID(o),S=r.view.getVersionID(o),d=new ZSClass.ParamGenerator([c],i,S,!0,!0),R=d.getSheets(),A={RID:i,VERSION:S,rangeList:d.getRanges(),sheetList:R,activeCell:d.getActiveCell(),chartId:e},h=(new s(l.CHART_GET_OPTIONS,A),new v);h.addEventListeners("onComplete",function(e){t.topic.publish(n.Listener,a.UserAction.CHARTS.UPDATE_OPTIONS,{CO:e.co})}),h.addEventListeners("onError",function(e){}),h.open(C.CHART_GET_OPTIONS),h.send(A)}}(this);
!function(e){var t=e.ZSChart,a=e.ZSClass,i=e.ZSEvents,n=i.Groups,r=(i.Names,i.topic),l=(t.Model,e.sPlusPlus),o=(e.ZSConstants.FeatureConstants,e.document,e.ZSConstants.I18N,e.ZSConstants.wCC,e.UIUtil.Component),g=(t.Constants.ChartRangePickerType,a.Editors.Utility,e.JSUtil,t.Constants.QuickStyleActions),s=t.Constants.QuickEditActions;function S(){t.Manager.DialogManager.call(this),this.unProcessed={},this.filterColumns=null,this.panel={open:!1,close:!0},this.rangeEditor={isEditing:!1,value:{prevValue:"",currValue:""}},this.SPMeta=new t.Model.SPMeta,this.SPMeta.init(),this.RECOMMENDATION=!1,this.TABEL_DEFINATION=!1,this.UPDATE_PANEL=!1}function T(){var e=t.Wrapper.DOMUtils,a=(t.Manager.SidePanelManager,new t.Manager.ZSCColorManager,e.getElementByClassName("pivotSpChrtTypesList"));"none"==a.style.display?e.show(a):e.hide(a)}function C(){try{var e=t.Manager.SidePanelManager,a=e.getChartType(e.getActiveChartID()[0]);return{COL3D:"COL",BAR3D:"BAR",PIE3D:"PIE",DOUGHNUT3D:"DOUGHNUT",STACKEDCOL3D:"STACKEDCOL",STACKEDCOL3D_PERCENT:"STACKEDCOL_PERCENT",STACKEDBAR3D:"STACKEDBAR",STACKEDBAR3D_PERCENT:"STACKEDBAR_PERCENT"}[a]||a}catch(e){}}function c(e){var a=["theme1","theme2","theme3","theme4","theme5","theme6"];a.forEach(function(t){e.classList.remove(t)});var i=t.Manager.SidePanelManager,n=i.getActiveChartThemeName(i.getActiveChartID()[0]);e.classList.add({"SHEET-OFFICE-COLORFUL-THEME1":"theme1","SHEET-OFFICE-COLORFUL-THEME2":"theme2","SHEET-OFFICE-COLORFUL-THEME3":"theme3","SHEET-OFFICE-COLORFUL-THEME4":"theme4","SHEET-OFFICE-COLORFUL-THEME5":"theme5","SHEET-OFFICE-COLORFUL-THEME6":"theme6"}[n]||a[0])}function A(e,a){var l=t.Manager.SidePanelManager;if(l.getActiveMeta()&&l.getActiveMeta().isPivotChart)return r.publish(n.UI,i.Names.SidePanel.CHARTS.TOGGLE_TO_NEEDED_TAB,{ev:void 0,TAB_NAME:"customTab"}),void(o=t.Wrapper.DOMUtils).showById("pivotChartTypeWrapper");var o=t.Wrapper.DOMUtils,g=(t.Manager.SidePanelManager,new t.Manager.ZSCColorManager),s=o.getElementByClassName("spChrtTypesList");if("none"==s.style.display){o.show(s);var S=o.getElementById("chartspContentDiv").getBoundingClientRect(),T=s.getBoundingClientRect(),A=S.height-T.top+S.top-10+"px";o.addStyle(s,{height:A});var d=C();if(!(d=C()))return;var I=s.querySelector("#"+d);if(null!=I){var E=I.parentNode.getBoundingClientRect(),D=s.getBoundingClientRect();E.y,D.y;I.checked=!0,I.setAttribute("checked","checked"),I.closest("div").scrollIntoView({block:"center"})}c(s)}else{if("none"!=s.style.display&&"OPEN"===a)return;D=s.getBoundingClientRect(),E=o.getElementById("chartRecommendTitle").getBoundingClientRect();setTimeout(function(){o.hide(s)},10)}g.hideColorScheme(),e&&e.stopPropagation()}function d(){t.Wrapper.DOMUtils.hideByClassName("spChrtTypesList"),t.Client.Action.removeBorderAnimation({ID:t.Utility.getActiveChart(!0)}),t.Client.Action.resetChartSelection({ID:t.Utility.getActiveChart(!0)}),r.publish(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.REMOVE_RECT,{ID:t.Utility.getActiveChart(!0)}),t.Client.Action.destroyContextualToolbar(-1,!0)}function I(e){t.Manager.SidePanelManager.TABEL_DEFINATION=!0;var a=l.view.getActiveGridID(),i=l.view.getResourceID(a),n=l.view.getVersionID(a),r=l.view.getSheetID(a),o=function(e,t,a){var i="",n=[];if(!e||""===e)return[];n=e.split(";");i="COLS"==t&&"VERTICAL"==a||"ROWS"==t&&"HORIZONTAL"==a?n[0]:e;return i}(e.getRange(),e.getSeriesIn(),e.getCombinedWay());if(null!=o&&0!=o.length){var g={parameters:{}};g.parameters.currentSheet=r,g.parameters.dataRange=e.getRange(),g.parameters.isCol="COLS"===e.getSeriesIn();var s=t.DecTable.initializeRangeMap(o);t.Server.Action.fetchDecTable(i,r,n,g,t.DecTable.processDecTableResponse,[g.parameters.isCol,o,s])}}function E(e){var a,i;a=e,i=t.Manager.SidePanelManager,(new t.Utility.CommanAgent).resetTitleCombo(),i.updateSidePanel(a||i.getActiveChartID()[0]),i.UPDATE_PANEL=!1,i.hideUnwantedProperty(a)}function D(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=e.cID,n=a.getDialogMeta(i),r=new t.Utility.ChartAgent,g={cbc:e.color,pbc:e.color};n.updateChartColor(e.color);var s=(new t.Model.ChartModel).getRGBA(e.color);o.zcolorselectbox("#chartcustomcolorDropDown1","setValue",s);var S=l.view.getActiveGridID(),T=l.view.getVersionID(S),C=l.view.getResourceID(S),c=l.view.getSheetID(S),A=new t.Controller.ZSCController,d=r.getChartMeta(i);d&&d.updateChartColor(s),A.updateCBC(C,c,T,d,g)}S.prototype=new t.Manager.DialogManager,S.prototype.setUnProcessed=function(e){this.unProcessedTask=e},S.prototype.getUnProcessed=function(){return this.unProcessedTask||{}},S.prototype.setPanelStatus=function(e){return this.panel=e,!0},S.prototype.enableRangeEditor=function(){this.rangeEditor.isEditing=!0},S.prototype.disableRangeEditor=function(){this.rangeEditor.isEditing=!1},S.prototype.isRangeEditing=function(){return this.rangeEditor.isEditing},S.prototype.setRangeValue=function(e,t){this.rangeEditor.value={prevValue:e,currValue:t}},S.prototype.isPanelOpen=function(){return this.panel.open},S.prototype.closeSidePanel=function(){var e=new t.Utility.CommanAgent;e.setDialogStatus(!1),e.removeDailogUtil(),this.clearSidePanelCached(),e.resetSidePanel()},S.prototype.setCurrentActionOwner=function(){this.currentActionOwner=!0},S.prototype.isCurrentActionOwner=function(){return this.currentActionOwner},S.prototype.resetCurrentActionOwner=function(){this.currentActionOwner=!1},S.prototype.clearDecTableAndAggregationUtility=function(){t.DecTable.clearRangeDecTableMap()},S.prototype.clearCache=function(){this.closeSidePanel(),this.clearDecTableAndAggregationUtility()},S.prototype.getActiveMeta=function(){var e=this.getActiveChartID(),t=null;if(e)return e.length>0&&(t=this.getMetaObject(e[0])),t},S.prototype.initPanelManager=function(){this.setIsSidePanel(!0)},S.prototype.init=function(e){var a=l.view.getActiveGridID(),i=l.view.getResourceID(a),n=l.view.getVersionID(a),r=l.view.getSheetID(a),o=l.view.getSheetState(a,r).getActiveRange();o.startRow,o.startCol,o.endRow,o.endCol;t.Server.Action.fetchChart(i,r,n,e?"PIVOT_CHART_DETAILS":"CHART_DETAILS",e,this.SPMeta.processResponse.bind(this.SPMeta)),this.RECOMMENDATION=!0},S.prototype.setFilterColumns=function(e){this.filterColumns=e},S.prototype.getFilterColumns=function(){return this.filterColumns},S.prototype.resetFocus=function(){return this.focusEventTwise=!1},t.Utility.UpdateSidePanel={TRENDLINE:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];a&&(new t.Utility.AgentDom).updateSeriesDom(a)},LEGEND:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateLegendRelatedDom(a),i.hidePropertyBasedOnMeta(a,!1)}},TITLE:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateTitleRelatedDom(a),i.hidePropertyBasedOnMeta(a,!1)}},XAXIS:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateXAxisRelatedDom(a),i.hidePropertyBasedOnMeta(a,!1)}},YAXIS:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateYAxisRelatedDom(a),i.hidePropertyBasedOnMeta(a,!1)}},FONTFAMILY:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateChartFontFamily(a),i.hidePropertyBasedOnMeta(a,!1)}},DATALABELS:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateDataLabelsDom(a),i.hidePropertyBasedOnMeta(a,!1)}},TOOLTIP:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateTooltipToggle(a),i.hidePropertyBasedOnMeta(a,!1)}},INVERTED:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateInvertedToggle(a),i.hidePropertyBasedOnMeta(a,!1)}},SPLINE:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateSplineToggle(a),i.hidePropertyBasedOnMeta(a,!1)}},RACE_CHART:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateRaceChartOptions(a),i.hidePropertyBasedOnMeta(a,!1)}},CAPTION:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateCaptionOptions(a),i.hidePropertyBasedOnMeta(a,!1)}},ANIMATION:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateAnimationToggle(a),i.hidePropertyBasedOnMeta(a,!1)}},AUTOEXPAND:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateAutoExpandToggle(a),i.hidePropertyBasedOnMeta(a,!1)}},MAJORMINOR:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateMajorMinor(a),i.hidePropertyBasedOnMeta(a,!1)}},BACKGROUNDCOLOR:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateBackgroundColorDom(a),i.hidePropertyBasedOnMeta(a,!1)}},GRIDLINECOLOR:function(e){var a=t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e];if(a){var i=new t.Utility.AgentDom;i.updateGlColorDom(a),i.hidePropertyBasedOnMeta(a,!1)}},AGGREGATION:function(e){try{if(!t.Manager.SidePanelManager.getDialogUtil().dialogMeta[e])return}catch(e){}}},t.Utility.updatePartOfPanel=function(e,a){var i=[];switch(e){case s.AGGREGATION:i.push("AGGREGATION");break;case g.LEGEND_STYLE:case s.LEGEND:i.push("LEGEND");break;case s.DATALABELS:i.push("DATALABELS");break;case g.XY_LABELS:i.push("XAXIS"),i.push("YAXIS");break;case g.STAGGER_LINES:case g.XY_REVERSE:case g.SLANT:case g.XAXIS_LABEL_STYLE:i.push("XAXIS");break;case g.XAXIS_TITLE_STYLE:case g.YAXIS_TITLE_STYLE:case g.TITLE_STYLE:case g.SUB_TITLE_STYLE:i.push("TITLE");break;case g.FONT_FAMILY:i.push("FONTFAMILY");break;case g.BACKGROUND_COLOR:i.push("BACKGROUNDCOLOR");break;case g.GRIDLINE_COLOR:i.push("GRIDLINECOLOR");break;case g.YAXIS_LABEL_STYLE:case g.YAXIS_MIN:case g.YAXIS_MAX:case g.YAXIS_INTERVAL:case g.PLOTLINE_TITLE:case g.PLOTLINE_TITLE_STYLE:case g.PLOTLINE_LABEL_STYLE:case g.ADD_OR_DELETE_PLOTLINE:case g.XY_LOGARITHMIC:case g.XY_BASEVALUE:case g.XY_OPPOSITE:i.push("YAXIS");break;case s.MAJOR:case s.MINOR:i.push("MAJORMINOR");break;case s.TOOLTIP:i.push("TOOLTIP");break;case s.INVERTED:i.push("INVERTED");break;case s.SPLINE:i.push("SPLINE");case s.ANIMATION:i.push("ANIMATION");break;case s.TRENDLINE:i.push("TRENDLINE");break;case g.ANIMATION_SPEED:case g.BAR_COUNT:case s.SORTING_TYPE:case 161:case 162:case 167:i.push("RACE_CHART");break;case g.CHART_CAPTION_FONTSIZE:case g.CHART_CAPTION_FONTWEIGHT:case g.CHART_CAPTION_FONTSTYLE:case g.CHART_CAPTION_FONTCOLOR:case g.ENABLE_CAPTION:i.push("CAPTION")}if(t.Manager.SidePanelManager.isPanelOpen())for(var n=0;n<i.length;n++){var r=i[n];t.Utility.UpdateSidePanel[r].call(this,a)}},t.Manager.SidePanelManager=new S,t.Action.doDeclarativeTableCall=I,r.register(n.UI,i.Names.SidePanel.CHARTS.UPDATE_ICON_THEME,c,"PARENT"),r.register(n.UserAction,i.Names.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,function(){!t.Manager.SidePanelManager.rangeEditor.isEditing&&r.publish(n.UI,i.Names.SidePanel.CHARTS.CLOSE)}),r.register(n.UI,i.Names.SidePanel.CHARTS.BINDEVENTS,function(){var e,a,i,n,r=t.Manager.SidePanelManager;r.setIsSidePanel(!0),r.setType("edit"),r.attachEventsForSP(),e=t.Wrapper.DOMUtils,a=e.getElementByClassName("spChrtTypes"),i=e.getElementById("pivotChartTypes"),n=e.getElementByClassName("sPanel"),e.addEventByNode(a,"click",A),e.addEventByNode(i,"click",T),e.addEventByNode(n,"click",d)}),r.register(n.UI,i.Names.SidePanel.CHARTS.METACONVERSION,function(e){if(d(),e){var a=t.Manager.SidePanelManager;a.isPanelOpen()&&(!function(e){if(e){var a=t.Manager.SidePanelManager;a.removeActiveChartID(),a.setActiveChartId(e),a.setIsSidePanel(!0),a.setType("edit")}}(e),function(e){var a=(new t.Utility.ChartAgent).getChartMeta(e),i=t.Manager.SidePanelManager;i.constructDialogMetaObject(a,e);var n=i.getMetaObject(e);n.setInstance(a.getInstance())}(e),a.RECOMMENDATION||a.checkForRecommendationsPopulated(a.getUnProcessed()))}},"CHART_ID"),r.register(n.UI,i.Names.SidePanel.CHARTS.HIDEPROPERTY,function(e,a){var i=t.Manager.SidePanelManager;if(i.isPanelOpen()&&e){var n=i.getDialogUtil().getDialogMeta(e);(new t.Utility.AgentDom).hidePropertyBasedOnMeta(n,!1,a)}},"CHART_ID","SUBACTION"),r.register(n.UI,i.Names.SidePanel.CHARTS.REFRESHBYMETA,E,"CHART_ID"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES,function(e){t.Manager.SidePanelManager.getDialogUtil().updateSeriesCustomization(e),(new t.Controller.ZSCController).doChartCustomization("series",e)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.CANVAS.FILL,D,"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.CANVAS.FONT_FAMILY,function(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=e.cID,n=a.getDialogMeta(i),r=new t.Utility.ChartAgent,g={style:{fontFamily:e.fontFamily}};o.zcombo("#chartfontfamilys","setValue",e.fontFamily),n.updateFontFamily(g);var s=l.view.getActiveGridID(),S=l.view.getVersionID(s),T=l.view.getResourceID(s),C=l.view.getSheetID(s);(new t.Controller.ZSCController).updateFontFamily(T,C,S,r.getChartMeta(i),g)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.CANVAS.TRANSPARACY,D,"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_SIZE,function(e){var a=e.fontSize;o.zcombo("#chartFont","setValue",a);var i=t.Manager.SidePanelManager.getDialogUtil(),n=new t.Utility.ChartAgent,r=e.cID,g=t.Utility.getTitleRelative(e.props.subAction),s=i.getSubAction(g,[r]),S=i.getTitleStyle(g,[r]),T=l.view.getActiveGridID(),C=l.view.getVersionID(T),c=l.view.getResourceID(T),A=l.view.getSheetID(T),d={};S.fontSize=e.fontSize,118==s&&(d.index=i.getActiveTitleIndex([r])),d.style=S;var I=n.getChartMeta(r);I.updateTitleStyle(s,S,d.index),(new t.Controller.ZSCController).updateTitleStyle(c,A,C,I,d,s)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_COLOR,function(e){var a=e.color,i=t.Manager.SidePanelManager,n=i.getDialogUtil(),r=new t.Utility.ChartAgent,l=new t.Controller.ZSCController,g=e.cID,s=t.Utility.getTitleRelative(e.props.subAction),S=n.getSubAction(s,[g]),T=n.getTitleStyle(s,[g]);S==t.Constants.TitleConstants.CHART_Y_AXIS_TITLE_STYLE&&(E.index=n.getActiveTitleIndex(activeObj));var C=(new t.Model.ChartModel).getRGBA(T.color),c=C&&r.isUniqueValue(C.replace(/ /g,""),a.replace(/ /g,"")),A=r.getChartMapFromSheet();if(!(A.length<4)){var d=A[3].get(i.getActiveChartID());c&&o.zcolorselectbox("#chartTitleFontColor","setValue",a);var I=i.getActiveMeta();c&&I.updateTitleStyle(S,T,s);var E={};r.getRGBAColor(T.color),T.color=a,E.style=T,c&&d.updateTitleStyle(r.fetchTitleLabelBasedOnSubAction(S),T,E.index),c&&l.updateTitleStyle(A[0],A[1],A[2],d,E,S)}},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_WEIGHT,function(e){t.Wrapper.DOMUtils.getElementById("chartTitlebold").click()},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.FONT_STYLE,function(e){t.Wrapper.DOMUtils.getElementById("chartTitleitalic").click()},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.ALIGNMENT,function(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=new t.Utility.ChartAgent,n=o.zcombo("#chartTitleCombo","getValue"),r=i.getSPActiveChartID(),l=(a.getSubAction(n,r),i.getChartMapFromSheet()),g=t.Manager.SidePanelManager;if(!(l.length<4)){var s=l[3],S=new t.Controller.ZSCController,T=s.get(r),C=e.alignment,c=g.getActiveMeta();c.updateTitleAlignment(119,C),c.updateTitleAlignment(120,C),T.updateTitleAlignment(i.fetchTitleLabelBasedOnSubAction(119),C),T.updateTitleAlignment(i.fetchTitleLabelBasedOnSubAction(120),C),d(),S.updateTitleAlignment(l[0],l[1],l[2],T,C,a.getSubActionForTitleAlignment("CHART_TITLE")),S.updateTitleAlignment(l[0],l[1],l[2],T,C,a.getSubActionForTitleAlignment("CHART_SUBTITLE"))}},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.TITLES.TEXT,function(e){var a=t.Wrapper.DOMUtils,i=(t.Manager.SidePanelManager.getDialogUtil(),a.getElementById("titleTextBox"));i.value=e.txt;var n=new Event("input");i.dispatchEvent(n)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_SIZE,function(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=(new t.Utility.ChartAgent,e.cID),n=l.view.getActiveGridID(),r=(l.view.getVersionID(n),l.view.getResourceID(n),l.view.getSheetID(n),e.fontSize);a&&a.updateXAxiesLabelStyle(i,{key:"fontSize",value:r}),(new t.Controller.ZSCController).doChartCustomization("haxis",{ID:i,style:{key:"fontSize",value:r}})},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_WEIGHT,function(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=(new t.Utility.ChartAgent,e.cID),n=l.view.getActiveGridID(),r=(l.view.getVersionID(n),l.view.getResourceID(n),l.view.getSheetID(n),e.bold?"normal":"bold");a&&a.updateXAxiesLabelStyle(i,{key:"fontWeight",value:r}),(new t.Controller.ZSCController).doChartCustomization("haxis",{ID:i,style:{key:"fontWeight",value:r}})},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_COLOR,function(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=new t.Utility.ChartAgent,n=e.cID,r=l.view.getActiveGridID(),o=(l.view.getVersionID(r),l.view.getResourceID(r),l.view.getSheetID(r),e.color),g=(a.getDialogMeta(n).getXAxis().labels||{}).style||{},s=(new t.Model.ChartModel).getRGBA(g.color);s&&i.isUniqueValue(s.replace(/ /g,""),o.replace(/ /g,""))&&(a&&a.updateXAxiesLabelStyle(n,{key:"color",value:o}),(new t.Controller.ZSCController).doChartCustomization("haxis",{ID:n,style:{key:"color",value:o}}))},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.HAXIS.FONT_STYLE,function(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=(new t.Utility.ChartAgent,e.cID),n=l.view.getActiveGridID(),r=(l.view.getVersionID(n),l.view.getResourceID(n),l.view.getSheetID(n),e.italic?"normal":"italic");a&&a.updateXAxiesLabelStyle(i,{key:"fontStyle",value:r}),(new t.Controller.ZSCController).doChartCustomization("haxis",{ID:i,style:{key:"fontStyle",value:r}})},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_SIZE,function(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=(new t.Utility.ChartAgent,e.cID),n=l.view.getActiveGridID(),r=(l.view.getVersionID(n),l.view.getResourceID(n),l.view.getSheetID(n),e.fontSize);a&&a.updateYAxiesLabelStyle(i,{key:"fontSize",value:r},e.props.index),(new t.Controller.ZSCController).doChartCustomization("vaxis",{ID:i,style:{key:"fontSize",value:r},yIndex:e.props.index})},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_WEIGHT,function(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=(new t.Utility.ChartAgent,e.cID),n=l.view.getActiveGridID(),r=(l.view.getVersionID(n),l.view.getResourceID(n),l.view.getSheetID(n),e.bold?"normal":"bold");a&&a.updateYAxiesLabelStyle(i,{key:"fontWeight",value:r},e.props.index),(new t.Controller.ZSCController).doChartCustomization("vaxis",{ID:i,style:{key:"fontWeight",value:r},yIndex:e.props.index})},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_COLOR,function(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=new t.Utility.ChartAgent,n=e.cID,r=l.view.getActiveGridID(),o=(l.view.getVersionID(r),l.view.getResourceID(r),l.view.getSheetID(r),e.color),g=(a.getDialogMeta(n).getYAxis()[e.props.index].labels||{}).style||{},s=(new t.Model.ChartModel).getRGBA(g.color);s&&i.isUniqueValue(s.replace(/ /g,""),o.replace(/ /g,""))&&(a&&a.updateYAxiesLabelStyle(n,{key:"color",value:o},e.props.index),(new t.Controller.ZSCController).doChartCustomization("vaxis",{ID:n,style:{key:"color",value:o},yIndex:e.props.index}))},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.FONT_STYLE,function(e){var a=t.Manager.SidePanelManager.getDialogUtil(),i=(new t.Utility.ChartAgent,e.cID),n=l.view.getActiveGridID(),r=(l.view.getVersionID(n),l.view.getResourceID(n),l.view.getSheetID(n),e.italic?"normal":"italic");a&&a.updateYAxiesLabelStyle(i,{key:"fontStyle",value:r},e.props.index),(new t.Controller.ZSCController).doChartCustomization("vaxis",{ID:i,style:{key:"fontStyle",value:r},yIndex:e.props.index})},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.MIN,function(e){var a=t.Wrapper.DOMUtils.getElementById("min");a.value=e.min;var i=new Event("change");a.dispatchEvent(i)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.MAX,function(e){var a=t.Wrapper.DOMUtils.getElementById("max");a.value=e.max;var i=new Event("change");a.dispatchEvent(i)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.VAXIS.INTERVAL,function(e){var a=t.Wrapper.DOMUtils.getElementById("interval");a.value=e.interval;var i=new Event("change");a.dispatchEvent(i)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_SIZE,function(e){o.zcombo("#legendFont","setValue",e.fontSize);var a,i=e.fontSize,n=l.view.getActiveGridID(),r=l.view.getVersionID(n),g=l.view.getResourceID(n),s=l.view.getSheetID(n),S=new t.Utility.ChartAgent,T=new t.Controller.ZSCController,C=t.Manager.SidePanelManager.getDialogUtil(),c=e.cID,A=(C.getDialogMeta(c),S.getChartMeta(c));A.getOptions(),a=A.getUpdateLegendStyle({fontSize:i}),A.updateLegendStyle(a),T.updateLegendStyle(g,s,r,A,a)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_WEIGHT,function(e){t.Wrapper.DOMUtils.getElementById("chartBold").click()},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_COLOR,function(e){var a=e.color;o.zcolorselectbox("#chartFontColor2","setValue",a);var i,n,r=l.view.getActiveGridID(),g=l.view.getVersionID(r),s=l.view.getResourceID(r),S=l.view.getSheetID(r),T=e.cID,C=new t.Utility.ChartAgent,c=new t.Controller.ZSCController,A=C.getChartMeta(T),d=A.getLegend();n=(new t.Model.ChartModel).getRGBA(d.itemStyle.color),i=A.getUpdateLegendStyle({color:a}),A.updateLegendStyle(i),C.isUniqueValue(n,a)&&c.updateLegendStyle(s,S,g,A,i)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.LEGEND.FONT_STYLE,function(e){t.Wrapper.DOMUtils.getElementById("chartitalic").click()},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CALL_RECOMMENDATION,function(e){var a=t.Manager.SidePanelManager;if((new t.Utility.AgentDom).hideRecommendationDOM(),a.isPanelOpen()&&!l.view.Toolbar.showChartPopup){var i=a.getDialogUtil().getMetaObject(e);i&&(t.Action.doRecommendation(i,!0),a.RECOMMENDATION=!1)}},"CHART_ID"),r.register(n.UI,i.Names.SidePanel.CHARTS.CALL_TABLE_DEFINITION,function(e){var a=t.Manager.SidePanelManager;if(a.isPanelOpen()){var i=a.getDialogUtil().getMetaObject(e);i&&(t.Aggregation.resetAggregationDom(i.getSeriesIn()),I(i))}},"CHART_ID"),r.register(n.UI,i.Names.SidePanel.CHARTS.REFRESH_SIDE_PANEL,function(e){t.Manager.SidePanelManager.isPanelOpen()&&E(e)},"CHART_ID"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES_TYPE,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.ID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o);s.changeChartType(n,r,i,[S],e.value)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.COLOR,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.ID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o);s.updatePlotlineColor(n,r,i,S,e)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.STYLES,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.ID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o);s.updatePlotlineStyle(n,r,i,S,e)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.PLOTLINE.DASHSTYLE,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.ID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o);s.updatePlotlineDashStyle(n,r,i,S,e)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_SIZE,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.cID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o),T=S.getDataLabelStyle()||{};T.fontSize=e.fontSize,S.setDataLabelStyle(T),s.updateDataLabelStyle(n,r,i,S)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_WEIGHT,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.cID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o),T=S.getDataLabelStyle()||{};T.fontWeight=e.bold?"normal":"bold",S.setDataLabelStyle(T),s.updateDataLabelStyle(n,r,i,S)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_COLOR,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.cID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o),T=S.getDataLabelStyle()||{};T.color=e.color,S.setDataLabelStyle(T),s.updateDataLabelStyle(n,r,i,S)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.FONT_STYLE,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.cID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o),T=S.getDataLabelStyle()||{};T.fontStyle=e.italic?"normal":"italic",S.setDataLabelStyle(T),s.updateDataLabelStyle(n,r,i,S)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.TOTALS,function(e){t.Manager.SidePanelManager.getDialogUtil().updateDataLabelTotals(e),(new t.Controller.ZSCController).updateDataLabelTotals(e)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.TOTAL.FONT_SIZE,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.cID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o),T=S.getDataLabelTotalStyle()||{};T.fontSize=e.fontSize,S.setDataLabelTotalStyle(T),s.updateDataLabelTotalStyle(n,r,i,S)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.TOTAL.FONT_WEIGHT,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.cID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o),T=S.getDataLabelTotalStyle()||{};T.fontWeight=e.bold?"normal":"bold",S.setDataLabelTotalStyle(T),s.updateDataLabelTotalStyle(n,r,i,S)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.TOTAL.FONT_COLOR,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.cID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o),T=S.getDataLabelTotalStyle()||{};T.color=e.color,S.setDataLabelTotalStyle(T),s.updateDataLabelTotalStyle(n,r,i,S)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.DATALABELS.TOTAL.FONT_STYLE,function(e){var a=l.view.getActiveGridID(),i=l.view.getVersionID(a),n=l.view.getResourceID(a),r=l.view.getSheetID(a),o=e.cID,g=new t.Utility.ChartAgent,s=new t.Controller.ZSCController,S=g.getChartMeta(o),T=S.getDataLabelTotalStyle()||{};T.fontStyle=e.italic?"normal":"italic",S.setDataLabelTotalStyle(T),s.updateDataLabelTotalStyle(n,r,i,S)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.THRESHOLD.VALUE,function(e){t.Manager.SidePanelManager.getDialogUtil().updateThresholdValue(e),(new t.Controller.ZSCController).updateThresholdValue(e)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.THRESHOLD.COLOR,function(e){t.Manager.SidePanelManager.getDialogUtil().updateThresholdColor(e),(new t.Controller.ZSCController).updateThresholdColor(e)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.CUSTOM.UPDATE.SERIES_LINE_STYLE,function(e){t.Manager.SidePanelManager.getDialogUtil().updateTrendlineStyle(e),(new t.Controller.ZSCController).doChartCustomization("tredlineStyle",e)},"PROPERTIES"),r.register(n.UI,i.Names.SidePanel.CHARTS.TOGGLE_CHART_TYPES,A,"e","ACTION"),r.register(n.UI,i.Names.SidePanel.CHARTS.CLOSE_CHART_TYPES,d,"PROPERTIES")}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSChart,a=e.UIUtil.Component,l=e.document;function r(){}function i(){var e=o.Wrapper.DOMUtils.getElementById("chartcustomcolorDropDown"),t=(new o.Utility.ChartAgent).getCustomColorForActiveChart();a.zcolorselectbox(e,"setValue",t)}r.prototype.fetchAndAddTemplate=function(){var t=o.Wrapper.DOMUtils;if(!t.getElementById("DI_CHART_COLOR_SCHEME")){var a=e.UserAction.getTemplate(["chartColorSchemeTemplate"]),r=l.createElement("div");r.id="DI_CHART_COLOR_SCHEME",r.style.display="none",r.classList.add("zSChrtClrPlt"),r.appendChild(a.chartColorSchemeTemplate),t.appendChild(document.body,r),(new o.Controller.ZSCController).initColoSchemeEvents()}},r.prototype.showColorScheme=function(e){var t=new o.Utility.CommanAgent,a=o.Wrapper.DOMUtils,l=t.getDialogStatus();this.init(l);var r=e.getBoundingClientRect(),n="";if(l){var c=o.Utility.getDialog();n=parseInt(c.style.zIndex)+1}var s={left:r.left+"px",top:r.top+r.height+"px",position:"absolute",zIndex:n};!a.getElementById("DI_CHART_COLOR_SCHEME")&&this.fetchAndAddTemplate(),a.addStyle("DI_CHART_COLOR_SCHEME",s),a.toggle("DI_CHART_COLOR_SCHEME");(new o.Utility.ChartAgent).getActiveChartMeta()[0].getOptions().colorOptions.colorTheme.name;i()},r.prototype.hideColorScheme=function(){o.Wrapper.DOMUtils.hideById("DI_CHART_COLOR_SCHEME")},r.prototype.init=function(e){var a,l,r,i,n,c,s,d,C={};e&&(a=o.Wrapper.DOMUtils.getElementById("chartThemePallate"),l=null,a&&(l=a.dataset),C=l),!e&&(r=t.view.getActiveGridID(),i=t.view.getResourceID(r),n=t.view.getVersionID(r),c=t.view.getSheetID(r),s=t.data.getWorkBook(i,n).getSheetObj(c).Charts,d=o.Utility.getActiveChart(),C=s.get(d[0]).getStyleOptions().colorTheme);var m={colorObject:{}};m.colorObject.colorTheme=C,(new o.Utility.AgentDom).resetColorDOMProperty(m,e)},r.prototype.initEvents=function(){var e=o.Wrapper.DOMUtils,t=new o.Utility.CommanAgent;l.body.addEventListener("click",function(e){"customColorToggle"!==e.target.id&&"customColorToggle"!==e.target.htmlFor&&function(e){for(var t=o.Wrapper.DOMUtils,a=["zcolorpicker__commandbaractionsright","zcolorpicker__currentcolorpreview","zcolorpicker__slidercontainer","zcolorpicker--advanced","zcolorpicker__commandbaractionsleft","zcolorpicker__default","zselectbox__arrow","zselectbox__icon","zcolorpicker__shades","zcolorpicker__navigatable","chartColorPallete","toggleCustomCheckBox","colorCustomPallete","cPaletteHolder","cPaletteCode","ui-zadvcolorpalette-bar","ui-zspinner-down","ui-zspinner-up","ui-zadvcolorpalette-spinnerpane","ui-zspinner-content","ui-zadvcolorpalette-swatchmain","ui-zcolorpalette-colors-container","ui-zcolorpalette-morecolors-text","ui-zcolorpalette-shadecontainer","ui-button-icon-primary"],l=0;l<a.length;l++)if(e&&e.target){if("customColorToggle"==e.target.id||t.hasClass(e.target,a[l]))return;if(e.target.parentElement){if("chartColPallate"==e.target.parentElement.id||"pivotchartColPallate"==e.target.parentElement.id||"chartcustomcolorDropDown"==e.target.parentElement.id||"MI_6006_IDENTITY"==e.target.parentElement.id||"colorpaletteContainer"==e.target.parentElement.id||t.hasClass(e.target.parentElement,a[l]))return;if(e.target.parentElement.parentElement&&t.hasClass(e.target.parentElement.parentElement,a[l]))return}}t.hideById("DI_CHART_COLOR_SCHEME")}(e)}),e.addEvent("cMenuPaletteHolder > .cPaletteClose","click",function(t){e.hideById("DI_CHART_COLOR_SCHEME")}),e.addEvent("sPCMenuPaletteHolder > .sPCPaletteClose","click",function(t){e.hideById("DI_CHART_COLOR_SCHEME")}),e.addEvent("ul#chartColorPaletteHolder > li","click",function(o){e.removeClass(e.findByClassName("ul#chartColorPaletteHolder > li","active"),"active"),e.removeClass(e.getElementByClassName("colorDialogCustomPallete"),"active");e.addClass(this,"active"),t.updateTheme(this.dataset),e.hideById("DI_CHART_COLOR_SCHEME")}),e.addEvent("ul#chartDialogCPalletteCode > li","click",function(o){e.removeClass(e.findByClassName("ul#chartDialogCPalletteCode > li","active"),"active"),e.removeClass(e.getElementByClassName("colorDialogCustomPallete"),"active");e.addClass(this,"active"),t.updateTheme(this.dataset),e.hideById("DI_CHART_COLOR_SCHEME")}),e.addEvent("colorDialogCustomPallete","click",function(o){e.removeClass(e.findByClassName("cPaletteCode > li","active"),"active");e.addClass(this,"active"),t.updateTheme(this.dataset),e.hideById("DI_CHART_COLOR_SCHEME")}),e.addEvent("customColorToggle","click",function(){t.reveseColorScheme(e.getElementById("customColorToggle").checked)});var r=e.getElementById("chartcustomcolorDropDown");a.bind(r,"zcolorselectchange",function(a,l){var r=l.rgb,i=e.getElementByClassName("colorDialogCustomPallete"),n=i.dataset.basecolor,c={"data-basecolor":r};e.addAttributes("colorDialogCustomPallete",c);var s=new o.Utility.SheetChartColor(r).getLinerGradient(6);e.addStyle("colorDialogCustomPallete",{"background-image":s});var d=(new o.Utility.ChartAgent).isUniqueValue(n,r);d&&t.updateTheme(i.dataset),d&&(e.removeClass(e.findByClassName("cPaletteCode > li","active"),"active"),e.addClass(e.getElementByClassName("colorDialogCustomPallete"),"active"))}),a.bind(r,"zcolorselectpickeropen",function(e,t){i()})},o.Manager.ZSCColorManager=r}(this);
!function(t){var e=t.sPlusPlus,i=t.ZSChart,r=i.Constants.ChartPublishConstant,a=i.Server.Action,n=t.JSUtil,s=t.ZSConstants.I18N,h=null,o=null;function u(){!h&&(h=new i.Manager.PublishDialogManager)}u.prototype.getFirstInstance=function(t){var e;return t&&(e=t[0]),e},u.prototype.isActionOwner=function(){return!!o},u.prototype.setActionOwner=function(){var t=e.data.UserInfo;o=t.zuid},u.prototype.showUrlPublishDialog=function(t){var e=n.fn.getServerPath();e+="/sheet/",e+="publicgraphs/";var i,r=null,a=t?t[0]:null;i=this.getActiveChartMeta(),r=this.getFirstInstance(i),e+=a?a.pcn:r.getPubChartName();var o={width:550,modal:!0,title:s.PublishedChart},u={url:e,height:r.getHeight(),width:r.getWidth(),title:r.getTitle()};h.init(o,u),h.open()},u.prototype.publishChart=function(){var t=this.getActiveChartMeta(),e=this.getRequestObject(t,r.PUBLISH);a.doPublicChart(e)},u.prototype.getActiveChartMeta=function(){return(new i.Utility.ChartAgent).getActiveChartMeta()},u.prototype.unPublishChart=function(){var t=this.getActiveChartMeta(),e=this.getRequestObject(t,r.REVERT);a.doPublicChart(e)},u.prototype.doPublishAction=function(t,e,i){switch(t.status){case r.PUBLISH:this.publishChart();break;case r.REVERT:this.unPublishChart();break;case r.SHOWURL:i&&this.showUrlPublishDialog(e)}this.setActionOwner()},u.prototype.getRequestObject=function(t,e){var i=[];for(var r in t){var a=t[r];i.push({id:a.getID()})}return{parameters:i,url:{publish:"chartaction",unpublish:"chartaction",showUrl:"chartaction"}[e],action:{publish:"CHART_PUBLISH",unpublish:"CHART_UNPUBLISH",showUrl:"CHART_PUBLISH"}[e]}},i.Manager.ZSCPublishManager=u}(this);
!function(t){t.sPlusPlus;var e=t.ZSChart;e.Action.createPreview=function(t,i,o){var r=new e.Utility.ChartAgent,n=i.co,s=r.clone(i,!0),l=(r.clone(s.co,!0),i.ts||","),c=i.ds||".";delete s.co;var a=new e.Model.ChartModel(t,s,n.chart,n.colorOptions,n.xAxis,n.yAxis,n.series,n.title,n.subtitle,n.tooltip,n.plotOptions,n.legend,n.credits,l,c,n.isStockChart,n.lineStyles);return a.setSeparatorOptions(),a.init(!1,!1),a.restoreDefaultSpacing(),a.showPreview(o)},e.Action.renderChart=function(t,i){return new Promise(function(o,r){var n=new e.Utility.ChartAgent,s=i.co,l=n.clone(i,!0),c=(n.clone(l.co,!0),i.ts||","),a=i.ds||".";delete l.co;var u=new e.Model.ChartModel(t,l,s.chart,s.colorOptions,s.xAxis,s.yAxis,s.series,s.title,s.subtitle,s.tooltip,s.plotOptions,s.legend,s.credits,c,a,s.isStockChart,s.lineStyles);u.setSeparatorOptions(),u.init(!1,!1),u.restoreDefaultSpacing(),u.showPreview(),setTimeout(function(){o()},200)})}}(this);
!function(e){e.sPlusPlus;var t,n=e.ZSChart,i=(n.Constants.ChartPublishConstant,n.Action,e.JSUtil),o=e.ZSConstants.I18N,r=e.ZSClass,l=e.ZSConstants.FeatureConstants,a=e.ZSConstants.wCC,s=(e.document,!1),c=null,d=null,u=null;function p(){this.dailogOptions=null,u=null}function g(e,t){var n,l=c.querySelector("#zsPublicUrlLink");l.innerText=e.url,l.href=e.url,t?n='<img title src="'+e.url+'.png">':(n='<iframe width="600" height="400" style="border:1px solid #ccc" frameborder="0" scrolling="no" src="',n+=e.url,n+='"></iframe>');var a=document.createTextNode(n);c.querySelector("#embedCode").innerText=a.wholeText,c.querySelector("#embedSnipetMsg").innerText=i.fn.replaceParams(o["Dialog.Publish.EmbedMessage"],[o["Dialog.Publish.Chart"]]);var s=c.querySelector("#embedSnipet"),d=s.querySelector("#embedCode"),u=s.querySelector("#embedSnippetCode"),p={inputToSelect:d,cssClass:"frmSnpt"};new r.CopyToClipboard(u,p).createElement();var g=c.querySelector("#publicURL"),C={inputToSelect:l,cssClass:"frmSnpt"};new r.CopyToClipboard(g,C).createElement()}p.prototype.init=function(e,t){this.dailogOptions=e,u=t},p.prototype.open=function(){!t&&(t=n.Wrapper.DOMUtils),this.initDialog(),this.dailogOptions.open=function(){this.openDialogHandler()}.bind(this),this.dailogOptions.close=function(){this.closeDialogHandler()}.bind(this),(d=new r.Dialog(c,this.dailogOptions)).open()},p.prototype.initDialog=function(){if(!d){s=!0;var n=e.UserAction.getTemplate(["PUBLIC_CHART_TEMPLATE","EMBED_SNIPPET_TEMPLATE","EMBED_REVERT_CANCEL_TEMPLATE"]);c=t.createElement("div",{id:a.DI+l.PUBLISH_CHART+a.IDENTITY}),t.appendChild(c,n.PUBLIC_CHART_TEMPLATE),t.appendChild(c,n.EMBED_SNIPPET_TEMPLATE),t.appendChild(c,n.EMBED_REVERT_CANCEL_TEMPLATE)}return d},p.prototype.getUrlOptions=function(){return u},p.prototype.openDialogHandler=function(){s&&this._bindEvents(c),g((new n.Utility.ChartAgent).clone(this.getUrlOptions()))},p.prototype.closeDialogHandler=function(){c.querySelector("#interactiveView").checked=!0},p.prototype._bindEvents=function(e){s=!1;var i=new n.Utility.ChartAgent,o=(i.clone(this.getUrlOptions()),this),r=t.getNodeInParent(e,"interactiveView")[0];t.addEventByNode(r,"click",function(){var n=i.clone(o.getUrlOptions());g(n),t.getNodeInParent(e,"zsPublicUrlLink")[0].innerText=n.url,t.getNodeInParent(e,"zsPublicUrlLink")[0].href=n.url});var l=t.getNodeInParent(e,"pnglView")[0];t.addEventByNode(l,"click",function(){var n=i.clone(o.getUrlOptions());g(n,!0),t.getNodeInParent(e,"zsPublicUrlLink")[0].innerText=n.url+".png",t.getNodeInParent(e,"zsPublicUrlLink")[0].href=n.url+".png"});var a=t.getNodeInParent(e,"btnRemovePublic")[0];t.addEventByNode(a,"click",function(){(new n.Controller.ZSCController).revertPubishChart(),d.close()});var c=t.getNodeInParent(e,"btnCancel")[0];t.addEventByNode(c,"click",function(){d.close()})},n.Manager.PublishDialogManager=p}(this);
!function(t){var n=t.ZSChart,e=(t.sPlusPlus,t.ZSConstants.ActionConstants),i=function(t){this.rID=null,this.sheetID=null,this.aConst=t,this.version=null,this.ttl=null,this.ttlTimer=null,this.ID=null,this.aOwner=null};i.prototype={getRID:function(){return this.rID},setRID:function(t){this.rID=t},setID:function(t){this.ID=t},getID:function(){return this.ID},setActionOwner:function(t){this.aOwner=t},getActionOwner:function(){return this.aOwner},setActionConst:function(t){this.action=t},getActionConst:function(){return this.action},isSameDocument:function(t){return this.getRID()==t&&-1!=this.getActionConst()},setSheetID:function(t){this.sheetID=t},getSheetID:function(){return this.sheetID},isSameSheet:function(t){return this.isSameDocument()&&this.getSheetID()==t},resetAction:function(){this.action=-1},setVersion:function(t){this.version=t},getVersion:function(){return this.version}},i.setObjectProperties=function(t){var i=null;return t.isRelatedToDesign&&((i=new n.Model.DesignClip(e.CHART_COPY_STYLE)).setRID(t.RID),i.setSheetID(t.sheetID),i.setID(t.sID),i.setActionOwner(t.aOwner),i.setVersion(t.version)),i},n.Model.CHARTCLIP=i}(this);
!function(t){var e,i=t.ZSChart,s=t.sPlusPlus,o=i.Model.CHARTCLIP,n=function(t){o.call(this,t),this.init()};(n.prototype=new o).init=function(){this.startTime=null,this.copyStatus=!1,this.pasteStatus=!1,this.clearTTL()},n.prototype.setStatus=function(t){-1!=this.a?this.copyStatus=!0:this.copyStatus=!1,this.setActionOwner(t.zuid),this.setPasteStatus(t.isPasteEnable)},n.prototype.setPasteStatus=function(t){this.pasteStatus=t},n.prototype.isPasteEnable=function(){return this.pasteStatus},n.prototype.getClipObject=function(){return isUndefined(e)&&(e=new n(-1)),e},n.prototype.clip=function(t){i.Server.Action.copyClipToServer(t.RID,t.sheetID,t.version,{sID:t.sID})},n.prototype.paste=function(t){var e=s.view.getActiveGridID(),o=s.view.getResourceID(e),n=s.view.getSheetID(e),r=s.view.getVersionID(e),p=this.getID();!(p==t)&&i.Server.Action.pasteDesign(o,n,r,{cID:t,sID:p,URL:"chartaction"})},n.prototype.setTTL=function(t){this.ttl=1e3*t,this.startTime=(new Date).getTime();var e=this;this.ttl>0&&(this.ttlTimer=setTimeout(function(){e.hasClip()&&e.removeClip()},this.ttl))},n.prototype.getTTL=function(){var t=this.ttl-((new Date).getTime()-this.startTime);return t>=0?(t/6e4).toFixed(1):-1},n.prototype.removeClip=function(){-1!=this.a&&(this.resetAction(),this.init())},n.prototype.clearTTL=function(){clearTimeout(this.ttlTimer)},n.prototype.hasClip=function(){return-1!=this.a},n.prototype.updateResponse=function(t){var e=t.copiedStyle;e&&(this.setStatus(e),this.setTTL(e.ttl))},n.prototype.setConfig=function(t){this.setSheetID(t.sheetID),this.setActionOwner(t.aOwner),this.setRID(t.RID),this.setVersion(t.version),this.setID(t.sID)},i.Model.DesignClip=n}(this);
!function(e){var t=e.ZSChart,i=e.sPlusPlus,r=e.ZSEvents,n=r.topic,s=r.Groups,o=r.Names,a=t.Model.CHARTCLIP,l=null,p=e.ZSConstants.ActionConstants;function g(){}g.prototype.copyStyle=function(){var e=new t.Utility.ChartAgent,r=i.view.getActiveGridID(),n=e.getActiveChartMeta()[0],s=i.view.getResourceID(r),o=i.view.getSheetID(r),a=i.view.getVersionID(r),g=i.data.UserInfo,c={RID:s,sheetID:o,sID:n.getID(),aOwner:g.zuid,version:a};!l&&(l=new t.Model.DesignClip(p.CHART_COPY_STYLE)),l.setConfig(c),l.pasteStatus=!0,l.clip(c)},g.prototype.resetDesignToDefault=function(){var e=new t.Utility.ChartAgent,r=i.view.getActiveGridID(),n=i.view.getResourceID(r),s=i.view.getSheetID(r),o=i.view.getVersionID(r),a=t.Utility.getActiveChart();for(var p in a){var g=e.getChartMeta(a[p]);t.Server.Action.doQuickStyleAction(n,s,o,g.getID(),128,[{cStyle:"default"}])}l&&l.removeClip()},g.prototype.pasteStyle=function(){var e=new t.Utility.ChartAgent,i=t.Utility.getActiveChart();for(var r in i){var n=e.getChartMeta(i[r]);this.hasStyleClip()&&l.paste(n.getID())}},g.prototype.hasStyleClip=function(){return!!l&&l.hasClip()},g.prototype.getClip=function(){return!l&&(l=this.getDefaultStyleClip()),l},g.prototype.getDefaultStyleClip=function(){new t.Utility.ChartAgent;var e=i.view.getActiveGridID(),r=i.view.getResourceID(e),n=i.view.getSheetID(e),s=i.view.getVersionID(e),o={RID:r,sheetID:n,sID:null,isRelatedToDesign:!0,aOwner:i.data.UserInfo.zuid,version:s};return a.setObjectProperties(o)},g.prototype.processMessage=function(e){this.getClip().updateResponse(e)},g.prototype.performStyleAction=function(e){switch(e){case"CS":this.copyStyle();break;case"PS":this.pasteStyle();break;case"RS":this.resetDesignToDefault()}},n.register(s.Listener,o.ServerClip.CHART.STYLE_CLIP,function(e){(new t.Manager.ZSCCManager).processMessage(e)},"STYLE_CLIP"),t.Manager.ZSCCManager=g}(this);
!function(e){var t,n,i,a,l,s,r,o,d=e.sPlusPlus,E=e.ZSChart,c=e.ZSEvents,u=c.topic,I=c.Groups,A=c.Names,S=e.UserAction,P=e.ZSClass,R=d.view.measures,p=(P=e.ZSClass).SidePanel,h=P.SidePanelClassList,T=[h.right,h.left,h.bottom],g=h.right,v=P.Editors.Utility,_=ZSConstants.I18N,L=e.ZSConstants.JSKeyCode,Z=e.UIUtil.Component,C=P.KeyMapping,f=(new P.SBFeature("ZIA").div,P.Range),U=!1,y=!1,m=1e3,M=[_.ziaLoadingMessage1,_.ziaLoadingMessage2,_.ziaLoadingMessage3,_.ziaLoadingMessage4,_.ziaLoadingMessage5,_.ziaLoadingMessage6,_.ziaLoadingMessage7],O=7;var D,b=new function(){C.call(this)};function N(){d.view.Events.Key.focusContext(b)}function G(){var e=d.view.Events.Key;e.focusContext(e.Entry.CellEditor.Context)}function B(e){var t=S.getTemplate(["ziaIcon"]);this.icon.appendChild(t.ziaIcon),this.icon.classList.add("sPZIABtm"),D=this.icon}function w(){}function z(){0==R.Right.sidePanel&&0==R.Right.customSidePanelWidth?(R.Right.sidePanel=this.minWidth,R.Right.customSidePanelWidth=this.minWidth):R.Right.sidePanel=R.Right.customSidePanelWidth>=this.minWidth?R.Right.customSidePanelWidth:this.minWidth,this.holder.setWidth(R.Right.sidePanel),N(),(new ZSZIA.Controller.ZController).openPanel()}function W(){R.Right.sidePanel=0,this.holder.setWidth(0),G(),(new ZSZIA.Controller.ZController).closePanel()}function q(){var e=E.Wrapper.DOMUtils,t=S.getTemplate(["SP_ZIA_FILTER_TEMPLATE","SP_ZIA_AGGREGATE_REPORT_TEMPLATE","SP_ZIA_WRAPPER_TEMPLATE","SP_ZIA_REPORT_WRAPPER_TEMPLATE","SP_ZIA_RECOMMEND_LIST","SP_ZIA_QUERY_TEMPLATE","SP_ZIA_MIXED_REPORT_TEMPLATE","SP_ZIA_TABLE_REPORT_TEMPLATE","SP_ZIA_GRAPH_REPORT_TEMPLATE","SP_ZIA_ERROR_REPORT_TEMPLATE","SP_ZIA_MORE_REPORT_TEMPLATE","SP_ZIA_ICON_TEMPLATE","SP_ZIA_CONTAINER","SP_ZIA_RANGE_TEMPLATE"]);this.panel.addEventListener("mousedown",N),this.panel.appendChild(t.SP_ZIA_CONTAINER),n=this.panel.querySelector("#pivotRec_container"),(l=document.createElement("span")).classList.add("ZsLoader"),(s=document.createElement("div")).classList.add("ziaTxt"),e.hide(s),(a=document.createElement("div")).classList.add("ziaLoadArea"),n.appendChild(t.SP_ZIA_ICON_TEMPLATE),n.appendChild(t.SP_ZIA_RANGE_TEMPLATE),n.appendChild(t.SP_ZIA_WRAPPER_TEMPLATE);var r=n.querySelector("#zWrapper");r.appendChild(t.SP_ZIA_REPORT_WRAPPER_TEMPLATE),r.appendChild(t.SP_ZIA_MORE_REPORT_TEMPLATE),document.getElementById("popupmenu").appendChild(t.SP_ZIA_FILTER_TEMPLATE);var c=r.querySelector("#rPlC");c.appendChild(t.SP_ZIA_RECOMMEND_LIST),a.appendChild(l),a.appendChild(s),c.appendChild(a),e.hide(a);var R=c.querySelector("#recommendedReportList");R.appendChild(t.SP_ZIA_AGGREGATE_REPORT_TEMPLATE),R.appendChild(t.SP_ZIA_QUERY_TEMPLATE),R.appendChild(t.SP_ZIA_MIXED_REPORT_TEMPLATE),R.appendChild(t.SP_ZIA_TABLE_REPORT_TEMPLATE),R.appendChild(t.SP_ZIA_GRAPH_REPORT_TEMPLATE),R.appendChild(t.SP_ZIA_ERROR_REPORT_TEMPLATE),function(e){var t=E.Wrapper.DOMUtils,a=e.querySelector("#explBtns");o=e.querySelector("#expFilter");var l=a.children,s=l[l.length-1].children,r=e.querySelector("#Formula");t.addEventByNode(l[0],t.Events.CLICK,H),t.addEventByNode(s[1],t.Events.CLICK,F),t.addEventByNode(s[0],t.Events.CLICK,k),o.setAttribute("data-content","#zFltWrapper"),o.setAttribute("data-is-content-html-encoded",!0),o.setAttribute("data-class-name","sPZIAFltr"),o.setAttribute("data-position","bottom-right"),Z.zpopover(o);var d=e.querySelector("#expCellRef");n.querySelector(".zsRangePicker").classList.add("zRDisable"),i=new P.Editors.RangeEditor(d),P.RangePicker.register(i,!0),t.addEvent("pivotRec_container",t.Events.CLICK,function(){u.publish(I.UI,A.SidePanel.ZIA.SCROLL)}),t.addEventByNode(e.querySelector("#closeZia"),t.Events.CLICK,function(){u.publish(I.UI,A.SidePanel.ZIA.TOGGLE)}),t.addEventByNode(e.querySelector("#voice_cancel"),t.Events.CLICK,function(){var e;e=this.dataset,u.publish(I.UI,A.SidePanel.ZIA.QUERY_TOOGLE,{STATE:e.state})}),t.addEventByNode(e.querySelector("#askQuestion"),t.Events.KEYUP,function(e){var t=e.keyCode||e.which,n=e.target.selectionStart,i=this.value.slice(0,n);if(13===t)u.publish(I.UI,A.SidePanel.ZIA.PROCESS_QUERY,{QUERY:this.value.trim(),TEXTBOX:e.target});else if(32==t)u.publish(I.UI,A.SidePanel.ZIA.ADD_SEARCH_SELECT,{QUERY:this.value.trim(),TEXTBOX:e.target,VALUE:i});else if(8==t)u.publish(I.UI,A.SidePanel.ZIA.SUGGESTION,{TEXT:i}),u.publish(I.UI,A.SidePanel.ZIA.SEARCH_SELECT_AT_INDEX,{INDEX:0});else if(!(t>=37&&t<=40)){if(27==t)return void u.publish(I.UI,A.SidePanel.ZIA.SCROLL);u.publish(I.UI,A.SidePanel.ZIA.SUGGESTION,{TEXT:i}),u.publish(I.UI,A.SidePanel.ZIA.SEARCH_SELECT_AT_INDEX,{INDEX:0})}e.stopPropagation(),e.preventDefault()}),t.addEventByNode(e.querySelector("#askQuestion"),t.Events.CLICK,function(e){u.publish(I.UI,A.SidePanel.ZIA.SHOW_DEFAULT_SUGGESTION,{TEXT:this.value}),e.stopPropagation(),e.preventDefault()}),t.addEventByNode(e,t.Events.KEYUP,function(e){var t=e.keyCode||e.which;27==t&&u.publish(I.UI,A.SidePanel.ZIA.HIDE_SEARCH),e.stopPropagation(),e.preventDefault()}),t.addEventByNode(e,t.Events.SCROLL,function(){u.publish(I.UI,A.SidePanel.ZIA.SCROLL)}),t.addEventByNode(e,t.Events.MOUSEWHEEL,function(){u.publish(I.UI,A.SidePanel.ZIA.SCROLL)}),t.addEventByNode(e,t.Events.DOMMOUSEWHEEL,function(){u.publish(I.UI,A.SidePanel.ZIA.SCROLL)}),Z.draggable(r,{helper:function(){var e=r,t=e.cloneNode(!0);return t.classList.add("ziaFromlaSnap"),t}.bind(this),appendTo:".sheetPaneContainer",scroll:!0,onDrag:function(e,t){ZSZIA.Client.Range.Highlight.REMOVE.fn.call(this),ZSZIA.Utility.scrollOutGridIfNeeded(e);var n=ZSZIA.Utility.getAbsoluteRowPosbyInMouseEvent(e),i=ZSZIA.Utility.getAbsoluteColPosbyInMouseEvent(e),a=new f(n,i,n,i);ZSZIA.Client.Range.Highlight.ADD.fn.call(this,121,a),U=!0},onStop:function(e,t){if(ZSZIA.Client.Range.Highlight.REMOVE.fn.call(this),!y&&ZSZIA.Client.isAllowToAddOnDragEnd(e)){var n=ZSZIA.Utility.getAbsoluteRowPosbyInMouseEvent(e),i=ZSZIA.Utility.getAbsoluteColPosbyInMouseEvent(e);ZSZIA.Client.onDragEnd.FORMULA.fn.call(this,n,i,r.dataset.formula,r.dataset.pattern,r.dataset.iaf)}y=!1,U=!1}}),t.addEventByNode(document.querySelector("body"),t.Events.KEYUP,function(e){var t=e.keyCode||e.which;switch(t){case 27:U&&(y=!0)}}),c=i,v.addValidator(c,function(){return x(c.value)},function(){c.Editor.style.border=""},function(){c.Editor.style.borderBottomColor="red"},200),function(e){var t=E.Wrapper.DOMUtils,n=e.querySelector("#copyURL");t.addEventByNode(n,t.Events.CLICK,function(){var t=e.querySelector("#formlaViewSpace");!function(e){var t=document.querySelector("#copyEditor");t.innerHTML="",t.appendChild(e.cloneNode(!0)),function(e){var t=document.createRange();t.selectNodeContents(e);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}(t),document.execCommand("copy"),t.blur(),JSUtil.fn.selectDivText(e)}(t),this.classList.add("sucState"),this.innerText="Copied";var n=this;setTimeout(function(){n.classList.remove("sucState"),n.innerText=_["Dialog.Button.Copy"],window.getSelection().removeAllRanges()},1e3)})}(r);var c}(n),n.querySelector("#ziaslink").href=d.data.AppRegistry.ZiaLearnMore,u.publish(I.UI,A.SidePanel.ZIA.SHOW_LOADER)}function H(){n.querySelector("#expSrc").classList.add("editRange"),n.querySelector(".zsRangePicker").classList.remove("zRDisable"),n.querySelector("#expCellRef").focus();var e=ZSZIA.Manager.ZPManager;e.enableRangeEditor(),e.setRangeValue(i.value,""),i.setSelectionRange(i.value.length,i.value.length),u.publish(I.UI,A.SidePanel.ZIA.HIDE_AGG_LAYER)}function F(){n.querySelector("#expSrc").classList.remove("editRange");var e=ZSZIA.Manager.ZPManager;e.disableRangeEditor();var t=e.getRange();u.publish(I.UI,A.SidePanel.ZIA.UPDATE_RANGE,{RANGE:t.prevValue}),n.querySelector(".zsRangePicker").classList.add("zRDisable")}function k(){var e=i.value;if(x(e)){n.querySelector("#expSrc").classList.remove("editRange"),n.querySelector(".zsRangePicker").classList.add("zRDisable");var t=ZSZIA.Manager.ZPManager;t.enableRangeEditor();var a=t.getRange();t.setRangeValue(a.prevValue,e),function(e){var t=new ZSZIA.Controller.ZController,n=new ZSZIA.Manager.ZiaViewManager;u.publish(I.UI,A.SidePanel.ZIA.UPDATE_RANGE,{RANGE:e});var i=n.getActiveHolder();if(!i)return;if(i.isInsideRange(e))return;t.doRangeUpdate({ranges:e})}(e)}else P.ZSAlert(_.InvalidRange,{title:_["Alert.Title.InvalidCellRange"]})}function x(e){var t=e.trim().split(";"),n=d.view.getActiveGridID(),i=d.view.getResourceID(n),a=d.view.getVersionID(n),l=!1;for(var s in t)if(!(l=!!JSUtil.Range.parseRange(i,a,t[s])||""==t[s]))return l;return l}function K(){var e=E.Wrapper.DOMUtils;e.hide(a),e.hide(s),clearTimeout(r)}d.view.Events.Key.Entry.RightPane.Node.addChildNode(b),u.register(I.UI,A.SidePanel.ZIA.BLUR,G),u.register(I.UI,A.SidePanel.ZIA.FILTER.APPLY,function(){o&&!o.classList.contains("ziaFltredBtn")&&o.classList.add("ziaFltredBtn")}),u.register(I.UI,A.SidePanel.ZIA.FILTER.REMOVE,function(){o&&o.classList.contains("ziaFltredBtn")&&o.classList.remove("ziaFltredBtn")}),u.register(I.UI,A.SidePanel.ZIA.CLEAR,function(){["queryList","recommendedGraphList","recommendedTableList","recommendedMixedList"].forEach(function(e){n.querySelector("#"+e).innerHTML=""})}),u.register(I.UI,A.SidePanel.ZIA.SHOW_LOADER,function(){try{var e=E.Wrapper.DOMUtils;ZSZIA.Utility.hideError(),K(),e.show(a),u.publish(I.UI,A.SidePanel.ZIA.CLEAR),u.publish(I.UI,A.SidePanel.ZIA.QUERY_TOOGLE),r&&clearTimeout(r),r=setTimeout(function(){var t,n,i=(t=O,n=0,+parseInt(Math.random()*(t-n)+n)),a=M[i];s.innerHTML=a,e.show(s)},m)}catch(e){}}),u.register(I.UI,A.SidePanel.ZIA.HIDE_LOADER,K),u.register(I.UI,A.SidePanel.ZIA.TOGGLE,function(){t&&t.toggle(),r&&clearTimeout(r)}),u.register(I.UI,A.SidePanel.ZIA.OPEN_PANEL,function(){i&&(i.value=""),i&&(i.Editor.style.border="")}),u.register(I.UI,A.Layout.TEMPLATE_LOADED,function(){setTimeout(function(){var e,n;(t=p.add({panelName:"ZIA",onCreate:B,callBack:q,allowed:T,direction:g,scrollCellToView:!0,minWidth:340,maxWidth:500})).onOpen=z,t.onClose=W,(e=E.Wrapper.DOMUtils).addAttributes(D,{title:_["MenuItem.DataTab.Explore"]}),e.addEventByNode(D,e.Events.CLICK,w),(n=b.keyDown)[L.UP]=function(){return u.publish(I.UI,A.SidePanel.ZIA.SEARCH_SELECT,{DIRECTION:L.UP}),!1},n[L.DOWN]=function(){return u.publish(I.UI,A.SidePanel.ZIA.SEARCH_SELECT,{DIRECTION:L.DOWN}),!1}},1e3)}),u.register(I.UI,A.SidePanel.ZIA.UPDATE_RANGE,function(e){i&&(i.value=function(e){for(var t=e.split(";"),n="",i=0;i<t.length;i++){var a=t[i].split(".");n=0==n.length?n:n+";",n+=a[1]||a[0]}return n}(e))},"RANGE"),u.register(I.UI,A.SidePanel.ZIA.UPDATE_QUERY,function(e){var t=E.Wrapper.DOMUtils;t.getElementById("askQuestion").value=e,t.getElementById("askQuestion").focus(),t.getElementById("askQuestion").setSelectionRange(t.getElementById("askQuestion").value.length,t.getElementById("askQuestion").value.length)},"QUERY"),u.register(I.UI,A.SidePanel.ZIA.FILTER.HIDE,function(){o&&Z.zpopover(o,"close")}),u.register(I.UI,A.SidePanel.ZIA.FILTER.TOGGLE,function(e){e&&o&&o.classList.contains("zsDisable")&&o.classList.remove("zsDisable"),!e&&o&&!o.classList.contains("zsDisable")&&o.classList.add("zsDisable")},"HAS_FILTER")}(this);
!function(t){!t.ZSZIA&&(t.ZSZIA={});t.window,t.sPlusPlus;var e=t.ZSZIA;!e.Manager&&(e.Manager={}),!e.Constants&&(e.Constants={}),!e.Model&&(e.Model={}),!e.Controller&&(e.Controller={}),!e.Utility&&(e.Utility={}),!e.Client&&(e.Client={}),!e.Server&&(e.Server={}),!e.Layer&&(e.Layer={})}(this);
!function(E){var A=E.ZSZIA;var t=100;const R={NEW:t++,CACHED:t++,SEARCH:t++};var s={};s[R.NEW]="#helpIco",s[R.CACHED]="#clockIco",s[R.SEARCH]="#arrowIco",A.Constants.META={},A.Constants.Parser={META:"META",REFRESH:"REFRESH"},A.Constants.META.Type={NLP:"NLP",CHART:"CHART",PIVOT:"PIVOT",FORMULA:"FORMULA"},A.Constants.View={TABLE:1,GENERAL:2,MIXED:3,QUERY:4,CDVIEW:!0},A.Constants.ID_SEPRATOR="#::_::::_::#",ZSZIA.Constants.RESPONSE={VALID:1,DROP:2,SINGLE:3,ERROR:4},ZSZIA.Constants.Index={CHART:1e3,PIVOT:2e3},ZSZIA.Constants.SupportedChart=["XYLINE","COL","BAR","SCATTER","COMBOCHART","PIE"],ZSZIA.Constants.SupportedOperations=["SUM","PRODUCT","MINIMUM","MAXIMUM","STANDARD DEVIATION","AVERAGE","MEAN","MEDIAN","TOTAL","STDDEV"],ZSZIA.Constants.ErrorCode={BAD_QUERY:502,DROP_REQUEST:501,SERVER_ERROR:500,BAD_REQUEST:400},ZSZIA.Constants.FRType={TABLE:"table",LIST:"list",STRING:"string"},ZSZIA.Constants.LayerCode=R,ZSZIA.Constants.LayerIcon=s,ZSZIA.Defaults={FORMULA:{TABLE:{}},TRIE_LIMIT:1e5},ZSZIA.Constants.Keywords={BY:"by",FOR:"for",WHERE:"where",IS:"is",OF:"of",EQUAL:"="}}(this);
!function(t){var s=t.ZSZIA,e=function(t){this.characterValue=t,this.isLeaf=0,this.dupValues=null,this.actualValues=null};function i(){this.suggestionList=new Array,this.trie=new e}i.prototype.constructTrieWord=function(t,s,i,r,u){var a=t.length;if(i==a&&(s.isLeaf?(s.dupValues[r]=1,u&&(s.actualValues[u]=1)):(s.isLeaf=1,s.dupValues={},s.dupValues[r]=1,u&&(s.actualValues={})&&(s.actualValues[u]=1))),i<a){var l=t.charAt(i),o=s[l];o?this.constructTrieWord(t,o,++i,r,u):(s[l]=new e(l),this.constructTrieWord(t,s[l],++i,r,u))}},i.prototype.constructTrie=function(t,s){var e=t.length;if(s){if(s.ACTUAL_TOKENS)for(var i=s.ACTUAL_TOKENS,r=0;r<e;r++)""!==t[r].trim()&&this.constructTrieWord(t[r].toLowerCase(),this.trie,0,t[r],i[r])}else for(r=0;r<e;r++)this.constructTrieWord(t[r].toLowerCase(),this.trie,0,t[r])},i.prototype.traverseTrie=function(t,s,e){if(e==t.length)return s;var i=s[t.charAt(e)];return i?this.traverseTrie(t,i,++e):null},i.prototype.suggestValuesTrie=function(t,s){if(1==t.isLeaf){for(var i in t.dupValues)this.suggestionListTrie.push(i);if(s&&s.ACTUAL_TOKENS&&t.actualValues)for(var i in t.actualValues)this.actualValuesList.push(i)}for(var r in t)t[r]instanceof e&&this.suggestValuesTrie(t[r],s)},i.prototype.autocompleteTrie=function(t,s){this.suggestionListTrie=[],this.actualValuesList=void 0;var e=null;null!==this.trie&&(e=this.traverseTrie(t.toLowerCase(),this.trie,0)),null!==e&&(s?s.ACTUAL_TOKENS&&(this.actualValuesList=[],this.suggestValuesTrie(e,s)):this.suggestValuesTrie(e));var i={};return this.suggestionListTrie&&(i.Suggestions=this.suggestionListTrie),this.actualValuesList&&(i.ActualValues=this.actualValuesList),i},s.Model.Trie=i}(this);
!function(e){e.window;var t=e.ZSZIA,i=(e.ZSChart,e.sPlusPlus,e.ZSEvents);i.topic,i.Groups,i.Names,t.Model.Trie;function o(){this.trieNodes={}}o.prototype.constructForest=function(e,i){this.trieNodes[e[0]]=new t.Model.Trie,this.trieNodes[e[0]].constructTrie(e,i)},o.prototype.suggestionForColumn=function(e,t,i){var o={};if(i){if(i.ACTUAL_TOKENS){var s=this.trieNodes[e]?this.trieNodes[e].autocompleteTrie(t,i):[];o[e]=s}}else{s=this.trieNodes[e]?this.trieNodes[e].autocompleteTrie(t):[];o[e]=s}return o},o.prototype.allPossibleSuggestion=function(e,t){var i=[],o={};if(t){if(t.ACTUAL_TOKENS)for(var s in this.trieNodes){var r=this.trieNodes[s]?this.trieNodes[s].autocompleteTrie(e,t):[];o[s]=r}}else for(var s in this.trieNodes){0!==(i=this.trieNodes[s]?this.trieNodes[s].autocompleteTrie(e):[]).length&&(o[s]=i)}return o},o.prototype.isAColumn=function(e){return Object.keys(this.trieNodes).includes(e)},o.prototype.getAllColumns=function(){return Object.keys(this.trieNodes)},t.Model.TrieForest=o}(this);
!function(n){var t=n.ZSConstants;ZSZIA.Utility.cellStatusResponseParser=function(n,c){for(var a,s="",e={},i=0;s+=c[i].getLabel(),++i!=c.length;)s+=",";for(var u in n){var o=n[u];switch(u){case"sum":a=t.Function.functions.SUM[0];break;case"avg":a=t.Function.functions.AVERAGE[0];break;case"min":a=t.Function.functions.MIN[0];break;case"max":a=t.Function.functions.MAX[0];break;case"cn":a=t.Function.functions.COUNT[0];break;case"count":a=t.Function.functions.COUNTA[0]}e[u]={},e[u].value=o,e[u].formula="="+a+"("+s+")"}return e}}(this);
!function(e){e.window;var t=e.ZSZIA,o=e.sPlusPlus,r=e.ZSChart,i=e.ZSEvents,n=i.topic,a=i.Groups,s=i.Names,l=t.Constants.RESPONSE,c=t.Constants.META.Type,d=e.ZSConstants.CommandConstants,u=e.ZSClass,g={},v=null,I=null,p=null,h=t.Constants.View.GENERAL,E=e.ZSDevTools.Logger,R=t.Constants.View,A=(ZSConstants.I18N,t.Constants.Keywords),f=t.Constants.SupportedOperations;function D(){}function C(e,t){for(var o,r=-1,i="",n=0;n<e.length;n++){var a=t.toLowerCase().lastIndexOf(e[n].toLowerCase()),s=t.toLowerCase().slice(a).trim().split(" "),l=e[n].trim().split(" ").length;s.slice(0,l).join(" ").toLowerCase()===e[n].toLowerCase()&&-1!==a&&a>=r&&(r=a,i=e[n],o=!0)}return{FLAG:o,KEY_FOUND:i,IDX:r}}function O(e,t,o,r,i,n,a,s){var l={};return l.SEARCH_RESULT=e,l.KEYWORD=t,l.APPEND_INDEX=o,l.APPEND_KEYWORD_TO_VALUE=r,l.APPEND_KEYWORD_TO_CONTENT=i,l.ADDITIONAL_PARAMETERS=n,l.APPEND_COLOR=a,l.maxLen=s,l}function w(e){return e===A.OF||e===A.EQUAL||e===A.IS}function S(e){h=e}function y(e){return"Invalid Date"!=new Date(e)}function m(e){var t=[];for(var o in e)t.push(e[o].key1);return t}function P(e,t){for(var o=[],r=0,i=e.length;r<i;r++)o.push({key1:e[r],key2:t[r]});return o.sort(L)}function L(e,t){return Z(e.key2,t.key2)}function Z(e,t){var o,r,i,n,a=Number.parseFloat(e),s=Number.parseFloat(t);if(r=s==t,i=!(o=a==e)&&y(e),n=!r&&y(t),o)return r?a<s?-1:a>s?1:0:1;if(i){if(n){var l=new Date(e),c=new Date(t),d=Math.abs(l.valueOf()),u=Math.abs(c.valueOf());return d>u?1:d<u?-1:0}return-1}return r?1:n?-1:e.localeCompare(t)}D.prototype.isAggregationAlive=function(){return p&&p.isAlive()},D.prototype.resetView=function(e){var r=o.view.getActiveGridID(),i=o.view.getResourceID(r),l=o.view.getVersionID(r),c=o.view.getSheetID(r),d=o.data.getWorkBook(i,l).getSheetObj(c).Prop.Name,u=new t.Controller.ZController,g=new t.Model.RequestObject;g.setProperties({fn:t.Server.doZiaReset,action:"ZIA_RESET",params:[{aConst:"ZIA_RESET",RID:i,VERSION:l,sheetID:c,sheetName:d,holderID:v,resetAction:e.action,callback:u.processResponse}]}),t.Manager.ZiaRequestManager.addActionIntoQueue(g),n.publish(a.UI,s.SidePanel.ZIA.SHOW_LOADER),n.publish(a.UI,s.SidePanel.ZIA.CLEAR_PRIORITY_HEADER)},D.prototype.refresh=function(){var e=o.view.getActiveGridID(),r=o.view.getResourceID(e),i=o.view.getVersionID(e),l=o.view.getSheetID(e),c=o.data.getWorkBook(r,i).getSheetObj(l).Prop.Name,d=new t.Controller.ZController,u=new t.Model.RequestObject;u.setProperties({fn:t.Server.doZiaRefresh,action:"ZIA_REFESH_UPDATE",params:[{aConst:"ZIA_REFRESH",RID:r,VERSION:i,sheetID:l,sheetName:c,holderID:v,callback:d.processResponse}]}),t.Manager.ZiaRequestManager.addActionIntoQueue(u),n.publish(a.UI,s.SidePanel.ZIA.SHOW_LOADER),n.publish(a.UI,s.SidePanel.ZIA.CLEAR_PRIORITY_HEADER)},D.prototype.doFilterAction=function(e){var r=o.view.getActiveGridID(),i=o.view.getResourceID(r),l=o.view.getVersionID(r),c=o.view.getSheetID(r),d=o.data.getWorkBook(i,l).getSheetObj(c).Prop.Name,g=new t.Controller.ZController,I=new t.Model.RequestObject,p=this.getActiveHolder();if(p)if(p.hasPriorityHeader()){var h=new u.ZSConfirm("Zia is detecting priority Headers, Do you want to continue ?");h.onYES(function(){E()}),h.onNO(function(){n.publish(a.UI,s.SidePanel.ZIA.FILTER.REMOVE_SELECTION)}),h.execute()}else E();function E(){p&&p.setFilterHeader(e),p&&p.flushProrityHeader(),I.setProperties({fn:t.Server.doFilterAction,action:"ZIA_FILTER_HEADER",params:[{aConst:"ZIA_FILTER_HEADER",RID:i,VERSION:l,sheetID:c,sheetName:d,holderID:v,filterRanges:JSON.stringify(e),callback:g.processResponse}]}),t.Manager.ZiaRequestManager.addActionIntoQueue(I),n.publish(a.UI,s.SidePanel.ZIA.SHOW_LOADER)}},D.prototype.setPriorityHeader=function(e){var r=o.view.getActiveGridID(),i=o.view.getResourceID(r),l=o.view.getVersionID(r),c=o.view.getSheetID(r),d=o.data.getWorkBook(i,l).getSheetObj(c).Prop.Name,g=new t.Controller.ZController,I=new t.Model.RequestObject,p=this.getActiveHolder();if(p)if(p.hasFilter()){var h=new u.ZSConfirm("Zia is detecting filter Headers, Do you want to continue ?");h.onYES(function(){E(),n.publish(a.UI,s.SidePanel.ZIA.FILTER.REMOVE_SELECTION)}),h.execute()}else E();function E(){p&&p.flushFilterHeader(),p&&p.setPriorityHeader(e),I.setProperties({fn:t.Server.doZiaPriorityHeader,action:"ZIA_PRIORITY_HEADER",params:[{aConst:"ZIA_PRIORITY_HEADER",RID:i,VERSION:l,sheetID:c,sheetName:d,holderID:v,priorityRanges:e,callback:g.processResponse}]}),t.Manager.ZiaRequestManager.addActionIntoQueue(I),n.publish(a.UI,s.SidePanel.ZIA.SHOW_LOADER)}},D.prototype.fetchRecommededQueries=function(e){var r=o.view.getActiveGridID(),i=o.view.getResourceID(r),n=o.view.getVersionID(r),a=o.view.getSheetID(r),s=o.data.getWorkBook(i,n).getSheetObj(a).Prop.Name,l=new t.Controller.ZController;v&&t.Server.fetchRecommededQueries({aConst:"ZIA_RECOMMEND_QUERIES",RID:i,VERSION:n,sheetID:a,sheetName:s,holderID:v,limit:e,callback:l.processRecommendQueries})},D.prototype.doBeforeSwitchAction=function(e,t,o){var r=this.getActiveHolder();r&&this.flushHolderByID(r.getID())},D.prototype.syncZiaAffectedHolder=function(e,o,r,i){E.isEnabled&&E.log("[ZIA] >>>> SYNC AFFECFED HOLDERS ",i);var n=new t.Controller.ZController;i.forEach(function(e){this.getActiveHolderID()==e&&n.syncUpdate({isModified:!0})}.bind(this))},D.prototype.sync=function(){var e=o.view.getActiveGridID(),r=o.view.getResourceID(e),i=o.view.getVersionID(e),n=o.view.getSheetID(e),a=o.data.getWorkBook(r,i).getSheetObj(n).Prop.Name,s=new t.Controller.ZController,l=new t.Model.RequestObject;v&&(l.setProperties({fn:t.Server.doZiaSync,action:"ZIA_SYNC_UPDATE",params:[{aConst:"ZIA_SYNC",RID:r,VERSION:i,sheetID:n,sheetName:a,holderID:v,callback:s.syncUpdate}]}),t.Manager.ZiaRequestManager.addActionIntoQueue(l))},D.prototype.reConnectZia=function(e){var r=o.view.getActiveGridID(),i=o.view.getResourceID(r),n=o.view.getVersionID(r),a=o.view.getSheetID(r),s=o.data.getWorkBook(i,n).getSheetObj(a).Prop.Name,l=new t.Controller.ZController,c=new t.Model.RequestObject;c.setProperties({fn:t.Server.doReconnect,action:"ZIA_RECONNECT",params:[{aConst:"ZIA_RECONNECT",RID:i,VERSION:n,sheetID:a,sheetName:s,holderID:e,callback:l.processResponse}]}),t.Manager.ZiaRequestManager.addActionIntoQueue(c)},D.prototype.doRangeUpdate=function(e){var r=o.view.getActiveGridID(),i=o.view.getResourceID(r),l=o.view.getVersionID(r),c=o.view.getSheetID(r),d=o.data.getWorkBook(i,l).getSheetObj(c).Prop.Name,u=new t.Controller.ZController,g=new t.Model.RequestObject,I=e.ranges;g.setProperties({fn:t.Server.doUpdateRange,action:"ZIA_RANGE_UPDATE",params:[{aConst:"ZIA_SAVE",RID:i,VERSION:l,sheetID:c,sheetName:d,holderID:v||"dummy",range:I,callback:u.processResponse}]}),t.Manager.ZiaRequestManager.addActionIntoQueue(g),n.publish(a.UI,s.SidePanel.ZIA.SHOW_LOADER),n.publish(a.UI,s.SidePanel.ZIA.CLEAR_PRIORITY_HEADER)},D.prototype.updateRecommendQuery=function(e){var t=this.getActiveHolder();t&&t.updateRecommendQuery(e)},D.prototype.process=function(e){var o=e[d.META].ZID,r=this.getHolder(o),i=t.Manager.ZAutoComplete;v=o,r.process(e),n.publish(a.UI,s.SidePanel.ZIA.UPDATE_RANGE,{RANGE:r.getRanges()}),n.publish(a.UI,s.SidePanel.ZIA.HIDE_LOADER);var l=document.querySelector("#recommendedNLPQuery > div > #askQuestion");i.create(),i.setParentElement(l),this.updateView(e)},D.prototype.updateView=function(e){try{var o=e[d.META];o.RENDERING_PRIORITY&&function(e){var t={MIXED:"recommendedMixedList",CHARTS:"recommendedGraphList",PIVOT:"recommendedTableList"},o=r.Wrapper.DOMUtils,i=o.getElementById("recommendedReportList");(function(){Object.keys(t).forEach(function(e){var o=i.querySelector("#"+t[e]);o.remove()})}).call(this),function(){e.forEach(function(e){var r=o.createElement("article",{id:t[e]});o.appendChild(i,r)})}.call(this)}.call(this,o.RENDERING_PRIORITY),Object.keys(o).forEach(function(e){new Promise(function(r,i){t.Client[e]&&t.Client[e].fn.call(this,o[e]),setTimeout(function(){r()},100)})})}catch(e){}},D.prototype.searchRelated=function(e){var o,r=t.Manager.ZAutoComplete,i=e.trim().split(" "),n=i.length-1,a=e.toLowerCase(),s=(a.trim().split(" "),i[n]),l={},c=r.getColTypeMap(),d=r.getAllColumns().sort(Z),u="",g=!1,v=-1,I=[],p=[],h={},E={},R=n,D={},S={},y=[],L=[],_=[],T=[A.BY,A.WHERE,A.FOR],M=[],H=[],b=0,N=0;for(var U in d)"NUMBER"!==c[d[U]]&&"DECIMAL"!==c[d[U]]||(I[N++]=d[U]);N=0;for(var U in d)"NUMBER"!==c[d[U]]&&"DECIMAL"!==c[d[U]]&&(p[N++]=d[U]);var V=C(f,e);if(V.FLAG){var k=a.slice(a.lastIndexOf(V.KEY_FOUND.toLowerCase())).slice(V.KEY_FOUND.length).trim(),F=a.trim().split(" ");if(""!==k)if(0===A.OF.toLowerCase().indexOf(k))H[b]={},H[b++]=O(I,A.OF,n,!0,!0,void 0,!0,n+1);else{var B=F.lastIndexOf(V.KEY_FOUND.toLowerCase())+1;for(var Y in 0===k.indexOf(A.OF.toLowerCase())&&(k=k.slice(A.OF.length).trim(),B+=1),I)0===I[Y].toLowerCase().indexOf(k.toLowerCase())&&I[Y].toLowerCase()!==k.toLowerCase()&&M.push(I[Y]);0!==M.length&&(H[b]={},H[b++]=O(M,void 0,B,!1,!1,void 0,!1,n+1))}else H[b]={},H[b++]=O(I,A.OF,n+1,!0,!0,void 0,!0,n+1)}var Q=C(T,e);if(Q.FLAG){F=a.trim().split(" ");if(""===(k=a.slice(a.lastIndexOf(Q.KEY_FOUND)).slice(Q.KEY_FOUND.length).trim())){H[b]={};var G=[],W="";switch(s.toLowerCase()){case A.BY:G=p,W=A.BY;break;case A.WHERE:G=d,W=A.WHERE;break;case A.FOR:G=d,W=A.FOR}return H[b]={},H[b++]=O(G,W,n,!0,!0,void 0,!0,n+1),l.REQ_OBJ=H,void r.buildLayer(l)}switch(Q.KEY_FOUND){case A.BY:for(var Y in p)0===p[Y].toLowerCase().indexOf(k.toLowerCase())&&p[Y].toLowerCase()!==k.toLowerCase()&&M.push(p[Y]);break;case A.WHERE:case A.FOR:for(var Y in d)0===d[Y].toLowerCase().indexOf(k.toLowerCase())&&d[Y].toLowerCase()!==k.toLowerCase()&&M.push(d[Y])}0!==M.length&&(H[b]={},H[b++]=O(M,Q.KEY_FOUND,F.lastIndexOf(Q.KEY_FOUND)+1,!1,!0,void 0,!0,n+1))}var j=C(d,e);if(j.FLAG&&(u=j.KEY_FOUND,g=j.FLAG,v=j.IDX),""!==u){var x=e.toLowerCase().slice(v).replace(u.toLowerCase(),"");if(""==x.trim()){if(V.FLAG&&!Q.FLAG)return H[b]={},H[b++]=O(p,A.BY,n+1,!0,!0,void 0,!0,n+1),l.REQ_OBJ=H,void r.buildLayer(l);if(Q.FLAG)switch(Q.KEY_FOUND){case A.BY:H[b]={},H[b++]=O(d,A.WHERE,n+1,!0,!0,void 0,!0,n+1)}if(p.includes(u)){G=[];if(0!==(K=r.getAllWordsForColumn(u,"",{ACTUAL_TOKENS:!0}))[u].Suggestions.length)for(var q=0;q<K[u].Suggestions.length;q++)K[u].Suggestions[q]===u&&(K[u].Suggestions.splice(q,1),K[u].ActualValues.splice(q,1),q--);G=m(G=P(K[u].Suggestions,K[u].ActualValues)),H[b]={},H[b++]=O(G,void 0,n+1,!1,!1,void 0,!1,n+1)}return l.REQ_OBJ=H,void r.buildLayer(l)}x.trim().split(" ");if(w(x.trim())){if(p.includes(u)){var K;i[n-1],G=[];if(0!==(K=r.getAllWordsForColumn(u,"",{ACTUAL_TOKENS:!0}))[u].Suggestions.length){for(q=0;q<K[u].Suggestions.length;q++)K[u].Suggestions[q]===u&&(K[u].Suggestions.splice(q,1),K[u].ActualValues.splice(q,1),q--);G=m(G=P(K[u].Suggestions,K[u].ActualValues)),H[b]={},H[b++]=O(G,void 0,n+1,!1,!1,void 0,!1,n+1),l.REQ_OBJ=H}}if(!w(x.trimStart()))return void r.buildLayer(l)}0===A.BY.toLowerCase().indexOf(x.trim())&&(H[b]={},H[b++]=O(p,A.BY,n,!0,!0,void 0,!0,n+1)),0===A.WHERE.toLowerCase().indexOf(x.trim())&&(H[b]={},H[b++]=O(d,A.WHERE,n,!0,!0,void 0,!0,n+1)),0===A.FOR.toLowerCase().indexOf(x.trim())&&(H[b]={},H[b++]=O(d,A.FOR,n,!0,!0,void 0,!0,n+1))}for(var z=n;z>=0;z--){for(var J=i[z],X=z+1;X<=n;X++)J=J+" "+i[X];for(var $ in""!==J.trim()&&(E=r.getAllWords(J,{ACTUAL_TOKENS:!0})),E)if(0!==E[$].Suggestions.length){R=z,o=J,h=E,E={};break}}if(void 0!==h[u]&&0!==h[u].Suggestions.length){for(var z in h[u].Suggestions)h[u].Suggestions[z]!==u&&h[u].Suggestions[z]!==o?void 0==D[h[u].ActualValues[z]]?D[h[u].ActualValues[z]]={value:h[u].Suggestions[z],column_name:[u],search_column:u}:D[h[u].ActualValues[z]].column_name.push(u):h[u].Suggestions[z]==u&&y.push(u);delete h[u]}for(var $ in h)if(0!==h[$].Suggestions.length)for(var z in h[$].Suggestions)h[$].Suggestions[z]!==$&&h[$].Suggestions[z]!==o?void 0==S[h[$].ActualValues[z]]?(S[h[$].ActualValues[z]]={value:h[$].Suggestions[z],column_name:[$]},g&&(S[h[$].ActualValues[z]].search_column=u)):S[h[$].ActualValues[z]].column_name.push($):h[$].Suggestions[z]==$&&y.push($);0!==Object.keys(D).length&&(E=Object.keys(D).sort(Z)).forEach(function(e){L.push(D[e])});(0!==L.length&&(H[b]={},H[b++]=O(L,void 0,R,!1,!1,void 0,!1,n+1)),0!==y.length&&(y=y.sort(Z),H[b]={},H[b++]=O(y,void 0,R,!1,!1,void 0,!0,n+1)),0!==Object.keys(S).length)&&Object.keys(S).sort(Z).forEach(function(e){_.push(S[e])});0!==_.length&&(H[b]={},H[b++]=O(_,void 0,R,!1,!1,void 0,!1,n+1)),l.REQ_OBJ=H,1!=Object.keys(l.REQ_OBJ).length||1!=l.REQ_OBJ[0].SEARCH_RESULT.length||!o||l.REQ_OBJ[0].SEARCH_RESULT[0]!=o&&l.REQ_OBJ[0].SEARCH_RESULT[0].value!=o?r.buildLayer(l):r.buildLayer({})},D.prototype.onChartTypeChange=function(e,t){var i=new r.Utility.ChartAgent,n=this.getActiveHolder();if(n){var a=n.getChartMetaByID(e);if(a){a.setType(t);var s=i.getRequestObject(a,"preview",!0),l=o.view.getActiveGridID(),c=o.view.getResourceID(l),d=o.view.getVersionID(l),u=o.view.getSheetID(l);r.Server.Action.updatePreview(c,u,d,s,function(t){this.processPreviewResponse(e,t)}.bind(this))}}},D.prototype.processPreviewResponse=function(e,o){var i=new r.Utility.ChartAgent,n=this.getActiveHolder();if(n){n.setChartMeta(e,i.clone(o,!0));var a=n.getChartLayerByID(e);new t.Model.ChartView(a.parentNode,e,o,220,330,void 0,void 0,a,!0).render()}},D.prototype.getAllHolder=function(){return Object.keys(g)},D.prototype.addChartLayer=function(e,t){var o=this.getActiveHolder();o&&o.addChartLayer(e,t)},D.prototype.insert=function(e,t){switch(I&&I.destroy(),t){case c.CHART:this.insertChart(e);break;case c.PIVOT:this.insertPivot(e)}},D.prototype.createZoomLayer=function(){(I=new t.Layer.UIZoomLayer).create()},D.prototype.getZoomLayer=function(){return!I&&this.createZoomLayer(),I},D.prototype.zoom=function(e,t){switch(!I&&this.createZoomLayer(),t){case c.CHART:this.zoomChart(e,I);break;case c.PIVOT:this.zoomPivot(e,I)}I.hideELement(this.getViewMode())},D.prototype.zoomViewByIndex=function(e){var t=this.getActiveHolder();if(t){var o=t.getIndexElement(e);o&&this.zoom(o.id,o.type)}else Layer.destroy()},D.prototype.zoomPivot=function(e,o){var r=this.getActiveHolder();if(o.setTableView(c.PIVOT),!r)return E.isEnabled&&E.log("[ZIA] >>>>>>> holder is not available for id "+e+" >>>>>>>> so destroing the zoomLayer"),void o.destroy();var i=r.getPivotMetaByID(e);if(!i)return E.isEnabled&&E.log("[ZIA] >>>>>>> Pivot META is not available for id "+e+" >>>>>>>> so destroing the zoomLayer"),void o.destroy();var n=o.getViewSpace();n.innerHTML="",o.getHeaderSpace().innerHTML=i.title;var a=r.getIndex(e);o.setIndex(a,r.getSize()),o.setActiveElement({id:e,type:c.PIVOT});var s=n.getBoundingClientRect();new t.Model.PivotView(void 0,e,i,s.height,s.width,!0,n).render()},D.prototype.zoomChart=function(e,o){var i=new r.Utility.ChartAgent,n=this.getActiveHolder();if(o.setTableView(c.CHART),!n)return E.isEnabled&&E.log("[ZIA] >>>>>>> holder is not available for id "+e+" >>>>>>>> so destroing the zoomLayer"),void o.destroy();var a=n.getChartMetaByID(e);if(!a)return E.isEnabled&&E.log("[ZIA] >>>>>>> Chart META is not available for id "+e+" >>>>>>>> so destroing the zoomLayer"),void o.destroy();var s=a.getDetails(),l=i.clone(a.getOptions(),!0),d=o.getViewSpace();d.innerHTML="",s.co=l;var u=s.co.title.text;s.co.title.text="",o.getHeaderSpace().innerHTML=u;var g=n.getIndex(e);o.setIndex(g,n.getSize()),new t.Model.ChartView(void 0,e,s,null,null,!0,d).render(),o.setActiveElement({id:e,type:c.CHART}),o.setTableView(c.CHART)},D.prototype.insertChart=function(e){var t=new r.Utility.ChartAgent,i=this.getActiveHolder();if(i){var n=i.getChartMetaByID(e);if(n){var a=t.getRequestObject(n,"new",!0),s=o.view.getActiveGridID(),l=o.view.getResourceID(s),c=o.view.getVersionID(s),d=o.view.getSheetID(s);r.Server.Action.updateChartOnGrid(l,d,c,a)}}},D.prototype.insertPivot=function(e){var t=this.getActiveHolder();if(t){var o=t.getPivotMetaByID(e);o&&u.Pivot.Util.getLocationToInsert(o,void 0,void 0,!0)}},D.prototype.placeAggergationLayer=function(e){var o=r.Wrapper.DOMUtils.getElementById("aggregationList");(p=new t.Layer.LYAggregation(o,e)).place()},D.prototype.getActiveHolder=function(){return g[v]},D.prototype.getActiveHolderID=function(){return v},D.prototype.getHolder=function(e){return g[e]||(g[e]=new t.Model.ZiaHolder),g[e]},D.prototype.flushHolderByID=function(e){g[e]&&delete g[e]},D.prototype.isValidResponse=function(e){if(this.successful=e&&!("ERROR"===(e.mt||e.mk)),!e||!this.successful)return l.ERROR;if(e.single)return l.SINGLE;if(e.drop)return l.DROP;var t=e[d.META];try{var o=t.MIXED&&t.MIXED.length>0,r=t.CHART&&t.CHART.length>0,i=t.PIVOT&&t.PIVOT.length>0;if(!(o||r||i))return l.ERROR}catch(e){return l.ERROR}return l.VALID},D.prototype.preprocessQueriesMeta=function(e){var t=this.getActiveHolder();t&&e.forEach(function(e){switch(e.Type){case c.CHART:t.addInTransient(t.addInChartMeta(e[c.CHART]),c.CHART);break;case c.PIVOT:t.addInTransient(t.addInPivotMeta(e[c.PIVOT]),c.PIVOT)}})},D.prototype.onDragEnd=function(e,t,o,r){switch(t){case c.CHART:this.onChartDragEnd(e,o,r);break;case c.PIVOT:this.onPivotDragEnd(e,o,r)}},D.prototype.onChartDragEnd=function(e,i,n){var a=this.getActiveHolder(),s=new r.Utility.ChartAgent;if(a){var l=a.getChartMetaByID(e);if(l){var c=t.Utility.getleftByColPos(n),d=t.Utility.getTopByRowPos(i);l.setLeft(c),l.setTop(d),l.setStartColIndex(n),l.setStartRowIndex(i),l.setDragMode(!0);var u=s.getRequestObject(l,"new",!0),g=o.view.getActiveGridID(),v=o.view.getResourceID(g),I=o.view.getVersionID(g),p=o.view.getSheetID(g);l.setDragMode(!1),l.resetRowColIndex(),r.Server.Action.updateChartOnGrid(v,p,I,u)}}},D.prototype.onPivotDragEnd=function(e,t,o){var r=this.getActiveHolder();if(r){var i=r.getPivotMetaByID(e);i&&u.Pivot.Util.getLocationToInsert(i,t,o,!0)}},D.prototype.processQuery=function(e){var r=o.view.getActiveGridID(),i=o.view.getResourceID(r),l=o.view.getVersionID(r),c=o.view.getSheetID(r),d=o.data.getWorkBook(i,l).getSheetObj(c).Prop.Name,u=new t.Controller.ZController,g=new t.Model.RequestObject;g.setProperties({fn:t.Server.doZiaQuery,action:"ZIA_QUERY_UPDATE",params:[{aConst:"NL_QUERY",RID:i,VERSION:l,sheetID:c,sheetName:d,holderID:v,query:escape(e),callback:u.processQueryResponse}]}),t.Manager.ZiaRequestManager.addActionIntoQueue(g),n.publish(a.UI,s.SidePanel.ZIA.QUERY.PROCESSS.QUEUE);var I=this.getActiveHolder();I&&I.cachedPreviousQuery(e)},D.prototype.updateQueryResult=function(e){n.publish(a.UI,s.SidePanel.ZIA.QUERY.PROCESSS.COMPLETE),t.Utility.hideReportComponent(),S.call(this,t.Constants.View.QUERY),t.Utility.processQueryResult(e)},D.prototype.showErrorMessage=function(){t.Utility.clearComponent(),t.Utility.hideQueryComponent(),!this.isAggregationAlive()&&t.Utility.showError(),n.publish(a.UI,s.SidePanel.ZIA.HIDE_LOADER)},D.prototype.getViewMode=function(){return h},t.Manager.ZiaViewManager=D,n.register(a.UI,s.SidePanel.ZIA.HIDE_AGG_LAYER,function(){p&&p.hide()}),n.register(a.UI,s.SidePanel.ZIA.UPDATE_VIEW,function(e){e==R.GENERAL?p&&p.toggle():p&&p.hide()},"MODE"),n.register(a.UI,s.SidePanel.ZIA.UPDATE_VIEW,S,"MODE"),n.register(a.UI,s.SidePanel.ZIA.CLOSE_PANEL,function(){g={},v=null}),n.register(a.UI,s.SidePanel.ZIA.CLOSE_ZOOM_VIEW,function(){I=null}),n.register(a.UI,s.SidePanel.ZIA.QUERY.CLEAR,function(){var e=t.Manager.ZPManager,o=new t.Manager.ZiaViewManager;if(e.isPanelOpen()){var r=o.getActiveHolder();r&&r.flushTransient()}}),n.register(a.UI,s.SidePanel.ZIA.CLEAR_PRIORITY_HEADER,function(){var e=t.Manager.ZPManager,o=new t.Manager.ZiaViewManager;if(e.isPanelOpen()){var r=o.getActiveHolder();r&&r.flushProrityHeader()}}),n.register(a.UI,s.SidePanel.ZIA.CLEAR_PRIORITY_HEADER,function(){var e=t.Manager.ZPManager,o=new t.Manager.ZiaViewManager;if(e.isPanelOpen()){var r=o.getActiveHolder();r&&r.flushFilterHeader()}})}(this);
!function(e){e.sPlusPlus;var i=e.ZSZIA,n=(e.sPlusPlus,e.ZSEvents),t=n.topic,a=n.Groups,s=n.Names;function l(){this.panel={open:!1,close:!0},this.reEvaulateNeeded=!0,this.rangeEditor={isEditing:!1,value:{prevValue:"",currValue:""}}}l.prototype={open:function(){this.panel.open=!0,this.panel.close=!1,t.publish(a.UI,s.SidePanel.ZIA.OPEN_PANEL),t.publish(a.UI,s.SidePanel.ZIA.FILTER.TOGGLE,{HAS_FILTER:!1})},close:function(){this.init(),t.publish(a.UI,s.SidePanel.ZIA.HIDE_AGG_LAYER),t.publish(a.UI,s.SidePanel.ZIA.CLOSE_PANEL),t.publish(a.UI,s.SidePanel.ZIA.FILTER.RESET)},init:function(){this.panel.open=!1,this.panel.close=!0,this.reEvaulateNeeded=!0,t.publish(a.UI,s.SidePanel.ZIA.HIDE_SEARCH)},isPanelOpen:function(){return this.panel.open},enableRangeEditor:function(){this.rangeEditor.isEditing=!0},disableRangeEditor:function(){this.rangeEditor.isEditing=!1},isRangeEditing:function(){return this.rangeEditor.isEditing},setRangeValue:function(e,i){this.rangeEditor.value={prevValue:e,currValue:i}},getRange:function(){return this.rangeEditor.value},setReEvalutate:function(e){this.reEvaulateNeeded=e},isReEvaluateAllowed:function(){return this.reEvaulateNeeded}},i.Manager.ZPManager=new l}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSZIA,s=(t=e.sPlusPlus,e.ZSEvents),a=(s.topic,s.Groups,s.Names,t.SML.Client.Utility.WorkerRequest),o=e.ZSClass.ActionObject,r=e.ZSConstants,l=r.URI,i=(e.encodeURIComponent,r.ActionConstants),I=(r.CommandConstants,e.ZSDevTools.Logger);function c(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),r=e.callback,I=i[e.aConst],c=l[e.aConst],C=new ZSClass.ParamGenerator([n],t,s,!1,!1),d=C.getSheets(),h={actionCnst:I,sheetId:n,RID:t,VERSION:s,activeCell:C.getActiveCell(),sheetList:d,holderID:e.holderID},S=(new o(I,h),new a);S.addEventListeners("onComplete",function(e){r&&r(e)}),S.open(c),S.send(h)}n.Server.doZiaQuery=function(e){var t=e.RID,n=e.sheetID,s=e.sheetName,r=e.VERSION,I=e.callback,c=i[e.aConst],C=l[e.aConst],d=new ZSClass.ParamGenerator([n],t,r,!1,!1),h=d.getSheets(),S={actionCnst:c,sheetId:n,RID:t,VERSION:r,sheetName:s,activeCell:d.getActiveCell(),sheetList:h,holderID:e.holderID,query:e.query},v=(new o(c,S),new a);v.addEventListeners("onComplete",function(e){I&&I(e)}),v.open(C),v.send(S)},n.Server.doUpdateRange=function(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),r=e.callback,I=i[e.aConst],c=l[e.aConst],C=new ZSClass.ParamGenerator([n],t,s,!1,!1),d=C.getSheets(),h={actionCnst:I,sheetId:n,RID:t,VERSION:s,activeCell:C.getActiveCell(),sheetList:d,rangeList:e.range,holderID:e.holderID},S=(new o(I,h),new a);S.addEventListeners("onComplete",function(e){r&&r(e)}),S.open(c),S.send(h)},n.Server.sendOpenZiaRequest=function(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),r=e.callback,I=i[e.aConst],c=l[e.aConst],C=new ZSClass.ParamGenerator([n],t,s,!1,!1),d=C.getSheets(),h=C.getActiveCell(),S=[];S.push(e.ranges);var v={actionCnst:I,sheetId:n,RID:t,VERSION:s,rangeList:S,activeCell:h,sheetList:d,holderID:e.holderID},R=(new o(I,v),new a);R.addEventListeners("onComplete",function(e){r&&r(e)}),R.open(c),R.send(v)},n.Server.sendCloseZiaRequest=function(e){if(e.drop)I.isEnabled&&I.log("[ZIA] >>>>>>>>>>>>> Droping zia close request >>>>>> ",e);else{var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),r=i[e.aConst],c=l[e.aConst],C=new ZSClass.ParamGenerator([n],t,s,!1,!1),d=C.getSheets(),h={actionCnst:r,sheetId:n,RID:t,VERSION:s,activeCell:C.getActiveCell(),sheetList:d,holderID:e.holderID},S=(new o(r,h),new a);S.open(c),S.send(h)}},n.Server.doZiaRefresh=c,n.Server.doZiaSync=c,n.Server.doReconnect=function(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),r=e.callback,I=e.holderID,c=i[e.aConst],C=l[e.aConst],d=new ZSClass.ParamGenerator([n],t,s,!1,!1),h=d.getSheets(),S={actionCnst:c,sheetId:n,RID:t,VERSION:s,activeCell:d.getActiveCell(),sheetList:h,holderID:I},v=(new o(c,S),new a);v.addEventListeners("onComplete",function(e){r&&r(e)}),v.open(C),v.send(S)},n.Server.doZiaPriorityHeader=function(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),r=e.callback,I=e.holderID,c=e.priorityRanges,C=i[e.aConst],d=l[e.aConst],h=new ZSClass.ParamGenerator([n],t,s,!1,!1),S=h.getSheets(),v={actionCnst:C,sheetId:n,RID:t,VERSION:s,activeCell:h.getActiveCell(),sheetList:S,holderID:I,pRanges:c},R=(new o(C,v),new a);R.addEventListeners("onComplete",function(e){r&&r(e)}),R.open(d),R.send(v)},n.Server.fetchRecommededQueries=function(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),r=e.callback,I=e.holderID,c=e.limit,C=i[e.aConst],d=l[e.aConst],h=new ZSClass.ParamGenerator([n],t,s,!1,!1),S=h.getSheets(),v={actionCnst:C,sheetId:n,RID:t,VERSION:s,activeCell:h.getActiveCell(),sheetList:S,holderID:I,limit:c},R=(new o(C,v),new a);R.addEventListeners("onComplete",function(e){r&&r(e)}),R.open(d),R.send(v)},n.Server.doZiaReset=function(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),r=e.callback,I=i[e.aConst],c=l[e.aConst],C=new ZSClass.ParamGenerator([n],t,s,!1,!1),d=C.getSheets(),h={actionCnst:I,sheetId:n,RID:t,VERSION:s,activeCell:C.getActiveCell(),sheetList:d,resetAction:e.resetAction,holderID:e.holderID},S=(new o(I,h),new a);S.addEventListeners("onComplete",function(e){r&&r(e)}),S.open(c),S.send(h)},n.Server.doFilterAction=function(e){var t=e.RID,n=e.sheetID,s=(e.sheetName,e.VERSION),r=e.callback,I=e.holderID,c=e.filterRanges,C=i[e.aConst],d=l[e.aConst],h=new ZSClass.ParamGenerator([n],t,s,!1,!1),S=h.getSheets(),v={actionCnst:C,sheetId:n,RID:t,VERSION:s,activeCell:h.getActiveCell(),sheetList:S,holderID:I,filterRanges:c},R=(new o(C,v),new a);R.addEventListeners("onComplete",function(e){r&&r(e)}),R.open(d),R.send(v)}}(this);
!function(e){e.window;var n=e.ZSZIA,a=e.sPlusPlus,t=e.ZSEvents,r=t.topic,i=t.Groups,l=t.Names,o=n.Constants.META.Type,s=(ZSClass.Range,n.Constants.View);a.data.Defaults,e.ZSDevTools;function g(){var e=a.view.getActiveGridID(),t=a.view.getResourceID(e),o=a.view.getVersionID(e),s=a.view.getSheetID(e),g=a.view.getSheetState(e,s),E=a.data.getWorkBook(t,o).getSheetObj(s).Prop.Name,S=g.getRanges(),A=new n.Controller.ZController,u=[],c="";u.push(S.pop()),c+=E+"."+(""==c?u[0].getLabel():";"+u[0].getLabel()),r.publish(i.UI,l.SidePanel.ZIA.UPDATE_RANGE,{RANGE:c});var d=new n.Model.RequestObject;d.setProperties({fn:I,action:"ZIA_OPEN",params:[{aConst:"ZIA_OPEN",ranges:u,callback:A.processResponse,RID:t,sheetID:s,sheetName:E,VERSION:o}]}),n.Manager.ZiaRequestManager.addActionIntoQueue(d),r.publish(i.UI,l.SidePanel.ZIA.SHOW_LOADER)}function I(e){n.Server.sendOpenZiaRequest(e)}function E(e){n.Server.sendCloseZiaRequest(e)}function S(e,a,t){return a.forEach(function(a){var r=n.Utility.parsePriority(e,a);r&&function(e){for(var n=t.length,a=0;a<n;a++){var r=t[a];if(e.range==r.range)return!1}return!0}(r)&&t.push(r)}),t.length>=1}function A(e){try{var n=e.length,a=e[0];return 1==n&&a.startRow==a.endRow&&a.startCol==a.endCol}catch(e){return!1}}function u(){c.call(this)}function c(){n.Manager.ZAutoComplete.hide()}r.register(i.Gesture.Selector.Range,l.GESTURE.ACTION.DOWN,u),r.register(i.UserAction,l.DocAction.ACTIVE_SHEET.BEFORE_SWITCH,function(e,a,t){var r=n.Manager.ZPManager,i=new n.Manager.ZiaViewManager;r.isPanelOpen()&&i.doBeforeSwitchAction(e,a,t)},"RID","SHEETID","VERSION"),r.register(i.UI,l.SidePanel.ZIA.ADD_SEARCH_SELECT,function(e,a,t){var o=n.Manager.ZAutoComplete;if(o.isSelectedSuggestion()){o.performSelection();var s=a.value;return r.publish(i.UI,l.SidePanel.ZIA.SUGGESTION,{TEXT:s}),void r.publish(i.UI,l.SidePanel.ZIA.SEARCH_SELECT_AT_INDEX,{INDEX:0})}r.publish(i.UI,l.SidePanel.ZIA.SUGGESTION,{TEXT:t}),r.publish(i.UI,l.SidePanel.ZIA.SEARCH_SELECT_AT_INDEX,{INDEX:0})},"QUERY","TEXTBOX","VALUE"),r.register(i.UI,l.SidePanel.ZIA.SEARCH_SELECT,function(e){n.Manager.ZAutoComplete.selectSuggestion(e)},"DIRECTION"),r.register(i.UI,l.SidePanel.ZIA.SEARCH_SELECT_AT_INDEX,function(e){n.Manager.ZAutoComplete.selectSuggestionAtIndex(e)},"INDEX"),r.register(i.UI,l.SidePanel.ZIA.SHOW_DEFAULT_SUGGESTION,function(e){if(!(e.length>=1)){var a=n.Manager.ZPManager,t=new n.Manager.ZiaViewManager;if(a.isPanelOpen()){var r=t.getActiveHolder();if(r){var i=r.getQueries(),l=r.getCachedQuery();n.Manager.ZAutoComplete.buildLayer({NEW:i||[],CACHED:l||[]},"SUBMIT")}}}},"TEXT"),r.register(i.UI,l.SidePanel.ZIA.META.CHART.SELECT,function(e,n){e.clearAllSelection(),e.setChartSelection(n)},"LAYER","TYPE"),r.register(i.UI,l.SidePanel.ZIA.SCROLL,u),r.register(i.UI,l.SidePanel.ZIA.MOVE,function(e){(new n.Manager.ZiaViewManager).zoomViewByIndex(e)},"index"),r.register(i.Listener,l.Mouse.RangeEnd,function(){var e=n.Manager.ZPManager,t=new n.Manager.ZiaViewManager;if(e.isPanelOpen()&&!e.isRangeEditing()){var o=a.view.getActiveGridID(),s=a.view.getResourceID(o),g=a.view.getVersionID(o),I=a.view.getSheetID(o),E=a.view.getSheetState(o,I),u=a.data.getWorkBook(s,g).getSheetObj(I).Prop.Name,c=E.getRanges(),d=t.getActiveHolder();if(A(c)&&d&&d.isInsideRange&&d.isInsideRange(c))d.hasPriorityHeader()&&(Z=new n.Controller.ZController).resetView({action:"ALL"});else if(A(c))(function(e){try{var a=e[0];return n.Utility.isCellBeneathPivot(a.startRow,a.startCol)}catch(e){return!1}}).call(this,c)||function(e){try{var t=e[0],o=new ZSChart.Utility.ChartAgent;o.detectTable(t,function(e){if(function(e){return e=e.replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";"),function(e){var t=n.Manager.ZPManager,r=new n.Manager.ZiaViewManager;if(t.isPanelOpen()&&!t.isRangeEditing()){var i=a.view.getActiveGridID(),l=a.view.getResourceID(i),o=a.view.getVersionID(i),s=r.getActiveHolder();if(s&&s.isInsideRange(e))return!1;var g=e.split(";"),I=JSUtil.Range.parseRange(l,o,g[0]),E=[];return I&&I.range&&E.push(I.range),!A(E)}}.call(this,e)}(e.dataRange)){var t=e.dataRange,o=new n.Controller.ZController;[].push(e.dataRange),d&&d.setRange(t),r.publish(i.UI,l.SidePanel.ZIA.UPDATE_RANGE,{RANGE:t}),o.doRangeUpdate({ranges:t})}}.bind(this),function(){})}catch(e){return!0}}.call(this,c);else{var R=[];if(d&&S(u,c,R))(Z=new n.Controller.ZController).setPriorityHeader(R);else{var P="",Z=new n.Controller.ZController,p=[];c.forEach(function(e){P+=u+"."+(""==P?e.getLabel():";"+e.getLabel()),e.id=e.type=0,p.push(e)}),d&&d.setRange(P),r.publish(i.UI,l.SidePanel.ZIA.UPDATE_RANGE,{RANGE:P}),Z.doRangeUpdate({ranges:P})}}}}),r.register(i.Listener,l.DocAction.WORKSHEETS.SWITCHSHEET,function(){if(n.Manager.ZPManager.isPanelOpen()){var e=new n.Model.RequestObject;e.setProperties({fn:g,action:"SHEET_SWITCH",params:[]}),n.Manager.ZiaRequestManager.addActionIntoQueue(e),n.Manager.ZAutoComplete.flush(),r.publish(i.UI,l.SidePanel.ZIA.SHOW_LOADER)}}),r.register(i.UI,l.SidePanel.ZIA.CLOSE_PANEL,function(){var e=new n.Manager.ZiaViewManager,t=a.view.getActiveGridID(),o=a.view.getResourceID(t),s=a.view.getVersionID(t),g=a.view.getSheetID(t),I=a.data.getWorkBook(o,s).getSheetObj(g).Prop.Name,S=e.getAllHolder(),A=new n.Model.RequestObject;A.setProperties({fn:E,action:"ZIA_CLOSE",params:[{aConst:"ZIA_CLOSE",RID:o,sheetID:g,sheetName:I,VERSION:s,holderID:JSON.stringify(S),drop:0==S.length}]}),n.Manager.ZiaRequestManager.addActionIntoQueue(A),r.publish(i.UI,l.SidePanel.ZIA.SHOW_LOADER),r.publish(i.UI,l.SidePanel.ZIA.QUERY_TOOGLE,{STATE:"result"}),n.Utility.hideQueryComponent(),n.Manager.ZPManager.init(),r.publish(i.UI,l.SidePanel.ZIA.SCROLL),r.publish(i.UI,l.SidePanel.ZIA.FILTER.HIDE)}),r.register(i.UI,l.SidePanel.ZIA.OPEN_PANEL,g),r.register(i.UI,l.SidePanel.ZIA.SYNC,function(){var e=n.Manager.ZPManager,a=new n.Controller.ZController;e.isPanelOpen()&&a.syncZia()}),r.register(i.UI,l.SidePanel.ZIA.SYNC_AFFECTED,function(e,a,t,r){var i=n.Manager.ZPManager,l=new n.Controller.ZController;i.isPanelOpen()&&l.syncZiaAffectedHolder(e,a,t,r)},"RID","SHEETID","VERSION","HOLDERS"),r.register(i.UI,l.SidePanel.ZIA.HIGHLIGHT_RANGE,function(e,a){n.Client.Range.Highlight[a]&&n.Client.Range.Highlight[a].fn.call(this,e)},"ID","TYPE"),r.register(i.UI,l.SidePanel.ZIA.PROCESS_QUERY,function(e,a){var t=n.Manager.ZAutoComplete;if(t.isSelectedSuggestion()){t.performSelection();var o=a.value;return r.publish(i.UI,l.SidePanel.ZIA.SUGGESTION,{TEXT:o}),void r.publish(i.UI,l.SidePanel.ZIA.SEARCH_SELECT_AT_INDEX,{INDEX:0})}if(r.publish(i.UI,l.SidePanel.ZIA.UPDATE_QUERY,{QUERY:e}),r.publish(i.UI,l.SidePanel.ZIA.HIDE_SEARCH),e&&1!=e.length){var s=n.Manager.ZPManager,g=new n.Controller.ZController;s.isPanelOpen()&&g.processQuery(e)}},"QUERY","TEXTBOX"),r.register(i.UI,l.SidePanel.ZIA.QUERY_TOOGLE,function(e){var a=(new n.Manager.ZiaViewManager).getViewMode(),t=ZSChart.Wrapper.DOMUtils;switch(t.getElementById("askQuestion").value="",a){case s.GENERAL:break;case s.QUERY:r.publish(i.UI,l.SidePanel.ZIA.QUERY.CLEAR),t.hide(t.getElementById("zRelatedQry")),n.Utility.showReportComponent(),r.publish(i.UI,l.SidePanel.ZIA.UPDATE_VIEW,{MODE:s.GENERAL})}},"STATE"),r.register(i.UI,l.SidePanel.ZIA.QUERY.RENDER.PREPROCESS,function(e){var a=n.Manager.ZPManager,t=new n.Manager.ZiaViewManager;if(a.isPanelOpen()&&e){var r=e.chartJSON,i=e.pivotJSON;r&&(r.co.title.text=r.co.title.text.length>2?r.co.title.text:e.naturalString);var l=[];r&&l.push({CHART:r,Type:o.CHART}),i&&l.push({PIVOT:i,Type:o.PIVOT}),t.preprocessQueriesMeta(l)}},"META"),r.register(i.UI,l.SidePanel.ZIA.META.CHART.ADD_LAYER,function(e,a){var t=n.Manager.ZPManager,r=new n.Manager.ZiaViewManager;t.isPanelOpen()&&r.addChartLayer(e,a)},"ID","LAYER"),r.register(i.UI,l.SidePanel.ZIA.CHANGE_TYPE,function(e,a){var t=n.Manager.ZPManager,r=new n.Controller.ZController;t.isPanelOpen()&&r.doChangeChartType(e,a)},"ID","Type"),r.register(i.UI,l.SidePanel.ZIA.SUGGESTION,function(e){var a=n.Manager.ZPManager,t=new n.Manager.ZiaViewManager;a.isPanelOpen()&&t.searchRelated(e)},"TEXT"),r.register(i.UI,l.SidePanel.ZIA.SEARCH_ITEM_CLICK,function(e,n,a,t,o){var s=document.querySelector("#recommendedNLPQuery > div > #askQuestion").value.trim().split(" "),g=(s.length,e.trim().split(" ")),I=g.length,E=a;if(void 0!==o){s.slice(0,o);var S=s.slice(o);I=g.length;for(var A=E,u=0;u<I;A++,u++)s[A]=g[u];for(var c=0;c<S.length;A++,c++)s[A]=S[c]}else for(A=E,u=0;u<I;A++,u++)s[A]=g[u];s[s.length]="";var d=s.join(" ");r.publish(i.UI,l.SidePanel.ZIA.UPDATE_QUERY,{QUERY:d}),"SUBMIT"==n&&r.publish(i.UI,l.SidePanel.ZIA.PROCESS_QUERY,{QUERY:e.trim()})},"VALUE","ETYPE","APPEND_INDEX","ADDED_PROPERTIES","MAXLEN"),r.register(i.UI,l.SidePanel.ZIA.HIDE_SEARCH,c),r.register(i.Listener,l.SheetAction.ACTIVE_CELL_RANGE.STATUS,function(e){var t=n.Manager.ZPManager,o=new n.Manager.ZiaViewManager;if(t.isPanelOpen()){var s=a.view.getActiveGridID(),g=a.view.getSheetID(s),I=a.view.getSheetState(s,g).getRanges();r.publish(i.UI,l.SidePanel.ZIA.SCROLL),o.placeAggergationLayer(n.Utility.cellStatusResponseParser(e,I))}},"STATUS")}(this);
!function(E){E.window,E.sPlusPlus;var e=E.ZSZIA,R=(E.sPlusPlus,E.ZSEvents),s=E.ZSDevTools,n=s.Logger,a=R.topic,o=R.Groups,r=R.Names,i=e.Manager,t=e.Constants.RESPONSE,A=E.ZSConstants.CommandConstants,M={},c=e.Constants.ErrorCode;function O(){}M[A.DOCUMENT_META]=function(E){for(var e in E){var R=E[e];R[A.SHEET_META]&&M[A.SHEET_META](R[A.SHEET_META])}},M[A.SHEET_META]=function(E){for(var e in E){var R=E[e];R[A.ZIA]&&M[A.ZIA](R[A.ZIA]),R[A.ERROR]&&M[A.ERROR](R[A.ERROR])}},M[A.QUERY]=function(E){(new i.ZiaViewManager).updateQueryResult(E)},M[A.ERROR]=function(E){n.isEnabled&&n.log("[ZIA] >>>>>>>>>>> ERROR RESPONSE >>>>>>>>>>>> ",s.Response.Decode(E));var e=E.statusCode,R=new i.ZiaViewManager;switch(e){case c.BAD_QUERY:R.updateQueryResult(E);break;case c.SERVER_ERROR:case c.BAD_REQUEST:R.showErrorMessage();break;case c.DROP_REQUEST:n.isEnabled&&n.log("[ZIA]>>>> Drop response")}},M[A.META]=function(E){var R=new i.ZiaViewManager;switch(R.isValidResponse(E)){case t.SINGLE:case t.ERROR:E&&E.RANGE&&a.publish(o.UI,r.SidePanel.ZIA.UPDATE_RANGE,{RANGE:E.RANGE}),R.showErrorMessage();break;case t.VALID:e.Utility.hideError(),e.Utility.clearComponent(),e.Utility.showQueryComponent(),e.Utility.resetIndex(),a.publish(o.UI,r.SidePanel.ZIA.QUERY_TOOGLE,{STATE:"result"}),R.process(E);break;case t.DROP:n.isEnabled&&n.log("[ZIA]>>>> Drop response")}},M[A.ZIA_RECOMMEND_QUERY]=function(E){(new i.ZiaViewManager).updateRecommendQuery(E)},M[A.ZIA]=function(E){E[A.ERROR]?M[A.ERROR](E[A.ERROR]):(E[A.META]&&M[A.META](E),E[A.QUERY]&&M[A.QUERY](E[A.QUERY]),E[A.ZIA_RECOMMEND_QUERY]&&M[A.ZIA_RECOMMEND_QUERY](E[A.ZIA_RECOMMEND_QUERY]))},M[t.ERROR]=function(E){var e=new i.ZiaViewManager;switch(e.isValidResponse(E)){case t.SINGLE:case t.ERROR:E&&E.RANGE&&a.publish(o.UI,r.SidePanel.ZIA.UPDATE_RANGE,{RANGE:E.RANGE}),e.showErrorMessage();break;case t.DROP:n.isEnabled&&n.log("[ZIA]>>>> Drop response")}},O.prototype.process=function(E){n.isEnabled&&n.log("[ZIA] >>>>>>>>>>> RESPONSE >>>>>>>>>>>> ",s.Response.Decode(E));try{E[A.DOCUMENT_META]&&M[A.DOCUMENT_META](E[A.DOCUMENT_META]),!E[A.DOCUMENT_META]&&M[t.ERROR](E)}catch(E){n.isEnabled&&n.log("[ZIA] >>>>>>>>>>> RESPONSE PARSING ERROR>>>>>>>>>>>> ",E)}},O.prototype.processQueryResponse=function(E){n.isEnabled&&n.log("[ZIA] >>>>>>>>>>> RESPONSE >>>>>>>>>>>> ",s.Response.Decode(E));try{E[A.DOCUMENT_META]&&M[A.DOCUMENT_META](E[A.DOCUMENT_META]),!E[A.DOCUMENT_META]&&M[A.QUERY](E)}catch(E){n.isEnabled&&n.log("[ZIA] >>>>>>>>>>> RESPONSE PARSING ERROR>>>>>>>>>>>> ",E)}},e.Manager.ZResponseParser=O}(this);
!function(e){e.window,e.sPlusPlus;var n=e.ZSZIA,i=(e.sPlusPlus,e.ZSEvents),o=i.topic,r=i.Groups,a=i.Names,s=n.Manager;function t(){}t.prototype={closePanel:function(){s.ZPManager.close()},openPanel:function(){s.ZPManager.open()},processResponse:function(e){(new s.ZResponseParser).process(e),(new s.ZiaViewManager).fetchRecommededQueries(-1)},refreshZia:function(){(new s.ZiaViewManager).refresh()},doRangeUpdate:function(e){(new s.ZiaViewManager).doRangeUpdate(e),o.publish(r.UI,a.SidePanel.ZIA.FILTER.RESET)},syncZia:function(){(new s.ZiaViewManager).sync()},syncZiaAffectedHolder:function(e,n,i,o){(new s.ZiaViewManager).syncZiaAffectedHolder(e,n,i,o)},syncUpdate:function(e){if(e.isModified)(new n.Controller.ZController).refreshZia();else if(e.RECONNECT){(new n.Controller.ZController).reConnectZia(e.ZID)}},reConnectZia:function(e){(new s.ZiaViewManager).reConnectZia(e)},insert:function(e,i){n.Utility.isReadOnlyView()||(new s.ZiaViewManager).insert(e,i)},zoom:function(e,n){(new s.ZiaViewManager).zoom(e,n)},processQuery:function(e){(new s.ZiaViewManager).processQuery(e)},processQueryResponse:function(e){(new s.ZResponseParser).processQueryResponse(e)},onDragEnd:function(e,i,o,r){n.Utility.isReadOnlyView()||(new s.ZiaViewManager).onDragEnd(e,i,o,r)},doChangeChartType:function(e,n){(new s.ZiaViewManager).onChartTypeChange(e,n)},setPriorityHeader:function(e){(new s.ZiaViewManager).setPriorityHeader(e)},processRecommendQueries:function(e){(new s.ZResponseParser).process(e)},resetView:function(e){(new s.ZiaViewManager).resetView(e)},doFilterAction:function(e){(new s.ZiaViewManager).doFilterAction(e)}},n.Controller.ZController=t}(this);
!function(t){t.window;var e=t.ZSZIA,n=t.sPlusPlus,i=t.ZSChart,r=e.Constants,o=t.ZSConstants.CommandConstants,s=e.Constants.META.Type,a=ZSClass.Range,h=n.data.Defaults;function c(){this.CHARTS={},this.PIVOT={},this.QUERIES=[],this.ID=void 0,this.range=void 0,this.PROFILE={},this.cIndex=r.Index.CHART,this.pIndex=r.Index.PIVOT,this.index=[],this.transiant={QUERY:[],CHART:[],PIVOT:[]},this.P_HEADERS=[],this.FILTER=[]}function p(t){var n=new i.Utility.ChartAgent;t&&t[e.Constants.META.Type.CHART]&&u.call(this,e.Constants.META.Type.CHART+"_"+this.getChartIndex(),n.clone(t[e.Constants.META.Type.CHART],!0)),t&&t[e.Constants.META.Type.PIVOT]&&d.call(this,e.Constants.META.Type.PIVOT+"_"+this.getPivotIndex(),n.clone(t[e.Constants.META.Type.PIVOT],!0))}function u(t,e){var n=new i.Model.DialogMeta;return n.constructPropertyFromObject(e),n.addDefaultIntelligence(),this.CHARTS[t]={},this.CHARTS[t].META=n,this.index.push({id:t,type:"CHART"}),t}function d(t,e){return this.PIVOT[t]=e,this.index.push({id:t,type:"PIVOT"}),t}function l(t,e){switch(e){case s.PIVOT:delete this.PIVOT[t];break;case s.CHART:delete this.CHARTS[t]}(function(t){var e=[];this.index.forEach(function(n){n&&n.id!==t&&e.push(n)}),this.index=e}).call(this,t)}c.prototype.init=function(){this.CHARTS={},this.PIVOT={},this.QUERIES=[],this.ID=void 0,this.range=void 0,this.PROFILE={},this.cIndex=r.Index.CHART,this.pIndex=r.Index.PIVOT,this.index=[],this.initTransient()},c.prototype.process=function(t){this.init(),t=t[o.META],this.setID(t.ZID),this.setRange(t.RANGE),this.setProfile(t.PROFILE),this.constructMeta(t),this.setQueries(t),this.setHeaders(t)},c.prototype.setQueries=function(t){var e=t.NLP_RECOMMEND_QUERIES;e&&(this.QUERIES=e.RecQueries)},c.prototype.setHeaders=function(t){e.Manager.ZiaFilterManager.initLayer(t.HEADERS)},c.prototype.updateRecommendQuery=function(t){var e={NLP_RECOMMEND_QUERIES:{RecQueries:t.recQueries}};this.setQueries(e)},c.prototype.getQueries=function(){return this.QUERIES},c.prototype.setPriorityHeader=function(t){this.P_HEADERS=t},c.prototype.flushProrityHeader=function(){this.P_HEADERS=[]},c.prototype.flushFilterHeader=function(){this.FILTER=[]},c.prototype.getPriorityHeader=function(){return this.P_HEADERS},c.prototype.hasPriorityHeader=function(){return this.P_HEADERS.length>=1},c.prototype.setFilterHeader=function(t){this.FILTER=t},c.prototype.hasFilter=function(){return this.FILTER.length>=1},c.prototype.cachedPreviousQuery=function(t){for(var e=this.transiant.QUERY,n=e.length,i=!1,r=0;r<n;r++){if(e[r].toLowerCase()==t.toLowerCase()){i=!0;break}}!i&&this.transiant.QUERY.push(t)},c.prototype.getCachedQuery=function(){return this.transiant.QUERY},c.prototype.setID=function(t){this.ID=t},c.prototype.setProfile=function(t){this.PROFILE=t},c.prototype.setRange=function(t){this.range=t},c.prototype.getID=function(){return this.ID},c.prototype.getRanges=function(){return this.range},c.prototype.setMixedMeta=function(t){this.MIXED=t},c.prototype.getMixedMeta=function(){return this.MIXED},c.prototype.isInsideRange=function(t){var e=!1;for(var n in t){var i=t[n];e=i&&this.hasRange(i)}return e},c.prototype.getChartMetaByID=function(t){return this.CHARTS[t].META},c.prototype.addChartLayer=function(t,e){this.CHARTS[t].Layer=e},c.prototype.getPivotMetaByID=function(t){return this.PIVOT[t]},c.prototype.setChartMeta=function(t,e){(function(t,e){var n=new i.Model.DialogMeta;n.constructPropertyFromObject(e),n.addDefaultIntelligence(),this.CHARTS[t].META=n}).call(this,t,e)},c.prototype.getChartLayerByID=function(t){return this.CHARTS[t].Layer},c.prototype.hasRange=function(t){var e=n.view.getActiveGridID(),i=n.view.getResourceID(e),r=n.view.getVersionID(e),o=this.getRanges().replace(/\$/g,"").replace(/\!/g,".").replace(/\,/g,";").split(";"),s=[];for(var c in o){if((d=JSUtil.Range.parseRange(i,r,o[c]))&&d.range){var p=new a(Math.max(d.range.startRow-1,0),Math.max(d.range.startCol-1,0),Math.min(d.range.endRow+1,h.MAX_ROW-1),Math.min(d.range.endCol+1,h.MAX_COL));s.push(p)}}var u=!1;for(var c in s){var d=s[c];if(u=this.isInRange(t,d))break}return u},c.prototype.getIndex=function(t){for(var e=-1,n=0;n<this.index.length;n++){if(e++,this.index[n].id===t)break}return e},c.prototype.getSize=function(){return this.index.length},c.prototype.getIndexElement=function(t){return this.index[t]},c.prototype.isInRange=function(t,e){return e.startRow<=t.startRow&&e.startCol<=t.startCol&&e.endRow>=t.endRow&&e.endCol>=t.endCol},c.prototype.addInTransient=function(t,e){this.transiant[e].push(t)},c.prototype.flushTransient=function(){Object.keys(this.transiant).forEach(function(t){switch(t){case s.CHART:(function(){this.transiant.CHART.forEach(function(t){l.call(this,t,s.CHART)}.bind(this))}).call(this);break;case s.PIVOT:(function(){this.transiant.PIVOT.forEach(function(t){l.call(this,t,s.PIVOT)}.bind(this))}).call(this)}}.bind(this)),this.initTransient()},c.prototype.initTransient=function(){this.transiant.CHART=[],this.transiant.PIVOT=[]},c.prototype.addInChartMeta=function(t){var n=new i.Utility.ChartAgent;return u.call(this,e.Constants.META.Type.CHART+"_"+this.getChartIndex(),n.clone(t,!0))},c.prototype.addInPivotMeta=function(t){var n=new i.Utility.ChartAgent;return d.call(this,e.Constants.META.Type.PIVOT+"_"+this.getPivotIndex(),n.clone(t,!0))},c.prototype.constructMeta=function(t){for(var n=new i.Utility.ChartAgent,r=t.MIXED||[],o=0;o<r.length;o++){var s=r[o];p.call(this,s)}var a=t.CHART?t.CHART:[];for(o=0;o<a.length;o++){var h=a[o];u.call(this,e.Constants.META.Type.CHART+"_"+this.getChartIndex(),n.clone(h,!0))}var c=t.PIVOT?t.PIVOT:[];for(o=0;o<c.length;o++){h=c[o];d.call(this,e.Constants.META.Type.PIVOT+"_"+this.getPivotIndex(),n.clone(h,!0))}},c.prototype.getChartIndex=function(){return this.cIndex++},c.prototype.getPivotIndex=function(){return this.pIndex++},e.Model.ZiaHolder=c}(this);
!function(t){t.window;var e=t.ZSZIA,s=t.ZSChart,i=t.ZSEvents,h=i.topic,r=i.Groups,c=i.Names,a=s.Constants.ChartType;function o(t,e,s,i,h,r,c,a,o){this.parentNode=t,this.ID=e,this.chartObject=s,this.tempID=c||void 0,this.height=i||null,this.width=h||null,this.Layer=a||null,this.stopPreProcess=r||!1,this.stopRecommendation=o||!1}o.prototype={render:function(){return new Promise(function(t,e){!this.stopPreProcess&&this.preProcess(),this.chartObject.co.chart.renderTo=this.tempID,this.chartObject.wd=this.width,this.chartObject.ht=this.height,!this.stopPreProcess&&this.Layer&&h.publish(r.UI,c.SidePanel.ZIA.META.CHART.ADD_LAYER,{ID:this.ID,LAYER:this.Layer}),!this.stopPreProcess&&this.Layer&&h.publish(r.UI,c.SidePanel.ZIA.META.CHART.SELECT,{LAYER:this.Layer,TYPE:this.chartObject.type}),!this.stopRecommendation&&!this.stopPreProcess&&this.Layer&&this.recommendChartType(this.chartObject),s.Action.createPreview(this.tempID,this.chartObject,{forZIA:!0}),setTimeout(function(){t()},200)}.bind(this))},preProcess:function(){this.Layer||(this.Layer=new e.Layer.UIChartLayer(this.ID,this.chartObject.co.title.text),this.parentNode.appendChild(this.Layer.container)),this.trimUnwantedProperty(),this.addAutoIntelligence(),this.setTempID(this.Layer.ID),this.appendInsights(this.Layer)},addAutoIntelligence:function(){switch(this.chartObject.type){case a.PIE.toUpperCase():case a.DOUGHNUT.toUpperCase():this.chartObject.lf="P",this.chartObject.co.plotOptions[this.chartObject.co.chart.type].dataLabels.enabled=!0}},trimUnwantedProperty:function(){this.chartObject.co.plotOptions.series.dataLabels||(this.chartObject.co.plotOptions.series.dataLabels={}),this.chartObject.co.plotOptions.series.dataLabels.enabled=!1,this.chartObject.co.legend.enabled=!1,this.chartObject.legendPos=0,this.chartObject.co.plotOptions[this.chartObject.co.chart.type].dataLabels.enabled=!1,this.chartObject.co.plotOptions[this.chartObject.co.chart.type].showInLegend=!1,this.chartObject.lf="N",this.chartObject.co.title.text="",this.chartObject.co.plotOptions.series.marker||(this.chartObject.co.plotOptions.series.marker={}),this.chartObject.co.plotOptions.series.marker.enabled=-1!==this.chartObject.type.indexOf(a.SCATTER.toUpperCase())},appendInsights:function(t){this.chartObject.insights&&h.publish(r.UI,c.SidePanel.ZIA.UPDATE_INSIGHTS,{LAYER:t,INSIGHTS:this.chartObject.insights||void 0})},recommendChartType:function(t){var e=new s.Manager.ZRecommendation;e.init(),e.setMetaData(t,!0);var i=e.predict();h.publish(r.UI,c.SidePanel.ZIA.META.CHART.RECOMMEND,{LAYER:this.Layer,TYPE:i})},setTempID:function(t){this.tempID=t},getLayer:function(){return this.Layer}},e.Model.ChartView=o}(this);
!function(t){t.window;var i=t.ZSZIA,e=t.ZSClass;e.Pivot.Util;function s(t,i,e,s,h,o,r){this.parentNode=t,this.ID=i,this.pivotObject=e,this.tempID=void 0,this.height=s||240,this.width=h||330,this.Layer=r||null,this.stopPreProcess=o||!1,this.pivotLayer=null}s.prototype={render:function(){return new Promise(function(t,i){!this.stopPreProcess&&this.preProcess(),this.pivotObject.width=this.width,this.pivotObject.height=this.height;var s=e.Pivot.Util.create();this.Layer.appendChild(s);var h=s.getContext("2d");new e.Pivot.Util.CanvasGrid(s,h,this.pivotObject).draw(),setTimeout(function(){t()},200)}.bind(this))},preProcess:function(){this.pivotLayer=new i.Layer.UIPivotLayer(this.ID,this.pivotObject.title,this.pivotObject.data.length),this.Layer=this.pivotLayer.getViewSpace(),this.parentNode.appendChild(this.pivotLayer.getContainer())},setTempID:function(t){this.tempID=t},getLayer:function(){return this.pivotLayer}},i.Model.PivotView=s}(this);
!function(t){t.window;var e=t.ZSZIA,i=t.ZSChart,n=t.ZSEvents,a=n.topic,o=n.Groups,s=n.Names,l=t.ZSConstants.I18N,d=(t.UserAction,l=t.ZSConstants.I18N,t.UIUtil.Component),r=ZSClass.Range;e.Constants.META.Type;function c(t,n,d){this.pivotsectionTag=document.createElement("section");var r=t;this.pivotsectionTag.id="pivot_explorepreview"+r,this.pivotsectionTag.classList.add("pb10");var c=document.createElement("div");c.classList.add("tCg"),this.pivotsectionTag.appendChild(c);var p=document.createElement("label");p.className="tCg",p.setAttribute("for","pivot_explorepreview"+r),c.appendChild(p);var v=document.createElement("div");v.classList.add("pTcH"),v.innerHTML=n,p.appendChild(v);var h=document.createElement("div");h.classList.add("cHaA"),h.setAttribute("id","rpId"+r),p.appendChild(h);var u=document.createElement("div");u.className="sHoP",this.pivotsectionTag.appendChild(u);var g=document.createElement("div");g.className="zIn pivot_zIn_Tab",g.id=r+"_zoom_explorepreview"+r,g.title=l["Zia.Zoom"];var E=document.createElement("div");E.className="ins_Tab pivot_ins_Tab",E.id=r+"_ins_explorepreview"+r,E.title=l["Zia.Insert.Pivot"],E.pivotTitle="",u.appendChild(E),u.appendChild(g);var y=document.createElement("div");y.classList.add("pivotFade"),y.style.height=this.height,y.style.width=this.width,h.appendChild(y);var m=document.createElement("div");m.className="fadeOutArea fadeOutBox",d<12&&(m.style.display="none");var C=document.createElement("div");C.classList.add("fOa"),m.appendChild(C),this.pivotLayer=document.createElement("div"),this.pivotLayer.id="explorepreview"+r,this.pivotLayer.classList.add("pvtAutoWidth"),y.appendChild(this.pivotLayer),y.appendChild(m),this.ID=this.pivotLayer.id;var I=i.Wrapper.DOMUtils;I.addEventByNode(this.pivotsectionTag,I.Events.MOUSEOVER,function(){a.publish(o.UI,s.SidePanel.ZIA.HIGHLIGHT_RANGE,{ID:t,TYPE:"PIVOT"})}),I.addEventByNode(this.pivotsectionTag,I.Events.MOUSELEAVE,function(){e.Client.Range.Highlight.REMOVE.fn.call(this)}),I.addEventByNode(g,I.Events.CLICK,function(){e.Client.Zoom.PIVOT.fn.call(this,t)}),I.addEventByNode(E,I.Events.CLICK,function(){e.Client.Insert.PIVOT.fn.call(this,t)}),this.attachDragable(t)}c.prototype.getViewSpace=function(){return this.pivotsectionTag.querySelector("#"+this.ID)},c.prototype.getContainer=function(){return this.pivotsectionTag},c.prototype.getDraggableLayer=function(){return this.pivotLayer},c.prototype.attachDragable=function(t){var n=i.Wrapper.DOMUtils,a=!1,o=!1;d.draggable(this.pivotsectionTag,{helper:function(){var t,e,i,n,a=this.getDraggableLayer();return t=a,e=document.createElement("canvas"),i=e.getContext("2d"),n=t.querySelector("canvas"),e.width=600,e.height=300,e.style.width="300px",e.style.height="150px",i.setTransform(2,0,0,1,0,0),i.drawImage(n,0,0,300,150),e}.bind(this),appendTo:".sheetPaneContainer",scroll:!0,onDrag:function(t,i){e.Client.Range.Highlight.REMOVE.fn.call(this),e.Utility.scrollOutGridIfNeeded(t);var n=e.Utility.getAbsoluteRowPosbyInMouseEvent(t),o=e.Utility.getAbsoluteColPosbyInMouseEvent(t),s=new r(n,o,n,o);e.Client.Range.Highlight.ADD.fn.call(this,1,s),a=!0},onStop:function(i,n){if(e.Client.Range.Highlight.REMOVE.fn.call(this),!o&&e.Client.isAllowToAddOnDragEnd(i)){var s=e.Utility.getAbsoluteRowPosbyInMouseEvent(i),l=e.Utility.getAbsoluteColPosbyInMouseEvent(i);e.Client.onDragEnd.PIVOT.fn.call(this,t,s,l)}o=!1,a=!1}}),n.addEventByNode(document.querySelector("body"),n.Events.KEYUP,function(t){switch(t.keyCode||t.which){case 27:a&&(o=!0)}})},c.prototype._collapseHeader=function(){this.pivotsectionTag.setAttribute("data-pchead","same")},e.Layer.UIPivotLayer=c,a.register(o.UI,s.SidePanel.ZIA.META.PIVOT.HEADER.COLLAPSE,function(t){t&&t._collapseHeader()},"LAYER")}(this);
!function(e){e.window;var n=e.ZSZIA,i=e.sPlusPlus,t=e.ZSEvents,r=t.topic,o=t.Groups,l=t.Names,a=n.Constants.META.Type,g=e.UserAction;n.Client.NLP_RECOMMEND_QUERIES={fn:function(e){var i=e.RecQueries;n.Utility.renderQueries(i)}},n.Client.CHART={fn:function(e,i){new Promise(function(t,r){n.Utility.renderChartRecommendations(e,i),setTimeout(function(){t()},200)})}},n.Client.PIVOT={fn:function(e,i){new Promise(function(t,r){n.Utility.renderPivotRecommendations(e,i),setTimeout(function(){t()},200)})}},n.Client.MIXED={fn:function(e){new Promise(function(i,t){n.Utility.renderMixedRecommendations(e),setTimeout(function(){i()},200)})}},n.Client.Range={},n.Client.Range.Highlight={},n.Client.Range.Highlight.REMOVE={fn:function(){var e=i.view.getActiveGridID(),n=i.view.getResourceID(e),t=i.view.getVersionID(e),a=i.view.getSheetID(e);r.publish(o.Listener,l.UserAction.HIGHLIGHT_RANGE.REMOVE,{RID:n,SHEETID:a,VERSION:t})}},n.Client.Range.Highlight.CHART={fn:function(e){var t=(new n.Manager.ZiaViewManager).getActiveHolder();if(t){var r=t.getChartMetaByID(e);if(r){var o=i.view.getActiveGridID(),l=i.view.getResourceID(o),a=i.view.getVersionID(o),g=(i.view.getSheetID(o),r.getSplitDataRanges());n.Client.Range.Highlight.REMOVE.fn.call(this);var s=1;g.trim().split(";").forEach(function(e){var i=JSUtil.Range.parseRange(l,a,e);i&&n.Client.Range.Highlight.ADD.fn.call(this,s,i.range),s++})}}}},n.Client.Range.Highlight.ADD={fn:function(e,n,t){var a=i.view.getActiveGridID(),g=i.view.getResourceID(a),s=i.view.getVersionID(a),I=i.view.getSheetID(a);r.publish(o.Listener,l.UserAction.HIGHLIGHT_RANGE.ADD,{RID:g,SHEETID:I,VERSION:s,RANGEID:e,RANGE:n,COLOR:t||"#f7b44b"})}},n.Client.Range.Highlight.PIVOT={fn:function(e){var t=(new n.Manager.ZiaViewManager).getActiveHolder();if(t){var r=t.getPivotMetaByID(e);if(r){var o=i.view.getActiveGridID(),l=i.view.getResourceID(o),a=i.view.getVersionID(o),g=(i.view.getSheetID(o),r.pa_json.dataRangeStr);if(g){n.Client.Range.Highlight.REMOVE.fn.call(this);var s=1;g.trim().split(";").forEach(function(e){var i=JSUtil.Range.parseRange(l,a,e);i&&n.Client.Range.Highlight.ADD.fn.call(this,s,i.range),s++})}}}}},n.Client.Insert={},n.Client.Zoom={},n.Client.onDragEnd={},n.Client.Insert.CHART={fn:function(e){var t=i.view.getActiveGridID(),g=i.view.getResourceID(t),s=i.view.getVersionID(t),I=i.view.getSheetID(t);r.publish(o.Listener,l.Layers.Ole.Blur,{RID:g,SHEETID:I,VERSION:s}),(new n.Controller.ZController).insert(e,a.CHART)}},n.Client.Insert.PIVOT={fn:function(e){(new n.Controller.ZController).insert(e,a.PIVOT)}},n.Client.Zoom.CHART={fn:function(e){(new n.Controller.ZController).zoom(e,a.CHART)}},n.Client.Zoom.PIVOT={fn:function(e){(new n.Controller.ZController).zoom(e,a.PIVOT)}},n.Client.isAllowToAddOnDragEnd=function(e){return n.Client.ifNotUnderPanel(e)},n.Client.ifNotUnderPanel=function(e){var i=n.Utility.getWrapperNode().getBoundingClientRect();return e.pageX-50<=i.left},n.Client.onDragEnd.CHART={fn:function(e,t,g){var s=i.view.getActiveGridID(),I=i.view.getResourceID(s),R=i.view.getVersionID(s),u=i.view.getSheetID(s);r.publish(o.Listener,l.Layers.Ole.Blur,{RID:I,SHEETID:u,VERSION:R}),(new n.Controller.ZController).onDragEnd(e,a.CHART,t,g),r.publish(o.UI,l.SidePanel.ZIA.BLUR)}},n.Client.onDragEnd.PIVOT={fn:function(e,i,t){(new n.Controller.ZController).onDragEnd(e,a.PIVOT,i,t),r.publish(o.UI,l.SidePanel.ZIA.BLUR)}},n.Client.onDragEnd.FORMULA={fn:function(e,t,a,s,I){if(!n.Utility.isReadOnlyView()){I="true"==I;var R=i.view.getActiveGridID(),u=i.view.getResourceID(R),v=i.view.getVersionID(R),c=i.view.getSheetID(R),f=[];f.push(c);var D=new ZSClass.Range(e,t,e,t);!I&&g.SubmitCellAlongWithPattern(u,f,v,a,s,e,t,!0),I&&g.SubmitArrayFormula(u,f,v,a,e,t,D,!0),r.publish(o.UI,l.SidePanel.ZIA.BLUR)}}}}(this);
!function(e){e.window;var t=e.ZSZIA,i=e.ZSChart,n=e.sPlusPlus,r=e.ZSEvents,o=r.topic,s=r.Groups,a=r.Names,l=t.Constants,d=l.Index.CHART,u=l.Index.PIVOT,c=ZSConstants.I18N,I=e.ZSDevTools.Logger,g=null;function v(t,i){var r,o=n.view.getGridComponent(i);if(e.isCanvasGrid){var s=o.translateCoordinates(t);r=o.getRelativeCoordinates(s.x,s.y)}else r=o.getRelativeCoordinates(t);return r}function y(e){var t=[];return t.push(e),t}t.Utility.parsePriority=function(e,t){var i=t.isColRange(),n=null,r=i?1:2;return(i?t.isCol():t.isRow())&&(n={type:r,range:e+"."+t.getLabel()}),n},t.Utility.isReadOnlyView=function(){var e=n.view.getActiveGridID(),t=n.view.getResourceID(e),i=n.view.getVersionID(e),r=n.view.getSheetID(e),o=n.data.getWorkBook(t,i);return o.isEditable()?!!o.ProtectedSheets.isSheetLocked(r)&&(ZSClass.ZSAlert(c["ProtectRange.UI.SheetLocked"]),!0):(ZSClass.ZSAlert(c["Banner.ReadOnly.App.Server"],{title:c["Alert.Title.ROMode"]}),!0)},t.Utility.isCellBeneathPivot=function(e,t){var i=n.view.getActiveGridID(),r=n.view.getResourceID(i),o=n.view.getVersionID(i),s=n.view.getSheetID(i);return!!n.data.getWorkBook(r,o).getSheetObj(s).Pivot.isXists(e,t)},t.Utility.getAbsoluteRowPosbyInMouseEvent=function(e){var i=n.view.getActiveGridID(),r=n.view.getResourceID(i),o=n.view.getVersionID(i),s=n.view.getSheetID(i),a=n.data.getWorkBook(r,o).getSheetObj(s),l=t.Utility.getRelativeCoordinates(e);return a.Row.auxiliaryAxis.findAbs(l.y)},t.Utility.scrollOutGridIfNeeded=function(){t.Client.isAllowToAddOnDragEnd(event)&&(null==g&&(g=new ZSClass.Timer(200,function(){!function(){g=null;var t=new Event("mouseup");e.dispatchEvent(t)}()})),g.reset(),o.publish(s.Listener,a.Mouse.ScrollOut,{GRIDID:n.view.getActiveGridID(),CALLBACK:function(){g.reset()}}))},t.Utility.getAbsoluteColPosbyInMouseEvent=function(e){var i=n.view.getActiveGridID(),r=n.view.getResourceID(i),o=n.view.getVersionID(i),s=n.view.getSheetID(i),a=n.data.getWorkBook(r,o).getSheetObj(s),l=t.Utility.getRelativeCoordinates(e);return a.Column.auxiliaryAxis.findAbs(l.x)},t.Utility.getRelativeCoordinates=function(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),r=n.view.getVersionID(t),o=n.view.getSheetID(t),s=(n.view.getSheetState(t,o).getZoom(),n.data.getWorkBook(i,r).getSheetObj(o),n.view.getGridComponent(t),v(e,t));return{x:s.x-e.offsetX,y:s.y-e.offsetY}},t.Utility.getRowPosbyInMouseEvent=function(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),r=n.view.getVersionID(t),o=n.view.getSheetID(t),s=n.data.getWorkBook(i,r).getSheetObj(o),a=v(e,t);return s.Row.auxiliaryAxis.findAbs(a.y)},t.Utility.getleftByColPos=function(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),r=n.view.getVersionID(t),o=n.view.getSheetID(t);return n.data.getWorkBook(i,r).getSheetObj(o).Column.auxiliaryAxis.getPos(e)},t.Utility.getTopByRowPos=function(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),r=n.view.getVersionID(t),o=n.view.getSheetID(t);return n.data.getWorkBook(i,r).getSheetObj(o).Row.auxiliaryAxis.getPos(e)},t.Utility.getColPosbyInMouseEvent=function(e){var t=n.view.getActiveGridID(),i=n.view.getResourceID(t),r=n.view.getVersionID(t),o=n.view.getSheetID(t),s=n.data.getWorkBook(i,r).getSheetObj(o),a=v(e,t);return s.Column.auxiliaryAxis.findAbs(a.x)},t.Utility.getWrapperNode=function(){return document.getElementById("pivotRec_container")},t.Utility.renderMixedRecommendations=function(e){for(var t=document.getElementById("recommendedMixedList"),i=0;i<e.length;i++){var n=e[i];Object.keys(n).length;this.render(n,this,t)}},t.Utility.renderQueries=function(e,i){!e&&(e=[]);var n=document.getElementById("queryList"),r=i&&-1!=i?e.slice(0,i):e;new t.Layer.LYQuery(n,r).place()},t.Utility.render=function(e,i,n){return new Promise(function(r,l){e&&e[t.Constants.META.Type.CHART]&&function(e){try{var i=new t.Model.ChartView(n,t.Constants.META.Type.CHART+"_"+t.Utility.getChartIndex(),e,220,330);i.render()}catch(e){I.isEnabled&&I.log("[ZIA] >>>>>>>> Chart Thrown exception while rendering ",e)}}.call(this,e[t.Constants.META.Type.CHART]),e&&e[t.Constants.META.Type.PIVOT]&&function(e){try{var i=new t.Model.PivotView(n,t.Constants.META.Type.PIVOT+"_"+t.Utility.getPivotIndex(),e,220,330);i.render(),o.publish(s.UI,a.SidePanel.ZIA.META.PIVOT.HEADER.COLLAPSE,{LAYER:i.getLayer()})}catch(e){I.isEnabled&&I.log("[ZIA] >>>>>>>> Pivot Thrown exception while rendering ",e)}}.call(this,e[t.Constants.META.Type.PIVOT]),setTimeout(function(){r(i)},200)})},t.Utility.renderPivotRecommendations=function(e,t){var i=t||document.getElementById("recommendedTableList");this.processPivotResponse(i,e)},t.Utility.processPivotResponse=function(e,i){var n=i.shift();if(n){var r=t.Utility.getPivotIndex();new t.Model.PivotView(e,t.Constants.META.Type.PIVOT+"_"+r,n,220,344).render().then(function(){setTimeout(function(){this.processPivotResponse(e,i)}.bind(this),200)}.bind(this))}},t.Utility.renderChartRecommendations=function(e,t){var i=t||document.getElementById("recommendedGraphList");this.processChartResponse(i,e)},t.Utility.processChartResponse=function(e,i){var n=i.shift();if(n){var r=t.Utility.getChartIndex();new t.Model.ChartView(e,t.Constants.META.Type.CHART+"_"+r,n,220,344).render().then(function(){setTimeout(function(){this.processChartResponse(e,i)}.bind(this),200)}.bind(this))}},t.Utility.clearComponent=function(){var e=i.Wrapper.DOMUtils;["queryList","recommendedGraphList","recommendedTableList","recommendedMixedList"].forEach(function(t){e.setInnerHTML(t,"")})},t.Utility.hideReportComponent=function(){var e=i.Wrapper.DOMUtils;["recommendedGraphList","recommendedTableList","recommendedMixedList"].forEach(function(t){e.hideById(t)})},t.Utility.showReportComponent=function(){var e=i.Wrapper.DOMUtils;["recommendedGraphList","recommendedTableList","recommendedMixedList"].forEach(function(t){e.showById(t)});var n=(new t.Manager.ZiaViewManager).getActiveHolder();if(n){var r=n.getQueries();t.Utility.renderQueries(r,3)}},t.Utility.hideQueryComponent=function(){var e=i.Wrapper.DOMUtils;["recommendedNLPQuery"].forEach(function(t){e.hideById(t)})},t.Utility.showQueryComponent=function(){var e=i.Wrapper.DOMUtils;["recommendedNLPQuery"].forEach(function(t){e.showById(t)})},t.Utility.processQueryResult=function(e){var t=e,i=function(e){try{var t=!0;if(!e.naturalString)return!1;switch(e.naturalString){case"invalid":t=!1}return t}catch(e){return!1}return!0}(t);i||o.publish(s.UI,a.SidePanel.ZIA.QUERY.ERROR),o.publish(s.UI,a.SidePanel.ZIA.QUERY.UPDATE.DOM,{META:t}),o.publish(s.UI,a.SidePanel.ZIA.QUERY.RENDER.PREPROCESS,{META:t}),i&&o.publish(s.UI,a.SidePanel.ZIA.QUERY.RENDER.RELATED_QUERY,{META:t.related}),i&&o.publish(s.UI,a.SidePanel.ZIA.QUERY.RENDER.PIVOT,{META:t.pivotJSON}),i&&o.publish(s.UI,a.SidePanel.ZIA.QUERY.RENDER.CHART,{META:t.chartJSON}),i&&o.publish(s.UI,a.SidePanel.ZIA.QUERY.RENDERING_PRIORITY,{RENDERING_PRIORITY:t.RENDERING_PRIORITY})},t.Utility.showError=function(){i.Wrapper.DOMUtils.showById("ZIAMessage")},t.Utility.hideError=function(){i.Wrapper.DOMUtils.hideById("ZIAMessage")},t.Utility.getChartIndex=function(){return d++},t.Utility.getPivotIndex=function(){return u++},t.Utility.resetIndex=function(){d=l.Index.CHART,u=l.Index.PIVOT},o.register(s.UI,a.SidePanel.ZIA.QUERY.RENDER.RELATED_QUERY,function(e){var n=i.Wrapper.DOMUtils;t.Utility.renderQueries(e),e&&e.length>=1?n.showById("zRelatedQry"):n.hideById("zRelatedQry")},"META"),o.register(s.UI,a.SidePanel.ZIA.QUERY.RENDER.CHART,function(e){var n=i.Wrapper.DOMUtils,r=n.getElementById("qryResult");n.show(r),t.Client.CHART.fn.call(this,y(e),r)},"META"),o.register(s.UI,a.SidePanel.ZIA.QUERY.RENDER.PIVOT,function(e){var n=i.Wrapper.DOMUtils,r=n.getElementById("qryResult");n.show(r),t.Client.PIVOT.fn.call(this,y(e),r)},"META"),o.register(s.UI,a.SidePanel.ZIA.QUERY.UPDATE.DOM,function(e){var n,r,o,s,a=i.Wrapper.DOMUtils;a.addClass(a.getElementById("recommendedNLPQuery"),"startQry"),a.show(a.getElementByClassName("relatedQry")),a.setInnerHTML("Answar",""),a.setInnerHTML("formlaViewSpace",""),a.hideById("Answar"),a.hideById("zQAnswar"),a.hideById("Formula"),a.hideById("zQFormula"),a.hideById("zResult"),a.hideById("zTableFade"),e&&e.naturalString&&function(e,t){var i={},n=a.getElementById("Answar"),r="";t.columns.forEach(function(t){var n,r;n=t,r=e.toLowerCase().indexOf(n.toLowerCase()),i[r]=r+n.length});for(var o=0;o<e.length;o++){if(i.hasOwnProperty(o)){var s=i[o];r+="<i class='fntBld'>"+e.substring(o,s)+"</i>",o=s}o<e.length&&(r+=e.charAt(o))}(function(e){var t=a.createElement("span");t.innerHTML=e,a.appendChild(n,t)})(r),a.showById("Answar"),a.showById("zQAnswar")}(e.naturalString,e.keywords),e&&e.formula&&(n=e.formula,r=e.pattern,o=e.isArrayFormula,(s=a.getElementById("Formula")).setAttribute("data-formula",n),s.setAttribute("data-iaf",o),s.setAttribute("data-pattern",r),a.setInnerHTML("formlaViewSpace",n),a.addStyle(s,{display:"flex"}),a.showById("zQFormula")),e&&e.result&&function(e){var n=i.Wrapper.DOMUtils.getElementById("zResult"),r=new t.Layer.LYFormula(n.querySelector("#zResultTable"),e);r.build(),r.toggle()}(e),a.addAttributes("voice_cancel",{"data-state":"result"})},"META"),o.register(s.UI,a.SidePanel.ZIA.QUERY.PROCESSS.QUEUE,function(){var e=i.Wrapper.DOMUtils;e.addClass(e.getElementById("recommendedNLPQuery"),"loading")}),o.register(s.UI,a.SidePanel.ZIA.QUERY.PROCESSS.COMPLETE,function(){i.Wrapper.DOMUtils.getElementById("recommendedNLPQuery").classList.remove("loading"),o.publish(s.UI,a.SidePanel.ZIA.QUERY.CLEAR)}),o.register(s.UI,a.SidePanel.ZIA.QUERY.CLEAR,function(){var e=i.Wrapper.DOMUtils;e.removeClass(e.getElementById("recommendedNLPQuery"),"startQry"),e.setInnerHTML("qryResult",""),e.hide(e.getElementByClassName("invalidQuest"))}),o.register(s.UI,a.SidePanel.ZIA.QUERY.ERROR,function(){var e=i.Wrapper.DOMUtils;e.show(e.getElementByClassName("invalidQuest"))}),o.register(s.UI,a.SidePanel.ZIA.QUERY.RENDERING_PRIORITY,function(e){if(e){for(var t=i.Wrapper.DOMUtils,n=t.getElementById("qryResult"),r=n.children,o=r.length,s=null,a=0;a<o;a++){var l=r[a];if(-1!==l.id.indexOf("CHART")){s=l;break}}s&&t.addChildAtIndex(s,n,null,0)}},"RENDERING_PRIORITY")}(this);
!function(t){t.window,t.sPlusPlus;var s=t.ZSZIA,i=(t.sPlusPlus,t.ZSEvents);i.topic,i.Groups,i.Names,t.JSUtil,t.ZSDevTools.Logger;function o(){this.fn=void 0,this.args=void 0,this.action=void 0}o.prototype={process:function(){this.fn.apply(this,this.args)},getAction:function(){return this.action},setProperties:function(t){this.fn=t.fn,this.action=t.action,this.args=t.params}},s.Model.RequestObject=o}(this);
!function(t){t.window,t.sPlusPlus;var i=t.ZSZIA,e=(t.sPlusPlus,t.ZSEvents),s=(e.topic,e.Groups,e.Names,t.JSUtil,t.ZSDevTools.Logger);function u(){this.queue=[],this.quid=-1,this.xuid=-1,this.ttl=void 0,this.queueing=!1}u.prototype.addActionIntoQueue=function(t){s.isEnabled&&s.log("[ZIA] >>>>>>>>>> Added Request to Queue  of action ",t.getAction()),this.queueing=!0,this.queue.push(t),this.getNextQuid(),clearTimeout(this.ttl),this.ttl=setTimeout(this.execute.bind(this),500),this.queueing=!1},u.prototype.execute=function(){if(!this.queueing){this.quid;var t=this.queue.pop();s.isEnabled&&s.log("[ZIA] >>>>>>>>>> going to perfromAction ",t.getAction()),this.perfromAction(t);var i=this.getNextXaid();s.isEnabled&&s.log("[ZIA] >>>>>>>>>> last perfomed xaid ",i)}},u.prototype.flush=function(){s.isEnabled&&s.log("[ZIA] >>>>>>>>>> Flushing Unwnated Request "),this.queue=[],this.quid=-1,this.xuid=-1,this.ttl=void 0,this.queueing=!1},u.prototype.perfromAction=function(t){try{t.process(),this.ttl=setTimeout(this.flush.bind(this),1e3)}catch(i){s.isEnabled&&s.log("[ZIA] >>>>>>>>>> last perfomed action is failed due to ",t.getAction(),i)}},u.prototype.getNextQuid=function(){this.quid++},u.prototype.getNextXaid=function(){var t=this.quid;return this.quid--,t},i.Manager.ZiaRequestManager=new u}(this);
!function(e){e.window;var t=e.ZSZIA,i=e.ZSChart,a=e.ZSEvents,n=a.topic,r=a.Groups,s=a.Names,o=e.UserAction,c=e.ZSConstants.I18N,l=e.UIUtil.Component,h=ZSClass.Range;t.Constants.META.Type,t.Constants.SupportedChart;function d(e,a){this.chartsectionTag=document.createElement("section");var o=e;this.chartsectionTag.id="chart_explorepreview"+o;var l=document.createElement("div");l.classList.add("tCg"),this.chartsectionTag.appendChild(l);var h=document.createElement("label");h.className="tCg",h.setAttribute("for","chart_explorepreview"+o),l.appendChild(h);var d=document.createElement("div");d.classList.add("pTcH"),d.innerHTML=a,h.appendChild(d),this.initInsightsLayer(h,o);var p=document.createElement("div");p.classList.add("cHaA","flt_left"),p.setAttribute("id","rcId"+o),h.appendChild(p);var T=document.createElement("div");T.className="sHoP",this.chartsectionTag.appendChild(T);var E=document.createElement("div");E.className="zIn chart_zIn_Tab",E.id=o+"_zoom_explorepreview"+o,E.title=c["Zia.Zoom"];var g=document.createElement("div");g.className="ins_Tab chart_ins_Tab",g.id=o+"_ins_explorepreview"+o,g.title=c["Zia.Insert.Chart"],T.appendChild(g),T.appendChild(E),this.chartLayer=document.createElement("div"),this.chartLayer.id="explorepreview"+o,this.chartLayer.style.height=this.height,this.chartLayer.style.width=this.width,p.appendChild(this.chartLayer),this.container=this.chartsectionTag,this.ID=this.chartLayer.id;var u=i.Wrapper.DOMUtils;u.addEventByNode(this.chartsectionTag,u.Events.MOUSEOVER,function(){n.publish(r.UI,s.SidePanel.ZIA.HIGHLIGHT_RANGE,{ID:e,TYPE:"CHART"})}),u.addEventByNode(this.chartsectionTag,u.Events.MOUSELEAVE,function(){t.Client.Range.Highlight.REMOVE.fn.call(this)}),u.addEventByNode(E,u.Events.CLICK,function(){t.Client.Zoom.CHART.fn.call(this,e)}),u.addEventByNode(g,u.Events.CLICK,function(){t.Client.Insert.CHART.fn.call(this,e)}),this.initTypeLayer(o),this.attachDragable(e)}d.prototype.initTypeLayer=function(e){var t=i.Wrapper.DOMUtils,a=o.getTemplate(["SP_ZIA_CHART_TYPE_TEMPLATE"]);this.chartsectionTag.appendChild(a.SP_ZIA_CHART_TYPE_TEMPLATE);var c=this.chartsectionTag.querySelector("#ZIA_CHART_TYPE").children;for(var l in c){var h=c[l];1==h.nodeType&&t.addEventByNode(h,t.Events.CLICK,function(){n.publish(r.UI,s.SidePanel.ZIA.CHANGE_TYPE,{ID:e,Type:this.id})})}},d.prototype.initInsightsLayer=function(e){var t=o.getTemplate(["SP_ZIA_INSIGHTS_TEMPLATE"]);e.appendChild(t.SP_ZIA_INSIGHTS_TEMPLATE)},d.prototype.getInsightsSpace=function(){return this.chartsectionTag.querySelector("#zInsigts")},d.prototype.getDraggableLayer=function(){return this.chartLayer},d.prototype.setChartSelection=function(e){var t=this.chartsectionTag.querySelector("#ZIA_CHART_TYPE").children;for(var i in t){var a=t[i];if(1==a.nodeType&&-1!==a.id.indexOf(e)){a.classList.add("sel");break}}},d.prototype.clearAllSelection=function(){var e=this.chartsectionTag.querySelector("#ZIA_CHART_TYPE").children;for(var t in e){var i=e[t];1==i.nodeType&&i.classList.remove("sel")}},d.prototype.updateProposedChartTypes=function(e){var t=i.Wrapper.DOMUtils,a=this.chartsectionTag.querySelector("#ZIA_CHART_TYPE").children;for(var n in a){var r=a[n];1==r.nodeType&&(-1==e.indexOf(r.id)?t.hide(r):t.show(r))}},d.prototype.attachDragable=function(a){var n=i.Wrapper.DOMUtils,r=!1,s=!1;l.draggable(this.chartsectionTag,{helper:function(){return this.getDraggableLayer().cloneNode(!0)}.bind(this),appendTo:e.isCanvasGrid?".gridContainer":".sheetPaneContainer",scroll:!0,onDrag:function(e,i){t.Client.Range.Highlight.REMOVE.fn.call(this),t.Utility.scrollOutGridIfNeeded(e);var a=t.Utility.getAbsoluteRowPosbyInMouseEvent(e),n=t.Utility.getAbsoluteColPosbyInMouseEvent(e),s=new h(a,n,a,n);t.Client.Range.Highlight.ADD.fn.call(this,1,s),r=!0},onStop:function(e,i){if(t.Client.Range.Highlight.REMOVE.fn.call(this),!s&&t.Client.isAllowToAddOnDragEnd(e)){var n=t.Utility.getAbsoluteRowPosbyInMouseEvent(e),o=t.Utility.getAbsoluteColPosbyInMouseEvent(e);t.Client.onDragEnd.CHART.fn.call(this,a,n,o)}s=!1,r=!1}}),n.addEventByNode(document.querySelector("body"),n.Events.KEYUP,function(e){switch(e.keyCode||e.which){case 27:r&&(s=!0)}})},d.prototype._collapseHeader=function(){this.chartsectionTag.setAttribute("data-pchead","same")},t.Layer.UIChartLayer=d,n.register(r.UI,s.SidePanel.ZIA.META.CHART.HEADER.COLLAPSE,function(e){e&&e._collapseHeader()},"LAYER"),n.register(r.UI,s.SidePanel.ZIA.UPDATE_INSIGHTS,function(e,t){var i=e.getInsightsSpace();t.length>1&&(i.innerHTML=t)},"LAYER","INSIGHTS"),n.register(r.UI,s.SidePanel.ZIA.META.CHART.RECOMMEND,function(e,t){e&&e.updateProposedChartTypes(t)},"LAYER","TYPE")}(this);
!function(e){e.window;var t,i=e.ZSZIA,r=e.ZSChart,a=e.ZSEvents,n=a.topic,d=a.Groups,s=a.Names,o=e.ZSConstants.I18N,p=i.Constants.View,l=i.Constants.META.Type,c=e.JSUtil,h=-1,v={},u=!1;function y(){this.parent=document.querySelector("body")}y.prototype.create=function(){var e=r.Wrapper.DOMUtils;(t=e.createElement("div")).id="rPtMd",t.classList.add("rPtM"),e.addEventByNode(this.parent,e.Events.KEYUP,function(e){switch(e.keyCode||e.which){case 27:this.destroy();break;case 37:this.onLeftMove();break;case 39:this.onRightMove()}}.bind(this)),e.appendChild(this.parent,t);var i=e.createElement("div");i.classList.add("rPtMc");var a=e.createElement("div");a.classList.add("rPtMcB"),e.appendChild(t,a),e.appendChild(t,i);var n=e.createElement("div");n.classList.add("pEsc"),n.innerText=o["Zia.Esc"],e.addEventByNode(a,e.Events.CLICK,this.destroy),e.appendChild(a,n);var d=e.createElement("article");d.classList.add("rPtMcA"),e.appendChild(i,d);var s=e.createElement("div");s.classList.add("ziaLeftArw"),e.addEventByNode(s,e.Events.CLICK,this.onLeftMove),e.appendChild(t,s);var p=e.createElement("section");p.classList.add("rPtMcAs"),e.appendChild(d,p);var l=e.createElement("div");l.id="rPtGrd",l.classList.add("fnt14","fntBld"),e.appendChild(p,l);var c=e.createElement("div");c.id="rPtCrt",c.classList.add("bgClr");var h=document.createElement("button");h.className="Zsbtn flt_right mt10 mr20 ml20",h.innerText=o["Zia.Insert"]||"Insert",this.insertDOM=h,e.addEventByNode(h,e.Events.CLICK,this.onInsert),e.appendChild(d,h);var v=e.createElement("article");v.classList.add("rPtMcAc"),v.id="zViewSpace",e.appendChild(i,v);var u=e.createElement("div");u.id="rPtCGrd",e.appendChild(v,u);var y=e.createElement("div");y.classList.add("ziaRightArw"),e.addEventByNode(y,e.Events.CLICK,this.onRightMove),e.appendChild(t,y);var E=e.createElement("div");E.classList.add("pgNumber"),e.appendChild(t,E)},y.prototype.destroy=function(){r.Wrapper.DOMUtils.remove("rPtMd"),u=!1,n.publish(d.UI,s.SidePanel.ZIA.CLOSE_ZOOM_VIEW)},y.prototype.getViewSpace=function(){return t.querySelector("#zViewSpace")},y.prototype.getHeaderSpace=function(){return t.querySelector("#rPtGrd")},y.prototype.setActiveElement=function(e){var t=r.Wrapper.DOMUtils;v.id=e.id,v.type=e.type,l.FORMULA==e.type?t.hide(this.insertDOM):t.show(this.insertDOM),u=!0},y.prototype.onInsert=function(){i.Client.Insert[v.type].fn.call(this,v.id)},y.prototype.setIndex=function(e,t){h=e+1,this.setPageIndex(t)},y.prototype.setPageIndex=function(e){var i=r.Wrapper.DOMUtils;t.querySelector(".pgNumber").innerText=h+"/"+e;var a=t.querySelector(".ziaLeftArw"),n=t.querySelector(".ziaRightArw");i.show(a),i.show(n),h<=1&&i.hide(a),h>=e&&i.hide(n)},y.prototype.hideELement=function(e){var i=r.Wrapper.DOMUtils,a=t.querySelector(".pgNumber"),n=t.querySelector(".ziaLeftArw"),d=t.querySelector(".ziaRightArw");i.show(a),e==p.QUERY&&(i.hide&&i.hide(n),i.hide&&i.hide(d),i.hide&&i.hide(a))},y.prototype.setTableView=function(e){r.Wrapper.DOMUtils.getElementByClassName("rPtMc").setAttribute("data-type",e)},y.prototype.onLeftMove=function(){u&&n.publish(d.UI,s.SidePanel.ZIA.MOVE,{index:h-2})},y.prototype.onRightMove=function(){u&&n.publish(d.UI,s.SidePanel.ZIA.MOVE,{index:h})},y.prototype.setRecordSummary=function(e){var t=r.Wrapper.DOMUtils,i=t.createElement("div");i.classList.add("wid100","flt_left","txt_left","pt20");var a=t.createElement("span");a.classList.add("fntBld"),a.innerText=o["documentsettingsdialog.Note"]+":";var n=t.createElement("span");n.innerText=c.fn.replaceParams(o["Zia.Record.Total"],[e.to,e.upto]),n.classList.add("pl5"),t.appendChild(i,a),t.appendChild(i,n),t.appendChild(this.getViewSpace(),i)},y.prototype.createGrid=function(t,i){this.grid=new e.Handsontable(t,i)},y.prototype.setData=function(e){this.grid&&this.grid.loadData(e),this.gird&&this.grid.render()},i.Layer.UIZoomLayer=y}(this);
!function(e){e.window;var t=e.ZSZIA,r=e.ZSChart,n=e.ZSEvents,i=n.topic,a=n.Groups,s=n.Names,p=t.Constants.LayerCode,o=t.Constants.LayerIcon;function d(e,t){this.parentNode=e,this.recQueries=t}function h(){var e=this.dataset;i.publish(a.UI,s.SidePanel.ZIA.PROCESS_QUERY,{QUERY:e.query})}d.prototype.place=function(){var e=r.Wrapper.DOMUtils;this.parentNode.innerHTML="",this.recQueries&&this.recQueries.forEach(function(t){var n=e.createElement("li",{"data-query":t});n.appendChild(function(){var e=r.Wrapper.DOMUtils,t="http://www.w3.org/2000/svg",n=e.createElementNS(t,"svg",{height:20,width:18,viewBox:"-1 -1 18 21"});n.classList.add("flt_left","mr10","posRel");var i=e.createElementNS(t,"use");return i.setAttributeNS("http://www.w3.org/1999/xlink","href",o[p.NEW]),e.appendChild(n,i),n}());var i=e.createElement("span");i.innerText=t,n.appendChild(i),e.addEventByNode(n,e.Events.CLICK,h),e.appendChild(this.parentNode,n)}.bind(this))},d.prototype.remove=function(){r.Wrapper.DOMUtils.setInnerHTML("queryList","")},t.Layer.LYQuery=d}(this);
!function(t){t.window;var e=t.ZSZIA,i=t.ZSChart,s=(t.sPlusPlus,t.ZSEvents),n=(s.topic,s.Groups,s.Names,t.ZSConstants.JSKeyCode),r=e.Constants.LayerCode,a=e.Constants.LayerIcon;function l(t,e,i){this.parent=t,this.properties=e,this.lisetener=i,this.eType=null,this.DOM=null,this.index=0,this.lastIndex=0,this.active=!1,this.list=[]}function h(t,e,i,s,n,r,a,l,h,o,d,c,p){var u=t.createElement("li");u.id="zSuggestion"+e,u.setAttribute("data-etype",i),u.setAttribute("data-query",s),u.setAttribute("data-maxLen",p),n&&u.setAttribute("style","border-bottom:0.5px solid #dddddd"),u.dataset.append_index=r||0,void 0!==a&&u.setAttribute("data-addedProperties",JSON.stringify(a)),u.appendChild(h(l));var E=t.createElement("span");E.innerHTML=o,u.appendChild(E),t.addEventByNode(u,t.Events.CLICK,c.lisetener.click),t.appendChild(d,u)}function o(t,e,s,n,l){var o=i.Wrapper.DOMUtils,d=!1;if(l)for(var c in l){var p=l[c],u=p.SEARCH_RESULT;u.forEach(function(e,i){var r;if("object"==typeof e)for(var a in e.column_name){var l={};l.value=e.value,l.column_name=e.column_name[a],l.search_column=e.search_column;var d=e.value+" - <span style='color : #7d7d7d'>"+e.column_name[a]+"</span>";h(o,++s,this.eType,e.value,i++==u.length-1&&a==e.column_name.length-1,p.APPEND_INDEX,l,n,E,d,t,this,p.maxLen),this.list.push(e.value)}else if(r=p.APPEND_KEYWORD_TO_VALUE?p.KEYWORD+" "+e:e,-1==this.list.indexOf(r)&&""!==r.trim()){d="";p.APPEND_KEYWORD_TO_CONTENT&&(d=p.KEYWORD),p.APPEND_COLOR?d=d+" <span style='color : #7d7d7d'>"+e+"</span>":d+=e,h(o,++s,this.eType,r,i++==u.length-1,p.APPEND_INDEX,p.ADDITIONAL_PARAMETERS,n,E,d,t,this,p.maxLen),this.list.push(r)}}.bind(this))}return e&&e.length>=1&&e.forEach(function(e){-1==this.list.indexOf(e)&&(n==r.CACHED&&!d&&(d=!0)&&function(t){var e=i.Wrapper.DOMUtils,s=e.createElement("li");s.classList.add("seprator"),e.appendChild(t,s)}(t),h(o,++s,this.eType,e,!1,void 0,void 0,n,E,e,t,this,void 0),this.list.push(e))}.bind(this)),s;function E(t){var e=i.Wrapper.DOMUtils,s="http://www.w3.org/2000/svg",n=e.createElementNS(s,"svg",{height:20,width:18,viewBox:"-1 -1 18 21"});n.classList.add("flt_left","mr10","posRel");var r=e.createElementNS(s,"use");return r.setAttributeNS("http://www.w3.org/1999/xlink","href",a[t]),e.appendChild(n,r),n}}l.prototype={init:function(t,e,i,s){t&&(this.parent=t),e&&(this.properties=e),i&&(this.lisetener=i),this.eType=s||"NONE",this.initProperty()},initProperty:function(){this.flush(),this.create(),this.refresh(),this.toogle()},create:function(){if(!this.DOM){var t=i.Wrapper.DOMUtils,e=UserAction.getTemplate(["SP_ZIA_AUTOCOMPLETE_TEMPLATE"]);this.DOM=t.createElement("div"),this.DOM.appendChild(e.SP_ZIA_AUTOCOMPLETE_TEMPLATE),t.appendChild(document.querySelector("#recommendedNLPQuery"),this.DOM),this.DOM.classList.add("arrowQry"),t.addEventByNode(this.DOM,t.Events.SCROLL,function(t){t.stopPropagation()}),t.addEventByNode(this.DOM,t.Events.MOUSEWHEEL,function(t){t.stopPropagation()}),t.addEventByNode(this.DOM,t.Events.DOMMOUSEWHEEL,function(t){t.stopPropagation()})}},refresh:function(){var t=this.DOM.querySelector("#autoCompleteList"),e=(i.Wrapper.DOMUtils,0);e=o.call(this,t,this.properties.NEW,e,r.NEW),e=o.call(this,t,this.properties.CACHED,e,r.CACHED),e=o.call(this,t,this.properties.SEARCH,e,r.SEARCH,this.properties.REQ_OBJ),this.lastIndex=e,this.properties=null},flush:function(){this.active=!1,this.index=0,this.lastIndex=0,this.list=[],this.DOM&&(this.DOM.querySelector("#autoCompleteList").innerHTML="")},destroy:function(){this.DOM.remove(),this.DOM=null},toogle:function(){var t=i.Wrapper.DOMUtils;this.DOM.style.top=this.parent.offsetHeight+this.parent.offsetTop+"px",!function(){if(!this.list)return!1;return this.list.length>=1}.call(this)?t.hide(this.DOM):t.show(this.DOM)},hide:function(){var t=i.Wrapper.DOMUtils;this.DOM&&t.hide(this.DOM),this.active=!1},select:function(t){var e;if(this.active=!0,this.list){switch(t){case n.DOWN:this.index++,this.lastIndex<this.index&&(this.index=1),e=this.index;break;case n.UP:this.index--,this.index<=0&&(this.index=this.lastIndex),e=this.index}this.selectElementOnIndex(e)}},selectAtIndex:function(t){this.list&&(this.list&&0==this.list.length||(this.active=!0,this.index=t,this.selectElementOnIndex(t)))},selectElementOnIndex:function(t){this.deselectAll();var e=document.getElementById("zSuggestion"+t);if(!e)return this.active=!1,void(this.index=0);this.active=!0,e.scrollIntoViewIfNeeded(),e.classList.add("sel")},deselectAll:function(){for(var t=1;t<=this.lastIndex;t++)document.getElementById("zSuggestion"+t).classList.remove("sel")},isSelected:function(){return this.active},onSelectionClick:function(){this.active=!1,document.getElementById("zSuggestion"+this.index).click()}},e.Layer.LYAutoComplete=l}(this);
!function(t){t.window;var e=t.ZSZIA,o=(t.ZSChart,t.sPlusPlus),s=t.ZSEvents;s.topic,s.Groups,s.Names,e.Constants.SupportedOperations;function r(){var t=o.view.getActiveGridID();o.view.getSheetID(t);this.trieForest=new e.Model.TrieForest,this.columnTypeMap={}}r.prototype.addTokens=function(t,e){this.trieForest.constructForest(t,{ACTUAL_TOKENS:e})},r.prototype.getSuggestions=function(t,e,o){return this.trieForest.suggestionForColumn(t,e,o)},r.prototype.getAllSuggestions=function(t,e){return this.trieForest.allPossibleSuggestion(t,e)},r.prototype.getAllColumns=function(){return this.trieForest.getAllColumns()},r.prototype.setTypeForTrieCol=function(t,e){this.columnTypeMap[t]=e},r.prototype.getColTypeMap=function(t,e){return this.columnTypeMap},e.Model.AutoComplete=r}(this);
!function(e){e.window;var t=e.ZSZIA,o=e.ZSChart,n=e.sPlusPlus,i=e.ZSEvents,r=i.topic,s=i.Groups,a=i.Names,l=(e.ZSConstants.I18N,t.Defaults),p={click:function(e){var t=this.dataset,o=t.query,n=t.etype,i=t.maxlen,l=t.append_index,p=t.addedproperties;r.publish(s.UI,a.SidePanel.ZIA.SEARCH_ITEM_CLICK,{VALUE:o,ETYPE:n,APPEND_INDEX:l,ADDED_PROPERTIES:p,MAXLEN:i})}};function u(){this.idx=null,this.Layer=null,this.parent=null,this.model=null,this.init()}u.prototype.init=function(){this.model=new t.Model.AutoComplete,this.Layer=new t.Layer.LYAutoComplete},u.prototype.setParentElement=function(e){this.parent=e},u.prototype.initLayer=function(e,t,o){this.Layer.init(this.parent,e,t,o)},u.prototype.create=function(){var e=(new t.Manager.ZiaViewManager).getActiveHolder(),i=new o.Utility.ChartAgent;if(e){var r=e.getRanges().trim().split(";"),s=n.view.getActiveGridID(),a=n.view.getResourceID(s),p=n.view.getVersionID(s),u=n.view.getSheetID(s),d=n.data.getWorkBook(a,p).getSheetObj(u).Prop.Name,c={parameters:{}};c.parameters.currentSheet=u,c.parameters.isCol=!0,this.model=new t.Model.AutoComplete,r.forEach(function(e){if(e.length>1){var t=JSUtil.Range.parseRange(a,p,e);if(t){var n=t.range,r=n.endCol,s=Math.round(l.TRIE_LIMIT/r),g=s>n.endRow?n.endRow:s,h=new ZSClass.Range(n.startRow,n.startCol,g,n.endCol);e=d+"."+h.getLabel();i.fetchRangeUniqueValue(h,["DisplayValue","ActualValue"],this.addTokens.bind(this),{maxLimit:2e3,filterBy:"COL"}),c.parameters.dataRange=e,o.Server.Action.fetchDecTable(a,u,p,c,this.setTypeForTrieColumn.bind(this))}}}.bind(this))}},u.prototype.getAllWordsForColumn=function(e,t,o){return this.getModel().getSuggestions(e,t,o)},u.prototype.getAllWords=function(e,t){return this.getModel().getAllSuggestions(e,t)},u.prototype.getAllColumns=function(){return this.getModel().getAllColumns()},u.prototype.getModel=function(){return this.model},u.prototype.setTypeForTrieColumn=function(e){for(var t in e[0])e[0][t].colHead&&this.getModel().setTypeForTrieCol(e[0][t].colHead,e[0][t].type)},u.prototype.getColTypeMap=function(){return this.getModel().getColTypeMap()},u.prototype.addTokens=function(e){for(var t in e)this.getModel().addTokens(e[t].DisplayValue,e[t].ActualValue)},u.prototype.buildLayer=function(e,t){this.initLayer(e,p,t)},u.prototype.selectSuggestion=function(e){this.Layer.select(e)},u.prototype.getPreviousResponse=function(){return this.previousSuggestions},u.prototype.getPreviousKeywordIdentified=function(){return this.previousKeywordIdentified},u.prototype.isPrevRequestAOperation=function(){return this.isPrevOper},u.prototype.getPrevOperation=function(){return this.prevOper},u.prototype.selectSuggestion=function(e){this.Layer.select(e)},u.prototype.selectSuggestionAtIndex=function(e){this.Layer.selectAtIndex(e)},u.prototype.hide=function(){this.Layer.hide()},u.prototype.performSelection=function(){this.Layer.onSelectionClick()},u.prototype.isSelectedSuggestion=function(){return this.Layer.isSelected()},u.prototype.flush=function(){this.model=new t.Model.AutoComplete},t.Manager.ZAutoComplete=new u}(this);
!function(t){t.window;var e=t.ZSZIA,i=t.ZSChart,n=t.ZSConstants.I18N,s=t.UIUtil.Component,a=ZSClass.Range,o={sum:n["StatusBar.Sum"],avg:n["StatusBar.Average"],min:n["StatusBar.Minimum"],max:n["StatusBar.Maximum"],count:n["StatusBar.Count"],cn:n["StatusBar.CountNumbers"]},r=["sum","avg","min","max","count","cn"];function l(t,e){this.parentNode=t,this.response=e,this.alive=!1}l.prototype.place=function(){i.Wrapper.DOMUtils;this.parentNode.innerHTML="",this.create(),this.toggle()},l.prototype.create=function(){var t=i.Wrapper.DOMUtils,n=!1,l=!1;this.response&&r.forEach(function(i){if(this.response[i]){var r=t.createElement("div",{"data-formula":this.response[i].formula||this.response[i]}),h=t.createElement("span"),p=t.createElement("span");t.appendChild(this.parentNode,r),t.appendChild(r,h),t.appendChild(r,p),h.innerText=o[i],p.innerText=this.response[i].value||this.response[i],h.classList.add("ziaBold"),h.classList.add("colorDimGray"),p.classList.add("ziaTokenRight"),r.classList.add("ziaAggElemWrp"),s.draggable(r,{helper:function(){var e=t.createElement("div");return e.innerText=r.dataset.formula,e.cloneNode(!0)}.bind(this),appendTo:".sheetPaneContainer",scroll:!0,onDrag:function(t,i){e.Client.Range.Highlight.REMOVE.fn.call(this),e.Utility.scrollOutGridIfNeeded(t);var s=e.Utility.getAbsoluteRowPosbyInMouseEvent(t),o=e.Utility.getAbsoluteColPosbyInMouseEvent(t),r=new a(s,o,s,o);e.Client.Range.Highlight.ADD.fn.call(this,1,r),n=!0},onStop:function(t,i){if(e.Client.Range.Highlight.REMOVE.fn.call(this),!l&&e.Client.isAllowToAddOnDragEnd(t)){var s=e.Utility.getAbsoluteRowPosbyInMouseEvent(t),a=e.Utility.getAbsoluteColPosbyInMouseEvent(t);e.Client.onDragEnd.FORMULA.fn.call(this,s,a,r.dataset.formula)}l=!1,n=!1}})}}.bind(this)),t.addEventByNode(document.querySelector("body"),t.Events.KEYUP,function(t){switch(t.keyCode||t.which){case 27:n&&(l=!0)}})},l.prototype.remove=function(){var t=i.Wrapper.DOMUtils;this.parentNode.innerHTML="",t.hide(this.parentNode),this.alive=!1},l.prototype.toggle=function(){var t=i.Wrapper.DOMUtils;t.show(this.parentNode),this.alive=!0,0==Object.keys(this.response).length&&(t.hide(this.parentNode),this.alive=!1)},l.prototype.hide=function(){i.Wrapper.DOMUtils.hide(this.parentNode),this.alive=!1},l.prototype.isAlive=function(){return this.alive},e.Layer.LYAggregation=l}(this);
!function(e){e.window;var t=e.ZSZIA,i=e.ZSChart,s=(e.ZSConstants.I18N,e.UIUtil.Component,e.UserAction),r=e.ZSEvents,a=r.topic,l=r.Groups,n=r.Names;function h(){this.parentNode=null,this.headers=null,this.filterHeadsers=[],this.alive=!1}function d(){for(var e=this.parentNode.querySelectorAll("input:checked"),t=e.length,i=0;i<t;i++){e[i].checked=!1}}function o(){return this.headers?this.headers.keys.length:0}function c(e){!e&&this.cancelBtn.setAttribute("disabled",!0),e&&this.cancelBtn.removeAttribute("disabled")}h.prototype.hasParent=function(){return!!this.parentNode},h.prototype.setParent=function(e){this.parentNode=e},h.prototype.init=function(e,t){this.headers=e,this.listeners=t},h.prototype.place=function(){i.Wrapper.DOMUtils;this.flush(),this.create(),function(){c.call(this,this.filterHeadsers&&this.filterHeadsers.length>=1);var e=i.Wrapper.DOMUtils,t=this.filterHeadsers?this.filterHeadsers.length:0,s=t==o.call(this),r=!s&&t>0;this.filterHeadsers&&this.filterHeadsers.forEach(function(e){var t="#"+e.assciatedFilterID,i=this.parentNode.querySelector(t);if(i){var s=i.querySelector("input");s&&(s.checked=!0)}}.bind(this));var a=e.getElementById("selectAllChkBox");e.removeClass(a.parentNode,"partialSelection"),s&&(a.checked=!0),!s&&(a.checked=!1),r&&e.addClass(a.parentNode,"partialSelection")}.call(this)},h.prototype.create=function(){var e=i.Wrapper.DOMUtils;(function(){var e=s.getTemplate(["SP_ZIA_SEARCH_TEMPLATE"]);e&&this.parentNode.appendChild(e.SP_ZIA_SEARCH_TEMPLATE);var t=i.Wrapper.DOMUtils,r=this.parentNode.querySelector("#chrtSearchField"),a=this;t.addEventByNode(r,t.Events.INPUT,function(){(function(e){var t=this.parentNode.querySelectorAll("span"),s=this.parentNode.querySelector("#selectAllChkBox").parentNode;(function(e){for(var t=this.parentNode.querySelectorAll("label"),s=t.length,r=i.Wrapper.DOMUtils,a=0;a<s;a++)r.show(t[a])}).call(this);var r=i.Wrapper.DOMUtils;if(""!=e){for(var a=t.length,l=0,n=0;n<a;n++){var h=t[n].dataset;-1==h.value.toLowerCase().indexOf(e.toLowerCase())&&s!=t[n].parentNode&&(r.hide(t[n].parentNode),l++)}l==a-1&&r.hide(s)}}).call(a,this.value)})}).call(this);var t=e.createElement("div",{id:"ziaFilterCont"});t.classList.add("sPZIAFltrCtn","pl10","pt1"),e.appendChild(this.parentNode,t);var r=1;this.headers&&this.headers.keys&&this.headers.keys.forEach(function(s){var a=e.createElement("label",{id:"zfilter"+r});a.setAttribute("fdata",s);var l=e.createElement("input",{type:"checkbox"}),n=e.createElement("span");a.classList.add("sPZIAChk"),n.innerHTML=s,n.setAttribute("data-value",s),e.appendChild(t,a),e.appendChild(a,l);var h=this;e.addEventByNode(l,e.Events.CHANGE,function(e){(function(){(function(){var e=this.parentNode.querySelectorAll("input:checked").length,t=i.Wrapper.DOMUtils,s=t.getElementById("selectAllChkBox");s.checked&&(e-=1),t.removeClass(s.parentNode,"partialSelection");var r=e==o.call(this),a=!r&&e>0;r&&(s.checked=!0),!r&&(s.checked=!1),a&&t.addClass(s.parentNode,"partialSelection")}).call(this)}).call(h)}),e.appendChild(a,n),r++}.bind(this));var h=e.createElement("button");h.classList.add("Zsbtn","flt_right"),h.innerHTML="Filter",this.cancelBtn=e.createElement("button"),this.cancelBtn.classList.add("Zsbtn","Zsbtn-grey","mb"),this.cancelBtn.innerHTML="Clear";var p=e.createElement("div");p.classList.add("wid100","wid","mt10","pt10","pr10","bdrTop"),e.appendChild(p,this.cancelBtn),e.appendChild(p,h),e.appendChild(this.parentNode,p);var u=e.getElementById("selectAllChkBox");e.addEventByNode(u,e.Events.CHANGE,function(e){var t=e.target.checked;(function(e){var t=this.parentNode.querySelectorAll("input"),s=t.length,r=i.Wrapper.DOMUtils,a=r.getElementById("selectAllChkBox");r.removeClass(a.parentNode,"partialSelection"),e=function(){for(var e=this.parentNode.querySelector("#ziaFilterCont").querySelectorAll("input"),t=!0,i=0;i<e.length;i++){var s=e[i];"none"!==s.parentNode.style.display&&(t=t&&s.checked)}return!t}.call(this);for(var l=0;l<s;l++){var n=t[l];"none"!==n.parentNode.style.display&&(n.checked=e)}var h=this.parentNode.querySelectorAll("input:checked");h.length-1!=o.call(this)&&h.length-1>0&&r.addClass(a.parentNode,"partialSelection"),c.call(this,!0)}).call(this,t)}.bind(this)),e.addEventByNode(h,e.Events.CLICK,function(){(function(){var e=this.parentNode.querySelectorAll("input:checked");this.filterHeadsers=[];for(var t=[],s=e.length,r=(i.Wrapper.DOMUtils,0);r<s;r++){var h=e[r],d="selectAllChkBox"===h.id,o=h.parentNode.id,p=h.parentNode.getAttribute("fdata");!d&&o&&this.filterHeadsers.push({assciatedFilterID:o,filtervalue:p}),p&&t.push(this.headers.values[this.headers.keys.indexOf(p)])}c.call(this,this.filterHeadsers&&this.filterHeadsers.length>=1),this.listeners.filter(t),t.length>=1&&a.publish(l.UI,n.SidePanel.ZIA.FILTER.APPLY)}).call(this)}.bind(this)),e.addEventByNode(this.cancelBtn,e.Events.CLICK,function(){(function(){this.filterHeadsers=[],d.call(this),this.listeners.clear(),c.call(this,!1),this.selectAllChecked=!1}).call(this)}.bind(this)),a.publish(l.UI,n.SidePanel.ZIA.FILTER.TOGGLE,{HAS_FILTER:this.headers&&this.headers.keys.length>=1})},h.prototype.flush=function(){this.parentNode&&(this.parentNode.innerHTML="")},h.prototype.destroy=function(){this.flush(),this.headers={},this.filterHeadsers=[],a.publish(l.UI,n.SidePanel.ZIA.FILTER.REMOVE)},h.prototype.toggle=function(){this.alive?this.hide():this.show(),this.headers&&0==this.headers.keys.length&&this.hide()},h.prototype.show=function(){i.Wrapper.DOMUtils.show(this.parentNode),this.alive=!0},h.prototype.hide=function(){i.Wrapper.DOMUtils.hide(this.parentNode),this.alive=!1},h.prototype.get=function(){return this.parentNode},h.prototype.removeSelection=function(){this.filterHeadsers=[],this.selectAllChecked=!1,d.call(this),a.publish(l.UI,n.SidePanel.ZIA.FILTER.REMOVE)},t.Layer.LYFilter=h}(this);
!function(e){e.window;var t=e.ZSZIA,r=e.ZSChart,i=(e.sPlusPlus,e.ZSEvents),n=i.topic,a=i.Groups,o=i.Names,s={filter:function(e){n.publish(a.UI,o.SidePanel.ZIA.FILTER.HIDE),(new t.Controller.ZController).doFilterAction(e)},clear:function(){n.publish(a.UI,o.SidePanel.ZIA.FILTER.HIDE),(new t.Controller.ZController).resetView({action:"ALL"}),n.publish(a.UI,o.SidePanel.ZIA.FILTER.REMOVE)}};function l(){this.Layer=null,this.init()}l.prototype.init=function(){this.Layer=new t.Layer.LYFilter,this.setParentElement()},l.prototype.setParentElement=function(){var e=r.Wrapper.DOMUtils.getElementById("zFltWrapper");this.parent=e,this.Layer.setParent(this.parent)},l.prototype.initLayer=function(e,t){!this.Layer.hasParent()&&this.setParentElement(),this.Layer.init(e||{},t||s),this.Layer.place()},l.prototype.destroy=function(){this.Layer&&this.Layer.destroy()},l.prototype.removeSelection=function(){this.Layer&&this.Layer.removeSelection()},t.Manager.ZiaFilterManager=new l,n.register(a.UI,o.SidePanel.ZIA.FILTER.REMOVE_SELECTION,function(){t.Manager.ZiaFilterManager.removeSelection()}),n.register(a.UI,o.SidePanel.ZIA.FILTER.RESET,function(){t.Manager.ZiaFilterManager.destroy()})}(this);
!function(e){e.window;var t=e.ZSZIA,a=e.ZSChart,r=e.ZSEvents,s=(r.topic,r.Groups,r.Names,t.Constants.FRType),i=(e.ZSConstants.I18N,t.Constants.META.Type),n=t.Manager,o=t.Defaults,l=null;function d(e,t){this.parentNode=e,this.headNode=this.parentNode.parentElement,this.META=t,l=this.META}function p(e,t){var r=a.Wrapper.DOMUtils,s=r.createElement("div");s.classList.add("dspTbl");var i=l.result,n=l.blockSize,d=[],p=i.length;r.hide(this.headNode.querySelector("#zTableFade"));for(var h=0,c=1,u=0;h<p&&(u<=e||-1==e);h++,c++)d[c-1]=i[h],c==n?(d.length>=1&&M(s,d,t?Math.min(t,n):n),u++,d=[],c=0):h!=p-1&&u!=e||(d.length>=1&&M(s,d,t?Math.min(t,n):n),d=[],u++,c=0),u>=e&&r.show(this.headNode.querySelector("#zTableFade"));function M(e,t,r){var s=a.Wrapper.DOMUtils,i=s.createElement("div");i.classList.add("dspTblRow","flt_left","wid100");for(var n=0;n<r;n++){var l=s.createElement("div");l.classList.add("dspTblCell"),l.style.width=o.FORMULA.TABLE.WIDTH/r+"px",l.innerHTML=t[n]||"",s.appendChild(i,l)}s.appendChild(e,i)}-1==e?this.HandsontableDOM=s:this.DOM=s}d.prototype.build=function(){this.preNodeSelection(),this.preprocess(),this.clear(),this.place(),this.bindZoomLayer()},d.prototype.preNodeSelection=function(){var e=a.Wrapper.DOMUtils;e.hide(this.parentNode);var t=this.headNode.querySelector("#zTablularResult");switch(t.classList.remove("singCol"),this.META.type){case s.LIST:t.classList.add("singCol");case s.TABLE:this.parentNode=t,e.show(t.parentElement);break;default:e.hide(t.parentElement),e.show(this.parentNode)}},d.prototype.place=function(){a.Wrapper.DOMUtils.appendChild(this.parentNode,this.DOM)},d.prototype.preprocess=function(){switch(this.META.type){case s.TABLE:p.call(this,5,4);break;case s.STRING:(function(e){var t=a.Wrapper.DOMUtils,r=t.createElement("table");r.classList.add("wid100"),e.forEach(function(e){var a=t.createElement("tr"),s=t.createElement("td");s.innerHTML=e,t.appendChild(a,s),t.appendChild(r,a)}),this.DOM=r}).call(this,[this.META.result]);break;case s.LIST:p.call(this,5)}},d.prototype.clear=function(){a.Wrapper.DOMUtils;this.parentNode.innerHTML=""},d.prototype.bindZoomLayer=function(){var e=a.Wrapper.DOMUtils;switch(this.META.type){case s.LIST:case s.TABLE:break;default:return}var t=this.headNode.querySelector("#formlaZoom"),r=this;e.addEventByNode(t,e.Events.CLICK,function(){r.zoomIn()},!0)},d.prototype.zoomIn=function(){var e=a.Wrapper.DOMUtils.createElement("div"),t=(new n.ZiaViewManager).getZoomLayer(),r=t.getViewSpace();r.innerHTML="";var s=l.naturalString;t.getHeaderSpace().innerHTML=s,t.setIndex(0,1),t.setActiveElement({id:i.FORMULA,type:i.FORMULA});var o=function(){var e=l.result,t=l.blockSize,a=l.columnsHeader||[],r=e.length>0?Math.ceil(e.length/t):0;if(0==a.length)for(var s=0;s<t;s++)a[s]="column "+s;var i=[];return function(e,t,a,r){for(var s=r.length,i=[],n=0,o=1;n<s;n++,o++)i[o-1]=r[n],o==t?(a.push(i),i=[],o=0):n==s-1&&(a.push(i),i=[],o=0)}(0,t,i,e),{to:r>100?100:r,upto:r,data:i}}.call(this);r.classList.add("sPDCLayer"),r.appendChild(e),t.createGrid(e,{stretchH:"all",maxRows:100,height:400,width:800,colHeaders:!0,renderAllRows:!0,readOnly:!0}),o.to!=o.upto&&t.setRecordSummary(o),setTimeout(function(){t.setData(o.data)},100)},d.prototype.toggle=function(){var e=a.Wrapper.DOMUtils;switch(this.META.type){case s.TABLE:case s.STRING:case s.LIST:e.show(this.headNode);break;default:e.hide(this.headNode)}},t.Layer.LYFormula=d}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSEvents,s=(e.ZSClass,n.topic),o=n.Groups,i=n.Names,r=(e.ZSDevTools.Logger,e.ZSClass.ActionObject),a=e.ZSConstants.ActionConstants,I=e.ZSConstants.URI,S=t.SML.Client.Utility.WorkerRequest;e.UserAction;e.UserAction.GRID_VIEW=function(n,c,E,d,l){var u=a.SHEET_VIEW,A=new e.ZSClass.ParamGenerator(c,n,E).getSheets(),C={RID:n,sheetList:A,action:u,VERSION:E,VALUE:d,prevValue:l},R=new r(u,C,d),D=new S;D.addEventListeners("onAcknowledge",function(e){s.publish(o.Listener,i.SheetAction.GRID_SPACING.MODIFY,{RID:n,SHEETID:c[0],VERSION:E,GRID_SPACING:t.data.View[d],ISSHEETSWITCH:!1,ISACTIONOWNER:!0,XAID:!0})}),D.addEventListeners("onComplete",function(e){e.qaid,R.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(R)}),D.addEventListeners("onError",function(e){}),D.open(I.GRID_VIEW),D.send(C)}}(this);
!function(t){var e=t.sPlusPlus,n=t.UserAction,s=t.ZSEvents,o=(s.topic,s.Groups,s.Names,t.ZSConstants),i=o.ActionConstants,r=t.ZSClass,a=(r.ActionObject,o.URI),c=e.SML.Client.Utility.WorkerRequest;t.ZSDevTools.Logger;n.SwitchRTL=function(t,e,n,s){var o=i.SAVE_RTL_SHEET,S={RID:t,sheetList:new r.ParamGenerator(e,t,n).getSheets(),action:o,VERSION:n,isRTL:s},u=new c;u.addEventListeners("onComplete",function(t){}),u.addEventListeners("onError",function(t){}),u.open(a.SWITCH_RTL),u.send(S)}}(this);
!function(e){var t=e.sPlusPlus,n=t.SML.Client,s=e.ZSConstants.URI,o=e.ZSConstants.I18N,a=(e.ZSDevTools.Logger,n.Utility.WorkerRequest),r=e.ZSEvents,i=r.topic,R=r.Groups,l=r.Names,C=e.ZSConstants.ActionConstants,S=e.ZSClass.ActionObject;e.UserAction.dragAndDropRange=function(e,n,r,c,d,D,E,u){var O=new ZSClass.ParamGenerator([n],e,r,!1,!1),g=O.getSheets(),A=O.getActiveCell(),v=O.getCustomRanges(d),p=O.getCustomRanges(c),w={RID:e,SHEETID:n,sheetList:g,rangeList:v,action:C.DRAG_DROP,activeCell:A,srcRangeList:p,srcSheetList:g,VERSION:r,undoRedoOptions:{FOCUS_SOURCE:!0}},I=new S(C.DRAG_DROP,w),L=new a;L.addEventListeners("onError",function(e){i.publish(R.Listener,l.ERROR.SHOW,{ERRORMSG:e.mk})}),L.addEventListeners("askConfirm",function(e){var t=new ZSClass.ZSConfirm(o[e.mk]);t.onYES(function(){L.param.showAlert=!1,L.resend()});var n=t.execute();i.publish(R.Listener,l.DocAction.ConfirmMsg.SHOW,{MSG:t.getMsg(),KEY:n,CONFIRMOBJ:t})}),L.addEventListeners("onComplete",function(s){i.publish(R.Selector.BoundUpdate.Range,l.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:n,VERSION:r,RANGE:d});var o=D.startRow-c.startRow,a=D.startCol-c.startCol,C=c.endRow-D.endRow,S=c.endCol-D.endCol,E=new ZSClass.Range(d.startRow+o,d.startCol+a,d.endRow-C,d.endCol-S);i.publish(R.Selector.BoundUpdate.Cell,l.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:n,VERSION:r,ActiveCellRange:E,ROW:E.startRow,COL:E.startCol});var u=s.qaid;I.qaid=u,t.data.UserInfo.ActionRecorder.record(I)}),L.open(s.DRAG_DROP),L.send(w)}}(this);
!function(e){var t=e.sPlusPlus,a=e.ZSEvents,n=e.ZSClass,s=a.topic,o=a.Groups,i=a.Names,r=(n=e.ZSClass,e.ZSConstants.ActionConstants),R=n.ActionObject,l=e.ZSConstants.URI,c=t.SML.Client.Utility.WorkerRequest,d=n.SelectorHelper.Constants,S=t.data.UserInfo;function E(e,a,E,u,C,I,g,O,v){void 0!==t.data.isRecastAction&&t.data.isRecastAction&&(t.data.isRecastAction=!1);t.data.getWorkBook(e,E);var A=t.view.getActiveGridID(),T=t.view.getSheetState(A,a[0]),L=new n.ParamGenerator(a,e,E,!0,!0),w=L.getSheets(),f=L.getCustomRanges(u),U=L.getActiveCell();if(function(e,t,a,n){s.publish(o.Selector.BoundUpdate.Range,i.Selection.BOUND_UPDATE.ADD,{RID:e,SHEETID:t,VERSION:a,RANGE:n}),status&&s.publish(o.Selector.BoundUpdate.Copy,i.Selection.BOUND_UPDATE.HIDE,{RID:e,SHEETID:t,VERSION:a,VisualCueStatus:d.CUESTATUS.HIDDEN})}(e,L.getActiveSheet(),E,u),C&&I){var p=u.startRow,D=u.startCol,_=u.endRow,m=u.endCol;"TO_BOTTOM"===I&&(p+=C),"TO_TOP"===I&&(_-=C),"TO_RIGHT"===I&&(D+=C),"TO_LEFT"===I&&(m-=C);var F=new n.Range(p,D,_,m),h=L.getCustomRanges(F);g=T.getFillRange()?T.getFillRange():g;var G=new n.Range(g.startRow,g.startCol,g.endRow,g.endCol);g=L.getCustomRanges(G);var N={RID:e,sheetList:w,VERSION:E,isCtrlPressed:!!O,action:r.FILLSERIES,srcCount:C,rangeList:f,activeCell:U,fixedRange:g,wholeRange:h,fillDirection:I,type:v||"default"},H=new R(r.FILLSERIES,N);status=S.activeInfo.getVisualCueStatus();var P=new c;P.addEventListeners("onComplete",function(e){H.params.RANGES=[T.getActiveRange()],H.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(H)}),P.addEventListeners("onError",function(e){s.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),P.open(l.FILL_SERIES),t.data.UserInfo.registerForRepeat(P,H),P.send(N)}}e.UserAction.CalcFillDetails=function(e,t,a,n,s,o,i){if(n.endRow>s.endRow)var r="TO_BOTTOM",R=s.endRow-s.startRow+1;else n.startRow<s.startRow?(r="TO_TOP",R=s.endRow-s.startRow+1):n.endCol>s.endCol?(r="TO_RIGHT",R=s.endCol-s.startCol+1):n.startCol<s.startCol&&(r="TO_LEFT",R=s.endCol-s.startCol+1);E(e,t,a,n,R,r,s,o,i)},e.UserAction.FillSeriesAuto=function(e,a,d,E){void 0!==t.data.isRecastAction&&(t.data.isRecastAction=!1);var u=new n.ParamGenerator(a,e,d,!0,!0),C={RID:e,sheetList:u.getSheets(),rangeList:u.getCustomRanges(E),VERSION:d,activeCell:u.getActiveCell(),action:r.FILLSERIES_AUTO},I=new R(r.FILLSERIES_AUTO,C);status=S.activeInfo.getVisualCueStatus();var g=new c;g.addEventListeners("onComplete",function(e){I.params.RANGES=[E],I.qaid=e.qaid,t.data.UserInfo.ActionRecorder.record(I)}),g.addEventListeners("onError",function(e){s.publish(o.Listener,i.ERROR.SHOW,{ERRORMSG:e.mk})}),g.open(l.FILL_SERIES_AUTO),g.send(C)}}(this);
!function(e){var t=e.sPlusPlus,n=(e.ZSEvents.Groups,e.ZSDevTools.Logger),s=e.ZSConstants.URI,r=t.SML.Client,o=t.data.Defaults,a=r.Utility.WorkerRequest,i=e.ZSConstants.ActionConstants;UserAction.CtrlNavigate=function(t,r,C,c,l,u,A){if(function(e,t,n){switch(n){case 1:return e<o.MAX_ROW-1;case 2:return e>0;case 3:return t<o.MAX_COL-1;case 4:return t>0}}(c,l,u)){var L=new e.ZSClass.ParamGenerator(r,t,C),M=L.getSheets(),O=new ZSClass.Range(c,l,o.MAX_ROW,o.MAX_COL),_=L.getCustomRanges(O),v=L.getActiveCell(),R={rid:t,sheetList:M,version:C,activeCell:v,row:c,col:l,rangeList:_,action:i.CTRL_NAVIGATION,traverseMode:u||3},g=new a;g.addEventListeners("onError",function(e){n.log("Ctrl Navigation error :",e)}),g.addEventListeners("onComplete",function(e){var n=e.row,s=e.col;n>o.MAX_ROW-1?n=o.MAX_ROW-1:n<o.MIN_ROW&&(n=o.MIN_ROW),s>o.MAX_COL-1?s=o.MAX_COL-1:s<o.MIN_COL&&(s=o.MIN_COL),A&&A(t,r[0],C,n,s)}),g.open(s.CTRL_NAVIGATION),g.send(R)}}}(this);
!function(t){var e=t.sPlusPlus,n=e.SML.Client.Utility.WorkerRequest,s=t.ZSConstants.URI;t.UserAction.expireClip=function(t,i,o){e.data.getWorkBook(t,i);var r={RID:t,VERSION:i,ExpValue:o},u=new n;u.open(s.EXPIRECLIP),u.send(r)}}(this);
!function(e){var t=e.sPlusPlus,o=e.ZSEvents,a=e.ZSClass,r=o.topic,i=o.Groups,n=o.Names,s=(t.SML.Client.Utility.WorkerRequest,e.ZSConstants.URI,t.data.UserInfo),c=ZSConstants.ActionConstants,d=e.ZSConstants.I18N,l=(a.AjaxRequest,a.RequestParameters);var p=!1;r.register(i.Listener,n.UserAction.REVERT_VERSION,function(){p=!0}),r.register(i.Listener,n.DocMeta.TRIGGER_DOCUMENT_EXIT,function(e,t){if(p)document.location.reload(!0);else{var o={countDown:15,buttons:[{text:d.OK,primary:!0,click:function(){document.location.reload(!0)}}],title:d[t]};a.ZSAlert(d[e],o)}},"EXCEPTIONKEY","TITLE"),e.UserAction.CloseDocument=function(o,d){var p=t.data.getWorkBook(o,d);if(p){var R,g,u=t.view.getActiveGridID(),v=t.view.getSheetID(u),C=p.getSheetObj(v),E=t.view.getSheetState(u,v),D=E.getActiveRow(),S=E.getActiveCol(),f=E.getRanges(),O=E.getScrollTops(),I=E.getScrollLefts(),N=Math.round(O[0]),m=Math.round(I[0]),U=C.Row.FreezedCount,y=C.Column.FreezedCount;(U>0||y>0)&&(R=Math.round(O[1]),g=Math.round(O[1])),s.activeInfo.setCopyState(1);var T={},P={activeRowIndex:D,activeColIndex:S,currRanges:f,positionTop:N,positionLeft:m,FreezedRow:U,FreezedCol:y};(U>0||y>0)&&(P.FreezedPositionTop=R,P.FreezedPositionLeft=g),T[v]=P;var h,L={URL:"hclosedoc",params:["activeSheetId","workBookDetails","copyDoc","versionNo","rid"],paramVal:[v,JSON.stringify(T),!1,null,o],action:c.HCLOSE_DOCUMENT},_=new l(L);h=!!UserAction.CollaborationNotifier&&UserAction.CollaborationNotifier.getRemoveUserProfile();var w=t.data.DocRegistry[o].RemoteViewInfo;if(navigator.sendBeacon){var k=t.data.PageRegistry.csrfCookieName,M=e.UIUtil.document.getCookie(k),A=new FormData;A.append("action",c.HCLOSE_DOCUMENT),A.append("activeSheetId",v),A.append("workBookDetails",JSON.stringify(T)),A.append("copyDoc",!1),A.append("versionNo",null),A.append("rid",o),A.append("removeUserProfile",h),A.append(t.data.PageRegistry.csrfParamName,M),t.data.PageRegistry.RS_ID&&A.append("rsid",t.data.PageRegistry.RS_ID),A.append("utid",t.data.PageRegistry.UT_ID),A.append("tabType","cached"),w&&w.REMOTE_ENC_DOC_ID&&A.append("doc",t.data.DocRegistry[o].DOCUMENT_POINTER),navigator.sendBeacon(_.getURL(o,d)+"?proxyURL=hclosedoc",A)}else{L={URL:"hclosedoc",action:c.HCLOSE_DOCUMENT},w&&w.REMOTE_ENC_DOC_ID?(L.params=["activeSheetId","workBookDetails","copyDoc","versionNo","rid","removeUserProfile","doc"],L.paramVal=[v,JSON.stringify(T),!1,null,o,h,t.data.DocRegistry[o].DOCUMENT_POINTER]):(L.params=["activeSheetId","workBookDetails","copyDoc","versionNo","rid","removeUserProfile"],L.paramVal=[v,JSON.stringify(T),!1,null,o,h]);var b=new a.AjaxRequest(o,d);b.init(L,{async:!1}),b.addEventListener("onComplete",function(e){}),b.addEventListener("onError",function(e){r.publish(i.Listener,n.ERROR.SHOW,{ERRORMSG:responseObj.mk})}),b.sendRequest()}}}}(this);
!function(e){var t=e.sPlusPlus,n=e.ZSConstants,i=e.ZSEvents,s=i.topic,r=i.Groups,a=i.Names,o=(e.JSUtil,n.I18N),S=t.SML.Client.Utility.WorkerRequest,l=n.ActionConstants,R=e.ZSClass,d=R.ActionObject,I=n.URI,E=R.SelectorHelper.Constants;e.UserAction.SubmitCell=function(n,i,c,A,g,u,v,C){var L=t.view.getActiveGridID(),T=t.view.getSheetID(L),O=new e.ZSClass.ParamGenerator(i,n,c),D=O.getSheets(),U=new R.Range(g,u,g,u),h=O.getCustomRanges(U),m=O.getActiveSheet(),w=(U=O.getActiveCell(),t.data.getWorkBook(n,c).getSheetObj(m)),p=w.Column.hidden.isHidden(u),N=w.Row.Visibility.isHidden(g);if(p||N)R.ZSAlert(o["HiddenRange.CellEdit.AlertMessage"],{title:o["HiddenRange.CellEdit.AlertMessage.Title"]});else{var f={RID:n,VERSION:c,sheetList:D,rangeList:h,activeCell:U,value:A,ISARRAYFORMULA:!1,validateDV:v,picklistItemID:C},M=new d(l.SUBMIT,f),G=h[0],b=new S(!0);m===T&&b.addEventListeners("onAcknowledge",function(){s.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:n,SHEETID:m,RANGELIST:G,ACTION:"SUBMIT",VERSION:c,VALUE:A})}),b.addEventListeners("onComplete",function(e){var n=e.qaid;M.qaid=n,t.data.UserInfo.ActionRecorder.record(M)}),b.addEventListeners("onError",function(e){s.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),b.open(I.SUBMIT),b.send(f),m===T&&s.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:m,VERSION:c}),s.publish(r.Selector.BoundUpdate.Copy,a.Selection.BOUND_UPDATE.HIDE,{RID:n,SHEETID:m,VERSION:c,VisualCueStatus:E.CUESTATUS.HIDDEN})}},e.UserAction.SubmitArrayFormula=function(n,i,o,E,c,A,g,u){var v=t.view.getActiveGridID(),C=t.view.getSheetID(v),L=t.view.getSheetState(v,C),T=new e.ZSClass.ParamGenerator(i,n,o),O=T.getSheets(),D=t.data.getWorkBook(n,o).getSheetObj(C),U=new R.Range(c,A,c,A);D.Merge.extendRange(U);var h=L.getActiveRange().equals(U),m=D.ArrayFormula.isXists(c,A),w={RID:n,VERSION:o,sheetList:O,rangeList:g=h&&m?T.getCustomRanges(m.root.clone()):g?T.getCustomRanges(g):T.getRanges(),activeCell:U=T.getActiveCell(),value:E,ISARRAYFORMULA:!0,isFromZia:u},p=new d(l.SUBMIT,w),N=new S(!0);N.addEventListeners("onComplete",function(e){var n=e.qaid;p.qaid=n,t.data.UserInfo.ActionRecorder.record(p)}),N.addEventListeners("onError",function(e){s.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),N.open(I.SUBMIT),N.send(w)},e.UserAction.SubmitCellAlongWithPattern=function(n,i,o,E,c,A,g,u){var v=t.view.getActiveGridID(),C=t.view.getSheetID(v),L=(t.view.getSheetState(v,m),new e.ZSClass.ParamGenerator(i,n,o)),T=L.getSheets(),O=new R.Range(A,g,A,g),D=L.getCustomRanges(O),U=(O=L.getActiveCell(),{RID:n,VERSION:o,sheetList:T,rangeList:D,activeCell:O,value:E,ISARRAYFORMULA:!1,isFromZia:u});c&&"undefined"!==c&&(U.formatType=c);var h=new d(l.SUBMIT,U),m=i[0],w=D[0],p=new S(!0);m===C&&p.addEventListeners("onAcknowledge",function(){s.publish(r.Listener,a.GridAction.CLIENTFIRSTACTIONS,{RID:n,SHEETID:m,RANGELIST:w,ACTION:"SUBMIT",VERSION:o,VALUE:E})}),p.addEventListeners("onComplete",function(e){var n=e.qaid;h.qaid=n,t.data.UserInfo.ActionRecorder.record(h)}),p.addEventListeners("onError",function(e){s.publish(r.Listener,a.ERROR.SHOW,{ERRORMSG:e.mk})}),p.open(I.SUBMIT),p.send(U),m===C&&s.publish(r.Listener,a.CellAction.WidgetAction.RECAST_WIDEGT_CLOSE,{RID:n,SHEETID:m,VERSION:o})}}(this);
!function(e){var n=e.sPlusPlus.SML.Client,t=e.ZSConstants.URI,s=(e.ZSEvents,n.Utility.WorkerRequest);UserAction.SendFeedback=function(e,n,i,o,E,F,S,r,u){var B={RID:e,VERSION:n,FB_MSG:i,FB_TYPE:o,FB_CATEGORY:E,FB_STARCOUNT:F,FB_MODE:S,FB_FILES:r},c=new s;c.addEventListeners("onComplete",function(){u&&u()}),c.open(t.FEEDBACK),c.send(B)}}(this);
!function(t){var n=t.sPlusPlus,e=t.ZSConstants,s=n.SML.Client.Utility.WorkerRequest,i=e.URI;t.UserAction.doGetStatus=function(t,n,e,o){var u={RID:t,SHEETID:n,VERSION:e,IS_HIDDEN:o},S=new s;S.addEventListeners("onComplete",function(t){}),S.open(i.GETSTATUS),S.send(u)}}(this);
!function(e){var t=e.sPlusPlus.SML.Client.Utility.WorkerRequest,s=e.ZSConstants.URI;e.UserAction.getDataTable=function(e,n,r,a,i){var o=new ZSClass.ParamGenerator([n],e,r,!0),l=o.getSheets(),u=a?o.getCustomRanges(a):o.getRanges(),c={rID:e,sheetList:l,sheetID:n,version:r,range:a,activeCell:o.getActiveCell(),rangeList:u},g=new t;g.addEventListeners("onError",function(e){var t={successful:!1};i&&i(t)}),g.addEventListeners("onComplete",function(e){var t=JSON.parse(e);t.successful=!0,i&&i(t)}),g.open(s.FIND_TABLE_RANGE),g.send(c)}}(this);
