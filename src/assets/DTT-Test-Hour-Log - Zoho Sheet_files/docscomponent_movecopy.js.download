function ZDDialog(){}function ZDConstants(){this.openTarget="_blank",this.callback=!1,this.folderArray=[],this.urlInvoker,this.moveUpFolder=!1,this.nextPage=!1,this.totalFiles="",this.templates="false",this.nameSortArrow="",this.nameSortOrder="",this.timeSortArrow="",this.timeSortOrder="desc",this.folderId="folder",this.parentFolderId="1",this.fromIndex="0",this.endIndex="10",this.prevIndex="1",this.nextIndex="10",this.docsPerPage="10",this.topLevelFetch="0",this.bottomLevelFetch="50",this.startFrom="0",this.fetchLimit="50",this.isShareEnabled=!1,this.advSearchFile=!1,this.trashsort=!1,this.searchQuery="",this.jsonData="",this.includeJSandCSSFiles=!1,this.selectedLeftPanel="recentservicedocs",this.templateObj={},this.rename_openfile={id:"rename_openfile",label:zd_js_obj.rename,icon:"zdc-rename_css",attr:{title:zd_js_obj.rename}},this.trash_openfile={id:"trash_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.delete_openfile={id:"delete_openfile",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive",attr:{title:zd_js_obj.deletedoc}},this.restore_openfile={id:"restore_openfile",label:zd_js_obj.restore,icon:"zdc-restoreicon_css",attr:{title:zd_js_obj.restore}},this.viewer={id:"zd_viewer_perm",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator={id:"zd_collaborator_perm",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner={id:"zd_coowner_perm",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_only={id:"zd_comment_perm",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.readfill={id:"zd_readfill_perm",label:zd_js_obj.label_read_fill,icon:"viewer",attr:{title:zd_js_obj.label_read_fill}},this.SCR_WTH="",this.SCR_HT="",this.searchType="relevance",this.createFolder={id:"createfolder",label:zd_js_obj.create,icon:"zdc-foldericon_css"},this.renameFolder={id:"renamefolder",label:zd_js_obj.rename,icon:"zdc-rename_css"},this.deleteFolder={id:"deletefolder",label:zd_js_obj.deletedoc,icon:"zdc-toolbardeleteactive"},this.viewer_details={id:"viewer_details",label:zd_js_obj.read_only,icon:"viewer",attr:{title:zd_js_obj.read_only}},this.collaborator_details={id:"collaborator_details",label:zd_js_obj.read_write,icon:"collaborator",attr:{title:zd_js_obj.read_write}},this.coowner_details={id:"coowner_details",label:zd_js_obj.coowner,icon:"co-owner",attr:{title:zd_js_obj.coowner}},this.comment_details={id:"comment_details",label:zd_js_obj.label_read_comment,icon:"viewer",attr:{title:zd_js_obj.label_read_comment}},this.readfill_details={id:"readfill_details",label:zd_js_obj.label_read_fill,icon:"viewer",attr:{title:zd_js_obj.label_read_fill}},this.trimmedEmails="",this.trimmedPerGroupIds="",this.trimmedOrgGroupIds="",this.groupNameList=[],this.groupNameAndIdList=[],this.docId,this.allShareJson={},this.isInternalMailId=!0,this.isCo_owner=!1,this.isFolderShare=!1,this.isVisibility=!1,this.updateShareStatus=!1,this.folderIds,this.resIds,this.autocomplete_selectValue="",this.G_fromAutoComplete=[],this.G_zdc_permissionType="2",this.defaultText="",this.templateCount=0}function SAVEASINIT(){}ZDDialog.showCommonDialog=function(e,t,i,s,o,n,a,r,l,d,c,p){p=p?p:1e4;ZD("#"+i).dialog({autoOpen:!0,zIndex:p,title:e,modal:t,resizable:l,closeText:"closeIcon",buttons:s,position:o,width:n,minWidth:d,minHeight:c,draggable:a,height:r,drag:function(){if("sharedialogdiv"==i){if(ZD("#zd_sharetextarea").is(":visible")){var e=ZD("#zd_sharetextarea").offset().top,t=ZD("#zd_sharetextarea").offset().left;ZD(".zdc_shareautocompletedialog.ui-autocomplete").css({top:e+45,left:t})}if(ZD("#zdc_visible_default_hidediv").is(":visible")){var s=ZD("#zdc_visible_changelink"),o=ZD(s).offset(),n=o.left-100,a=o.top+30;ZD("#zdc_visible_default_hidediv").css({top:a,left:n})}}},open:function(){ZD("#"+i).parent().addClass("docsdialog").prev();if("undefined"!=typeof G_OF_OBJ&&!ZD("#docsdialoguidialogzindex").length&&"zohosheet"===G_OF_OBJ.urlInvoker){var e=ZD(this).closest(".ui-dialog"),t=parseInt(e.css("z-index"))+5,s=document.createElement("style");s.type="text/css",s.id="docsdialoguidialogzindex";var o=".docsdialog.ui-dialog{z-index:";o+=t+" !important;}",s.innerHTML=o,document.getElementsByTagName("head")[0].appendChild(s)}},resize:function(e,t){ZDDialog.resizeDialog(e,t,i)}});return ZD("#"+i).bind("dialogclose",function(){return ZDDialog.closePopUp(i),ZD(document).trigger("dialogbeforeclose"),!1}),!1},ZDDialog.resizeDialog=function(e,t,i){if("attachopenfiledialogdiv"==i){var s=t.size.height-92;ZD("#showopenservicefilespace").css("height",s),ZD("#showopenservicefilespace").openfiledatagrid("resize")}else if("sharedialogdiv"==i){ZD("#zd_initial_sharetextarea").is(":visible")&&ZD("#zd_initial_sharetextarea").trigger("focus");var s=t.size.height-279;ZD("#sharedialogdiv").css("overflow","hidden"),ZD(".privateshare-list").css("height",s),ZD("#zd_top_menu").is(":visible")&&ZD(".privateshare-list").css("height",s-93)}else if("attachfiledialogdiv"==i){var s=t.size.height-225;ZD("div#showattachfilespace").css("height",s),ZD("div#showattachfilespace").attachfiledatagrid("resize")}else if("adddocdialogdiv"==i){var s=t.size.height-255;ZD("div#tree_container").css("height",s).parent().css("height",s+40)}},ZDDialog.openAlert=function(e,t,i,s,o,n,a){ZD("#frameDiv").remove(),(void 0==o||""==o)&&(o=[200,350]),n=350;var r=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(r).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:s,position:o,width:n,draggable:a,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<span class="flleft icon_divider"></span><p>'+t+"</p>").removeAttr("style"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),!1}),ZD("#frameDiv").addClass("custommargin_lightgrey"),!1},ZDDialog.componentAlert=function(e,t,i,s,o,n,a){ZD("#frameDiv").remove(),(void 0==o||""==o)&&(o=[]),n=520;var r=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(r).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,dialogClass:"zdocsalert",buttons:s,position:o,width:n,draggable:a,height:"auto",open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<span class="flleft icon_divider"></span><p>'+t+"</p>").removeAttr("style"),ZD(".zdocsalert").find(".ui-icon-closethick").hide(),ZD("#frameDiv").addClass("custommargin_lightgrey"),!1},ZDDialog.createNewFolderDialog=function(e,t,i,s,o,n){ZD("#createnewfolderdiv").remove();var a=ZD('<div id="createnewfolderdiv" style="display:none;"></div>');ZD(a).appendTo("body");ZD("#createnewfolderdiv").dialog({autoOpen:!0,zIndex:10008,title:e,modal:t,resizable:!1,closeText:"closeIcon",buttons:i,position:s,width:o,draggable:!0,height:n,open:function(){ZD("#createnewfolderdiv").parent().addClass("docsdialog")}});ZD("#createnewfolderdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("createnewfolderdiv"),!1})},ZDDialog.showValidatePasswordDialog=function(e,t,i,s,o,n){ZD("#passworddialogdiv").remove();var a=ZD('<div id="passworddialogdiv" style="display:none;"></div>');ZD(a).appendTo("body");ZD("#passworddialogdiv").dialog({autoOpen:!0,zIndex:10008,title:e,modal:t,resizable:!1,closeText:"closeIcon",buttons:i,position:s,width:o,draggable:!0,height:n,open:function(){ZD(".ui-dialog-titlebar-close").hide()},closeOnEscape:!1,open:function(){ZD("#passworddialogdiv").parent().addClass("docsdialog")}});ZD("#passworddialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("passworddialogdiv"),!1})},ZDDialog.showDialogForSendingMail=function(e,t,i,s,o,n){ZD("#securesharedialogdiv").remove();var a=ZD('<div id="securesharedialogdiv" style="display:none;"></div>');ZD(a).appendTo("body");ZD("#securesharedialogdiv").dialog({autoOpen:!0,zIndex:100008,title:e,modal:!1,resizable:!1,closeText:"closeIcon",buttons:i,position:s,width:o,draggable:!0,height:n,open:function(){ZD("#securesharedialogdiv").parent().addClass("docsdialog")}});ZD("#securesharedialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("securesharedialogdiv"),!1})},ZDDialog.closePopUp=function(e,t){ZD("#"+e).unbind("dialogclose"),"attachopenfiledialogdiv"==e?(ZD("#zd_leftmenu,#zd_rightmenu").unbind().remove(),ZD("#recentservicedocs").addClass("selectedView"),ZD("#serviceDialogLeftPanel,#showopenservicefilespace,div#selectboxdiv,div#searchdivforservicefiles,#servicefilepagination,table.toolbar").undelegate(),ZD("#attachopenfiledialogdiv").unbind("dialogclose"),ZD("div#showopenservicefilespace").openfiledatagrid("destroy"),ZD("#attachopenfiledialogdiv").dialog("destroy"),ZD("#attachopenfiledialogdiv").filedialog("destroy").remove(),ZD("#createnewfolderdiv,#frameDiv").dialog("destroy").remove()):"passworddialogdiv"==e?ZD("#passworddialogdiv").dialog("destroy").remove():"securesharedialogdiv"==e?(ZD("#securesharedialogdiv").dialog("destroy").remove(),public_PwdExpiryDate="",ZD_G_CurrentVisibility=""):"linkdocsdialogdiv"==e?(ZD("#recentservicedocs").addClass("selectedView"),ZD("div#showopenservicefilespace").linkdocsdatagrid("destroy"),ZD("#linkdocsdialogdiv").dialog("destroy"),ZD("#linkdocsdialogdiv").linkdocsdialog("destroy").remove()):"attachfiledialogdiv"==e?(ZD("#attachfiledialogdiv").unbind("dialogclose"),ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("div#attachfiledialogdiv").attachfiledialog("destroy").remove(),ZD("#attachfiledialogdiv").dialog("destroy").remove()):"zdattachcontainer"==e?(ZD("#zd_leftmenu,#zd_rightmenu,#homeButton").unbind().remove(),ZD("#serviceDialogLeftPanel,#showattachfilespace,div#selectboxdiv,div#servicefilepagination").undelegate(),ZD("div#showattachfilespace").attachfiledatagrid("destroy").remove(),ZD("#zdattachcontainer").attachfiledialog("destroy").remove()):"adddocdialogdiv"==e?(ZD("#adddocdialogdiv").unbind("dialogclose"),ZD("#expand_view,#folder_container").undelegate(),ZD("#"+e).dialog("destroy").remove()):"frameDiv"==e||"createnewfolderdiv"==e||"sharedialogdiv"==e||"uploadConfirmDiv"==e?("sharedialogdiv"==e&&(ZD(".zdc_shareautocompletedialog.ui-autocomplete").remove(),ZD("#zd_leftmenu,#visibilityoptions_top").unbind(),ZD("#zd_leftmenu,#visibilityoptions_top").remove(),ZD("#sharedialogdiv").undelegate(),ZD("#zdc_visible_default_hidediv").undelegate(),ZD("body").undelegate("#sharedialogdiv, #zdc_visible_default_hidediv, .ui-widget-overlay","click"),ZD("#zd_sharetextarea").autocomplete("destroy"),ZD("#zd_sharetextarea,#share_via_link_edit").unbind(),ZD("#frameDiv").dialog("destroy").remove(),G_COMP_OBJ.isReqFromDocs&&ZDUtils.deSelectDocs(),G_OF_OBJ.autocomplete_selectValue="",G_OF_OBJ.trimmedPerGroupIds="",G_OF_OBJ.trimmedOrgGroupIds="",G_OF_OBJ.trimmedEmails="",G_OF_OBJ.G_fromAutoComplete=[],G_OF_OBJ.isCo_owner=!1),"passwordvalidation"!=t&&ZD("#zdc_visible_default_hidediv").remove(),ZD("#"+e).dialog("destroy").remove()):"sharecollabupgradediv"==e?ZD("#"+e).dialog("destroy").remove():"mycollaboratorslistdiv"==e?ZD("#"+e).dialog("destroy").remove():"dialogdiv"==e?ZD("#"+e).html("").removeAttr("style").dialog("destroy"):"statusdialogdiv"==e?ZD("#"+e).dialog("destroy").remove():"customfieldsdialogdiv"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"sharefileaslinkcontainer"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"ui-zmoveto-dialog"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"ui-zdocssaveas-dialog"===e?(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove()):"initSaveAs"===e&&(ZD("#"+e).dialog("destroy").remove(),ZD("#"+e).remove())},ZDDialog.showExternalUsersList=function(e,t,i,s,o,n){ZD("#frameDiv").remove(),(void 0==i||""==i)&&(i=[200,350]),width=450;var a=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(a).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:i,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return"invalidList"==o?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_invalid+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"):3==s&&"externalList"==o&&0==n?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_coowner_permission_not_allowed+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_continue_remove_users_share_again+"</div></div></div>").removeAttr("style"):ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_list_contains_people_not_part_organization+':</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_are_you_sure_you_want_to_share+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showNonZohoUserList=function(e,t,i){ZD("#frameDiv").remove(),(void 0==i||""==i)&&(i=[200,350]),width=450;var s,o=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');s="NONE"==zd_third_party||""==zd_third_party||"undefined"==zd_third_party||void 0==zd_third_party?"zoho":zd_third_party.toLowerCase(),ZD(o).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:i,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div  style="display: block;"><div><div>'+ZDUtils.replaceParams(zd_js_obj.label_users_groups_listed_invalid,new Array(s))+':</div><div class="zdc-external-list"></div></div></div>').removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.showInactiveUserList=function(e,t,i){ZD("#frameDiv").remove(),(void 0==i||""==i)&&(i=[200,350]),width=450;var s=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(s).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:i,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>'+zd_js_obj.label_users_listed_are_inactive+'</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton(),!1}),!1},ZDDialog.sharePolicyFailList=function(e,t,i,s,o){ZD("#frameDiv").remove(),(void 0==i||""==i)&&(i=[200,350]),width=450;var n=ZD('<div id="frameDiv" style="display:none;" class="custommargin_lightgrey"></div>');ZD(n).appendTo("body");ZD("#frameDiv").dialog({autoOpen:!0,zIndex:10005,title:e,modal:!1,resizable:!1,closeText:"",buttons:t,position:i,width:width,draggable:!0,height:"auto",close:function(){ZD(this).dialog("destroy").remove()},open:function(){ZD("#frameDiv").parent().addClass("docsdialog").prev()}});return"ext_fail"==s?ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Your organization policy does not allow you to share with below users:</div><div class="zdc-external-list"></div><div>To continue sharing, please contact your administrator.</div></div></div>').removeAttr("style"):"accept_fail"==s&&ZD("#frameDiv").empty().html('<div class="ui-corner-all" style="display: block;"><div><div>Organization policy of below user(s) does not allow you to share with them :</div><div class="zdc-external-list"></div><div>'+zd_js_obj.label_to_continue_share_remove_users_share_again+"</div></div></div>").removeAttr("style"),ZD("#frameDiv").addClass("custommargin_lightgrey"),ZD("#frameDiv").bind("dialogclose",function(){return ZDDialog.closePopUp("frameDiv"),"undefined"==typeof o&&(ZDSHAREDIALOG.resetEmailIds(),ZDSHAREDIALOG.insertShareButton()),!1}),!1},ZDDialog.showStatusDialog=function(e,t,i,s,o){var n=ZD('<div id="statusdialogdiv" style="display:none;"></div>');if(ZD(n).appendTo("body"),(""===i||void 0===i)&&(i=[SCR_WTH-SCR_WTH/1.6,SCR_HT-SCR_HT/1.6]),ZDdialog=ZD("#statusdialogdiv").dialog({autoOpen:!0,title:e,modal:t,resizable:!1,closeText:"",buttons:"",position:i,width:s,draggable:!0,height:o,open:function(){ZD(".ui-dialog-titlebar-close").hide()}}),!ZD("#statusdialogdiv").parent(".dialog-inner-container").length){var a=ZD('<div class="ui-corner-all dialog-inner-container" style="display:block;"></div>');a.insertBefore(ZD("#statusdialogdiv")).append(ZD("#statusdialogdiv"))}if(ZD(".sshow_layoutcontainer").length){var r=parseInt(ZD(".sshow_layoutcontainer").css("z-index"));ZD("#statusdialogdiv").closest(".ui-dialog").css("z-index",r+5)}ZD("#statusdialogdiv").unbind().bind("dialogclose",function(){return ZDDialog.closePopUp("statusdialogdiv"),!1})},ZDDialog.showPreviewImg=function(e,t,i){ZDDialog.showCommonDialog(e,!0,"dialogdiv","","",SCR_WTH/1.35,!0,SCR_HT/1.5);var s='<div align="center"  style="padding:10px;"><img src="'+i+'" style="max-height:'+SCR_HT/1.5+'px" /></div>';ZD("#dialogdiv").html(s)},G_COMP_CONSTANTS=function(){this.isReqFromDocs=!1,this.serviceType=""};var G_COMP_OBJ=new G_COMP_CONSTANTS,zd_isIE="";!function(){var e=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);zd_isIE=e?parseInt(e[1]):void 0}();var G_OF_OBJ,G_FormDataArray=[],G_FileDataArray=[],G_UploadIndexCounter=0,ZD_collaboratorCount=0,docs_myContacts=[],user_emailContacts=[],ZD=jQuery,zd_js_obj="",zdcsrfPair,isWin=-1!=navigator.appVersion.indexOf("Win")?!0:!1,isSafari=navigator.userAgent.toLowerCase().indexOf("safari")>-1,userAgent=navigator.userAgent.toLowerCase(),us=userAgent.substring(userAgent.indexOf("chrome/")+7),chrome7=parseInt(us.substring(us,us.indexOf(".")))>=7?!0:!1,zdcomp_userType,ZD_G_CurrentVisibility="private",public_PwdExpiryDate="",DComponents=function(e){function t(e){return e&&(o=e.split("#")[1],o&&(o=o.split("=")[1],document.cookie=s.clientTokenName+"="+o+"; domain="+s.domain+"; path=/; secure")),o}function i(i){s.serviceName=i.serviceName,s.domain=i.domain;var o=s.clientTokenServiceURL;if("tokenpair.do"===o){var n=window.location;o=n.protocol+"//"+n.hostname+DComponents.option("contextPath")+o}var a=i.clientTokenReqURL+"client_auth=true&servicename="+i.serviceName+"&serviceurl="+o,r=e("<iframe>").attr({id:"zfc-iam-clienttoken",src:a,style:"display:none;"});r.appendTo("body"),r.load(function(){t(this.contentWindow.location.href)})}var s={csrfParamName:"zpcr",csrfCookieName:"zpcc",csrfRequestURL:void 0,contextPath:"docs/",clientTokenIsEnabled:!1,clientTokenName:"x-uds-clitoken",clientTokenServiceParamName:"x-cli-service-name",serviceName:"ZohoWriter",clientTokenReqURL:"https://accounts.localzoho.com/login",clientTokenServiceURL:"tokenpair.do",service:"WR"},o=void 0;return{getClientToken:function(){return o},init:function(t){var t={};t.contextPath="/docs/",t.csrfParamName="zpcr";var o=window.location.hostname.split(".");o.length>2&&(o.reverse().pop(),o.reverse()),s.domain=o.join(".");var n=!1;void 0!==t.csrfRequestURL&&""!==t.csrfRequestURL&&ZDocsUtil.ajaxUtil(t.csrfRequestURL,"GET"),!t.csrfInitRequest||void 0!==t.csrfParamName&&""!==t.csrfParamName||(n=!0,t.csrfParamName=s.csrfParamName,t.csrfCookieName=s.csrfCookieName),s=e.extend({},s,t);var a=s.clientToken;s.clientTokenIsEnabled!==!0||void 0!==a&&""!==a||ZDocsUtil.ajaxUtil("getproperties.do","get","",{success:function(e){"success"===e.request&&i(e)}}),n&&ZDocsUtil.ajaxUtil("html/blank.html","get","","")},option:function(e,t){return t?void(s[e]=t):s[e]}}}(jQuery),ZDocsUtil=function(e){function t(){var e=zdcsrfPair.split("=");return e[1]}return{sendAjaxUpdate:function(t,i,s){var o=window.tdURL+"/docs/zdloadcomponentdata.do?resourceId="+window.wdResId;e.ajax({url:o,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(o){ZD("#zd_user_details").remove(),ZD("body").append(o);var n="PATCH",a=window.tdURL+"/api/v1/files/"+t,r={id:t,type:"files",attributes:{name:i}},l=JSON.stringify({data:r}),d=e.ajax({type:n,url:a,contentType:"application/json; charset=utf-8",xhrFields:{withCredentials:!0},data:l,headers:{"X-ZCSRF-TOKEN":"zpcr="+window.ZDOCScsrfToken},beforeSend:function(e){s.progress&&s.progress(e)},fail:function(e){s.fail&&!s.errorNotified&&(s.errorNotified=!0,s.fail(e))},error:function(e){s.fail&&!s.errorNotified&&(s.errorNotified=!0,s.fail(e))},success:function(t){if(s.success){var i=t;i.request="success",i.DOC_ENCODE_NAME=t.data.attributes.display_html_name,i.DOC_NAME=t.data.attributes.name,i.DOC_ENCODE_ATTR_NAME=t.data.attributes.display_attr_name,i.DOC_ENCODE_URL_NAME=t.data.attributes.display_url_name,"object"!=typeof i&&"application/json"===optionObj.responseType&&(i=e.parseJSON(t)),s.success(i)}}});return d}})},ajaxUtil:function(e,t,i,s,o,n){if(i=i||{},o=o||{},s=s||{},"getfoldertree.do"===e){temp=document.domain.split("."),temp[0]="workdrive";for(var a="",r=0;r<temp.length;r++)a+=temp[r],r!=temp.length-1&&(a+=".");var l="https://"+a+"/docs/getproductinfo.do?rid="+i.rid;ZD.ajax({url:l,type:"GET",xhrFields:{withCredentials:!0},dataType:"html",success:function(a){var r=ZD.parseJSON(a);r.isTeamResource&&(window.ZD_IS_NEW_UI_ENABLED=!0,window.wdResId=i.rid,window.tdURL=r.pcUrl),ZDocsUtil.triggerRequest(e,t,i,s,o,n)}})}else ZDocsUtil.triggerRequest(e,t,i,s,o,n)},triggerRequest:function(t,i,s,o,n,a){s=s||{},n=n||{},o=o||{},n.responseType=n.responseType?n.responseType:"application/json","post"===i.toLowerCase()&&(s[DComponents.option("csrfParamName")]=this.getCSRFToken()),t=a?t:"/docs/"+t,window.ZD_IS_NEW_UI_ENABLED&&"false"!==window.ZD_IS_NEW_UI_ENABLED&&(t=window.tdURL+t),o.errorNotified=!1;var r=e.ajax({type:i,url:t,xhrFields:{withCredentials:!0},data:s,beforeSend:function(e){o.progress&&o.progress(e)},fail:function(e){o.fail&&!o.errorNotified&&(o.errorNotified=!0,o.fail(e))},error:function(e){o.fail&&!o.errorNotified&&(o.errorNotified=!0,o.fail(e))},success:function(t){if(o.success){var i=t;"object"!=typeof i&&"application/json"===n.responseType&&(i=e.parseJSON(t)),o.success(i)}}});return r},commonKeys:{insert:"Insert",close:"Close",cancel:"Cancel"},getString:function(e,t,i){return this.getI18NString("fcommon",e,i,t||this.commonKeys)},getI18NString:function(e,t,i,s){return i=i||[],ZDocsComponents.getI18NText(e,t,s,i)},removeProgressDialog:function(){e("#zfc-progress-dialog").remove()},showProgressDialog:function(t,i,s){if(s===!0){var s=e("<div>").attr({id:"zfc-progress-dialog-overlay"}).appendTo("body");s.css({overflow:"scroll",position:"fixed",width:"100%",height:"100%","z-index":e.ui.dialog&&e.ui.dialog.zIndex?e.ui.dialog.zIndex:1e4,top:0,left:0});var o=e("<div>").attr({id:"zfc-progress-dialog"}).appendTo(s)}else var o=e("<div>").attr({id:"zfc-progress-dialog"}).appendTo("body");o.css({height:i.outerHeight(),width:i.outerWidth(),left:i.offset().left,top:i.offset().top});var n=e("<span>").attr({id:"zfc-dialog-loader","class":"ui-zfc-loader-circle"}).appendTo(o),a=e("<span>").attr({"class":"zfc-dialog-loader-msg"}).appendTo(o);a.text(t),o.animate({height:110,width:220,marginTop:100,marginLeft:i.outerWidth()/3},100,function(){var e=(o.outerWidth()-(n.outerWidth()+a.width()+4))/2,t=(o.outerHeight()-n.outerHeight()-2)/2;n.css({left:e,top:t}),a.css({left:e,top:t}),n.fadeIn(50),a.fadeIn(100)})},showError:function(t,i,s,o,n){t=""===t||void 0===t?ZDocsUtil.getString("internalserver.label"):t;var a=i.find("#ui-fc-server-error");a.length||(a=e('<div id="ui-fc-server-error" class="ui-fc-server-error"><div class="zc-server-error"><span id="zc-server-error-close" title="'+ZDocsUtil.getString("close","fcommon")+'" class="ui-zfc-icon ui-icon-closethick"></span><div class="zc-server-error-msg" id="zfc-server-error"></div> </div> </div>'),a[void 0!==n?n:"insertBefore"](s)),a.find("#zfc-server-error").text(t);var r={openDelay:200,closeDelay:200};if(o=e.extend({},r,o),a.slideDown(o.openDelay,function(){o.onOpen&&o.onOpen(a)}),o.autoCloseDelay){i.data("zfcAutoClose")&&clearTimeout(i.data("zfcAutoClose"));var l=setTimeout(function(){a.slideUp(o.closeDelay,function(){o.onAutoClose&&o.onAutoClose(a)})},o.autoCloseDelay);i.data("zfcAutoClose",l)}a.find("#zc-server-error-close").off("click").on("click",function(){o.beforeClose&&o.beforeClose(a),a.slideUp(o.closeDelay,function(){o.onClose&&o.onClose(a)})})},getCSRFToken:function(){return t(DComponents.option("csrfCookieName"))},getCSRFCookie:function(e){return t(e)}}}(jQuery),ZDocsDOMUtil=function(){var e=void 0;return{init:function(){e={div:document.createElement("div")}},clone:function(t){return e[t].cloneNode()}}}(window),ZDocsComponents=function(e){function t(){var e=document.createElement("div"),t=!1;return e.addEventListener("DOMAttrModified",function(){t=!0},!1),e.setAttribute("class","zcomponents"),t}var i=!0,s=navigator.userAgent.toLowerCase(),o=document.createElement("div"),n=document.createTextNode(" ");return{version:"3.1",isRTL:!1,selector:"data-ctype",userAgent:s,locale:navigator.language,zIndex:1e3,$document:e(document),$window:e(window),hasHandlebars:window.Handlebars?!0:!1,keys:{},keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38,ALT:18},initDeferredComponents:function(t,i,s){var o=this;setTimeout(function(){e.each(t,function(t,i){e(i).each(function(i,s){o._initComponent(e(s),t)})}),s&&s(t)},i?i:1e4)},init:function(t,s,o){i&&this._init(),t=e(t?t:"body");var n=o?o:this.selector,a="["+n+"]",r=document.querySelectorAll?t[0].querySelectorAll(a):e(a,t);if((t[0].attributes[n]||t[0].dataset&&t[0].dataset[n])&&(r=e(t).add(r)),r.length){var l=this;this.eachAsync(r,{delay:20,loop:function(e,t){l._initComponent(t,void 0,o)},end:function(){l._end(t,r,s)}})}else this._end(t,r,s)},destroy:function(t,i,s){t=e(t?t:"body"),s=s?s:this.selector;var o="["+s+"]",n=e(o,t);if(t.is(o)&&(n=e(t).add(n)),n.length){var a=this;this.eachAsync(n,{delay:20,loop:function(t,i){e(i)[i.getAttribute(s)]("destroy")},end:function(){a._end(t,n,i,!0)}})}else this._end(t,n,i,!0)},eachAsync:function(t,i){var s=0,o=t.length,n=i.loop||function(){};this.whileAsync(e.extend(i,{test:function(){return o>s},loop:function(){var e=t[s];return n.call(e,s++,e)}}))},whileAsync:function(e){var t=Math.abs(e.delay)||10,i=isNaN(e.bulk)?500:Math.abs(e.bulk),s=e.test||function(){return!0},o=e.loop||function(){},n=e.end||function(){};!function a(){for(var e=!1,r=new Date;(e=s())&&(o(),!(0===i||new Date-r>i)););e?setTimeout(a,t):n()}()},_initComponent:function(t,i,s){s=s?s:this.selector,t=e(t),t[i?i:t.attr(s)]()},_end:function(e,t,i,s){this.$document.trigger(s?"zcomponentdestroyed":"zcomponentinitialized",e),i&&i(t)},clearMetadata:function(t){t&&e(t).removeData("metadata")},_getDataAttributes:function(e,t){for(var i=e.attributes,s=i.length,o=0;s>o;o++){var n=i[o].nodeName,a=""===i[o].nodeValue?"true":i[o].nodeValue;"data"!==n&&(n=n.match(/^data-/)?n.replace(/^data-/,""):n,n=n.replace(/-([a-zA-Z])/g,this._stringReplace.bind(this)),n=n.replace("Html","HTML").replace(/Svg/g,"SVG"),t[n]="true"===a||"false"===a?"true"===a:-1!==a.indexOf("{")?ZDocsComponents._getObject(a):a)}return t},_stringReplace:function(e){return e[1].toUpperCase()},_getDataSet:function(e,t){var i,s=e.dataset;for(var o in s)s.hasOwnProperty(o)&&(i=s[o],o=o.replace(/Html/g,"HTML").replace(/Svg/g,"SVG"),t[o]="true"===i||"false"===i?"true"===i:-1!==i.indexOf("{")?ZDocsComponents._getObject(i):i);return t},_getOptions:void 0,getOptions:function(t){t=t instanceof jQuery?t[0]:t;var i=e.data(t,"metadata");if(!i&&t.attributes){var s=t.getAttribute("data");s&&(i=ZDocsComponents._getObject(void 0,t)),i=this._getOptions(t,i?i:{}),e.data(t,"metadata",i)}return i?i:{}},getTemplate:function(e){var t;return this.hasHandlebars&&Handlebars.templates&&(t=Handlebars.templates[e]),t},_getObject:function(t,i){if("object"==typeof t)return t;t=t||i.getAttribute("data"),t=t.indexOf("{")<0?"{"+t+"}":t;try{t=JSON.parse(t.replace(/'/g,'"'))}catch(s){return e.metadata?e(i).metadata():{}}return t},_extend:function(t,i){t.prototype=e.extend({},i.prototype,t.prototype),e.each(t.prototype,function(s,o){"function"===e.type(o)&&(t.prototype[s]=function(){var e=function(){return i.prototype[s].apply(this,arguments)};return function(){return this._super=e,o.apply(this,arguments)}}())})},OS:{isLinux:function(){return-1!=navigator.appVersion.indexOf("Linux")}},Browser:{isIE:function(){return-1!==s.indexOf("msie")||-1!==s.indexOf(".net")},isSafari:function(){return-1!==s.indexOf("safari")&&-1===s.indexOf("chrome")},isChrome:function(){return window.chrome},isFirefox:function(){return s.indexOf("firefox")>-1?!0:!1},isMac:function(){return navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)?!0:!1},isWindows:function(){return-1!==navigator.platform.indexOf("Win")},getIEVersion:function(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=i.exec(t)&&(e=parseFloat(RegExp.$1))}return e}},AJAX:{transport:function(t,i,s){var o=e.ajax({url:t.sourceURL,data:t.data,type:t.type,dataType:t.dataType,success:function(e){i(e)},fail:function(e,t){s(e,t)},error:function(e,t){s(e,t)}});return o}},setI18NKeys:function(t,i,s){if("object"==typeof t)for(var o in t)this.keys[o]=e.extend({},this.keys[o],t[o]);else this.keys[t]=s?i:e.extend({},this.keys[t],i)},getI18NText:function(e,t,i){var s=void 0;4===arguments.length&&(s=i,i=arguments[3]);var o=ZDocsComponents.keys[e]||{},n=o[t]||"";if(""===n&&s&&(n=s[t]),i)for(var a=0;a<i.length;a++)n=n.replace("{"+a+"}",i[a]);return n},create:function(e){var t=e.ctype.replace(e.ctype.charAt(0),""),i="create"+t.charAt(0).toUpperCase()+t.substring(1);return this[i](e)},setProperties:function(){var e=document.documentElement||{},t=document.body||{};ZDocsComponents.documentObject={height:Math.max(e.clientHeight,e.scrollHeight,e.offsetHeight,t.offsetHeight,t.scrollHeight),width:Math.max(e.clientWidth,e.scrollHeight,e.offsetHeight,t.offsetWidth,t.scrollWidth)},ZDocsComponents.windowObject={height:window.innerHeight,width:window.innerWidth}},createSVGElement:function(e,t,i){var s=document.createElementNS("http://www.w3.org/2000/svg",e);for(var o in t)s.setAttribute(o,t[o]);if(i)for(var n=0;n<i.length;n++)for(var a in i[n]){var r=document.createElementNS("http://www.w3.org/2000/svg",a),l=i[n][a];if(l.nodes)r=this.createSVGElement(a,l.props,l.nodes);else for(var d in l)r.setAttribute(d,l[d]);s.appendChild(r)}return s},createIcon:function(t,i,s,o,n){if(i=s?-1===s.indexOf("#")?"#"+s:s:o?o:i)if(-1===i.indexOf("#"))t.addClass(" "+i);else{var s=i.split(" ")[0],a=i.slice(s.length).trim()+" "+(n?n+"__svg":"");t.empty().append(e("<svg class='"+a+"'><use xlink:href='"+s+"'></use></svg>"))}return t},_handleIcon:function(t,i,s,o,n,a,r,l){r&&t.removeClass(l);var d=!1;if(void 0!==a||void 0!==o||void 0!==n)if(a&&0===a.indexOf("#")||void 0!==n){var c=n||a,p=c.split(" ");n=p[0],o=p[1]||"",d=!0}else o=o||a;else if(void 0!==s&&void 0!==i){var c=this._svgSprite.querySelector("#"+s);if(!c){var h=i.props||{};h.id=s;var u=this.createSVGElement("symbol",h,i.nodes);this._svgSprite.appendChild(u)}n="#"+s,o=i.props&&i.props.class?i.props.class:s,d=!0}return d?(n=-1!==n.indexOf("#")?n:"#"+n,t.empty().append(e("<svg class='"+o+"'><use xlink:href='"+n+"'></use></svg>"))):t.addClass(o),t},encodeHTML:function(e){return n.nodeValue=e,o.innerHTML},_init:function(){ZDocsDOMUtil.init();var s=ZDocsComponents;return i?(i=!1,s._getOptions=ZDocsDOMUtil.clone("div").dataset?s._getDataSet:s._getDataAttributes,s.isDOMAttrModifiedSupported=t(),o.appendChild(n),s.Browser.isIE()&&s.isDOMAttrModifiedSupported&&(s.core._attachObserver=function(e){var t=this;this.observer=function(e){-1!==t.attributeList.indexOf(e.attrName)&&t._handleObserver(e.attrName,e.newValue)},e.addEventListener("DOMAttrModified",this.observer,!1)},s.core.destroy=function(){this.element[0].removeEventListener("DOMAttrModified",this.observer)}),s.setProperties(),s._svgSprite=s.createSVGElement("svg",{id:"zcomponents__svg"}),void e(s._svgSprite).appendTo("body").hide()):!1},registerComponent:function(t,s,o){o||(o=s,s=this.core),o.componentName=t,e[t]=function(e,t,i){arguments.length&&this._init(e,t,i)};var n=new s;n.options=e.extend(!0,{},n.options),e[t].prototype=e.extend(!0,{},n,o),e.fn[t]=function(s){i&&ZDocsComponents._init();var o=this,n=this.length;if(s&&"object"!=typeof s){if("string"!=typeof s||-1!==s.indexOf("_"))return!1;for(var a=Array.prototype.slice.call(arguments,1),r=0;n>r;r++){var l=e(this[r]).data(t);l&&("option"===s?s=a&&2===a.length?"setAttribute":"getAttribute":"options"===s&&(s=a&&0===a.length?"getAttributes":"setAttributes"),o=l[s].apply(l,a))}}else{s=s?s:{};for(var r=0;n>r;r++){var l=e(this[r]).data(t);if(l)return o;var d=e.extend(!0,{},e[t].prototype.options,ZDocsComponents[t]?ZDocsComponents[t].DEFAULTS:{},ZDocsComponents.getOptions(this[r],{}),s);e(this[r]).data(t,new e[t](d,this[r],s))}}return o},this._extend(e[t],s)}}}(jQuery);!function(e){ZDocsComponents.core=function(e,t){arguments.length&&this._init(e,t)},ZDocsComponents.core.prototype={_init:function(t,i,s){this.element=e(i),this.options=t,this._create(e(i),t,s)},_create:function(){},_trigger:function(t,i,s,o){o=o?o:this.element;var n,a,r,l=this.options[t];if(s=s||{},i=e.Event(i),i.type=(this.componentName?this.componentName+t:""+t).toLowerCase(),i.originalTarget=i.target,i.target=o,a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return o.trigger(i,s),s=[i].concat(s),r=l&&"string"==typeof l?this._triggerFunction(l,o[0],s):e.isFunction(l)?l.apply(o,s):void 0,void 0!==r?r:!i.isDefaultPrevented()},_handleIcon:function(e,t,i,s,o,n,a,r,l,d){return d=d||this.componentName+"__"+i,ZDocsComponents._handleIcon(e,t,d,s,o,n,a,r,l)},_triggerFunction:function(e,t,i){for(var s=e.split("."),o=window,n=0;n<s.length&&o;n++)o=o[s[n]];return o&&o.apply(t,i)},_handleObserver:function(e,t){var i=e.replace(/^data-/,"");i=i.replace(/-([a-zA-Z])/g,function(e){return e[1].toUpperCase()}),this.setAttribute(i,t)},_attachObserver:function(e){var t=this;this.observer=new MutationObserver(function(e){var i=e[0].attributeName,s=e[0].target.getAttribute(i);t._handleObserver(i,s)}),this.observer.observe(e,{attributes:!0,attributeFilter:this.attributeList})},getData:function(e){return ZDocsComponents.getOptions(e?e:this.element[0])},_setAttribute:function(){return!0},setAttribute:function(e,t){if("string"!=typeof this.options[e]||this.options[e]!==t){var i=this._setAttribute(e,t);"disable"===e&&(this._handleDisable(t),i=!0),i&&(this.options[e]=t)}},setAttributes:function(e){for(var t in e)this.setAttribute(t,e[t])},getAttribute:function(e){return this.options[e]},getAttributes:function(){return e.extend(!0,{},this.options)},_getI18N:function(e,t,i,s){var o=ZDocsComponents.keys[e]||{},n=o[t]||"";if(""===n&&i&&(n=i[t]),s)for(var a=0;a<s.length;a++)n=n.replace("{"+a+"}",s[a]);return n},enable:function(){this._handleDisable(!0)},disable:function(){this._handleDisable(!1)},_handleDisable:function(t){var i=this._baseElement?e(this._baseElement):this.element;i[t?"addClass":"removeClass"]("is-disabled"),t?i.attr({"aria-disabled":t,disabled:t}):i.removeAttr("aria-disabled disabled"),this.setAttribute("disabled",!t)},getElement:function(){return this._baseElement?this._baseElement:this.element},_destroy:function(){},destroy:function(){this.element.off("."+this.eventPrefix),this.element.removeData(this.componentName).removeData("metadata"),this._destroy(),this._baseElement&&this._baseElement[0]!==this.element[0]&&this._baseElement.remove()}}}(jQuery),document.addEventListener("DOMContentLoaded",ZDocsComponents._init),window.addEventListener("resize",ZDocsComponents.setProperties),function(e,t){"use strict";var i={eventPrefix:"filefield",options:{displayLength:450,rename:!0,fileId:"",fileName:"",saveToFolder:!0,alwaysDisplayMove:!0,allowDuplicateName:!1,canFavourite:!0,serviceName:"zw",buttonName:"Move"},_isEnabled:!0,_isFileNameModified:!1,_isFilePathModified:!1,_fileTextBox:"zfiletextbox",_folderTextBox:"zfoldertextbox",_textFieldIsClicked:!1,_textFieldMinWidth:300,_textFieldMaxWidth:300,_folderTreeMinWidth:300,_folderTreeMaxWidth:600,_treeMaxHeight:500,_ellipsPos:0,_favRequest:void 0,_favElement:void 0,_EVENTS:{ONSUCCESS:"success",ONSUBMIT:"submit",ONFOCUS:"focus",ONBLUR:"blur",ONFAILURE:"failure",ONFAVOURITE:"favourite",ONUNFAVOURITE:"unfavourite"},_create:function(){this._textarea=document.createElement("textarea"),this.options=e.extend({},e.fn.zdocsfilefield.config,this.options),this.options.canCreateFolder=!1,this._isSafari=/^((?!chrome).)*safari/i.test(navigator.userAgent),this._textFieldMaxWidth=this.options.displayLength,this._isRawFileName="boolean"==typeof this.options.isEncoded?!this.options.isEncoded:!1,this._baseElement=e(this.element),this._defaultLoadCheck=!1,this._createRenameContainer(),(this.options.rename||this.options.canFavourite)&&this._getReosurceAndTreeDetails(),this._baseElement.on("click",function(e){e.stopPropagation()}),this._validationIsInProgress=!1,this.options.rename||this._baseElement.prop("title",this._fileEncodeName)},_bindFavouriteEvents:function(){var e=this;e._favElement.off("click").on("click",function(t){e._favRequest&&e._favRequest.abort(),e._updateFavouriteStatus(e._favElement.find("span").hasClass("ui-zfc-icon-favourite"),t)})},_updateFavouriteStatus:function(e,t){var i=e?"unfavourite":"favourite",s={action:i,rid:this.options.fileId},o=this,n={progress:function(){o._changeFavouriteStatus("inprogress",i,t)},success:function(e){var s=e.message?e.message:e.request;o._favRequest=void 0,o._isFavorite=e.isFavorite?!1:!0,i=e.isFavorite?"favourite":"unfavourite",o._changeFavouriteStatus(s,i,t)},fail:function(){o._favRequest=void 0,o._changeFavouriteStatus("error",i,t)}};this._favRequest=ZDocsUtil.ajaxUtil("documentupdate.do","POST",s,n)},_getReosurceAndTreeDetails:function(){var t=this,i={success:function(i){if("success"===i.request){if(i.is_newui_enabled)i.resourceCapability.canMove||(t.options.saveToFolder=i.resourceCapability.canMove),i.resourceCapability.canRename?(t.options.rename=!0,t._initMouseEvents()):t.options.rename=!1,i.resourceCapability.canMove&&t.options.saveToFolder&&t.options.alwaysDisplayMove&&(e("<div/>").attr({id:"ui-zfilefield-folder-button",title:t._getString("choosefolder.label")}).html(e("<span/>").attr({"class":"ui-zfc-icon-folder ui-zfc-icon"})).appendTo(t._baseElement),t._createFolderIconAndInitEvents());else if(t._isFavorite=i.isFavorite,t._isShared=i.isShared,i.saveToFolder||(t.options.saveToFolder=i.saveToFolder),i.renameAllowed?(t.options.rename=!0,t._initMouseEvents()):t.options.rename=!1,i.saveToFolder&&t.options.saveToFolder&&t.options.alwaysDisplayMove?(e("<div/>").attr({id:"ui-zfilefield-folder-button",title:t._getString("choosefolder.label")}).html(e("<span/>").attr({"class":"ui-zfc-icon-folder ui-zfc-icon"})).appendTo(t._baseElement),t._createFolderIconAndInitEvents()):t._baseElement.addClass("ui-zfilefield-rename-only"),t.options.canFavourite&&t._isShared){var s=t._isFavorite?"removefavorite.label":"markasfavorite.label";t._favElement=e('<div class="ui-zfilefield-fav" id="ui-zfilefield-fav" title="'+t._getString(s)+'">').html('<span class="ui-zfc-icon ui-zfc-icon-'+(t._isFavorite?"favourite":"unfavourite")+'"></span>').appendTo(t._baseElement),t._bindFavouriteEvents()}}else t.options.saveToFolder=!1}};this._getFoldersList(void 0,i)},_getFoldersList:function(e,t){var i={rid:this.options.fileId,folderId:e};ZDocsUtil.ajaxUtil("getfoldertree.do","GET",i,t)},_createRenameContainer:function(){this._renameElement||(this.options.fileName=this.options.fileName.length>0?this.options.fileName.trim():this._baseElement.text().trim(),this._baseElement.html(""),this._renameWrapper=e("<div>").attr({id:"ui-zft-wrapper","class":"ui-zft-wrapper"}).appendTo(this._baseElement),this._renameElement=e("<div>").attr({id:"ui-zft-name","class":"ui-zft-name"}).appendTo(this._renameWrapper),this._extensionElement=e("<div>").attr({id:"ui-zft-extension"}).appendTo(this._renameWrapper),void 0!==this.options.fileExtension&&"zwriter"!==this.options.fileExtension&&"zsheet"!==this.options.fileExtension&&"zslide"!==this.options.fileExtension&&(this._extensionElement.attr({"class":"ui-zft-extension"}),this._extensionElement.text("."+this.options.fileExtension))),this.options.fileName=this.options.fileName.length>0?this.options.fileName.trim():this._baseElement.text().trim(),this._setEllipzsis(),this._setTextFieldWidth(this._renameWrapper,"divElement",0),this._baseElement.addClass("ui-zfilefield "+(this._isSafari?"ui-zff-transition-safari":" ui-zff-transition-base")),this._defaultLoadCheck||this._baseElementTooltipReset(!0),this._defaultLoadCheck=!0,this._renameWrapper.off("mouseenter.zstf mouseleave.zstf"),this._initBodyEvents(!1),this.options.rename&&(this._initMouseEvents(),this._newFolderErrStatus=!1,this._isCursorMoved=!1)},_initMouseEvents:function(){var t=this;this._textFieldMouseEnter=void 0,t._renameWrapper.on("mouseenter.zstf",function(){if(t._baseElement.addClass("ui-zfilefield-active"),t._renameWrapper.addClass("ui-zft-is-active"),e("#"+t._fileTextBox).length<1){var i=e("<input/>").attr({type:"text",maxlength:255,id:t._fileTextBox,value:t._fileEncodeName});if(t._renameElement.html(i),!t.options.alwaysDisplayMove&&t.options.saveToFolder){var s=e("<div/>").attr({id:"ui-zfilefield-folder-button",title:t._getString("choosefolder.label")}).html(e("<span/>").attr({"class":"ui-zfc-icon-folder ui-zfc-icon"}));t._renameElement.append(s),t._createFolderIconAndInitEvents()}t._initTextboxEvents(),t._setTextFieldWidth(e("#"+t._fileTextBox),"inputElement",0),t._setTextFieldWidth(t._renameWrapper,"divHover",0),t._textFieldMouseEnter=setTimeout(function(){t._renameWrapper.css("width","auto")},100)}}),t._renameWrapper.on("mouseleave.zstf",function(){t._textFieldIsClicked?(t._renameWrapper.addClass("ui-zft-is-active"),t._baseElement.addClass("ui-zfilefield-active")):(t._textFieldMouseEnter&&clearTimeout(t._textFieldMouseEnter),t._setEllipzsis(),t._baseElement.removeClass("ui-zfilefield-active"),t._renameWrapper.removeClass("ui-zft-is-active"),t._setTextFieldWidth(t._renameWrapper,"divElement",0),t._baseElementTooltipReset(!0))}),this._extensionElement.off("mouseup.zstf").on("mouseup.zstf",function(){e("#"+t._fileTextBox).focus().select()})},_initBodyEvents:function(t){var i=this;t?i._initBodyEvent||(i._initBodyEvent=!0,e(window).on("keydown.zstf",function(e){27===e.keyCode&&(i._initBodyEvents(!1),i._isFileNameModified=!1,i._isFilePathModified=!1,i._renameWrapper.removeClass("ui-zft-is-active"),i._baseElement.removeClass("ui-zfilefield-active"),i._onSubmit(e,"escapeKey"))}),e("body").on("click.zstf",function(e){i._textFieldIsClicked=!0,i._validationIsInProgress||e.target.id===i._fileTextBox||i._onSubmit(e,"clickevent")})):(this._initBodyEvent=!1,e(window).off("keydown.zstf"),e("body").off("click.zstf"))},_initTextboxEvents:function(){var i=this,s=e("#"+i._fileTextBox);s.on("focus",function(e){s.select(),i._triggerEvent(i._EVENTS.ONFOCUS,e)}),s.on("click",function(e){return i._textKeypressed=!1,i._initBodyEvents(!0),i._textFieldIsClicked=!0,i._baseElement.addClass("ui-zfilefield-active"),i._renameWrapper.addClass("ui-zft-is-active"),i._setTextFieldWidth(s,"inputElement",0),e.stopPropagation(),i._baseElementTooltipReset(!1),!1}),s.on("keydown",function(e){i._textKeypressed=!0,16!==e.keyCode&&188!==e.keyCode&&(i._setTextFieldWidth(s,"inputElement",0),e.keyCode===t.keyCode.ESCAPE?(i._isFileNameModified=!1,i._onSubmit(e,"escapeKey")):(i._isFileNameModified=s.val()!==i.options.fileName?!0:!1,(e.keyCode===t.keyCode.ENTER||e.keyCode===t.keyCode.TAB)&&(i._baseElement.addClass("ui-zfilefield-active"),i._renameWrapper.addClass("ui-zft-is-active"),i._onSubmit(e,"textFieldFousOut")))),e.stopPropagation()}),s.on("keyup",function(e){return 16!==e.keyCode&&188!==e.keyCode&&i._setTextFieldWidth(s,"inputElement",0),i._isFileNameModified=s.val()!==i.options.fileName?!0:!1,e.stopPropagation(),!1})},_baseElementTooltipReset:function(e){e?this._isEllipsisActive()&&this._baseElement.prop("title",this._fileEncodeName):this._resetTooltip(this._baseElement)},_resetTooltip:function(t){e("body > .ui-ztooltip").remove(),t.removeAttr("title")},_setEllipzsis:function(){this._fileEncodeName=this.options.fileName;var t=e("#ui-zfilefield-renamefield");t.length<1&&(t=e('<div id="ui-zfilefield-renamefield">').attr("class","ui-zfilefield-renamefield").appendTo("body")),t[this._isRawFileName?"text":"html"](this.options.fileName),this._fileEncodeName=t.text(),this._renameElement.text(this._fileEncodeName),t.remove()},_isEllipsisActive:function(){return this._baseElement[0].offsetWidth<this._baseElement[0].scrollWidth},_setTextFieldWidth:function(t,i,s){var o=e("#ui-zfilefield-dummy");o.length<1&&(o=e('<div id="ui-zfilefield-dummy">').attr("class","ui-zfilefield-renamefield").appendTo("body"));var n=void 0;if(o.show(),"divElement"===i?(o.html(t.text().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/ /g,"&nbsp;")),n=o.width()+s):"divHover"===i?n=e("#"+this._fileTextBox).width()+this._extensionElement.outerWidth(!0):(o.html(t.val().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/ /g,"&nbsp;")),n=o.outerWidth()+s),o.hide(),"inputElement"===i){var a=50,r=this._textFieldMaxWidth;n<=this._textFieldMaxWidth-a&&(r=n+a),t.css("width",r),r>=this._textFieldMaxWidth&&this._baseElementTooltipReset(!0)}else t.css("width",(n<=this._textFieldMaxWidth?n+1:this._textFieldMaxWidth)+"px")},_triggerEvent:function(t,i,s){var o={target:e(this.element)};return s&&(o=e.extend(o,s)),this._trigger(t,i,o)},_onSubmit:function(i,s){if("escapeKey"===s)this._refresh(i);else{var o=e("#"+this._fileTextBox);if(this._isFileNameModified){var n="";if(this._isFileNameModified){var a=o.val();""===a.trim()?(n=this._fileEncodeName,o.val(this._fileEncodeName),this._setTextFieldWidth(o,"inputElement")):a!==this.options.fileName&&(n=a),this._isFileNameModified=!1}var r=this.options.fileName,l=""===n?this._fileEncodeName:n,d={action:"rename",rid:this.options.fileId,docname:l},c=this,p={progress:function(){c._requestStatus=!0,c._showLoader(!0,"progress",s),c._triggerEvent(c._EVENTS.ONSUBMIT,i,{fileHTMLName:l})},success:function(o){"success"===o.request?(c._isRawFileName=!1,c.options.fileName=o.DOC_ENCODE_NAME,c._showLoader(!1,"success",s),e("body").trigger("renameSuccess",{filename:o.DOC_NAME,filename_enc_attr:o.DOC_ENCODE_ATTR_NAME,filename_enc_name:o.DOC_ENCODE_NAME,filename_enc_url:o.DOC_ENCODE_URL_NAME}),c._refresh(i),c._triggerEvent(c._EVENTS.ONSUCCESS,i,{fileName:o.DOC_ENCODE_NAME,fileHTMLName:o.DOC_NAME})):"File_Name_Already_Exist"===o.message?(c._showLoader(!1,"fail",s),c._validationIsInProgress=!0,t.showMessageDialog({type:"alert",secondary:c._getString("renamealert.label"),icon:"ui-zalert-error",onClose:function(t){t.isCancel||setTimeout(function(){e("#"+c._fileTextBox).focus().select().removeAttr("readonly"),c._validationIsInProgress=!1},200)}})):c._renameFail(i,c.options.folderId,r,s),c._requestStatus=!1},fail:function(e){null!==ZD_IS_NEW_UI_ENABLED&&void 0!==ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED!==!1&&"false"!==ZD_IS_NEW_UI_ENABLED&&alert(JSON.parse(e.responseText).errors[0].title),c._renameFail(i,c.options.folderId,r,s)}};null!==ZD_IS_NEW_UI_ENABLED&&void 0!==ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED!==!1&&"false"!==ZD_IS_NEW_UI_ENABLED?ZDocsUtil.sendAjaxUpdate(this.options.fileId,l,p):ZDocsUtil.ajaxUtil("documentupdate.do","POST",d,p)}else this._refresh(i)}},_renameFail:function(e,t,i,s){this._requestStatus=!1,this._showLoader(!1,"fail",s),this.options.fileName=i,this._isRawFileName=!1,this._refresh(e),this._triggerEvent(this._EVENTS.ONFAILURE,e,{folderId:t,fileName:i})},rename:function(e,t){this._isRawFileName="boolean"==typeof t?!t:!1,this.options.fileName="undefined"==typeof e?"":e,this._refresh()},_refresh:function(t){this._textFieldIsClicked=!1,e(document).trigger("mousedown.ztooltip"),this._createRenameContainer(),this._baseElementTooltipReset(!1),this._baseElementTooltipReset(!0);var i=this;setTimeout(function(){i._renameWrapper.removeClass("ui-zft-is-active"),i._baseElement.removeClass("ui-zfilefield-active")},50),t&&this._triggerEvent(this._EVENTS.ONBLUR,t)},_createFolderIconAndInitEvents:function(){var t=this,i=e("#ui-zfilefield-folder-button");i.off("click").on("click",function(){if(null!==ZD_IS_NEW_UI_ENABLED&&void 0!==ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED!==!1&&"false"!==ZD_IS_NEW_UI_ENABLED){var e={serviceName:t.options.serviceName,resId:t.options.fileId,handback_obj:{},okButtonName:t.options.buttonName,createFolderEnable:!0,showFileNameInHeader:!1,notifySuccessMessage:!0};"zohosheet"===t.options.serviceName?ZDocsMoveTo.openSheetTDMove(e):ZDocsMoveTo.openTDMove(e)}else ZDocsMoveTo.open({allowDuplicateName:t.options.allowDuplicateName,extension:t.options.fileExtension,fileExtension:t.options.fileExtension,fileName:t.options.fileName,fileId:t.options.fileId,dialogTitle:t.options.movetoDialogTitle})})},changeFolderName:function(t,i){e("#ui-zfolfer-"+t+"-li","#ui-zfilefield-folder-tree").find("a").text(i)},changeStatus:function(e,t){"Favourite"===e&&this._changeFavouriteStatus("success",t)},_escapeHTML:function(e){return this._textarea.textContent=e,this._textarea.innerHTML},_showLoader:function(t){e("#"+this._fileTextBox).attr("readonly",t),e("#ui-zfilefield-loader").length||this._renameWrapper.append(e("<div>").attr({id:"ui-zfilefield-loader","class":"ui-zff-loader"}).html('<span class="ui-zfc-loader-circle"><span>')),e("#ui-zfilefield-loader")[t?"show":"hide"]()},_changeFavouriteStatus:function(t,i,s){"success"===t||"inprogress"===t?("favourite"===i?(this._isFavorite=!0,e("#ui-zfilefield-fav span").attr("class","ui-zfc-icon ui-zfc-icon-favourite")):(this._isFavorite=!1,e("#ui-zfilefield-fav span").attr("class","ui-zfc-icon ui-zfc-icon-unfavourite")),this._triggerEvent("favourite"===i?this._EVENTS.ONUNFAVOURITE:this._EVENTS.ONFAVOURITE,s)):"FileAlreadyFavorite"===t?(this._isFavorite=!0,e("#ui-zfilefield-fav span").attr("class","ui-zfc-icon ui-zfc-icon-favourite")):"FileAlreadyUnFavorite"===t&&(this._isFavorite=!1,e("#ui-zfilefield-fav span").attr("class","ui-zfc-icon ui-zfc-icon-unfavourite"));var o=this._isFavorite?"removefavorite.label":"markasfavorite.label";this._resetTooltip(this._favElement),this._favElement.data("title",this._getString(o)).prop("title",this._getString(o))},_getString:function(e,t,i){return ZDocsUtil.getI18NString(i?i:"zfilefield",e,t?t:void 0,this.options.keys)},disable:function(){this._isEnabled=!1,e("#ui-zfilefield-folder-button").hide(),this._renameWrapper.off("mouseenter.zstf mouseleave.zstf"),this._initBodyEvents(!1)},enable:function(){this._isEnabled=!0,this.options.rename&&(this._initMouseEvents(!0),this.options.saveToFolder&&e("#ui-zfilefield-folder-button").show()),this._refresh()},destroy:function(){this.element.empty(),this.element.off(".zfilefield")}};t.registerComponent("zdocsfilefield",i),e.fn.zdocsfilefield.config={keys:{"markasfavorite.label":"Set as Favorite","removefavorite.label":"Remove Favorite","choosefolder.label":"Choose Folder","renamealert.label":"A file with this name already exists. Please choose a different name."}}}(jQuery,ZDocsComponents),function(e,t){function i(){r._text=document.createElement("span"),r._label=document.createElement("label"),r._arrow=document.createElement("i"),r._text.className="zbutton__text",r._arrow.className="zbutton__icon h-floatright"}function s(t){var i=t.tagName?t.tagName:"button",s=document.createElement(i);return s.setAttribute("id",t.id),t.customAttributes&&e(s).attr(t.customAttributes),t.appendTo&&e(t.appendTo)[0].appendChild(s),e(s)[t.componentName](t)}var o={options:{appearance:"normal",text:void 0,icon:void 0,iconClassName:void 0,SVGIconId:void 0,size:"medium",disabled:!1,checked:!1,actionInProgress:!1,progressIndicator:{type:"circular",position:"left",direction:"left-to-right",loadingText:"",value:5,iconClassName:void 0,SVGIconId:void 0},constructButton:!0,className:""},eventPrefix:"zbutton",attributeList:["data-appearance","data-icon","data-text","data-size","data-disabled","disabled","data-action-in-progress","data-progress-indicator"],_EVENTS:{CLICK:"click",CHANGE:"change",STATECHANGE:"statechange"},_create:function(){void 0===r._text&&i(),this.options.icon=this.options.icons&&this.options.icons.primary||this.options.icon,this.options.disabled=this.element[0].disabled,this.options.checked=this.element[0].checked,this.element[0].setAttribute("role","button"),this._baseElement="INPUT"===this.element[0].tagName?this._getLabelElement(this.element):this.element,this.options.constructButton&&this._construct(),this._checkAndDisable(),this._bindEvents()},_construct:function(){if(this.options.text=this.options.text?this.options.text:this.options.label?this.options.label:this.element.text().trim(),this.options.text&&""!==this.options.text){var e=r._text.cloneNode();e.textContent=this.options.text,this._baseElement[0].innerHTML="",this._baseElement[0].appendChild(e)}(this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&this._setIcons(),this._baseElement[0].className+=" zbutton "+("normal"!==this.options.appearance?"zbutton--"+this.options.appearance:"")+" zbutton--"+this.options.size+" "+this.options.className,this._baseElement[0].setAttribute("aria-label",this.options.text?this.options.text:this.element.attr("title"))},_setIcons:function(){if(!this.options.actionInProgress||!this._baseElement.find(".zeffects--rotate").length){this._baseElement.find(".zbutton__mainicon").remove();var t=e("<i class='zbutton__icon zbutton__mainicon '></i>"),i=this._handleIcon(t,void 0,void 0,this.options.iconClassName,this.options.SVGIconId,this.options.icon);this._baseElement.prepend(i),(this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&""===this.options.text&&(this._baseElement[0].className+=" zbutton--icononly")}},_bindEvents:function(){var i=this;if(this._baseElement.on("click.zbutton",function(e){i._baseElement.hasClass("is-disabled")||(ZDocsComponents.Browser.isFirefox()&&i._baseElement.focus(),i.options.actionInProgress&&i.showProgressIndicator(),i._baseElement.is("label")&&i._check(!0,e),i._trigger(i._EVENTS.CLICK,e,{button:i.element,options:i.options}))}),this._input){var i=this;this._baseElement.off("keydown.zbutton").on("keydown.zbutton",function(s){if(s.keyCode===t.keyCode.ENTER||s.keyCode===t.keyCode.SPACE)i.element.trigger("click");else if(s.keyCode===t.keyCode.LEFT||s.keyCode===t.keyCode.DOWN){var o=i._input.attr("name"),n=i._input.prevAll("input[type=radio][name="+o+"]")[0];n||(n=i._input.nextAll("input[type=radio][name="+o+"]:last")),e("label[for='"+e(n).attr("id")+"']").trigger("click").trigger("focus")}else if(s.keyCode===t.keyCode.RIGHT||s.keyCode===t.keyCode.UP){var o=i._input.attr("name");n=i._input.nextAll("input[type=radio][name="+o+"]")[0],n||(n=i._input.prevAll("input[type=radio][name="+o+"]:last")),e("label[for='"+e(n).attr("id")+"']").trigger("click").trigger("focus")}})}window.ZShortCut&&ZShortCut.register(this.element)},_checkAndDisable:function(){this.options.disabled?(this._baseElement.addClass("is-disabled").attr({"aria-disabled":!0}),this._baseElement.attr("disabled")||this._baseElement[0].setAttribute("disabled",!0)):(this._baseElement.removeClass("is-disabled").removeAttr("aria-disabled"),this._baseElement.attr("disabled")&&this._baseElement.removeAttr("disabled")),this._trigger(this._EVENTS.STATECHANGE,{},{button:this.element,options:this.options,disabled:this.options.disabled}),this.options.checked?(this._baseElement.addClass("is-selected").prop("checked",!0).attr("aria-checked",!0),this._input.prop("checked",!0)):(this._baseElement.removeClass("is-selected").removeAttr("checked aria-checked").prop("checked",!1),this._input&&this._input.prop("checked",!1))},_check:function(t,i){if(!this._baseElement.hasClass("is-disabled")){var s=this._input.attr("name"),o=e("input[type=radio][name="+s+"]");t&&"radio"==this._input.attr("type")&&o.each(function(t,i){e(i).prop("checked",!1).next("label").prop("checked",!1),e(i).next(".zbutton").removeClass("is-selected"),e(i).data("zbutton").options.checked=!1}),ZDocsComponents.Browser.isFirefox()&&this._baseElement.focus(),"radio"===this._input.attr("type")?this.options.checked=t:this._baseElement.prop("checked")||!t?this.options.checked=!1:t&&(this.options.checked=t),this._checkAndDisable(),i&&this._trigger(this._EVENTS.CHANGE,i,{button:this.element,options:this.options})}},_getLabelElement:function(t){var i=t.next("label");return i.length||(i=e("<label>").text(this.options.text).insertAfter(t),this._labelCreated=!0),i.attr({"for":t.attr("id"),tabindex:0,"class":t.attr("class"),title:t.attr(t.attr("title")?"title":"data-title"),role:t.attr("type")}),this._input=t.addClass("h-dnone"),i},_createLoaderElement:function(t){var i=e("<i class='zbutton__icon "+("right"!==t||this._baseElement.is(".zbutton--icononly")?"":"h-floatright")+"'></i>");if(this.options.progressIndicator.SVGIconId||this.options.progressIndicator.iconClassName)this._handleIcon(i,void 0,void 0,this.options.progressIndicator.iconClassName,this.options.progressIndicator.SVGIconId);else{var s=ZDocsComponents.createSVGElement("svg",{"class":"zbutton__svg zbutton__loader zeffects--rotate"},[{circle:{"class":"circle__track"}},{circle:{"class":"circle__load"}}]);i[0].appendChild(s)}return i},setProgressValue:function(e){this._progressElement&&(e>100&&(e=100),this._progressElement.css("width",parseInt(e)+"%"),this.options.progressIndicator.value=e)},getProgressValue:function(){return this._progressElement?100*parseFloat(this._progressElement.outerWidth(!0)/(this.element.outerWidth(!0)-2*parseInt(this.element.css("border")))):0},showProgressIndicator:function(t){var i=t&&t.type?t.type:this.options.progressIndicator.type,s=t&&t.position?t.position:this.options.progressIndicator.position,o=t&&t.direction?t.direction:this.options.progressIndicator.direction,n=t&&t.loadingText?t.loadingText:this.options.progressIndicator.loadingText,a=t&&t.value?t.value:this.options.progressIndicator.value;this._baseElement.find(".zbutton__loader").length||("circular"===i?((this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&("left"===s||this._baseElement.is(".zbutton--icononly"))&&this._baseElement.find("i:first").remove(),this._baseElement.prepend(this._createLoaderElement(s))):"linear-bar"===i?(this._progressElement=e("<span class='"+("top"===s?"zbutton__topline":"zbutton__bottomline")+"'/>"),this.setProgressValue(a)):"linear-fill"===i&&(this._progressElement=e("<span class='"+("right-to-left"===o?"zbutton__bgprogress--fromright":"zbutton__bgprogress")+"'/>"),this.setProgressValue(a)),""!==n&&this._baseElement.find(".zbutton__text").text(n),this._baseElement.append(this._progressElement).attr("disabled",!0).addClass("is-disabled zbutton--loading h-transition"),this.options.actionInProgress=!0)},hideProgressIndicator:function(){this._progressElement&&(this._progressElement.remove(),this._progressElement=void 0),this.options.icon||this.options.iconClassName||this.options.SVGIconId?(this._baseElement.find(".zbutton__icon").remove(),this._baseElement.find(".zbutton__icon").length||this._setIcons()):this._baseElement.find(".zbutton__icon").remove(),this._baseElement.removeClass("zbutton--loading h-transition"),this.options.disabled||this._baseElement.removeAttr("disabled").removeClass("is-disabled"),this.options.text?this._baseElement.find(".zbutton__text").text(this.options.text):(this._baseElement.find(".zbutton__text").remove(),(this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&this._baseElement.addClass("zbutton--icononly"))},destroy:function(){return this._super(),this._baseElement.off(".zbutton").empty().removeClass("zbutton zbutton--icononly is-disabled is-selected"),this._baseElement.off(".zbutton"),this._input&&(this._input.removeClass("h-dnone").removeData("zbutton"),this._input=void 0,this._labelCreated&&this._baseElement.remove()),this.element.text(this.options.text).removeData("zbutton")},setAttribute:function(t,i){if("appearance"===t&&i!==this.options.appearance)this._baseElement.removeClass("zbutton--"+this.options.appearance).addClass("zbutton--"+i);else if("text"!==t&&"label"!==t&&"data-text"!==t||i===this.options.text)if("size"!==t&&"data-size"!==t||i===this.options.size)if("disabled"===t&&this.options.disabled!==i)"string"==typeof i&&(i="true"===i||"disabled"===i),this.options.disabled=i,this._checkAndDisable();else if("icon"!==t&&"data-icon"!==t&&"iconClassName"!==t&&"SVGIconId"!==t||i===this.options[t]){if("checked"===t&&i!==this.options.checked)this._input&&this._check(i,void 0);else if("actionInProgress"===t&&i!==this.options.actionInProgress)this.options[t]=i,i?this.showProgressIndicator():this.hideProgressIndicator();else if("progressIndicator"===t&&this.options.actionInProgress){var s=this.options,o=e.extend({},this.options.progressIndicator,i);s.progressIndicator=o,this.destroy(),this.element.zbutton(s),this.showProgressIndicator()}}else(this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&this._baseElement.find("i:first").remove(),this.options[t]=i,i&&this._setIcons();else this.options.size&&this._baseElement.removeClass("zbutton--"+this.options.size),this._baseElement.addClass("zbutton--"+i);else if(this.options.text&&""!==this.options.text)this.options.actionInProgress||(i&&""!==i?this._baseElement.find(".zbutton__text").text(i):(this._baseElement.find(".zbutton__text").remove(),this._baseElement.find("i").length&&(this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&this._baseElement.addClass("zbutton--icononly")));else{var n=e("<span class='zbutton__text'>"+i+"</span>");this.options.actionInProgress||(this._baseElement.find("i").length&&(this.options.icon||this.options.iconClassName||this.options.SVGIconId)?n.insertAfter(this._baseElement.find(".zbutton__icon:first")):n[this._baseElement.find("i").length?"prependTo":"appendTo"](this._baseElement),this._baseElement.removeClass("zbutton--icononly"))}this.options[t]=i}},n={options:{menuId:void 0,delay:0,showArrowIcon:!0,arrowIconClassName:void 0,arrowSVGIconId:void 0,activeClass:"is-selected"},eventPrefix:"zdmenubutton",_construct:function(){this._super(),this.element[0].className+=" zbutton--menu",this.element[0].setAttribute("aria-haspopup",!0);var t=r._arrow.cloneNode();if(this.options.showArrowIcon){var i=this.options.splitbutton?"zbutton__svg zbutton__splitarrow":"zbutton__svg zbutton__menuarrow",s={props:{"class":i,viewBox:"0 0 48 48",width:"100%",height:"100%"},nodes:[{path:{"class":"cls-1",d:"M12,19.478L15.571,16l9.286,9.739L34.143,16,37,19.478,24.857,32Z"}}]};this._handleIcon(e(t),s,"arrow",this.options.arrowIconClassName,this.options.arrowSVGIconId),this.element[0].appendChild(t)}},destroy:function(){this._super(),this.element.off(".zdmenubutton").removeClass("zbutton--menu").removeData("zdmenubutton").removeAttr("aria-haspopup")},_bindEvents:function(){var i=this;this.element.on("mousedown.zdmenubutton",function(){i.element.hasClass("is-disabled")||(i.element.focus(),i.options.menuId&&e.fn.zmenu&&(i.options.delay?window.setTimeout(function(){i._showHideMenu()},i.options.delay):i._showHideMenu()))}).on("click.zdmenubutton",function(e){i._trigger(i._EVENTS.CLICK,e,{button:i.element,options:i.options})}).on("keydown.zdmenubutton",function(s){(s.keyCode===t.keyCode.DOWN||s.keyCode===t.keyCode.ENTER||s.keyCode===t.keyCode.SPACE)&&i.options.menuId&&e.fn.zmenu&&(i._showHideMenu(),s.preventDefault(),s.stopPropagation())}),window.ZShortCut&&ZShortCut.register(this.element)},_showHideMenu:function(){var i=this;!e("#"+i.options.menuId).is(":visible")||i.options.splitbutton&&e("#"+i.options.menuId).data("forElement")&&e("#"+i.options.menuId).data("forElement")[0]!==i.element.closest(".zbutton--split").get(0)||!i.options.splitbutton&&e("#"+i.options.menuId).data("forElement")&&e("#"+i.options.menuId).data("forElement")[0]!==i.element.get(0)?(e(".zmenu").zmenu("hide"),e("#"+i.options.menuId).on("zmenuhide",function(e){!i.options.splitbutton&&e.originalEvent&&i.element.focus(),i.element.removeClass(i.options.activeClass)}),e("#"+i.options.menuId).zmenu(),e("#"+i.options.menuId).zmenu("show",{forElement:i.options.splitbutton?i.element.closest(".zbutton--split"):i.element}),i.element.addClass(i.options.activeClass),t.$window.on("resize.zdmenubutton",function(){e(".zmenu").zmenu("hide")})):(i.element.removeClass(i.options.activeClass),e("#"+i.options.menuId).zmenu("hide"),t.$document.off("click.zdmenubutton"))}},a={_initialShow:!0,attributeList:["data-appearance","data-icon","data-text","data-size","data-disabled","disabled","data-menu-id"],options:{size:"medium",disabled:!1,updateButtonOnMenuItemClick:!0},_create:function(t,i){var s=t.attr("id"),o=void 0,n=void 0,a=document.createElement("div");this.splitPair=a,a.setAttribute("class","zbutton--split "+i.className),a.setAttribute("role","splitbutton"),"primary"!==i.appearance&&(a.className+=" zbutton--splitnormal"),s&&(a.setAttribute("id",s+"Container"),o=s+"DropDown"),t[0].parentNode.insertBefore(a,t[0]),!i.menuId&&e(t).next().length&&"BUTTON"===e(t).next()[0].tagName?n=e(t).next()[0]:(n=document.createElement("button"),n.setAttribute("id",o)),this.menuButton=n,n.setAttribute("class","zbutton--icononly");var r={appearance:i.appearance,size:i.size,disabled:void 0!==i.disabled?i.disabled:!1,delay:i.delay,splitbutton:!0,showArrowIcon:i.showArrowIcon,arrowIconClassName:i.arrowIconClassName,arrowSVGIconId:i.arrowSVGIconId};a.appendChild(t[0]),a.appendChild(n),i.menuId&&n.setAttribute("data-menu-id",i.menuId),t.disabled&&n.setAttribute("disabled",!0),i.splitbuttonAttributes&&e(n).attr(i.splitbuttonAttributes),i.appData&&(r.appData=i.appData),t.removeAttr("data-menu-id"),i.className="",t.zbutton(i),this.element=t,e(n).zdmenubutton(r),this.options=i,this._bindEvents()},_bindEvents:function(){var t=this;this.element.off("click.zbutton"),e(this.splitPair).off("click.zbutton").on("click.zsplitbutton",function(i){var s=e(i.target).closest(".zbutton"),o={options:t.options};s.hasClass("zbutton--menu")?o.isMenuButton=!0:(t.element.focus(),e.fn.zmenu&&e("#"+t.options.menuId).zmenu("hide")),o.element=t.element,o.dropdownButton=e(t.menuButton),t._trigger("click",i,o)}),window.ZShortCut&&(ZShortCut.register(this.element),ZShortCut.register(e(this.menuButton))),e("#"+this.options.menuId).on("zmenubeforeshow",function(){t.options.updateButtonOnMenuItemClick&&t._initialShow?t._hideMenuItem(t.options.menuId,!0):e.noop}),e("#"+this.options.menuId).on("zmenushow",function(i,s){if(e("#"+t.options.menuId).data("forElement")[0]==t.menuButton[0]){var o=s.menu.attr("class");o.match("top")?(t.element.css("border-bottom-left-radius",window.getComputedStyle(t.splitPair,null).borderBottomLeftRadius),e(t.menuButton).css("border-bottom-right-radius",window.getComputedStyle(t.splitPair,null).borderBottomRightRadius)):o.match("bottom")&&(t.element.css("border-top-left-radius",window.getComputedStyle(t.splitPair,null).borderTopLeftRadius),e(t.menuButton).css("border-top-right-radius",window.getComputedStyle(t.splitPair,null).borderTopRightRadius)),t._initialShow=!1}}).on("zmenuhide",function(){t.element.css({"border-bottom-left-radius":"","border-top-left-radius":"","border-bottom-right-radius":"","border-top-right-radius":""}),e(t.menuButton).css({"border-bottom-right-radius":"","border-top-right-radius":"","border-top-left-radius":"","border-bottom-left-radius":""})}),this.options.updateButtonOnMenuItemClick&&e("#"+this.options.menuId).on("zmenuitemclick",function(i,s){var o=s.menu.data("zmenu").options,n=o.contentType,a=(t.options.icon||t.options.iconClassName||t.options.SVGIconId)&&t.element.data("zbutton").options.text?"icon-text":t.options.icon||t.options.iconClassName||t.options.SVGIconId?"icon":"text";n===a&&(t._hideMenuItem(t.options.menuId,!1),e("#"+t.options.menuId).zmenu("hideMenuItems",[s.menuitem]),(t.options.icon||t.options.iconClassName||t.options.SVGIconId)&&t.setAttribute("icon",s.data.icon),t.element.data("zbutton").options.text&&t.setAttribute("text",s.data.label),t._trigger("change",i,s))})},_hideMenuItem:function(t,i){for(var s=e("#"+t),o=this.element.data("zbutton").options.text,n=this.options.icon||this.options.iconClassName||this.options.SVGIconId,a=s.find("li"),r=0;r<a.length;r++){var l=this.getData(a[r]),d=l.icon&&n?l.icon===n:!0,c=l.label&&o?l.label===o:!0;d&&c&&(i?s.zmenu("hideMenuItems",[a[r]]):s.zmenu("showMenuItems",[a[r]]))}},getElement:function(){return e(this.splitPair)},setAttribute:function(t,i){return("disabled"===t||"menuId"===t||"data-menu-id"===t||"size"===t||"data-size"===t||"appearance"===t||"data-appearance"===t&&this.options[t]!==i)&&(e(this.menuButton).zdmenubutton("setAttribute",t,i),"appearance"===t&&e(this.splitPair)["primary"===i?"removeClass":"addClass"]("zbutton--splitnormal")),this.options[t]=i,this.element.zbutton("object"==typeof t?"setAttributes":"setAttribute",t,i)},destroy:function(){this._super(),e(this.menuButton).remove(),this.element.unwrap().zbutton("destroy").removeData("zsplitbutton")}},r={};t.createButton=function(e){return e.componentName="zbutton",s(e)},t.createSplitbutton=t.createSplitButton=function(e){return e.componentName="zsplitbutton",s(e)},t.createMenubutton=t.createMenuButton=function(e){return e.componentName="zdmenubutton",s(e)},t.createUploadbutton=t.createUploadButton=function(e){return e.componentName="zuploadbutton",e.tagName="input",e.customAttributes=e.customAttributes?e.customAttributes:{},e.customAttributes.type="file",s(e)},t.registerComponent("zbutton",o),t.registerComponent("zdmenubutton",e.zbutton,n),t.registerComponent("zsplitbutton",e.zbutton,a)}(jQuery,ZDocsComponents),function(e){var t={eventPrefix:"zscroll",options:{dynamicDimensions:!1,top:void 0,left:void 0,scrollIncrement:55,showScrollBarOnHover:!1,showScrollBarAlways:!1,disappearDelay:1200,animateHide:!0},_EVENTS:{SCROLL:"scroll",SCROLLXEND:"scrollxend",SCROLLYEND:"scrollyend",SCROLLEND:"scrollend"},_create:function(){ZDocsComponents.specialMouseWheelHandler(),this._initialize(),this.options.dynamicDimensions&&ZDocsComponents.scrollBindings.push(this.element)},_initialize:function(){if(this._minScrollBarSize=35,void 0===this._pane?this._originalPadding=this.element.css("paddingTop")+" "+this.element.css("paddingRight")+" "+this.element.css("paddingBottom")+" "+this.element.css("paddingLeft"):this.element.css("padding",this._originalPadding),this._elementOverflowCSS=this.element.css("overflow"),this._elementWidth=this.element.width(),this._elementHeight=this.element.height(),this._paneWidth=this.element.innerWidth(),this._paneHeight=this.element.innerHeight(),"UL"!==this.element[0].tagName){if(this.element.addClass("zscroll"),void 0!==this._pane&&"none"!==this.element.css("max-height")&&void 0!==this.element.css("max-height")){var t=parseInt(this.element.css("max-height"));this._paneHeight=this.element.find(".zscroll__content").innerHeight(),this._paneHeight>t&&(this._paneHeight=t),this._paneWidth=this.element.find(".zscroll__content").innerWidth()}this.element.width(this._paneWidth).height(this._paneHeight)}else this._isUL=!0,this.element.css("overflow","visible");if(void 0===this._pane&&(this._outerPane=e('<div class="zscroll__container"/>'),this._isUL&&(this._parentElement=e("<div>"),elementParent=this.element.parent(),this.element.appendTo(this._parentElement),this._parentElement.appendTo(elementParent).addClass("zscroll").width(this._paneWidth).height(this._paneHeight)),this._pane=e('<div class="zscroll__content" />').css("padding",this._originalPadding).append(this._isUL?this._parentElement.children():this.element.children()).appendTo(this._outerPane),this._outerPane.appendTo(this._isUL?this._parentElement:this.element),(ZDocsComponents.Browser.isFirefox()||ZDocsComponents.Browser.isIE())&&this._pane.css("padding-bottom","0px")),this._outerPane.css({width:this._paneWidth,height:this._paneHeight}),this._pane.width(this._elementWidth),this._pane.css("overflow","auto"),this._contentWidth=this._pane[0].scrollWidth,this._contentHeight=this._pane[0].scrollHeight,this._isUL&&(this._contentHeight!==this.element[0].scrollHeight&&(this._contentHeight=this.element[0].scrollHeight),this._contentWidth!==this.element[0].scrollWidth&&(this._contentWidth=this.element[0].scrollWidth)),this._pane.css("overflow",""),this._percentInViewX=this._contentWidth/this._paneWidth,this._percentInViewY=this._contentHeight/this._paneHeight,this._horizontal=this._percentInViewX>1,this._vertical=this._percentInViewY>1,this._handleScrollYTrack(),this._handleScrollXTrack(),this._bindEvents(),this._maxScrollY=this._contentHeight-this._paneHeight,this._maxScrollX=this._contentWidth-this._paneWidth,this._vertical&&this._finalVerValue){var i,s=-this._pane.position().top,i=s/this._maxScrollY;this._scrollPosY(void 0,i*this._maxDragY)}if(this._horizontal&&this._finalHorValue){var i,s=-this._pane.position().left,i=s/this._maxScrollX;this._scrollPosX(void 0,i*this._maxDragX)}},_handleScrollYTrack:function(){this._vertical?(void 0===this._verticalTrack&&(this._verticalTrack=e("<div class='zscroll__track--v'>"),this._verticalBar=e("<div class='zscroll__thumb zscroll__thumb--v'>").appendTo(this._verticalTrack),this._verticalTrack.appendTo(this._outerPane)),this._setVerticalScrollSize()):void 0!==this._verticalTrack&&(this._verticalTrack.remove(),this._verticalBar.remove(),this._verticalTrack=this._verticalBar=this._finalVerValue=void 0,this._pane.css("top","0px"))},_handleScrollXTrack:function(){this._horizontal?(void 0===this._horizontalTrack&&(this._horizontalTrack=e("<div class='zscroll__track--h'>"),this._horizontalBar=e("<div class='zscroll__thumb zscroll__thumb--h'>").appendTo(this._horizontalTrack),this._horizontalTrack.appendTo(this._outerPane)),this._setHorScrollSize()):void 0!==this._horizontalTrack&&(this._horizontalTrack.remove(),this._horizontalBar.remove(),this._horizontalTrack=this._horizontalBar=this._finalHorValue=void 0,this._pane.css("left","0px"))},_setVerticalScrollSize:function(){this._verticalTrack&&(this._verticalBarHeight=Math.ceil(1/this._percentInViewY*this._paneHeight),this._verticalBarHeight<this._minScrollBarSize&&(this._verticalBarHeight=this._minScrollBarSize),this._verticalTrack.css("height",this._paneHeight),this._maxDragY=this._paneHeight-this._verticalBarHeight,this._verticalBar.css("height",this._verticalBarHeight),this.options.showScrollBarAlways&&this._verticalBar.show())},_setHorScrollSize:function(){this._horizontalTrack&&(this._horizontalBarWidth=Math.ceil(1/this._percentInViewX*this._paneWidth),this._horizontalBarWidth<this._minScrollBarSize&&(this._horizontalBarWidth=this._minScrollBarSize),this._horizontalTrack.css("width",this._paneWidth),this._maxDragX=this._paneWidth-this._horizontalBarWidth,this._horizontalBar.css("width",this._horizontalBarWidth),this.options.showScrollBarAlways&&this._horizontalBar.show())},_getScrollbarWidth:function(){if(!this._defaultScrollbarWidth){var t=e("<div>").css({width:"100px",height:"100px",overflow:"scroll"}).appendTo("body");this._defaultScrollbarWidth=t.width()-t[0].scrollWidth,t.remove()}return this._defaultScrollbarWidth},_bindEvents:function(){var t,i,s=this;this._scrollX=!1,this._scrollY=!1,this._outerPane.off("mousewheel."+this.eventPrefix).on("mousewheel."+this.eventPrefix,function(e,o,n,a){!s._vertical||0===t&&t===-0&&0===a||0!==i&&i!==-0&&void 0!==i||(t=a,s.options.showScrollBarAlways||(s._verticalBar&&s._verticalBar.show(),s._horizontalBar&&!s.options.showScrollBarOnHover&&s._horizontalBar.hide()),s._scrollY=!0,s._scrollX=!1),!s._horizontal||0===i&&i===-0&&0===n||0!==t&&t!==-0&&void 0!==t||(i=n,s.options.showScrollBarAlways||(s._horizontalBar&&s._horizontalBar.show(),s._verticalBar&&!s.options.showScrollBarOnHover&&s._verticalBar.hide()),s._scrollX=!0,s._scrollY=!1);var r=e.deltaFactor;s._prevHorPosition||(s._prevHorPosition=0),s._prevVerPosition||(s._prevVerPosition=0);var l=s._prevHorPosition,d=s._prevVerPosition;return s._scrollContent(e,n*r,-a*r),l===s._prevHorPosition&&d===s._prevVerPosition}),this._outerPane.off("mouseenter."+this.eventPrefix).on("mouseenter."+this.eventPrefix,function(){s._refresh(),e("body").addClass("h-overflowhidden"),s._mouseLeave=!1,s.options.showScrollBarOnHover&&(s._horizontalBar&&s._horizontalBar.show(),s._verticalBar&&s._verticalBar.show())}).off("mouseleave."+this.eventPrefix).on("mouseleave."+this.eventPrefix,function(){e("body").removeClass("h-overflowhidden"),s._mouseLeave=!0,s.options.showScrollBarOnHover&&(s._removeVerticalTrackSettings(),s._removeHorizontalTrackSettings())}),this._verticalBar&&this._verticalBar.off("mousedown."+this.eventPrefix).on("mousedown."+this.eventPrefix,function(e){e.preventDefault(),e.stopPropagation(),s._startY=e.pageY-s._verticalBar.position().top,s._mousedown=!0,ZDocsComponents.$document.off("mousemove."+s.eventPrefix).on("mousemove."+s.eventPrefix,function(e){e.preventDefault(),s._animate=!1,s._scrollPosY(e,e.pageY-s._startY)}).off("mouseup."+s.eventPrefix).on("mouseup."+s.eventPrefix,function(e){e.preventDefault(),s._mousedown=!1,ZDocsComponents.$document.off("mouseup."+s.eventPrefix+" mousemove."+s.eventPrefix+" mousedown."+s.eventPrefix)})}),this._horizontalBar&&this._horizontalBar.off("mousedown."+this.eventPrefix).on("mousedown."+this.eventPrefix,function(e){e.preventDefault(),s._startX=e.pageX-s._horizontalBar.position().left,s._mousedown=!0,ZDocsComponents.$document.off("mousemove."+s.eventPrefix).on("mousemove."+s.eventPrefix,function(e){e.preventDefault(),s._animate=!1,s._scrollPosX(e,e.pageX-s._startX)}).off("mouseup."+s.eventPrefix).on("mouseup."+s.eventPrefix,function(e){e.preventDefault(),s._mousedown=!1,ZDocsComponents.$document.off("mouseup."+s.eventPrefix+" mousemove."+s.eventPrefix+" mousedown."+s.eventPrefix)})}),this._verticalTrack&&this._verticalTrack.off("mousedown."+this.eventPrefix).on("mousedown."+this.eventPrefix,function(e){if(s._verticalBar.is(":visible")||s._defaultScrollbarWidth>0){var t,i=s._verticalTrack.offset(),o=e.pageY-i.top-s._finalVerValue;t=e.pageY-i.top-s._verticalBarHeight/2;var n=o>0?s._finalVerValue+s.options.scrollIncrement:s._finalVerValue-s.options.scrollIncrement;s._animate=!0,o>0?t>n?s._scrollPosY(e,n):s._scrollPosY(e,t):n>t?s._scrollPosY(e,n):s._scrollPosY(e,t)}}).off("mouseenter."+this.eventPrefix).on("mouseenter."+this.eventPrefix,function(){s._addVerticalTrackSettings()}).off("mouseleave."+this.eventPrefix).on("mouseleave."+this.eventPrefix,function(){s._removeVerticalTrackSettings()}),this._horizontalTrack&&this._horizontalTrack.off("mousedown."+this.eventPrefix).on("mousedown."+this.eventPrefix,function(e){if(s._horizontalBar.is(":visible")||s._defaultScrollbarWidth>0){var t,i=s._horizontalTrack.offset(),o=e.pageX-i.left-s._finalHorValue;t=e.pageX-i.left-s._horizontalBarWidth/2;var n=o>0?s._finalHorValue+s.options.scrollIncrement:s._finalHorValue-s.options.scrollIncrement;s._animate=!0,o>0?t>n?s._scrollPosX(e,n):s._scrollPosX(e,t):n>t?s._scrollPosX(e,n):s._scrollPosX(e,t)}}).off("mouseenter."+this.eventPrefix).on("mouseenter."+this.eventPrefix,function(){s._addHorizontalTrackSettings()}).off("mouseleave."+this.eventPrefix).on("mouseleave."+this.eventPrefix,function(){s._removeHorizontalTrackSettings()})},_removeHorizontalTrackSettings:function(){var e=this;clearTimeout(this._removeHTimeout),this._removeHTimeout=setTimeout(function(){!e._mousedown&&e._horizontal&&e._horizontalBar&&e._horizontalBar.is(":visible")&&(e._horizontalTrack.removeClass("zscroll__handler--hover zscroll__handler--hoverh"),e._horizontalBar.removeClass("zscroll__thumb--hoverh h-scrollhorheight"),!e.options.showScrollBarAlways&&!e.options.showScrollBarOnHover&&(e.options.animateHide?e._horizontalBar.fadeOut():e._horizontalBar.hide()),e.options.showScrollBarOnHover&&e._mouseLeave&&(e.options.animateHide?e._horizontalBar.fadeOut():e._horizontalBar.hide()))},this.options.disappearDelay)},_removeVerticalTrackSettings:function(){var e=this;clearTimeout(this._removeVTimeout),this._removeVTimeout=setTimeout(function(){!e._mousedown&&e._vertical&&e._verticalBar&&e._verticalBar.is(":visible")&&(e._verticalTrack.removeClass("zscroll__handler--hover zscroll__handler--hoverv"),e._verticalBar.removeClass("zscroll__thumb--hoverv h-scrollverheight"),!e.options.showScrollBarAlways&&!e.options.showScrollBarOnHover&&(e.options.animateHide?e._verticalBar.fadeOut():e._verticalBar.hide()),e.options.showScrollBarOnHover&&e._mouseLeave&&(e.options.animateHide?e._verticalBar.fadeOut():e._verticalBar.hide()))},this.options.disappearDelay)},_addVerticalTrackSettings:function(){clearTimeout(this._removeVTimeout),this._vertical&&this._verticalBar&&this._verticalBar.is(":visible")&&(this._verticalTrack.addClass("zscroll__handler--hover zscroll__handler--hoverv"),this._verticalBar.addClass("zscroll__thumb--hoverv h-scrollverheight"))},_addHorizontalTrackSettings:function(){clearTimeout(this._removeHTimeout),this._horizontal&&this._horizontalBar&&this._horizontalBar.is(":visible")&&(this._horizontalTrack.addClass("zscroll__handler--hover zscroll__handler--hoverh"),this._horizontalBar.addClass("zscroll__thumb--hoverh h-scrollhorheight"))},_scrollContent:function(e,t,i){this._horizontal&&this._scrollHorContent(e,t),this._vertical&&this._scrollVerContent(e,i)},_scrollHorContent:function(e,t){if(this._scrollY===!0)return!1;var i,s=-this._pane.position().left+Math[0>t?"floor":"ceil"](t);i=s/this._maxScrollX,this._scrollPosX(e,i*this._maxDragX)},_scrollPosX:function(e,t){this._horizontalBar&&(0>t?(t=0,e&&e.preventDefault()):t>this._maxDragX&&(t=this._maxDragX,e&&e.preventDefault()),this._animate?this._horizontalBar.animate({left:t},100,"swing"):this._horizontalBar.css("left",t),this.options.left=t,this._removeHorizontalTrackSettings(),this._finalHorValue=t,this._positionX(e,t))},_positionX:function(e,t){this._prevHorPosition=t||0;var i=t/this._maxDragX,s=-i*this._maxScrollX;this._pane.css("left",s),this._triggerEvent(this._EVENTS.SCROLL,e,{scrollBarPos:t,scrollLeft:-s}),this._positionXEnded=t!==this._maxDragX?!1:this._positionXEnded,this._triggerEvent(this._EVENTS.SCROLLEND,e,{scrollBarPos:t,scrollLeft:-s}),t!==this._maxDragX||this._positionXEnded||(this._positionXEnded=!0,this._triggerEvent(this._EVENTS.SCROLLXEND,e,{scrollBarPos:t,scrollLeft:-s}))},_scrollVerContent:function(e,t){if(this._animate=!1,this._scrollX===!0)return!1;var i,s;i=-this._pane.position().top+Math[0>t?"floor":"ceil"](t),s=i/this._maxScrollY,this._scrollPosY(e,s*this._maxDragY)},_scrollPosY:function(e,t){if(this._verticalBar){this._finalVerValue=t,0>t?(t=0,e&&e.preventDefault()):t>this._maxDragY&&(t=this._maxDragY,e&&e.preventDefault()),this._finalVerValue=t,this._prevVerPosition=t||0;var i=t/this._maxDragY,s=-i*this._maxScrollY,o=this._triggerEvent(this._EVENTS.SCROLL,e,{scrollBarPos:t,scrollTop:-s,scroll:"vertical",maxScrollValue:this._maxDragY});o&&(this.options.top=t,this._animate?this._verticalBar.animate({top:t},100,"swing"):this._verticalBar.css("top",t),this._pane.css("top",s),this._removeVerticalTrackSettings()),this._positionYEnded=t!==this._maxDragY?!1:this._positionYEnded,this._triggerEvent(this._EVENTS.SCROLLEND,e,{scrollBarPos:t,scrollTop:-s,scroll:"vertical"}),t!==this._maxDragY||this._positionYEnded||(this._positionYEnded=!0,this._triggerEvent(this._EVENTS.SCROLLYEND,e,{scrollBarPos:t,scrollTop:-s,scroll:"vertical"}))}},_refresh:function(){if(this.element.css({width:"",height:""}),this._getScrollbarWidth(),this._elementWidth=this.element.width(),this._paneWidth=this.element.innerWidth(),this._paneHeight=this.element.innerHeight(),this._isUL?this._parentElement.css({width:this._paneWidth,height:this._paneHeight}):this.element.css({width:this._paneWidth,height:this._paneHeight}),this._outerPane.css({width:this._paneWidth,height:this._paneHeight}),this._percentInViewX=this._contentWidth/this._paneWidth,this._percentInViewY=this._contentHeight/this._paneHeight,this._horizontal=this._percentInViewX>1,this._vertical=this._percentInViewY>1,this._contentWidth=this._pane[0].scrollWidth,this._contentHeight=this._pane[0].scrollHeight,this._isUL&&(this._contentHeight!==this.element[0].scrollHeight&&(this._contentHeight=this.element[0].scrollHeight),this._contentWidth!==this.element[0].scrollWidth&&(this._contentWidth=this.element[0].scrollWidth)),this._handleScrollYTrack(),this._handleScrollXTrack(),this._maxScrollY=this._contentHeight-this._paneHeight,this._maxScrollX=this._contentWidth-this._paneWidth,this._finalVerValue&&this._vertical){var e,t=-this._pane.position().top,e=t/this._maxScrollY;this._scrollPosY(void 0,e*this._maxDragY)}else this._finalVerValue&&!this._vertical&&(this._verticalBar.hide(),this._finalVerValue=void 0);if(this._horizontal&&this._finalHorValue){var e,t=-this._pane.position().left,e=t/this._maxScrollX;this._scrollPosX(void 0,e*this._maxDragX)}else this._finalHorValue&&!this._horizontal&&(this._horizontalBar.hide(),this._finalHorValue=void 0)},_reinitialize:function(){var e="UL"===this.element[0].tagName?this._parentElement:this.element;e.css({width:"",height:""});var t=e.find(".zscroll__content").innerHeight(),i=e.find(".zscroll__content").innerWidth();this._hasDimensionsChanged=t!==this._paneHeight||i!==this._paneWidth,this._hasDimensionsChanged?this._initialize():e.css({width:this._paneWidth,height:this._paneHeight})},_resetScrollPosition:function(){this._pane.css({top:"0px",left:"0px"}),this._horizontal&&this._horizontalBar.css("left","0px"),this._vertical&&this._verticalBar.css("top","0px")},_triggerEvent:function(e,t,i){var s={scroll:this.element,value:i};return this._trigger(e,t,s)},reinitialize:function(){this._reinitialize()},refresh:function(){this._refresh()},resetScrollPosition:function(){this._resetScrollPosition()},setAttribute:function(e,t){this.options[e]=t,"top"===e?this._scrollPosY(void 0,t):"left"===e&&this._scrollPosX(void 0,t)},destroy:function(){this.element.removeData(this.eventPrefix),this.element.find(".zscroll__content").children().unwrap(),this.element.find(".zscroll__container").children().unwrap(),this.element.removeClass("zscroll"),this.element.css({padding:this._originalPadding,overflow:this._elementOverflowCSS,width:"",height:""}),this.element.off("."+this.eventPrefix),ZDocsComponents.$document.off("."+this.eventPrefix),this._pane.remove(),this._outerPane.remove(),this._outerPane=this._pane=void 0,this._removeHTimeout&&clearTimeout(this._removeHTimeout),this._removeVTimeout&&clearTimeout(this._removeVTimeout),this._horizontal&&(this._horizontalBar.remove(),this._horizontalTrack.remove(),this._horizontalTrack=this._horizontalBar=void 0),this._vertical&&(this._verticalBar.remove(),this._verticalTrack.remove(),this._verticalTrack=this._verticalBar=void 0)}};ZDocsComponents.registerComponent("zscroll",t),ZDocsComponents.scrollBindings=[],ZDocsComponents.nullLowestDeltaTimeout=void 0,ZDocsComponents.lowestDelta=void 0,ZDocsComponents.specialMouseWheelHandler=function(){var t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],i="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(e.event.fixHooks)for(var s=t.length;s>=0;s--)e.event.fixHooks[t[s]]=e.event.mouseHooks;ZDocsComponents.mouseSpecial=e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=i.length;t>=0;t--)this.addEventListener(i[t],ZDocsComponents.mouseWheelHandler,!1);else this.onmousewheel=ZDocsComponents.mouseWheelHandler;e.data(this,"mousewheel-line-height",ZDocsComponents.mouseSpecial.getLineHeight(this)),e.data(this,"mousewheel-elem-height",ZDocsComponents.mouseSpecial.getElementHeight(this))},getElementHeight:function(t){return e(t).height()},getLineHeight:function(t){var t=e(t),i=t["offsetParent"in e.fn?"offsetParent":"parent"]();return i.length||(i=e("body")),parseInt(i.css("fontSize"),10)||parseInt(t.css("fontSize"),10)||16},teardown:function(){if(this.removeEventListener)for(var t=i.length;t>=0;t--)this.removeEventListener(i[t],ZDocsComponents.mouseWheelHandler,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-elem-height")},settings:{adjustOldDeltas:!0,normalizeOffset:!0}}},ZDocsComponents.shouldAdjustOldDeltas=function(e,t){return ZDocsComponents.mouseSpecial.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0},ZDocsComponents.mouseWheelHandler=function(t){var i=t||window.event,s=Array.prototype.slice.call(arguments,1),o=0,n=0,a=0,r=0,l=0,d=0;if(t=e.event.fix(i),t.type="mousewheel","detail"in i&&(a=-1*i.detail),"wheelDelta"in i&&(a=i.wheelDelta),"wheelDeltaY"in i&&(a=i.wheelDeltaY),"wheelDeltaX"in i&&(n=-1*i.wheelDeltaX),o=0===a?n:a,"deltaY"in i&&(a=-1*i.deltaY,o=a),"deltaX"in i&&(n=i.deltaX,0===a&&(o=-1*n)),0!==a||0!==n){if(1===i.deltaMode){var c=e.data(this,"mousewheel-line-height");o*=c,a*=c,n*=c}else if(2===i.deltaMode){var p=e.data(this,"mousewheel-elem-height");o*=p,a*=p,n*=p}if(r=Math.max(Math.abs(a),Math.abs(n)),(!ZDocsComponents.lowestDelta||r<ZDocsComponents.lowestDelta)&&(ZDocsComponents.lowestDelta=r,ZDocsComponents.shouldAdjustOldDeltas(i,r)&&(ZDocsComponents.lowestDelta/=40)),ZDocsComponents.shouldAdjustOldDeltas(i,r)&&(o/=40,n/=40,a/=40),o=Math[o>=1?"floor":"ceil"](o/ZDocsComponents.lowestDelta),n=Math[n>=1?"floor":"ceil"](n/ZDocsComponents.lowestDelta),a=Math[a>=1?"floor":"ceil"](a/ZDocsComponents.lowestDelta),ZDocsComponents.mouseSpecial.settings.normalizeOffset&&this.getBoundingClientRect){var h=this.getBoundingClientRect();l=t.clientX-h.left,d=t.clientY-h.top}return t.deltaX=n,t.deltaY=a,t.deltaFactor=ZDocsComponents.lowestDelta,t.offsetX=l,t.offsetY=d,t.deltaMode=0,s.unshift(t,o,n,a),ZDocsComponents.nullLowestDeltaTimeout&&clearTimeout(ZDocsComponents.nullLowestDeltaTimeout),ZDocsComponents.nullLowestDeltaTimeout=setTimeout(ZDocsComponents.nullLowestDelta,200),(e.event.dispatch||e.event.handle).apply(this,s)}},ZDocsComponents.nullLowestDelta=function(){ZDocsComponents.lowestDelta=null},ZDocsComponents.$window.on("resize.zscroll",function(){clearTimeout(ZDocsComponents.scrollBindTimeout),ZDocsComponents.scrollBindings&&(ZDocsComponents.scrollBindTimeout=setTimeout(function(){for(var t=0;t<ZDocsComponents.scrollBindings.length;t++)e(ZDocsComponents.scrollBindings[t]).zscroll("reinitialize")},0))})}(jQuery);var ZFileExplorer=function(e){var t=void 0,s="",o=1,n={keys:{"readonly.label":"Read Only","savein.label":"Location:","nofoldersfound.label":"No Folders Found","newfolderbutton.label":"New Folder","newfoldername.label":"Untitled Folder","foldername.label":"Folder Name","folderalert.label":"A folder with this name already exists. Please choose a different name.","permissionerrorfolder.label":"Cannot create a folder. Your permission has been changed.","unknownerrorfolder.label":"Unable to create folder due to an unknown error.","myfolders.label":"My Folders","sharedfolders.label":"Shared with Me"},fileId:void 0,canCreateFolder:!0},a={docs:"WR",writer:"WR",zohosheet:"ST",spreadsheet:"ST",zohoshow:"SW",presentation:"SW"},r=!1,l={folderId:void 0,myFolderId:void 0,parentId:void 0,myFolderTree:void 0,sharedWithMe:void 0,currentPath:void 0,recentFolders:void 0,isOwner:void 0},d={widgetEventPrefix:"zfileexplorer",_EVENTS:{ONSELECT:"select",ONAFTERINIT:"afterinit"},_init:function(t){o=1,this.options=e.extend({},n,t),this._createMainContainer()},_createMainContainer:function(){this._category={myFolder:{id:"ui-folder-myfolder",label:this._getString("myfolders.label"),iconClass:"zsaveas zsaveas-folder"},sharedFolder:{id:"ui-folder-sharedfolder",label:this._getString("sharedfolders.label"),iconClass:"zsaveas zsaveas-shared-withme"}};var t=this,i=this.options.renderTo?"#"+this.options.renderTo:"body";this._fileexplorer=e("<div>").attr({id:"ui-zfileexplorer","class":"ui-zfileexplorer"}).appendTo(i),this._createSaveInContainer(),this._createFolderContainer();var s={progress:function(){},success:function(i){"success"===i.request&&(l=e.extend({},l,i),t.options.docsURL=l.docsURL,t._initFolderListing(l))},fail:function(){}};this._getDocumentDetails(s),this.options.onInit?this.options.onInit():this._triggerEvent(this._EVENTS.ONINIT);var o=!1;this._fileexplorer.click(function(i){e(i.target).closest("#ui-zfileexplorer-location").length||(e("#ui-zfileexplorer-location").off("keydown"),o=!1,t._recentlyClicked.removeClass("ui-zfileexplorer-selected"))}),e("#ui-zfileexplorer-location").click(function(){e("#ui-zfileexplorer-location").attr("tabindex",0),o||(o=!0,t._bindKeyboradEvents(),e("#ui-zfileexplorer-location").focus())})},_initFolderListing:function(t){this._folderSearch(),this._tooltipEllipsis(),this._currentSelectedField=e("#ui-folder-myfolder"),t.isOwner?(this._currentSelectedField.trigger("click"),this._containerFol=e("#ui-zfileexplorer-myFolder")):t.inWorkspace?(e("#ui-folder-workspaces").trigger("click"),this._containerFol=e("#ui-zfileexplorer-workspaces")):(e("#ui-folder-sharedfolder").trigger("click"),this._containerFol=e("#ui-zfileexplorer-sharedFolder")),this._currentFilePath(),this.options.afterInit?this.options.afterInit(t):this._triggerEvent(this._EVENTS.ONAFTERINIT)},_bindKeyboradEvents:function(){var t=this;e("#ui-zfileexplorer-location").off("keydown").keydown(function(i){{var s,o,n=i.charCode||i.keyCode;e("#ui-folder-myfolder").offset().top,e("#ui-zfileexplorer-location").outerHeight()}switch(t._currentSelectedField=t._recentlyClicked,n){case ZDocsComponents.keyCode.ENTER:t._currentSelectedField.hasClass("ui-zfileexplorer-file")&&t._triggerOnSelect(!1,t._currentSelectedField.data().zfid);break;case ZDocsComponents.keyCode.LEFT:if(s=t._currentSelectedField.closest(".ui-zfileexplorer-folder").attr("id"),s&&"ui-zfileexplorer-searchLists-ul"!=s&&"ui-zfileexplorer-location"!=s){t._currentSelectedField=e("ui-zfileexplorer-myFolder-ul"===s?"#ui-folder-myfolder":"ui-zfileexplorer-sharedFolder-ul"===s?"#ui-folder-sharedfolder":"ui-zfileexplorer-workspaces-ul"===s?"#ui-folder-workspaces":"#ui-zfolder-"+s.substring(s.indexOf("-")+1)+"-li.ui-zfileexplorer-select"),o=t._currentSelectedField;{o.parent().parent()}t._scrollDownList(o),t._currentSelectedField.trigger("click")}break;case ZDocsComponents.keyCode.UP:if(t._currentSelectedField.prev().is("li")){if(o=t._currentSelectedField.prev(),o.hasClass("ui-zfileexplorer-file")&&t.options.fileNavigation===!1)for(;o.hasClass("ui-zfileexplorer-file")||o.hasClass("ui-readonlyfolder");)o=o.prev();o.hasClass("ui-zfileexplorer-grouping")&&(o=o.prev());o.is("li")&&t._scrollDownList(o),o.hasClass("ui-zfileexplorer-file")&&(t._openOnEnter=!0),o.trigger("click")}i.preventDefault();break;case ZDocsComponents.keyCode.RIGHT:if("ui-folder-myfolder"===t._currentSelectedField.attr("id")?t._currentSelectedField=e("#ui-zfileexplorer-myFolder-ul").children().children().children().children().first():"ui-folder-sharedfolder"===t._currentSelectedField.attr("id")?t._currentSelectedField=e("#ui-zfileexplorer-sharedFolder-ul").children().children().children().children().first():"ui-folder-workspaces"===t._currentSelectedField.attr("id")?t._currentSelectedField=e("#ui-zfileexplorer-workspaces-ul").children().children().children().children().first():(s=t._currentSelectedField.attr("id"),s=e("#ui-"+s.substring(11,s.length-3)),s.children().has("li").length&&(t._currentSelectedField=s.children().children().children().children().first())),o=t._currentSelectedField,o.hasClass("ui-zfileexplorer-file")&&t.options.fileNavigation===!1)for(;o.hasClass("ui-zfileexplorer-file")||o.hasClass("ui-readonlyfolder");)o=o.next();o.hasClass("ui-zfileexplorer-grouping")&&(o=o.next());{o.parent().parent()}t._scrollDownList(o),o!==t._recentlyClicked&&(o.hasClass("ui-zfileexplorer-file")&&(t._openOnEnter=!0),o.trigger("click"));break;case ZDocsComponents.keyCode.DOWN:if(t._currentSelectedField.next().is("li")){if(o=t._currentSelectedField.next(),o.hasClass("ui-zfileexplorer-file")&&t.options.fileNavigation===!1)for(;o.hasClass("ui-zfileexplorer-file")||o.hasClass("ui-readonlyfolder");)o=o.next();o.hasClass("ui-zfileexplorer-grouping")&&(o=o.next());o.is("li")&&t._scrollDownList(o),o.hasClass("ui-zfileexplorer-file")&&(t._openOnEnter=!0),o.trigger("click")}i.preventDefault();break;case ZDocsComponents.keyCode.TAB:t._recentlyClicked.removeClass("ui-zfileexplorer-selected")}})},_getDocumentDetails:function(e,t){var i={rid:this.options.fileId,folderId:t,action:"rescInfo"};ZDocsUtil.ajaxUtil("getdocstree.do","GET",i,e)},_getWorkspaceFolders:function(e,t,i,s){var o={rid:this.options.fileId,workspaceId:e,action:"wsfolders"};null!==t&&void 0!==t&&""!==t&&(o.folderId=t,o.action="wssubfolders",e=t);var n=this,a={progress:function(){},success:function(t){n._createFolderTree(t.myWorkspace,e,!1,"ws-folders"),n._displayFolderList(i,s)},fail:function(){}};ZDocsUtil.ajaxUtil("getdocstree.do","GET",o,a)},_getSharedFolders:function(t,i,s,o,n){var a={rid:this.options.fileId,folderId:t,action:"folderList"};void 0!==i&&(a.sharedBy=i);var r=this,l={progress:function(){},success:function(a){"success"===a.request&&(void 0!==i&&a.folderTree&&a.folderTree.length?r._createFolderTree(a.folderTree,t,!1,s):a.folderTree&&a.folderTree.length&&r._createFolderTree(a.folderTree,t,!1,s)),clearTimeout(this._clearTimeout),setTimeout(function(){e("#ui-zfileexplorer-bar-anim-effect").show()},50),this._clearTimeout=setTimeout(function(){r._displayFolderList(o,n)},200)},fail:function(){}};ZDocsUtil.ajaxUtil("getdocstree.do","GET",a,l)},_getUsersSharedFolders:function(t,i,s){var o={rid:this.options.fileId,sharedBy:t,action:"sharedFolders"},n=this,a={progress:function(){},success:function(o){"success"===o.request&&(n._createFolderTree(o.folderTree,t,!1,"shared-folders"),e("#ui-"+o.sharedBy).remove()),clearTimeout(this._clearTimeout),setTimeout(function(){e("#ui-zfileexplorer-bar-anim-effect").show()},50),this._clearTimeout=setTimeout(function(){n._displayFolderList(i,s)},100)},fail:function(){}};ZDocsUtil.ajaxUtil("getdocstree.do","GET",o,a)},_currentFilePath:function(){o=1;var t=l.currentPathFolderInfo;for(var i in t)this._createFolderTree(t[i],i,!1,void 0,!0);t=l.currentPathFolderArray;for(var s=0;s<t.length;s++)l.isOwner||0!==s||e("#ui-zfolder-"+t[s]+"-li").data("zflist",!0),e("#ui-zfolder-"+t[s]+"-li").trigger("click"),e("#ui-zfolder-"+t[s]+"-li").data("zftree",!1);this._containerFol.width((t.length+1)*e(".ui-zfileexplorer-folder").outerWidth()),this._zscrollList(),o=0,e(".ui-zfileexplorer-folder-content").zscroll()},_createSaveInContainer:function(){{var t=this,i=e("<div>").attr("class","ui-zfileexplorer-tools"),s=e("<div>").attr({"class":"ui-zfileexplorer-searchbox-cont",id:"ui-zfileexplorer-searchbox-cont"}).appendTo(i),o=e("<div>").attr("class","ui-zfileexplorer-searchbox").appendTo(s),n=e("<span>").attr({id:"ui-zfileexplorer-search-icon","class":"zsaveas zsaveas-search"}).appendTo(o),a=(e("<input>").attr({id:"ui-zfileexplorer-search","class":"ztextbox",type:"text"}).appendTo(o),e("<span>").attr({id:"ui-zfileexplorer-searchclose","class":"ui-zfileexplorer-searchclose"}).appendTo(o),e("<div>").attr("class","ui-zfileexplorer-fieldname").text(this._getString("savein.label")).appendTo(i),e("<div>").attr("class","ui-zfileexplorer-fieldinput").appendTo(i)),r=(l.recentFolders,e("<div>").attr("class","ui-zfileexplorer-recentfolders").appendTo(a));e("<span>").attr({id:"ui-zfileexplorer-recentFolderIcon","class":"ui-zfileexplorer-list-icon zsaveas zsaveas-folder"}).appendTo(r),e("<div>").attr({id:"ui-zfileexplorer-recent-folders-loader","class":"ui-zfileexplorer-recent-folders-loader"}).appendTo(r)}this._recentFoldersName=e("<input>").attr({id:"ui-zfileexplorer-recentFolderName","class":"ui-zfileexplorer-recentFolderName",type:"text",disabled:!0}).appendTo(r);var d=e("<div>").attr({id:"ui-zfileexplorer-newfolder"}).appendTo(a);this._newFolderBtn=e("<button>").attr({id:"ui-zfileexplorer-btn-newfolder","class":"ui-zfileexplorer-btn-newfolder"}).text(this._getString("newfolderbutton.label")).appendTo(d),this._newFolderBtn.zbutton(),i.appendTo(this._fileexplorer),this._newFolderBtn.on("click",function(){if(t._selectedFolderElement){t._newFolderBtn.zbutton("option","disabled",!0),e("#ui-zfileexplorer-folderContainer").addClass("ui-zfileexplorer-folcont-cursor"),n.addClass("ui-zfileexplorer-searchicon-opacity");var i=(document.createElement("div"),'<li id="ui-zsa-newfolder" class="ui-zsa-newfolder"><a><span id="ui-zsa-newfolder-icon" class="ui-zfileexplorer-list-icon zsaveas zsaveas-folder"></span> <input id="ui-zsa-newfolder-field" class="ztextbox ui-zsa-newfolder-field" type="text" value="'+t._getString("newfoldername.label")+'"> </a></li>');t._selectedFolderListing.append(i),t._zscrollList(),t._scrollDownList(),t._initCreateFolderEvents()}})},_initCreateFolderEvents:function(){var t=this;this._nameCheckInProgress=!1,e(".ui-dialog-titlebar-close").mousedown(function(){e("#ui-zsa-newfolder").remove(),t._nameCheckInProgress=!0}),e("#ui-zsa-newfolder-field").focus().select().off("keydown focusout").on("keydown focusout",function(i){{var s=e(this);i.keyCode}if(e("#ui-zsa-newfolder-field").css({"border-color":"#4190F2"}),27===i.keyCode&&(t._newFolderBtn.zbutton("option","disabled",!1),e("#ui-zsa-newfolder-field").off(),e("#ui-zfileexplorer-location").focus(),t._selectedFolderListing[0].removeChild(e("#ui-zsa-newfolder")[0]),i.stopPropagation(),t._recentlyClicked.trigger("click")),!t._nameCheckInProgress&&(13===i.keyCode||"focusout"===i.type)){var o=s.val().trim(),n=!0;if(0===o.length)e("#ui-zsa-newfolder-field").removeAttr("style"),n=!1,t._scrollDownList("newfolder"),e("#ui-zsa-newfolder-field").css({"border-color":"#e5443d",animation:"ui-zfe-shake .2s ease-in-out"}),e("#ui-zsa-newfolder-field").select();else if(t._selectedFolderListing.find("li.ui-folder,.ui-readonlyfolder").each(function(){o.toLowerCase()===e(this).text().toLowerCase()&&(n=!1)}),n)t._scrollDownList("newfolder"),e("#ui-zsa-newfolder").addClass("ui-zsa-newfolder-creation"),e("#ui-zsa-newfolder-icon").removeClass("zsaveas zsaveas-folder").addClass("ui-zfc-loader-circle zc-primary"),e("#ui-zsa-newfolder-field").attr("readonly",!0),t._createFolder(o);else{t._scrollDownList("newfolder"),t._nameCheckInProgress=!0,t._scrollDownList("newfolder");var a=[{text:"Ok",click:function(){ZD(this).dialog("destroy").remove(),t._nameCheckInProgress=!1,e("#ui-zsa-newfolder-field").focus().select()}}];ZDDialog.componentAlert(t._getString("foldername.label"),t._getString("folderalert.label"),"",a)}i.stopPropagation(),i.preventDefault()}}).on("click",function(e){e.stopPropagation()})},_createFolderContainer:function(){var t=this,i=e("<div>").attr("id","ui-zfileexplorer-folderContainer"),s=e("<div>").attr("class","ui-zfileexplorer-content").appendTo(i),n=e("<div>").attr({"class":"ui-zfileexplorer-location",id:"ui-zfileexplorer-location"}).appendTo(s),a=e("<div>").attr("class","ui-zfileexplorer-favorites").appendTo(n),r=e("<ul>").appendTo(a),d=e("<div>").attr({"class":"ui-zfileexplorer-folder-content",id:"ui-zfileexplorer-folder-content"}).appendTo(n);d.append(e("<span>").attr({"class":"ui-zfc-loader-circle",id:"ui-zfileexplorer-loader"}).css({"margin-left":"48%"})),i.appendTo(this._fileexplorer);var c="",p="";for(var h in this._category)c+="<li id="+this._category[h].id+' data-category="ui-zfileexplorer-'+h+'"><a><span class=" ui-zfileexplorer-list-icon '+this._category[h].iconClass+'"></span> <span class="ui-zfileexplorer-folder_name">'+this._category[h].label+"</span> </a></li>",p+='<div id="ui-zfileexplorer-'+h+'"></div>';p+='<div id="ui-zfileexplorer-searchLists"></div>',r.append(c),this._fragment=document.createDocumentFragment(),d.append(p),d.zscroll({setHeight:!0,setWidth:!0});var u;this._selectedWorkspaceId=void 0,this._selectedUserId=void 0,e(document).on("click.zsa","#ui-zfileexplorer-location li",function(){var i=e(this);if(!(t._selectedFolderListing&&t._selectedFolderListing.find("#ui-zsa-newfolder").length||i.hasClass("ui-zfileexplorer-breadcrumb-li")||i.hasClass("ui-zfileexplorer-selected"))){if(i.hasClass("ui-zfileexplorer-file"))return void e("#ui-zsa-docname").val(i.text());i.addClass("ui-zfileexplorer-selected ui-zfileexplorer-select"),t._recentlyClicked&&i[0]!=t._recentlyClicked[0]&&t._recentlyClicked.removeClass("ui-zfileexplorer-selected"),t._removeSlection(i,i.data()),t._recentFolderList(i),t._recentlyClicked=i,(e("#ui-zfileexplorer-search").val()||t._searchResult)&&(t._xhr&&t._xhr.abort(),"ui-folder-myfolder"===i.attr("id")?(t._searchResultInterpretation(),e("#ui-zfileexplorer-myFolder").empty()):"ui-folder-sharedfolder"===i.attr("id")?(t._searchResultInterpretation(),e("#ui-zfileexplorer-sharedFolder").empty()):"ui-folder-workspaces"===i.attr("id")?(t._searchResultInterpretation(),e("#ui-zfileexplorer-workspaces").empty()):"ui-zfileexplorer-searchLists-ul"===i.closest(".ui-zfileexplorer-folder").attr("id")&&(e("#ui-zfileexplorer-workspaces").empty(),e("#ui-zfileexplorer-myFolder").empty(),e("#ui-zfileexplorer-sharedFolder").empty()));var s=i.data();if(0===o)if(this._clearTimeout="",s.isuser){if(t._selectedUserId=s.zfid,!s.zflist)return t._loaderForFoldersDis(i),t._getUsersSharedFolders(s.zfid,i,s),void i.data("zflist",!0)}else{if(s.zftree&&("ws"===s.resourcetype||"ws-folders"===s.resourcetype)){i.data("zftree",!1),u=s.zfid;var n=void 0;return"ws"===s.resourcetype?t._selectedWorkspaceId=s.zfid:n=s.zfid,void t._getWorkspaceFolders(t._selectedWorkspaceId,n,i,s)}if(s.zftree&&!s.isuser&&!s.zflist)return"shared-folders"===s.resourcetype||"shared-subfolders"===s.resourcetype?(void 0===t._selectedUserId&&(t._selectedUserId=s.zsharedby),t._loaderForFoldersDis(i),t._getSharedFolders(s.zfid,t._selectedUserId,"shared-subfolders",i,s)):(t._loaderForFoldersDis(i),t._getSharedFolders(s.zfid,void 0,void 0,i,s)),void i.data("zftree",!1)}var a=s.category;"ui-zfileexplorer-myFolder"===a?(0===e("#ui-zfileexplorer-myFolder:visible").length&&e("#ui-zfileexplorer-myFolder").show(),u="zfileexplorer-myFolder-ul",selectedFodlerID=l.myFolderId,t._createFolderTree(l.myFolderTree,u,!0),t._displayFolderList(i,s)):"ui-zfileexplorer-sharedFolder"===a?(0===e("#ui-zfileexplorer-sharedFolder:visible").length&&e("#ui-zfileexplorer-sharedFolder").show(),u="zfileexplorer-sharedFolder-ul",t._createFolderTree(l.sharedWithMe,u,!1,"shared-users"),t._displayFolderList(i,s)):"ui-zfileexplorer-workspaces"===a?(0===e("#ui-zfileexplorer-workspaces:visible").length&&e("#ui-zfileexplorer-workspaces").show(),u="zfileexplorer-workspaces-ul",t._createFolderTree(l.myWorkspace,u,!1,"ws"),t._displayFolderList(i,s)):t._displayFolderList(i,s)}})},_loaderForFoldersDis:function(t){mainContainer=t.closest(".ui-zfileexplorer-folder").parent().attr("id"),e("#"+mainContainer).append(e("<div>").attr({id:"ui-loader-div","class":"ui-zfileexplorer-folder"})),e("#ui-loader-div").append(e("<span>").attr({id:"ui-zfileexplorer-loading-bar","class":"ui-zfileexplorer-loading-bar"})),e("#ui-loader-div").append(e("<span>").attr({id:"ui-zfileexplorer-bar-anim-effect","class":"ui-zfileexplorer-bar-anim-effect"})),e("#ui-zfileexplorer-loading-bar").append(e("<span>").attr({id:"ui-zfileexplorer-loading-bar-effect","class":"ui-zfileexplorer-loading-bar-effect"})),0===o&&e("#"+s).width(e("#"+s).children(":visible").length*e(".ui-zfileexplorer-folder").outerWidth()),this._zscrollList()},_removeSlection:function(t,i){var o=i.category;if(e("#ui-zfileexplorer-loader").remove(),o)e("#"+s).html(""),s=o,t.parent().children().removeClass("ui-zfileexplorer-select");else{parentId=i.zfid,selectedFodlerID=parentId;var n=t.index(),a=e("#"+t.closest(".ui-zfileexplorer-folder").attr("id")+" ul");if(a.find("li:lt("+n+")")&&a.find("li:lt("+n+")").data("flag",0).removeClass("ui-zfileexplorer-select"),a.find("li:gt("+n+")")&&a.find("li:gt("+n+")").data("flag",0).removeClass("ui-zfileexplorer-select"),1===i.flag||void 0===parentId)return;var r=t.closest(".ui-zfileexplorer-folder").index();e("#"+s).children(":gt("+r+")").hide(),e("#"+s).children(":gt("+r+")").children().children().children().children().removeClass("ui-zfileexplorer-select"),parentId="ui-"+parentId}},_displayFolderList:function(t,i,n){var a,r=i.category,l=t.closest(".ui-zfileexplorer-folder");if(r)switch(e("#"+s).html(""),s=r,t.parent().children().removeClass("ui-zfileexplorer-select"),t.addClass("ui-zfileexplorer-select"),s){case"ui-zfileexplorer-myFolder":n=s+"-ul";break;case"ui-zfileexplorer-sharedFolder":n=s+"-ul";break;case"ui-zfileexplorer-workspaces":n=s+"-ul";break;case"ui-zfileexplorer-sharedWorkspace":n=s+"-ul"}else{n=i.zfid,a=n;var d=t.index(),c=e("#"+l.attr("id")+" ul");if(c.find("li:lt("+d+")")&&c.find("li:lt("+d+")").data("flag",0).removeClass("ui-zfileexplorer-select"),c.find("li:gt("+d+")")&&c.find("li:gt("+d+")").data("flag",0).removeClass("ui-zfileexplorer-select"),1===i.flag||void 0===n)return;var p=l.index();e("#"+s).children(":gt("+p+")").hide(),e("#"+s).children(":gt("+p+")").children().children().children().removeClass("ui-zfileexplorer-select"),n="ui-"+n}if("ui-zfileexplorer-searchLists-ul"===this._recentlyClicked.closest(".ui-zfileexplorer-folder").attr("id")&&(s="ui-zfileexplorer-searchLists"),e("#"+n).length)p>e("#"+n).index()?(e("#"+n).insertAfter(l),e("#"+n).show()):e("#"+n).show();else{if(e("#ui-loader-div").remove(),null!==this._fragment.querySelector("#"+n))e("#"+s).append(e(this._fragment.querySelector("#"+n)));else{var h=e("<div>").attr({"class":"ui-zfileexplorer-folder",id:n}).appendTo(e("#"+s)).append("<ul></ul>");e("#"+s).append(h)}e("#"+s).children("#"+n).zscroll({setHeight:!0})}"ui-zfileexplorer-searchLists"===s?(e("#ui-zfileexplorer-searchLists").children().css({height:e(".ui-zfileexplorer-folder").outerHeight()-22}),e("#ui-zfileexplorer-searchLists").children().zscroll("refresh"),e(".ui-zscroll-horizontal").css({bottom:22}),this._breadcrumbList()):(e(".ui-zscroll-horizontal").css({bottom:1}),this._removeBreadcrumb()),0===o&&(e("#"+s).width(e("#"+s).children(":visible").length*e(".ui-zfileexplorer-folder").outerWidth()),this._zscrollList());var u;"ui-zfileexplorer-sharedFolder-ul"===n||"ui-zfileexplorer-sharedFolder-ul"===l.attr("id")||"ui-zfileexplorer-workspaces-ul"===n||t.data().readonly===!0?(this._newFolderBtn.zbutton("option","disabled",!0),u=!1):(u=!0,this._selectedFolderElement=e("#"+n),this._selectedFolderListing=e("#"+n).find("ul"),this._newFolderBtn.zbutton("option","disabled",!1),e("#ui-zfileexplorer-search-icon").removeClass("ui-zfileexplorer-searchicon-opacity"),e("#ui-zfileexplorer-folderContainer").removeClass("ui-zfileexplorer-folcont-cursor")),this._recentlyClicked.hasClass("ui-zfileexplorer-file")||this._triggerOnSelect(u,a)},_zscrollList:function(){var t=e("#ui-zfileexplorer-folder-content").children(".zscroll__container").children(".zscroll__content"),i=t[0].scrollWidth;e("#ui-zfileexplorer-folder-content").zscroll("refresh"),i>t.outerWidth()&&e("#ui-zfileexplorer-folder-content").zscroll("setAttribute","left",i)},_scrollDownList:function(t){var i;i="newfolder"===t?e("#ui-zsa-newfolder"):t?t:this._recentlyClicked;var s=e("#ui-zfileexplorer-location").outerHeight(),o=e("#ui-folder-myfolder").offset().top+s,n=i.parent().parent();if(i.offset().top+i.outerHeight()>=o){var a=i.offset().top-o;i.parent().parent().parent().parent().zscroll("setAttribute","top",n.scrollTop()+a+24)}else if(i.offset().top<=o-s){var a=i.offset().top;i.parent().parent().parent().parent().zscroll("setAttribute","top",n.scrollTop()-(o-s)+a-24)}},_breadcrumbList:function(){var s=this,o=(new Date).getTime();e.ajax({url:"/docs/getbreadcrumbsdata.do?type=breadcrumbs&resId="+s._recentlyClicked.data().zfid+"&mode=gettreeobjects&currentview=search&_t="+o,headers:{"X-ZCSRF-TOKEN":"zpcr="+ZDocsUtil.getCSRFCookie("zpcc")}}).done(function(s){var o,n=s.dataobj.length,a=0,r=0;t?t.children().remove():t=e("<div>").attr({id:"ui-zfileexplorer-breadcrumb","class":"ui-zfileexplorer-breadcrumb"}).appendTo(e("#ui-zfileexplorer-folder-content")).hide().fadeIn(100),t.append("<ul></ul>");var l="";for(0===s.dataobj[0].scope?l+='<li id="ui-zfileexplorer-breadcrumb-li" class="ui-zfileexplorer-breadcrumb-li"><a><span class=" ui-zfileexplorer-list-icon zsaveas zsaveas-folder"></span> <span class="ui-zfileexplorer-breadcrumb_folder_name">My Folders</span><span class="ui-zfileexplorer-icon-right zsaveas zsaveas-expand-arrow"></span> </a></li>':(l+='<li id="ui-zfileexplorer-breadcrumb-li" class="ui-zfileexplorer-breadcrumb-li"><a><span class=" ui-zfileexplorer-list-icon zsaveas zsaveas-shared-withme"></span> <span class="ui-zfileexplorer-breadcrumb_folder_name">Shared with Me</span><span class="ui-zfileexplorer-icon-right zsaveas zsaveas-expand-arrow"></span> </a></li>',l+='<li id="ui-zfileexplorer-breadcrumb-li" class="ui-zfileexplorer-breadcrumb-li"><a><span class=" ui-zfileexplorer-list-icon zsaveas zsaveas-user"></span> <span class="ui-zfileexplorer-breadcrumb_folder_name">'+s.dataobj[0].created_user_name+'</span><span class="ui-zfileexplorer-icon-right zsaveas zsaveas-expand-arrow"></span> </a></li>'),i=n-1;i>=0;i--)l+=0===i?'<li id="ui-zfileexplorer-breadcrumb-li" class="ui-zfileexplorer-breadcrumb-li"><a><span class=" ui-zfileexplorer-list-icon zsaveas zsaveas-folder"></span> <span class="ui-zfileexplorer-breadcrumb_folder_name">'+s.dataobj[i].enc_res_name+"</span> </a></li>":'<li id="ui-zfileexplorer-breadcrumb-li" class="ui-zfileexplorer-breadcrumb-li"><a><span class=" ui-zfileexplorer-list-icon zsaveas zsaveas-folder"></span> <span class="ui-zfileexplorer-breadcrumb_folder_name">'+s.dataobj[i].enc_res_name+'</span><span class="ui-zfileexplorer-icon-right zsaveas zsaveas-expand-arrow"></span> </a></li>';t.children().append(l);var d=t.children().children();if(d.each(function(){a+=e(this).width()}),a>=514){var c=e("<span>").attr({id:"ui-breadcrumb-showPath","class":"ui-breadcrumb-showPath","data-menu-id":"showpath"}).hide();c.append('<span class="ui-icon ui-components-icon ui-icon-triangle-1-s"></span>'),e("#showpath").children()&&e("#showpath").remove(),o=e("<ul>").attr({id:"showpath","class":"ui-breadcrumb-menulist",position:"end_after_end",data:"{'componentOptions':{'height':'148','positionAlterable':false}}"}).css("display","none").appendTo("body"),t.append(c),d.each(function(){a>=514&&(e(this).find(".ui-zfileexplorer-breadcrumb_folder_name").width()>60&&(e(this).find(".ui-zfileexplorer-breadcrumb_folder_name").css("width",60).addClass("breadcrumb-shrink-expand breadcrumb-blur-effect"),a-=e(this).find(".ui-zfileexplorer-breadcrumb_folder_name").width()-60),r+=e(this).width(),r>=514&&(c.show(),o.append('<li data=\'{"label":"'+e(this).text()+'","icon": "zsaveas zsaveas-folder"}\'></li>'),e(this).remove()))}),d.mouseenter(function(){var t,i,s;t=e(this).find(".ui-zfileexplorer-breadcrumb_folder_name"),t.hasClass("breadcrumb-blur-effect")&&t.removeClass("breadcrumb-blur-effect"),s=t.clone(),s.css({width:"auto"}).appendTo("body"),i=s.width(),s.remove(),e(this).find(".breadcrumb-shrink-expand").animate({width:i},100)}).mouseleave(function(){e(this).find(".breadcrumb-shrink-expand").addClass("breadcrumb-blur-effect"),e(this).find(".breadcrumb-shrink-expand").animate({width:60},200)})}})},_removeBreadcrumb:function(){t&&(e(".ui-zfileexplorer-breadcrumb").remove(),t=void 0)},_recentFolderList:function(t){e("#ui-zfileexplorer-recent-folders-loader").remove(),this._recentFoldersName.val(t.children().children().text())},_folderSearch:function(){var t=this;this._xhr,e("#ui-zfileexplorer-search").keyup(function(i){var s=e("#ui-zfileexplorer-search").val();if(s&&s.length>=3||s&&13===i.keyCode){var o=i.charCode||i.keyCode,n=[9,16,17,18,20,32,37,38,39,40,91,93];if(-1!=e.inArray(o,n))return;e("#ui-zfileexplorer-searchclose").hasClass("zsaveas-search-close")&&e("#ui-zfileexplorer-searchclose").removeClass("zsaveas zsaveas-search-close"),e("#ui-zfileexplorer-searchclose").addClass("ui-zfc-loader-circle"),t._newFolderBtn.zbutton("option","disabled",!0);var a="zfileexplorer-searchLists-ul";t._recentlyClicked.closest("#ui-zfileexplorer-myFolder").length||t._recentlyClicked.is("#ui-folder-myfolder")?(e("#ui-zfileexplorer-myFolder").hide(),e("#ui-folder-myfolder").removeClass("ui-zfileexplorer-selected ui-zfileexplorer-select")):t._recentlyClicked.closest("#ui-zfileexplorer-sharedFolder").length||t._recentlyClicked.is("#ui-folder-sharedfolder")?(e("#ui-zfileexplorer-sharedFolder").hide(),e("#ui-folder-sharedfolder").removeClass("ui-zfileexplorer-selected ui-zfileexplorer-select")):(t._recentlyClicked.closest("#ui-zfileexplorer-workspaces").length||t._recentlyClicked.is("#ui-folder-workspaces"))&&(e("#ui-zfileexplorer-workspaces").hide(),e("#ui-folder-workspaces").removeClass("ui-zfileexplorer-selected ui-zfileexplorer-select")),t._xhr&&t._xhr.abort(),t._xhr=e.ajax({url:"/docs/getsearchlist.do?action=search&searchtype=alllocation&category=folders&start=0&limit=50&sortorder=asc&orderby=name&crossdomain=true&searchquery="+s+"*",headers:{"X-ZCSRF-TOKEN":"zpcr="+ZDocsUtil.getCSRFCookie("zpcc")}}).done(function(i){i=JSON.parse(i);var s=e("#ui-zfileexplorer-searchLists");i&&i.dataobj.length>0?(e("#ui-zfileexplorer-searchclose").removeClass("ui-zfc-loader-circle").addClass("zsaveas zsaveas-search-close"),s.children().length&&(s.empty(),s.css({width:e(".ui-zfileexplorer-folder").outerWidth(),height:"100%"}),t._removeBreadcrumb()),t._createFolderTree(i.dataobj,a),t._searchResult=e(t._fragment.querySelector("#ui-"+a)),s.append(t._searchResult),s.children().zscroll({setHeight:!0}),t._zscrollList()):(e("#ui-zfileexplorer-searchclose").removeClass("ui-zfc-loader-circle").addClass("zsaveas zsaveas-search-close"),s.empty(),noResult=e("<label>").attr({"class":"ui-zfileexplorer-noresults"}).text(t._getString("nofoldersfound.label")),s.append(noResult),t._removeBreadcrumb())}),t._triggerOnSelect(!1)}else t._xhr&&t._xhr.abort(),8===i.keyCode&&s.length<=0&&(e("#ui-zfileexplorer-search").select(),t._searchResultInterpretation())}),e("#ui-zfileexplorer-searchclose").click(function(i){e("#ui-zfileexplorer-searchclose").hasClass("zsaveas-search-close")&&(e("#ui-zfileexplorer-search").select(),t._searchResultInterpretation(),i.stopPropagation())})},_searchResultInterpretation:function(){var t=this;e("#ui-zfileexplorer-searchLists").empty(),t._recentlyClicked.closest("#ui-zfileexplorer-myFolder").length||t._recentlyClicked.is("#ui-folder-myfolder")?(e("#ui-zfileexplorer-myFolder").show(),e("#ui-folder-myfolder").addClass("ui-zfileexplorer-select")):t._recentlyClicked.closest("#ui-zfileexplorer-sharedFolder").length||t._recentlyClicked.is("#ui-folder-sharedfolder")?(e("#ui-zfileexplorer-sharedFolder").show(),e("#ui-folder-sharedfolder").addClass("ui-zfileexplorer-select")):t._recentlyClicked.closest("#ui-zfileexplorer-workspaces").length||t._recentlyClicked.is("#ui-folder-workspaces")?(e("#ui-zfileexplorer-workspaces").show(),e("#ui-folder-workspaces").addClass("ui-zfileexplorer-select")):(e("#ui-folder-myfolder").trigger("click"),e("#ui-folder-myfolder").removeClass("ui-zfileexplorer-selected"),e("#ui-zfileexplorer-search").select()),t._zscrollList(),e("#ui-zfileexplorer-searchclose").removeClass("ui-zfc-loader-circle zsaveas zsaveas-search-close"),e("#ui-zfileexplorer-search").val(""),t._recentlyClicked.is("#ui-folder-sharedfolder")||t._recentlyClicked.parent().parent().parent().is("#ui-zfileexplorer-sharedFolder-ul")||t._recentlyClicked.is("#ui-folder-workspaces")||t._recentlyClicked.data().readonly===!0||(t._triggerOnSelect(!0,t._recentlyClicked.data().zfid),t._newFolderBtn.zbutton("option","disabled",!1))},_createFolderTree:function(e,t,i,s){var o,n="",r=!1,l=!1,d="",c="",p="",h="";if(void 0!==e){for(var u=0;u<e.length;u++){var f=a[e[u].res_type];("folder"===e[u].res_type||f===DComponents.option("service")||e[u].id)&&(c=e[u].id||e[u].resource_id||e[u].res_id,d=e[u].encattr_res_name||e[u].encodedName||e[u].name,p=e[u].extension||e[u].res_extn,lastOpenedTime=e[u].Last_Opened_Time,createdTime=e[u].Created_Time,lastModifiedTime=e[u].Last_Modified_Time,r=e[u].sub_folder&&e[u].sub_folder.length>0?!0:!1,1===e[u].scope&&(s="shared-folders"),e[u].readOnly||1===e[u].permission?(o="ui-readonlyfolder",e[u].readOnly=!0):o="ui-folder","zfileexplorer-sharedFolder-ul"===t?(r=!1,n+='<li id="ui-zfolder-'+c+'-li" data-zftree="true" data-zflist="false" data-isuser="true" data-zfid="'+c+'">',n+='<a><span class="ui-zfileexplorer-list-icon zsaveas zsaveas-user"></span><span class="ui-zfileexplorer-folder_name">'+e[u].encodedFullName+'</span><span class="ui-zfileexplorer-icon-right zsaveas zsaveas-expand-arrow"></span></a></li>'):"zfileexplorer-workspaces-ul"===t?(r=!1,n+='<li id="ui-zfolder-'+c+'-li" data-resourcetype="'+s+'" data-zftree="true" data-zflist="false" data-zfid="'+c+'" data-readonly="'+e[u].readOnly+'">',n+='<a><span class="ui-zfileexplorer-list-icon zsaveas zsaveas-workspace"></span><span class="ui-zfileexplorer-folder_name">'+d+'</span><span class="ui-zfileexplorer-icon-right zsaveas zsaveas-expand-arrow"></span></a></li>'):p&&"folder"!==e[u].res_type?(r=!1,h+='<li id="ui-zfolder-'+c+'-li" class="ui-zfileexplorer-file" data-resourcetype="'+s+'" data-zftree="'+l+'" data-zflist="false" data-kind="file" data-zfid="'+c+'" data-zext="'+p+'" data-lastopened="'+lastOpenedTime+'" data-lastmodified="'+lastModifiedTime+'" data-createdtime="'+createdTime+'">',h+='<a><span class="ui-zfileexplorer-list-icon zsaveas zsaveas-file-'+p+'"></span><span class="ui-zfileexplorer-folder_name">'+d+"</span></a></li>"):(l=Boolean(!i||e[u].IS_TREE),n+='<li id="ui-zfolder-'+c+'-li" class="'+o+'" data-resourcetype="'+s+'" data-zftree="'+l+'" data-zflist="false" data-kind="fol" data-zsharedby="'+e[u].space_id+'" data-zfid="'+c+'" data-readonly="'+e[u].readOnly+'" data-lastopened="'+lastOpenedTime+'" data-lastmodified="'+lastModifiedTime+'" data-createdtime="'+createdTime+'">',n+='<a><span class="ui-zfileexplorer-list-icon zsaveas zsaveas-folder"></span><span class="ui-zfileexplorer-folder_name">'+d+'</span><span class="ui-zfileexplorer-icon-right zsaveas zsaveas-expand-arrow"></span></a></li>'),r&&this._createFolderTree(e[u].sub_folder,c,i,s))}var m=document.createElement("div");m.className="ui-zfileexplorer-folder",m.id="ui-"+t,null!==this._fragment.querySelector("#ui-"+t)&&this._fragment.removeChild(this._fragment.querySelector("#ui-"+t)),m.innerHTML="<ul>"+n+h+"</ul>",this._fragment.appendChild(m)}},_createFolder:function(t,i){if(""!==t.trim()&&!this._requestStatus){var s="createfolder",o={rid:this.options.fileId,action:s,folderId:l.myFolderId===selectedFodlerID||void 0===selectedFodlerID||""===selectedFodlerID?"-1":selectedFodlerID,folderName:t,rid:this.options.fileId},n=this,a={progress:function(){n._requestStatus=!0,n._toggleLoader(!0,"progress",s,{folderId:i})},success:function(t){if("success"===t.request){n._selectedFolderListing[0].removeChild(e("#ui-zsa-newfolder")[0]),n._toggleLoader(!1,"success",s,{folderId:t.folderId});var o="#ui-zfolder-"+t.folderId+"-li";"-1"===t.folderId?(l.myFolderTree=t.folderTree,e("#ui-zfileexplorer-myFolder-ul").remove(),o="#ui-folder-myfolder"):e("#ui-"+t.folderId).remove(),t.folderTree&&t.folderTree.length&&(n._createFolderTree(t.folderTree,t.folderId),e(o).trigger("click"),e("#ui-zfolder-"+t.newFolderId+"-li").trigger("click"),n._scrollDownList())}else if("FolderNameAlreadyExist"===t.message){setTimeout(function(){e("#ui-zsa-newfolder-field").removeAttr("readonly"),e("#ui-zsa-newfolder").removeClass("ui-zsa-newfolder-creation"),e("#ui-zsa-newfolder-icon").removeClass("ui-zfc-loader-circle zc-primary").addClass("zsaveas zsaveas-folder")},1),n._newFolderErrStatus=!0,n._toggleLoader(!1,"error",s,{folderId:i});var a=[{text:"Close",click:function(){ZD(this).dialog("destroy").remove(),n._initCreateFolderEvents()}}];ZDDialog.componentAlert(n._getString("foldername.label"),n._getString("folderalert.label"),"",a)}else n._toggleLoader(!1,"status",s,{folderId:i}),e("#ui-fc-server-error")&&e("#ui-fc-server-error").remove(),n._triggerOnError("Permission_Denied"===t.message?n._getString("permissionerrorfolder.label"):n._getString("unknownerrorfolder.label")),setTimeout(function(){e("#ui-zsa-newfolder-field").removeAttr("readonly"),e("#ui-zsa-newfolder").removeClass("ui-zsa-newfolder-creation"),e("#ui-zsa-newfolder-icon").removeClass("ui-zfc-loader-circle zc-primary").addClass("zsaveas zsaveas-folder")},1);n._requestStatus=!1},fail:function(){n._requestStatus=!1,n._toggleLoader(!1,"fail",s,{folderId:i})}};ZDocsUtil.ajaxUtil("documentupdate.do","POST",o,a)}},_tooltipEllipsis:function(){var t=this;e(document).off("mouseover.zsa").on("mouseover.zsa","#ui-zfileexplorer-location li",function(){var i=e(this).children().find(".ui-zfileexplorer-folder_name"),s=i.clone().css({display:"inline",width:"auto",visibility:"hidden"}).appendTo("body");s.width()>i.width()?e(this).hasClass("ui-readonlyfolder")?i.attr({title:i.text()+" ( "+t._getString("readonly.label")+" )"}):i.attr("title",i.text()):e(this).hasClass("ui-readonlyfolder")&&i.attr("title",t._getString("readonly.label")),s.remove()})},_triggerOnSelect:function(e,t){this.options.onSelect?((l.myFolderId===t||"ui-zfileexplorer-myFolder"===this._recentlyClicked.data("category"))&&(t="-1"),this.options.onSelect({parentId:l.parentId,selectedFodlerID:t,folderWritePermission:e,selectedFolderElement:this._selectedFolderElement,recentlyClicked:this._recentlyClicked,intialFolContainWdth:o})):this._triggerEvent(this._EVENTS.ONSELECT)},_triggerOnError:function(e){this.options.onError?this.options.onError({errorMsg:e}):this._triggerEvent(this._EVENTS.ONSELECT)},_toggleLoader:function(){},_getString:function(e,t,i){return ZDocsUtil.getI18NString(t?t:"zfileexplorer",e,i,this.options.keys)},_triggerEvent:function(t,i){var s={action:this._action,fileId:this.options.fileId};i&&(s=e.extend(s,i)),e("body").trigger("zfileexplorer"+t,s)},_close:function(){r=!1,e(document).off("click.zsa mouseover.zsa"),e("#ui-zfileexplorer-recent-folders,#ui-zfileexplorer-file-format,#ui-zsa-newfolder,#ui-zfileexplorer-sorting-menu").remove(),this._fileexplorer.remove()}};return{open:function(e){r||d._init(e)},close:function(){d._close()},handleScroll:function(){d._scrollDownList()},handleSearchResult:function(){d._searchResultInterpretation()}}}(window.jQuery),ZFocusHandler=function(e){return{init:function(e,t){this._setInitialFocus(e,t),this._bindEvents(e,t)},_setInitialFocus:function(t,i){var s=t.find("input[tabindex]:not([tabindex=-1]):not([disabled]),textarea[tabindex]:not([tabindex=-1]):not([disabled]), button[tabindex]:not([tabindex=-1]):not([disabled]), .zselectbox[tabindex]:not([tabindex=-1]):not([tabindex=0]), a[tabindex]:not([tabindex=-1]):not([disabled]):not("+i+")").filter(":visible");if(s.length||(s=t.find("input:not([tabindex=-1]):not([disabled]),label[tabindex]:not([tabindex=-1]):not([disabled]),textarea:not([tabindex=-1]):not([disabled]), button:not([tabindex=-1]):not([disabled]), .zselectbox:not([tabindex=-1]):not([disabled]), a:not([tabindex=-1]):not([disabled]):not("+i+")").filter(":visible"),s.length)){var o=e(s.get(s.length-1)),n=o.prop("tabindex");return s.each(function(t,i){e(i).prop("tabindex")<n&&(o=e(i),n=e(i).prop("tabindex"))}),o.focus()}},_getNextTabElement:function(t,i,s,o,n){var a=e(o.toArray()),r=a.eq((a.index(t)+i)%a.length);r.hasClass("zselectbox")&&(r.hasClass("zselectbox")?r.prev().zcombobox("setFocus"):r.prev().zselectbox("setFocus")),r.is("[disabled],:hidden")?this._getNextTabElement(t,n.shiftKey?i-1:i+1,s,o,n):r.focus()},_bindEvents:function(t,i){var s=this,o=t.find("input:not([tabindex=-1]),label[tabindex]:not([tabindex=-1]), textarea:not([tabindex=-1]), button:not([tabindex=-1]), .zselectbox:not([tabindex=-1]), a:not([tabindex=-1]):not("+i+")");o.on("keydown.zfocushandler",function(i){if(i.which===ZDocsComponents.keyCode.TAB)if(i.target===o.last())o.get(0).focus();else{var n=i.shiftKey?-1:1;s._getNextTabElement(e(this),n,t,o,i)}}),t.off("keydown.zfocushandler").on("keydown.zfocushandler",function(t){e(t.target).is(".zdialog")&&t.which===ZDocsComponents.keyCode.TAB&&o.get(0).focus()})},_unbindEvents:function(e){var t=e.find("input:not([tabindex=-1]), textarea:not([tabindex=-1]), button:not([tabindex=-1]), .zselectbox:not([tabindex=-1]), a:not([tabindex=-1])");t.off("keydown.zfocushandler")},destroy:function(e){this._unbindEvents(e)},refresh:function(e,t,i){this._unbindEvents(e),this._bindEvents(e,t),i&&this._setInitialFocus(e,t)}}}(jQuery);SAVEASINIT.loadMailMergeSave=function(e){var t='<div id="docsLocContainer" class="zdocsLocContainer"><div class="inputdiv"><span id="ui-zfileexplorer-recentFolderIcon" class="ui-zfileexplorer-list-icon zsaveas zsaveas-folder iconspan"></span><input id="zd_saveaslocation" class="locationinput" type="text" disabled="disabled"></div><div class="chooselink" id="openSaveAs">Choose</div></div>';ZD("#"+e.container_id).append(t),SAVEASINIT.setLocation("My Folders"),ZD("#openSaveAs").unbind().bind("click",function(){SAVEASINIT.getProductData(e)});var i={action:"deepcopy",rid:e.fileId,folderId:"-1",fileextn:"",docname:"",parentFolder:$("#zd_saveaslocation").val(),handbackObj:e.calbackFn};e.calbackFn(i)},SAVEASINIT.getProductData=function(e){window.tdURL=e.WDUrl;var t=window.tdURL+"/docs/getuserproducts.do";ZD.ajax({url:t,type:"GET",xhrFields:{withCredentials:!0},dataType:"html",success:function(t){var i=JSON.parse(t);if(i.length>1)SAVEASINIT.chooseProduct(e,"docs_workdrive");else{var s=i[0].is_team_resource?"workdrive":"docs";SAVEASINIT.chooseProduct(e,s)}}})},SAVEASINIT.chooseProduct=function(e,t){var i=(e.container_id,e.fileId),s=e.fileName,o=e.serviceName,n=(e.buttonLabel,e.dialogTitle);if(void 0===n&&(n="Save As"),"docs"==t)window.ZD_IS_NEW_UI_ENABLED="false",ZDocsSaveAs.open({dialogTitle:n,fileId:i,needDefaultLocation:!1,fileName:s,callbackMethod:SAVEASINIT.processCopy,handbackObj:{callbck:e.calbackFn}});else if("workdrive"==t){window.ZD_IS_NEW_UI_ENABLED="true";var a={serviceName:o,resId:"",handback_obj:{callbck:e.calbackFn},okButtonName:"Choose",createFolderEnable:!0,showFileNameInHeader:!0,callback:SAVEASINIT.processCopy};SAVEASINIT.showChooseFolderForMailMerge(a)}else{$("#productchooser").remove(),$("body").append('<div id="productchooser"><div style="padding-bottom:10px;">Choose where you want to save your file</div><label style="padding-right:25px"><input checked=true type="radio" name="product" value="workdrive">WorkDrive</label><label><input type="radio" name="product" value="docs">Docs</label></div>');var r=[{id:"getProductBtn",text:"Choose",click:function(){var t=$("input[name='product']:checked").val();$("#productchooser").remove(),SAVEASINIT.chooseProduct(e,t)}}];ZDDialog.showCommonDialog("choose product",!0,"productchooser",r,[],"250",!0,"auto",!1,"100","200")}},SAVEASINIT.loadLocation=function(e){var t=e.container_id,i=e.fileId,s=e.fileName,o=e.serviceName,n=(e.buttonLabel,e.dialogTitle);void 0===n&&(n="Save As");var a='<div id="docsLocContainer" class="zdocsLocContainer"><div class="inputdiv"><span id="ui-zfileexplorer-recentFolderIcon" class="ui-zfileexplorer-list-icon zsaveas zsaveas-folder iconspan"></span><input id="zd_saveaslocation" class="locationinput" type="text" disabled="disabled"></div><div class="chooselink" id="openSaveAs">Choose</div></div>';if(ZD("#"+t).append(a),null!==ZD_IS_NEW_UI_ENABLED&&void 0!==ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED!==!1&&"false"!==ZD_IS_NEW_UI_ENABLED)ZD("#openSaveAs").unbind().bind("click",function(){var t={serviceName:o,resId:i,handback_obj:{callbck:e.calbackFn},okButtonName:"Choose",createFolderEnable:!0,showFileNameInHeader:!0,callback:SAVEASINIT.processCopy};SAVEASINIT.showChooseFolderDialog(t)}),ZD.ajax({url:window.tdURL+"/api/v1/files/"+i+"/breadcrumbs",xhrFields:{withCredentials:!0},success:function(t){SAVEASINIT.updateTDLocation(t,e)}});else{ZD("#openSaveAs").unbind().bind("click",function(){ZDocsSaveAs.open({dialogTitle:n,fileId:i,needDefaultLocation:!1,fileName:s,callbackMethod:SAVEASINIT.processCopy,handbackObj:{callbck:e.calbackFn}})});var r={rid:i,folderId:"",action:"rescInfo"},l={progress:function(){},success:function(t){SAVEASINIT.updateLocation(t,e)},fail:function(){}};ZDocsUtil.ajaxUtil("getdocstree.do","GET",r,l)}},SAVEASINIT.loadPath=function(e){var t=e.container_id,i=e.fileId,s=e.fileName,o=e.serviceName,n=(e.buttonLabel,'<div id="docsLocContainer" style="height:24px"><div style="background-color:#E0E0E0;height:24px;float:left;margin-right:8px;border:1px solid  #C8C8C8"><span id="ui-zfileexplorer-recentFolderIcon" style="margin-left:4px;margin-top:4px" class="ui-zfileexplorer-list-icon zsaveas zsaveas-folder"></span><input id="zd_saveaslocation" style="float:left;margin-right:10px;background-color:#E0E0E0;border:1px solid #E0E0E0" type="text" disabled="disabled"></div><div style="cursor:pointer;background-color:#E0E0E0;float: left;padding: 4px 10px;" id="openSaveAs">Choose</div></div>');if(ZD("#"+t).append(n),null!==ZD_IS_NEW_UI_ENABLED&&void 0!==ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED!==!1&&"false"!==ZD_IS_NEW_UI_ENABLED)ZD("#openSaveAs").unbind().bind("click",function(){var t={serviceName:o,resId:i,handback_obj:{callbck:e.calbackFn},okButtonName:"Choose",createFolderEnable:!0,showFileNameInHeader:!0,callback:SAVEASINIT.processCopy};"zohosheet"===o?SAVEASINIT.showSheetChooseFolderDialog(t):SAVEASINIT.showChooseFolderDialog(t)}),ZD.ajax({url:window.tdURL+"/api/v1/files/"+i+"/breadcrumbs",xhrFields:{withCredentials:!0},success:function(t){SAVEASINIT.updateTDLocation(t,e)}});else{ZD("#openSaveAs").unbind().bind("click",function(){ZDocsSaveAs.open({fileId:i,needDefaultLocation:!1,fileName:s,callbackMethod:SAVEASINIT.processCopy,handbackObj:{callbck:e.calbackFn}})});var a={rid:i,folderId:"",action:"rescInfo"},r={progress:function(){},success:function(t){SAVEASINIT.updateLocation(t,e)},fail:function(){}};ZDocsUtil.ajaxUtil("getdocstree.do","GET",a,r)}},SAVEASINIT.loadSaveAs=function(e){var t="Save as",i="Save";void 0!==e.title&&(t=e.title),void 0!==e.buttonLabel&&(i=e.buttonLabel);var s="<div id='initSaveAs'></div>";ZD("body").append(s);var o='<div style="margin-left:80px;margin-top:15px"><div style="float:left;margin-right:10px">File Name:</div><div><input id="ui-zsa-docname" type="text" tabindex="1" style="width:162px;height:22px"></div></div>';ZD("#initSaveAs").append(o);var n='<div id="locationEle" style="margin-left:80px;margin-top:30px;margin-bottom:80px"><div id="locationLable" style="margin-right:15px;float:left">Location:</div><div id="locationContainer" style="float:left"></div></div>';ZD("#initSaveAs").append(n),ZD("#ui-zsa-docname").val(e.fileName),SAVEASINIT.loadPath({container_id:"locationContainer",fileId:e.fileId,fileName:e.fileName,calbackFn:e.calbackFn,serviceName:e.serviceName});var a=[{id:"docsSaveBtn",text:i},{id:"docsCancelBtn",text:"Cancel",click:function(){ZDDialog.closePopUp("initSaveAs")}}];ZDDialog.showCommonDialog(t,!0,"initSaveAs",a,[],520,!0,"auto",!1,400,400),ZD("#initSaveAs").css("min-height","auto")},SAVEASINIT.updateTDLocation=function(e,t){var i=e.data[0].attributes.parent_ids[e.data[0].attributes.parent_ids.length-1].name,s=e.data[0].attributes.parent_ids[e.data[0].attributes.parent_ids.length-1].resource_id;if("MYSPACE_LIBRARY"===i&&(i="My Folder"),SAVEASINIT.setLocation(i),ZD("#docsSaveBtn").length)ZD("#docsSaveBtn").unbind().bind("click",function(){var e={action:"deepcopy",rid:t.fileId,folderId:s,fileextn:"",docname:$("#ui-zsa-docname").val(),parentFolder:$("#zd_saveaslocation").val(),handbackObj:t.calbackFn};t.calbackFn(e),ZDDialog.closePopUp("initSaveAs")});else{var o={action:"deepcopy",rid:t.fileId,folderId:s,fileextn:"",docname:"",parentFolder:$("#zd_saveaslocation").val(),handbackObj:t.calbackFn};t.calbackFn(o)}},SAVEASINIT.updateLocation=function(e,t){var i="My Folders";if(e.isOwner){var s=e.currentPathFolderInfo,o=e.currentPathFolderArray[0];if(e.currentPathFolderArray.length)if(1===e.currentPathFolderArray.length)for(var n=0;n<e.myFolderTree.length;n++)e.myFolderTree[n].id===e.parentId&&(i=e.myFolderTree[n].encodedName);else{if(e.currentPathFolderArray.length>1)var o=e.currentPathFolderArray[e.currentPathFolderArray.length-2];var a=s[o];for(n=0;n<a.length;n++)a[n].id===e.parentId&&(i=a[n].encodedName)}}var r=e.parentId;if(e.isOwner||(r=-1),SAVEASINIT.setLocation(i),ZD("#docsSaveBtn").length)ZD("#docsSaveBtn").unbind().bind("click",function(){var i={action:"deepcopy",rid:t.fileId,folderId:r,fileextn:e.extension,docname:$("#ui-zsa-docname").val(),parentFolder:$("#zd_saveaslocation").val(),handbackObj:t.calbackFn};t.calbackFn(i),ZDDialog.closePopUp("initSaveAs")});else{var l={action:"deepcopy",rid:t.fileId,folderId:r,fileextn:e.extension,docname:e.documentEncodedName,parentFolder:$("#zd_saveaslocation").val(),handbackObj:t.calbackFn};t.calbackFn(l)}},SAVEASINIT.setLocation=function(e){ZD("#zd_saveaslocation").val(e)},SAVEASINIT.processCopy=function(e){if(ZD("#docsSaveBtn").length)SAVEASINIT.setLocation(null!==ZD_IS_NEW_UI_ENABLED&&void 0!==ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED!==!1&&"false"!==ZD_IS_NEW_UI_ENABLED?e.targetFolder.targetFolderName:e.parentFolder),ZD("#docsSaveBtn").unbind().bind("click",function(){if(null!==ZD_IS_NEW_UI_ENABLED&&void 0!==ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED!==!1&&"false"!==ZD_IS_NEW_UI_ENABLED)e.handback_obj.callbck({action:"deepcopy",docname:$("#ui-zsa-docname").val(),fileextn:"",folderId:e.targetFolder.targetFolderId,parentFolder:e.targetFolder.targetFolderName,rid:e.targetFolder.currentResId});else{var t=e.handbackObj;e.docname=$("#ui-zsa-docname").val(),t.callbck(e)}ZDDialog.closePopUp("initSaveAs")});else if(null!==ZD_IS_NEW_UI_ENABLED&&void 0!==ZD_IS_NEW_UI_ENABLED&&ZD_IS_NEW_UI_ENABLED!==!1&&"false"!==ZD_IS_NEW_UI_ENABLED)SAVEASINIT.setLocation(e.targetFolder.targetFolderName),e.handback_obj.callbck({action:"deepcopy",docname:"",fileextn:"",folderId:e.targetFolder.targetFolderId,parentFolder:e.targetFolder.targetFolderName,rid:e.targetFolder.currentResId});else{var t=e.handbackObj;SAVEASINIT.setLocation(e.parentFolder),t.callbck(e)}},SAVEASINIT.injectScript=function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,t.async=!1,document.getElementsByTagName("head")[0].appendChild(t)},SAVEASINIT.showSheetChooseFolderDialog=function(e){if($("body").append("zw"===e.serviceName?'<div id="wd-loading-div" style="top:0;height: 100%;width: 100%;position: fixed;background: rgba(0,0,0,0.5);z-index: 10008;display: flex;align-items: center;justify-content: center;"><div style="color: #fff;font-size: 13px;"><style>.loader {border: 3px solid #f3f3f3;border-radius: 50%;border-top: 3px solid #4190f2;width: 32px;height: 32px;-webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;margin: auto;margin-bottom: 8px;}@-webkit-keyframes spin {0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); }}@keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style><div class="loader"></div>Loading...</div></div>':'<div id="wd-loading-div" style="top:0;height: 100%;width: 100%;position: fixed;background: rgba(0,0,0,0.5);z-index: 10008;display: flex;align-items: center;justify-content: center;"><div style="color: #fff;font-size: 13px;"><style>.loader {border: 3px solid #f3f3f3;border-radius: 50%;border-top: 3px solid #28b294;width: 32px;height: 32px;-webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;margin: auto;margin-bottom: 8px;}@-webkit-keyframes spin {0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); }}@keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style><div class="loader"></div>Loading...</div></div>'),$("#docscomponent").length)resId=e.resId,urlJson.ZD_COMP_PROPERTIES=e,window.attachObj=e,selected_component="chooseFolder",window.manifestJson=$("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=$("#fingerprint_assets").attr("uiLabManifestJson"),loginJson.client_manifest=window.manifestJson,loginJson.uilab_client_manifest=window.uiLabManifestJson,$("#docs_placeholder").trigger("click");else{var t=window.tdURL+"/docs/zdloadcomponentdata.do?resourceId="+window.wdResId;ZD.ajax({url:t,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){$("body").append($(t).filter("#fingerprint_assets")[0]),$("body").append($(t).filter("#wd_constants")[0]),$("body").append($(t).filter("#wd_i18n")[0]),$("body").append($(t).filter("#user_login_data")[0]),window.driveUserInfo=JSON.parse($("#user_login_data").val()),window.urlJson=[],window.loginJson=[],window.ZDOCScsrfToken=$("#wd_constants").attr("ZDOCScsrfToken"),window.flatpicker=$("#wd_constants").attr("flatpicker"),window.injectScript=SAVEASINIT.injectScript,window.staticVer=$("#wd_constants").attr("staticVer"),window.toggleFeaturesJSON=JSON.parse($("#wd_constants").attr("toggleFeaturesJSON")),window.ZD_CSSStaticSever=$("#wd_constants").attr("ZD_CSSStaticSever"),window.ZD_JSStaticSever=$("#wd_constants").attr("ZD_JSStaticSever"),window.appName=$("#wd_constants").attr("appName"),window.js_obj=JSON.parse($("#wd_i18n").attr("js_obj")),window.clientAssetsCachedVersion=$("#wd_constants").attr("clientAssetsCachedVersion"),window.enableExternalEditJSON=JSON.parse($("#wd_constants").attr("enableExternalEditJSON")),window.localeObj=$("#wd_constants").attr("localeObj"),urlJson.API_PATH_PREFIX=ZD("#wd_constants").attr("API_PATH_PREFIX"),urlJson.PC_URL=ZD("#wd_constants").attr("PC_URL");var i=window.ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+window.flatpicker;$("head").append('<link rel="stylesheet" href="'+i+'" type="text/css">'),window.manifestJson=$("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=$("#fingerprint_assets").attr("uiLabManifestJson"),selected_component="chooseFolder",urlJson.jsStaticServer=ZD_JSStaticSever,urlJson.ZD_COMP_PROPERTIES=e,window.attachObj=e,resId=e.resId,components_css="",scoped_writertheme_theme_css="",scoped_webcomponent_theme_css="",components_js="",components_vendor_js="",tp_vendor_js="",window.asset_engine="engine.js",window.asset_engine_vendor="engine-vendor.js",urlJson.jsStaticServer=ZD_JSStaticSever,window.manifestJson?(loginJson.client_manifest=window.manifestJson,appParsedJson=JSON.parse(window.manifestJson).assets,tp_vendor_js=appParsedJson["assets/tp-vendor.js"],components_js=appParsedJson["assets/components.js"],components_vendor_js=appParsedJson["assets/vendor.js"],components_css=appParsedJson["assets/components.css"]):(tp_vendor_js="assets/tp-vendor.js",components_js="assets/components.js",components_vendor_js="assets/vendor.js",components_css="assets/components.css"),window.uiLabManifestJson?(loginJson.uilab_client_manifest=window.uiLabManifestJson,uiLabParsedJson=JSON.parse(window.uiLabManifestJson).assets,scoped_writertheme_theme_css=uiLabParsedJson["assets/dev/scoped_writertheme_theme.css"],scoped_webcomponent_theme_css=uiLabParsedJson["assets/dev/scoped_webcomponent_theme.css"]):(scoped_writertheme_theme_css="assets/dev/scoped_writertheme_theme.css",scoped_webcomponent_theme_css="assets/dev/scoped_webcomponent_theme.css"),$("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),$("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-accessed-stats/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-accessed-stats%22%2C%22environment%22%3A%22development%22%7D"/>'),$("head").append('<meta name="zd-accessed-stats/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-accessed-stats%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-accessed-stats/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-accessed-stats/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),$("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),$("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="wd-resource-chooser/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22wd-resource-chooser%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="wd-resource-chooser/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22wd-resource-chooser%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/wd-resource-chooser/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/wd-resource-chooser/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===e.serviceName?($("body").append('<div class="writertheme-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_writertheme_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):($("body").append('<div class="webcomponent-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_webcomponent_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),SAVEASINIT.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+tp_vendor_js),SAVEASINIT.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_vendor_js),SAVEASINIT.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_js)}})}},SAVEASINIT.showChooseFolderDialog=function(e){if($("body").append("zw"===e.serviceName?'<div id="wd-loading-div" style="top:0;height: 100%;width: 100%;position: fixed;background: rgba(0,0,0,0.5);z-index: 10008;display: flex;align-items: center;justify-content: center;"><div style="color: #fff;font-size: 13px;"><style>.loader {border: 3px solid #f3f3f3;border-radius: 50%;border-top: 3px solid #4190f2;width: 32px;height: 32px;-webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;margin: auto;margin-bottom: 8px;}@-webkit-keyframes spin {0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); }}@keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style><div class="loader"></div>Loading...</div></div>':'<div id="wd-loading-div" style="top:0;height: 100%;width: 100%;position: fixed;background: rgba(0,0,0,0.5);z-index: 10008;display: flex;align-items: center;justify-content: center;"><div style="color: #fff;font-size: 13px;"><style>.loader {border: 3px solid #f3f3f3;border-radius: 50%;border-top: 3px solid #28b294;width: 32px;height: 32px;-webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;margin: auto;margin-bottom: 8px;}@-webkit-keyframes spin {0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); }}@keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style><div class="loader"></div>Loading...</div></div>'),$("#docscomponent").length)resId=e.resId,urlJson.ZD_COMP_PROPERTIES=e,window.attachObj=e,selected_component="chooseFolder",window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),loginJson.client_manifest=window.manifestJson,loginJson.uilab_client_manifest=window.uiLabManifestJson,$("#docs_placeholder").trigger("click");else{var t=window.tdURL+"/docs/zdloadcomponentdata.do?resourceId="+window.wdResId;ZD.ajax({url:t,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){ZD("#zd_user_details").remove(),ZD("body").append(t),ZD(t).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),window.driveUserInfo=JSON.parse(ZD("#user_login_data").val()),selected_component="chooseFolder",urlJson.jsStaticServer=ZD_JSStaticSever,urlJson.ZD_COMP_PROPERTIES=e,window.attachObj=e,resId=e.resId,components_css="",scoped_writertheme_theme_css="",scoped_webcomponent_theme_css="",components_js="",components_vendor_js="",tp_vendor_js="",window.asset_engine="engine.js",window.asset_engine_vendor="engine-vendor.js",urlJson.jsStaticServer=ZD_JSStaticSever,window.manifestJson?(loginJson.client_manifest=window.manifestJson,appParsedJson=JSON.parse(window.manifestJson).assets,tp_vendor_js=appParsedJson["assets/tp-vendor.js"],components_js=appParsedJson["assets/components.js"],components_vendor_js=appParsedJson["assets/vendor.js"],components_css=appParsedJson["assets/components.css"]):(tp_vendor_js="assets/tp-vendor.js",components_js="assets/components.js",components_vendor_js="assets/vendor.js",components_css="assets/components.css"),window.uiLabManifestJson?(loginJson.uilab_client_manifest=window.uiLabManifestJson,uiLabParsedJson=JSON.parse(window.uiLabManifestJson).assets,scoped_writertheme_theme_css=uiLabParsedJson["assets/dev/scoped_writertheme_theme.css"],scoped_webcomponent_theme_css=uiLabParsedJson["assets/dev/scoped_webcomponent_theme.css"]):(scoped_writertheme_theme_css="assets/dev/scoped_writertheme_theme.css",scoped_webcomponent_theme_css="assets/dev/scoped_webcomponent_theme.css"),$("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),$("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-accessed-stats/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-accessed-stats%22%2C%22environment%22%3A%22development%22%7D"/>'),$("head").append('<meta name="zd-accessed-stats/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-accessed-stats%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-accessed-stats/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-accessed-stats/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),$("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),$("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="wd-resource-chooser/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22wd-resource-chooser%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="wd-resource-chooser/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22wd-resource-chooser%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/wd-resource-chooser/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/wd-resource-chooser/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===e.serviceName?($("body").append('<div class="writertheme-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_writertheme_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):($("body").append('<div class="webcomponent-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_webcomponent_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),SAVEASINIT.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+tp_vendor_js),SAVEASINIT.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_vendor_js),SAVEASINIT.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_js)}})}},SAVEASINIT.showChooseFolderForMailMerge=function(e){if($("body").append("zw"===e.serviceName?'<div id="wd-loading-div" style="top:0;height: 100%;width: 100%;position: fixed;background: rgba(0,0,0,0.5);z-index: 10008;display: flex;align-items: center;justify-content: center;"><div style="color: #fff;font-size: 13px;"><style>.loader {border: 3px solid #f3f3f3;border-radius: 50%;border-top: 3px solid #4190f2;width: 32px;height: 32px;-webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;margin: auto;margin-bottom: 8px;}@-webkit-keyframes spin {0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); }}@keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style><div class="loader"></div>Loading...</div></div>':'<div id="wd-loading-div" style="top:0;height: 100%;width: 100%;position: fixed;background: rgba(0,0,0,0.5);z-index: 10008;display: flex;align-items: center;justify-content: center;"><div style="color: #fff;font-size: 13px;"><style>.loader {border: 3px solid #f3f3f3;border-radius: 50%;border-top: 3px solid #28b294;width: 32px;height: 32px;-webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;margin: auto;margin-bottom: 8px;}@-webkit-keyframes spin {0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); }}@keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style><div class="loader"></div>Loading...</div></div>'),$("#docscomponent").length)resId=e.resId,urlJson.ZD_COMP_PROPERTIES=e,window.attachObj=e,selected_component="choose_folder",window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),loginJson.client_manifest=window.manifestJson,loginJson.uilab_client_manifest=window.uiLabManifestJson,$("#docs_placeholder").trigger("click");else{var t=window.tdURL+"/docs/zdloadcomponentdata.do";ZD.ajax({url:t,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(t){ZD("#zd_user_details").remove(),ZD("body").append(t),ZD(t).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),selected_component="choose_folder",window.driveUserInfo=JSON.parse(ZD("#user_login_data").val()),urlJson.jsStaticServer=ZD_JSStaticSever,urlJson.ZD_COMP_PROPERTIES=e,window.attachObj=e,resId=e.resId,components_css="",scoped_writertheme_theme_css="",scoped_webcomponent_theme_css="",components_js="",components_vendor_js="",tp_vendor_js="",window.asset_engine="engine.js",window.asset_engine_vendor="engine-vendor.js",urlJson.jsStaticServer=ZD_JSStaticSever,window.manifestJson?(loginJson.client_manifest=window.manifestJson,appParsedJson=JSON.parse(window.manifestJson).assets,tp_vendor_js=appParsedJson["assets/tp-vendor.js"],components_js=appParsedJson["assets/components.js"],components_vendor_js=appParsedJson["assets/vendor.js"],components_css=appParsedJson["assets/components.css"]):(tp_vendor_js="assets/tp-vendor.js",components_js="assets/components.js",components_vendor_js="assets/vendor.js",components_css="assets/components.css"),window.uiLabManifestJson?(loginJson.uilab_client_manifest=window.uiLabManifestJson,uiLabParsedJson=JSON.parse(window.uiLabManifestJson).assets,scoped_writertheme_theme_css=uiLabParsedJson["assets/dev/scoped_writertheme_theme.css"],scoped_webcomponent_theme_css=uiLabParsedJson["assets/dev/scoped_webcomponent_theme.css"]):(scoped_writertheme_theme_css="assets/dev/scoped_writertheme_theme.css",scoped_webcomponent_theme_css="assets/dev/scoped_webcomponent_theme.css"),$("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),$("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-accessed-stats/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-accessed-stats%22%2C%22environment%22%3A%22development%22%7D"/>'),$("head").append('<meta name="zd-accessed-stats/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-accessed-stats%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-accessed-stats/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-accessed-stats/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),$("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),$("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),$("head").append('<meta name="wd-resource-chooser/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22wd-resource-chooser%22%2C%22environment%22%3A%22production%22%7D" />'),$("head").append('<meta name="wd-resource-chooser/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22wd-resource-chooser%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/wd-resource-chooser/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/wd-resource-chooser/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===e.serviceName?($("body").append('<div class="writertheme-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_writertheme_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):($("body").append('<div class="webcomponent-theme" id="docscomponent">'),$("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_webcomponent_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),SAVEASINIT.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+tp_vendor_js),SAVEASINIT.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_vendor_js),SAVEASINIT.injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_js)}})}};var ZDocsMoveTo=function(e){var t={keys:{"cancel.label":"Cancel","yesmove.label":"Yes, move","title.label":"Move To","filename.label":"File Name","movefilealert1.label":"Cannot move the file to the selected location because already there is another file with the same name.","movefilealert2.label":"Cannot move the file because the source and destination location are same.","ownership_change_msg.label":"Moving a file to another user's folder will change its ownership.","ownership_change_alert.label":"Are you sure you want to move this file?","permissionerrormove.label":"Cannot move in this folder. Your permission has been changed.","unknownerrormove.label":"Unable to move due to an unknown error.","movesuccessful.label":"File moved successfully.","move.label":"Move","moving.label":"Moving"},fileId:void 0,extension:void 0,allowDuplicateName:!1,fileName:"",dialogTitle:""},i=!1,s={extension:void 0,folderId:void 0,myFolderId:void 0,parentId:void 0,myFolderTree:void 0,sharedWithMe:void 0,currentPath:void 0,recentFolders:void 0,isOwner:void 0},o={widgetEventPrefix:"zmoveto",_EVENTS:{ONOPEN:"open",ONFINISH:"done",ONCLOSE:"close"},_init:function(i){this.options=e.extend({},t,i),s.documentName=this.options.fileName,s.extension=this.options.extension,this._createDialog()},_createDialog:function(){{var t=this;(window.innerWidth-760)/2,(window.innerHeight-270)/7}this._movetoDialog=e("<div>").attr({id:"ui-zmoveto-dialog"}).appendTo("body");var i=[{id:"ui-zmoveto-movebutton",text:this._getString("move.label"),click:function(){t._canMoveDocument(!0)}},{id:"btn-cancel",text:"Cancel",click:function(){e(".ui-zsa-newfolder").remove(),ZDDialog.closePopUp("ui-zmoveto-dialog")}}],o=""===this.options.dialogTitle||void 0===this.options.dialogTitle?this._getString("title.label"):this.options.dialogTitle;ZDDialog.showCommonDialog(o,!0,"ui-zmoveto-dialog",i,[],760,!0,"auto",!1,400,400),this._dialogBase=this._movetoDialog.parent(),ZFileExplorer.open({fileId:this.options.fileId,renderTo:"ui-zmoveto-dialog",onInit:function(){e("#ui-zfileexplorer-newfolder").on("click",function(){ZD("#ui-zmoveto-movebutton").button("disable")}),e("#ui-zmoveto-closebutton").mousedown(function(){e("#ui-zsa-newfolder").remove()})},afterInit:function(e){ZD("#ui-zmoveto-movebutton").button("enable"),(void 0===s.extension||""===s.extension.trim())&&(s.extension=e.extension)},onSelect:function(e){t._selectedFodlerID=e.selectedFodlerID,t._recentlyClicked=e.recentlyClicked,t._currentFolderLoc=e.parentId,t._selectedFolderElement=e.selectedFolderElement,t._folderWritePermission=e.folderWritePermission,ZD("#ui-zmoveto-movebutton").button(t._folderWritePermission===!0&&void 0!==t._selectedFodlerID?"enable":"disable")},onError:function(e){t._serverError(e.errorMsg)}});var n=!1;this._movetoDialog.click(function(i){e(i.target).closest("#ui-zfileexplorer-location").length||(e("#ui-zfileexplorer-location").off("keydown"),n=!1,t._bindTabkeyEvents(),t._recentlyClicked.removeClass("ui-zfileexplorer-selected"))}),e("#ui-zfileexplorer-location").click(function(){e("#ui-zfileexplorer-location").attr("tabindex",0),n||(n=!0,t._bindTabkeyEvents(),e("#ui-zfileexplorer-location").focus())}),this._dialogBase.on("contextmenu",function(e){return"text"!==e.target.type?!1:void 0})},_bindTabkeyEvents:function(){var t=this;this._dialogBase.off("keydown.move").on("keydown.move",function(i){var s=i.charCode||i.keyCode;if(9===s){var o=e(".ui-zmoveto-dialog").find(":focus"),n=o.attr("id");i.shiftKey?"ui-zfileexplorer-btn-newfolder"!==n||e("#ui-zfileexplorer-searchLists").children().length&&!e("#ui-zfileexplorer-searchLists").children().hasClass("ui-zfileexplorer-noresults")&&!t._recentlyClicked.closest("#ui-zfileexplorer-searchLists").is("#ui-zfileexplorer-searchLists")?"ui-zfileexplorer-search"===n&&e("#ui-zfileexplorer-btn-newfolder").hasClass("ui-state-disabled")&&(!e("#ui-zfileexplorer-searchLists").children().length||e("#ui-zfileexplorer-searchLists").children().hasClass("ui-zmoveto-noresult_found")?(ZFileExplorer.handleSearchResult(),t._recentlyClicked.trigger("click")):e("#ui-zfileexplorer-searchLists > div > div > ul > li:first").trigger("click"),e("#ui-zfileexplorer-location").focus(),ZFileExplorer.handleScroll()):((!e("#ui-zfileexplorer-searchLists").children().length||e("#ui-zfileexplorer-searchLists").children().hasClass("ui-zfileexplorer-noresults"))&&ZFileExplorer.handleSearchResult(),e("#ui-zfileexplorer-location").focus(),t._recentlyClicked.trigger("click"),ZFileExplorer.handleScroll()):("ui-zmoveto-movebutton"===n||"ui-zmoveto-closebutton"===n&&e("#ui-zmoveto-movebutton").hasClass("ui-state-disabled"))&&(!e("#ui-zfileexplorer-searchLists").children().length||e("#ui-zfileexplorer-searchLists").children().hasClass("ui-zfileexplorer-noresults")||t._recentlyClicked.closest("#ui-zfileexplorer-searchLists").is("#ui-zfileexplorer-searchLists"))?((!e("#ui-zfileexplorer-searchLists").children().length||e("#ui-zfileexplorer-searchLists").children().hasClass("ui-zfileexplorer-noresults"))&&ZFileExplorer.handleSearchResult(),t._recentlyClicked.trigger("click"),ZFileExplorer.handleScroll()):"ui-zmoveto-closebutton"===n&&e("#ui-zfileexplorer-searchLists").children().length&&e("#ui-zmoveto-movebutton").hasClass("ui-state-disabled")&&(e("#ui-zfileexplorer-searchLists > div > div > ul > li:first").trigger("click"),ZFileExplorer.handleScroll())}})},_canMoveDocument:function(t){if(t){ZDocsUtil.showProgressDialog(this._getString("moving.label")+"...",this._dialogBase),this._moveDocument(),this._dialogBase.hide();var i=e("#ui-zmoveto-movebutton");i.children(".ui-button-text").text(this._getString("moving.label")),i.children().first().hasClass("ui-zfc-loader-circle")||i.prepend(e("<span>").attr({"class":"ui-button-icon-primary ui-icon ui-zfc-loader-circle"}))}else{var s;s=this._getString(this._recentlyClicked.attr("id")==="ui-zfolder-"+this._currentFolderLoc+"-li"?"movefilealert2.label":"movefilealert1.label");var o=[{text:ZDocsUtil.getString("cancel.label",baseObj.options.keys),click:function(){ZD(this).dialog("destroy").remove(),setTimeout(function(){e("#ui-zmoveto-movebutton").focus()},200)}}];ZDDialog.componentAlert(baseObj._getString("filename.label"),s,"",o)}},_moveDocument:function(t){var i="move",o=s.myFolderId===this._selectedFodlerID||void 0===this._selectedFodlerID||""===this._selectedFodlerID?"-1":this._selectedFodlerID,n={action:i,rid:this.options.fileId,folderId:o};if(!this._requestStatus){this._requestTime=new Date;var a=this,r={progress:function(){a._requestStatus=!0,a._triggerEvent(a._EVENTS.ONSUBMIT,t,{folderId:o})},success:function(t){"success"===t.request?a._handleAJAXRequest(void 0,function(){a.options.onSuccess&&a.options.onSuccess({fileId:t.newResourceId}),ZDDialog.closePopUp("ui-zmoveto-dialog");var i=e('<div id="ui-zmoveto-success" class="ui-zmoveto-success"><div class="zc-server-error"><span id="zc-server-error-close" title="'+ZDocsUtil.getString("close.label",a.options.keys)+'" class="ui-zfc-icon ui-icon-closethick"></span><div class="zc-server-error-msg">'+a._getString("movesuccessful.label")+" </div> </div> </div>").appendTo("body");i.css({left:(window.innerWidth-i.outerWidth())/2,display:"block"}),setTimeout(function(){i.remove()},2e3)}):a._copyFail(t.message),a._requestStatus=!1},fail:function(){a._copyFail()}};ZDocsUtil.ajaxUtil("documentupdate.do","POST",n,r)}},_serverError:function(e){var t={autoCloseDelay:5e3};ZDocsUtil.showError(e,this._dialogBase,"#ui-zmoveto-dialog",t,"prependTo")},_handleAJAXRequest:function(e,t){var i=new Date,s=parseInt(i-this._requestTime);s=s>1e3?0:1e3-s,setTimeout(function(){t&&t(e),ZDocsUtil.removeProgressDialog()},s)},_copyFail:function(t){var i=this;this._handleAJAXRequest(t,function(t){ZDocsUtil.removeProgressDialog(),i._dialogBase.show();var s=i._getString("unknownerrormove.label");"ACCESS_DENIED"===t?s=i._getString("permissionerrormove.label"):"File_Name_Already_Exist"===t?s=i._getString("movefilealert1.label"):"Src_AND_Dest_Same"===t&&(s=i._getString("movefilealert2.label")),i._dialogBase.show(),i._requestStatus=!1;var o=e("#ui-zmoveto-movebutton");o.children(".ui-button-text").text(i._getString("move.label")),o.children().first().remove(),i._serverError(s)})},_getString:function(e,t,i){return ZDocsUtil.getI18NString(t?t:"zmoveto",e,i,this.options.keys)},_triggerEvent:function(t,i){var s={action:this._action,fileId:this.options.fileId};i&&(s=e.extend(s,i)),e("body").trigger("zmoveto"+t,s)},_closeDialog:function(){this._movetoDialog.zdialog("close")},_injectScript:function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,t.async=!1,document.getElementsByTagName("head")[0].appendChild(t)},_close:function(){this._movetoDialog.zdialog("destroy"),i=!1,this._triggerEvent(this._EVENTS.ONCLOSE),e(document).off("click.zsa mouseover.zsa"),ZFileExplorer.close(),this._movetoDialog.remove()}};return{open:function(e){i||o._init(e)},close:function(){o._closeDialog()},openSheetTDMove:function(t){if(e("body").append("zw"===t.serviceName?'<div id="wd-loading-div" style="top:0;height: 100%;width: 100%;position: fixed;background: rgba(0,0,0,0.5);z-index: 10008;display: flex;align-items: center;justify-content: center;"><div style="color: #fff;font-size: 13px;"><style>.loader {border: 3px solid #f3f3f3;border-radius: 50%;border-top: 3px solid #4190f2;width: 32px;height: 32px;-webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;margin: auto;margin-bottom: 8px;}@-webkit-keyframes spin {0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); }}@keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style><div class="loader"></div>Loading...</div></div>':'<div id="wd-loading-div" style="top:0;height: 100%;width: 100%;position: fixed;background: rgba(0,0,0,0.5);z-index: 10008;display: flex;align-items: center;justify-content: center;"><div style="color: #fff;font-size: 13px;"><style>.loader {border: 3px solid #f3f3f3;border-radius: 50%;border-top: 3px solid #28b294;width: 32px;height: 32px;-webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;margin: auto;margin-bottom: 8px;}@-webkit-keyframes spin {0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); }}@keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style><div class="loader"></div>Loading...</div></div>'),e("#docscomponent").length)resId=t.resId,urlJson.ZD_COMP_PROPERTIES=t,selected_component="move",window.attachObj=t,window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),loginJson.client_manifest=window.manifestJson,loginJson.uilab_client_manifest=window.uiLabManifestJson,e("#docs_placeholder").trigger("click");else{var i=window.tdURL+"/docs/zdloadcomponentdata.do?resourceId="+window.wdResId;ZD.ajax({url:i,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(i){e("body").append(e(i).filter("#fingerprint_assets")[0]),e("body").append(e(i).filter("#wd_constants")[0]),e("body").append(e(i).filter("#wd_i18n")[0]),e("body").append(e(i).filter("#user_login_data")[0]),window.driveUserInfo=JSON.parse(e("#user_login_data").val()),window.urlJson=[],window.loginJson=[],window.ZDOCScsrfToken=e("#wd_constants").attr("ZDOCScsrfToken"),window.flatpicker=e("#wd_constants").attr("flatpicker"),window.injectScript=o._injectScript,window.staticVer=e("#wd_constants").attr("staticVer"),window.toggleFeaturesJSON=JSON.parse(e("#wd_constants").attr("toggleFeaturesJSON")),window.ZD_CSSStaticSever=e("#wd_constants").attr("ZD_CSSStaticSever"),window.ZD_JSStaticSever=e("#wd_constants").attr("ZD_JSStaticSever"),window.appName=e("#wd_constants").attr("appName"),window.js_obj=JSON.parse(e("#wd_i18n").attr("js_obj")),window.clientAssetsCachedVersion=e("#wd_constants").attr("clientAssetsCachedVersion"),window.enableExternalEditJSON=JSON.parse(e("#wd_constants").attr("enableExternalEditJSON")),window.localeObj=e("#wd_constants").attr("localeObj"),urlJson.API_PATH_PREFIX=ZD("#wd_constants").attr("API_PATH_PREFIX"),urlJson.PC_URL=ZD("#wd_constants").attr("PC_URL");var s=window.ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+window.flatpicker;e("head").append('<link rel="stylesheet" href="'+s+'" type="text/css">'),window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),selected_component="move",urlJson.jsStaticServer=ZD_JSStaticSever,urlJson.ZD_COMP_PROPERTIES=t,window.attachObj=t,resId=t.resId,components_css="",scoped_writertheme_theme_css="",scoped_webcomponent_theme_css="",components_js="",components_vendor_js="",tp_vendor_js="",window.asset_engine="engine.js",window.asset_engine_vendor="engine-vendor.js",urlJson.jsStaticServer=ZD_JSStaticSever,window.manifestJson?(loginJson.client_manifest=window.manifestJson,appParsedJson=JSON.parse(window.manifestJson).assets,tp_vendor_js=appParsedJson["assets/tp-vendor.js"],components_js=appParsedJson["assets/components.js"],components_vendor_js=appParsedJson["assets/vendor.js"],components_css=appParsedJson["assets/components.css"]):(tp_vendor_js="assets/tp-vendor.js",components_js="assets/components.js",components_vendor_js="assets/vendor.js",components_css="assets/components.css"),window.uiLabManifestJson?(loginJson.uilab_client_manifest=window.uiLabManifestJson,uiLabParsedJson=JSON.parse(window.uiLabManifestJson).assets,scoped_writertheme_theme_css=uiLabParsedJson["assets/dev/scoped_writertheme_theme.css"],scoped_webcomponent_theme_css=uiLabParsedJson["assets/dev/scoped_webcomponent_theme.css"]):(scoped_writertheme_theme_css="assets/dev/scoped_writertheme_theme.css",scoped_webcomponent_theme_css="assets/dev/scoped_webcomponent_theme.css"),e("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),e("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),e("head").append('<meta name="zd-accessed-stats/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-accessed-stats%22%2C%22environment%22%3A%22development%22%7D"/>'),e("head").append('<meta name="zd-accessed-stats/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-accessed-stats%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-accessed-stats/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-accessed-stats/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),e("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),e("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),e("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),e("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),e("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),e("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),e("head").append('<meta name="wd-resource-chooser/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22wd-resource-chooser%22%2C%22environment%22%3A%22production%22%7D" />'),e("head").append('<meta name="wd-resource-chooser/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22wd-resource-chooser%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/wd-resource-chooser/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/wd-resource-chooser/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===t.serviceName?(e("body").append('<div class="writertheme-theme" id="docscomponent">'),e("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_writertheme_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):(e("body").append('<div class="webcomponent-theme" id="docscomponent">'),e("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_webcomponent_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),o._injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+tp_vendor_js),o._injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_vendor_js),o._injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_js)}})}},openTDMove:function(t){if(e("body").append("zw"===t.serviceName?'<div id="wd-loading-div" style="top:0;height: 100%;width: 100%;position: fixed;background: rgba(0,0,0,0.5);z-index: 10008;display: flex;align-items: center;justify-content: center;"><div style="color: #fff;font-size: 13px;"><style>.loader {border: 3px solid #f3f3f3;border-radius: 50%;border-top: 3px solid #4190f2;width: 32px;height: 32px;-webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;margin: auto;margin-bottom: 8px;}@-webkit-keyframes spin {0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); }}@keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style><div class="loader"></div>Loading...</div></div>':'<div id="wd-loading-div" style="top:0;height: 100%;width: 100%;position: fixed;background: rgba(0,0,0,0.5);z-index: 10008;display: flex;align-items: center;justify-content: center;"><div style="color: #fff;font-size: 13px;"><style>.loader {border: 3px solid #f3f3f3;border-radius: 50%;border-top: 3px solid #28b294;width: 32px;height: 32px;-webkit-animation: spin 1s linear infinite; animation: spin 1s linear infinite;margin: auto;margin-bottom: 8px;}@-webkit-keyframes spin {0% { -webkit-transform: rotate(0deg); }100% { -webkit-transform: rotate(360deg); }}@keyframes spin {0% { transform: rotate(0deg); }100% { transform: rotate(360deg); }}</style><div class="loader"></div>Loading...</div></div>'),e("#docscomponent").length)resId=t.resId,urlJson.ZD_COMP_PROPERTIES=t,selected_component="move",window.attachObj=t,window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),loginJson.client_manifest=window.manifestJson,loginJson.uilab_client_manifest=window.uiLabManifestJson,e("#docs_placeholder").trigger("click");else{var i=window.tdURL+"/docs/zdloadcomponentdata.do?resourceId="+window.wdResId;ZD.ajax({url:i,type:"GET",dataType:"html",xhrFields:{withCredentials:!0},success:function(i){ZD("#zd_user_details").remove(),ZD("body").append(i),ZD(i).find("script").each(function(){ZD.parseJSON(ZD(this).text())}),window.manifestJson=ZD("#fingerprint_assets").attr("manifestJson"),window.uiLabManifestJson=ZD("#fingerprint_assets").attr("uiLabManifestJson"),window.driveUserInfo=JSON.parse(ZD("#user_login_data").val()),selected_component="move",urlJson.jsStaticServer=ZD_JSStaticSever,urlJson.ZD_COMP_PROPERTIES=t,window.attachObj=t,resId=t.resId,components_css="",scoped_writertheme_theme_css="",scoped_webcomponent_theme_css="",components_js="",components_vendor_js="",tp_vendor_js="",window.asset_engine="engine.js",window.asset_engine_vendor="engine-vendor.js",urlJson.jsStaticServer=ZD_JSStaticSever,window.manifestJson?(loginJson.client_manifest=window.manifestJson,appParsedJson=JSON.parse(window.manifestJson).assets,tp_vendor_js=appParsedJson["assets/tp-vendor.js"],components_js=appParsedJson["assets/components.js"],components_vendor_js=appParsedJson["assets/vendor.js"],components_css=appParsedJson["assets/components.css"]):(tp_vendor_js="assets/tp-vendor.js",components_js="assets/components.js",components_vendor_js="assets/vendor.js",components_css="assets/components.css"),window.uiLabManifestJson?(loginJson.uilab_client_manifest=window.uiLabManifestJson,uiLabParsedJson=JSON.parse(window.uiLabManifestJson).assets,scoped_writertheme_theme_css=uiLabParsedJson["assets/dev/scoped_writertheme_theme.css"],scoped_webcomponent_theme_css=uiLabParsedJson["assets/dev/scoped_webcomponent_theme.css"]):(scoped_writertheme_theme_css="assets/dev/scoped_writertheme_theme.css",scoped_webcomponent_theme_css="assets/dev/scoped_webcomponent_theme.css"),e("head").append('<meta name="description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="components/config/environment" content="%7B%22modulePrefix%22%3A%22components%22%2C%22environment%22%3A%22development%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22components%22%2C%22version%22%3A%220.0.0+5c7d29f1%22%7D%2C%22exportApplicationGlobal%22%3Atrue%7D" />'),e("head").append('<meta name="components/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%2C%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),e("head").append('<meta name="zd-accessed-stats/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-accessed-stats%22%2C%22environment%22%3A%22development%22%7D"/>'),e("head").append('<meta name="zd-accessed-stats/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-accessed-stats%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-accessed-stats/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-accessed-stats/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),e("head").append('<meta name="zd-share-dialog/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-share-dialog%22%2C%22environment%22%3A%22development%22%7D" />'),e("head").append('<meta name="zd-share-dialog/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-share-dialog%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-share-dialog/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D"/>'),e("head").append('<meta name="zd-file-open/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-file-open%22%2C%22environment%22%3A%22production%22%7D" />'),e("head").append('<meta name="zd-file-open/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-file-open%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-file-open/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),e("head").append('<meta name="zd-move-copy/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22zd-move-copy%22%2C%22environment%22%3A%22production%22%7D" />'),e("head").append('<meta name="zd-move-copy/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22zd-move-copy%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/zd-move-copy/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),e("head").append('<meta name="wd-resource-chooser/config/environment" content="%7B%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22modulePrefix%22%3A%22wd-resource-chooser%22%2C%22environment%22%3A%22production%22%7D" />'),e("head").append('<meta name="wd-resource-chooser/config/asset-manifest" content="%7B%22bundles%22%3A%7B%22wd-resource-chooser%22%3A%7B%22assets%22%3A%5B%7B%22uri%22%3A%22/engines-dist/wd-resource-chooser/assets/engine-vendor.js%22%2C%22type%22%3A%22js%22%7D%2C%7B%22uri%22%3A%22/engines-dist/wd-resource-chooser/assets/engine.js%22%2C%22type%22%3A%22js%22%7D%5D%7D%7D%7D" />'),"zw"===t.serviceName?(e("body").append('<div class="writertheme-theme" id="docscomponent">'),e("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_writertheme_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_writertheme_theme.css">')):(e("body").append('<div class="webcomponent-theme" id="docscomponent">'),e("head").append(window.uiLabManifestJson?'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/ui-lab/dist/"+scoped_webcomponent_theme_css+'">':'<link rel="stylesheet" href="'+ZD_CSSStaticSever+"/jsapps/components/dist/"+components_css+'"><link rel="stylesheet" href="'+ZD_CSSStaticSever+'/jsapps/ui-lab/dev-releases/scoped_webcomponent_theme.css">')),o._injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+tp_vendor_js),o._injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_vendor_js),o._injectScript(ZD_JSStaticSever+"/jsapps/components/dist/"+components_js)}})}}}}(window.jQuery),ZDocsSaveAs=function(e){var t={keys:{"cancel.label":"Cancel","close.label":"Close","title.label":"Save As","filename.label":"File Name","saving.label":"Saving","choosefolderloc.label":"Choose Folder Location","filename.label":"File Name:","filealert.label":"A file with this name already exists. Please choose a different name.","save.label":"Choose","fileformat.label":"Format:","unknownerrorsave.label":"Unable to save due to an unknown error.","permissionerrorsave.label":"Cannot save in this folder. Your permission has been changed.","advancedOptionsLabel.label":"Options"},fileId:void 0,extension:void 0,fileName:"",allowDuplicateName:!1,dialogTitle:"",showAdvancedOptionsByDefault:!1,advancedOptionsInnerHTML:"",advancedOptionsLabel:"",postURL:"",needDefaultLocation:!1,callbackMethod:function(){},handbackObj:{}},i=!1,s={extension:void 0,folderId:void 0,myFolderId:void 0,parentId:void 0,myFolderTree:void 0,sharedWithMe:void 0,currentPath:void 0,recentFolders:void 0,isOwner:void 0},o={widgetEventPrefix:"zsaveas",_EVENTS:{ONOPEN:"open",ONFINISH:"done",ONCLOSE:"close"},_init:function(i){this.options=e.extend({},s,t,i),s.documentName=this.options.fileName,s.extension=this.options.extension||this.options.fileExtension,this._createDialog()},_createDialog:function(){var t=this;this._fileExtention=void 0,this._isDefaultExtn=!1,this._dialogWrapperWidth=442,this._dialogWidth=442;var i=(window.innerWidth-this._dialogDefaultWidth)/2,s=(window.innerHeight-270)/7;this._saveasDialog=e("<div>").attr({id:"ui-zdocssaveas-dialog"}).appendTo("body");var o=[{id:"ui-zsaveas-savebutton",text:this._getString("save.label"),click:function(){t._copyDocument(),e(".ui-zsa-newfolder").remove(),ZDDialog.closePopUp("ui-zdocssaveas-dialog")}},{id:"btn-cancel",text:"Cancel",click:function(){e(".ui-zsa-newfolder").remove(),ZDDialog.closePopUp("ui-zdocssaveas-dialog")}}];this._dialogBase=this._saveasDialog.parent(),this._createFileNameContainer();var n=""===this.options.dialogTitle||void 0===this.options.dialogTitle?this._getString("title.label"):this.options.dialogTitle;ZDDialog.showCommonDialog(n,!0,"ui-zdocssaveas-dialog",o,[],760,!0,"auto",!1,400,400),e(".ui-zsaveas-filenamecontainer").hide();var a=this._saveasDialog.find(".ui-zsaveas-filenamecontainer"),r=this._saveasDialog.find(".ui-zsaveas-fieldname");r.width()>90&&(this._dialogWrapperWidth+=50,this._dialogWidth=480,r.addClass("ui-zsaveas-fieldname-large"),this._dialogBase.width(this._dialogWidth).addClass("ui-zsaveas-large"),i=(window.innerWidth-this._dialogWrapperWidth)/2,this._saveasDialog.zdialog("open",[i,s])),a.removeClass("ui-zsaveas-collapse"),ZD("#ui-zsaveas-savebutton").button("disable"),ZFileExplorer.open({fileId:this.options.fileId,renderTo:"ui-zdocssaveas-dialog",onInit:function(){e("#ui-zfileexplorer-folderContainer").css("display","none"),e("#ui-zfileexplorer .ui-zfileexplorer-searchbox-cont").hide(),e("#ui-zfileexplorer-newfolder").hide(),""!==t.options.postURL&&(t._createFormatContainer(),t._moreRelativeOptions()),t._createExpandCollapseBtn(),t._createFormatContainer(),e("#ui-zfileexplorer-newfolder").on("click",function(){ZD("#ui-zsaveas-savebutton").button("disable")}),e("#ui-zsaveas-closebutton").mousedown(function(){e("#ui-zsa-newfolder").remove()})},afterInit:function(e){(void 0===t._fileExtention||""===t._fileExtention.trim())&&(t._isDefaultExtn=!0,t._fileExtention=e.extension)},onSelect:function(e){t._selectedFodlerID=e.selectedFodlerID,t._recentlyClicked=e.recentlyClicked,t._selectedFolderElement=e.selectedFolderElement,t._folderWritePermission=e.folderWritePermission,t._intialFolContainWdth=e.intialFolContainWdth,ZD("#ui-zsaveas-savebutton").button(t._folderWritePermission===!0&&void 0!==t._selectedFodlerID?"enable":"disable")},onError:function(e){t._serverError(e.errorMsg)}});var l=!1;this._saveasDialog.click(function(i){e(i.target).closest("#ui-zfileexplorer-location").length||(e("#ui-zfileexplorer-location").off("keydown"),l=!1,t._bindTabkeyEvents(),t._recentlyClicked.removeClass("ui-zfileexplorer-selected"))}),e("#ui-zfileexplorer-location").click(function(){e("#ui-zfileexplorer-location").attr("tabindex",0),l||(l=!0,t._bindTabkeyEvents(),e("#ui-zfileexplorer-location").focus())}),this._dialogBase.on("contextmenu",function(e){return"text"!==e.target.type?!1:void 0})},_bindTabkeyEvents:function(){var t=this;e("#ui-zdocssaveas-dialog").off("keydown").keydown(function(i){var s=i.charCode||i.keyCode;if(9===s){var o=e("#ui-zdocssaveas-dialog").find(":focus"),n=o.attr("id");"ui-zsaveas-formatsPane"!==o.parent().attr("class")||e("#ui-zfileexplorer-searchLists").children().length&&!e("#ui-zfileexplorer-searchLists").children().hasClass("ui-zfileexplorer-noresults")&&!t._recentlyClicked.closest("#ui-zfileexplorer-searchLists").is("#ui-zfileexplorer-searchLists")?"ui-zsaveas-formatsPane"===o.parent().attr("class")&&e("#ui-zfileexplorer-searchLists").children().length?(e("#ui-zfileexplorer-location").focus(),e("#ui-zfileexplorer-searchLists > div > div > ul > li:first").trigger("click"),ZFileExplorer.handleScroll()):i.shiftKey&&("ui-zfileexplorer-btn-newfolder"!==n||e("#ui-zfileexplorer-searchLists").children().length&&!t._recentlyClicked.closest("#ui-zfileexplorer-searchLists").is("#ui-zfileexplorer-searchLists")?"ui-zsaveas-expandCollapse"===n&&!e("#ui-zfileexplorer-searchLists").children().length&&e("#ui-zfileexplorer-btn-newfolder").hasClass("ui-state-disabled")?(e("#ui-zfileexplorer-location").focus(),t._recentlyClicked.trigger("click"),ZFileExplorer.handleScroll()):"ui-zsaveas-expandCollapse"===n&&e("#ui-zfileexplorer-searchLists").children().length&&e("#ui-zfileexplorer-btn-newfolder").hasClass("ui-state-disabled")&&(e("#ui-zfileexplorer-location").focus(),e("#ui-zfileexplorer-searchLists > div > div > ul > li:first").trigger("click"),ZFileExplorer.handleScroll()):(e("#ui-zfileexplorer-location").focus(),t._recentlyClicked.trigger("click"),ZFileExplorer.handleScroll())):((!e("#ui-zfileexplorer-searchLists").children().length||e("#ui-zfileexplorer-searchLists").children().hasClass("ui-zfileexplorer-noresults"))&&ZFileExplorer.handleSearchResult(),e("#ui-zfileexplorer-location").focus(),t._recentlyClicked.trigger("click"),ZFileExplorer.handleScroll())}})},_createFileNameContainer:function(){var t=e("<div>").attr("class","ui-zsaveas-filenamecontainer ui-zsaveas-collapse"),i=(e("<div>").attr("class","ui-zsaveas-fieldname").text(this._getString("filename.label")).appendTo(t),e("<div>").attr("class","ui-zsaveas-fieldinput").appendTo(t)),o=e("<input>").attr({id:"ui-zsa-docname","class":"ztextbox ui-zsa-docname",type:"text",value:s.documentName,tabindex:1}).appendTo(i),n=this.options.otherFileFormats;if(n&&n.length&&void 0!=s.extension){var a=e("<span>").attr({id:"ui-saveas-extn","class":"ui-saveas-extn"}).appendTo(i);void 0!=s.extension&&"zwriter"!==s.extension&&"zsheet"!==s.extension&&"zslide"!==s.extension&&a.text("."+s.extension),a.mouseup(function(){o.focus()}),o.focus(function(){a.addClass("ui-saveas-extn-focus")}).blur(function(){a.removeClass("ui-saveas-extn-focus")})}else o.addClass("ui-zsa-docname-no-format");var r=e("#ui-zsaveas-savebutton");t.appendTo(this._saveasDialog),setTimeout(function(){o.select()},1);var l=this;o.keyup(function(t){l._recentlyClicked.is("#ui-folder-sharedfolder")||l._recentlyClicked.parent().parent().parent().is("#ui-zfileexplorer-sharedFolder-ul")||l._recentlyClicked.is("#ui-folder-workspaces")||e("#ui-zfileexplorer-searchLists").children().length||l._recentlyClicked.data().readonly===!0||(13===t.keyCode&&o.val().trim().length>0?r.trigger("click"):o.val().trim().length>0?r.zbutton("option","disabled",!1):r.zbutton("option","disabled",!0))})},_createFormatContainer:function(){var t=this.options.otherFileFormats;if(this._fileExtention=s.extension,t&&t.length){var i=e("<div>").attr("id","ui-zsaveas-format"),o=(e("<div>").attr({"class":"ui-zsaveas-fieldname"}).text(this._getString("fileformat.label")).appendTo(i),e("<div>").attr({"class":"ui-zsaveas-formatsPane"}).appendTo(i)),n=e("<select>").attr({id:"ui-zsaveas-formatsBtn"}).appendTo(o);i.appendTo(this._saveasDialog).hide();for(var a=0;a<t.length;a++)if(t[a].mtype){e("<option>").attr("separator",!0).appendTo(n)}else if(t[a].fileExtension===this._fileExtention){e("<option>").attr({"data-icon":t[a].iconClass,value:t[a].fileExtension,selected:"selected"}).text(t[a].format).appendTo(n)}else{e("<option>").attr({"data-icon":t[a].iconClass,value:t[a].fileExtension}).text(t[a].format).appendTo(n)}var r=this;n.zselectbox({contentType:"icon-text",retainFocus:!0,applyExistingOptionStyles:!0,width:214}).on("zselectboxchange",function(t,i){r._fileExtention=i.selectedValue,e("#ui-saveas-extn").text("zwriter"===i.value||"zsheet"===i.value||"zslide"===i.value?"":"."+r._fileExtention)})}},_createExpandCollapseBtn:function(){{var t=this;e("#ui-zfileexplorer .ui-zfileexplorer-fieldinput")}this._expandBtn=e("<button>").attr({id:"ui-zsaveas-expandCollapse",title:this._getString("choosefolderloc.label")}).insertBefore(e("#ui-zfileexplorer-newfolder")),this._expandBtn.zbutton({icon:"zsaveas zsaveas-down-arrow"}),t.options.needDefaultLocation?(e("#ui-zdocssaveas-dialog").css("min-height","auto"),this._expandBtn.on("click",function(){t._transition(),ZFileExplorer.handleScroll()})):(this._expandBtn.hide(),t._showListing())},_moreRelativeOptions:function(){var t=e("<div>").attr({id:"ui-zsaveas-more-options","class":"ui-zsaveas-more-options",expanded:!1}).appendTo(this._saveasDialog),i=e("<span>").attr({id:"ui-zsaveas-advance-arrow-icon","class":"ui-zsaveas-advance-arrow-icon zsaveas zsaveas-expand-arrow"}).appendTo(t),s=e("<span>").attr({id:"ui-zsaveas-options-header","class":"ui-zsaveas-options-header"}).appendTo(t);s.text(""===this.options.advancedOptionsLabel||void 0===this.options.advancedOptionsLabel?this._getString("advancedOptionsLabel.label"):this.options.advancedOptionsLabel);var o=e("<div>").attr({id:"ui-zsaveas-custom-html","class":"ui-zsaveas-custom-html"}).appendTo(t);e("#ui-zsaveas-format").appendTo(o),o.append(this.options.advancedOptionsInnerHTML),this.options.showAdvancedOptionsByDefault?t.addClass("ui-zsaveas-options-expand"):t.click(function(){i.removeClass("zsaveas-down-arrow zsaveas-expand-arrow"),"false"===t.attr("expanded")?(i.addClass("zsaveas-down-arrow"),t.attr("expanded",!0)):(i.addClass("zsaveas-expand-arrow"),t.attr("expanded",!1)),o.slideToggle("fast")}),o.click(function(e){e.stopPropagation()})},_advanceSelectedOptions:function(){var t,i=e("#ui-zsaveas-custom-html input");for(this._optionsList={},t=0;t<i.length;t++)opt=i[t],this._optionsList[opt.id]=opt.checked},_copyDocument:function(){var t=e("#ui-zsa-docname").val();t=""===t||this._selectedFodlerID===t?this.options.documentName:t;var i="deepcopy",o=s.myFolderId===this._selectedFodlerID||void 0===this._selectedFodlerID||""===this._selectedFodlerID?"-1":this._selectedFodlerID,n={action:i,rid:this.options.fileId,folderId:o,fileextn:this._fileExtention,docname:t,parentFolder:e("#ui-zfileexplorer-recentFolderName").val(),handbackObj:this.options.handbackObj};this.options.callbackMethod(n)},_serverError:function(e){var t={autoCloseDelay:5e3};ZDocsUtil.showError(e,this._dialogBase,"#ui-zdocssaveas-dialog",t,"prependTo")},_handleAJAXRequest:function(e,t){var i=new Date,s=parseInt(i-this._requestTime);s=s>1e3?0:1e3-s,setTimeout(function(){ZDocsUtil.removeProgressDialog(),t&&t(e)},s)},_copyFail:function(e){var t=this;this._handleAJAXRequest(e,function(){t._dialogBase.show();var i=t._getString("unknownerrorsave.label");"Permission_Denied"===e?i=t._getString("permissionerrorsave.label"):"File_Name_Already_Exist"===e&&(i=t._getString("filealert.label")),t._dialogBase.show(),t._requestStatus=!1,t._serverError(i)})},_getString:function(e,t,i){return ZDocsUtil.getI18NString(t?t:"zsaveas",e,i,this.options.keys)},_triggerEvent:function(t,i){var s={action:this._action,fileId:this.options.fileId};i&&(s=e.extend(s,i)),e("body").trigger("zsaveas"+t,s)},_showListing:function(){e("#ui-zfileexplorer-folderContainer").is(":visible")?(e("#ui-zdocssaveas-dialog").css("height","auto"),this._expandBtn.children().removeClass("zsaveas-up-arrow").addClass("zsaveas-down-arrow")):(e("#ui-zfileexplorer-folderContainer").show(),this._saveasDialog.css("height","calc(100% - 154px)"),e("#ui-zfileexplorer").css("height","calc(100% - 86px)"),e("#ui-zfileexplorer-newfolder, .ui-zfileexplorer-searchbox-cont").show(),this._expandBtn.children().removeClass("zsaveas-down-arrow").addClass("zsaveas-up-arrow"))},_transition:function(){e("#ui-zfileexplorer-folderContainer").is(":visible")?(e("#ui-zdocssaveas-dialog").css("height","auto"),this._dialogBase.animate({"margin-left":"+=133",width:this._dialogWidth}),e("#ui-zfileexplorer-folderContainer").slideUp(400),e("#ui-zsaveas-format").slideUp(400),e("#ui-zfileexplorer").children(".ui-zfileexplorer-tools").animate({top:0}),e("#ui-zfileexplorer-newfolder, .ui-zfileexplorer-searchbox-cont").fadeOut(100),e("#ui-zsaveas-format").fadeOut(200),this._expandBtn.children().removeClass("zsaveas-up-arrow").addClass("zsaveas-down-arrow")):(e("#ui-zfileexplorer").children(".ui-zfileexplorer-tools").animate({top:-6}),e("#ui-zfileexplorer-folderContainer").delay(200).fadeIn(200),e("#ui-zsaveas-format").slideDown(400),this._dialogBase.animate({"margin-left":"-=133",width:760}),this._saveasDialog.css("height","calc(100% - 154px)"),e("#ui-zfileexplorer").css("height","calc(100% - 86px)"),e("#ui-zfileexplorer-newfolder, .ui-zfileexplorer-searchbox-cont").delay(200).fadeIn(200),this._expandBtn.children().removeClass("zsaveas-down-arrow").addClass("zsaveas-up-arrow"))},_closeDialog:function(){this._saveasDialog.zdialog("close")},_close:function(){this._saveasDialog.zdialog("destroy"),i=!1,this._triggerEvent(this._EVENTS.ONCLOSE),e(document).off("click.zsa mouseover.zsa"),this._saveasDialog.remove(),ZFileExplorer.close(),e("#ui-zsaveas-recent-folders,#zselect_ui-zsaveas-formatsBtnMenu").remove()}};return{open:function(e){i||o._init(e)},close:function(){ZDDialog.closePopUp("ui-zdocssaveas-dialog")}}}(window.jQuery);